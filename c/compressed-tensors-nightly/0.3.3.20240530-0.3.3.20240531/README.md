# Comparing `tmp/compressed_tensors_nightly-0.3.3.20240530-py3-none-any.whl.zip` & `tmp/compressed_tensors_nightly-0.3.3.20240531-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,45 +1,45 @@
-Zip file size: 64276 bytes, number of entries: 43
--rw-r--r--  2.0 unx      789 b- defN 24-May-30 00:04 compressed_tensors/__init__.py
--rw-r--r--  2.0 unx      755 b- defN 24-May-30 00:04 compressed_tensors/base.py
--rw-r--r--  2.0 unx     1512 b- defN 24-May-30 00:04 compressed_tensors/version.py
--rw-r--r--  2.0 unx      992 b- defN 24-May-30 00:04 compressed_tensors/compressors/__init__.py
--rw-r--r--  2.0 unx     2134 b- defN 24-May-30 00:04 compressed_tensors/compressors/base.py
--rw-r--r--  2.0 unx     1257 b- defN 24-May-30 00:04 compressed_tensors/compressors/dense.py
--rw-r--r--  2.0 unx     5403 b- defN 24-May-30 00:04 compressed_tensors/compressors/helpers.py
--rw-r--r--  2.0 unx     5203 b- defN 24-May-30 00:04 compressed_tensors/compressors/int_quantized.py
--rw-r--r--  2.0 unx    10481 b- defN 24-May-30 00:04 compressed_tensors/compressors/model_compressor.py
--rw-r--r--  2.0 unx     8412 b- defN 24-May-30 00:04 compressed_tensors/compressors/pack_quantized.py
--rw-r--r--  2.0 unx     8637 b- defN 24-May-30 00:04 compressed_tensors/compressors/sparse_bitmask.py
--rw-r--r--  2.0 unx      704 b- defN 24-May-30 00:04 compressed_tensors/config/__init__.py
--rw-r--r--  2.0 unx     1454 b- defN 24-May-30 00:04 compressed_tensors/config/base.py
--rw-r--r--  2.0 unx     1317 b- defN 24-May-30 00:04 compressed_tensors/config/dense.py
--rw-r--r--  2.0 unx     1308 b- defN 24-May-30 00:04 compressed_tensors/config/sparse_bitmask.py
--rw-r--r--  2.0 unx      760 b- defN 24-May-30 00:04 compressed_tensors/quantization/__init__.py
--rw-r--r--  2.0 unx     4360 b- defN 24-May-30 00:04 compressed_tensors/quantization/quant_args.py
--rw-r--r--  2.0 unx     8727 b- defN 24-May-30 00:04 compressed_tensors/quantization/quant_config.py
--rw-r--r--  2.0 unx     3571 b- defN 24-May-30 00:04 compressed_tensors/quantization/quant_scheme.py
--rw-r--r--  2.0 unx      798 b- defN 24-May-30 00:04 compressed_tensors/quantization/lifecycle/__init__.py
--rw-r--r--  2.0 unx     7984 b- defN 24-May-30 00:04 compressed_tensors/quantization/lifecycle/apply.py
--rw-r--r--  2.0 unx     1776 b- defN 24-May-30 00:04 compressed_tensors/quantization/lifecycle/calibration.py
--rw-r--r--  2.0 unx     2247 b- defN 24-May-30 00:04 compressed_tensors/quantization/lifecycle/compressed.py
--rw-r--r--  2.0 unx    10822 b- defN 24-May-30 00:04 compressed_tensors/quantization/lifecycle/forward.py
--rw-r--r--  2.0 unx     1726 b- defN 24-May-30 00:04 compressed_tensors/quantization/lifecycle/frozen.py
--rw-r--r--  2.0 unx     3732 b- defN 24-May-30 00:04 compressed_tensors/quantization/lifecycle/initialize.py
--rw-r--r--  2.0 unx      745 b- defN 24-May-30 00:04 compressed_tensors/quantization/observers/__init__.py
--rw-r--r--  2.0 unx     5121 b- defN 24-May-30 00:04 compressed_tensors/quantization/observers/base.py
--rw-r--r--  2.0 unx     2166 b- defN 24-May-30 00:04 compressed_tensors/quantization/observers/helpers.py
--rw-r--r--  2.0 unx     2165 b- defN 24-May-30 00:04 compressed_tensors/quantization/observers/memoryless.py
--rw-r--r--  2.0 unx     3669 b- defN 24-May-30 00:04 compressed_tensors/quantization/observers/min_max.py
--rw-r--r--  2.0 unx      656 b- defN 24-May-30 00:04 compressed_tensors/quantization/utils/__init__.py
--rw-r--r--  2.0 unx     6017 b- defN 24-May-30 00:04 compressed_tensors/quantization/utils/helpers.py
--rw-r--r--  2.0 unx      658 b- defN 24-May-30 00:04 compressed_tensors/registry/__init__.py
--rw-r--r--  2.0 unx    11890 b- defN 24-May-30 00:04 compressed_tensors/registry/registry.py
--rw-r--r--  2.0 unx      665 b- defN 24-May-30 00:04 compressed_tensors/utils/__init__.py
--rw-r--r--  2.0 unx     1735 b- defN 24-May-30 00:04 compressed_tensors/utils/helpers.py
--rw-r--r--  2.0 unx     8502 b- defN 24-May-30 00:04 compressed_tensors/utils/safetensors_load.py
--rw-r--r--  2.0 unx    11357 b- defN 24-May-30 00:05 compressed_tensors_nightly-0.3.3.20240530.dist-info/LICENSE
--rw-r--r--  2.0 unx     5633 b- defN 24-May-30 00:05 compressed_tensors_nightly-0.3.3.20240530.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-May-30 00:05 compressed_tensors_nightly-0.3.3.20240530.dist-info/WHEEL
--rw-r--r--  2.0 unx       19 b- defN 24-May-30 00:05 compressed_tensors_nightly-0.3.3.20240530.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     4376 b- defN 24-May-30 00:05 compressed_tensors_nightly-0.3.3.20240530.dist-info/RECORD
-43 files, 162327 bytes uncompressed, 57008 bytes compressed:  64.9%
+Zip file size: 64314 bytes, number of entries: 43
+-rw-r--r--  2.0 unx      789 b- defN 24-May-31 00:03 compressed_tensors/__init__.py
+-rw-r--r--  2.0 unx      755 b- defN 24-May-31 00:03 compressed_tensors/base.py
+-rw-r--r--  2.0 unx     1512 b- defN 24-May-31 00:03 compressed_tensors/version.py
+-rw-r--r--  2.0 unx      992 b- defN 24-May-31 00:03 compressed_tensors/compressors/__init__.py
+-rw-r--r--  2.0 unx     2134 b- defN 24-May-31 00:03 compressed_tensors/compressors/base.py
+-rw-r--r--  2.0 unx     1257 b- defN 24-May-31 00:03 compressed_tensors/compressors/dense.py
+-rw-r--r--  2.0 unx     5403 b- defN 24-May-31 00:03 compressed_tensors/compressors/helpers.py
+-rw-r--r--  2.0 unx     5242 b- defN 24-May-31 00:03 compressed_tensors/compressors/int_quantized.py
+-rw-r--r--  2.0 unx    10481 b- defN 24-May-31 00:03 compressed_tensors/compressors/model_compressor.py
+-rw-r--r--  2.0 unx     8451 b- defN 24-May-31 00:03 compressed_tensors/compressors/pack_quantized.py
+-rw-r--r--  2.0 unx     8637 b- defN 24-May-31 00:03 compressed_tensors/compressors/sparse_bitmask.py
+-rw-r--r--  2.0 unx      704 b- defN 24-May-31 00:03 compressed_tensors/config/__init__.py
+-rw-r--r--  2.0 unx     1454 b- defN 24-May-31 00:03 compressed_tensors/config/base.py
+-rw-r--r--  2.0 unx     1317 b- defN 24-May-31 00:03 compressed_tensors/config/dense.py
+-rw-r--r--  2.0 unx     1308 b- defN 24-May-31 00:03 compressed_tensors/config/sparse_bitmask.py
+-rw-r--r--  2.0 unx      760 b- defN 24-May-31 00:03 compressed_tensors/quantization/__init__.py
+-rw-r--r--  2.0 unx     4360 b- defN 24-May-31 00:03 compressed_tensors/quantization/quant_args.py
+-rw-r--r--  2.0 unx     8727 b- defN 24-May-31 00:03 compressed_tensors/quantization/quant_config.py
+-rw-r--r--  2.0 unx     3571 b- defN 24-May-31 00:03 compressed_tensors/quantization/quant_scheme.py
+-rw-r--r--  2.0 unx      798 b- defN 24-May-31 00:03 compressed_tensors/quantization/lifecycle/__init__.py
+-rw-r--r--  2.0 unx     7984 b- defN 24-May-31 00:03 compressed_tensors/quantization/lifecycle/apply.py
+-rw-r--r--  2.0 unx     1776 b- defN 24-May-31 00:03 compressed_tensors/quantization/lifecycle/calibration.py
+-rw-r--r--  2.0 unx     2247 b- defN 24-May-31 00:03 compressed_tensors/quantization/lifecycle/compressed.py
+-rw-r--r--  2.0 unx    10822 b- defN 24-May-31 00:03 compressed_tensors/quantization/lifecycle/forward.py
+-rw-r--r--  2.0 unx     1726 b- defN 24-May-31 00:03 compressed_tensors/quantization/lifecycle/frozen.py
+-rw-r--r--  2.0 unx     3732 b- defN 24-May-31 00:03 compressed_tensors/quantization/lifecycle/initialize.py
+-rw-r--r--  2.0 unx      745 b- defN 24-May-31 00:03 compressed_tensors/quantization/observers/__init__.py
+-rw-r--r--  2.0 unx     5121 b- defN 24-May-31 00:03 compressed_tensors/quantization/observers/base.py
+-rw-r--r--  2.0 unx     2166 b- defN 24-May-31 00:03 compressed_tensors/quantization/observers/helpers.py
+-rw-r--r--  2.0 unx     2165 b- defN 24-May-31 00:03 compressed_tensors/quantization/observers/memoryless.py
+-rw-r--r--  2.0 unx     3669 b- defN 24-May-31 00:03 compressed_tensors/quantization/observers/min_max.py
+-rw-r--r--  2.0 unx      656 b- defN 24-May-31 00:03 compressed_tensors/quantization/utils/__init__.py
+-rw-r--r--  2.0 unx     6017 b- defN 24-May-31 00:03 compressed_tensors/quantization/utils/helpers.py
+-rw-r--r--  2.0 unx      658 b- defN 24-May-31 00:03 compressed_tensors/registry/__init__.py
+-rw-r--r--  2.0 unx    11890 b- defN 24-May-31 00:03 compressed_tensors/registry/registry.py
+-rw-r--r--  2.0 unx      665 b- defN 24-May-31 00:03 compressed_tensors/utils/__init__.py
+-rw-r--r--  2.0 unx     1735 b- defN 24-May-31 00:03 compressed_tensors/utils/helpers.py
+-rw-r--r--  2.0 unx     8502 b- defN 24-May-31 00:03 compressed_tensors/utils/safetensors_load.py
+-rw-r--r--  2.0 unx    11357 b- defN 24-May-31 00:07 compressed_tensors_nightly-0.3.3.20240531.dist-info/LICENSE
+-rw-r--r--  2.0 unx     5673 b- defN 24-May-31 00:07 compressed_tensors_nightly-0.3.3.20240531.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-31 00:07 compressed_tensors_nightly-0.3.3.20240531.dist-info/WHEEL
+-rw-r--r--  2.0 unx       19 b- defN 24-May-31 00:07 compressed_tensors_nightly-0.3.3.20240531.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     4376 b- defN 24-May-31 00:07 compressed_tensors_nightly-0.3.3.20240531.dist-info/RECORD
+43 files, 162445 bytes uncompressed, 57046 bytes compressed:  64.9%
```

## zipnote {}

```diff
@@ -108,23 +108,23 @@
 
 Filename: compressed_tensors/utils/helpers.py
 Comment: 
 
 Filename: compressed_tensors/utils/safetensors_load.py
 Comment: 
 
-Filename: compressed_tensors_nightly-0.3.3.20240530.dist-info/LICENSE
+Filename: compressed_tensors_nightly-0.3.3.20240531.dist-info/LICENSE
 Comment: 
 
-Filename: compressed_tensors_nightly-0.3.3.20240530.dist-info/METADATA
+Filename: compressed_tensors_nightly-0.3.3.20240531.dist-info/METADATA
 Comment: 
 
-Filename: compressed_tensors_nightly-0.3.3.20240530.dist-info/WHEEL
+Filename: compressed_tensors_nightly-0.3.3.20240531.dist-info/WHEEL
 Comment: 
 
-Filename: compressed_tensors_nightly-0.3.3.20240530.dist-info/top_level.txt
+Filename: compressed_tensors_nightly-0.3.3.20240531.dist-info/top_level.txt
 Comment: 
 
-Filename: compressed_tensors_nightly-0.3.3.20240530.dist-info/RECORD
+Filename: compressed_tensors_nightly-0.3.3.20240531.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## compressed_tensors/compressors/int_quantized.py

```diff
@@ -53,21 +53,22 @@
 
         :param model_state: state dict of uncompressed model
         :param model_quant_args: quantization args for each quantized weight, needed for
         quantize function to calculate bit depth
         :return: compressed state dict
         """
         compressed_dict = {}
+        weight_suffix = ".weight"
         _LOGGER.debug(
             f"Compressing model with {len(model_state)} parameterized layers..."
         )
 
         for name, value in tqdm(model_state.items(), desc="Compressing model"):
-            if name.endswith(".weight"):
-                prefix = name.removesuffix(".weight")
+            if name.endswith(weight_suffix):
+                prefix = name[: -(len(weight_suffix))]
                 scale = model_state.get(merge_names(prefix, "weight_scale"), None)
                 zp = model_state.get(merge_names(prefix, "weight_zero_point"), None)
                 if scale is not None and zp is not None:
                     # weight is quantized, compress it
                     quant_args = model_quant_args[prefix]
                     if can_quantize(value, quant_args):
                         # only quantize if not already quantized
```

## compressed_tensors/compressors/pack_quantized.py

```diff
@@ -58,21 +58,22 @@
 
         :param model_state: state dict of uncompressed model
         :param model_quant_args: quantization args for each quantized weight, needed for
         quantize function to calculate bit depth
         :return: compressed state dict
         """
         compressed_dict = {}
+        weight_suffix = ".weight"
         _LOGGER.debug(
             f"Compressing model with {len(model_state)} parameterized layers..."
         )
 
         for name, value in tqdm(model_state.items(), desc="Compressing model"):
-            if name.endswith(".weight"):
-                prefix = name.removesuffix(".weight")
+            if name.endswith(weight_suffix):
+                prefix = name[: -(len(weight_suffix))]
                 scale = model_state.get(merge_names(prefix, "weight_scale"), None)
                 zp = model_state.get(merge_names(prefix, "weight_zero_point"), None)
                 shape = torch.tensor(value.shape)
                 if scale is not None and zp is not None:
                     # weight is quantized, compress it
                     quant_args = model_quant_args[prefix]
                     if can_quantize(value, quant_args):
```

## Comparing `compressed_tensors_nightly-0.3.3.20240530.dist-info/LICENSE` & `compressed_tensors_nightly-0.3.3.20240531.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `compressed_tensors_nightly-0.3.3.20240530.dist-info/METADATA` & `compressed_tensors_nightly-0.3.3.20240531.dist-info/METADATA`

 * *Files 3% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: compressed-tensors-nightly
-Version: 0.3.3.20240530
+Version: 0.3.3.20240531
 Summary: Library for utilization of compressed safetensors of neural network models
 Home-page: https://github.com/neuralmagic/compressed-tensors
 Author: Neuralmagic, Inc.
 Author-email: support@neuralmagic.com
 License: Apache 2.0
 Description-Content-Type: text/markdown
 License-File: LICENSE
@@ -85,15 +85,15 @@
 
 We can apply bitmask compression to a whole model. For more detailed example see `example` directory.
 ```python
 from compressed_tensors import save_compressed_model, load_compressed, BitmaskConfig
 from transformers import AutoModelForCausalLM
 
 model_name = "neuralmagic/llama2.c-stories110M-pruned50"
-model = AutoModelForCausalLM.from_pretrained(model_name)
+model = AutoModelForCausalLM.from_pretrained(model_name, torch_dtype="auto")
 
 original_state_dict = model.state_dict()
 
 compression_config = BitmaskConfig()
 
 # save compressed model weights
 save_compressed_model(model, "compressed_model.safetensors", compression_format=compression_config.format)
@@ -107,15 +107,15 @@
 
 ## Saving a Compressed Model with PTQ
 
 We can use compressed-tensors to run basic post training quantization (PTQ) and save the quantized model compressed on disk
 
 ```python
 model_name = "TinyLlama/TinyLlama-1.1B-intermediate-step-1431k-3T"
-model = AutoModelForCausalLM.from_pretrained(model_name, device_map="cuda:0")
+model = AutoModelForCausalLM.from_pretrained(model_name, device_map="cuda:0", torch_dtype="auto")
 
 config = QuantizationConfig.parse_file("./examples/bit_packing/int4_config.json")
 config.quantization_status = QuantizationStatus.CALIBRATION
 apply_quantization_config(model, config)
 
 dataset = load_dataset("ptb_text_only")["train"]
 tokenizer = AutoTokenizer.from_pretrained(model_name)
```

## Comparing `compressed_tensors_nightly-0.3.3.20240530.dist-info/RECORD` & `compressed_tensors_nightly-0.3.3.20240531.dist-info/RECORD`

 * *Files 3% similar despite different names*

```diff
@@ -1,17 +1,17 @@
 compressed_tensors/__init__.py,sha256=SV1csvHUVCd8kHXz6UDZim1HZ_fAVG3vfk-j_4Bb6hY,789
 compressed_tensors/base.py,sha256=OA2TOLP1gP3LSH7gp508eqr2ZtDQ-pqRHElCp-aB0vs,755
 compressed_tensors/version.py,sha256=V8krJZctm43D4AGQhJY6dB0MvP1-T9TJ8BcGa8kESrI,1512
 compressed_tensors/compressors/__init__.py,sha256=3yyoNICHll3F4HS6Yu-cgNZpDhfuobFNWCs6DrPcUyQ,992
 compressed_tensors/compressors/base.py,sha256=LWEgbpgTxzmoqQ7Xhq2OQszUgWoDtFuGCiV1Y8nlBGw,2134
 compressed_tensors/compressors/dense.py,sha256=G_XHbvuENyupIKlXSITOQgvPkNkcMEOLcLWQr70V9EE,1257
 compressed_tensors/compressors/helpers.py,sha256=k9avlkmeYj6vkOAvl-MgcixtP7ib24SCfhzZ-RusXfw,5403
-compressed_tensors/compressors/int_quantized.py,sha256=bPi62n1MjySOeBat_yWMyc_LvDNDeSihu1gxzo_YrNY,5203
+compressed_tensors/compressors/int_quantized.py,sha256=Ct2vCK0yoPm6vkIFlzDMGQ7m14xT1GyURsSwH9DP770,5242
 compressed_tensors/compressors/model_compressor.py,sha256=gHD2VMbXkXaZiJu3ibOaWiYb4oJDz2hxX03wDuu1yhI,10481
-compressed_tensors/compressors/pack_quantized.py,sha256=zNQnnefK3qWpIzeGTBldQrRc8LM0p-nfSAN9Q9zUAIE,8412
+compressed_tensors/compressors/pack_quantized.py,sha256=VPiLlgJlDgARrn7YmiQoLqUfxErKBfj54epMYWRsF8k,8451
 compressed_tensors/compressors/sparse_bitmask.py,sha256=H9oZSTYI1oRCzAMbd4zThUnZd1h2rfs8DmA3tPcvuNE,8637
 compressed_tensors/config/__init__.py,sha256=ZBqWn3r6ku1qfmlHHYp0mQueY0i7Pwhr9rbQk9dDlMc,704
 compressed_tensors/config/base.py,sha256=grf5tDaLep8i2-W_p7H-fW9DOGXDi4Zz7su7zjs1Qqc,1454
 compressed_tensors/config/dense.py,sha256=NgSxnFCnckU9-iunxEaqiFwqgdO7YYxlWKR74jNbjks,1317
 compressed_tensors/config/sparse_bitmask.py,sha256=pZUboRNZTu6NajGOQEFExoPknak5ynVAUeiiYpS1Gt8,1308
 compressed_tensors/quantization/__init__.py,sha256=83J5bPB7PavN2TfCoW7_vEDhfYpm4TDrqYO9vdSQ5bk,760
 compressed_tensors/quantization/quant_args.py,sha256=A6b2V8lhsM8Ho8RjlPBQdxRUDNWhqq-ie5E3RR2_GNg,4360
@@ -32,12 +32,12 @@
 compressed_tensors/quantization/utils/__init__.py,sha256=VdtEmP0bvuND_IGQnyqUPc5lnFp-1_yD7StKSX4x80w,656
 compressed_tensors/quantization/utils/helpers.py,sha256=NzAH18Cn_-mTAR87y6IlcQU5gC393XSjgNKC9CRkr78,6017
 compressed_tensors/registry/__init__.py,sha256=FwLSNYqfIrb5JD_6OK_MT4_svvKTN_nEhpgQlQvGbjI,658
 compressed_tensors/registry/registry.py,sha256=fxjOjh2wklCvJhQxwofdy-zV8q7MkQ85SLG77nml2iA,11890
 compressed_tensors/utils/__init__.py,sha256=5DrYjoZbaEvSkJcC-GRSbM_RBHVF4tG9gMd3zsJnjLw,665
 compressed_tensors/utils/helpers.py,sha256=h0jfl9drs5FAx40tCHRcVtJqXixB5hT5yq_IG2aY_-w,1735
 compressed_tensors/utils/safetensors_load.py,sha256=wo9UirGrGlenBqZeqotvpCT7D5MEdjCo2J3HeRaIFoU,8502
-compressed_tensors_nightly-0.3.3.20240530.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
-compressed_tensors_nightly-0.3.3.20240530.dist-info/METADATA,sha256=qwUahaxoHtwQWO9CbLp2YOw7M4xzLJ5uUvDnJg3m3GA,5633
-compressed_tensors_nightly-0.3.3.20240530.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-compressed_tensors_nightly-0.3.3.20240530.dist-info/top_level.txt,sha256=w2i-GyPs2s1UwVxvutSvN_lM22SXC2hQFBmoMcPnV7Y,19
-compressed_tensors_nightly-0.3.3.20240530.dist-info/RECORD,,
+compressed_tensors_nightly-0.3.3.20240531.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
+compressed_tensors_nightly-0.3.3.20240531.dist-info/METADATA,sha256=C02ZlsO9SJ14Zly_UFEtYDmiOdXVb-0upcrn_sgM1QM,5673
+compressed_tensors_nightly-0.3.3.20240531.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+compressed_tensors_nightly-0.3.3.20240531.dist-info/top_level.txt,sha256=w2i-GyPs2s1UwVxvutSvN_lM22SXC2hQFBmoMcPnV7Y,19
+compressed_tensors_nightly-0.3.3.20240531.dist-info/RECORD,,
```

