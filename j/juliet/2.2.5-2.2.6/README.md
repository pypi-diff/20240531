# Comparing `tmp/juliet-2.2.5-py3-none-any.whl.zip` & `tmp/juliet-2.2.6-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,17 +1,17 @@
-Zip file size: 60866 bytes, number of entries: 15
+Zip file size: 61141 bytes, number of entries: 15
 -rw-r--r--  2.0 unx    20297 b- defN 24-Mar-01 22:56 juliet/KeplerOrbit.py
--rw-r--r--  2.0 unx      111 b- defN 21-Sep-03 16:46 juliet/__init__.py
+-rw-r--r--  2.0 unx      111 b- defN 24-Mar-29 05:42 juliet/__init__.py
 -rw-r--r--  2.0 unx      608 b- defN 21-Sep-03 16:46 juliet/__main__.py
--rw-r--r--  2.0 unx       22 b- defN 24-Mar-01 22:56 juliet/_version.py
--rw-r--r--  2.0 unx   262571 b- defN 24-Mar-01 22:56 juliet/fit.py
+-rw-r--r--  2.0 unx       22 b- defN 24-May-30 18:22 juliet/_version.py
+-rw-r--r--  2.0 unx   264061 b- defN 24-May-30 18:22 juliet/fit.py
 -rw-r--r--  2.0 unx      189 b- defN 21-Sep-03 16:18 juliet/plots.py
 -rw-r--r--  2.0 unx      424 b- defN 21-Sep-03 16:46 juliet/test_utils.py
--rw-r--r--  2.0 unx    35374 b- defN 24-Mar-01 22:56 juliet/utils.py
--rw-r--r--  2.0 unx     1548 b- defN 24-Mar-01 23:07 juliet-2.2.5.dist-info/AUTHORS.rst
--rw-r--r--  2.0 unx     1084 b- defN 24-Mar-01 23:07 juliet-2.2.5.dist-info/LICENSE
--rw-r--r--  2.0 unx      604 b- defN 24-Mar-01 23:07 juliet-2.2.5.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Mar-01 23:07 juliet-2.2.5.dist-info/WHEEL
--rw-r--r--  2.0 unx       48 b- defN 24-Mar-01 23:07 juliet-2.2.5.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        7 b- defN 24-Mar-01 23:07 juliet-2.2.5.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     1156 b- defN 24-Mar-01 23:07 juliet-2.2.5.dist-info/RECORD
-15 files, 324135 bytes uncompressed, 58974 bytes compressed:  81.8%
+-rw-r--r--  2.0 unx    35383 b- defN 24-May-30 18:22 juliet/utils.py
+-rw-r--r--  2.0 unx     1548 b- defN 24-May-30 18:22 juliet-2.2.6.dist-info/AUTHORS.rst
+-rw-r--r--  2.0 unx     1084 b- defN 24-May-30 18:22 juliet-2.2.6.dist-info/LICENSE
+-rw-r--r--  2.0 unx      604 b- defN 24-May-30 18:22 juliet-2.2.6.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-30 18:22 juliet-2.2.6.dist-info/WHEEL
+-rw-r--r--  2.0 unx       48 b- defN 24-May-30 18:22 juliet-2.2.6.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        7 b- defN 24-May-30 18:22 juliet-2.2.6.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1156 b- defN 24-May-30 18:22 juliet-2.2.6.dist-info/RECORD
+15 files, 325634 bytes uncompressed, 59249 bytes compressed:  81.8%
```

## zipnote {}

```diff
@@ -18,29 +18,29 @@
 
 Filename: juliet/test_utils.py
 Comment: 
 
 Filename: juliet/utils.py
 Comment: 
 
-Filename: juliet-2.2.5.dist-info/AUTHORS.rst
+Filename: juliet-2.2.6.dist-info/AUTHORS.rst
 Comment: 
 
-Filename: juliet-2.2.5.dist-info/LICENSE
+Filename: juliet-2.2.6.dist-info/LICENSE
 Comment: 
 
-Filename: juliet-2.2.5.dist-info/METADATA
+Filename: juliet-2.2.6.dist-info/METADATA
 Comment: 
 
-Filename: juliet-2.2.5.dist-info/WHEEL
+Filename: juliet-2.2.6.dist-info/WHEEL
 Comment: 
 
-Filename: juliet-2.2.5.dist-info/entry_points.txt
+Filename: juliet-2.2.6.dist-info/entry_points.txt
 Comment: 
 
-Filename: juliet-2.2.5.dist-info/top_level.txt
+Filename: juliet-2.2.6.dist-info/top_level.txt
 Comment: 
 
-Filename: juliet-2.2.5.dist-info/RECORD
+Filename: juliet-2.2.6.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## juliet/_version.py

```diff
@@ -1 +1 @@
-__version__ = "2.2.5"
+__version__ = "2.2.6"
```

## juliet/fit.py

```diff
@@ -142,16270 +142,16363 @@
 000008d0: 2020 2020 290a 0a23 2049 6d70 6f72 7420      )..# Import 
 000008e0: 6765 6e65 7269 6320 7573 6566 756c 2063  generic useful c
 000008f0: 6c61 7373 6573 3a0a 696d 706f 7274 206f  lasses:.import o
 00000900: 730a 696d 706f 7274 2073 7973 0a69 6d70  s.import sys.imp
 00000910: 6f72 7420 6e75 6d70 7920 6173 206e 700a  ort numpy as np.
 00000920: 2320 5573 6566 756c 2069 6d70 6f72 7473  # Useful imports
 00000930: 2066 6f72 2070 6172 616c 6c65 6c69 7a61   for paralleliza
-00000940: 7469 6f6e 3a0a 6672 6f6d 206d 756c 7469  tion:.from multi
-00000950: 7072 6f63 6573 7369 6e67 2069 6d70 6f72  processing impor
-00000960: 7420 506f 6f6c 0a69 6d70 6f72 7420 636f  t Pool.import co
-00000970: 6e74 6578 746c 6962 0a0a 2320 4465 6669  ntextlib..# Defi
-00000980: 6e65 2063 6f6e 7374 616e 7473 206f 6e20  ne constants on 
-00000990: 7468 6520 636f 6465 3a0a 4720 3d20 362e  the code:.G = 6.
-000009a0: 3637 3430 3865 2d31 3120 2023 2047 7261  67408e-11  # Gra
-000009b0: 7669 7461 7469 6f6e 616c 2063 6f6e 7374  vitational const
-000009c0: 616e 742c 206d 6b73 0a6c 6f67 3270 6920  ant, mks.log2pi 
-000009d0: 3d20 6e70 2e6c 6f67 2832 2e20 2a20 6e70  = np.log(2. * np
-000009e0: 2e70 6929 2020 2320 6c6e 2832 2a70 6929  .pi)  # ln(2*pi)
-000009f0: 0a0a 2320 496d 706f 7274 2061 6c6c 2074  ..# Import all t
-00000a00: 6865 2075 7469 6c73 2066 756e 6374 696f  he utils functio
-00000a10: 6e73 3a0a 6672 6f6d 202e 7574 696c 7320  ns:.from .utils 
-00000a20: 696d 706f 7274 202a 0a0a 5f5f 616c 6c5f  import *..__all_
-00000a30: 5f20 3d20 5b27 6c6f 6164 272c 2027 6669  _ = ['load', 'fi
-00000a40: 7427 2c20 2767 6175 7373 6961 6e5f 7072  t', 'gaussian_pr
-00000a50: 6f63 6573 7327 2c20 276d 6f64 656c 275d  ocess', 'model']
-00000a60: 0a0a 636c 6173 7320 6c6f 6164 286f 626a  ..class load(obj
-00000a70: 6563 7429 3a0a 2020 2020 2222 220a 2020  ect):.    """.  
-00000a80: 2020 4769 7665 6e20 6120 6469 6374 696f    Given a dictio
-00000a90: 6e61 7279 2077 6974 6820 7072 696f 7273  nary with priors
-00000aa0: 2028 6f72 2061 2066 696c 656e 616d 6520   (or a filename 
-00000ab0: 706f 696e 7469 6e67 2074 6f20 6120 7072  pointing to a pr
-00000ac0: 696f 7220 6669 6c65 2920 616e 6420 6461  ior file) and da
-00000ad0: 7461 2065 6974 6865 7220 6769 7665 6e20  ta either given 
-00000ae0: 7468 726f 7567 6820 6172 7261 7973 0a20  through arrays. 
-00000af0: 2020 206f 7220 7468 726f 7567 6820 6669     or through fi
-00000b00: 6c65 7320 636f 6e74 6169 6e69 6e67 2074  les containing t
-00000b10: 6865 2064 6174 612c 2074 6869 7320 636c  he data, this cl
-00000b20: 6173 7320 6c6f 6164 7320 6461 7461 2069  ass loads data i
-00000b30: 6e74 6f20 6120 6a75 6c69 6574 206f 626a  nto a juliet obj
-00000b40: 6563 7420 7768 6963 6820 686f 6c64 7320  ect which holds 
-00000b50: 616c 6c20 7468 6520 696e 666f 726d 6174  all the informat
-00000b60: 696f 6e0a 2020 2020 6162 6f75 7420 7468  ion.    about th
-00000b70: 6520 6461 7461 7365 742e 2045 7861 6d70  e dataset. Examp
-00000b80: 6c65 2075 7361 6765 3a0a 0a20 2020 2020  le usage:..     
-00000b90: 2020 2020 2020 2020 2020 3e3e 3e20 6461            >>> da
-00000ba0: 7461 203d 206a 756c 6965 742e 6c6f 6164  ta = juliet.load
-00000bb0: 2870 7269 6f72 733d 7072 696f 7273 2c74  (priors=priors,t
-00000bc0: 5f6c 633d 7469 6d65 732c 795f 6c63 3d66  _lc=times,y_lc=f
-00000bd0: 6c75 7865 732c 7965 7272 5f6c 633d 666c  luxes,yerr_lc=fl
-00000be0: 7578 6573 5f65 7272 6f72 7329 0a0a 2020  uxes_errors)..  
-00000bf0: 2020 4f72 2c20 616c 736f 2c0a 0a20 2020    Or, also,..   
-00000c00: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00000c10: 6461 7461 203d 206a 756c 6965 742e 6c6f  data = juliet.lo
-00000c20: 6164 2869 6e70 7574 5f66 6f6c 6465 7220  ad(input_folder 
-00000c30: 3d20 666f 6c64 6572 290a 0a20 2020 203a  = folder)..    :
-00000c40: 7061 7261 6d20 7072 696f 7273 3a20 286f  param priors: (o
-00000c50: 7074 696f 6e61 6c2c 2064 6963 7420 6f72  ptional, dict or
-00000c60: 2073 7472 696e 6729 0a20 2020 2020 2020   string).       
-00000c70: 2054 6869 7320 6361 6e20 6265 2065 6974   This can be eit
-00000c80: 6865 7220 6120 7079 7468 6f6e 2060 6073  her a python ``s
-00000c90: 7472 696e 6760 6020 6f72 2061 2070 7974  tring`` or a pyt
-00000ca0: 686f 6e20 6060 6469 6374 6060 2e20 4966  hon ``dict``. If
-00000cb0: 2061 2060 6064 6963 7460 602c 2074 6869   a ``dict``, thi
-00000cc0: 7320 6861 7320 746f 2063 6f6e 7461 696e  s has to contain
-00000cd0: 2065 6163 6820 6f66 0a20 2020 2020 2020   each of.       
-00000ce0: 2074 6865 2070 6172 616d 6574 6572 7320   the parameters 
-00000cf0: 746f 2062 6520 6669 742c 2061 6c6f 6e67  to be fit, along
-00000d00: 2077 6974 6820 7468 6569 7220 7265 7370   with their resp
-00000d10: 6563 7469 7665 2070 7269 6f72 2064 6973  ective prior dis
-00000d20: 7472 6962 7574 696f 6e73 2061 6e64 2068  tributions and h
-00000d30: 7970 6572 7061 7261 6d65 7465 7273 2e20  yperparameters. 
-00000d40: 4561 6368 206b 6579 0a20 2020 2020 2020  Each key.       
-00000d50: 206f 6620 7468 6973 2064 6963 7469 6f6e   of this diction
-00000d60: 6172 7920 6861 7320 746f 2068 6176 6520  ary has to have 
-00000d70: 6120 7061 7261 6d65 7465 7220 6e61 6d65  a parameter name
-00000d80: 2028 652e 672e 2c20 6060 7231 5f70 3160   (e.g., ``r1_p1`
-00000d90: 602c 2060 6073 6967 6d61 5f77 5f54 4553  `, ``sigma_w_TES
-00000da0: 5360 6029 2c20 616e 6420 6561 6368 206f  S``), and each o
-00000db0: 660a 2020 2020 2020 2020 7468 6f73 6520  f.        those 
-00000dc0: 656c 656d 656e 7473 2061 7265 2c20 696e  elements are, in
-00000dd0: 2074 7572 6e2c 2064 6963 7469 6f6e 6172   turn, dictionar
-00000de0: 6965 7320 6173 2077 656c 6c20 636f 6e74  ies as well cont
-00000df0: 6169 6e69 6e67 2074 776f 206b 6579 733a  aining two keys:
-00000e00: 2061 2060 6064 6973 7472 6962 7574 696f   a ``distributio
-00000e10: 6e60 600a 2020 2020 2020 2020 6b65 7920  n``.        key 
-00000e20: 7768 6963 6820 6465 6669 6e65 7320 7468  which defines th
-00000e30: 6520 7072 696f 7220 6469 7374 7269 6275  e prior distribu
-00000e40: 7469 6f6e 206f 6620 7468 6520 7061 7261  tion of the para
-00000e50: 6d65 7465 7220 616e 6420 6120 6060 6879  meter and a ``hy
-00000e60: 7065 7270 6172 616d 6574 6572 7360 6020  perparameters`` 
-00000e70: 6b65 792c 0a20 2020 2020 2020 2077 6869  key,.        whi
-00000e80: 6368 2063 6f6e 7461 696e 7320 7468 6520  ch contains the 
-00000e90: 6879 7065 7270 6172 616d 6574 6572 7320  hyperparameters 
-00000ea0: 6f66 2074 6861 7420 6469 7374 7269 6275  of that distribu
-00000eb0: 7469 6f6e 2e0a 0a20 2020 2020 2020 2045  tion...        E
-00000ec0: 7861 6d70 6c65 2073 6574 7570 206f 6620  xample setup of 
-00000ed0: 7468 6520 6060 7072 696f 7273 6060 2064  the ``priors`` d
-00000ee0: 6963 7469 6f6e 6172 793a 0a20 2020 2020  ictionary:.     
-00000ef0: 2020 2020 2020 203e 3e3e 2070 7269 6f72         >>> prior
-00000f00: 7320 3d20 7b7d 0a20 2020 2020 2020 2020  s = {}.         
-00000f10: 2020 203e 3e3e 2070 7269 6f72 735b 2772     >>> priors['r
-00000f20: 315f 7031 275d 203d 207b 7d0a 2020 2020  1_p1'] = {}.    
-00000f30: 2020 2020 2020 2020 3e3e 3e20 7072 696f          >>> prio
-00000f40: 7273 5b27 7231 5f70 3127 5d5b 2764 6973  rs['r1_p1']['dis
-00000f50: 7472 6962 7574 696f 6e27 5d20 3d20 2755  tribution'] = 'U
-00000f60: 6e69 666f 726d 270a 2020 2020 2020 2020  niform'.        
-00000f70: 2020 2020 3e3e 3e20 7072 696f 7273 5b27      >>> priors['
-00000f80: 7231 5f70 3127 5d5b 2768 7970 6572 7061  r1_p1']['hyperpa
-00000f90: 7261 6d65 7465 7273 275d 203d 205b 302e  rameters'] = [0.
-00000fa0: 2c31 2e5d 0a0a 2020 2020 2020 2020 4966  ,1.]..        If
-00000fb0: 2061 2060 6073 7472 696e 6760 602c 2074   a ``string``, t
-00000fc0: 6869 7320 6861 7320 746f 2063 6f6e 7461  his has to conta
-00000fd0: 696e 2074 6865 2066 696c 656e 616d 6520  in the filename 
-00000fe0: 746f 2061 2070 726f 7065 7220 6a75 6c69  to a proper juli
-00000ff0: 6574 2070 7269 6f72 2066 696c 653b 2074  et prior file; t
-00001000: 6865 2070 7269 6f72 2060 6064 6963 7460  he prior ``dict`
-00001010: 6020 7769 6c6c 0a20 2020 2020 2020 2074  ` will.        t
-00001020: 6865 6e20 6265 2067 656e 6572 6174 6564  hen be generated
-00001030: 2066 726f 6d20 7468 6572 652e 2041 2070   from there. A p
-00001040: 726f 7065 7220 7072 696f 7220 6669 6c65  roper prior file
-00001050: 2068 6173 2069 6e20 7468 6520 6669 7273   has in the firs
-00001060: 7420 636f 6c75 6d6e 2074 6865 206e 616d  t column the nam
-00001070: 6520 6f66 2074 6865 2070 6172 616d 6574  e of the paramet
-00001080: 6572 2c0a 2020 2020 2020 2020 696e 2074  er,.        in t
-00001090: 6865 2073 6563 6f6e 6420 7468 6520 6e61  he second the na
-000010a0: 6d65 206f 6620 7468 6520 6469 7374 7269  me of the distri
-000010b0: 6275 7469 6f6e 2c20 616e 6420 696e 2074  bution, and in t
-000010c0: 6865 2074 6869 7264 2074 6865 2068 7970  he third the hyp
-000010d0: 6572 7061 7261 6d65 7465 7273 206f 6620  erparameters of 
-000010e0: 7468 6174 2064 6973 7472 6962 7574 696f  that distributio
-000010f0: 6e20 666f 720a 2020 2020 2020 2020 7468  n for.        th
-00001100: 6520 7061 7261 6d65 7465 722e 0a0a 2020  e parameter...  
-00001110: 2020 2020 2020 4e6f 7465 2074 6861 7420        Note that 
-00001120: 7468 6973 2061 6c6f 6e67 2077 6974 6820  this along with 
-00001130: 6569 7468 6572 206c 6967 6874 6375 7276  either lightcurv
-00001140: 6520 6f72 2052 5620 6461 7461 206f 7220  e or RV data or 
-00001150: 6120 6060 696e 7075 745f 666f 6c64 6572  a ``input_folder
-00001160: 6060 2068 6173 2074 6f20 6265 2067 6976  `` has to be giv
-00001170: 656e 2069 6e20 6f72 6465 7220 746f 2070  en in order to p
-00001180: 726f 7065 726c 790a 2020 2020 2020 2020  roperly.        
-00001190: 6c6f 6164 2061 206a 756c 6965 7420 6461  load a juliet da
-000011a0: 7461 206f 626a 6563 742e 0a0a 2020 2020  ta object...    
-000011b0: 3a70 6172 616d 2073 7461 7274 696e 675f  :param starting_
-000011c0: 706f 696e 743a 2028 6d61 6e64 6174 6f72  point: (mandator
-000011d0: 7920 6966 2075 7369 6e67 204d 434d 432c  y if using MCMC,
-000011e0: 2075 7365 6c65 7373 2069 6620 7573 696e   useless if usin
-000011f0: 6720 6e65 7374 6564 2073 616d 706c 6572  g nested sampler
-00001200: 732c 2064 6963 7429 0a20 2020 2020 2020  s, dict).       
-00001210: 2044 6963 7469 6f6e 6172 7920 696e 6469   Dictionary indi
-00001220: 6361 7469 6e67 2074 6865 2073 7461 7274  cating the start
-00001230: 696e 6720 7661 6c75 6520 6f66 2065 6163  ing value of eac
-00001240: 6820 6f66 2074 6865 2070 6172 616d 6574  h of the paramet
-00001250: 6572 7320 666f 7220 7468 6520 4d43 4d43  ers for the MCMC
-00001260: 2072 756e 2028 692e 652e 2c20 6375 7272   run (i.e., curr
-00001270: 656e 746c 7920 6f6e 6c79 206f 6620 7573  ently only of us
-00001280: 6520 666f 7220 6060 656d 6365 6560 6029  e for ``emcee``)
-00001290: 2e20 4b65 7973 2073 686f 756c 6420 6265  . Keys should be
-000012a0: 2063 6f6e 7369 7374 656e 7420 7769 7468   consistent with
-000012b0: 2074 6865 2060 6070 7269 6f72 6060 206e   the ``prior`` n
-000012c0: 616d 696e 6773 2061 626f 7665 3b0a 2020  amings above;.  
-000012d0: 2020 2020 2020 6561 6368 206b 6579 2073        each key s
-000012e0: 686f 756c 6420 6861 7665 2061 6e20 6173  hould have an as
-000012f0: 736f 6369 6174 6564 2066 6c6f 6174 2077  sociated float w
-00001300: 6974 6820 7468 6520 7374 6172 7469 6e67  ith the starting
-00001310: 2076 616c 7565 2e20 5468 6973 2069 7320   value. This is 
-00001320: 6f66 206e 6f20 7573 6520 6966 2075 7369  of no use if usi
-00001330: 6e67 206e 6573 7465 6420 7361 6d70 6c65  ng nested sample
-00001340: 7273 2028 7768 6963 6820 7361 6d70 6c65  rs (which sample
-00001350: 2064 6972 6563 746c 7920 6672 6f6d 2074   directly from t
-00001360: 6865 2070 7269 6f72 292e 0a0a 2020 2020  he prior)...    
-00001370: 3a70 6172 616d 2069 6e70 7574 5f66 6f6c  :param input_fol
-00001380: 6465 723a 2028 6f70 7469 6f6e 616c 2c20  der: (optional, 
-00001390: 7374 7269 6e67 290a 2020 2020 2020 2020  string).        
-000013a0: 5079 7468 6f6e 2060 6073 7472 696e 6760  Python ``string`
-000013b0: 6020 636f 6e74 6169 6e69 6e67 2074 6865  ` containing the
-000013c0: 2070 6174 6820 746f 2061 2066 6f6c 6465   path to a folde
-000013d0: 7220 636f 6e74 6169 6e69 6e67 2061 6c6c  r containing all
-000013e0: 2074 6865 2069 6e70 7574 2064 6174 6120   the input data 
-000013f0: 2d2d 2d20 7468 6973 2077 696c 6c20 7468  --- this will th
-00001400: 7573 2062 6520 6c6f 6164 2069 6e74 6f20  us be load into 
-00001410: 610a 2020 2020 2020 2020 6a75 6c69 6574  a.        juliet
-00001420: 2064 6174 6120 6f62 6a65 6374 2e20 5468   data object. Th
-00001430: 6973 2069 6e70 7574 2066 6f6c 6465 7220  is input folder 
-00001440: 6861 7320 746f 2063 6f6e 7461 696e 2061  has to contain a
-00001450: 7420 6c65 6173 7420 6120 6060 7072 696f  t least a ``prio
-00001460: 7273 2e64 6174 6060 2066 696c 6520 7769  rs.dat`` file wi
-00001470: 7468 2074 6865 2070 7269 6f72 7320 616e  th the priors an
-00001480: 6420 6569 7468 6572 2061 2060 606c 632e  d either a ``lc.
-00001490: 6461 7460 600a 2020 2020 2020 2020 6669  dat``.        fi
-000014a0: 6c65 2063 6f6e 7461 696e 696e 6720 6c69  le containing li
-000014b0: 6768 7463 7572 7665 2064 6174 6120 6f72  ghtcurve data or
-000014c0: 2061 2060 6072 7673 2e64 6174 6060 2066   a ``rvs.dat`` f
-000014d0: 696c 6520 636f 6e74 6169 6e69 6e67 2072  ile containing r
-000014e0: 6164 6961 6c2d 7665 6c6f 6369 7479 2064  adial-velocity d
-000014f0: 6174 612e 2049 6620 696e 2074 6869 7320  ata. If in this 
-00001500: 666f 6c64 6572 2061 2060 6047 505f 6c63  folder a ``GP_lc
-00001510: 5f72 6567 7265 7373 6f72 732e 6461 7460  _regressors.dat`
-00001520: 600a 2020 2020 2020 2020 6669 6c65 206f  `.        file o
-00001530: 7220 6120 6060 4750 5f72 765f 7265 6772  r a ``GP_rv_regr
-00001540: 6573 736f 7273 2e64 6174 6060 2066 696c  essors.dat`` fil
-00001550: 6520 6973 2066 6f75 6e64 2c20 6461 7461  e is found, data
-00001560: 2077 696c 6c20 6265 206c 6f61 6465 6420   will be loaded 
-00001570: 696e 746f 2074 6865 206a 756c 6965 7420  into the juliet 
-00001580: 6f62 6a65 6374 2061 7320 7765 6c6c 2e0a  object as well..
-00001590: 0a20 2020 2020 2020 204e 6f74 6520 7468  .        Note th
-000015a0: 6174 2061 7420 6c65 6173 7420 7468 6973  at at least this
-000015b0: 206f 7220 6120 6060 7072 696f 7273 6060   or a ``priors``
-000015c0: 2073 7472 696e 6720 6f72 2064 6963 7469   string or dicti
-000015d0: 6f6e 6172 792c 2061 6c6f 6e67 2077 6974  onary, along wit
-000015e0: 6820 6569 7468 6572 206c 6967 6874 6375  h either lightcu
-000015f0: 7276 6520 6f72 2052 5620 6461 7461 2068  rve or RV data h
-00001600: 6173 2074 6f20 6265 2067 6976 656e 0a20  as to be given. 
-00001610: 2020 2020 2020 2069 6e20 6f72 6465 7220         in order 
-00001620: 746f 2070 726f 7065 726c 7920 6c6f 6164  to properly load
-00001630: 2061 206a 756c 6965 7420 6461 7461 206f   a juliet data o
-00001640: 626a 6563 742e 0a0a 2020 2020 3a70 6172  bject...    :par
-00001650: 616d 2074 5f6c 633a 2028 6f70 7469 6f6e  am t_lc: (option
-00001660: 616c 2c20 6469 6374 696f 6e61 7279 290a  al, dictionary).
-00001670: 2020 2020 2020 2020 4469 6374 696f 6e61          Dictiona
-00001680: 7279 2077 686f 7365 206b 6579 7320 6172  ry whose keys ar
-00001690: 6520 696e 7374 7275 6d65 6e74 206e 616d  e instrument nam
-000016a0: 6573 3b20 6561 6368 206f 6620 7468 6f73  es; each of thos
-000016b0: 6520 6b65 7973 2069 7320 6578 7065 6374  e keys is expect
-000016c0: 6564 2074 6f20 6861 7665 2061 7272 6179  ed to have array
-000016d0: 7320 7769 7468 2074 6865 2074 696d 6573  s with the times
-000016e0: 2063 6f72 7265 7370 6f6e 6469 6e67 2074   corresponding t
-000016f0: 6f20 7468 6f73 6520 696e 7374 7275 6d65  o those instrume
-00001700: 6e74 732e 0a20 2020 2020 2020 2046 6f72  nts..        For
-00001710: 2065 7861 6d70 6c65 2c0a 2020 2020 2020   example,.      
-00001720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001730: 2020 2020 2020 2020 2020 2020 2020 3e3e                >>
-00001740: 3e20 745f 6c63 203d 207b 7d0a 2020 2020  > t_lc = {}.    
-00001750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001770: 3e3e 3e20 745f 6c63 5b27 5445 5353 275d  >>> t_lc['TESS']
-00001780: 203d 206e 702e 6c69 6e73 7061 6365 2830   = np.linspace(0
-00001790: 2c31 3030 2c31 3030 290a 0a20 2020 2020  ,100,100)..     
-000017a0: 2020 2049 7320 6120 7661 6c69 6420 696e     Is a valid in
-000017b0: 7075 7420 6469 6374 696f 6e61 7279 2066  put dictionary f
-000017c0: 6f72 2060 6074 5f6c 6360 602e 0a0a 2020  or ``t_lc``...  
-000017d0: 2020 3a70 6172 616d 2079 5f6c 633a 2028    :param y_lc: (
-000017e0: 6f70 7469 6f6e 616c 2c20 6469 6374 696f  optional, dictio
-000017f0: 6e61 7279 290a 2020 2020 2020 2020 5369  nary).        Si
-00001800: 6d69 6c61 726c 7920 746f 2060 6074 5f6c  milarly to ``t_l
-00001810: 6360 602c 2064 6963 7469 6f6e 6172 7920  c``, dictionary 
-00001820: 7768 6f73 6520 6b65 7973 2061 7265 2069  whose keys are i
-00001830: 6e73 7472 756d 656e 7420 6e61 6d65 733b  nstrument names;
-00001840: 2065 6163 6820 6f66 2074 686f 7365 206b   each of those k
-00001850: 6579 7320 6973 2065 7870 6563 7465 6420  eys is expected 
-00001860: 746f 2068 6176 6520 6172 7261 7973 2077  to have arrays w
-00001870: 6974 6820 7468 6520 666c 7578 6573 2063  ith the fluxes c
-00001880: 6f72 7265 7370 6f6e 6469 6e67 2074 6f20  orresponding to 
-00001890: 7468 6f73 6520 696e 7374 7275 6d65 6e74  those instrument
-000018a0: 732e 0a20 2020 2020 2020 2054 6865 7365  s..        These
-000018b0: 2061 7265 2065 7870 6563 7465 6420 746f   are expected to
-000018c0: 2062 6520 636f 6e73 6973 7465 6e74 2077   be consistent w
-000018d0: 6974 6820 7468 6520 6060 745f 6c63 6060  ith the ``t_lc``
-000018e0: 2064 6963 7469 6f6e 6172 6965 732e 0a0a   dictionaries...
-000018f0: 2020 2020 3a70 6172 616d 2079 6572 725f      :param yerr_
-00001900: 6c63 3a20 286f 7074 696f 6e61 6c2c 2064  lc: (optional, d
-00001910: 6963 7469 6f6e 6172 7929 0a20 2020 2020  ictionary).     
-00001920: 2020 2053 696d 696c 6172 6c79 2074 6f20     Similarly to 
-00001930: 6060 745f 6c63 6060 2c20 6469 6374 696f  ``t_lc``, dictio
-00001940: 6e61 7279 2077 686f 7365 206b 6579 7320  nary whose keys 
-00001950: 6172 6520 696e 7374 7275 6d65 6e74 206e  are instrument n
-00001960: 616d 6573 3b20 6561 6368 206f 6620 7468  ames; each of th
-00001970: 6f73 6520 6b65 7973 2069 7320 6578 7065  ose keys is expe
-00001980: 6374 6564 2074 6f20 6861 7665 2061 7272  cted to have arr
-00001990: 6179 7320 7769 7468 2074 6865 2065 7272  ays with the err
-000019a0: 6f72 7320 6f6e 2074 6865 2066 6c75 7865  ors on the fluxe
-000019b0: 7320 636f 7272 6573 706f 6e64 696e 6720  s corresponding 
-000019c0: 746f 2074 686f 7365 2069 6e73 7472 756d  to those instrum
-000019d0: 656e 7473 2e0a 2020 2020 2020 2020 5468  ents..        Th
-000019e0: 6573 6520 6172 6520 6578 7065 6374 6564  ese are expected
-000019f0: 2074 6f20 6265 2063 6f6e 7369 7374 656e   to be consisten
-00001a00: 7420 7769 7468 2074 6865 2060 6074 5f6c  t with the ``t_l
-00001a10: 6360 6020 6469 6374 696f 6e61 7269 6573  c`` dictionaries
-00001a20: 2e0a 0a20 2020 203a 7061 7261 6d20 4750  ...    :param GP
-00001a30: 5f72 6567 7265 7373 6f72 735f 6c63 3a20  _regressors_lc: 
-00001a40: 286f 7074 696f 6e61 6c2c 2064 6963 7469  (optional, dicti
-00001a50: 6f6e 6172 7929 0a20 2020 2020 2020 2044  onary).        D
-00001a60: 6963 7469 6f6e 6172 7920 7768 6f73 6520  ictionary whose 
-00001a70: 6b65 7973 2061 7265 206e 616d 6573 206f  keys are names o
-00001a80: 6620 696e 7374 7275 6d65 6e74 7320 7768  f instruments wh
-00001a90: 6572 6520 6120 4750 2069 7320 746f 2062  ere a GP is to b
-00001aa0: 6520 6669 742e 204f 6e20 6561 6368 206e  e fit. On each n
-00001ab0: 616d 652f 656c 656d 656e 742c 2061 6e20  ame/element, an 
-00001ac0: 6172 7261 7920 6f66 0a20 2020 2020 2020  array of.       
-00001ad0: 2072 6567 7265 7373 6f72 7320 6f66 2073   regressors of s
-00001ae0: 6861 7065 2060 6028 6d2c 6e29 6060 2063  hape ``(m,n)`` c
-00001af0: 6f6e 7461 696e 696e 6720 696e 2065 6163  ontaining in eac
-00001b00: 6820 636f 6c75 6d6e 2074 6865 2060 606e  h column the ``n
-00001b10: 6060 2047 5020 7265 6772 6573 736f 7273  `` GP regressors
-00001b20: 2074 6f20 6265 2075 7365 6420 666f 720a   to be used for.
-00001b30: 2020 2020 2020 2020 6060 6d60 6020 7068          ``m`` ph
-00001b40: 6f74 6f6d 6574 7269 6320 6d65 6173 7572  otometric measur
-00001b50: 656d 656e 7473 2068 6173 2074 6f20 6265  ements has to be
-00001b60: 2067 6976 656e 2e20 4e6f 7465 2074 6861   given. Note tha
-00001b70: 7420 6060 6d60 6020 666f 7220 6120 6769  t ``m`` for a gi
-00001b80: 7665 6e20 696e 7374 7275 6d65 6e74 2068  ven instrument h
-00001b90: 6173 2074 6f20 6265 206f 6620 7468 6520  as to be of the 
-00001ba0: 7361 6d65 206c 656e 6774 680a 2020 2020  same length.    
-00001bb0: 2020 2020 6173 2074 6865 2063 6f72 7265      as the corre
-00001bc0: 7370 6f6e 6469 6e67 2060 6074 5f6c 6360  sponding ``t_lc`
-00001bd0: 6020 666f 7220 7468 6174 2069 6e73 7472  ` for that instr
-00001be0: 756d 656e 742e 2041 6c73 6f2c 206e 6f74  ument. Also, not
-00001bf0: 6520 7468 6520 6f72 6465 7220 6f66 2065  e the order of e
-00001c00: 6163 6820 7265 6772 6573 736f 7220 6f66  ach regressor of
-00001c10: 2065 6163 6820 696e 7374 7275 6d65 6e74   each instrument
-00001c20: 2068 6173 2074 6f20 6d61 7463 680a 2020   has to match.  
-00001c30: 2020 2020 2020 7468 6520 636f 7272 6573        the corres
-00001c40: 706f 6e64 696e 6720 6f72 6465 7220 696e  ponding order in
-00001c50: 2074 6865 2060 6074 5f6c 6360 6020 6172   the ``t_lc`` ar
-00001c60: 7261 792e 0a20 2020 2020 2020 2046 6f72  ray..        For
-00001c70: 2065 7861 6d70 6c65 2c0a 0a20 2020 2020   example,..     
-00001c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001c90: 2020 2020 2020 2020 2020 2020 2020 203e                 >
-00001ca0: 3e3e 2047 505f 7265 6772 6573 736f 7273  >> GP_regressors
-00001cb0: 5f6c 6320 3d20 7b7d 0a20 2020 2020 2020  _lc = {}.       
-00001cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001cd0: 2020 2020 2020 2020 2020 2020 203e 3e3e               >>>
-00001ce0: 2047 505f 7265 6772 6573 736f 7273 5f6c   GP_regressors_l
-00001cf0: 635b 2754 4553 5327 5d20 3d20 6e70 2e6c  c['TESS'] = np.l
-00001d00: 696e 7370 6163 6528 2d31 2c31 2c31 3030  inspace(-1,1,100
-00001d10: 290a 0a20 2020 2020 2020 2049 6620 6120  )..        If a 
-00001d20: 676c 6f62 616c 206d 6f64 656c 2077 616e  global model wan
-00001d30: 7473 2074 6f20 6265 2075 7365 642c 2074  ts to be used, t
-00001d40: 6865 6e20 7468 6520 696e 7374 7275 6d65  hen the instrume
-00001d50: 6e74 2073 686f 756c 6420 6265 2060 6072  nt should be ``r
-00001d60: 7660 602c 2061 6e64 2065 6163 6820 6f66  v``, and each of
-00001d70: 2074 6865 2060 606d 6060 2072 6f77 7320   the ``m`` rows 
-00001d80: 7368 6f75 6c64 2063 6f72 7265 7370 6f6e  should correspon
-00001d90: 6420 746f 2074 6865 2060 606d 6060 2074  d to the ``m`` t
-00001da0: 696d 6573 2e0a 0a20 2020 203a 7061 7261  imes...    :para
-00001db0: 6d20 6c69 6e65 6172 5f72 6567 7265 7373  m linear_regress
-00001dc0: 6f72 735f 6c63 3a20 286f 7074 696f 6e61  ors_lc: (optiona
-00001dd0: 6c2c 2064 6963 7469 6f6e 6172 7929 0a20  l, dictionary). 
-00001de0: 2020 2020 2020 2053 696d 696c 6172 6c79         Similarly
-00001df0: 2061 7320 666f 7220 6060 4750 5f72 6567   as for ``GP_reg
-00001e00: 7265 7373 6f72 735f 6c63 6060 2c20 7468  ressors_lc``, th
-00001e10: 6973 2069 7320 6120 6469 6374 696f 6e61  is is a dictiona
-00001e20: 7279 2077 686f 7365 206b 6579 7320 6172  ry whose keys ar
-00001e30: 6520 6e61 6d65 7320 6f66 2069 6e73 7472  e names of instr
-00001e40: 756d 656e 7473 2077 6865 7265 2061 206c  uments where a l
-00001e50: 696e 6561 7220 7265 6772 6573 7369 6f6e  inear regression
-00001e60: 2069 7320 746f 2062 6520 6669 742e 0a20   is to be fit.. 
-00001e70: 2020 2020 2020 204f 6e20 6561 6368 206e         On each n
-00001e80: 616d 652f 656c 656d 656e 742c 2061 6e20  ame/element, an 
-00001e90: 6172 7261 7920 6f66 2073 6861 7065 2060  array of shape `
-00001ea0: 6028 712c 7029 6060 2063 6f6e 7461 696e  `(q,p)`` contain
-00001eb0: 696e 6720 696e 2065 6163 6820 636f 6c75  ing in each colu
-00001ec0: 6d6e 2074 6865 2060 6070 6060 206c 696e  mn the ``p`` lin
-00001ed0: 6561 7220 7265 6772 6573 736f 7273 2074  ear regressors t
-00001ee0: 6f20 6265 2075 7365 6420 666f 7220 7468  o be used for th
-00001ef0: 6520 6060 7160 600a 2020 2020 2020 2020  e ``q``.        
-00001f00: 7068 6f74 6f6d 6574 7269 6320 6d65 6173  photometric meas
-00001f10: 7572 656d 656e 7473 2e20 4167 6169 6e2c  urements. Again,
-00001f20: 206e 6f74 6520 7468 6520 6f72 6465 7220   note the order 
-00001f30: 6f66 2065 6163 6820 7265 6772 6573 736f  of each regresso
-00001f40: 7220 6f66 2065 6163 6820 696e 7374 7275  r of each instru
-00001f50: 6d65 6e74 2068 6173 2074 6f20 6d61 7463  ment has to matc
-00001f60: 6820 7468 6520 636f 7272 6573 706f 6e64  h the correspond
-00001f70: 696e 6720 6f72 6465 7220 696e 2074 6865  ing order in the
-00001f80: 2060 6074 5f6c 6360 6020 6172 7261 792e   ``t_lc`` array.
-00001f90: 0a0a 2020 2020 3a70 6172 616d 2047 505f  ..    :param GP_
-00001fa0: 7265 6772 6573 736f 7273 5f72 763a 2028  regressors_rv: (
-00001fb0: 6f70 7469 6f6e 616c 2c20 6469 6374 696f  optional, dictio
-00001fc0: 6e61 7279 290a 2020 2020 2020 2020 5361  nary).        Sa
-00001fd0: 6d65 2061 7320 6060 4750 5f72 6567 7265  me as ``GP_regre
-00001fe0: 7373 6f72 735f 6c63 6060 2062 7574 2066  ssors_lc`` but f
-00001ff0: 6f72 2074 6865 2072 6164 6961 6c2d 7665  or the radial-ve
-00002000: 6c6f 6369 7479 2064 6174 612e 2049 6620  locity data. If 
-00002010: 6120 676c 6f62 616c 206d 6f64 656c 2077  a global model w
-00002020: 616e 7473 2074 6f20 6265 2075 7365 642c  ants to be used,
-00002030: 2074 6865 6e20 7468 6520 696e 7374 7275   then the instru
-00002040: 6d65 6e74 2073 686f 756c 6420 6265 2060  ment should be `
-00002050: 606c 6360 602c 2061 6e64 2065 6163 6820  `lc``, and each 
-00002060: 6f66 2074 6865 2060 606d 6060 2072 6f77  of the ``m`` row
-00002070: 7320 7368 6f75 6c64 2063 6f72 7265 7370  s should corresp
-00002080: 6f6e 6420 746f 2074 6865 2060 606d 6060  ond to the ``m``
-00002090: 2074 696d 6573 2e0a 0a20 2020 203a 7061   times...    :pa
-000020a0: 7261 6d20 6c69 6e65 6172 5f72 6567 7265  ram linear_regre
-000020b0: 7373 6f72 735f 7276 3a20 286f 7074 696f  ssors_rv: (optio
-000020c0: 6e61 6c2c 2064 6963 7469 6f6e 6172 7929  nal, dictionary)
-000020d0: 0a20 2020 2020 2020 2053 616d 6520 6173  .        Same as
-000020e0: 2060 606c 696e 6561 725f 7265 6772 6573   ``linear_regres
-000020f0: 736f 7273 5f6c 6360 602c 2062 7574 2066  sors_lc``, but f
-00002100: 6f72 2074 6865 2072 6164 6961 6c2d 7665  or the radial-ve
-00002110: 6c6f 6369 7469 6573 2e0a 0a20 2020 203a  locities...    :
-00002120: 7061 7261 6d20 745f 7276 3a20 286f 7074  param t_rv: (opt
-00002130: 696f 6e61 6c2c 2064 6963 7469 6f6e 6172  ional, dictionar
-00002140: 7929 0a20 2020 2020 2020 2053 616d 6520  y).        Same 
-00002150: 6173 2060 6074 5f6c 6360 602c 2062 7574  as ``t_lc``, but
-00002160: 2066 6f72 2074 6865 2072 6164 6961 6c2d   for the radial-
-00002170: 7665 6c6f 6369 7469 6573 2e0a 0a20 2020  velocities...   
-00002180: 203a 7061 7261 6d20 795f 7276 3a20 286f   :param y_rv: (o
-00002190: 7074 696f 6e61 6c2c 2064 6963 7469 6f6e  ptional, diction
-000021a0: 6172 7929 0a20 2020 2020 2020 2053 616d  ary).        Sam
-000021b0: 6520 6173 2060 6079 5f6c 6360 602c 2062  e as ``y_lc``, b
-000021c0: 7574 2066 6f72 2074 6865 2072 6164 6961  ut for the radia
-000021d0: 6c2d 7665 6c6f 6369 7469 6573 2e0a 0a20  l-velocities... 
-000021e0: 2020 203a 7061 7261 6d20 7965 7272 5f72     :param yerr_r
-000021f0: 763a 2028 6f70 7469 6f6e 616c 2c20 6469  v: (optional, di
-00002200: 6374 696f 6e61 7279 290a 2020 2020 2020  ctionary).      
-00002210: 2020 5361 6d65 2061 7320 6060 7965 7272    Same as ``yerr
-00002220: 5f6c 6360 602c 2062 7574 2066 6f72 2074  _lc``, but for t
-00002230: 6865 2072 6164 6961 6c2d 7665 6c6f 6369  he radial-veloci
-00002240: 7469 6573 2e0a 0a20 2020 203a 7061 7261  ties...    :para
-00002250: 6d20 6f75 745f 666f 6c64 6572 3a20 286f  m out_folder: (o
-00002260: 7074 696f 6e61 6c2c 2073 7472 696e 6729  ptional, string)
-00002270: 0a20 2020 2020 2020 2049 6620 6120 7061  .        If a pa
-00002280: 7468 2069 7320 6769 7665 6e2c 2072 6573  th is given, res
-00002290: 756c 7473 2077 696c 6c20 6265 2073 6176  ults will be sav
-000022a0: 6564 2074 6f20 7468 6174 2070 6174 6820  ed to that path 
-000022b0: 6173 2061 2060 6070 6963 6b6c 6560 6020  as a ``pickle`` 
-000022c0: 6669 6c65 2c20 616c 6f6e 6720 7769 7468  file, along with
-000022d0: 2061 6c6c 2069 6e70 7574 7320 696e 2074   all inputs in t
-000022e0: 6865 2073 7461 6e64 6172 6420 6a75 6c69  he standard juli
-000022f0: 6574 2066 6f72 6d61 742e 0a0a 2020 2020  et format...    
-00002300: 3a70 6172 616d 206c 6366 696c 656e 616d  :param lcfilenam
-00002310: 653a 2020 286f 7074 696f 6e61 6c2c 2073  e:  (optional, s
-00002320: 7472 696e 6729 0a20 2020 2020 2020 2049  tring).        I
-00002330: 6620 6120 7061 7468 2074 6f20 6120 6c69  f a path to a li
-00002340: 6768 7463 7572 7665 2066 696c 6520 6973  ghtcurve file is
-00002350: 2067 6976 656e 2c20 6060 745f 6c63 6060   given, ``t_lc``
-00002360: 2c20 6060 795f 6c63 6060 2c20 6060 7965  , ``y_lc``, ``ye
-00002370: 7272 5f6c 6360 6020 616e 6420 6060 696e  rr_lc`` and ``in
-00002380: 7374 7275 6d65 6e74 735f 6c63 6060 2077  struments_lc`` w
-00002390: 696c 6c20 6265 2072 6561 6420 6672 6f6d  ill be read from
-000023a0: 2074 6865 7265 2e20 5468 6520 6261 7369   there. The basi
-000023b0: 6320 6669 6c65 2066 6f72 6d61 7420 6973  c file format is
-000023c0: 2061 2070 7572 650a 2020 2020 2020 2020   a pure.        
-000023d0: 6173 6369 6920 6669 6c65 2077 6865 7265  ascii file where
-000023e0: 2074 696d 6573 2061 7265 2069 6e20 7468   times are in th
-000023f0: 6520 6669 7273 7420 636f 6c75 6d6e 2c20  e first column, 
-00002400: 7265 6c61 7469 7665 2066 6c75 7865 7320  relative fluxes 
-00002410: 696e 2074 6865 2073 6563 6f6e 642c 2065  in the second, e
-00002420: 7272 6f72 7320 696e 2074 6865 2074 6869  rrors in the thi
-00002430: 7264 2061 6e64 2069 6e73 7472 756d 656e  rd and instrumen
-00002440: 7420 6e61 6d65 7320 696e 2074 6865 2066  t names in the f
-00002450: 6f75 7274 682e 2049 6620 6d6f 7265 2063  ourth. If more c
-00002460: 6f6c 756d 6e73 2061 7265 2067 6976 656e  olumns are given
-00002470: 2066 6f72 0a20 2020 2020 2020 2061 2067   for.        a g
-00002480: 6976 656e 2069 6e73 7472 756d 656e 742c  iven instrument,
-00002490: 2074 686f 7365 2077 696c 6c20 6265 2069   those will be i
-000024a0: 6465 6e74 6966 6965 6420 6173 206c 696e  dentified as lin
-000024b0: 6561 7220 7265 6772 6573 736f 7273 2066  ear regressors f
-000024c0: 6f72 2074 686f 7365 2069 6e73 7472 756d  or those instrum
-000024d0: 656e 7473 2e0a 0a20 2020 203a 7061 7261  ents...    :para
-000024e0: 6d20 7276 6669 6c65 6e61 6d65 3a20 286f  m rvfilename: (o
-000024f0: 7074 696f 6e61 6c2c 2073 7472 696e 6729  ptional, string)
-00002500: 0a20 2020 2020 2020 2053 616d 6520 6173  .        Same as
-00002510: 2060 606c 6366 696c 656e 616d 6560 602c   ``lcfilename``,
-00002520: 2062 7574 2066 6f72 2074 6865 2072 6164   but for the rad
-00002530: 6961 6c2d 7665 6c6f 6369 7469 6573 2e0a  ial-velocities..
-00002540: 0a20 2020 203a 7061 7261 6d20 4750 6c63  .    :param GPlc
-00002550: 6570 6172 616d 6669 6c65 3a20 286f 7074  eparamfile: (opt
-00002560: 696f 6e61 6c2c 2073 7472 696e 6729 0a20  ional, string). 
-00002570: 2020 2020 2020 2049 6620 6120 7061 7468         If a path
-00002580: 2074 6f20 6120 6669 6c65 2069 7320 6769   to a file is gi
-00002590: 7665 6e2c 2074 6865 2063 6f6c 756d 6e73  ven, the columns
-000025a0: 206f 6620 7468 6174 2066 696c 6520 7769   of that file wi
-000025b0: 6c6c 2062 6520 7573 6564 2061 7320 4750  ll be used as GP
-000025c0: 2072 6567 7265 7373 6f72 7320 666f 7220   regressors for 
-000025d0: 7468 6520 6c69 6768 7463 7572 7665 2066  the lightcurve f
-000025e0: 6974 2e20 5468 6520 6669 6c65 2066 6f72  it. The file for
-000025f0: 6d61 7420 6973 2061 2070 7572 6520 6173  mat is a pure as
-00002600: 6369 6920 6669 6c65 0a20 2020 2020 2020  cii file.       
-00002610: 2077 6865 7265 2072 6567 7265 7373 6f72   where regressor
-00002620: 7320 6172 6520 6769 7665 6e20 696e 2064  s are given in d
-00002630: 6966 6665 7265 6e74 2063 6f6c 756d 6e73  ifferent columns
-00002640: 2c20 616e 6420 7468 6520 6c61 7374 2063  , and the last c
-00002650: 6f6c 756d 6e20 686f 6c64 7320 7468 6520  olumn holds the 
-00002660: 696e 7374 7275 6d65 6e74 206e 616d 652e  instrument name.
-00002670: 2054 6865 206f 7264 6572 206f 6620 7468   The order of th
-00002680: 6973 2066 696c 6520 6861 7320 746f 2062  is file has to b
-00002690: 6520 636f 6e73 6973 7465 6e74 2077 6974  e consistent wit
-000026a0: 680a 2020 2020 2020 2020 6060 745f 6c63  h.        ``t_lc
-000026b0: 6060 2061 6e64 2f6f 7220 7468 6520 6060  `` and/or the ``
-000026c0: 6c63 6669 6c65 6e61 6d65 6060 2066 696c  lcfilename`` fil
-000026d0: 652e 2049 6620 6120 676c 6f62 616c 206d  e. If a global m
-000026e0: 6f64 656c 2077 616e 7473 2074 6f20 6265  odel wants to be
-000026f0: 2075 7365 642c 2073 6574 2074 6865 2069   used, set the i
-00002700: 6e73 7472 756d 656e 7420 6e61 6d65 7320  nstrument names 
-00002710: 6f66 2061 6c6c 2072 6567 7265 7373 6f72  of all regressor
-00002720: 7320 746f 2060 606c 6360 602e 0a0a 2020  s to ``lc``...  
-00002730: 2020 3a70 6172 616d 2047 5072 7665 7061    :param GPrvepa
-00002740: 7261 6d66 696c 653a 2028 6f70 7469 6f6e  ramfile: (option
-00002750: 616c 2c20 7374 7269 6e67 290a 2020 2020  al, string).    
-00002760: 2020 2020 5361 6d65 2061 7320 6060 4750      Same as ``GP
-00002770: 6c63 6570 6172 616d 6669 6c65 6060 2062  lceparamfile`` b
-00002780: 7574 2066 6f72 2074 6865 2072 6164 6961  ut for the radia
-00002790: 6c2d 7665 6c6f 6369 7469 6573 2e20 4966  l-velocities. If
-000027a0: 2061 2067 6c6f 6261 6c20 6d6f 6465 6c20   a global model 
-000027b0: 7761 6e74 7320 746f 2062 6520 7573 6564  wants to be used
-000027c0: 2c20 7365 7420 7468 6520 696e 7374 7275  , set the instru
-000027d0: 6d65 6e74 206e 616d 6573 206f 6620 616c  ment names of al
-000027e0: 6c20 7265 6772 6573 736f 7273 2074 6f20  l regressors to 
-000027f0: 6060 7276 6060 2e0a 0a20 2020 203a 7061  ``rv``...    :pa
-00002800: 7261 6d20 4c4d 6c63 6570 6172 616d 6669  ram LMlceparamfi
-00002810: 6c65 3a20 286f 7074 696f 6e61 6c2c 2073  le: (optional, s
-00002820: 7472 696e 6729 0a20 2020 2020 2020 2049  tring).        I
-00002830: 6620 6120 7061 7468 2074 6f20 6120 6669  f a path to a fi
-00002840: 6c65 2069 7320 6769 7665 6e2c 2074 6865  le is given, the
-00002850: 2063 6f6c 756d 6e73 206f 6620 7468 6174   columns of that
-00002860: 2066 696c 6520 7769 6c6c 2062 6520 7573   file will be us
-00002870: 6564 2061 7320 6c69 6e65 6172 2072 6567  ed as linear reg
-00002880: 7265 7373 6f72 7320 666f 7220 7468 6520  ressors for the 
-00002890: 6c69 6768 7463 7572 7665 2066 6974 2e20  lightcurve fit. 
-000028a0: 5468 6520 6669 6c65 2066 6f72 6d61 7420  The file format 
-000028b0: 6973 2061 2070 7572 6520 6173 6369 6920  is a pure ascii 
-000028c0: 6669 6c65 0a20 2020 2020 2020 2077 6865  file.        whe
-000028d0: 7265 2072 6567 7265 7373 6f72 7320 6172  re regressors ar
-000028e0: 6520 6769 7665 6e20 696e 2064 6966 6665  e given in diffe
-000028f0: 7265 6e74 2063 6f6c 756d 6e73 2c20 616e  rent columns, an
-00002900: 6420 7468 6520 6c61 7374 2063 6f6c 756d  d the last colum
-00002910: 6e20 686f 6c64 7320 7468 6520 696e 7374  n holds the inst
-00002920: 7275 6d65 6e74 206e 616d 652e 2054 6865  rument name. The
-00002930: 206f 7264 6572 206f 6620 7468 6973 2066   order of this f
-00002940: 696c 6520 6861 7320 746f 2062 6520 636f  ile has to be co
-00002950: 6e73 6973 7465 6e74 2077 6974 680a 2020  nsistent with.  
-00002960: 2020 2020 2020 6060 745f 6c63 6060 2061        ``t_lc`` a
-00002970: 6e64 2f6f 7220 7468 6520 6060 6c63 6669  nd/or the ``lcfi
-00002980: 6c65 6e61 6d65 6060 2066 696c 652e 2049  lename`` file. I
-00002990: 6620 6120 676c 6f62 616c 206d 6f64 656c  f a global model
-000029a0: 2077 616e 7473 2074 6f20 6265 2075 7365   wants to be use
-000029b0: 642c 2073 6574 2074 6865 2069 6e73 7472  d, set the instr
-000029c0: 756d 656e 7420 6e61 6d65 7320 6f66 2061  ument names of a
-000029d0: 6c6c 2072 6567 7265 7373 6f72 7320 746f  ll regressors to
-000029e0: 2060 606c 6360 602e 0a0a 2020 2020 3a70   ``lc``...    :p
-000029f0: 6172 616d 204c 4d72 7665 7061 7261 6d66  aram LMrveparamf
-00002a00: 696c 653a 2028 6f70 7469 6f6e 616c 2c20  ile: (optional, 
-00002a10: 7374 7269 6e67 290a 2020 2020 2020 2020  string).        
-00002a20: 5361 6d65 2061 7320 6060 4c4d 6c63 6570  Same as ``LMlcep
-00002a30: 6172 616d 6669 6c65 6060 2062 7574 2066  aramfile`` but f
-00002a40: 6f72 2074 6865 2072 6164 6961 6c2d 7665  or the radial-ve
-00002a50: 6c6f 6369 7469 6573 2e20 4966 2061 2067  locities. If a g
-00002a60: 6c6f 6261 6c20 6d6f 6465 6c20 7761 6e74  lobal model want
-00002a70: 7320 746f 2062 6520 7573 6564 2c20 7365  s to be used, se
-00002a80: 7420 7468 6520 696e 7374 7275 6d65 6e74  t the instrument
-00002a90: 206e 616d 6573 206f 6620 616c 6c20 7265   names of all re
-00002aa0: 6772 6573 736f 7273 2074 6f20 6060 7276  gressors to ``rv
-00002ab0: 6060 2e0a 0a20 2020 203a 7061 7261 6d20  ``...    :param 
-00002ac0: 6c63 7469 6d65 6465 663a 2028 6f70 7469  lctimedef: (opti
-00002ad0: 6f6e 616c 2c20 7374 7269 6e67 290a 2020  onal, string).  
-00002ae0: 2020 2020 2020 5469 6d65 2064 6566 696e        Time defin
-00002af0: 6974 696f 6e73 2066 6f72 2065 6163 6820  itions for each 
-00002b00: 6f66 2074 6865 206c 6967 6874 6375 7276  of the lightcurv
-00002b10: 6520 696e 7374 7275 6d65 6e74 732e 2044  e instruments. D
-00002b20: 6566 6175 6c74 2069 7320 746f 2061 7373  efault is to ass
-00002b30: 756d 6520 616c 6c20 696e 7374 7275 6d65  ume all instrume
-00002b40: 6e74 7320 2869 6e20 6c63 7320 616e 6420  nts (in lcs and 
-00002b50: 7276 7329 2068 6176 6520 7468 6520 7361  rvs) have the sa
-00002b60: 6d65 2074 696d 6520 6465 6669 6e69 7469  me time definiti
-00002b70: 6f6e 732e 2049 6620 6d6f 7265 2074 6861  ons. If more tha
-00002b80: 6e20 6f6e 6520 696e 7374 7275 6d65 6e74  n one instrument
-00002b90: 2069 7320 6769 7665 6e2c 2074 6869 7320   is given, this 
-00002ba0: 7374 7269 6e67 0a20 2020 2020 2020 2073  string.        s
-00002bb0: 686f 756c 6420 6861 7665 2069 6e73 7472  hould have instr
-00002bc0: 756d 656e 7473 2061 6e64 2074 696d 652d  uments and time-
-00002bd0: 6465 6669 6e69 7469 6f6e 7320 7365 7061  definitions sepa
-00002be0: 7261 7465 6420 6279 2063 6f6d 6d61 732c  rated by commas,
-00002bf0: 2065 2e67 2e2c 2060 6054 4553 532d 5444   e.g., ``TESS-TD
-00002c00: 422c 204c 434f 4754 2d55 5443 6060 2c20  B, LCOGT-UTC``, 
-00002c10: 6574 632e 0a0a 2020 2020 3a70 6172 616d  etc...    :param
-00002c20: 2072 7674 696d 6564 6566 3a20 286f 7074   rvtimedef: (opt
-00002c30: 696f 6e61 6c2c 2073 7472 696e 6729 0a20  ional, string). 
-00002c40: 2020 2020 2020 2054 696d 6520 6465 6669         Time defi
-00002c50: 6e69 7469 6f6e 7320 666f 7220 6561 6368  nitions for each
-00002c60: 206f 6620 7468 6520 7261 6469 616c 2d76   of the radial-v
-00002c70: 656c 6f63 6974 7920 696e 7374 7275 6d65  elocity instrume
-00002c80: 6e74 732e 2044 6566 6175 6c74 2069 7320  nts. Default is 
-00002c90: 746f 2061 7373 756d 6520 616c 6c20 696e  to assume all in
-00002ca0: 7374 7275 6d65 6e74 7320 2869 6e20 6c63  struments (in lc
-00002cb0: 7320 616e 6420 7276 7329 2068 6176 6520  s and rvs) have 
-00002cc0: 7468 6520 7361 6d65 2074 696d 6520 6465  the same time de
-00002cd0: 6669 6e69 7469 6f6e 732e 2049 6620 6d6f  finitions. If mo
-00002ce0: 7265 2074 6861 6e20 6f6e 6520 696e 7374  re than one inst
-00002cf0: 7275 6d65 6e74 2069 7320 6769 7665 6e2c  rument is given,
-00002d00: 0a20 2020 2020 2020 2074 6869 7320 7374  .        this st
-00002d10: 7269 6e67 2073 686f 756c 6420 6861 7665  ring should have
-00002d20: 2069 6e73 7472 756d 656e 7473 2061 6e64   instruments and
-00002d30: 2074 696d 652d 6465 6669 6e69 7469 6f6e   time-definition
-00002d40: 7320 7365 7061 7261 7465 6420 6279 2063  s separated by c
-00002d50: 6f6d 6d61 732c 2065 2e67 2e2c 2060 6046  ommas, e.g., ``F
-00002d60: 4552 4f53 2d54 4442 2c20 4841 5250 532d  EROS-TDB, HARPS-
-00002d70: 5554 4360 602c 2065 7463 2e0a 0a20 2020  UTC``, etc...   
-00002d80: 203a 7061 7261 6d20 6c64 5f6c 6177 733a   :param ld_laws:
-00002d90: 2028 6f70 7469 6f6e 616c 2c20 7374 7269   (optional, stri
-00002da0: 6e67 290a 2020 2020 2020 2020 4c69 6d62  ng).        Limb
-00002db0: 2d64 6172 6b65 6e69 6e67 206c 6177 2074  -darkening law t
-00002dc0: 6f20 6265 2075 7365 6420 666f 7220 6561  o be used for ea
-00002dd0: 6368 2069 6e73 7472 756d 656e 742e 2044  ch instrument. D
-00002de0: 6566 6175 6c74 2069 7320 6060 7175 6164  efault is ``quad
-00002df0: 7261 7469 6360 6020 666f 7220 616c 6c20  ratic`` for all 
-00002e00: 696e 7374 7275 6d65 6e74 732e 2049 6620  instruments. If 
-00002e10: 6d6f 7265 2074 6861 6e20 6f6e 6520 696e  more than one in
-00002e20: 7374 7275 6d65 6e74 2069 7320 6769 7665  strument is give
-00002e30: 6e2c 0a20 2020 2020 2020 2074 6869 7320  n,.        this 
-00002e40: 7374 7269 6e67 2073 686f 756c 6420 6861  string should ha
-00002e50: 7665 2069 6e73 7472 756d 656e 7473 2061  ve instruments a
-00002e60: 6e64 206c 696d 622d 6461 726b 656e 696e  nd limb-darkenin
-00002e70: 6720 6c61 7773 2073 6570 6172 6174 6564  g laws separated
-00002e80: 2062 7920 636f 6d6d 6173 2c20 652e 672e   by commas, e.g.
-00002e90: 2c20 6060 5445 5353 2d71 7561 6472 6174  , ``TESS-quadrat
-00002ea0: 6963 2c20 4c43 4f47 542d 6c69 6e65 6172  ic, LCOGT-linear
-00002eb0: 6060 2e0a 0a20 2020 203a 7061 7261 6d20  ``...    :param 
-00002ec0: 7072 696f 7266 696c 653a 2028 6f70 7469  priorfile: (opti
-00002ed0: 6f6e 616c 2c20 7374 7269 6e67 290a 2020  onal, string).  
-00002ee0: 2020 2020 2020 4966 2061 2070 6174 6820        If a path 
-00002ef0: 746f 2061 2066 696c 6520 6973 2067 6976  to a file is giv
-00002f00: 656e 2c20 6974 2077 696c 6c20 6265 2061  en, it will be a
-00002f10: 7373 756d 6564 2074 6869 7320 6973 2061  ssumed this is a
-00002f20: 2070 7269 6f72 2066 696c 652e 2054 6865   prior file. The
-00002f30: 2060 6070 7269 6f72 7360 6020 6469 6374   ``priors`` dict
-00002f40: 696f 6e61 7279 2077 696c 6c20 6265 206f  ionary will be o
-00002f50: 7665 7277 7269 7474 656e 2062 7920 7468  verwritten by th
-00002f60: 6520 6461 7461 2069 6e20 7468 6973 0a20  e data in this. 
-00002f70: 2020 2020 2020 2066 696c 652e 2054 6865         file. The
-00002f80: 2066 696c 6520 7374 7275 6374 7572 6520   file structure 
-00002f90: 6973 2061 2070 6c61 696e 2061 7363 6969  is a plain ascii
-00002fa0: 2066 696c 652c 2077 6974 6820 7468 6520   file, with the 
-00002fb0: 6e61 6d65 206f 6620 7468 6520 7061 7261  name of the para
-00002fc0: 6d65 7465 7273 2069 6e20 7468 6520 6669  meters in the fi
-00002fd0: 7273 7420 636f 6c75 6d6e 2c20 6e61 6d65  rst column, name
-00002fe0: 206f 6620 7468 6520 7072 696f 7220 6469   of the prior di
-00002ff0: 7374 7269 6275 7469 6f6e 2069 6e20 7468  stribution in th
-00003000: 650a 2020 2020 2020 2020 7365 636f 6e64  e.        second
-00003010: 2063 6f6c 756d 6e20 616e 6420 6879 7065   column and hype
-00003020: 7270 6172 616d 6574 6572 7320 696e 2074  rparameters in t
-00003030: 6865 2074 6869 7264 2063 6f6c 756d 6e2e  he third column.
-00003040: 0a0a 2020 2020 3a70 6172 616d 206c 635f  ..    :param lc_
-00003050: 696e 7374 7275 6d65 6e74 5f73 7570 6572  instrument_super
-00003060: 7361 6d70 3a20 286f 7074 696f 6e61 6c2c  samp: (optional,
-00003070: 2061 7272 6179 206f 6620 7374 7269 6e67   array of string
-00003080: 7329 0a20 2020 2020 2020 2044 6566 696e  s).        Defin
-00003090: 6520 666f 7220 7768 6963 6820 6c69 6768  e for which ligh
-000030a0: 7463 7572 7665 2069 6e73 7472 756d 656e  tcurve instrumen
-000030b0: 7473 2073 7570 6572 2d73 616d 706c 696e  ts super-samplin
-000030c0: 6720 7769 6c6c 2062 6520 6170 706c 6965  g will be applie
-000030d0: 6420 2865 2e67 2e2c 2069 6e20 7468 6520  d (e.g., in the 
-000030e0: 6361 7365 206f 6620 6c6f 6e67 2d63 6164  case of long-cad
-000030f0: 656e 6365 2069 6e74 6567 7261 7469 6f6e  ence integration
-00003100: 7329 2e20 652e 672e 2c20 6060 6c63 5f69  s). e.g., ``lc_i
-00003110: 6e73 7472 756d 656e 745f 7375 7065 7273  nstrument_supers
-00003120: 616d 7020 3d20 5b27 5445 5353 272c 274b  amp = ['TESS','K
-00003130: 3227 5d60 600a 0a20 2020 203a 7061 7261  2']``..    :para
-00003140: 6d20 6c63 5f6e 5f73 7570 6572 7361 6d70  m lc_n_supersamp
-00003150: 3a20 286f 7074 696f 6e61 6c2c 2061 7272  : (optional, arr
-00003160: 6179 206f 6620 696e 7473 290a 2020 2020  ay of ints).    
-00003170: 2020 2020 4465 6669 6e65 2074 6865 206e      Define the n
-00003180: 756d 6265 7220 6f66 2064 6174 6170 6f69  umber of datapoi
-00003190: 6e74 7320 746f 2073 7570 6572 7361 6d70  nts to supersamp
-000031a0: 6c65 2e20 4f72 6465 7220 7368 6f75 6c64  le. Order should
-000031b0: 2062 6520 636f 6e73 6973 7465 6e74 2077   be consistent w
-000031c0: 6974 6820 6f72 6465 7220 696e 2060 606c  ith order in ``l
-000031d0: 635f 696e 7374 7275 6d65 6e74 5f73 7570  c_instrument_sup
-000031e0: 6572 7361 6d70 6060 2e20 652e 672e 2c20  ersamp``. e.g., 
-000031f0: 6060 6c63 5f6e 5f73 7570 6572 7361 6d70  ``lc_n_supersamp
-00003200: 203d 205b 3230 2c33 305d 6060 2e0a 0a20   = [20,30]``... 
-00003210: 2020 203a 7061 7261 6d20 6c63 5f65 7870     :param lc_exp
-00003220: 7469 6d65 5f73 7570 6572 7361 6d70 3a20  time_supersamp: 
-00003230: 286f 7074 696f 6e61 6c2c 2061 7272 6179  (optional, array
-00003240: 206f 6620 666c 6f61 7473 290a 2020 2020   of floats).    
-00003250: 2020 2020 4465 6669 6e65 2074 6865 2065      Define the e
-00003260: 7870 6f73 7572 652d 7469 6d65 206f 6620  xposure-time of 
-00003270: 7468 6520 6f62 7365 7276 6174 696f 6e73  the observations
-00003280: 2066 6f72 2074 6865 2073 7570 6572 7361   for the supersa
-00003290: 6d70 6c69 6e67 2e20 4f72 6465 7220 7368  mpling. Order sh
-000032a0: 6f75 6c64 2062 6520 636f 6e73 6973 7465  ould be consiste
-000032b0: 6e74 2077 6974 6820 6f72 6465 7220 696e  nt with order in
-000032c0: 2060 606c 635f 696e 7374 7275 6d65 6e74   ``lc_instrument
-000032d0: 5f73 7570 6572 7361 6d70 6060 2e20 652e  _supersamp``. e.
-000032e0: 672e 2c20 6060 6c63 5f65 7870 7469 6d65  g., ``lc_exptime
-000032f0: 5f73 7570 6572 7361 6d70 203d 205b 302e  _supersamp = [0.
-00003300: 3032 3034 3334 2c30 2e30 3230 3433 345d  020434,0.020434]
-00003310: 6060 0a0a 2020 2020 3a70 6172 616d 2076  ``..    :param v
-00003320: 6572 626f 7365 3a20 286f 7074 696f 6e61  erbose: (optiona
-00003330: 6c2c 2062 6f6f 6c65 616e 290a 2020 2020  l, boolean).    
-00003340: 2020 2020 4966 2054 7275 652c 2061 6c6c      If True, all
-00003350: 206f 7574 7075 7473 206f 6620 7468 6520   outputs of the 
-00003360: 636f 6465 2061 7265 2070 7269 6e74 6564  code are printed
-00003370: 2074 6f20 7465 726d 696e 616c 2e20 4465   to terminal. De
-00003380: 6661 756c 7420 6973 2046 616c 7365 2e0a  fault is False..
-00003390: 0a20 2020 203a 7061 7261 6d20 6d61 7465  .    :param mate
-000033a0: 726e 5f65 7073 3a20 286f 7074 696f 6e61  rn_eps: (optiona
-000033b0: 6c2c 2066 6c6f 6174 290a 2020 2020 2020  l, float).      
-000033c0: 2020 4570 7369 6c6f 6e20 7061 7261 6d65    Epsilon parame
-000033d0: 7465 7220 666f 7220 7468 6520 4d61 7465  ter for the Mate
-000033e0: 726e 2061 7070 726f 7869 6d61 7469 6f6e  rn approximation
-000033f0: 2028 7365 6520 6365 6c65 7269 7465 2064   (see celerite d
-00003400: 6f63 756d 656e 7461 7469 6f6e 292e 0a0a  ocumentation)...
-00003410: 2020 2020 3a70 6172 616d 2067 656f 7267      :param georg
-00003420: 655f 686f 646c 723a 2028 6f70 7469 6f6e  e_hodlr: (option
-00003430: 616c 2c20 626f 6f6c 290a 2020 2020 2020  al, bool).      
-00003440: 2020 466c 6167 2074 6f20 6465 6669 6e65    Flag to define
-00003450: 2069 6620 796f 7520 7761 6e74 2074 6f20   if you want to 
-00003460: 7573 6520 7468 6520 484f 444c 5220 736f  use the HODLR so
-00003470: 6c76 6572 2066 6f72 2067 656f 7267 6520  lver for george 
-00003480: 4750 2773 206f 7220 6e6f 7420 2873 6565  GP's or not (see
-00003490: 2068 7474 703a 2f2f 6466 6d2e 696f 2f67   http://dfm.io/g
-000034a0: 656f 7267 652f 6375 7272 656e 742f 7573  eorge/current/us
-000034b0: 6572 2f73 6f6c 7665 7273 2f29 2e0a 0a20  er/solvers/)... 
-000034c0: 2020 203a 7061 7261 6d20 7069 636b 6c65     :param pickle
-000034d0: 5f65 6e63 6f64 696e 673a 2028 6f70 7469  _encoding: (opti
-000034e0: 6f6e 616c 2c20 7374 7269 6e67 290a 2020  onal, string).  
-000034f0: 2020 2020 2020 4465 6669 6e65 2070 6963        Define pic
-00003500: 6b6c 6520 656e 636f 6469 6e67 2069 6e20  kle encoding in 
-00003510: 6361 7365 2066 6974 2077 6173 2064 6f6e  case fit was don
-00003520: 6520 7769 7468 2050 7974 686f 6e20 322e  e with Python 2.
-00003530: 3720 616e 6420 7265 7375 6c74 7320 6172  7 and results ar
-00003540: 6520 7265 6164 2077 6974 6820 5079 7468  e read with Pyth
-00003550: 6f6e 2033 2e0a 0a20 2020 2022 2222 0a0a  on 3...    """..
-00003560: 2020 2020 6465 6620 6461 7461 5f70 7265      def data_pre
-00003570: 7061 7261 7469 6f6e 2873 656c 662c 2074  paration(self, t
-00003580: 696d 6573 2c20 696e 7374 7275 6d65 6e74  imes, instrument
-00003590: 732c 206c 696e 6561 725f 7265 6772 6573  s, linear_regres
-000035a0: 736f 7273 293a 0a20 2020 2020 2020 2022  sors):.        "
-000035b0: 2222 0a20 2020 2020 2020 2054 6869 7320  "".        This 
-000035c0: 6675 6e63 7469 6f6e 2067 656e 6572 6174  function generat
-000035d0: 6573 2066 2075 7365 6675 6c20 696e 7465  es f useful inte
-000035e0: 726e 616c 2061 7272 6179 7320 666f 7220  rnal arrays for 
-000035f0: 7468 6973 2063 6c61 7373 3a20 696e 616d  this class: inam
-00003600: 6573 2077 6869 6368 2073 6176 6573 2074  es which saves t
-00003610: 6865 2069 6e73 7472 756d 656e 7420 6e61  he instrument na
-00003620: 6d65 732c 2060 6067 6c6f 6261 6c5f 7469  mes, ``global_ti
-00003630: 6d65 7360 600a 2020 2020 2020 2020 7768  mes``.        wh
-00003640: 6963 6820 6973 2061 2022 666c 6174 7465  ich is a "flatte
-00003650: 6e65 6422 2061 7272 6179 206f 6620 7468  ned" array of th
-00003660: 6520 6060 7469 6d65 7360 6020 6469 6374  e ``times`` dict
-00003670: 696f 6e61 7279 2077 6865 7265 2061 6c6c  ionary where all
-00003680: 2074 6865 2074 696d 6573 2066 6f72 2061   the times for a
-00003690: 6c6c 2069 6e73 7472 756d 656e 7473 2061  ll instruments a
-000036a0: 7265 2073 7461 636b 6564 2c20 696e 7374  re stacked, inst
-000036b0: 7275 6d65 6e74 5f69 6e64 6578 6573 2c0a  rument_indexes,.
-000036c0: 2020 2020 2020 2020 7768 6963 6820 6973          which is
-000036d0: 2061 2064 6963 7469 6f6e 6172 7920 7468   a dictionary th
-000036e0: 6174 2068 6173 2c20 666f 7220 6561 6368  at has, for each
-000036f0: 2069 6e73 7472 756d 656e 7420 7468 6520   instrument the 
-00003700: 696e 6465 7865 7320 6f66 2074 6865 2060  indexes of the `
-00003710: 6067 6c6f 6261 6c5f 7469 6d65 7360 6020  `global_times`` 
-00003720: 636f 7272 6573 706f 6e64 696e 6720 746f  corresponding to
-00003730: 2065 6163 6820 696e 7374 7275 6d65 6e74   each instrument
-00003740: 2c20 6c6d 5f62 6f6f 6c65 616e 2077 6869  , lm_boolean whi
-00003750: 6368 2073 6176 6573 2062 6f6f 6c65 616e  ch saves boolean
-00003760: 7320 666f 7220 6561 6368 0a20 2020 2020  s for each.     
-00003770: 2020 2069 6e73 7472 756d 656e 7420 746f     instrument to
-00003780: 2069 6e64 6963 6174 6520 6966 2074 6865   indicate if the
-00003790: 7265 2061 7265 206c 696e 6561 7220 7265  re are linear re
-000037a0: 6772 6573 736f 7273 2061 6e64 206c 6d5f  gressors and lm_
-000037b0: 6172 6775 6d65 6e74 7320 7768 6963 6820  arguments which 
-000037c0: 6172 6520 7468 6520 6c69 6e65 6172 2d72  are the linear-r
-000037d0: 6567 7265 7373 6f72 7320 666f 7220 6561  egressors for ea
-000037e0: 6368 2069 6e73 7472 756d 656e 742e 0a20  ch instrument.. 
-000037f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00003800: 2020 2069 6e61 6d65 7320 3d20 5b5d 0a20     inames = []. 
-00003810: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00003820: 7261 6e67 6528 6c65 6e28 7469 6d65 7329  range(len(times)
-00003830: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00003840: 6620 696e 7374 7275 6d65 6e74 735b 695d  f instruments[i]
-00003850: 206e 6f74 2069 6e20 696e 616d 6573 3a0a   not in inames:.
-00003860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003870: 696e 616d 6573 2e61 7070 656e 6428 696e  inames.append(in
-00003880: 7374 7275 6d65 6e74 735b 695d 290a 2020  struments[i]).  
-00003890: 2020 2020 2020 6e69 6e73 7472 756d 656e        ninstrumen
-000038a0: 7473 203d 206c 656e 2869 6e61 6d65 7329  ts = len(inames)
-000038b0: 0a20 2020 2020 2020 2069 6e73 7472 756d  .        instrum
-000038c0: 656e 745f 696e 6465 7865 7320 3d20 7b7d  ent_indexes = {}
-000038d0: 0a20 2020 2020 2020 2066 6f72 2069 6e73  .        for ins
-000038e0: 7472 756d 656e 7420 696e 2069 6e61 6d65  trument in iname
-000038f0: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
-00003900: 6e73 7472 756d 656e 745f 696e 6465 7865  nstrument_indexe
-00003910: 735b 696e 7374 7275 6d65 6e74 5d20 3d20  s[instrument] = 
-00003920: 6e70 2e77 6865 7265 280a 2020 2020 2020  np.where(.      
-00003930: 2020 2020 2020 2020 2020 696e 7374 7275            instru
-00003940: 6d65 6e74 7320 3d3d 2069 6e73 7472 756d  ments == instrum
-00003950: 656e 7429 5b30 5d0a 0a20 2020 2020 2020  ent)[0]..       
-00003960: 2023 2041 6c73 6f20 6765 6e65 7261 7465   # Also generate
-00003970: 206c 6d5f 6c63 5f62 6f6f 6c65 616e 2069   lm_lc_boolean i
-00003980: 6e20 6361 7365 206c 696e 6561 7220 7265  n case linear re
-00003990: 6772 6573 736f 7273 2077 6572 6520 7061  gressors were pa
-000039a0: 7373 6564 3a0a 2020 2020 2020 2020 6c6d  ssed:.        lm
-000039b0: 5f62 6f6f 6c65 616e 203d 207b 7d0a 2020  _boolean = {}.  
-000039c0: 2020 2020 2020 6c6d 5f61 7267 756d 656e        lm_argumen
-000039d0: 7473 203d 207b 7d0a 2020 2020 2020 2020  ts = {}.        
-000039e0: 6966 206c 696e 6561 725f 7265 6772 6573  if linear_regres
-000039f0: 736f 7273 2069 7320 6e6f 7420 4e6f 6e65  sors is not None
-00003a00: 3a0a 2020 2020 2020 2020 2020 2020 6c69  :.            li
-00003a10: 6e65 6172 5f69 6e73 7472 756d 656e 7473  near_instruments
-00003a20: 203d 206c 696e 6561 725f 7265 6772 6573   = linear_regres
-00003a30: 736f 7273 2e6b 6579 7328 290a 2020 2020  sors.keys().    
-00003a40: 2020 2020 2020 2020 666f 7220 696e 7374          for inst
-00003a50: 7275 6d65 6e74 2069 6e20 696e 616d 6573  rument in inames
-00003a60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00003a70: 2020 6966 2069 6e73 7472 756d 656e 7420    if instrument 
-00003a80: 696e 206c 696e 6561 725f 696e 7374 7275  in linear_instru
-00003a90: 6d65 6e74 733a 0a20 2020 2020 2020 2020  ments:.         
-00003aa0: 2020 2020 2020 2020 2020 206c 6d5f 626f             lm_bo
-00003ab0: 6f6c 6561 6e5b 696e 7374 7275 6d65 6e74  olean[instrument
-00003ac0: 5d20 3d20 5472 7565 0a20 2020 2020 2020  ] = True.       
-00003ad0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00003ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003af0: 2020 206c 6d5f 626f 6f6c 6561 6e5b 696e     lm_boolean[in
-00003b00: 7374 7275 6d65 6e74 5d20 3d20 4661 6c73  strument] = Fals
-00003b10: 650a 2020 2020 2020 2020 656c 7365 3a0a  e.        else:.
-00003b20: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00003b30: 696e 7374 7275 6d65 6e74 2069 6e20 696e  instrument in in
-00003b40: 616d 6573 3a0a 2020 2020 2020 2020 2020  ames:.          
-00003b50: 2020 2020 2020 6c6d 5f62 6f6f 6c65 616e        lm_boolean
-00003b60: 5b69 6e73 7472 756d 656e 745d 203d 2046  [instrument] = F
-00003b70: 616c 7365 0a20 2020 2020 2020 2072 6574  alse.        ret
-00003b80: 7572 6e20 696e 616d 6573 2c20 696e 7374  urn inames, inst
-00003b90: 7275 6d65 6e74 5f69 6e64 6578 6573 2c20  rument_indexes, 
-00003ba0: 6c6d 5f62 6f6f 6c65 616e 0a0a 2020 2020  lm_boolean..    
-00003bb0: 6465 6620 636f 6e76 6572 745f 696e 7075  def convert_inpu
-00003bc0: 745f 6461 7461 2873 656c 662c 2074 2c20  t_data(self, t, 
-00003bd0: 792c 2079 6572 7229 3a0a 2020 2020 2020  y, yerr):.      
-00003be0: 2020 2222 220a 2020 2020 2020 2020 5468    """.        Th
-00003bf0: 6973 2063 6f6e 7665 7274 7320 7468 6520  is converts the 
-00003c00: 696e 7075 7420 6469 6374 696f 6e61 7269  input dictionari
-00003c10: 6573 2074 6f20 6172 7261 7973 2028 7468  es to arrays (th
-00003c20: 6973 2069 7320 6561 7369 6572 2074 6f20  is is easier to 
-00003c30: 6861 6e64 6c65 2069 6e74 6572 6e61 6c6c  handle internall
-00003c40: 7920 7769 7468 696e 206a 756c 6965 743b  y within juliet;
-00003c50: 2069 6e70 7574 2064 6963 7469 6f6e 6172   input dictionar
-00003c60: 6965 7320 6172 6520 6a75 7374 2061 736b  ies are just ask
-00003c70: 6564 2062 6563 6175 7365 0a20 2020 2020  ed because.     
-00003c80: 2020 2069 7420 6973 2065 6173 6965 7220     it is easier 
-00003c90: 666f 7220 7468 6520 7573 6572 2074 6f20  for the user to 
-00003ca0: 7061 7373 2074 6865 6d29 2e0a 2020 2020  pass them)..    
-00003cb0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00003cc0: 696e 7374 7275 6d65 6e74 7320 3d20 6c69  instruments = li
-00003cd0: 7374 2874 2e6b 6579 7328 2929 0a20 2020  st(t.keys()).   
-00003ce0: 2020 2020 2061 6c6c 5f74 696d 6573 203d       all_times =
-00003cf0: 206e 702e 6172 7261 7928 5b5d 290a 2020   np.array([]).  
-00003d00: 2020 2020 2020 616c 6c5f 7920 3d20 6e70        all_y = np
+00000940: 7469 6f6e 3a0a 696d 706f 7274 206d 756c  tion:.import mul
+00000950: 7469 7072 6f63 6573 7369 6e67 2061 7320  tiprocessing as 
+00000960: 6d70 0a66 726f 6d20 6d75 6c74 6970 726f  mp.from multipro
+00000970: 6365 7373 696e 6720 696d 706f 7274 2050  cessing import P
+00000980: 6f6f 6c0a 696d 706f 7274 2063 6f6e 7465  ool.import conte
+00000990: 7874 6c69 620a 0a23 2044 6566 696e 6520  xtlib..# Define 
+000009a0: 636f 6e73 7461 6e74 7320 6f6e 2074 6865  constants on the
+000009b0: 2063 6f64 653a 0a47 203d 2036 2e36 3734   code:.G = 6.674
+000009c0: 3038 652d 3131 2020 2320 4772 6176 6974  08e-11  # Gravit
+000009d0: 6174 696f 6e61 6c20 636f 6e73 7461 6e74  ational constant
+000009e0: 2c20 6d6b 730a 6c6f 6732 7069 203d 206e  , mks.log2pi = n
+000009f0: 702e 6c6f 6728 322e 202a 206e 702e 7069  p.log(2. * np.pi
+00000a00: 2920 2023 206c 6e28 322a 7069 290a 0a23  )  # ln(2*pi)..#
+00000a10: 2049 6d70 6f72 7420 616c 6c20 7468 6520   Import all the 
+00000a20: 7574 696c 7320 6675 6e63 7469 6f6e 733a  utils functions:
+00000a30: 0a66 726f 6d20 2e75 7469 6c73 2069 6d70  .from .utils imp
+00000a40: 6f72 7420 2a0a 0a5f 5f61 6c6c 5f5f 203d  ort *..__all__ =
+00000a50: 205b 276c 6f61 6427 2c20 2766 6974 272c   ['load', 'fit',
+00000a60: 2027 6761 7573 7369 616e 5f70 726f 6365   'gaussian_proce
+00000a70: 7373 272c 2027 6d6f 6465 6c27 5d0a 0a63  ss', 'model']..c
+00000a80: 6c61 7373 206c 6f61 6428 6f62 6a65 6374  lass load(object
+00000a90: 293a 0a20 2020 2022 2222 0a20 2020 2047  ):.    """.    G
+00000aa0: 6976 656e 2061 2064 6963 7469 6f6e 6172  iven a dictionar
+00000ab0: 7920 7769 7468 2070 7269 6f72 7320 286f  y with priors (o
+00000ac0: 7220 6120 6669 6c65 6e61 6d65 2070 6f69  r a filename poi
+00000ad0: 6e74 696e 6720 746f 2061 2070 7269 6f72  nting to a prior
+00000ae0: 2066 696c 6529 2061 6e64 2064 6174 6120   file) and data 
+00000af0: 6569 7468 6572 2067 6976 656e 2074 6872  either given thr
+00000b00: 6f75 6768 2061 7272 6179 730a 2020 2020  ough arrays.    
+00000b10: 6f72 2074 6872 6f75 6768 2066 696c 6573  or through files
+00000b20: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00000b30: 6461 7461 2c20 7468 6973 2063 6c61 7373  data, this class
+00000b40: 206c 6f61 6473 2064 6174 6120 696e 746f   loads data into
+00000b50: 2061 206a 756c 6965 7420 6f62 6a65 6374   a juliet object
+00000b60: 2077 6869 6368 2068 6f6c 6473 2061 6c6c   which holds all
+00000b70: 2074 6865 2069 6e66 6f72 6d61 7469 6f6e   the information
+00000b80: 0a20 2020 2061 626f 7574 2074 6865 2064  .    about the d
+00000b90: 6174 6173 6574 2e20 4578 616d 706c 6520  ataset. Example 
+00000ba0: 7573 6167 653a 0a0a 2020 2020 2020 2020  usage:..        
+00000bb0: 2020 2020 2020 203e 3e3e 2064 6174 6120         >>> data 
+00000bc0: 3d20 6a75 6c69 6574 2e6c 6f61 6428 7072  = juliet.load(pr
+00000bd0: 696f 7273 3d70 7269 6f72 732c 745f 6c63  iors=priors,t_lc
+00000be0: 3d74 696d 6573 2c79 5f6c 633d 666c 7578  =times,y_lc=flux
+00000bf0: 6573 2c79 6572 725f 6c63 3d66 6c75 7865  es,yerr_lc=fluxe
+00000c00: 735f 6572 726f 7273 290a 0a20 2020 204f  s_errors)..    O
+00000c10: 722c 2061 6c73 6f2c 0a0a 2020 2020 2020  r, also,..      
+00000c20: 2020 2020 2020 2020 203e 3e3e 2064 6174           >>> dat
+00000c30: 6120 3d20 6a75 6c69 6574 2e6c 6f61 6428  a = juliet.load(
+00000c40: 696e 7075 745f 666f 6c64 6572 203d 2066  input_folder = f
+00000c50: 6f6c 6465 7229 0a0a 2020 2020 3a70 6172  older)..    :par
+00000c60: 616d 2070 7269 6f72 733a 2028 6f70 7469  am priors: (opti
+00000c70: 6f6e 616c 2c20 6469 6374 206f 7220 7374  onal, dict or st
+00000c80: 7269 6e67 290a 2020 2020 2020 2020 5468  ring).        Th
+00000c90: 6973 2063 616e 2062 6520 6569 7468 6572  is can be either
+00000ca0: 2061 2070 7974 686f 6e20 6060 7374 7269   a python ``stri
+00000cb0: 6e67 6060 206f 7220 6120 7079 7468 6f6e  ng`` or a python
+00000cc0: 2060 6064 6963 7460 602e 2049 6620 6120   ``dict``. If a 
+00000cd0: 6060 6469 6374 6060 2c20 7468 6973 2068  ``dict``, this h
+00000ce0: 6173 2074 6f20 636f 6e74 6169 6e20 6561  as to contain ea
+00000cf0: 6368 206f 660a 2020 2020 2020 2020 7468  ch of.        th
+00000d00: 6520 7061 7261 6d65 7465 7273 2074 6f20  e parameters to 
+00000d10: 6265 2066 6974 2c20 616c 6f6e 6720 7769  be fit, along wi
+00000d20: 7468 2074 6865 6972 2072 6573 7065 6374  th their respect
+00000d30: 6976 6520 7072 696f 7220 6469 7374 7269  ive prior distri
+00000d40: 6275 7469 6f6e 7320 616e 6420 6879 7065  butions and hype
+00000d50: 7270 6172 616d 6574 6572 732e 2045 6163  rparameters. Eac
+00000d60: 6820 6b65 790a 2020 2020 2020 2020 6f66  h key.        of
+00000d70: 2074 6869 7320 6469 6374 696f 6e61 7279   this dictionary
+00000d80: 2068 6173 2074 6f20 6861 7665 2061 2070   has to have a p
+00000d90: 6172 616d 6574 6572 206e 616d 6520 2865  arameter name (e
+00000da0: 2e67 2e2c 2060 6072 315f 7031 6060 2c20  .g., ``r1_p1``, 
+00000db0: 6060 7369 676d 615f 775f 5445 5353 6060  ``sigma_w_TESS``
+00000dc0: 292c 2061 6e64 2065 6163 6820 6f66 0a20  ), and each of. 
+00000dd0: 2020 2020 2020 2074 686f 7365 2065 6c65         those ele
+00000de0: 6d65 6e74 7320 6172 652c 2069 6e20 7475  ments are, in tu
+00000df0: 726e 2c20 6469 6374 696f 6e61 7269 6573  rn, dictionaries
+00000e00: 2061 7320 7765 6c6c 2063 6f6e 7461 696e   as well contain
+00000e10: 696e 6720 7477 6f20 6b65 7973 3a20 6120  ing two keys: a 
+00000e20: 6060 6469 7374 7269 6275 7469 6f6e 6060  ``distribution``
+00000e30: 0a20 2020 2020 2020 206b 6579 2077 6869  .        key whi
+00000e40: 6368 2064 6566 696e 6573 2074 6865 2070  ch defines the p
+00000e50: 7269 6f72 2064 6973 7472 6962 7574 696f  rior distributio
+00000e60: 6e20 6f66 2074 6865 2070 6172 616d 6574  n of the paramet
+00000e70: 6572 2061 6e64 2061 2060 6068 7970 6572  er and a ``hyper
+00000e80: 7061 7261 6d65 7465 7273 6060 206b 6579  parameters`` key
+00000e90: 2c0a 2020 2020 2020 2020 7768 6963 6820  ,.        which 
+00000ea0: 636f 6e74 6169 6e73 2074 6865 2068 7970  contains the hyp
+00000eb0: 6572 7061 7261 6d65 7465 7273 206f 6620  erparameters of 
+00000ec0: 7468 6174 2064 6973 7472 6962 7574 696f  that distributio
+00000ed0: 6e2e 0a0a 2020 2020 2020 2020 4578 616d  n...        Exam
+00000ee0: 706c 6520 7365 7475 7020 6f66 2074 6865  ple setup of the
+00000ef0: 2060 6070 7269 6f72 7360 6020 6469 6374   ``priors`` dict
+00000f00: 696f 6e61 7279 3a0a 2020 2020 2020 2020  ionary:.        
+00000f10: 2020 2020 3e3e 3e20 7072 696f 7273 203d      >>> priors =
+00000f20: 207b 7d0a 2020 2020 2020 2020 2020 2020   {}.            
+00000f30: 3e3e 3e20 7072 696f 7273 5b27 7231 5f70  >>> priors['r1_p
+00000f40: 3127 5d20 3d20 7b7d 0a20 2020 2020 2020  1'] = {}.       
+00000f50: 2020 2020 203e 3e3e 2070 7269 6f72 735b       >>> priors[
+00000f60: 2772 315f 7031 275d 5b27 6469 7374 7269  'r1_p1']['distri
+00000f70: 6275 7469 6f6e 275d 203d 2027 556e 6966  bution'] = 'Unif
+00000f80: 6f72 6d27 0a20 2020 2020 2020 2020 2020  orm'.           
+00000f90: 203e 3e3e 2070 7269 6f72 735b 2772 315f   >>> priors['r1_
+00000fa0: 7031 275d 5b27 6879 7065 7270 6172 616d  p1']['hyperparam
+00000fb0: 6574 6572 7327 5d20 3d20 5b30 2e2c 312e  eters'] = [0.,1.
+00000fc0: 5d0a 0a20 2020 2020 2020 2049 6620 6120  ]..        If a 
+00000fd0: 6060 7374 7269 6e67 6060 2c20 7468 6973  ``string``, this
+00000fe0: 2068 6173 2074 6f20 636f 6e74 6169 6e20   has to contain 
+00000ff0: 7468 6520 6669 6c65 6e61 6d65 2074 6f20  the filename to 
+00001000: 6120 7072 6f70 6572 206a 756c 6965 7420  a proper juliet 
+00001010: 7072 696f 7220 6669 6c65 3b20 7468 6520  prior file; the 
+00001020: 7072 696f 7220 6060 6469 6374 6060 2077  prior ``dict`` w
+00001030: 696c 6c0a 2020 2020 2020 2020 7468 656e  ill.        then
+00001040: 2062 6520 6765 6e65 7261 7465 6420 6672   be generated fr
+00001050: 6f6d 2074 6865 7265 2e20 4120 7072 6f70  om there. A prop
+00001060: 6572 2070 7269 6f72 2066 696c 6520 6861  er prior file ha
+00001070: 7320 696e 2074 6865 2066 6972 7374 2063  s in the first c
+00001080: 6f6c 756d 6e20 7468 6520 6e61 6d65 206f  olumn the name o
+00001090: 6620 7468 6520 7061 7261 6d65 7465 722c  f the parameter,
+000010a0: 0a20 2020 2020 2020 2069 6e20 7468 6520  .        in the 
+000010b0: 7365 636f 6e64 2074 6865 206e 616d 6520  second the name 
+000010c0: 6f66 2074 6865 2064 6973 7472 6962 7574  of the distribut
+000010d0: 696f 6e2c 2061 6e64 2069 6e20 7468 6520  ion, and in the 
+000010e0: 7468 6972 6420 7468 6520 6879 7065 7270  third the hyperp
+000010f0: 6172 616d 6574 6572 7320 6f66 2074 6861  arameters of tha
+00001100: 7420 6469 7374 7269 6275 7469 6f6e 2066  t distribution f
+00001110: 6f72 0a20 2020 2020 2020 2074 6865 2070  or.        the p
+00001120: 6172 616d 6574 6572 2e0a 0a20 2020 2020  arameter...     
+00001130: 2020 204e 6f74 6520 7468 6174 2074 6869     Note that thi
+00001140: 7320 616c 6f6e 6720 7769 7468 2065 6974  s along with eit
+00001150: 6865 7220 6c69 6768 7463 7572 7665 206f  her lightcurve o
+00001160: 7220 5256 2064 6174 6120 6f72 2061 2060  r RV data or a `
+00001170: 6069 6e70 7574 5f66 6f6c 6465 7260 6020  `input_folder`` 
+00001180: 6861 7320 746f 2062 6520 6769 7665 6e20  has to be given 
+00001190: 696e 206f 7264 6572 2074 6f20 7072 6f70  in order to prop
+000011a0: 6572 6c79 0a20 2020 2020 2020 206c 6f61  erly.        loa
+000011b0: 6420 6120 6a75 6c69 6574 2064 6174 6120  d a juliet data 
+000011c0: 6f62 6a65 6374 2e0a 0a20 2020 203a 7061  object...    :pa
+000011d0: 7261 6d20 7374 6172 7469 6e67 5f70 6f69  ram starting_poi
+000011e0: 6e74 3a20 286d 616e 6461 746f 7279 2069  nt: (mandatory i
+000011f0: 6620 7573 696e 6720 4d43 4d43 2c20 7573  f using MCMC, us
+00001200: 656c 6573 7320 6966 2075 7369 6e67 206e  eless if using n
+00001210: 6573 7465 6420 7361 6d70 6c65 7273 2c20  ested samplers, 
+00001220: 6469 6374 290a 2020 2020 2020 2020 4469  dict).        Di
+00001230: 6374 696f 6e61 7279 2069 6e64 6963 6174  ctionary indicat
+00001240: 696e 6720 7468 6520 7374 6172 7469 6e67  ing the starting
+00001250: 2076 616c 7565 206f 6620 6561 6368 206f   value of each o
+00001260: 6620 7468 6520 7061 7261 6d65 7465 7273  f the parameters
+00001270: 2066 6f72 2074 6865 204d 434d 4320 7275   for the MCMC ru
+00001280: 6e20 2869 2e65 2e2c 2063 7572 7265 6e74  n (i.e., current
+00001290: 6c79 206f 6e6c 7920 6f66 2075 7365 2066  ly only of use f
+000012a0: 6f72 2060 6065 6d63 6565 6060 292e 204b  or ``emcee``). K
+000012b0: 6579 7320 7368 6f75 6c64 2062 6520 636f  eys should be co
+000012c0: 6e73 6973 7465 6e74 2077 6974 6820 7468  nsistent with th
+000012d0: 6520 6060 7072 696f 7260 6020 6e61 6d69  e ``prior`` nami
+000012e0: 6e67 7320 6162 6f76 653b 0a20 2020 2020  ngs above;.     
+000012f0: 2020 2065 6163 6820 6b65 7920 7368 6f75     each key shou
+00001300: 6c64 2068 6176 6520 616e 2061 7373 6f63  ld have an assoc
+00001310: 6961 7465 6420 666c 6f61 7420 7769 7468  iated float with
+00001320: 2074 6865 2073 7461 7274 696e 6720 7661   the starting va
+00001330: 6c75 652e 2054 6869 7320 6973 206f 6620  lue. This is of 
+00001340: 6e6f 2075 7365 2069 6620 7573 696e 6720  no use if using 
+00001350: 6e65 7374 6564 2073 616d 706c 6572 7320  nested samplers 
+00001360: 2877 6869 6368 2073 616d 706c 6520 6469  (which sample di
+00001370: 7265 6374 6c79 2066 726f 6d20 7468 6520  rectly from the 
+00001380: 7072 696f 7229 2e0a 0a20 2020 203a 7061  prior)...    :pa
+00001390: 7261 6d20 696e 7075 745f 666f 6c64 6572  ram input_folder
+000013a0: 3a20 286f 7074 696f 6e61 6c2c 2073 7472  : (optional, str
+000013b0: 696e 6729 0a20 2020 2020 2020 2050 7974  ing).        Pyt
+000013c0: 686f 6e20 6060 7374 7269 6e67 6060 2063  hon ``string`` c
+000013d0: 6f6e 7461 696e 696e 6720 7468 6520 7061  ontaining the pa
+000013e0: 7468 2074 6f20 6120 666f 6c64 6572 2063  th to a folder c
+000013f0: 6f6e 7461 696e 696e 6720 616c 6c20 7468  ontaining all th
+00001400: 6520 696e 7075 7420 6461 7461 202d 2d2d  e input data ---
+00001410: 2074 6869 7320 7769 6c6c 2074 6875 7320   this will thus 
+00001420: 6265 206c 6f61 6420 696e 746f 2061 0a20  be load into a. 
+00001430: 2020 2020 2020 206a 756c 6965 7420 6461         juliet da
+00001440: 7461 206f 626a 6563 742e 2054 6869 7320  ta object. This 
+00001450: 696e 7075 7420 666f 6c64 6572 2068 6173  input folder has
+00001460: 2074 6f20 636f 6e74 6169 6e20 6174 206c   to contain at l
+00001470: 6561 7374 2061 2060 6070 7269 6f72 732e  east a ``priors.
+00001480: 6461 7460 6020 6669 6c65 2077 6974 6820  dat`` file with 
+00001490: 7468 6520 7072 696f 7273 2061 6e64 2065  the priors and e
+000014a0: 6974 6865 7220 6120 6060 6c63 2e64 6174  ither a ``lc.dat
+000014b0: 6060 0a20 2020 2020 2020 2066 696c 6520  ``.        file 
+000014c0: 636f 6e74 6169 6e69 6e67 206c 6967 6874  containing light
+000014d0: 6375 7276 6520 6461 7461 206f 7220 6120  curve data or a 
+000014e0: 6060 7276 732e 6461 7460 6020 6669 6c65  ``rvs.dat`` file
+000014f0: 2063 6f6e 7461 696e 696e 6720 7261 6469   containing radi
+00001500: 616c 2d76 656c 6f63 6974 7920 6461 7461  al-velocity data
+00001510: 2e20 4966 2069 6e20 7468 6973 2066 6f6c  . If in this fol
+00001520: 6465 7220 6120 6060 4750 5f6c 635f 7265  der a ``GP_lc_re
+00001530: 6772 6573 736f 7273 2e64 6174 6060 0a20  gressors.dat``. 
+00001540: 2020 2020 2020 2066 696c 6520 6f72 2061         file or a
+00001550: 2060 6047 505f 7276 5f72 6567 7265 7373   ``GP_rv_regress
+00001560: 6f72 732e 6461 7460 6020 6669 6c65 2069  ors.dat`` file i
+00001570: 7320 666f 756e 642c 2064 6174 6120 7769  s found, data wi
+00001580: 6c6c 2062 6520 6c6f 6164 6564 2069 6e74  ll be loaded int
+00001590: 6f20 7468 6520 6a75 6c69 6574 206f 626a  o the juliet obj
+000015a0: 6563 7420 6173 2077 656c 6c2e 0a0a 2020  ect as well...  
+000015b0: 2020 2020 2020 4e6f 7465 2074 6861 7420        Note that 
+000015c0: 6174 206c 6561 7374 2074 6869 7320 6f72  at least this or
+000015d0: 2061 2060 6070 7269 6f72 7360 6020 7374   a ``priors`` st
+000015e0: 7269 6e67 206f 7220 6469 6374 696f 6e61  ring or dictiona
+000015f0: 7279 2c20 616c 6f6e 6720 7769 7468 2065  ry, along with e
+00001600: 6974 6865 7220 6c69 6768 7463 7572 7665  ither lightcurve
+00001610: 206f 7220 5256 2064 6174 6120 6861 7320   or RV data has 
+00001620: 746f 2062 6520 6769 7665 6e0a 2020 2020  to be given.    
+00001630: 2020 2020 696e 206f 7264 6572 2074 6f20      in order to 
+00001640: 7072 6f70 6572 6c79 206c 6f61 6420 6120  properly load a 
+00001650: 6a75 6c69 6574 2064 6174 6120 6f62 6a65  juliet data obje
+00001660: 6374 2e0a 0a20 2020 203a 7061 7261 6d20  ct...    :param 
+00001670: 745f 6c63 3a20 286f 7074 696f 6e61 6c2c  t_lc: (optional,
+00001680: 2064 6963 7469 6f6e 6172 7929 0a20 2020   dictionary).   
+00001690: 2020 2020 2044 6963 7469 6f6e 6172 7920       Dictionary 
+000016a0: 7768 6f73 6520 6b65 7973 2061 7265 2069  whose keys are i
+000016b0: 6e73 7472 756d 656e 7420 6e61 6d65 733b  nstrument names;
+000016c0: 2065 6163 6820 6f66 2074 686f 7365 206b   each of those k
+000016d0: 6579 7320 6973 2065 7870 6563 7465 6420  eys is expected 
+000016e0: 746f 2068 6176 6520 6172 7261 7973 2077  to have arrays w
+000016f0: 6974 6820 7468 6520 7469 6d65 7320 636f  ith the times co
+00001700: 7272 6573 706f 6e64 696e 6720 746f 2074  rresponding to t
+00001710: 686f 7365 2069 6e73 7472 756d 656e 7473  hose instruments
+00001720: 2e0a 2020 2020 2020 2020 466f 7220 6578  ..        For ex
+00001730: 616d 706c 652c 0a20 2020 2020 2020 2020  ample,.         
+00001740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001750: 2020 2020 2020 2020 2020 203e 3e3e 2074             >>> t
+00001760: 5f6c 6320 3d20 7b7d 0a20 2020 2020 2020  _lc = {}.       
+00001770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001780: 2020 2020 2020 2020 2020 2020 203e 3e3e               >>>
+00001790: 2074 5f6c 635b 2754 4553 5327 5d20 3d20   t_lc['TESS'] = 
+000017a0: 6e70 2e6c 696e 7370 6163 6528 302c 3130  np.linspace(0,10
+000017b0: 302c 3130 3029 0a0a 2020 2020 2020 2020  0,100)..        
+000017c0: 4973 2061 2076 616c 6964 2069 6e70 7574  Is a valid input
+000017d0: 2064 6963 7469 6f6e 6172 7920 666f 7220   dictionary for 
+000017e0: 6060 745f 6c63 6060 2e0a 0a20 2020 203a  ``t_lc``...    :
+000017f0: 7061 7261 6d20 795f 6c63 3a20 286f 7074  param y_lc: (opt
+00001800: 696f 6e61 6c2c 2064 6963 7469 6f6e 6172  ional, dictionar
+00001810: 7929 0a20 2020 2020 2020 2053 696d 696c  y).        Simil
+00001820: 6172 6c79 2074 6f20 6060 745f 6c63 6060  arly to ``t_lc``
+00001830: 2c20 6469 6374 696f 6e61 7279 2077 686f  , dictionary who
+00001840: 7365 206b 6579 7320 6172 6520 696e 7374  se keys are inst
+00001850: 7275 6d65 6e74 206e 616d 6573 3b20 6561  rument names; ea
+00001860: 6368 206f 6620 7468 6f73 6520 6b65 7973  ch of those keys
+00001870: 2069 7320 6578 7065 6374 6564 2074 6f20   is expected to 
+00001880: 6861 7665 2061 7272 6179 7320 7769 7468  have arrays with
+00001890: 2074 6865 2066 6c75 7865 7320 636f 7272   the fluxes corr
+000018a0: 6573 706f 6e64 696e 6720 746f 2074 686f  esponding to tho
+000018b0: 7365 2069 6e73 7472 756d 656e 7473 2e0a  se instruments..
+000018c0: 2020 2020 2020 2020 5468 6573 6520 6172          These ar
+000018d0: 6520 6578 7065 6374 6564 2074 6f20 6265  e expected to be
+000018e0: 2063 6f6e 7369 7374 656e 7420 7769 7468   consistent with
+000018f0: 2074 6865 2060 6074 5f6c 6360 6020 6469   the ``t_lc`` di
+00001900: 6374 696f 6e61 7269 6573 2e0a 0a20 2020  ctionaries...   
+00001910: 203a 7061 7261 6d20 7965 7272 5f6c 633a   :param yerr_lc:
+00001920: 2028 6f70 7469 6f6e 616c 2c20 6469 6374   (optional, dict
+00001930: 696f 6e61 7279 290a 2020 2020 2020 2020  ionary).        
+00001940: 5369 6d69 6c61 726c 7920 746f 2060 6074  Similarly to ``t
+00001950: 5f6c 6360 602c 2064 6963 7469 6f6e 6172  _lc``, dictionar
+00001960: 7920 7768 6f73 6520 6b65 7973 2061 7265  y whose keys are
+00001970: 2069 6e73 7472 756d 656e 7420 6e61 6d65   instrument name
+00001980: 733b 2065 6163 6820 6f66 2074 686f 7365  s; each of those
+00001990: 206b 6579 7320 6973 2065 7870 6563 7465   keys is expecte
+000019a0: 6420 746f 2068 6176 6520 6172 7261 7973  d to have arrays
+000019b0: 2077 6974 6820 7468 6520 6572 726f 7273   with the errors
+000019c0: 206f 6e20 7468 6520 666c 7578 6573 2063   on the fluxes c
+000019d0: 6f72 7265 7370 6f6e 6469 6e67 2074 6f20  orresponding to 
+000019e0: 7468 6f73 6520 696e 7374 7275 6d65 6e74  those instrument
+000019f0: 732e 0a20 2020 2020 2020 2054 6865 7365  s..        These
+00001a00: 2061 7265 2065 7870 6563 7465 6420 746f   are expected to
+00001a10: 2062 6520 636f 6e73 6973 7465 6e74 2077   be consistent w
+00001a20: 6974 6820 7468 6520 6060 745f 6c63 6060  ith the ``t_lc``
+00001a30: 2064 6963 7469 6f6e 6172 6965 732e 0a0a   dictionaries...
+00001a40: 2020 2020 3a70 6172 616d 2047 505f 7265      :param GP_re
+00001a50: 6772 6573 736f 7273 5f6c 633a 2028 6f70  gressors_lc: (op
+00001a60: 7469 6f6e 616c 2c20 6469 6374 696f 6e61  tional, dictiona
+00001a70: 7279 290a 2020 2020 2020 2020 4469 6374  ry).        Dict
+00001a80: 696f 6e61 7279 2077 686f 7365 206b 6579  ionary whose key
+00001a90: 7320 6172 6520 6e61 6d65 7320 6f66 2069  s are names of i
+00001aa0: 6e73 7472 756d 656e 7473 2077 6865 7265  nstruments where
+00001ab0: 2061 2047 5020 6973 2074 6f20 6265 2066   a GP is to be f
+00001ac0: 6974 2e20 4f6e 2065 6163 6820 6e61 6d65  it. On each name
+00001ad0: 2f65 6c65 6d65 6e74 2c20 616e 2061 7272  /element, an arr
+00001ae0: 6179 206f 660a 2020 2020 2020 2020 7265  ay of.        re
+00001af0: 6772 6573 736f 7273 206f 6620 7368 6170  gressors of shap
+00001b00: 6520 6060 286d 2c6e 2960 6020 636f 6e74  e ``(m,n)`` cont
+00001b10: 6169 6e69 6e67 2069 6e20 6561 6368 2063  aining in each c
+00001b20: 6f6c 756d 6e20 7468 6520 6060 6e60 6020  olumn the ``n`` 
+00001b30: 4750 2072 6567 7265 7373 6f72 7320 746f  GP regressors to
+00001b40: 2062 6520 7573 6564 2066 6f72 0a20 2020   be used for.   
+00001b50: 2020 2020 2060 606d 6060 2070 686f 746f       ``m`` photo
+00001b60: 6d65 7472 6963 206d 6561 7375 7265 6d65  metric measureme
+00001b70: 6e74 7320 6861 7320 746f 2062 6520 6769  nts has to be gi
+00001b80: 7665 6e2e 204e 6f74 6520 7468 6174 2060  ven. Note that `
+00001b90: 606d 6060 2066 6f72 2061 2067 6976 656e  `m`` for a given
+00001ba0: 2069 6e73 7472 756d 656e 7420 6861 7320   instrument has 
+00001bb0: 746f 2062 6520 6f66 2074 6865 2073 616d  to be of the sam
+00001bc0: 6520 6c65 6e67 7468 0a20 2020 2020 2020  e length.       
+00001bd0: 2061 7320 7468 6520 636f 7272 6573 706f   as the correspo
+00001be0: 6e64 696e 6720 6060 745f 6c63 6060 2066  nding ``t_lc`` f
+00001bf0: 6f72 2074 6861 7420 696e 7374 7275 6d65  or that instrume
+00001c00: 6e74 2e20 416c 736f 2c20 6e6f 7465 2074  nt. Also, note t
+00001c10: 6865 206f 7264 6572 206f 6620 6561 6368  he order of each
+00001c20: 2072 6567 7265 7373 6f72 206f 6620 6561   regressor of ea
+00001c30: 6368 2069 6e73 7472 756d 656e 7420 6861  ch instrument ha
+00001c40: 7320 746f 206d 6174 6368 0a20 2020 2020  s to match.     
+00001c50: 2020 2074 6865 2063 6f72 7265 7370 6f6e     the correspon
+00001c60: 6469 6e67 206f 7264 6572 2069 6e20 7468  ding order in th
+00001c70: 6520 6060 745f 6c63 6060 2061 7272 6179  e ``t_lc`` array
+00001c80: 2e0a 2020 2020 2020 2020 466f 7220 6578  ..        For ex
+00001c90: 616d 706c 652c 0a0a 2020 2020 2020 2020  ample,..        
+00001ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001cb0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00001cc0: 4750 5f72 6567 7265 7373 6f72 735f 6c63  GP_regressors_lc
+00001cd0: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
+00001ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001cf0: 2020 2020 2020 2020 2020 3e3e 3e20 4750            >>> GP
+00001d00: 5f72 6567 7265 7373 6f72 735f 6c63 5b27  _regressors_lc['
+00001d10: 5445 5353 275d 203d 206e 702e 6c69 6e73  TESS'] = np.lins
+00001d20: 7061 6365 282d 312c 312c 3130 3029 0a0a  pace(-1,1,100)..
+00001d30: 2020 2020 2020 2020 4966 2061 2067 6c6f          If a glo
+00001d40: 6261 6c20 6d6f 6465 6c20 7761 6e74 7320  bal model wants 
+00001d50: 746f 2062 6520 7573 6564 2c20 7468 656e  to be used, then
+00001d60: 2074 6865 2069 6e73 7472 756d 656e 7420   the instrument 
+00001d70: 7368 6f75 6c64 2062 6520 6060 7276 6060  should be ``rv``
+00001d80: 2c20 616e 6420 6561 6368 206f 6620 7468  , and each of th
+00001d90: 6520 6060 6d60 6020 726f 7773 2073 686f  e ``m`` rows sho
+00001da0: 756c 6420 636f 7272 6573 706f 6e64 2074  uld correspond t
+00001db0: 6f20 7468 6520 6060 6d60 6020 7469 6d65  o the ``m`` time
+00001dc0: 732e 0a0a 2020 2020 3a70 6172 616d 206c  s...    :param l
+00001dd0: 696e 6561 725f 7265 6772 6573 736f 7273  inear_regressors
+00001de0: 5f6c 633a 2028 6f70 7469 6f6e 616c 2c20  _lc: (optional, 
+00001df0: 6469 6374 696f 6e61 7279 290a 2020 2020  dictionary).    
+00001e00: 2020 2020 5369 6d69 6c61 726c 7920 6173      Similarly as
+00001e10: 2066 6f72 2060 6047 505f 7265 6772 6573   for ``GP_regres
+00001e20: 736f 7273 5f6c 6360 602c 2074 6869 7320  sors_lc``, this 
+00001e30: 6973 2061 2064 6963 7469 6f6e 6172 7920  is a dictionary 
+00001e40: 7768 6f73 6520 6b65 7973 2061 7265 206e  whose keys are n
+00001e50: 616d 6573 206f 6620 696e 7374 7275 6d65  ames of instrume
+00001e60: 6e74 7320 7768 6572 6520 6120 6c69 6e65  nts where a line
+00001e70: 6172 2072 6567 7265 7373 696f 6e20 6973  ar regression is
+00001e80: 2074 6f20 6265 2066 6974 2e0a 2020 2020   to be fit..    
+00001e90: 2020 2020 4f6e 2065 6163 6820 6e61 6d65      On each name
+00001ea0: 2f65 6c65 6d65 6e74 2c20 616e 2061 7272  /element, an arr
+00001eb0: 6179 206f 6620 7368 6170 6520 6060 2871  ay of shape ``(q
+00001ec0: 2c70 2960 6020 636f 6e74 6169 6e69 6e67  ,p)`` containing
+00001ed0: 2069 6e20 6561 6368 2063 6f6c 756d 6e20   in each column 
+00001ee0: 7468 6520 6060 7060 6020 6c69 6e65 6172  the ``p`` linear
+00001ef0: 2072 6567 7265 7373 6f72 7320 746f 2062   regressors to b
+00001f00: 6520 7573 6564 2066 6f72 2074 6865 2060  e used for the `
+00001f10: 6071 6060 0a20 2020 2020 2020 2070 686f  `q``.        pho
+00001f20: 746f 6d65 7472 6963 206d 6561 7375 7265  tometric measure
+00001f30: 6d65 6e74 732e 2041 6761 696e 2c20 6e6f  ments. Again, no
+00001f40: 7465 2074 6865 206f 7264 6572 206f 6620  te the order of 
+00001f50: 6561 6368 2072 6567 7265 7373 6f72 206f  each regressor o
+00001f60: 6620 6561 6368 2069 6e73 7472 756d 656e  f each instrumen
+00001f70: 7420 6861 7320 746f 206d 6174 6368 2074  t has to match t
+00001f80: 6865 2063 6f72 7265 7370 6f6e 6469 6e67  he corresponding
+00001f90: 206f 7264 6572 2069 6e20 7468 6520 6060   order in the ``
+00001fa0: 745f 6c63 6060 2061 7272 6179 2e0a 0a20  t_lc`` array... 
+00001fb0: 2020 203a 7061 7261 6d20 4750 5f72 6567     :param GP_reg
+00001fc0: 7265 7373 6f72 735f 7276 3a20 286f 7074  ressors_rv: (opt
+00001fd0: 696f 6e61 6c2c 2064 6963 7469 6f6e 6172  ional, dictionar
+00001fe0: 7929 0a20 2020 2020 2020 2053 616d 6520  y).        Same 
+00001ff0: 6173 2060 6047 505f 7265 6772 6573 736f  as ``GP_regresso
+00002000: 7273 5f6c 6360 6020 6275 7420 666f 7220  rs_lc`` but for 
+00002010: 7468 6520 7261 6469 616c 2d76 656c 6f63  the radial-veloc
+00002020: 6974 7920 6461 7461 2e20 4966 2061 2067  ity data. If a g
+00002030: 6c6f 6261 6c20 6d6f 6465 6c20 7761 6e74  lobal model want
+00002040: 7320 746f 2062 6520 7573 6564 2c20 7468  s to be used, th
+00002050: 656e 2074 6865 2069 6e73 7472 756d 656e  en the instrumen
+00002060: 7420 7368 6f75 6c64 2062 6520 6060 6c63  t should be ``lc
+00002070: 6060 2c20 616e 6420 6561 6368 206f 6620  ``, and each of 
+00002080: 7468 6520 6060 6d60 6020 726f 7773 2073  the ``m`` rows s
+00002090: 686f 756c 6420 636f 7272 6573 706f 6e64  hould correspond
+000020a0: 2074 6f20 7468 6520 6060 6d60 6020 7469   to the ``m`` ti
+000020b0: 6d65 732e 0a0a 2020 2020 3a70 6172 616d  mes...    :param
+000020c0: 206c 696e 6561 725f 7265 6772 6573 736f   linear_regresso
+000020d0: 7273 5f72 763a 2028 6f70 7469 6f6e 616c  rs_rv: (optional
+000020e0: 2c20 6469 6374 696f 6e61 7279 290a 2020  , dictionary).  
+000020f0: 2020 2020 2020 5361 6d65 2061 7320 6060        Same as ``
+00002100: 6c69 6e65 6172 5f72 6567 7265 7373 6f72  linear_regressor
+00002110: 735f 6c63 6060 2c20 6275 7420 666f 7220  s_lc``, but for 
+00002120: 7468 6520 7261 6469 616c 2d76 656c 6f63  the radial-veloc
+00002130: 6974 6965 732e 0a0a 2020 2020 3a70 6172  ities...    :par
+00002140: 616d 2074 5f72 763a 2028 6f70 7469 6f6e  am t_rv: (option
+00002150: 616c 2c20 6469 6374 696f 6e61 7279 290a  al, dictionary).
+00002160: 2020 2020 2020 2020 5361 6d65 2061 7320          Same as 
+00002170: 6060 745f 6c63 6060 2c20 6275 7420 666f  ``t_lc``, but fo
+00002180: 7220 7468 6520 7261 6469 616c 2d76 656c  r the radial-vel
+00002190: 6f63 6974 6965 732e 0a0a 2020 2020 3a70  ocities...    :p
+000021a0: 6172 616d 2079 5f72 763a 2028 6f70 7469  aram y_rv: (opti
+000021b0: 6f6e 616c 2c20 6469 6374 696f 6e61 7279  onal, dictionary
+000021c0: 290a 2020 2020 2020 2020 5361 6d65 2061  ).        Same a
+000021d0: 7320 6060 795f 6c63 6060 2c20 6275 7420  s ``y_lc``, but 
+000021e0: 666f 7220 7468 6520 7261 6469 616c 2d76  for the radial-v
+000021f0: 656c 6f63 6974 6965 732e 0a0a 2020 2020  elocities...    
+00002200: 3a70 6172 616d 2079 6572 725f 7276 3a20  :param yerr_rv: 
+00002210: 286f 7074 696f 6e61 6c2c 2064 6963 7469  (optional, dicti
+00002220: 6f6e 6172 7929 0a20 2020 2020 2020 2053  onary).        S
+00002230: 616d 6520 6173 2060 6079 6572 725f 6c63  ame as ``yerr_lc
+00002240: 6060 2c20 6275 7420 666f 7220 7468 6520  ``, but for the 
+00002250: 7261 6469 616c 2d76 656c 6f63 6974 6965  radial-velocitie
+00002260: 732e 0a0a 2020 2020 3a70 6172 616d 206f  s...    :param o
+00002270: 7574 5f66 6f6c 6465 723a 2028 6f70 7469  ut_folder: (opti
+00002280: 6f6e 616c 2c20 7374 7269 6e67 290a 2020  onal, string).  
+00002290: 2020 2020 2020 4966 2061 2070 6174 6820        If a path 
+000022a0: 6973 2067 6976 656e 2c20 7265 7375 6c74  is given, result
+000022b0: 7320 7769 6c6c 2062 6520 7361 7665 6420  s will be saved 
+000022c0: 746f 2074 6861 7420 7061 7468 2061 7320  to that path as 
+000022d0: 6120 6060 7069 636b 6c65 6060 2066 696c  a ``pickle`` fil
+000022e0: 652c 2061 6c6f 6e67 2077 6974 6820 616c  e, along with al
+000022f0: 6c20 696e 7075 7473 2069 6e20 7468 6520  l inputs in the 
+00002300: 7374 616e 6461 7264 206a 756c 6965 7420  standard juliet 
+00002310: 666f 726d 6174 2e0a 0a20 2020 203a 7061  format...    :pa
+00002320: 7261 6d20 6c63 6669 6c65 6e61 6d65 3a20  ram lcfilename: 
+00002330: 2028 6f70 7469 6f6e 616c 2c20 7374 7269   (optional, stri
+00002340: 6e67 290a 2020 2020 2020 2020 4966 2061  ng).        If a
+00002350: 2070 6174 6820 746f 2061 206c 6967 6874   path to a light
+00002360: 6375 7276 6520 6669 6c65 2069 7320 6769  curve file is gi
+00002370: 7665 6e2c 2060 6074 5f6c 6360 602c 2060  ven, ``t_lc``, `
+00002380: 6079 5f6c 6360 602c 2060 6079 6572 725f  `y_lc``, ``yerr_
+00002390: 6c63 6060 2061 6e64 2060 6069 6e73 7472  lc`` and ``instr
+000023a0: 756d 656e 7473 5f6c 6360 6020 7769 6c6c  uments_lc`` will
+000023b0: 2062 6520 7265 6164 2066 726f 6d20 7468   be read from th
+000023c0: 6572 652e 2054 6865 2062 6173 6963 2066  ere. The basic f
+000023d0: 696c 6520 666f 726d 6174 2069 7320 6120  ile format is a 
+000023e0: 7075 7265 0a20 2020 2020 2020 2061 7363  pure.        asc
+000023f0: 6969 2066 696c 6520 7768 6572 6520 7469  ii file where ti
+00002400: 6d65 7320 6172 6520 696e 2074 6865 2066  mes are in the f
+00002410: 6972 7374 2063 6f6c 756d 6e2c 2072 656c  irst column, rel
+00002420: 6174 6976 6520 666c 7578 6573 2069 6e20  ative fluxes in 
+00002430: 7468 6520 7365 636f 6e64 2c20 6572 726f  the second, erro
+00002440: 7273 2069 6e20 7468 6520 7468 6972 6420  rs in the third 
+00002450: 616e 6420 696e 7374 7275 6d65 6e74 206e  and instrument n
+00002460: 616d 6573 2069 6e20 7468 6520 666f 7572  ames in the four
+00002470: 7468 2e20 4966 206d 6f72 6520 636f 6c75  th. If more colu
+00002480: 6d6e 7320 6172 6520 6769 7665 6e20 666f  mns are given fo
+00002490: 720a 2020 2020 2020 2020 6120 6769 7665  r.        a give
+000024a0: 6e20 696e 7374 7275 6d65 6e74 2c20 7468  n instrument, th
+000024b0: 6f73 6520 7769 6c6c 2062 6520 6964 656e  ose will be iden
+000024c0: 7469 6669 6564 2061 7320 6c69 6e65 6172  tified as linear
+000024d0: 2072 6567 7265 7373 6f72 7320 666f 7220   regressors for 
+000024e0: 7468 6f73 6520 696e 7374 7275 6d65 6e74  those instrument
+000024f0: 732e 0a0a 2020 2020 3a70 6172 616d 2072  s...    :param r
+00002500: 7666 696c 656e 616d 653a 2028 6f70 7469  vfilename: (opti
+00002510: 6f6e 616c 2c20 7374 7269 6e67 290a 2020  onal, string).  
+00002520: 2020 2020 2020 5361 6d65 2061 7320 6060        Same as ``
+00002530: 6c63 6669 6c65 6e61 6d65 6060 2c20 6275  lcfilename``, bu
+00002540: 7420 666f 7220 7468 6520 7261 6469 616c  t for the radial
+00002550: 2d76 656c 6f63 6974 6965 732e 0a0a 2020  -velocities...  
+00002560: 2020 3a70 6172 616d 2047 506c 6365 7061    :param GPlcepa
+00002570: 7261 6d66 696c 653a 2028 6f70 7469 6f6e  ramfile: (option
+00002580: 616c 2c20 7374 7269 6e67 290a 2020 2020  al, string).    
+00002590: 2020 2020 4966 2061 2070 6174 6820 746f      If a path to
+000025a0: 2061 2066 696c 6520 6973 2067 6976 656e   a file is given
+000025b0: 2c20 7468 6520 636f 6c75 6d6e 7320 6f66  , the columns of
+000025c0: 2074 6861 7420 6669 6c65 2077 696c 6c20   that file will 
+000025d0: 6265 2075 7365 6420 6173 2047 5020 7265  be used as GP re
+000025e0: 6772 6573 736f 7273 2066 6f72 2074 6865  gressors for the
+000025f0: 206c 6967 6874 6375 7276 6520 6669 742e   lightcurve fit.
+00002600: 2054 6865 2066 696c 6520 666f 726d 6174   The file format
+00002610: 2069 7320 6120 7075 7265 2061 7363 6969   is a pure ascii
+00002620: 2066 696c 650a 2020 2020 2020 2020 7768   file.        wh
+00002630: 6572 6520 7265 6772 6573 736f 7273 2061  ere regressors a
+00002640: 7265 2067 6976 656e 2069 6e20 6469 6666  re given in diff
+00002650: 6572 656e 7420 636f 6c75 6d6e 732c 2061  erent columns, a
+00002660: 6e64 2074 6865 206c 6173 7420 636f 6c75  nd the last colu
+00002670: 6d6e 2068 6f6c 6473 2074 6865 2069 6e73  mn holds the ins
+00002680: 7472 756d 656e 7420 6e61 6d65 2e20 5468  trument name. Th
+00002690: 6520 6f72 6465 7220 6f66 2074 6869 7320  e order of this 
+000026a0: 6669 6c65 2068 6173 2074 6f20 6265 2063  file has to be c
+000026b0: 6f6e 7369 7374 656e 7420 7769 7468 0a20  onsistent with. 
+000026c0: 2020 2020 2020 2060 6074 5f6c 6360 6020         ``t_lc`` 
+000026d0: 616e 642f 6f72 2074 6865 2060 606c 6366  and/or the ``lcf
+000026e0: 696c 656e 616d 6560 6020 6669 6c65 2e20  ilename`` file. 
+000026f0: 4966 2061 2067 6c6f 6261 6c20 6d6f 6465  If a global mode
+00002700: 6c20 7761 6e74 7320 746f 2062 6520 7573  l wants to be us
+00002710: 6564 2c20 7365 7420 7468 6520 696e 7374  ed, set the inst
+00002720: 7275 6d65 6e74 206e 616d 6573 206f 6620  rument names of 
+00002730: 616c 6c20 7265 6772 6573 736f 7273 2074  all regressors t
+00002740: 6f20 6060 6c63 6060 2e0a 0a20 2020 203a  o ``lc``...    :
+00002750: 7061 7261 6d20 4750 7276 6570 6172 616d  param GPrveparam
+00002760: 6669 6c65 3a20 286f 7074 696f 6e61 6c2c  file: (optional,
+00002770: 2073 7472 696e 6729 0a20 2020 2020 2020   string).       
+00002780: 2053 616d 6520 6173 2060 6047 506c 6365   Same as ``GPlce
+00002790: 7061 7261 6d66 696c 6560 6020 6275 7420  paramfile`` but 
+000027a0: 666f 7220 7468 6520 7261 6469 616c 2d76  for the radial-v
+000027b0: 656c 6f63 6974 6965 732e 2049 6620 6120  elocities. If a 
+000027c0: 676c 6f62 616c 206d 6f64 656c 2077 616e  global model wan
+000027d0: 7473 2074 6f20 6265 2075 7365 642c 2073  ts to be used, s
+000027e0: 6574 2074 6865 2069 6e73 7472 756d 656e  et the instrumen
+000027f0: 7420 6e61 6d65 7320 6f66 2061 6c6c 2072  t names of all r
+00002800: 6567 7265 7373 6f72 7320 746f 2060 6072  egressors to ``r
+00002810: 7660 602e 0a0a 2020 2020 3a70 6172 616d  v``...    :param
+00002820: 204c 4d6c 6365 7061 7261 6d66 696c 653a   LMlceparamfile:
+00002830: 2028 6f70 7469 6f6e 616c 2c20 7374 7269   (optional, stri
+00002840: 6e67 290a 2020 2020 2020 2020 4966 2061  ng).        If a
+00002850: 2070 6174 6820 746f 2061 2066 696c 6520   path to a file 
+00002860: 6973 2067 6976 656e 2c20 7468 6520 636f  is given, the co
+00002870: 6c75 6d6e 7320 6f66 2074 6861 7420 6669  lumns of that fi
+00002880: 6c65 2077 696c 6c20 6265 2075 7365 6420  le will be used 
+00002890: 6173 206c 696e 6561 7220 7265 6772 6573  as linear regres
+000028a0: 736f 7273 2066 6f72 2074 6865 206c 6967  sors for the lig
+000028b0: 6874 6375 7276 6520 6669 742e 2054 6865  htcurve fit. The
+000028c0: 2066 696c 6520 666f 726d 6174 2069 7320   file format is 
+000028d0: 6120 7075 7265 2061 7363 6969 2066 696c  a pure ascii fil
+000028e0: 650a 2020 2020 2020 2020 7768 6572 6520  e.        where 
+000028f0: 7265 6772 6573 736f 7273 2061 7265 2067  regressors are g
+00002900: 6976 656e 2069 6e20 6469 6666 6572 656e  iven in differen
+00002910: 7420 636f 6c75 6d6e 732c 2061 6e64 2074  t columns, and t
+00002920: 6865 206c 6173 7420 636f 6c75 6d6e 2068  he last column h
+00002930: 6f6c 6473 2074 6865 2069 6e73 7472 756d  olds the instrum
+00002940: 656e 7420 6e61 6d65 2e20 5468 6520 6f72  ent name. The or
+00002950: 6465 7220 6f66 2074 6869 7320 6669 6c65  der of this file
+00002960: 2068 6173 2074 6f20 6265 2063 6f6e 7369   has to be consi
+00002970: 7374 656e 7420 7769 7468 0a20 2020 2020  stent with.     
+00002980: 2020 2060 6074 5f6c 6360 6020 616e 642f     ``t_lc`` and/
+00002990: 6f72 2074 6865 2060 606c 6366 696c 656e  or the ``lcfilen
+000029a0: 616d 6560 6020 6669 6c65 2e20 4966 2061  ame`` file. If a
+000029b0: 2067 6c6f 6261 6c20 6d6f 6465 6c20 7761   global model wa
+000029c0: 6e74 7320 746f 2062 6520 7573 6564 2c20  nts to be used, 
+000029d0: 7365 7420 7468 6520 696e 7374 7275 6d65  set the instrume
+000029e0: 6e74 206e 616d 6573 206f 6620 616c 6c20  nt names of all 
+000029f0: 7265 6772 6573 736f 7273 2074 6f20 6060  regressors to ``
+00002a00: 6c63 6060 2e0a 0a20 2020 203a 7061 7261  lc``...    :para
+00002a10: 6d20 4c4d 7276 6570 6172 616d 6669 6c65  m LMrveparamfile
+00002a20: 3a20 286f 7074 696f 6e61 6c2c 2073 7472  : (optional, str
+00002a30: 696e 6729 0a20 2020 2020 2020 2053 616d  ing).        Sam
+00002a40: 6520 6173 2060 604c 4d6c 6365 7061 7261  e as ``LMlcepara
+00002a50: 6d66 696c 6560 6020 6275 7420 666f 7220  mfile`` but for 
+00002a60: 7468 6520 7261 6469 616c 2d76 656c 6f63  the radial-veloc
+00002a70: 6974 6965 732e 2049 6620 6120 676c 6f62  ities. If a glob
+00002a80: 616c 206d 6f64 656c 2077 616e 7473 2074  al model wants t
+00002a90: 6f20 6265 2075 7365 642c 2073 6574 2074  o be used, set t
+00002aa0: 6865 2069 6e73 7472 756d 656e 7420 6e61  he instrument na
+00002ab0: 6d65 7320 6f66 2061 6c6c 2072 6567 7265  mes of all regre
+00002ac0: 7373 6f72 7320 746f 2060 6072 7660 602e  ssors to ``rv``.
+00002ad0: 0a0a 2020 2020 3a70 6172 616d 206c 6374  ..    :param lct
+00002ae0: 696d 6564 6566 3a20 286f 7074 696f 6e61  imedef: (optiona
+00002af0: 6c2c 2073 7472 696e 6729 0a20 2020 2020  l, string).     
+00002b00: 2020 2054 696d 6520 6465 6669 6e69 7469     Time definiti
+00002b10: 6f6e 7320 666f 7220 6561 6368 206f 6620  ons for each of 
+00002b20: 7468 6520 6c69 6768 7463 7572 7665 2069  the lightcurve i
+00002b30: 6e73 7472 756d 656e 7473 2e20 4465 6661  nstruments. Defa
+00002b40: 756c 7420 6973 2074 6f20 6173 7375 6d65  ult is to assume
+00002b50: 2061 6c6c 2069 6e73 7472 756d 656e 7473   all instruments
+00002b60: 2028 696e 206c 6373 2061 6e64 2072 7673   (in lcs and rvs
+00002b70: 2920 6861 7665 2074 6865 2073 616d 6520  ) have the same 
+00002b80: 7469 6d65 2064 6566 696e 6974 696f 6e73  time definitions
+00002b90: 2e20 4966 206d 6f72 6520 7468 616e 206f  . If more than o
+00002ba0: 6e65 2069 6e73 7472 756d 656e 7420 6973  ne instrument is
+00002bb0: 2067 6976 656e 2c20 7468 6973 2073 7472   given, this str
+00002bc0: 696e 670a 2020 2020 2020 2020 7368 6f75  ing.        shou
+00002bd0: 6c64 2068 6176 6520 696e 7374 7275 6d65  ld have instrume
+00002be0: 6e74 7320 616e 6420 7469 6d65 2d64 6566  nts and time-def
+00002bf0: 696e 6974 696f 6e73 2073 6570 6172 6174  initions separat
+00002c00: 6564 2062 7920 636f 6d6d 6173 2c20 652e  ed by commas, e.
+00002c10: 672e 2c20 6060 5445 5353 2d54 4442 2c20  g., ``TESS-TDB, 
+00002c20: 4c43 4f47 542d 5554 4360 602c 2065 7463  LCOGT-UTC``, etc
+00002c30: 2e0a 0a20 2020 203a 7061 7261 6d20 7276  ...    :param rv
+00002c40: 7469 6d65 6465 663a 2028 6f70 7469 6f6e  timedef: (option
+00002c50: 616c 2c20 7374 7269 6e67 290a 2020 2020  al, string).    
+00002c60: 2020 2020 5469 6d65 2064 6566 696e 6974      Time definit
+00002c70: 696f 6e73 2066 6f72 2065 6163 6820 6f66  ions for each of
+00002c80: 2074 6865 2072 6164 6961 6c2d 7665 6c6f   the radial-velo
+00002c90: 6369 7479 2069 6e73 7472 756d 656e 7473  city instruments
+00002ca0: 2e20 4465 6661 756c 7420 6973 2074 6f20  . Default is to 
+00002cb0: 6173 7375 6d65 2061 6c6c 2069 6e73 7472  assume all instr
+00002cc0: 756d 656e 7473 2028 696e 206c 6373 2061  uments (in lcs a
+00002cd0: 6e64 2072 7673 2920 6861 7665 2074 6865  nd rvs) have the
+00002ce0: 2073 616d 6520 7469 6d65 2064 6566 696e   same time defin
+00002cf0: 6974 696f 6e73 2e20 4966 206d 6f72 6520  itions. If more 
+00002d00: 7468 616e 206f 6e65 2069 6e73 7472 756d  than one instrum
+00002d10: 656e 7420 6973 2067 6976 656e 2c0a 2020  ent is given,.  
+00002d20: 2020 2020 2020 7468 6973 2073 7472 696e        this strin
+00002d30: 6720 7368 6f75 6c64 2068 6176 6520 696e  g should have in
+00002d40: 7374 7275 6d65 6e74 7320 616e 6420 7469  struments and ti
+00002d50: 6d65 2d64 6566 696e 6974 696f 6e73 2073  me-definitions s
+00002d60: 6570 6172 6174 6564 2062 7920 636f 6d6d  eparated by comm
+00002d70: 6173 2c20 652e 672e 2c20 6060 4645 524f  as, e.g., ``FERO
+00002d80: 532d 5444 422c 2048 4152 5053 2d55 5443  S-TDB, HARPS-UTC
+00002d90: 6060 2c20 6574 632e 0a0a 2020 2020 3a70  ``, etc...    :p
+00002da0: 6172 616d 206c 645f 6c61 7773 3a20 286f  aram ld_laws: (o
+00002db0: 7074 696f 6e61 6c2c 2073 7472 696e 6729  ptional, string)
+00002dc0: 0a20 2020 2020 2020 204c 696d 622d 6461  .        Limb-da
+00002dd0: 726b 656e 696e 6720 6c61 7720 746f 2062  rkening law to b
+00002de0: 6520 7573 6564 2066 6f72 2065 6163 6820  e used for each 
+00002df0: 696e 7374 7275 6d65 6e74 2e20 4465 6661  instrument. Defa
+00002e00: 756c 7420 6973 2060 6071 7561 6472 6174  ult is ``quadrat
+00002e10: 6963 6060 2066 6f72 2061 6c6c 2069 6e73  ic`` for all ins
+00002e20: 7472 756d 656e 7473 2e20 4966 206d 6f72  truments. If mor
+00002e30: 6520 7468 616e 206f 6e65 2069 6e73 7472  e than one instr
+00002e40: 756d 656e 7420 6973 2067 6976 656e 2c0a  ument is given,.
+00002e50: 2020 2020 2020 2020 7468 6973 2073 7472          this str
+00002e60: 696e 6720 7368 6f75 6c64 2068 6176 6520  ing should have 
+00002e70: 696e 7374 7275 6d65 6e74 7320 616e 6420  instruments and 
+00002e80: 6c69 6d62 2d64 6172 6b65 6e69 6e67 206c  limb-darkening l
+00002e90: 6177 7320 7365 7061 7261 7465 6420 6279  aws separated by
+00002ea0: 2063 6f6d 6d61 732c 2065 2e67 2e2c 2060   commas, e.g., `
+00002eb0: 6054 4553 532d 7175 6164 7261 7469 632c  `TESS-quadratic,
+00002ec0: 204c 434f 4754 2d6c 696e 6561 7260 602e   LCOGT-linear``.
+00002ed0: 0a0a 2020 2020 3a70 6172 616d 2070 7269  ..    :param pri
+00002ee0: 6f72 6669 6c65 3a20 286f 7074 696f 6e61  orfile: (optiona
+00002ef0: 6c2c 2073 7472 696e 6729 0a20 2020 2020  l, string).     
+00002f00: 2020 2049 6620 6120 7061 7468 2074 6f20     If a path to 
+00002f10: 6120 6669 6c65 2069 7320 6769 7665 6e2c  a file is given,
+00002f20: 2069 7420 7769 6c6c 2062 6520 6173 7375   it will be assu
+00002f30: 6d65 6420 7468 6973 2069 7320 6120 7072  med this is a pr
+00002f40: 696f 7220 6669 6c65 2e20 5468 6520 6060  ior file. The ``
+00002f50: 7072 696f 7273 6060 2064 6963 7469 6f6e  priors`` diction
+00002f60: 6172 7920 7769 6c6c 2062 6520 6f76 6572  ary will be over
+00002f70: 7772 6974 7465 6e20 6279 2074 6865 2064  written by the d
+00002f80: 6174 6120 696e 2074 6869 730a 2020 2020  ata in this.    
+00002f90: 2020 2020 6669 6c65 2e20 5468 6520 6669      file. The fi
+00002fa0: 6c65 2073 7472 7563 7475 7265 2069 7320  le structure is 
+00002fb0: 6120 706c 6169 6e20 6173 6369 6920 6669  a plain ascii fi
+00002fc0: 6c65 2c20 7769 7468 2074 6865 206e 616d  le, with the nam
+00002fd0: 6520 6f66 2074 6865 2070 6172 616d 6574  e of the paramet
+00002fe0: 6572 7320 696e 2074 6865 2066 6972 7374  ers in the first
+00002ff0: 2063 6f6c 756d 6e2c 206e 616d 6520 6f66   column, name of
+00003000: 2074 6865 2070 7269 6f72 2064 6973 7472   the prior distr
+00003010: 6962 7574 696f 6e20 696e 2074 6865 0a20  ibution in the. 
+00003020: 2020 2020 2020 2073 6563 6f6e 6420 636f         second co
+00003030: 6c75 6d6e 2061 6e64 2068 7970 6572 7061  lumn and hyperpa
+00003040: 7261 6d65 7465 7273 2069 6e20 7468 6520  rameters in the 
+00003050: 7468 6972 6420 636f 6c75 6d6e 2e0a 0a20  third column... 
+00003060: 2020 203a 7061 7261 6d20 6c63 5f69 6e73     :param lc_ins
+00003070: 7472 756d 656e 745f 7375 7065 7273 616d  trument_supersam
+00003080: 703a 2028 6f70 7469 6f6e 616c 2c20 6172  p: (optional, ar
+00003090: 7261 7920 6f66 2073 7472 696e 6773 290a  ray of strings).
+000030a0: 2020 2020 2020 2020 4465 6669 6e65 2066          Define f
+000030b0: 6f72 2077 6869 6368 206c 6967 6874 6375  or which lightcu
+000030c0: 7276 6520 696e 7374 7275 6d65 6e74 7320  rve instruments 
+000030d0: 7375 7065 722d 7361 6d70 6c69 6e67 2077  super-sampling w
+000030e0: 696c 6c20 6265 2061 7070 6c69 6564 2028  ill be applied (
+000030f0: 652e 672e 2c20 696e 2074 6865 2063 6173  e.g., in the cas
+00003100: 6520 6f66 206c 6f6e 672d 6361 6465 6e63  e of long-cadenc
+00003110: 6520 696e 7465 6772 6174 696f 6e73 292e  e integrations).
+00003120: 2065 2e67 2e2c 2060 606c 635f 696e 7374   e.g., ``lc_inst
+00003130: 7275 6d65 6e74 5f73 7570 6572 7361 6d70  rument_supersamp
+00003140: 203d 205b 2754 4553 5327 2c27 4b32 275d   = ['TESS','K2']
+00003150: 6060 0a0a 2020 2020 3a70 6172 616d 206c  ``..    :param l
+00003160: 635f 6e5f 7375 7065 7273 616d 703a 2028  c_n_supersamp: (
+00003170: 6f70 7469 6f6e 616c 2c20 6172 7261 7920  optional, array 
+00003180: 6f66 2069 6e74 7329 0a20 2020 2020 2020  of ints).       
+00003190: 2044 6566 696e 6520 7468 6520 6e75 6d62   Define the numb
+000031a0: 6572 206f 6620 6461 7461 706f 696e 7473  er of datapoints
+000031b0: 2074 6f20 7375 7065 7273 616d 706c 652e   to supersample.
+000031c0: 204f 7264 6572 2073 686f 756c 6420 6265   Order should be
+000031d0: 2063 6f6e 7369 7374 656e 7420 7769 7468   consistent with
+000031e0: 206f 7264 6572 2069 6e20 6060 6c63 5f69   order in ``lc_i
+000031f0: 6e73 7472 756d 656e 745f 7375 7065 7273  nstrument_supers
+00003200: 616d 7060 602e 2065 2e67 2e2c 2060 606c  amp``. e.g., ``l
+00003210: 635f 6e5f 7375 7065 7273 616d 7020 3d20  c_n_supersamp = 
+00003220: 5b32 302c 3330 5d60 602e 0a0a 2020 2020  [20,30]``...    
+00003230: 3a70 6172 616d 206c 635f 6578 7074 696d  :param lc_exptim
+00003240: 655f 7375 7065 7273 616d 703a 2028 6f70  e_supersamp: (op
+00003250: 7469 6f6e 616c 2c20 6172 7261 7920 6f66  tional, array of
+00003260: 2066 6c6f 6174 7329 0a20 2020 2020 2020   floats).       
+00003270: 2044 6566 696e 6520 7468 6520 6578 706f   Define the expo
+00003280: 7375 7265 2d74 696d 6520 6f66 2074 6865  sure-time of the
+00003290: 206f 6273 6572 7661 7469 6f6e 7320 666f   observations fo
+000032a0: 7220 7468 6520 7375 7065 7273 616d 706c  r the supersampl
+000032b0: 696e 672e 204f 7264 6572 2073 686f 756c  ing. Order shoul
+000032c0: 6420 6265 2063 6f6e 7369 7374 656e 7420  d be consistent 
+000032d0: 7769 7468 206f 7264 6572 2069 6e20 6060  with order in ``
+000032e0: 6c63 5f69 6e73 7472 756d 656e 745f 7375  lc_instrument_su
+000032f0: 7065 7273 616d 7060 602e 2065 2e67 2e2c  persamp``. e.g.,
+00003300: 2060 606c 635f 6578 7074 696d 655f 7375   ``lc_exptime_su
+00003310: 7065 7273 616d 7020 3d20 5b30 2e30 3230  persamp = [0.020
+00003320: 3433 342c 302e 3032 3034 3334 5d60 600a  434,0.020434]``.
+00003330: 0a20 2020 203a 7061 7261 6d20 7665 7262  .    :param verb
+00003340: 6f73 653a 2028 6f70 7469 6f6e 616c 2c20  ose: (optional, 
+00003350: 626f 6f6c 6561 6e29 0a20 2020 2020 2020  boolean).       
+00003360: 2049 6620 5472 7565 2c20 616c 6c20 6f75   If True, all ou
+00003370: 7470 7574 7320 6f66 2074 6865 2063 6f64  tputs of the cod
+00003380: 6520 6172 6520 7072 696e 7465 6420 746f  e are printed to
+00003390: 2074 6572 6d69 6e61 6c2e 2044 6566 6175   terminal. Defau
+000033a0: 6c74 2069 7320 4661 6c73 652e 0a0a 2020  lt is False...  
+000033b0: 2020 3a70 6172 616d 206d 6174 6572 6e5f    :param matern_
+000033c0: 6570 733a 2028 6f70 7469 6f6e 616c 2c20  eps: (optional, 
+000033d0: 666c 6f61 7429 0a20 2020 2020 2020 2045  float).        E
+000033e0: 7073 696c 6f6e 2070 6172 616d 6574 6572  psilon parameter
+000033f0: 2066 6f72 2074 6865 204d 6174 6572 6e20   for the Matern 
+00003400: 6170 7072 6f78 696d 6174 696f 6e20 2873  approximation (s
+00003410: 6565 2063 656c 6572 6974 6520 646f 6375  ee celerite docu
+00003420: 6d65 6e74 6174 696f 6e29 2e0a 0a20 2020  mentation)...   
+00003430: 203a 7061 7261 6d20 6765 6f72 6765 5f68   :param george_h
+00003440: 6f64 6c72 3a20 286f 7074 696f 6e61 6c2c  odlr: (optional,
+00003450: 2062 6f6f 6c29 0a20 2020 2020 2020 2046   bool).        F
+00003460: 6c61 6720 746f 2064 6566 696e 6520 6966  lag to define if
+00003470: 2079 6f75 2077 616e 7420 746f 2075 7365   you want to use
+00003480: 2074 6865 2048 4f44 4c52 2073 6f6c 7665   the HODLR solve
+00003490: 7220 666f 7220 6765 6f72 6765 2047 5027  r for george GP'
+000034a0: 7320 6f72 206e 6f74 2028 7365 6520 6874  s or not (see ht
+000034b0: 7470 3a2f 2f64 666d 2e69 6f2f 6765 6f72  tp://dfm.io/geor
+000034c0: 6765 2f63 7572 7265 6e74 2f75 7365 722f  ge/current/user/
+000034d0: 736f 6c76 6572 732f 292e 0a0a 2020 2020  solvers/)...    
+000034e0: 3a70 6172 616d 2070 6963 6b6c 655f 656e  :param pickle_en
+000034f0: 636f 6469 6e67 3a20 286f 7074 696f 6e61  coding: (optiona
+00003500: 6c2c 2073 7472 696e 6729 0a20 2020 2020  l, string).     
+00003510: 2020 2044 6566 696e 6520 7069 636b 6c65     Define pickle
+00003520: 2065 6e63 6f64 696e 6720 696e 2063 6173   encoding in cas
+00003530: 6520 6669 7420 7761 7320 646f 6e65 2077  e fit was done w
+00003540: 6974 6820 5079 7468 6f6e 2032 2e37 2061  ith Python 2.7 a
+00003550: 6e64 2072 6573 756c 7473 2061 7265 2072  nd results are r
+00003560: 6561 6420 7769 7468 2050 7974 686f 6e20  ead with Python 
+00003570: 332e 0a0a 2020 2020 2222 220a 0a20 2020  3...    """..   
+00003580: 2064 6566 2064 6174 615f 7072 6570 6172   def data_prepar
+00003590: 6174 696f 6e28 7365 6c66 2c20 7469 6d65  ation(self, time
+000035a0: 732c 2069 6e73 7472 756d 656e 7473 2c20  s, instruments, 
+000035b0: 6c69 6e65 6172 5f72 6567 7265 7373 6f72  linear_regressor
+000035c0: 7329 3a0a 2020 2020 2020 2020 2222 220a  s):.        """.
+000035d0: 2020 2020 2020 2020 5468 6973 2066 756e          This fun
+000035e0: 6374 696f 6e20 6765 6e65 7261 7465 7320  ction generates 
+000035f0: 6620 7573 6566 756c 2069 6e74 6572 6e61  f useful interna
+00003600: 6c20 6172 7261 7973 2066 6f72 2074 6869  l arrays for thi
+00003610: 7320 636c 6173 733a 2069 6e61 6d65 7320  s class: inames 
+00003620: 7768 6963 6820 7361 7665 7320 7468 6520  which saves the 
+00003630: 696e 7374 7275 6d65 6e74 206e 616d 6573  instrument names
+00003640: 2c20 6060 676c 6f62 616c 5f74 696d 6573  , ``global_times
+00003650: 6060 0a20 2020 2020 2020 2077 6869 6368  ``.        which
+00003660: 2069 7320 6120 2266 6c61 7474 656e 6564   is a "flattened
+00003670: 2220 6172 7261 7920 6f66 2074 6865 2060  " array of the `
+00003680: 6074 696d 6573 6060 2064 6963 7469 6f6e  `times`` diction
+00003690: 6172 7920 7768 6572 6520 616c 6c20 7468  ary where all th
+000036a0: 6520 7469 6d65 7320 666f 7220 616c 6c20  e times for all 
+000036b0: 696e 7374 7275 6d65 6e74 7320 6172 6520  instruments are 
+000036c0: 7374 6163 6b65 642c 2069 6e73 7472 756d  stacked, instrum
+000036d0: 656e 745f 696e 6465 7865 732c 0a20 2020  ent_indexes,.   
+000036e0: 2020 2020 2077 6869 6368 2069 7320 6120       which is a 
+000036f0: 6469 6374 696f 6e61 7279 2074 6861 7420  dictionary that 
+00003700: 6861 732c 2066 6f72 2065 6163 6820 696e  has, for each in
+00003710: 7374 7275 6d65 6e74 2074 6865 2069 6e64  strument the ind
+00003720: 6578 6573 206f 6620 7468 6520 6060 676c  exes of the ``gl
+00003730: 6f62 616c 5f74 696d 6573 6060 2063 6f72  obal_times`` cor
+00003740: 7265 7370 6f6e 6469 6e67 2074 6f20 6561  responding to ea
+00003750: 6368 2069 6e73 7472 756d 656e 742c 206c  ch instrument, l
+00003760: 6d5f 626f 6f6c 6561 6e20 7768 6963 6820  m_boolean which 
+00003770: 7361 7665 7320 626f 6f6c 6561 6e73 2066  saves booleans f
+00003780: 6f72 2065 6163 680a 2020 2020 2020 2020  or each.        
+00003790: 696e 7374 7275 6d65 6e74 2074 6f20 696e  instrument to in
+000037a0: 6469 6361 7465 2069 6620 7468 6572 6520  dicate if there 
+000037b0: 6172 6520 6c69 6e65 6172 2072 6567 7265  are linear regre
+000037c0: 7373 6f72 7320 616e 6420 6c6d 5f61 7267  ssors and lm_arg
+000037d0: 756d 656e 7473 2077 6869 6368 2061 7265  uments which are
+000037e0: 2074 6865 206c 696e 6561 722d 7265 6772   the linear-regr
+000037f0: 6573 736f 7273 2066 6f72 2065 6163 6820  essors for each 
+00003800: 696e 7374 7275 6d65 6e74 2e0a 2020 2020  instrument..    
+00003810: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00003820: 696e 616d 6573 203d 205b 5d0a 2020 2020  inames = [].    
+00003830: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00003840: 6765 286c 656e 2874 696d 6573 2929 3a0a  ge(len(times)):.
+00003850: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00003860: 6e73 7472 756d 656e 7473 5b69 5d20 6e6f  nstruments[i] no
+00003870: 7420 696e 2069 6e61 6d65 733a 0a20 2020  t in inames:.   
+00003880: 2020 2020 2020 2020 2020 2020 2069 6e61               ina
+00003890: 6d65 732e 6170 7065 6e64 2869 6e73 7472  mes.append(instr
+000038a0: 756d 656e 7473 5b69 5d29 0a20 2020 2020  uments[i]).     
+000038b0: 2020 206e 696e 7374 7275 6d65 6e74 7320     ninstruments 
+000038c0: 3d20 6c65 6e28 696e 616d 6573 290a 2020  = len(inames).  
+000038d0: 2020 2020 2020 696e 7374 7275 6d65 6e74        instrument
+000038e0: 5f69 6e64 6578 6573 203d 207b 7d0a 2020  _indexes = {}.  
+000038f0: 2020 2020 2020 666f 7220 696e 7374 7275        for instru
+00003900: 6d65 6e74 2069 6e20 696e 616d 6573 3a0a  ment in inames:.
+00003910: 2020 2020 2020 2020 2020 2020 696e 7374              inst
+00003920: 7275 6d65 6e74 5f69 6e64 6578 6573 5b69  rument_indexes[i
+00003930: 6e73 7472 756d 656e 745d 203d 206e 702e  nstrument] = np.
+00003940: 7768 6572 6528 0a20 2020 2020 2020 2020  where(.         
+00003950: 2020 2020 2020 2069 6e73 7472 756d 656e         instrumen
+00003960: 7473 203d 3d20 696e 7374 7275 6d65 6e74  ts == instrument
+00003970: 295b 305d 0a0a 2020 2020 2020 2020 2320  )[0]..        # 
+00003980: 416c 736f 2067 656e 6572 6174 6520 6c6d  Also generate lm
+00003990: 5f6c 635f 626f 6f6c 6561 6e20 696e 2063  _lc_boolean in c
+000039a0: 6173 6520 6c69 6e65 6172 2072 6567 7265  ase linear regre
+000039b0: 7373 6f72 7320 7765 7265 2070 6173 7365  ssors were passe
+000039c0: 643a 0a20 2020 2020 2020 206c 6d5f 626f  d:.        lm_bo
+000039d0: 6f6c 6561 6e20 3d20 7b7d 0a20 2020 2020  olean = {}.     
+000039e0: 2020 206c 6d5f 6172 6775 6d65 6e74 7320     lm_arguments 
+000039f0: 3d20 7b7d 0a20 2020 2020 2020 2069 6620  = {}.        if 
+00003a00: 6c69 6e65 6172 5f72 6567 7265 7373 6f72  linear_regressor
+00003a10: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+00003a20: 2020 2020 2020 2020 2020 206c 696e 6561             linea
+00003a30: 725f 696e 7374 7275 6d65 6e74 7320 3d20  r_instruments = 
+00003a40: 6c69 6e65 6172 5f72 6567 7265 7373 6f72  linear_regressor
+00003a50: 732e 6b65 7973 2829 0a20 2020 2020 2020  s.keys().       
+00003a60: 2020 2020 2066 6f72 2069 6e73 7472 756d       for instrum
+00003a70: 656e 7420 696e 2069 6e61 6d65 733a 0a20  ent in inames:. 
+00003a80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00003a90: 6620 696e 7374 7275 6d65 6e74 2069 6e20  f instrument in 
+00003aa0: 6c69 6e65 6172 5f69 6e73 7472 756d 656e  linear_instrumen
+00003ab0: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
+00003ac0: 2020 2020 2020 2020 6c6d 5f62 6f6f 6c65          lm_boole
+00003ad0: 616e 5b69 6e73 7472 756d 656e 745d 203d  an[instrument] =
+00003ae0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+00003af0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00003b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003b10: 6c6d 5f62 6f6f 6c65 616e 5b69 6e73 7472  lm_boolean[instr
+00003b20: 756d 656e 745d 203d 2046 616c 7365 0a20  ument] = False. 
+00003b30: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00003b40: 2020 2020 2020 2020 2066 6f72 2069 6e73           for ins
+00003b50: 7472 756d 656e 7420 696e 2069 6e61 6d65  trument in iname
+00003b60: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00003b70: 2020 206c 6d5f 626f 6f6c 6561 6e5b 696e     lm_boolean[in
+00003b80: 7374 7275 6d65 6e74 5d20 3d20 4661 6c73  strument] = Fals
+00003b90: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
+00003ba0: 2069 6e61 6d65 732c 2069 6e73 7472 756d   inames, instrum
+00003bb0: 656e 745f 696e 6465 7865 732c 206c 6d5f  ent_indexes, lm_
+00003bc0: 626f 6f6c 6561 6e0a 0a20 2020 2064 6566  boolean..    def
+00003bd0: 2063 6f6e 7665 7274 5f69 6e70 7574 5f64   convert_input_d
+00003be0: 6174 6128 7365 6c66 2c20 742c 2079 2c20  ata(self, t, y, 
+00003bf0: 7965 7272 293a 0a20 2020 2020 2020 2022  yerr):.        "
+00003c00: 2222 0a20 2020 2020 2020 2054 6869 7320  "".        This 
+00003c10: 636f 6e76 6572 7473 2074 6865 2069 6e70  converts the inp
+00003c20: 7574 2064 6963 7469 6f6e 6172 6965 7320  ut dictionaries 
+00003c30: 746f 2061 7272 6179 7320 2874 6869 7320  to arrays (this 
+00003c40: 6973 2065 6173 6965 7220 746f 2068 616e  is easier to han
+00003c50: 646c 6520 696e 7465 726e 616c 6c79 2077  dle internally w
+00003c60: 6974 6869 6e20 6a75 6c69 6574 3b20 696e  ithin juliet; in
+00003c70: 7075 7420 6469 6374 696f 6e61 7269 6573  put dictionaries
+00003c80: 2061 7265 206a 7573 7420 6173 6b65 6420   are just asked 
+00003c90: 6265 6361 7573 650a 2020 2020 2020 2020  because.        
+00003ca0: 6974 2069 7320 6561 7369 6572 2066 6f72  it is easier for
+00003cb0: 2074 6865 2075 7365 7220 746f 2070 6173   the user to pas
+00003cc0: 7320 7468 656d 292e 0a20 2020 2020 2020  s them)..       
+00003cd0: 2022 2222 0a20 2020 2020 2020 2069 6e73   """.        ins
+00003ce0: 7472 756d 656e 7473 203d 206c 6973 7428  truments = list(
+00003cf0: 742e 6b65 7973 2829 290a 2020 2020 2020  t.keys()).      
+00003d00: 2020 616c 6c5f 7469 6d65 7320 3d20 6e70    all_times = np
 00003d10: 2e61 7272 6179 285b 5d29 0a20 2020 2020  .array([]).     
-00003d20: 2020 2061 6c6c 5f79 6572 7220 3d20 6e70     all_yerr = np
-00003d30: 2e61 7272 6179 285b 5d29 0a20 2020 2020  .array([]).     
-00003d40: 2020 2061 6c6c 5f69 6e73 7472 756d 656e     all_instrumen
-00003d50: 7473 203d 206e 702e 6172 7261 7928 5b5d  ts = np.array([]
-00003d60: 290a 2020 2020 2020 2020 666f 7220 696e  ).        for in
-00003d70: 7374 7275 6d65 6e74 2069 6e20 696e 7374  strument in inst
-00003d80: 7275 6d65 6e74 733a 0a20 2020 2020 2020  ruments:.       
-00003d90: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-00003da0: 6e67 6528 6c65 6e28 745b 696e 7374 7275  nge(len(t[instru
-00003db0: 6d65 6e74 5d29 293a 0a20 2020 2020 2020  ment])):.       
-00003dc0: 2020 2020 2020 2020 2061 6c6c 5f74 696d           all_tim
-00003dd0: 6573 203d 206e 702e 6170 7065 6e64 2861  es = np.append(a
-00003de0: 6c6c 5f74 696d 6573 2c20 745b 696e 7374  ll_times, t[inst
-00003df0: 7275 6d65 6e74 5d5b 695d 290a 2020 2020  rument][i]).    
-00003e00: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
-00003e10: 7920 3d20 6e70 2e61 7070 656e 6428 616c  y = np.append(al
-00003e20: 6c5f 792c 2079 5b69 6e73 7472 756d 656e  l_y, y[instrumen
-00003e30: 745d 5b69 5d29 0a20 2020 2020 2020 2020  t][i]).         
-00003e40: 2020 2020 2020 2061 6c6c 5f79 6572 7220         all_yerr 
-00003e50: 3d20 6e70 2e61 7070 656e 6428 616c 6c5f  = np.append(all_
-00003e60: 7965 7272 2c20 7965 7272 5b69 6e73 7472  yerr, yerr[instr
-00003e70: 756d 656e 745d 5b69 5d29 0a20 2020 2020  ument][i]).     
-00003e80: 2020 2020 2020 2020 2020 2061 6c6c 5f69             all_i
-00003e90: 6e73 7472 756d 656e 7473 203d 206e 702e  nstruments = np.
-00003ea0: 6170 7065 6e64 2861 6c6c 5f69 6e73 7472  append(all_instr
-00003eb0: 756d 656e 7473 2c20 696e 7374 7275 6d65  uments, instrume
-00003ec0: 6e74 290a 2020 2020 2020 2020 7265 7475  nt).        retu
-00003ed0: 726e 2061 6c6c 5f74 696d 6573 2c20 616c  rn all_times, al
-00003ee0: 6c5f 792c 2061 6c6c 5f79 6572 722c 2061  l_y, all_yerr, a
-00003ef0: 6c6c 5f69 6e73 7472 756d 656e 7473 0a0a  ll_instruments..
-00003f00: 2020 2020 6465 6620 636f 6e76 6572 745f      def convert_
-00003f10: 746f 5f64 6963 7469 6f6e 6172 7928 7365  to_dictionary(se
-00003f20: 6c66 2c20 742c 2079 2c20 7965 7272 2c20  lf, t, y, yerr, 
-00003f30: 696e 7374 7275 6d65 6e74 5f69 6e64 6578  instrument_index
-00003f40: 6573 293a 0a20 2020 2020 2020 2022 2222  es):.        """
-00003f50: 0a20 2020 2020 2020 2043 6f6e 7665 7274  .        Convert
-00003f60: 2064 6174 6120 6769 7665 6e20 696e 2061   data given in a
-00003f70: 7272 6179 7320 746f 2064 6963 7469 6f6e  rrays to diction
-00003f80: 6172 6965 7320 666f 7220 6561 7369 6572  aries for easier
-00003f90: 2075 7365 7220 7573 6167 650a 2020 2020   user usage.    
-00003fa0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00003fb0: 7469 6d65 7320 3d20 7b7d 0a20 2020 2020  times = {}.     
-00003fc0: 2020 2064 6174 6120 3d20 7b7d 0a20 2020     data = {}.   
-00003fd0: 2020 2020 2065 7272 6f72 7320 3d20 7b7d       errors = {}
-00003fe0: 0a20 2020 2020 2020 2066 6f72 2069 6e73  .        for ins
-00003ff0: 7472 756d 656e 7420 696e 2069 6e73 7472  trument in instr
-00004000: 756d 656e 745f 696e 6465 7865 732e 6b65  ument_indexes.ke
-00004010: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
-00004020: 2020 7469 6d65 735b 696e 7374 7275 6d65    times[instrume
-00004030: 6e74 5d20 3d20 745b 696e 7374 7275 6d65  nt] = t[instrume
-00004040: 6e74 5f69 6e64 6578 6573 5b69 6e73 7472  nt_indexes[instr
-00004050: 756d 656e 745d 5d0a 2020 2020 2020 2020  ument]].        
-00004060: 2020 2020 6461 7461 5b69 6e73 7472 756d      data[instrum
-00004070: 656e 745d 203d 2079 5b69 6e73 7472 756d  ent] = y[instrum
-00004080: 656e 745f 696e 6465 7865 735b 696e 7374  ent_indexes[inst
-00004090: 7275 6d65 6e74 5d5d 0a20 2020 2020 2020  rument]].       
-000040a0: 2020 2020 2065 7272 6f72 735b 696e 7374       errors[inst
-000040b0: 7275 6d65 6e74 5d20 3d20 7965 7272 5b69  rument] = yerr[i
-000040c0: 6e73 7472 756d 656e 745f 696e 6465 7865  nstrument_indexe
-000040d0: 735b 696e 7374 7275 6d65 6e74 5d5d 0a20  s[instrument]]. 
-000040e0: 2020 2020 2020 2072 6574 7572 6e20 7469         return ti
-000040f0: 6d65 732c 2064 6174 612c 2065 7272 6f72  mes, data, error
-00004100: 730a 0a20 2020 2064 6566 2073 6176 655f  s..    def save_
-00004110: 7265 6772 6573 736f 7273 2873 656c 662c  regressors(self,
-00004120: 2066 6e61 6d65 2c20 4750 5f61 7267 756d   fname, GP_argum
-00004130: 656e 7473 293a 0a20 2020 2020 2020 2022  ents):.        "
-00004140: 2222 0a20 2020 2020 2020 2054 6869 7320  "".        This 
-00004150: 6675 6e63 7469 6f6e 2073 6176 6573 2074  function saves t
-00004160: 6865 2047 5020 7265 6772 6573 736f 7273  he GP regressors
-00004170: 2074 6f20 666e 616d 652e 0a20 2020 2020   to fname..     
-00004180: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-00004190: 6f75 7420 3d20 6f70 656e 2866 6e61 6d65  out = open(fname
-000041a0: 2c20 2777 2729 0a20 2020 2020 2020 2066  , 'w').        f
-000041b0: 6f72 2047 505f 696e 7374 7275 6d65 6e74  or GP_instrument
-000041c0: 2069 6e20 4750 5f61 7267 756d 656e 7473   in GP_arguments
-000041d0: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
-000041e0: 2020 2020 2047 505f 7265 6772 6573 736f       GP_regresso
-000041f0: 7273 203d 2047 505f 6172 6775 6d65 6e74  rs = GP_argument
-00004200: 735b 4750 5f69 6e73 7472 756d 656e 745d  s[GP_instrument]
-00004210: 0a20 2020 2020 2020 2020 2020 206d 756c  .            mul
-00004220: 7469 5f64 696d 656e 7369 6f6e 616c 203d  ti_dimensional =
-00004230: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-00004240: 2020 2069 6620 6c65 6e28 4750 5f72 6567     if len(GP_reg
-00004250: 7265 7373 6f72 732e 7368 6170 6529 203d  ressors.shape) =
-00004260: 3d20 323a 0a20 2020 2020 2020 2020 2020  = 2:.           
-00004270: 2020 2020 206d 756c 7469 5f64 696d 656e       multi_dimen
-00004280: 7369 6f6e 616c 203d 2054 7275 650a 2020  sional = True.  
-00004290: 2020 2020 2020 2020 2020 6966 206d 756c            if mul
-000042a0: 7469 5f64 696d 656e 7369 6f6e 616c 3a0a  ti_dimensional:.
-000042b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000042c0: 666f 7220 6920 696e 2072 616e 6765 2847  for i in range(G
-000042d0: 505f 7265 6772 6573 736f 7273 2e73 6861  P_regressors.sha
-000042e0: 7065 5b30 5d29 3a0a 2020 2020 2020 2020  pe[0]):.        
-000042f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00004300: 6a20 696e 2072 616e 6765 2847 505f 7265  j in range(GP_re
-00004310: 6772 6573 736f 7273 2e73 6861 7065 5b31  gressors.shape[1
-00004320: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-00004330: 2020 2020 2020 2020 2020 2020 666f 7574              fout
-00004340: 2e77 7269 7465 2827 7b30 3a2e 3130 667d  .write('{0:.10f}
-00004350: 2027 2e66 6f72 6d61 7428 4750 5f72 6567   '.format(GP_reg
-00004360: 7265 7373 6f72 735b 692c 206a 5d29 290a  ressors[i, j])).
-00004370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004380: 2020 2020 666f 7574 2e77 7269 7465 2827      fout.write('
-00004390: 7b30 3a7d 5c6e 272e 666f 726d 6174 2847  {0:}\n'.format(G
-000043a0: 505f 696e 7374 7275 6d65 6e74 2929 0a20  P_instrument)). 
-000043b0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000043c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000043d0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-000043e0: 4750 5f72 6567 7265 7373 6f72 732e 7368  GP_regressors.sh
-000043f0: 6170 655b 305d 293a 0a20 2020 2020 2020  ape[0]):.       
-00004400: 2020 2020 2020 2020 2020 2020 2066 6f75               fou
-00004410: 742e 7772 6974 6528 277b 303a 2e31 3066  t.write('{0:.10f
-00004420: 7d20 7b31 3a7d 5c6e 272e 666f 726d 6174  } {1:}\n'.format
-00004430: 2847 505f 7265 6772 6573 736f 7273 5b69  (GP_regressors[i
-00004440: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00004450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d20: 2020 2061 6c6c 5f79 203d 206e 702e 6172     all_y = np.ar
+00003d30: 7261 7928 5b5d 290a 2020 2020 2020 2020  ray([]).        
+00003d40: 616c 6c5f 7965 7272 203d 206e 702e 6172  all_yerr = np.ar
+00003d50: 7261 7928 5b5d 290a 2020 2020 2020 2020  ray([]).        
+00003d60: 616c 6c5f 696e 7374 7275 6d65 6e74 7320  all_instruments 
+00003d70: 3d20 6e70 2e61 7272 6179 285b 5d29 0a20  = np.array([]). 
+00003d80: 2020 2020 2020 2066 6f72 2069 6e73 7472         for instr
+00003d90: 756d 656e 7420 696e 2069 6e73 7472 756d  ument in instrum
+00003da0: 656e 7473 3a0a 2020 2020 2020 2020 2020  ents:.          
+00003db0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+00003dc0: 286c 656e 2874 5b69 6e73 7472 756d 656e  (len(t[instrumen
+00003dd0: 745d 2929 3a0a 2020 2020 2020 2020 2020  t])):.          
+00003de0: 2020 2020 2020 616c 6c5f 7469 6d65 7320        all_times 
+00003df0: 3d20 6e70 2e61 7070 656e 6428 616c 6c5f  = np.append(all_
+00003e00: 7469 6d65 732c 2074 5b69 6e73 7472 756d  times, t[instrum
+00003e10: 656e 745d 5b69 5d29 0a20 2020 2020 2020  ent][i]).       
+00003e20: 2020 2020 2020 2020 2061 6c6c 5f79 203d           all_y =
+00003e30: 206e 702e 6170 7065 6e64 2861 6c6c 5f79   np.append(all_y
+00003e40: 2c20 795b 696e 7374 7275 6d65 6e74 5d5b  , y[instrument][
+00003e50: 695d 290a 2020 2020 2020 2020 2020 2020  i]).            
+00003e60: 2020 2020 616c 6c5f 7965 7272 203d 206e      all_yerr = n
+00003e70: 702e 6170 7065 6e64 2861 6c6c 5f79 6572  p.append(all_yer
+00003e80: 722c 2079 6572 725b 696e 7374 7275 6d65  r, yerr[instrume
+00003e90: 6e74 5d5b 695d 290a 2020 2020 2020 2020  nt][i]).        
+00003ea0: 2020 2020 2020 2020 616c 6c5f 696e 7374          all_inst
+00003eb0: 7275 6d65 6e74 7320 3d20 6e70 2e61 7070  ruments = np.app
+00003ec0: 656e 6428 616c 6c5f 696e 7374 7275 6d65  end(all_instrume
+00003ed0: 6e74 732c 2069 6e73 7472 756d 656e 7429  nts, instrument)
+00003ee0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00003ef0: 616c 6c5f 7469 6d65 732c 2061 6c6c 5f79  all_times, all_y
+00003f00: 2c20 616c 6c5f 7965 7272 2c20 616c 6c5f  , all_yerr, all_
+00003f10: 696e 7374 7275 6d65 6e74 730a 0a20 2020  instruments..   
+00003f20: 2064 6566 2063 6f6e 7665 7274 5f74 6f5f   def convert_to_
+00003f30: 6469 6374 696f 6e61 7279 2873 656c 662c  dictionary(self,
+00003f40: 2074 2c20 792c 2079 6572 722c 2069 6e73   t, y, yerr, ins
+00003f50: 7472 756d 656e 745f 696e 6465 7865 7329  trument_indexes)
+00003f60: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00003f70: 2020 2020 2020 436f 6e76 6572 7420 6461        Convert da
+00003f80: 7461 2067 6976 656e 2069 6e20 6172 7261  ta given in arra
+00003f90: 7973 2074 6f20 6469 6374 696f 6e61 7269  ys to dictionari
+00003fa0: 6573 2066 6f72 2065 6173 6965 7220 7573  es for easier us
+00003fb0: 6572 2075 7361 6765 0a20 2020 2020 2020  er usage.       
+00003fc0: 2022 2222 0a20 2020 2020 2020 2074 696d   """.        tim
+00003fd0: 6573 203d 207b 7d0a 2020 2020 2020 2020  es = {}.        
+00003fe0: 6461 7461 203d 207b 7d0a 2020 2020 2020  data = {}.      
+00003ff0: 2020 6572 726f 7273 203d 207b 7d0a 2020    errors = {}.  
+00004000: 2020 2020 2020 666f 7220 696e 7374 7275        for instru
+00004010: 6d65 6e74 2069 6e20 696e 7374 7275 6d65  ment in instrume
+00004020: 6e74 5f69 6e64 6578 6573 2e6b 6579 7328  nt_indexes.keys(
+00004030: 293a 0a20 2020 2020 2020 2020 2020 2074  ):.            t
+00004040: 696d 6573 5b69 6e73 7472 756d 656e 745d  imes[instrument]
+00004050: 203d 2074 5b69 6e73 7472 756d 656e 745f   = t[instrument_
+00004060: 696e 6465 7865 735b 696e 7374 7275 6d65  indexes[instrume
+00004070: 6e74 5d5d 0a20 2020 2020 2020 2020 2020  nt]].           
+00004080: 2064 6174 615b 696e 7374 7275 6d65 6e74   data[instrument
+00004090: 5d20 3d20 795b 696e 7374 7275 6d65 6e74  ] = y[instrument
+000040a0: 5f69 6e64 6578 6573 5b69 6e73 7472 756d  _indexes[instrum
+000040b0: 656e 745d 5d0a 2020 2020 2020 2020 2020  ent]].          
+000040c0: 2020 6572 726f 7273 5b69 6e73 7472 756d    errors[instrum
+000040d0: 656e 745d 203d 2079 6572 725b 696e 7374  ent] = yerr[inst
+000040e0: 7275 6d65 6e74 5f69 6e64 6578 6573 5b69  rument_indexes[i
+000040f0: 6e73 7472 756d 656e 745d 5d0a 2020 2020  nstrument]].    
+00004100: 2020 2020 7265 7475 726e 2074 696d 6573      return times
+00004110: 2c20 6461 7461 2c20 6572 726f 7273 0a0a  , data, errors..
+00004120: 2020 2020 6465 6620 7361 7665 5f72 6567      def save_reg
+00004130: 7265 7373 6f72 7328 7365 6c66 2c20 666e  ressors(self, fn
+00004140: 616d 652c 2047 505f 6172 6775 6d65 6e74  ame, GP_argument
+00004150: 7329 3a0a 2020 2020 2020 2020 2222 220a  s):.        """.
+00004160: 2020 2020 2020 2020 5468 6973 2066 756e          This fun
+00004170: 6374 696f 6e20 7361 7665 7320 7468 6520  ction saves the 
+00004180: 4750 2072 6567 7265 7373 6f72 7320 746f  GP regressors to
+00004190: 2066 6e61 6d65 2e0a 2020 2020 2020 2020   fname..        
+000041a0: 2222 220a 2020 2020 2020 2020 666f 7574  """.        fout
+000041b0: 203d 206f 7065 6e28 666e 616d 652c 2027   = open(fname, '
+000041c0: 7727 290a 2020 2020 2020 2020 666f 7220  w').        for 
+000041d0: 4750 5f69 6e73 7472 756d 656e 7420 696e  GP_instrument in
+000041e0: 2047 505f 6172 6775 6d65 6e74 732e 6b65   GP_arguments.ke
+000041f0: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
+00004200: 2020 4750 5f72 6567 7265 7373 6f72 7320    GP_regressors 
+00004210: 3d20 4750 5f61 7267 756d 656e 7473 5b47  = GP_arguments[G
+00004220: 505f 696e 7374 7275 6d65 6e74 5d0a 2020  P_instrument].  
+00004230: 2020 2020 2020 2020 2020 6d75 6c74 695f            multi_
+00004240: 6469 6d65 6e73 696f 6e61 6c20 3d20 4661  dimensional = Fa
+00004250: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00004260: 6966 206c 656e 2847 505f 7265 6772 6573  if len(GP_regres
+00004270: 736f 7273 2e73 6861 7065 2920 3d3d 2032  sors.shape) == 2
+00004280: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00004290: 2020 6d75 6c74 695f 6469 6d65 6e73 696f    multi_dimensio
+000042a0: 6e61 6c20 3d20 5472 7565 0a20 2020 2020  nal = True.     
+000042b0: 2020 2020 2020 2069 6620 6d75 6c74 695f         if multi_
+000042c0: 6469 6d65 6e73 696f 6e61 6c3a 0a20 2020  dimensional:.   
+000042d0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+000042e0: 2069 2069 6e20 7261 6e67 6528 4750 5f72   i in range(GP_r
+000042f0: 6567 7265 7373 6f72 732e 7368 6170 655b  egressors.shape[
+00004300: 305d 293a 0a20 2020 2020 2020 2020 2020  0]):.           
+00004310: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
+00004320: 6e20 7261 6e67 6528 4750 5f72 6567 7265  n range(GP_regre
+00004330: 7373 6f72 732e 7368 6170 655b 315d 293a  ssors.shape[1]):
+00004340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004350: 2020 2020 2020 2020 2066 6f75 742e 7772           fout.wr
+00004360: 6974 6528 277b 303a 2e31 3066 7d20 272e  ite('{0:.10f} '.
+00004370: 666f 726d 6174 2847 505f 7265 6772 6573  format(GP_regres
+00004380: 736f 7273 5b69 2c20 6a5d 2929 0a20 2020  sors[i, j])).   
+00004390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000043a0: 2066 6f75 742e 7772 6974 6528 277b 303a   fout.write('{0:
+000043b0: 7d5c 6e27 2e66 6f72 6d61 7428 4750 5f69  }\n'.format(GP_i
+000043c0: 6e73 7472 756d 656e 7429 290a 2020 2020  nstrument)).    
+000043d0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000043e0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+000043f0: 7220 6920 696e 2072 616e 6765 2847 505f  r i in range(GP_
+00004400: 7265 6772 6573 736f 7273 2e73 6861 7065  regressors.shape
+00004410: 5b30 5d29 3a0a 2020 2020 2020 2020 2020  [0]):.          
+00004420: 2020 2020 2020 2020 2020 666f 7574 2e77            fout.w
+00004430: 7269 7465 2827 7b30 3a2e 3130 667d 207b  rite('{0:.10f} {
+00004440: 313a 7d5c 6e27 2e66 6f72 6d61 7428 4750  1:}\n'.format(GP
+00004450: 5f72 6567 7265 7373 6f72 735b 695d 2c0a  _regressors[i],.
 00004460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004470: 2020 2020 2020 2020 2020 2047 505f 696e             GP_in
-00004480: 7374 7275 6d65 6e74 2929 0a20 2020 2020  strument)).     
-00004490: 2020 2066 6f75 742e 636c 6f73 6528 290a     fout.close().
-000044a0: 0a20 2020 2064 6566 2073 6176 655f 6461  .    def save_da
-000044b0: 7461 2873 656c 662c 2066 6e61 6d65 2c20  ta(self, fname, 
-000044c0: 742c 2079 2c20 7965 7272 2c20 696e 7374  t, y, yerr, inst
-000044d0: 7275 6d65 6e74 732c 206c 6d5f 626f 6f6c  ruments, lm_bool
-000044e0: 6561 6e2c 0a20 2020 2020 2020 2020 2020  ean,.           
-000044f0: 2020 2020 2020 206c 6d5f 6172 6775 6d65         lm_argume
-00004500: 6e74 7329 3a0a 2020 2020 2020 2020 2222  nts):.        ""
-00004510: 220a 2020 2020 2020 2020 5468 6973 2066  ".        This f
-00004520: 756e 6374 696f 6e20 7361 7665 7320 742c  unction saves t,
-00004530: 792c 7965 7272 2c69 6e73 7472 756d 656e  y,yerr,instrumen
-00004540: 7473 2c6c 6d5f 626f 6f6c 6561 6e20 616e  ts,lm_boolean an
-00004550: 6420 6c6d 5f61 7267 756d 656e 7473 2064  d lm_arguments d
-00004560: 6174 6120 746f 2066 6e61 6d65 2e0a 2020  ata to fname..  
-00004570: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00004580: 2020 666f 7574 203d 206f 7065 6e28 666e    fout = open(fn
-00004590: 616d 652c 2027 7727 290a 2020 2020 2020  ame, 'w').      
-000045a0: 2020 6c6d 5f63 6f75 6e74 6572 7320 3d20    lm_counters = 
-000045b0: 7b7d 0a20 2020 2020 2020 2066 6f72 2069  {}.        for i
-000045c0: 2069 6e20 7261 6e67 6528 6c65 6e28 7429   in range(len(t)
-000045d0: 293a 0a0a 2020 2020 2020 2020 2020 2020  ):..            
-000045e0: 666f 7574 2e77 7269 7465 2827 7b30 3a2e  fout.write('{0:.
-000045f0: 3130 667d 207b 313a 2e31 3066 7d20 7b32  10f} {1:.10f} {2
-00004600: 3a2e 3130 667d 207b 333a 7d27 2e66 6f72  :.10f} {3:}'.for
-00004610: 6d61 7428 0a20 2020 2020 2020 2020 2020  mat(.           
-00004620: 2020 2020 2074 5b69 5d2c 2079 5b69 5d2c       t[i], y[i],
-00004630: 2079 6572 725b 695d 2c20 696e 7374 7275   yerr[i], instru
-00004640: 6d65 6e74 735b 695d 2929 0a0a 2020 2020  ments[i]))..    
-00004650: 2020 2020 2020 2020 6966 206c 6d5f 626f          if lm_bo
-00004660: 6f6c 6561 6e5b 696e 7374 7275 6d65 6e74  olean[instrument
-00004670: 735b 695d 5d3a 0a0a 2020 2020 2020 2020  s[i]]:..        
-00004680: 2020 2020 2020 2020 6966 2069 6e73 7472          if instr
-00004690: 756d 656e 7473 5b69 5d20 6e6f 7420 696e  uments[i] not in
-000046a0: 206c 6d5f 636f 756e 7465 7273 2e6b 6579   lm_counters.key
-000046b0: 7328 293a 0a0a 2020 2020 2020 2020 2020  s():..          
-000046c0: 2020 2020 2020 2020 2020 6c6d 5f63 6f75            lm_cou
-000046d0: 6e74 6572 735b 696e 7374 7275 6d65 6e74  nters[instrument
-000046e0: 735b 695d 5d20 3d20 300a 0a20 2020 2020  s[i]] = 0..     
-000046f0: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
-00004700: 2069 6e20 7261 6e67 6528 6c6d 5f61 7267   in range(lm_arg
-00004710: 756d 656e 7473 5b69 6e73 7472 756d 656e  uments[instrumen
-00004720: 7473 5b69 5d5d 2e73 6861 7065 5b31 5d29  ts[i]].shape[1])
-00004730: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-00004740: 2020 2020 2020 2066 6f75 742e 7772 6974         fout.writ
-00004750: 6528 2720 7b30 3a2e 3130 667d 272e 666f  e(' {0:.10f}'.fo
-00004760: 726d 6174 286c 6d5f 6172 6775 6d65 6e74  rmat(lm_argument
-00004770: 735b 696e 7374 7275 6d65 6e74 735b 695d  s[instruments[i]
-00004780: 5d5b 0a0a 2020 2020 2020 2020 2020 2020  ][..            
-00004790: 2020 2020 2020 2020 2020 2020 6c6d 5f63              lm_c
-000047a0: 6f75 6e74 6572 735b 696e 7374 7275 6d65  ounters[instrume
-000047b0: 6e74 735b 695d 5d5d 5b6a 5d29 290a 0a20  nts[i]]][j])).. 
-000047c0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-000047d0: 6d5f 636f 756e 7465 7273 5b69 6e73 7472  m_counters[instr
-000047e0: 756d 656e 7473 5b69 5d5d 202b 3d20 310a  uments[i]] += 1.
-000047f0: 0a20 2020 2020 2020 2020 2020 2066 6f75  .            fou
-00004800: 742e 7772 6974 6528 275c 6e27 290a 0a20  t.write('\n').. 
-00004810: 2020 2020 2020 2066 6f75 742e 636c 6f73         fout.clos
-00004820: 6528 290a 0a20 2020 2064 6566 2073 6176  e()..    def sav
-00004830: 655f 7072 696f 7266 696c 6528 7365 6c66  e_priorfile(self
-00004840: 2c20 666e 616d 6529 3a0a 2020 2020 2020  , fname):.      
-00004850: 2020 2222 220a 2020 2020 2020 2020 5468    """.        Th
-00004860: 6973 2066 756e 6374 696f 6e20 7361 7665  is function save
-00004870: 7320 6120 7072 696f 7266 696c 6520 6669  s a priorfile fi
-00004880: 6c65 206f 7574 2074 6f20 666e 616d 650a  le out to fname.
-00004890: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000048a0: 2020 2020 666f 7574 203d 206f 7065 6e28      fout = open(
-000048b0: 666e 616d 652c 2027 7727 290a 2020 2020  fname, 'w').    
-000048c0: 2020 2020 666f 7220 706e 616d 6520 696e      for pname in
-000048d0: 2073 656c 662e 7072 696f 7273 2e6b 6579   self.priors.key
-000048e0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-000048f0: 2069 6620 7365 6c66 2e70 7269 6f72 735b   if self.priors[
-00004900: 706e 616d 655d 5b27 6469 7374 7269 6275  pname]['distribu
-00004910: 7469 6f6e 275d 2e6c 6f77 6572 2829 2021  tion'].lower() !
-00004920: 3d20 2766 6978 6564 273a 0a20 2020 2020  = 'fixed':.     
-00004930: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00004940: 203d 2027 2c27 2e6a 6f69 6e28 0a20 2020   = ','.join(.   
-00004950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004960: 206e 702e 6172 7261 7928 7365 6c66 2e70   np.array(self.p
-00004970: 7269 6f72 735b 706e 616d 655d 5b27 6879  riors[pname]['hy
-00004980: 7065 7270 6172 616d 6574 6572 7327 5d29  perparameters'])
-00004990: 2e61 7374 7970 6528 7374 7229 290a 2020  .astype(str)).  
-000049a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000049b0: 2073 656c 662e 7374 6172 7469 6e67 5f70   self.starting_p
-000049c0: 6f69 6e74 2069 7320 6e6f 7420 4e6f 6e65  oint is not None
-000049d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000049e0: 2020 2020 2020 666f 7574 2e77 7269 7465        fout.write
-000049f0: 2827 7b30 3a20 3c32 307d 207b 313a 203c  ('{0: <20} {1: <
-00004a00: 3230 7d20 7b32 3a20 3c32 307d 207b 333a  20} {2: <20} {3:
-00004a10: 203c 3230 7d5c 6e27 2e66 6f72 6d61 7428   <20}\n'.format(
-00004a20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004a30: 2020 2020 2020 2020 2070 6e61 6d65 2c20           pname, 
-00004a40: 7365 6c66 2e70 7269 6f72 735b 706e 616d  self.priors[pnam
-00004a50: 655d 5b27 6469 7374 7269 6275 7469 6f6e  e]['distribution
-00004a60: 275d 2c20 7661 6c75 652c 0a20 2020 2020  '], value,.     
-00004a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a80: 2020 2073 656c 662e 7374 6172 7469 6e67     self.starting
-00004a90: 5f70 6f69 6e74 5b70 6e61 6d65 5d29 290a  _point[pname])).
-00004aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ab0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00004ac0: 2020 2020 2020 2020 2020 666f 7574 2e77            fout.w
-00004ad0: 7269 7465 2827 7b30 3a20 3c32 307d 207b  rite('{0: <20} {
-00004ae0: 313a 203c 3230 7d20 7b32 3a20 3c32 307d  1: <20} {2: <20}
-00004af0: 5c6e 272e 666f 726d 6174 280a 2020 2020  \n'.format(.    
-00004b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004b10: 2020 2020 706e 616d 652c 2073 656c 662e      pname, self.
-00004b20: 7072 696f 7273 5b70 6e61 6d65 5d5b 2764  priors[pname]['d
-00004b30: 6973 7472 6962 7574 696f 6e27 5d2c 2076  istribution'], v
-00004b40: 616c 7565 2929 0a20 2020 2020 2020 2020  alue)).         
-00004b50: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00004b60: 2020 2020 2020 2020 2076 616c 7565 203d           value =
-00004b70: 2073 7472 2873 656c 662e 7072 696f 7273   str(self.priors
-00004b80: 5b70 6e61 6d65 5d5b 2768 7970 6572 7061  [pname]['hyperpa
-00004b90: 7261 6d65 7465 7273 275d 290a 2020 2020  rameters']).    
-00004ba0: 2020 2020 2020 2020 2020 2020 666f 7574              fout
-00004bb0: 2e77 7269 7465 2827 7b30 3a20 3c32 307d  .write('{0: <20}
-00004bc0: 207b 313a 203c 3230 7d20 7b32 3a20 3c32   {1: <20} {2: <2
-00004bd0: 307d 5c6e 272e 666f 726d 6174 280a 2020  0}\n'.format(.  
-00004be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004bf0: 2020 706e 616d 652c 2073 656c 662e 7072    pname, self.pr
-00004c00: 696f 7273 5b70 6e61 6d65 5d5b 2764 6973  iors[pname]['dis
-00004c10: 7472 6962 7574 696f 6e27 5d2c 2076 616c  tribution'], val
-00004c20: 7565 2929 0a20 2020 2020 2020 2066 6f75  ue)).        fou
-00004c30: 742e 636c 6f73 6528 290a 0a20 2020 2064  t.close()..    d
-00004c40: 6566 2063 6865 636b 5f67 6c6f 6261 6c28  ef check_global(
-00004c50: 7365 6c66 2c20 6e61 6d65 293a 0a20 2020  self, name):.   
-00004c60: 2020 2020 2066 6f72 2070 6e61 6d65 2069       for pname i
-00004c70: 6e20 7365 6c66 2e70 7269 6f72 732e 6b65  n self.priors.ke
-00004c80: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
-00004c90: 2020 6966 206e 616d 6520 696e 2070 6e61    if name in pna
-00004ca0: 6d65 2e73 706c 6974 2827 5f27 295b 313a  me.split('_')[1:
-00004cb0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-00004cc0: 2020 2072 6574 7572 6e20 5472 7565 0a20     return True. 
-00004cd0: 2020 2020 2020 2072 6574 7572 6e20 4661         return Fa
-00004ce0: 6c73 650a 0a20 2020 2064 6566 2061 7070  lse..    def app
-00004cf0: 656e 645f 4750 2873 656c 662c 206e 6461  end_GP(self, nda
-00004d00: 7461 2c20 696e 7374 7275 6d65 6e74 5f69  ta, instrument_i
-00004d10: 6e64 6578 6573 2c20 4750 5f61 7267 756d  ndexes, GP_argum
-00004d20: 656e 7473 2c20 696e 616d 6573 293a 0a20  ents, inames):. 
-00004d30: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00004d40: 2020 2020 2020 2054 6869 7320 6675 6e63         This func
-00004d50: 7469 6f6e 2061 7070 656e 6473 2061 6c6c  tion appends all
-00004d60: 2074 6865 2047 5020 7265 6772 6573 736f   the GP regresso
-00004d70: 7273 2069 6e74 6f20 6f6e 6520 2d2d 2d20  rs into one --- 
-00004d80: 7573 6566 756c 2066 6f72 2074 6865 2067  useful for the g
-00004d90: 6c6f 6261 6c20 6d6f 6465 6c73 2e0a 2020  lobal models..  
-00004da0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00004db0: 2020 2320 4669 7273 7420 6368 6563 6b20    # First check 
-00004dc0: 6966 2047 5020 7265 6772 6573 736f 7273  if GP regressors
-00004dd0: 2061 7265 206d 756c 7469 2d64 696d 656e   are multi-dimen
-00004de0: 7369 6f6e 616c 202d 2d2d 2063 6865 636b  sional --- check
-00004df0: 2074 6869 7320 6a75 7374 2066 6f72 2074   this just for t
-00004e00: 6865 2066 6972 7374 2069 6e73 7472 756d  he first instrum
-00004e10: 656e 743a 0a20 2020 2020 2020 2069 6620  ent:.        if 
-00004e20: 6c65 6e28 4750 5f61 7267 756d 656e 7473  len(GP_arguments
-00004e30: 5b69 6e61 6d65 735b 305d 5d2e 7368 6170  [inames[0]].shap
-00004e40: 6529 203d 3d20 323a 0a20 2020 2020 2020  e) == 2:.       
-00004e50: 2020 2020 206e 7265 6772 6573 736f 7273       nregressors
-00004e60: 203d 2047 505f 6172 6775 6d65 6e74 735b   = GP_arguments[
-00004e70: 696e 616d 6573 5b30 5d5d 2e73 6861 7065  inames[0]].shape
-00004e80: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-00004e90: 6d75 6c74 6964 696d 656e 7369 6f6e 616c  multidimensional
-00004ea0: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
-00004eb0: 2020 2020 6f75 7420 3d20 6e70 2e7a 6572      out = np.zer
-00004ec0: 6f73 285b 6e64 6174 612c 206e 7265 6772  os([ndata, nregr
-00004ed0: 6573 736f 7273 5d29 0a20 2020 2020 2020  essors]).       
-00004ee0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00004ef0: 2020 206d 756c 7469 6469 6d65 6e73 696f     multidimensio
-00004f00: 6e61 6c20 3d20 4661 6c73 650a 2020 2020  nal = False.    
-00004f10: 2020 2020 2020 2020 6f75 7420 3d20 6e70          out = np
-00004f20: 2e7a 6572 6f73 286e 6461 7461 290a 2020  .zeros(ndata).  
-00004f30: 2020 2020 2020 666f 7220 696e 7374 7275        for instru
-00004f40: 6d65 6e74 2069 6e20 696e 616d 6573 3a0a  ment in inames:.
-00004f50: 2020 2020 2020 2020 2020 2020 6966 206d              if m
-00004f60: 756c 7469 6469 6d65 6e73 696f 6e61 6c3a  ultidimensional:
-00004f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004f80: 206f 7574 5b69 6e73 7472 756d 656e 745f   out[instrument_
-00004f90: 696e 6465 7865 735b 696e 7374 7275 6d65  indexes[instrume
-00004fa0: 6e74 5d2c 203a 5d20 3d20 4750 5f61 7267  nt], :] = GP_arg
-00004fb0: 756d 656e 7473 5b0a 2020 2020 2020 2020  uments[.        
-00004fc0: 2020 2020 2020 2020 2020 2020 696e 7374              inst
-00004fd0: 7275 6d65 6e74 5d0a 2020 2020 2020 2020  rument].        
-00004fe0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00004ff0: 2020 2020 2020 2020 2020 6f75 745b 696e            out[in
-00005000: 7374 7275 6d65 6e74 5f69 6e64 6578 6573  strument_indexes
-00005010: 5b69 6e73 7472 756d 656e 745d 5d20 3d20  [instrument]] = 
-00005020: 4750 5f61 7267 756d 656e 7473 5b69 6e73  GP_arguments[ins
-00005030: 7472 756d 656e 745d 0a20 2020 2020 2020  trument].       
-00005040: 2072 6574 7572 6e20 6f75 740a 0a20 2020   return out..   
-00005050: 2064 6566 2073 6f72 745f 4750 2873 656c   def sort_GP(sel
-00005060: 662c 2064 6963 7479 7065 293a 0a20 2020  f, dictype):.   
-00005070: 2020 2020 2069 6620 6469 6374 7970 6520       if dictype 
-00005080: 3d3d 2027 6c63 273a 0a20 2020 2020 2020  == 'lc':.       
-00005090: 2020 2020 2023 2053 6f72 7420 6669 7273       # Sort firs
-000050a0: 7420 7469 6d65 732c 2066 6c75 7865 732c  t times, fluxes,
-000050b0: 2065 7272 6f72 7320 616e 6420 7468 6520   errors and the 
-000050c0: 4750 2072 6567 7265 7373 6f72 3a0a 2020  GP regressor:.  
-000050d0: 2020 2020 2020 2020 2020 6964 785f 736f            idx_so
-000050e0: 7274 203d 206e 702e 6172 6773 6f72 7428  rt = np.argsort(
-000050f0: 7365 6c66 2e47 505f 6c63 5f61 7267 756d  self.GP_lc_argum
-00005100: 656e 7473 5b27 6c63 275d 5b3a 2c20 305d  ents['lc'][:, 0]
-00005110: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00005120: 6c66 2e74 5f6c 6320 3d20 7365 6c66 2e74  lf.t_lc = self.t
-00005130: 5f6c 635b 6964 785f 736f 7274 5d0a 2020  _lc[idx_sort].  
-00005140: 2020 2020 2020 2020 2020 7365 6c66 2e79            self.y
-00005150: 5f6c 6320 3d20 7365 6c66 2e79 5f6c 635b  _lc = self.y_lc[
-00005160: 6964 785f 736f 7274 5d0a 2020 2020 2020  idx_sort].      
-00005170: 2020 2020 2020 7365 6c66 2e79 6572 725f        self.yerr_
-00005180: 6c63 203d 2073 656c 662e 7965 7272 5f6c  lc = self.yerr_l
-00005190: 635b 6964 785f 736f 7274 5d0a 0a20 2020  c[idx_sort]..   
-000051a0: 2020 2020 2020 2020 2073 656c 662e 4750           self.GP
-000051b0: 5f6c 635f 6172 6775 6d65 6e74 735b 276c  _lc_arguments['l
-000051c0: 6327 5d5b 3a2c 305d 203d 2073 656c 662e  c'][:,0] = self.
-000051d0: 4750 5f6c 635f 6172 6775 6d65 6e74 735b  GP_lc_arguments[
-000051e0: 276c 6327 5d5b 6964 785f 736f 7274 2c30  'lc'][idx_sort,0
-000051f0: 5d0a 0a20 2020 2020 2020 2020 2020 2023  ]..            #
-00005200: 204e 6f77 2077 6974 6820 7468 6520 736f   Now with the so
-00005210: 7274 6564 2069 6e64 6963 6573 2c20 6974  rted indices, it
-00005220: 6572 6174 6520 7468 726f 7567 6820 7468  erate through th
-00005230: 6520 696e 7374 7275 6d65 6e74 2069 6e64  e instrument ind
-00005240: 6578 6573 2061 6e64 2063 6861 6e67 6520  exes and change 
-00005250: 7468 656d 2061 6363 6f72 6469 6e67 2074  them according t
-00005260: 6f20 7468 6520 6e65 770a 2020 2020 2020  o the new.      
-00005270: 2020 2020 2020 2320 6f72 6465 7269 6e67        # ordering
-00005280: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
-00005290: 7220 696e 7374 7275 6d65 6e74 2069 6e20  r instrument in 
-000052a0: 7365 6c66 2e69 6e61 6d65 735f 6c63 3a0a  self.inames_lc:.
-000052b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000052c0: 6e65 775f 696e 7374 7275 6d65 6e74 5f69  new_instrument_i
-000052d0: 6e64 6578 6573 203d 206e 702e 7a65 726f  ndexes = np.zero
-000052e0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-000052f0: 2020 2020 2020 206c 656e 2873 656c 662e         len(self.
-00005300: 696e 7374 7275 6d65 6e74 5f69 6e64 6578  instrument_index
-00005310: 6573 5f6c 635b 696e 7374 7275 6d65 6e74  es_lc[instrument
-00005320: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
-00005330: 2020 2020 696e 7374 7275 6d65 6e74 5f69      instrument_i
-00005340: 6e64 6578 6573 203d 2073 656c 662e 696e  ndexes = self.in
-00005350: 7374 7275 6d65 6e74 5f69 6e64 6578 6573  strument_indexes
-00005360: 5f6c 635b 696e 7374 7275 6d65 6e74 5d0a  _lc[instrument].
-00005370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005380: 636f 756e 7465 7220 3d20 300a 2020 2020  counter = 0.    
-00005390: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000053a0: 6920 696e 2069 6e73 7472 756d 656e 745f  i in instrument_
-000053b0: 696e 6465 7865 733a 0a20 2020 2020 2020  indexes:.       
-000053c0: 2020 2020 2020 2020 2020 2020 206e 6577               new
-000053d0: 5f69 6e73 7472 756d 656e 745f 696e 6465  _instrument_inde
-000053e0: 7865 735b 636f 756e 7465 725d 203d 206e  xes[counter] = n
-000053f0: 702e 7768 6572 6528 0a20 2020 2020 2020  p.where(.       
-00005400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005410: 2069 203d 3d20 6964 785f 736f 7274 295b   i == idx_sort)[
-00005420: 305d 5b30 5d0a 2020 2020 2020 2020 2020  0][0].          
-00005430: 2020 2020 2020 2020 2020 636f 756e 7465            counte
-00005440: 7220 2b3d 2031 0a20 2020 2020 2020 2020  r += 1.         
-00005450: 2020 2020 2020 2073 656c 662e 696e 7374         self.inst
-00005460: 7275 6d65 6e74 5f69 6e64 6578 6573 5f6c  rument_indexes_l
-00005470: 635b 0a20 2020 2020 2020 2020 2020 2020  c[.             
-00005480: 2020 2020 2020 2069 6e73 7472 756d 656e         instrumen
-00005490: 745d 203d 206e 6577 5f69 6e73 7472 756d  t] = new_instrum
-000054a0: 656e 745f 696e 6465 7865 732e 6173 7479  ent_indexes.asty
-000054b0: 7065 2827 696e 7427 290a 2020 2020 2020  pe('int').      
-000054c0: 2020 656c 6966 2064 6963 7479 7065 203d    elif dictype =
-000054d0: 3d20 2772 7627 3a0a 2020 2020 2020 2020  = 'rv':.        
-000054e0: 2020 2020 2320 536f 7274 2066 6972 7374      # Sort first
-000054f0: 2074 696d 6573 2c20 7276 732c 2065 7272   times, rvs, err
-00005500: 6f72 7320 616e 6420 7468 6520 4750 2072  ors and the GP r
-00005510: 6567 7265 7373 6f72 3a0a 2020 2020 2020  egressor:.      
-00005520: 2020 2020 2020 6964 785f 736f 7274 203d        idx_sort =
-00005530: 206e 702e 6172 6773 6f72 7428 7365 6c66   np.argsort(self
-00005540: 2e47 505f 7276 5f61 7267 756d 656e 7473  .GP_rv_arguments
-00005550: 5b27 7276 275d 5b3a 2c20 305d 290a 2020  ['rv'][:, 0]).  
-00005560: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
-00005570: 5f72 7620 3d20 7365 6c66 2e74 5f72 765b  _rv = self.t_rv[
-00005580: 6964 785f 736f 7274 5d0a 2020 2020 2020  idx_sort].      
-00005590: 2020 2020 2020 7365 6c66 2e79 5f72 7620        self.y_rv 
-000055a0: 3d20 7365 6c66 2e79 5f72 765b 6964 785f  = self.y_rv[idx_
-000055b0: 736f 7274 5d0a 2020 2020 2020 2020 2020  sort].          
-000055c0: 2020 7365 6c66 2e79 6572 725f 7276 203d    self.yerr_rv =
-000055d0: 2073 656c 662e 7965 7272 5f72 765b 6964   self.yerr_rv[id
-000055e0: 785f 736f 7274 5d0a 0a20 2020 2020 2020  x_sort]..       
-000055f0: 2020 2020 2073 656c 662e 4750 5f72 765f       self.GP_rv_
-00005600: 6172 6775 6d65 6e74 735b 2772 7627 5d5b  arguments['rv'][
-00005610: 3a2c 305d 203d 2073 656c 662e 4750 5f72  :,0] = self.GP_r
-00005620: 765f 6172 6775 6d65 6e74 735b 2772 7627  v_arguments['rv'
-00005630: 5d5b 6964 785f 736f 7274 2c30 5d0a 0a20  ][idx_sort,0].. 
-00005640: 2020 2020 2020 2020 2020 2023 204e 6f77             # Now
-00005650: 2077 6974 6820 7468 6520 736f 7274 6564   with the sorted
-00005660: 2069 6e64 6963 6573 2c20 6974 6572 6174   indices, iterat
-00005670: 6520 7468 726f 7567 6820 7468 6520 696e  e through the in
-00005680: 7374 7275 6d65 6e74 2069 6e64 6578 6573  strument indexes
-00005690: 2061 6e64 2063 6861 6e67 6520 7468 656d   and change them
-000056a0: 2061 6363 6f72 6469 6e67 2074 6f20 7468   according to th
-000056b0: 6520 6e65 770a 2020 2020 2020 2020 2020  e new.          
-000056c0: 2020 2320 6f72 6465 7269 6e67 3a0a 2020    # ordering:.  
-000056d0: 2020 2020 2020 2020 2020 666f 7220 696e            for in
-000056e0: 7374 7275 6d65 6e74 2069 6e20 7365 6c66  strument in self
-000056f0: 2e69 6e61 6d65 735f 7276 3a0a 2020 2020  .inames_rv:.    
-00005700: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
-00005710: 2020 2020 2020 2020 2020 206e 6577 5f69             new_i
-00005720: 6e73 7472 756d 656e 745f 696e 6465 7865  nstrument_indexe
-00005730: 7320 3d20 6e70 2e7a 6572 6f73 280a 2020  s = np.zeros(.  
-00005740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005750: 2020 6c65 6e28 7365 6c66 2e69 6e73 7472    len(self.instr
-00005760: 756d 656e 745f 696e 6465 7865 735f 7276  ument_indexes_rv
-00005770: 5b69 6e73 7472 756d 656e 745d 2929 0a20  [instrument])). 
-00005780: 2020 2020 2020 2020 2020 2020 2020 200a                 .
-00005790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000057a0: 696e 7374 7275 6d65 6e74 5f69 6e64 6578  instrument_index
-000057b0: 6573 203d 2073 656c 662e 696e 7374 7275  es = self.instru
-000057c0: 6d65 6e74 5f69 6e64 6578 6573 5f72 765b  ment_indexes_rv[
-000057d0: 696e 7374 7275 6d65 6e74 5d0a 2020 2020  instrument].    
-000057e0: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-000057f0: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
-00005800: 6e74 6572 203d 2030 0a20 2020 2020 2020  nter = 0.       
-00005810: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-00005820: 6e20 696e 7374 7275 6d65 6e74 5f69 6e64  n instrument_ind
-00005830: 6578 6573 3a0a 0a20 2020 2020 2020 2020  exes:..         
-00005840: 2020 2020 2020 2020 2020 206e 6577 5f69             new_i
-00005850: 6e73 7472 756d 656e 745f 696e 6465 7865  nstrument_indexe
-00005860: 735b 636f 756e 7465 725d 203d 206e 702e  s[counter] = np.
-00005870: 7768 6572 6528 6920 3d3d 2069 6478 5f73  where(i == idx_s
-00005880: 6f72 7429 5b30 5d5b 305d 0a20 2020 2020  ort)[0][0].     
-00005890: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000058a0: 6f75 6e74 6572 202b 3d20 310a 2020 2020  ounter += 1.    
-000058b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000058c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000058d0: 2073 656c 662e 696e 7374 7275 6d65 6e74   self.instrument
-000058e0: 5f69 6e64 6578 6573 5f72 765b 696e 7374  _indexes_rv[inst
-000058f0: 7275 6d65 6e74 5d20 3d20 6e65 775f 696e  rument] = new_in
-00005900: 7374 7275 6d65 6e74 5f69 6e64 6578 6573  strument_indexes
-00005910: 2e61 7374 7970 6528 2769 6e74 2729 0a0a  .astype('int')..
-00005920: 2020 2020 6465 6620 6765 6e65 7261 7465      def generate
-00005930: 5f64 6174 6164 6963 7428 7365 6c66 2c20  _datadict(self, 
-00005940: 6469 6374 7970 6529 3a0a 2020 2020 2020  dictype):.      
-00005950: 2020 2222 220a 2020 2020 2020 2020 5468    """.        Th
-00005960: 6973 2067 656e 6572 6174 6573 2074 6865  is generates the
-00005970: 206f 7074 696f 6e73 2064 6963 7469 6f6e   options diction
-00005980: 6172 7920 666f 7220 6c69 6768 7463 7572  ary for lightcur
-00005990: 7665 732c 2052 5673 2c20 616e 6420 6576  ves, RVs, and ev
-000059a0: 6572 7974 6869 6e67 2065 6c73 6520 796f  erything else yo
-000059b0: 7520 7761 6e74 2074 6f20 6669 742e 2055  u want to fit. U
-000059c0: 7365 6675 6c20 666f 7220 7468 650a 2020  seful for the.  
-000059d0: 2020 2020 2020 6669 742c 2061 7320 6974        fit, as it
-000059e0: 2073 6570 6172 6174 6572 7320 6f70 7469   separaters opti
-000059f0: 6f6e 7320 7065 7220 696e 7374 7275 6d65  ons per instrume
-00005a00: 6e74 2e0a 0a20 2020 2020 2020 203a 7061  nt...        :pa
-00005a10: 7261 6d20 6469 6374 7970 653a 2028 7374  ram dictype: (st
-00005a20: 7269 6e67 290a 2020 2020 2020 2020 2020  ring).          
-00005a30: 2020 4465 6669 6e65 7320 7468 6520 7479    Defines the ty
-00005a40: 7065 206f 6620 6469 6374 696f 6e61 7279  pe of dictionary
-00005a50: 2074 7970 652e 2049 7420 6361 6e20 6569   type. It can ei
-00005a60: 7468 6572 2062 6520 276c 6327 2028 666f  ther be 'lc' (fo
-00005a70: 7220 7468 6520 6c69 6768 7463 7572 7665  r the lightcurve
-00005a80: 2064 6963 7469 6f6e 6172 7929 206f 7220   dictionary) or 
-00005a90: 2772 7627 2028 666f 7220 7468 650a 2020  'rv' (for the.  
-00005aa0: 2020 2020 2020 2020 2020 7261 6469 616c            radial
-00005ab0: 2d76 656c 6f63 6974 7920 6f6e 6529 2e0a  -velocity one)..
-00005ac0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00005ad0: 2020 2020 2064 6963 7469 6f6e 6172 7920       dictionary 
-00005ae0: 3d20 7b7d 0a20 2020 2020 2020 2069 6620  = {}.        if 
-00005af0: 6469 6374 7970 6520 3d3d 2027 6c63 273a  dictype == 'lc':
-00005b00: 0a20 2020 2020 2020 2020 2020 2069 6e61  .            ina
-00005b10: 6d65 7320 3d20 7365 6c66 2e69 6e61 6d65  mes = self.iname
-00005b20: 735f 6c63 0a20 2020 2020 2020 2020 2020  s_lc.           
-00005b30: 206e 696e 7374 7275 6d65 6e74 7320 3d20   ninstruments = 
-00005b40: 7365 6c66 2e6e 696e 7374 7275 6d65 6e74  self.ninstrument
-00005b50: 735f 6c63 0a20 2020 2020 2020 2020 2020  s_lc.           
-00005b60: 2069 6e73 7472 756d 656e 745f 7375 7065   instrument_supe
-00005b70: 7273 616d 7020 3d20 7365 6c66 2e6c 635f  rsamp = self.lc_
-00005b80: 696e 7374 7275 6d65 6e74 5f73 7570 6572  instrument_super
-00005b90: 7361 6d70 0a20 2020 2020 2020 2020 2020  samp.           
-00005ba0: 206e 5f73 7570 6572 7361 6d70 203d 2073   n_supersamp = s
-00005bb0: 656c 662e 6c63 5f6e 5f73 7570 6572 7361  elf.lc_n_supersa
-00005bc0: 6d70 0a20 2020 2020 2020 2020 2020 2065  mp.            e
-00005bd0: 7870 7469 6d65 5f73 7570 6572 7361 6d70  xptime_supersamp
-00005be0: 203d 2073 656c 662e 6c63 5f65 7870 7469   = self.lc_expti
-00005bf0: 6d65 5f73 7570 6572 7361 6d70 0a20 2020  me_supersamp.   
-00005c00: 2020 2020 2020 2020 206e 756d 6265 7269           numberi
-00005c10: 6e67 5f70 6c61 6e65 7473 203d 2073 656c  ng_planets = sel
-00005c20: 662e 6e75 6d62 6572 696e 675f 7472 616e  f.numbering_tran
-00005c30: 7369 7469 6e67 5f70 6c61 6e65 7473 0a20  siting_planets. 
-00005c40: 2020 2020 2020 2020 2020 2023 2043 6865             # Che
-00005c50: 636b 2069 6620 6d6f 6465 6c20 6973 2067  ck if model is g
-00005c60: 6c6f 6261 6c20 6261 7365 6420 6f6e 2074  lobal based on t
-00005c70: 6865 2069 6e70 7574 2070 7269 6f72 206e  he input prior n
-00005c80: 616d 6573 2e20 4966 2074 6865 7920 696e  ames. If they in
-00005c90: 636c 7564 6520 6173 2069 6e73 7472 756d  clude as instrum
-00005ca0: 656e 7420 2272 7622 2c20 7365 7420 746f  ent "rv", set to
-00005cb0: 2067 6c6f 6261 6c20 6d6f 6465 6c3a 0a20   global model:. 
-00005cc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005cd0: 676c 6f62 616c 5f6c 635f 6d6f 6465 6c20  global_lc_model 
-00005ce0: 3d20 7365 6c66 2e63 6865 636b 5f67 6c6f  = self.check_glo
-00005cf0: 6261 6c28 276c 6327 290a 2020 2020 2020  bal('lc').      
-00005d00: 2020 2020 2020 676c 6f62 616c 5f6d 6f64        global_mod
-00005d10: 656c 203d 2073 656c 662e 676c 6f62 616c  el = self.global
-00005d20: 5f6c 635f 6d6f 6465 6c0a 2020 2020 2020  _lc_model.      
-00005d30: 2020 2020 2020 2369 6620 676c 6f62 616c        #if global
-00005d40: 5f6d 6f64 656c 2061 6e64 2028 7365 6c66  _model and (self
-00005d50: 2e47 505f 6c63 5f61 7267 756d 656e 7473  .GP_lc_arguments
-00005d60: 2069 7320 6e6f 7420 4e6f 6e65 293a 0a20   is not None):. 
-00005d70: 2020 2020 2020 2020 2020 2023 2020 2020             #    
-00005d80: 7365 6c66 2e47 505f 6c63 5f61 7267 756d  self.GP_lc_argum
-00005d90: 656e 7473 5b27 6c63 275d 203d 2073 656c  ents['lc'] = sel
-00005da0: 662e 6170 7065 6e64 5f47 5028 6c65 6e28  f.append_GP(len(
-00005db0: 7365 6c66 2e74 5f6c 6329 2c20 7365 6c66  self.t_lc), self
-00005dc0: 2e69 6e73 7472 756d 656e 745f 696e 6465  .instrument_inde
-00005dd0: 7865 735f 6c63 2c20 7365 6c66 2e47 505f  xes_lc, self.GP_
-00005de0: 6c63 5f61 7267 756d 656e 7473 2c20 696e  lc_arguments, in
-00005df0: 616d 6573 290a 2020 2020 2020 2020 2020  ames).          
-00005e00: 2020 4750 5f72 6567 7265 7373 6f72 7320    GP_regressors 
-00005e10: 3d20 7365 6c66 2e47 505f 6c63 5f61 7267  = self.GP_lc_arg
-00005e20: 756d 656e 7473 0a20 2020 2020 2020 2065  uments.        e
-00005e30: 6c69 6620 6469 6374 7970 6520 3d3d 2027  lif dictype == '
-00005e40: 7276 273a 0a20 2020 2020 2020 2020 2020  rv':.           
-00005e50: 2069 6e61 6d65 7320 3d20 7365 6c66 2e69   inames = self.i
-00005e60: 6e61 6d65 735f 7276 0a20 2020 2020 2020  names_rv.       
-00005e70: 2020 2020 206e 696e 7374 7275 6d65 6e74       ninstrument
-00005e80: 7320 3d20 7365 6c66 2e6e 696e 7374 7275  s = self.ninstru
-00005e90: 6d65 6e74 735f 7276 0a20 2020 2020 2020  ments_rv.       
-00005ea0: 2020 2020 2069 6e73 7472 756d 656e 745f       instrument_
-00005eb0: 7375 7065 7273 616d 7020 3d20 4e6f 6e65  supersamp = None
-00005ec0: 0a20 2020 2020 2020 2020 2020 206e 5f73  .            n_s
-00005ed0: 7570 6572 7361 6d70 203d 204e 6f6e 650a  upersamp = None.
-00005ee0: 2020 2020 2020 2020 2020 2020 6578 7074              expt
-00005ef0: 696d 655f 7375 7065 7273 616d 7020 3d20  ime_supersamp = 
-00005f00: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-00005f10: 206e 756d 6265 7269 6e67 5f70 6c61 6e65   numbering_plane
-00005f20: 7473 203d 2073 656c 662e 6e75 6d62 6572  ts = self.number
-00005f30: 696e 675f 7276 5f70 6c61 6e65 7473 0a20  ing_rv_planets. 
-00005f40: 2020 2020 2020 2020 2020 2023 2043 6865             # Che
-00005f50: 636b 2069 6620 6d6f 6465 6c20 6973 2067  ck if model is g
-00005f60: 6c6f 6261 6c20 6261 7365 6420 6f6e 2074  lobal based on t
-00005f70: 6865 2069 6e70 7574 2070 7269 6f72 206e  he input prior n
-00005f80: 616d 6573 2e20 4966 2074 6865 7920 696e  ames. If they in
-00005f90: 636c 7564 6520 6173 2069 6e73 7472 756d  clude as instrum
-00005fa0: 656e 7420 226c 6322 2c20 7365 7420 746f  ent "lc", set to
-00005fb0: 2067 6c6f 6261 6c20 6d6f 6465 6c3a 0a20   global model:. 
-00005fc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005fd0: 676c 6f62 616c 5f72 765f 6d6f 6465 6c20  global_rv_model 
-00005fe0: 3d20 7365 6c66 2e63 6865 636b 5f67 6c6f  = self.check_glo
-00005ff0: 6261 6c28 2772 7627 290a 2020 2020 2020  bal('rv').      
-00006000: 2020 2020 2020 676c 6f62 616c 5f6d 6f64        global_mod
-00006010: 656c 203d 2073 656c 662e 676c 6f62 616c  el = self.global
-00006020: 5f72 765f 6d6f 6465 6c0a 2020 2020 2020  _rv_model.      
-00006030: 2020 2020 2020 2320 4966 2067 6c6f 6261        # If globa
-00006040: 6c5f 6d6f 6465 6c20 6973 2054 7275 652c  l_model is True,
-00006050: 2063 7265 6174 6520 616e 2061 6464 6974   create an addit
-00006060: 696f 6e61 6c20 6b65 7920 696e 2074 6865  ional key in the
-00006070: 2047 505f 7265 6772 6573 736f 7273 2061   GP_regressors a
-00006080: 7272 6179 2074 6861 7420 7769 6c6c 2068  rray that will h
-00006090: 6176 6520 616c 6c20 7468 6520 4750 2072  ave all the GP r
-000060a0: 6567 7265 7373 6f72 7320 6170 7065 6e64  egressors append
-000060b0: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
-000060c0: 2369 6620 676c 6f62 616c 5f6d 6f64 656c  #if global_model
-000060d0: 2061 6e64 2028 7365 6c66 2e47 505f 7276   and (self.GP_rv
-000060e0: 5f61 7267 756d 656e 7473 2069 7320 6e6f  _arguments is no
-000060f0: 7420 4e6f 6e65 293a 0a20 2020 2020 2020  t None):.       
-00006100: 2020 2020 2023 2020 2020 7365 6c66 2e47       #    self.G
-00006110: 505f 7276 5f61 7267 756d 656e 7473 5b27  P_rv_arguments['
-00006120: 7276 275d 203d 2073 656c 662e 6170 7065  rv'] = self.appe
-00006130: 6e64 5f47 5028 6c65 6e28 7365 6c66 2e74  nd_GP(len(self.t
-00006140: 5f72 7629 2c20 7365 6c66 2e69 6e73 7472  _rv), self.instr
-00006150: 756d 656e 745f 696e 6465 7865 735f 7276  ument_indexes_rv
-00006160: 2c20 7365 6c66 2e47 505f 7276 5f61 7267  , self.GP_rv_arg
-00006170: 756d 656e 7473 2c20 696e 616d 6573 290a  uments, inames).
-00006180: 2020 2020 2020 2020 2020 2020 4750 5f72              GP_r
-00006190: 6567 7265 7373 6f72 7320 3d20 7365 6c66  egressors = self
-000061a0: 2e47 505f 7276 5f61 7267 756d 656e 7473  .GP_rv_arguments
-000061b0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000061c0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000061d0: 2045 7863 6570 7469 6f6e 280a 2020 2020   Exception(.    
-000061e0: 2020 2020 2020 2020 2020 2020 2749 4e50              'INP
-000061f0: 5554 2045 5252 4f52 3a20 6469 6374 7970  UT ERROR: dictyp
-00006200: 6520 6e6f 7420 756e 6465 7273 746f 6f64  e not understood
-00006210: 2e20 4861 7320 746f 2062 6520 6569 7468  . Has to be eith
-00006220: 6572 206c 6320 6f72 2072 762e 270a 2020  er lc or rv.'.  
-00006230: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00006240: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-00006250: 6e67 6528 6e69 6e73 7472 756d 656e 7473  nge(ninstruments
-00006260: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00006270: 6e73 7472 756d 656e 7420 3d20 696e 616d  nstrument = inam
-00006280: 6573 5b69 5d0a 2020 2020 2020 2020 2020  es[i].          
-00006290: 2020 6469 6374 696f 6e61 7279 5b69 6e73    dictionary[ins
-000062a0: 7472 756d 656e 745d 203d 207b 7d0a 2020  trument] = {}.  
-000062b0: 2020 2020 2020 2020 2020 2320 5361 7665            # Save
-000062c0: 2069 6620 6120 6769 7665 6e20 696e 7374   if a given inst
-000062d0: 7275 6d65 6e74 2077 696c 6c20 7265 6365  rument will rece
-000062e0: 6976 6520 7265 7361 6d70 6c69 6e67 2028  ive resampling (
-000062f0: 696e 6974 6961 6c69 7a65 2074 6869 7320  initialize this 
-00006300: 6173 2046 616c 7365 293a 0a20 2020 2020  as False):.     
-00006310: 2020 2020 2020 2064 6963 7469 6f6e 6172         dictionar
-00006320: 795b 696e 7374 7275 6d65 6e74 5d5b 2772  y[instrument]['r
-00006330: 6573 616d 706c 696e 6727 5d20 3d20 4661  esampling'] = Fa
-00006340: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00006350: 2320 5361 7665 2069 6620 6120 6769 7665  # Save if a give
-00006360: 6e20 696e 7374 7275 6d65 6e74 2068 6173  n instrument has
-00006370: 2047 5020 6669 7474 696e 6720 4f4e 2028   GP fitting ON (
-00006380: 696e 6974 6961 6c69 7a65 2074 6869 7320  initialize this 
-00006390: 6173 2046 616c 7365 293a 0a20 2020 2020  as False):.     
-000063a0: 2020 2020 2020 2064 6963 7469 6f6e 6172         dictionar
-000063b0: 795b 696e 7374 7275 6d65 6e74 5d5b 2747  y[instrument]['G
-000063c0: 5044 6574 7265 6e64 275d 203d 2046 616c  PDetrend'] = Fal
-000063d0: 7365 0a20 2020 2020 2020 2020 2020 2023  se.            #
-000063e0: 2053 6176 6520 6966 2074 7261 6e73 6974   Save if transit
-000063f0: 2066 6974 7469 6e67 2077 696c 6c20 6265   fitting will be
-00006400: 2064 6f6e 6520 666f 7220 6120 6769 7665   done for a give
-00006410: 6e20 6461 7461 7365 742f 696e 7374 7275  n dataset/instru
-00006420: 6d65 6e74 2028 7468 6973 2069 7320 736f  ment (this is so
-00006430: 2075 7365 7273 2063 616e 2066 6974 2070   users can fit p
-00006440: 686f 746f 6d65 7472 7920 7769 7468 2c20  hotometry with, 
-00006450: 652e 672e 2c20 4750 7329 3a0a 2020 2020  e.g., GPs):.    
-00006460: 2020 2020 2020 2020 6966 2064 6963 7479          if dicty
-00006470: 7065 203d 3d20 276c 6327 3a0a 2020 2020  pe == 'lc':.    
-00006480: 2020 2020 2020 2020 2020 2020 6469 6374              dict
-00006490: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
-000064a0: 745d 5b27 5472 616e 7369 7446 6974 275d  t]['TransitFit']
-000064b0: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
-000064c0: 2020 2020 2020 2020 2064 6963 7469 6f6e           diction
-000064d0: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
-000064e0: 2754 7261 6e73 6974 4669 7443 6174 776f  'TransitFitCatwo
-000064f0: 6d61 6e27 5d20 3d20 4661 6c73 650a 2020  man'] = False.  
-00006500: 2020 2020 2020 2020 2020 2020 2020 6469                di
-00006510: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
-00006520: 656e 745d 5b27 4563 6c69 7073 6546 6974  ent]['EclipseFit
-00006530: 275d 203d 2046 616c 7365 0a20 2020 2020  '] = False.     
-00006540: 2020 2020 2020 2020 2020 2064 6963 7469             dicti
-00006550: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
-00006560: 5d5b 2750 6861 7365 4375 7276 6546 6974  ]['PhaseCurveFit
-00006570: 275d 203d 2046 616c 7365 0a20 2020 2020  '] = False.     
-00006580: 2020 2020 2020 2020 2020 2064 6963 7469             dicti
-00006590: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
-000065a0: 5d5b 2754 7261 6e45 636c 4669 7427 5d20  ]['TranEclFit'] 
-000065b0: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
-000065c0: 2069 6620 6469 6374 7970 6520 3d3d 2027   if dictype == '
-000065d0: 6c63 273a 0a20 2020 2020 2020 2020 2020  lc':.           
-000065e0: 2023 2045 7874 7261 6374 206c 696d 622d   # Extract limb-
-000065f0: 6461 726b 656e 696e 6720 6c61 772e 2049  darkening law. I
-00006600: 6620 6e6f 206c 696d 622d 6461 726b 656e  f no limb-darken
-00006610: 696e 6720 6c61 7720 7761 7320 6769 7665  ing law was give
-00006620: 6e20 6279 2074 6865 2075 7365 722c 2061  n by the user, a
-00006630: 7373 756d 6520 4c44 206c 6177 2064 6570  ssume LD law dep
-00006640: 656e 6469 6e67 206f 6e20 7768 6574 6865  ending on whethe
-00006650: 7220 7468 6520 7573 6572 2064 6566 696e  r the user defin
-00006660: 6564 2061 2070 7269 6f72 2066 6f72 2071  ed a prior for q
-00006670: 3120 6f6e 6c79 2066 6f72 2061 0a20 2020  1 only for a.   
-00006680: 2020 2020 2020 2020 2023 2067 6976 656e           # given
-00006690: 2069 6e73 7472 756d 656e 7420 2869 6e20   instrument (in 
-000066a0: 7768 6963 6820 7468 6174 2069 6e73 7472  which that instr
-000066b0: 756d 656e 7420 6973 2073 6574 2074 6f20  ument is set to 
-000066c0: 7468 6520 6c69 6e65 6172 206c 6177 2920  the linear law) 
-000066d0: 6f72 2061 2070 7269 6f72 2066 6f72 2071  or a prior for q
-000066e0: 3120 616e 6420 7132 2c20 696e 2077 6869  1 and q2, in whi
-000066f0: 6368 2063 6173 6520 7765 2061 7373 756d  ch case we assum
-00006700: 6520 7468 6520 7573 6572 0a20 2020 2020  e the user.     
-00006710: 2020 2020 2020 2023 2077 616e 7473 2074         # wants t
-00006720: 6f20 7573 6520 6120 7175 6164 7261 7469  o use a quadrati
-00006730: 6320 6c61 7720 666f 7220 7468 6174 2069  c law for that i
-00006740: 6e73 7472 756d 656e 742e 2049 6620 7573  nstrument. If us
-00006750: 6572 2067 6176 6520 6f6e 6520 6c69 6d62  er gave one limb
-00006760: 2d64 6172 6b65 6e69 6e67 206c 6177 2c20  -darkening law, 
-00006770: 6173 7375 6d65 2074 6861 7420 6c61 7720  assume that law 
-00006780: 666f 7220 616c 6c20 696e 7374 7275 6d65  for all instrume
-00006790: 6e74 7320 7468 6174 2068 6176 6520 7072  nts that have pr
-000067a0: 696f 7273 2066 6f72 2071 3120 616e 6420  iors for q1 and 
-000067b0: 7132 0a20 2020 2020 2020 2020 2020 2023  q2.            #
-000067c0: 2028 6966 206f 6e6c 7920 7131 2069 7320   (if only q1 is 
-000067d0: 6769 7665 6e2c 2061 7373 756d 6520 6c69  given, assume li
-000067e0: 6e65 6172 2066 6f72 2074 686f 7365 2069  near for those i
-000067f0: 6e73 7472 756d 656e 7473 292e 2049 6620  nstruments). If 
-00006800: 4c44 206c 6177 7320 6769 7665 6e20 666f  LD laws given fo
-00006810: 7220 6576 6572 7920 696e 7374 7275 6d65  r every instrume
-00006820: 6e74 2c20 6578 7472 6163 7420 7468 656d  nt, extract them
-00006830: 3a0a 2020 2020 2020 2020 2020 2020 616c  :.            al
-00006840: 6c5f 6c64 5f6c 6177 7320 3d20 7365 6c66  l_ld_laws = self
-00006850: 2e6c 645f 6c61 7773 2e73 706c 6974 2827  .ld_laws.split('
-00006860: 2c27 290a 2020 2020 2020 2020 2020 2020  ,').            
-00006870: 6966 206c 656e 2861 6c6c 5f6c 645f 6c61  if len(all_ld_la
-00006880: 7773 2920 3d3d 2031 3a0a 2020 2020 2020  ws) == 1:.      
-00006890: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-000068a0: 696e 2072 616e 6765 286e 696e 7374 7275  in range(ninstru
-000068b0: 6d65 6e74 7329 3a0a 2020 2020 2020 2020  ments):.        
-000068c0: 2020 2020 2020 2020 2020 2020 696e 7374              inst
-000068d0: 7275 6d65 6e74 203d 2069 6e61 6d65 735b  rument = inames[
-000068e0: 695d 0a20 2020 2020 2020 2020 2020 2020  i].             
-000068f0: 2020 2020 2020 2071 315f 6769 7665 6e20         q1_given 
-00006900: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
-00006910: 2020 2020 2020 2020 2020 2020 7132 5f67              q2_g
-00006920: 6976 656e 203d 2046 616c 7365 0a20 2020  iven = False.   
-00006930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006940: 2066 6f72 2070 6172 616d 6574 6572 2069   for parameter i
-00006950: 6e20 7365 6c66 2e70 7269 6f72 732e 6b65  n self.priors.ke
-00006960: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
-00006970: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00006980: 2070 6172 616d 6574 6572 5b30 3a32 5d20   parameter[0:2] 
-00006990: 3d3d 2027 7131 273a 0a20 2020 2020 2020  == 'q1':.       
-000069a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000069b0: 2020 2020 2069 6620 696e 7374 7275 6d65       if instrume
-000069c0: 6e74 2069 6e20 7061 7261 6d65 7465 722e  nt in parameter.
-000069d0: 7370 6c69 7428 275f 2729 5b31 3a5d 3a0a  split('_')[1:]:.
-000069e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000069f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006a00: 7131 5f67 6976 656e 203d 2054 7275 650a  q1_given = True.
-00006a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006a20: 2020 2020 2020 2020 6966 2070 6172 616d          if param
-00006a30: 6574 6572 5b30 3a32 5d20 3d3d 2027 7132  eter[0:2] == 'q2
-00006a40: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-00006a50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00006a60: 6620 696e 7374 7275 6d65 6e74 2069 6e20  f instrument in 
-00006a70: 7061 7261 6d65 7465 722e 7370 6c69 7428  parameter.split(
-00006a80: 275f 2729 5b31 3a5d 3a0a 2020 2020 2020  '_')[1:]:.      
-00006a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006aa0: 2020 2020 2020 2020 2020 7132 5f67 6976            q2_giv
-00006ab0: 656e 203d 2054 7275 650a 2020 2020 2020  en = True.      
-00006ac0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00006ad0: 2071 315f 6769 7665 6e20 616e 6420 286e   q1_given and (n
-00006ae0: 6f74 2071 325f 6769 7665 6e29 3a0a 2020  ot q2_given):.  
-00006af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006b00: 2020 2020 2020 6469 6374 696f 6e61 7279        dictionary
-00006b10: 5b69 6e73 7472 756d 656e 745d 5b27 6c64  [instrument]['ld
-00006b20: 6c61 7727 5d20 3d20 276c 696e 6561 7227  law'] = 'linear'
-00006b30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006b40: 2020 2020 2065 6c69 6620 7131 5f67 6976       elif q1_giv
-00006b50: 656e 2061 6e64 2071 325f 6769 7665 6e3a  en and q2_given:
-00006b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006b70: 2020 2020 2020 2020 2064 6963 7469 6f6e           diction
-00006b80: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
-00006b90: 276c 646c 6177 275d 203d 2028 0a20 2020  'ldlaw'] = (.   
-00006ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006bb0: 2020 2020 2020 2020 2061 6c6c 5f6c 645f           all_ld_
-00006bc0: 6c61 7773 5b30 5d2e 7370 6c69 7428 272d  laws[0].split('-
-00006bd0: 2729 5b2d 315d 292e 7370 6c69 7428 295b  ')[-1]).split()[
-00006be0: 305d 2e6c 6f77 6572 2829 0a20 2020 2020  0].lower().     
-00006bf0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00006c00: 6c69 6620 286e 6f74 2071 315f 6769 7665  lif (not q1_give
-00006c10: 6e29 2061 6e64 2071 325f 6769 7665 6e3a  n) and q2_given:
-00006c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006c30: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00004470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004490: 2020 2020 2020 2020 4750 5f69 6e73 7472          GP_instr
+000044a0: 756d 656e 7429 290a 2020 2020 2020 2020  ument)).        
+000044b0: 666f 7574 2e63 6c6f 7365 2829 0a0a 2020  fout.close()..  
+000044c0: 2020 6465 6620 7361 7665 5f64 6174 6128    def save_data(
+000044d0: 7365 6c66 2c20 666e 616d 652c 2074 2c20  self, fname, t, 
+000044e0: 792c 2079 6572 722c 2069 6e73 7472 756d  y, yerr, instrum
+000044f0: 656e 7473 2c20 6c6d 5f62 6f6f 6c65 616e  ents, lm_boolean
+00004500: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00004510: 2020 2020 6c6d 5f61 7267 756d 656e 7473      lm_arguments
+00004520: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00004530: 2020 2020 2020 2054 6869 7320 6675 6e63         This func
+00004540: 7469 6f6e 2073 6176 6573 2074 2c79 2c79  tion saves t,y,y
+00004550: 6572 722c 696e 7374 7275 6d65 6e74 732c  err,instruments,
+00004560: 6c6d 5f62 6f6f 6c65 616e 2061 6e64 206c  lm_boolean and l
+00004570: 6d5f 6172 6775 6d65 6e74 7320 6461 7461  m_arguments data
+00004580: 2074 6f20 666e 616d 652e 0a20 2020 2020   to fname..     
+00004590: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+000045a0: 6f75 7420 3d20 6f70 656e 2866 6e61 6d65  out = open(fname
+000045b0: 2c20 2777 2729 0a20 2020 2020 2020 206c  , 'w').        l
+000045c0: 6d5f 636f 756e 7465 7273 203d 207b 7d0a  m_counters = {}.
+000045d0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+000045e0: 2072 616e 6765 286c 656e 2874 2929 3a0a   range(len(t)):.
+000045f0: 0a20 2020 2020 2020 2020 2020 2066 6f75  .            fou
+00004600: 742e 7772 6974 6528 277b 303a 2e31 3066  t.write('{0:.10f
+00004610: 7d20 7b31 3a2e 3130 667d 207b 323a 2e31  } {1:.10f} {2:.1
+00004620: 3066 7d20 7b33 3a7d 272e 666f 726d 6174  0f} {3:}'.format
+00004630: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00004640: 2020 745b 695d 2c20 795b 695d 2c20 7965    t[i], y[i], ye
+00004650: 7272 5b69 5d2c 2069 6e73 7472 756d 656e  rr[i], instrumen
+00004660: 7473 5b69 5d29 290a 0a20 2020 2020 2020  ts[i]))..       
+00004670: 2020 2020 2069 6620 6c6d 5f62 6f6f 6c65       if lm_boole
+00004680: 616e 5b69 6e73 7472 756d 656e 7473 5b69  an[instruments[i
+00004690: 5d5d 3a0a 0a20 2020 2020 2020 2020 2020  ]]:..           
+000046a0: 2020 2020 2069 6620 696e 7374 7275 6d65       if instrume
+000046b0: 6e74 735b 695d 206e 6f74 2069 6e20 6c6d  nts[i] not in lm
+000046c0: 5f63 6f75 6e74 6572 732e 6b65 7973 2829  _counters.keys()
+000046d0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
+000046e0: 2020 2020 2020 206c 6d5f 636f 756e 7465         lm_counte
+000046f0: 7273 5b69 6e73 7472 756d 656e 7473 5b69  rs[instruments[i
+00004700: 5d5d 203d 2030 0a0a 2020 2020 2020 2020  ]] = 0..        
+00004710: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
+00004720: 2072 616e 6765 286c 6d5f 6172 6775 6d65   range(lm_argume
+00004730: 6e74 735b 696e 7374 7275 6d65 6e74 735b  nts[instruments[
+00004740: 695d 5d2e 7368 6170 655b 315d 293a 0a0a  i]].shape[1]):..
+00004750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004760: 2020 2020 666f 7574 2e77 7269 7465 2827      fout.write('
+00004770: 207b 303a 2e31 3066 7d27 2e66 6f72 6d61   {0:.10f}'.forma
+00004780: 7428 6c6d 5f61 7267 756d 656e 7473 5b69  t(lm_arguments[i
+00004790: 6e73 7472 756d 656e 7473 5b69 5d5d 5b0a  nstruments[i]][.
+000047a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000047b0: 2020 2020 2020 2020 206c 6d5f 636f 756e           lm_coun
+000047c0: 7465 7273 5b69 6e73 7472 756d 656e 7473  ters[instruments
+000047d0: 5b69 5d5d 5d5b 6a5d 2929 0a0a 2020 2020  [i]]][j]))..    
+000047e0: 2020 2020 2020 2020 2020 2020 6c6d 5f63              lm_c
+000047f0: 6f75 6e74 6572 735b 696e 7374 7275 6d65  ounters[instrume
+00004800: 6e74 735b 695d 5d20 2b3d 2031 0a0a 2020  nts[i]] += 1..  
+00004810: 2020 2020 2020 2020 2020 666f 7574 2e77            fout.w
+00004820: 7269 7465 2827 5c6e 2729 0a0a 2020 2020  rite('\n')..    
+00004830: 2020 2020 666f 7574 2e63 6c6f 7365 2829      fout.close()
+00004840: 0a0a 2020 2020 6465 6620 7361 7665 5f70  ..    def save_p
+00004850: 7269 6f72 6669 6c65 2873 656c 662c 2066  riorfile(self, f
+00004860: 6e61 6d65 293a 0a20 2020 2020 2020 2022  name):.        "
+00004870: 2222 0a20 2020 2020 2020 2054 6869 7320  "".        This 
+00004880: 6675 6e63 7469 6f6e 2073 6176 6573 2061  function saves a
+00004890: 2070 7269 6f72 6669 6c65 2066 696c 6520   priorfile file 
+000048a0: 6f75 7420 746f 2066 6e61 6d65 0a20 2020  out to fname.   
+000048b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000048c0: 2066 6f75 7420 3d20 6f70 656e 2866 6e61   fout = open(fna
+000048d0: 6d65 2c20 2777 2729 0a20 2020 2020 2020  me, 'w').       
+000048e0: 2066 6f72 2070 6e61 6d65 2069 6e20 7365   for pname in se
+000048f0: 6c66 2e70 7269 6f72 732e 6b65 7973 2829  lf.priors.keys()
+00004900: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00004910: 2073 656c 662e 7072 696f 7273 5b70 6e61   self.priors[pna
+00004920: 6d65 5d5b 2764 6973 7472 6962 7574 696f  me]['distributio
+00004930: 6e27 5d2e 6c6f 7765 7228 2920 213d 2027  n'].lower() != '
+00004940: 6669 7865 6427 3a0a 2020 2020 2020 2020  fixed':.        
+00004950: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
+00004960: 272c 272e 6a6f 696e 280a 2020 2020 2020  ','.join(.      
+00004970: 2020 2020 2020 2020 2020 2020 2020 6e70                np
+00004980: 2e61 7272 6179 2873 656c 662e 7072 696f  .array(self.prio
+00004990: 7273 5b70 6e61 6d65 5d5b 2768 7970 6572  rs[pname]['hyper
+000049a0: 7061 7261 6d65 7465 7273 275d 292e 6173  parameters']).as
+000049b0: 7479 7065 2873 7472 2929 0a20 2020 2020  type(str)).     
+000049c0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+000049d0: 6c66 2e73 7461 7274 696e 675f 706f 696e  lf.starting_poin
+000049e0: 7420 6973 206e 6f74 204e 6f6e 653a 0a20  t is not None:. 
+000049f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004a00: 2020 2066 6f75 742e 7772 6974 6528 277b     fout.write('{
+00004a10: 303a 203c 3230 7d20 7b31 3a20 3c32 307d  0: <20} {1: <20}
+00004a20: 207b 323a 203c 3230 7d20 7b33 3a20 3c32   {2: <20} {3: <2
+00004a30: 307d 5c6e 272e 666f 726d 6174 280a 2020  0}\n'.format(.  
+00004a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004a50: 2020 2020 2020 706e 616d 652c 2073 656c        pname, sel
+00004a60: 662e 7072 696f 7273 5b70 6e61 6d65 5d5b  f.priors[pname][
+00004a70: 2764 6973 7472 6962 7574 696f 6e27 5d2c  'distribution'],
+00004a80: 2076 616c 7565 2c0a 2020 2020 2020 2020   value,.        
+00004a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004aa0: 7365 6c66 2e73 7461 7274 696e 675f 706f  self.starting_po
+00004ab0: 696e 745b 706e 616d 655d 2929 0a20 2020  int[pname])).   
+00004ac0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00004ad0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00004ae0: 2020 2020 2020 2066 6f75 742e 7772 6974         fout.writ
+00004af0: 6528 277b 303a 203c 3230 7d20 7b31 3a20  e('{0: <20} {1: 
+00004b00: 3c32 307d 207b 323a 203c 3230 7d5c 6e27  <20} {2: <20}\n'
+00004b10: 2e66 6f72 6d61 7428 0a20 2020 2020 2020  .format(.       
+00004b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004b30: 2070 6e61 6d65 2c20 7365 6c66 2e70 7269   pname, self.pri
+00004b40: 6f72 735b 706e 616d 655d 5b27 6469 7374  ors[pname]['dist
+00004b50: 7269 6275 7469 6f6e 275d 2c20 7661 6c75  ribution'], valu
+00004b60: 6529 290a 2020 2020 2020 2020 2020 2020  e)).            
+00004b70: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00004b80: 2020 2020 2020 7661 6c75 6520 3d20 7374        value = st
+00004b90: 7228 7365 6c66 2e70 7269 6f72 735b 706e  r(self.priors[pn
+00004ba0: 616d 655d 5b27 6879 7065 7270 6172 616d  ame]['hyperparam
+00004bb0: 6574 6572 7327 5d29 0a20 2020 2020 2020  eters']).       
+00004bc0: 2020 2020 2020 2020 2066 6f75 742e 7772           fout.wr
+00004bd0: 6974 6528 277b 303a 203c 3230 7d20 7b31  ite('{0: <20} {1
+00004be0: 3a20 3c32 307d 207b 323a 203c 3230 7d5c  : <20} {2: <20}\
+00004bf0: 6e27 2e66 6f72 6d61 7428 0a20 2020 2020  n'.format(.     
+00004c00: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00004c10: 6e61 6d65 2c20 7365 6c66 2e70 7269 6f72  name, self.prior
+00004c20: 735b 706e 616d 655d 5b27 6469 7374 7269  s[pname]['distri
+00004c30: 6275 7469 6f6e 275d 2c20 7661 6c75 6529  bution'], value)
+00004c40: 290a 2020 2020 2020 2020 666f 7574 2e63  ).        fout.c
+00004c50: 6c6f 7365 2829 0a0a 2020 2020 6465 6620  lose()..    def 
+00004c60: 6368 6563 6b5f 676c 6f62 616c 2873 656c  check_global(sel
+00004c70: 662c 206e 616d 6529 3a0a 2020 2020 2020  f, name):.      
+00004c80: 2020 666f 7220 706e 616d 6520 696e 2073    for pname in s
+00004c90: 656c 662e 7072 696f 7273 2e6b 6579 7328  elf.priors.keys(
+00004ca0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00004cb0: 6620 6e61 6d65 2069 6e20 706e 616d 652e  f name in pname.
+00004cc0: 7370 6c69 7428 275f 2729 5b31 3a5d 3a0a  split('_')[1:]:.
+00004cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ce0: 7265 7475 726e 2054 7275 650a 2020 2020  return True.    
+00004cf0: 2020 2020 7265 7475 726e 2046 616c 7365      return False
+00004d00: 0a0a 2020 2020 6465 6620 6170 7065 6e64  ..    def append
+00004d10: 5f47 5028 7365 6c66 2c20 6e64 6174 612c  _GP(self, ndata,
+00004d20: 2069 6e73 7472 756d 656e 745f 696e 6465   instrument_inde
+00004d30: 7865 732c 2047 505f 6172 6775 6d65 6e74  xes, GP_argument
+00004d40: 732c 2069 6e61 6d65 7329 3a0a 2020 2020  s, inames):.    
+00004d50: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00004d60: 2020 2020 5468 6973 2066 756e 6374 696f      This functio
+00004d70: 6e20 6170 7065 6e64 7320 616c 6c20 7468  n appends all th
+00004d80: 6520 4750 2072 6567 7265 7373 6f72 7320  e GP regressors 
+00004d90: 696e 746f 206f 6e65 202d 2d2d 2075 7365  into one --- use
+00004da0: 6675 6c20 666f 7220 7468 6520 676c 6f62  ful for the glob
+00004db0: 616c 206d 6f64 656c 732e 0a20 2020 2020  al models..     
+00004dc0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00004dd0: 2046 6972 7374 2063 6865 636b 2069 6620   First check if 
+00004de0: 4750 2072 6567 7265 7373 6f72 7320 6172  GP regressors ar
+00004df0: 6520 6d75 6c74 692d 6469 6d65 6e73 696f  e multi-dimensio
+00004e00: 6e61 6c20 2d2d 2d20 6368 6563 6b20 7468  nal --- check th
+00004e10: 6973 206a 7573 7420 666f 7220 7468 6520  is just for the 
+00004e20: 6669 7273 7420 696e 7374 7275 6d65 6e74  first instrument
+00004e30: 3a0a 2020 2020 2020 2020 6966 206c 656e  :.        if len
+00004e40: 2847 505f 6172 6775 6d65 6e74 735b 696e  (GP_arguments[in
+00004e50: 616d 6573 5b30 5d5d 2e73 6861 7065 2920  ames[0]].shape) 
+00004e60: 3d3d 2032 3a0a 2020 2020 2020 2020 2020  == 2:.          
+00004e70: 2020 6e72 6567 7265 7373 6f72 7320 3d20    nregressors = 
+00004e80: 4750 5f61 7267 756d 656e 7473 5b69 6e61  GP_arguments[ina
+00004e90: 6d65 735b 305d 5d2e 7368 6170 655b 315d  mes[0]].shape[1]
+00004ea0: 0a20 2020 2020 2020 2020 2020 206d 756c  .            mul
+00004eb0: 7469 6469 6d65 6e73 696f 6e61 6c20 3d20  tidimensional = 
+00004ec0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00004ed0: 206f 7574 203d 206e 702e 7a65 726f 7328   out = np.zeros(
+00004ee0: 5b6e 6461 7461 2c20 6e72 6567 7265 7373  [ndata, nregress
+00004ef0: 6f72 735d 290a 2020 2020 2020 2020 656c  ors]).        el
+00004f00: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00004f10: 6d75 6c74 6964 696d 656e 7369 6f6e 616c  multidimensional
+00004f20: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00004f30: 2020 2020 206f 7574 203d 206e 702e 7a65       out = np.ze
+00004f40: 726f 7328 6e64 6174 6129 0a20 2020 2020  ros(ndata).     
+00004f50: 2020 2066 6f72 2069 6e73 7472 756d 656e     for instrumen
+00004f60: 7420 696e 2069 6e61 6d65 733a 0a20 2020  t in inames:.   
+00004f70: 2020 2020 2020 2020 2069 6620 6d75 6c74           if mult
+00004f80: 6964 696d 656e 7369 6f6e 616c 3a0a 2020  idimensional:.  
+00004f90: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
+00004fa0: 745b 696e 7374 7275 6d65 6e74 5f69 6e64  t[instrument_ind
+00004fb0: 6578 6573 5b69 6e73 7472 756d 656e 745d  exes[instrument]
+00004fc0: 2c20 3a5d 203d 2047 505f 6172 6775 6d65  , :] = GP_argume
+00004fd0: 6e74 735b 0a20 2020 2020 2020 2020 2020  nts[.           
+00004fe0: 2020 2020 2020 2020 2069 6e73 7472 756d           instrum
+00004ff0: 656e 745d 0a20 2020 2020 2020 2020 2020  ent].           
+00005000: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00005010: 2020 2020 2020 206f 7574 5b69 6e73 7472         out[instr
+00005020: 756d 656e 745f 696e 6465 7865 735b 696e  ument_indexes[in
+00005030: 7374 7275 6d65 6e74 5d5d 203d 2047 505f  strument]] = GP_
+00005040: 6172 6775 6d65 6e74 735b 696e 7374 7275  arguments[instru
+00005050: 6d65 6e74 5d0a 2020 2020 2020 2020 7265  ment].        re
+00005060: 7475 726e 206f 7574 0a0a 2020 2020 6465  turn out..    de
+00005070: 6620 736f 7274 5f47 5028 7365 6c66 2c20  f sort_GP(self, 
+00005080: 6469 6374 7970 6529 3a0a 2020 2020 2020  dictype):.      
+00005090: 2020 6966 2064 6963 7479 7065 203d 3d20    if dictype == 
+000050a0: 276c 6327 3a0a 2020 2020 2020 2020 2020  'lc':.          
+000050b0: 2020 2320 536f 7274 2066 6972 7374 2074    # Sort first t
+000050c0: 696d 6573 2c20 666c 7578 6573 2c20 6572  imes, fluxes, er
+000050d0: 726f 7273 2061 6e64 2074 6865 2047 5020  rors and the GP 
+000050e0: 7265 6772 6573 736f 723a 0a20 2020 2020  regressor:.     
+000050f0: 2020 2020 2020 2069 6478 5f73 6f72 7420         idx_sort 
+00005100: 3d20 6e70 2e61 7267 736f 7274 2873 656c  = np.argsort(sel
+00005110: 662e 4750 5f6c 635f 6172 6775 6d65 6e74  f.GP_lc_argument
+00005120: 735b 276c 6327 5d5b 3a2c 2030 5d29 0a20  s['lc'][:, 0]). 
+00005130: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00005140: 745f 6c63 203d 2073 656c 662e 745f 6c63  t_lc = self.t_lc
+00005150: 5b69 6478 5f73 6f72 745d 0a20 2020 2020  [idx_sort].     
+00005160: 2020 2020 2020 2073 656c 662e 795f 6c63         self.y_lc
+00005170: 203d 2073 656c 662e 795f 6c63 5b69 6478   = self.y_lc[idx
+00005180: 5f73 6f72 745d 0a20 2020 2020 2020 2020  _sort].         
+00005190: 2020 2073 656c 662e 7965 7272 5f6c 6320     self.yerr_lc 
+000051a0: 3d20 7365 6c66 2e79 6572 725f 6c63 5b69  = self.yerr_lc[i
+000051b0: 6478 5f73 6f72 745d 0a0a 2020 2020 2020  dx_sort]..      
+000051c0: 2020 2020 2020 7365 6c66 2e47 505f 6c63        self.GP_lc
+000051d0: 5f61 7267 756d 656e 7473 5b27 6c63 275d  _arguments['lc']
+000051e0: 5b3a 2c30 5d20 3d20 7365 6c66 2e47 505f  [:,0] = self.GP_
+000051f0: 6c63 5f61 7267 756d 656e 7473 5b27 6c63  lc_arguments['lc
+00005200: 275d 5b69 6478 5f73 6f72 742c 305d 0a0a  '][idx_sort,0]..
+00005210: 2020 2020 2020 2020 2020 2020 2320 4e6f              # No
+00005220: 7720 7769 7468 2074 6865 2073 6f72 7465  w with the sorte
+00005230: 6420 696e 6469 6365 732c 2069 7465 7261  d indices, itera
+00005240: 7465 2074 6872 6f75 6768 2074 6865 2069  te through the i
+00005250: 6e73 7472 756d 656e 7420 696e 6465 7865  nstrument indexe
+00005260: 7320 616e 6420 6368 616e 6765 2074 6865  s and change the
+00005270: 6d20 6163 636f 7264 696e 6720 746f 2074  m according to t
+00005280: 6865 206e 6577 0a20 2020 2020 2020 2020  he new.         
+00005290: 2020 2023 206f 7264 6572 696e 673a 0a20     # ordering:. 
+000052a0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+000052b0: 6e73 7472 756d 656e 7420 696e 2073 656c  nstrument in sel
+000052c0: 662e 696e 616d 6573 5f6c 633a 0a20 2020  f.inames_lc:.   
+000052d0: 2020 2020 2020 2020 2020 2020 206e 6577               new
+000052e0: 5f69 6e73 7472 756d 656e 745f 696e 6465  _instrument_inde
+000052f0: 7865 7320 3d20 6e70 2e7a 6572 6f73 280a  xes = np.zeros(.
+00005300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005310: 2020 2020 6c65 6e28 7365 6c66 2e69 6e73      len(self.ins
+00005320: 7472 756d 656e 745f 696e 6465 7865 735f  trument_indexes_
+00005330: 6c63 5b69 6e73 7472 756d 656e 745d 2929  lc[instrument]))
+00005340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005350: 2069 6e73 7472 756d 656e 745f 696e 6465   instrument_inde
+00005360: 7865 7320 3d20 7365 6c66 2e69 6e73 7472  xes = self.instr
+00005370: 756d 656e 745f 696e 6465 7865 735f 6c63  ument_indexes_lc
+00005380: 5b69 6e73 7472 756d 656e 745d 0a20 2020  [instrument].   
+00005390: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
+000053a0: 6e74 6572 203d 2030 0a20 2020 2020 2020  nter = 0.       
+000053b0: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
+000053c0: 6e20 696e 7374 7275 6d65 6e74 5f69 6e64  n instrument_ind
+000053d0: 6578 6573 3a0a 2020 2020 2020 2020 2020  exes:.          
+000053e0: 2020 2020 2020 2020 2020 6e65 775f 696e            new_in
+000053f0: 7374 7275 6d65 6e74 5f69 6e64 6578 6573  strument_indexes
+00005400: 5b63 6f75 6e74 6572 5d20 3d20 6e70 2e77  [counter] = np.w
+00005410: 6865 7265 280a 2020 2020 2020 2020 2020  here(.          
+00005420: 2020 2020 2020 2020 2020 2020 2020 6920                i 
+00005430: 3d3d 2069 6478 5f73 6f72 7429 5b30 5d5b  == idx_sort)[0][
+00005440: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
+00005450: 2020 2020 2020 2063 6f75 6e74 6572 202b         counter +
+00005460: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+00005470: 2020 2020 7365 6c66 2e69 6e73 7472 756d      self.instrum
+00005480: 656e 745f 696e 6465 7865 735f 6c63 5b0a  ent_indexes_lc[.
+00005490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000054a0: 2020 2020 696e 7374 7275 6d65 6e74 5d20      instrument] 
+000054b0: 3d20 6e65 775f 696e 7374 7275 6d65 6e74  = new_instrument
+000054c0: 5f69 6e64 6578 6573 2e61 7374 7970 6528  _indexes.astype(
+000054d0: 2769 6e74 2729 0a20 2020 2020 2020 2065  'int').        e
+000054e0: 6c69 6620 6469 6374 7970 6520 3d3d 2027  lif dictype == '
+000054f0: 7276 273a 0a20 2020 2020 2020 2020 2020  rv':.           
+00005500: 2023 2053 6f72 7420 6669 7273 7420 7469   # Sort first ti
+00005510: 6d65 732c 2072 7673 2c20 6572 726f 7273  mes, rvs, errors
+00005520: 2061 6e64 2074 6865 2047 5020 7265 6772   and the GP regr
+00005530: 6573 736f 723a 0a20 2020 2020 2020 2020  essor:.         
+00005540: 2020 2069 6478 5f73 6f72 7420 3d20 6e70     idx_sort = np
+00005550: 2e61 7267 736f 7274 2873 656c 662e 4750  .argsort(self.GP
+00005560: 5f72 765f 6172 6775 6d65 6e74 735b 2772  _rv_arguments['r
+00005570: 7627 5d5b 3a2c 2030 5d29 0a20 2020 2020  v'][:, 0]).     
+00005580: 2020 2020 2020 2073 656c 662e 745f 7276         self.t_rv
+00005590: 203d 2073 656c 662e 745f 7276 5b69 6478   = self.t_rv[idx
+000055a0: 5f73 6f72 745d 0a20 2020 2020 2020 2020  _sort].         
+000055b0: 2020 2073 656c 662e 795f 7276 203d 2073     self.y_rv = s
+000055c0: 656c 662e 795f 7276 5b69 6478 5f73 6f72  elf.y_rv[idx_sor
+000055d0: 745d 0a20 2020 2020 2020 2020 2020 2073  t].            s
+000055e0: 656c 662e 7965 7272 5f72 7620 3d20 7365  elf.yerr_rv = se
+000055f0: 6c66 2e79 6572 725f 7276 5b69 6478 5f73  lf.yerr_rv[idx_s
+00005600: 6f72 745d 0a0a 2020 2020 2020 2020 2020  ort]..          
+00005610: 2020 7365 6c66 2e47 505f 7276 5f61 7267    self.GP_rv_arg
+00005620: 756d 656e 7473 5b27 7276 275d 5b3a 2c30  uments['rv'][:,0
+00005630: 5d20 3d20 7365 6c66 2e47 505f 7276 5f61  ] = self.GP_rv_a
+00005640: 7267 756d 656e 7473 5b27 7276 275d 5b69  rguments['rv'][i
+00005650: 6478 5f73 6f72 742c 305d 0a0a 2020 2020  dx_sort,0]..    
+00005660: 2020 2020 2020 2020 2320 4e6f 7720 7769          # Now wi
+00005670: 7468 2074 6865 2073 6f72 7465 6420 696e  th the sorted in
+00005680: 6469 6365 732c 2069 7465 7261 7465 2074  dices, iterate t
+00005690: 6872 6f75 6768 2074 6865 2069 6e73 7472  hrough the instr
+000056a0: 756d 656e 7420 696e 6465 7865 7320 616e  ument indexes an
+000056b0: 6420 6368 616e 6765 2074 6865 6d20 6163  d change them ac
+000056c0: 636f 7264 696e 6720 746f 2074 6865 206e  cording to the n
+000056d0: 6577 0a20 2020 2020 2020 2020 2020 2023  ew.            #
+000056e0: 206f 7264 6572 696e 673a 0a20 2020 2020   ordering:.     
+000056f0: 2020 2020 2020 2066 6f72 2069 6e73 7472         for instr
+00005700: 756d 656e 7420 696e 2073 656c 662e 696e  ument in self.in
+00005710: 616d 6573 5f72 763a 0a20 2020 2020 2020  ames_rv:.       
+00005720: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00005730: 2020 2020 2020 2020 6e65 775f 696e 7374          new_inst
+00005740: 7275 6d65 6e74 5f69 6e64 6578 6573 203d  rument_indexes =
+00005750: 206e 702e 7a65 726f 7328 0a20 2020 2020   np.zeros(.     
+00005760: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00005770: 656e 2873 656c 662e 696e 7374 7275 6d65  en(self.instrume
+00005780: 6e74 5f69 6e64 6578 6573 5f72 765b 696e  nt_indexes_rv[in
+00005790: 7374 7275 6d65 6e74 5d29 290a 2020 2020  strument])).    
+000057a0: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
+000057b0: 2020 2020 2020 2020 2020 2020 2069 6e73               ins
+000057c0: 7472 756d 656e 745f 696e 6465 7865 7320  trument_indexes 
+000057d0: 3d20 7365 6c66 2e69 6e73 7472 756d 656e  = self.instrumen
+000057e0: 745f 696e 6465 7865 735f 7276 5b69 6e73  t_indexes_rv[ins
+000057f0: 7472 756d 656e 745d 0a20 2020 2020 2020  trument].       
+00005800: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+00005810: 2020 2020 2020 2020 2020 636f 756e 7465            counte
+00005820: 7220 3d20 300a 2020 2020 2020 2020 2020  r = 0.          
+00005830: 2020 2020 2020 666f 7220 6920 696e 2069        for i in i
+00005840: 6e73 7472 756d 656e 745f 696e 6465 7865  nstrument_indexe
+00005850: 733a 0a0a 2020 2020 2020 2020 2020 2020  s:..            
+00005860: 2020 2020 2020 2020 6e65 775f 696e 7374          new_inst
+00005870: 7275 6d65 6e74 5f69 6e64 6578 6573 5b63  rument_indexes[c
+00005880: 6f75 6e74 6572 5d20 3d20 6e70 2e77 6865  ounter] = np.whe
+00005890: 7265 2869 203d 3d20 6964 785f 736f 7274  re(i == idx_sort
+000058a0: 295b 305d 5b30 5d0a 2020 2020 2020 2020  )[0][0].        
+000058b0: 2020 2020 2020 2020 2020 2020 636f 756e              coun
+000058c0: 7465 7220 2b3d 2031 0a20 2020 2020 2020  ter += 1.       
+000058d0: 2020 2020 2020 2020 2020 2020 200a 2020               .  
+000058e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000058f0: 6c66 2e69 6e73 7472 756d 656e 745f 696e  lf.instrument_in
+00005900: 6465 7865 735f 7276 5b69 6e73 7472 756d  dexes_rv[instrum
+00005910: 656e 745d 203d 206e 6577 5f69 6e73 7472  ent] = new_instr
+00005920: 756d 656e 745f 696e 6465 7865 732e 6173  ument_indexes.as
+00005930: 7479 7065 2827 696e 7427 290a 0a20 2020  type('int')..   
+00005940: 2064 6566 2067 656e 6572 6174 655f 6461   def generate_da
+00005950: 7461 6469 6374 2873 656c 662c 2064 6963  tadict(self, dic
+00005960: 7479 7065 293a 0a20 2020 2020 2020 2022  type):.        "
+00005970: 2222 0a20 2020 2020 2020 2054 6869 7320  "".        This 
+00005980: 6765 6e65 7261 7465 7320 7468 6520 6f70  generates the op
+00005990: 7469 6f6e 7320 6469 6374 696f 6e61 7279  tions dictionary
+000059a0: 2066 6f72 206c 6967 6874 6375 7276 6573   for lightcurves
+000059b0: 2c20 5256 732c 2061 6e64 2065 7665 7279  , RVs, and every
+000059c0: 7468 696e 6720 656c 7365 2079 6f75 2077  thing else you w
+000059d0: 616e 7420 746f 2066 6974 2e20 5573 6566  ant to fit. Usef
+000059e0: 756c 2066 6f72 2074 6865 0a20 2020 2020  ul for the.     
+000059f0: 2020 2066 6974 2c20 6173 2069 7420 7365     fit, as it se
+00005a00: 7061 7261 7465 7273 206f 7074 696f 6e73  paraters options
+00005a10: 2070 6572 2069 6e73 7472 756d 656e 742e   per instrument.
+00005a20: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00005a30: 2064 6963 7479 7065 3a20 2873 7472 696e   dictype: (strin
+00005a40: 6729 0a20 2020 2020 2020 2020 2020 2044  g).            D
+00005a50: 6566 696e 6573 2074 6865 2074 7970 6520  efines the type 
+00005a60: 6f66 2064 6963 7469 6f6e 6172 7920 7479  of dictionary ty
+00005a70: 7065 2e20 4974 2063 616e 2065 6974 6865  pe. It can eithe
+00005a80: 7220 6265 2027 6c63 2720 2866 6f72 2074  r be 'lc' (for t
+00005a90: 6865 206c 6967 6874 6375 7276 6520 6469  he lightcurve di
+00005aa0: 6374 696f 6e61 7279 2920 6f72 2027 7276  ctionary) or 'rv
+00005ab0: 2720 2866 6f72 2074 6865 0a20 2020 2020  ' (for the.     
+00005ac0: 2020 2020 2020 2072 6164 6961 6c2d 7665         radial-ve
+00005ad0: 6c6f 6369 7479 206f 6e65 292e 0a20 2020  locity one)..   
+00005ae0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00005af0: 2020 6469 6374 696f 6e61 7279 203d 207b    dictionary = {
+00005b00: 7d0a 2020 2020 2020 2020 6966 2064 6963  }.        if dic
+00005b10: 7479 7065 203d 3d20 276c 6327 3a0a 2020  type == 'lc':.  
+00005b20: 2020 2020 2020 2020 2020 696e 616d 6573            inames
+00005b30: 203d 2073 656c 662e 696e 616d 6573 5f6c   = self.inames_l
+00005b40: 630a 2020 2020 2020 2020 2020 2020 6e69  c.            ni
+00005b50: 6e73 7472 756d 656e 7473 203d 2073 656c  nstruments = sel
+00005b60: 662e 6e69 6e73 7472 756d 656e 7473 5f6c  f.ninstruments_l
+00005b70: 630a 2020 2020 2020 2020 2020 2020 696e  c.            in
+00005b80: 7374 7275 6d65 6e74 5f73 7570 6572 7361  strument_supersa
+00005b90: 6d70 203d 2073 656c 662e 6c63 5f69 6e73  mp = self.lc_ins
+00005ba0: 7472 756d 656e 745f 7375 7065 7273 616d  trument_supersam
+00005bb0: 700a 2020 2020 2020 2020 2020 2020 6e5f  p.            n_
+00005bc0: 7375 7065 7273 616d 7020 3d20 7365 6c66  supersamp = self
+00005bd0: 2e6c 635f 6e5f 7375 7065 7273 616d 700a  .lc_n_supersamp.
+00005be0: 2020 2020 2020 2020 2020 2020 6578 7074              expt
+00005bf0: 696d 655f 7375 7065 7273 616d 7020 3d20  ime_supersamp = 
+00005c00: 7365 6c66 2e6c 635f 6578 7074 696d 655f  self.lc_exptime_
+00005c10: 7375 7065 7273 616d 700a 2020 2020 2020  supersamp.      
+00005c20: 2020 2020 2020 6e75 6d62 6572 696e 675f        numbering_
+00005c30: 706c 616e 6574 7320 3d20 7365 6c66 2e6e  planets = self.n
+00005c40: 756d 6265 7269 6e67 5f74 7261 6e73 6974  umbering_transit
+00005c50: 696e 675f 706c 616e 6574 730a 2020 2020  ing_planets.    
+00005c60: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
+00005c70: 6966 206d 6f64 656c 2069 7320 676c 6f62  if model is glob
+00005c80: 616c 2062 6173 6564 206f 6e20 7468 6520  al based on the 
+00005c90: 696e 7075 7420 7072 696f 7220 6e61 6d65  input prior name
+00005ca0: 732e 2049 6620 7468 6579 2069 6e63 6c75  s. If they inclu
+00005cb0: 6465 2061 7320 696e 7374 7275 6d65 6e74  de as instrument
+00005cc0: 2022 7276 222c 2073 6574 2074 6f20 676c   "rv", set to gl
+00005cd0: 6f62 616c 206d 6f64 656c 3a0a 2020 2020  obal model:.    
+00005ce0: 2020 2020 2020 2020 7365 6c66 2e67 6c6f          self.glo
+00005cf0: 6261 6c5f 6c63 5f6d 6f64 656c 203d 2073  bal_lc_model = s
+00005d00: 656c 662e 6368 6563 6b5f 676c 6f62 616c  elf.check_global
+00005d10: 2827 6c63 2729 0a20 2020 2020 2020 2020  ('lc').         
+00005d20: 2020 2067 6c6f 6261 6c5f 6d6f 6465 6c20     global_model 
+00005d30: 3d20 7365 6c66 2e67 6c6f 6261 6c5f 6c63  = self.global_lc
+00005d40: 5f6d 6f64 656c 0a20 2020 2020 2020 2020  _model.         
+00005d50: 2020 2023 6966 2067 6c6f 6261 6c5f 6d6f     #if global_mo
+00005d60: 6465 6c20 616e 6420 2873 656c 662e 4750  del and (self.GP
+00005d70: 5f6c 635f 6172 6775 6d65 6e74 7320 6973  _lc_arguments is
+00005d80: 206e 6f74 204e 6f6e 6529 3a0a 2020 2020   not None):.    
+00005d90: 2020 2020 2020 2020 2320 2020 2073 656c          #    sel
+00005da0: 662e 4750 5f6c 635f 6172 6775 6d65 6e74  f.GP_lc_argument
+00005db0: 735b 276c 6327 5d20 3d20 7365 6c66 2e61  s['lc'] = self.a
+00005dc0: 7070 656e 645f 4750 286c 656e 2873 656c  ppend_GP(len(sel
+00005dd0: 662e 745f 6c63 292c 2073 656c 662e 696e  f.t_lc), self.in
+00005de0: 7374 7275 6d65 6e74 5f69 6e64 6578 6573  strument_indexes
+00005df0: 5f6c 632c 2073 656c 662e 4750 5f6c 635f  _lc, self.GP_lc_
+00005e00: 6172 6775 6d65 6e74 732c 2069 6e61 6d65  arguments, iname
+00005e10: 7329 0a20 2020 2020 2020 2020 2020 2047  s).            G
+00005e20: 505f 7265 6772 6573 736f 7273 203d 2073  P_regressors = s
+00005e30: 656c 662e 4750 5f6c 635f 6172 6775 6d65  elf.GP_lc_argume
+00005e40: 6e74 730a 2020 2020 2020 2020 656c 6966  nts.        elif
+00005e50: 2064 6963 7479 7065 203d 3d20 2772 7627   dictype == 'rv'
+00005e60: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+00005e70: 616d 6573 203d 2073 656c 662e 696e 616d  ames = self.inam
+00005e80: 6573 5f72 760a 2020 2020 2020 2020 2020  es_rv.          
+00005e90: 2020 6e69 6e73 7472 756d 656e 7473 203d    ninstruments =
+00005ea0: 2073 656c 662e 6e69 6e73 7472 756d 656e   self.ninstrumen
+00005eb0: 7473 5f72 760a 2020 2020 2020 2020 2020  ts_rv.          
+00005ec0: 2020 696e 7374 7275 6d65 6e74 5f73 7570    instrument_sup
+00005ed0: 6572 7361 6d70 203d 204e 6f6e 650a 2020  ersamp = None.  
+00005ee0: 2020 2020 2020 2020 2020 6e5f 7375 7065            n_supe
+00005ef0: 7273 616d 7020 3d20 4e6f 6e65 0a20 2020  rsamp = None.   
+00005f00: 2020 2020 2020 2020 2065 7870 7469 6d65           exptime
+00005f10: 5f73 7570 6572 7361 6d70 203d 204e 6f6e  _supersamp = Non
+00005f20: 650a 2020 2020 2020 2020 2020 2020 6e75  e.            nu
+00005f30: 6d62 6572 696e 675f 706c 616e 6574 7320  mbering_planets 
+00005f40: 3d20 7365 6c66 2e6e 756d 6265 7269 6e67  = self.numbering
+00005f50: 5f72 765f 706c 616e 6574 730a 2020 2020  _rv_planets.    
+00005f60: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
+00005f70: 6966 206d 6f64 656c 2069 7320 676c 6f62  if model is glob
+00005f80: 616c 2062 6173 6564 206f 6e20 7468 6520  al based on the 
+00005f90: 696e 7075 7420 7072 696f 7220 6e61 6d65  input prior name
+00005fa0: 732e 2049 6620 7468 6579 2069 6e63 6c75  s. If they inclu
+00005fb0: 6465 2061 7320 696e 7374 7275 6d65 6e74  de as instrument
+00005fc0: 2022 6c63 222c 2073 6574 2074 6f20 676c   "lc", set to gl
+00005fd0: 6f62 616c 206d 6f64 656c 3a0a 2020 2020  obal model:.    
+00005fe0: 2020 2020 2020 2020 7365 6c66 2e67 6c6f          self.glo
+00005ff0: 6261 6c5f 7276 5f6d 6f64 656c 203d 2073  bal_rv_model = s
+00006000: 656c 662e 6368 6563 6b5f 676c 6f62 616c  elf.check_global
+00006010: 2827 7276 2729 0a20 2020 2020 2020 2020  ('rv').         
+00006020: 2020 2067 6c6f 6261 6c5f 6d6f 6465 6c20     global_model 
+00006030: 3d20 7365 6c66 2e67 6c6f 6261 6c5f 7276  = self.global_rv
+00006040: 5f6d 6f64 656c 0a20 2020 2020 2020 2020  _model.         
+00006050: 2020 2023 2049 6620 676c 6f62 616c 5f6d     # If global_m
+00006060: 6f64 656c 2069 7320 5472 7565 2c20 6372  odel is True, cr
+00006070: 6561 7465 2061 6e20 6164 6469 7469 6f6e  eate an addition
+00006080: 616c 206b 6579 2069 6e20 7468 6520 4750  al key in the GP
+00006090: 5f72 6567 7265 7373 6f72 7320 6172 7261  _regressors arra
+000060a0: 7920 7468 6174 2077 696c 6c20 6861 7665  y that will have
+000060b0: 2061 6c6c 2074 6865 2047 5020 7265 6772   all the GP regr
+000060c0: 6573 736f 7273 2061 7070 656e 6465 643a  essors appended:
+000060d0: 0a20 2020 2020 2020 2020 2020 2023 6966  .            #if
+000060e0: 2067 6c6f 6261 6c5f 6d6f 6465 6c20 616e   global_model an
+000060f0: 6420 2873 656c 662e 4750 5f72 765f 6172  d (self.GP_rv_ar
+00006100: 6775 6d65 6e74 7320 6973 206e 6f74 204e  guments is not N
+00006110: 6f6e 6529 3a0a 2020 2020 2020 2020 2020  one):.          
+00006120: 2020 2320 2020 2073 656c 662e 4750 5f72    #    self.GP_r
+00006130: 765f 6172 6775 6d65 6e74 735b 2772 7627  v_arguments['rv'
+00006140: 5d20 3d20 7365 6c66 2e61 7070 656e 645f  ] = self.append_
+00006150: 4750 286c 656e 2873 656c 662e 745f 7276  GP(len(self.t_rv
+00006160: 292c 2073 656c 662e 696e 7374 7275 6d65  ), self.instrume
+00006170: 6e74 5f69 6e64 6578 6573 5f72 762c 2073  nt_indexes_rv, s
+00006180: 656c 662e 4750 5f72 765f 6172 6775 6d65  elf.GP_rv_argume
+00006190: 6e74 732c 2069 6e61 6d65 7329 0a20 2020  nts, inames).   
+000061a0: 2020 2020 2020 2020 2047 505f 7265 6772           GP_regr
+000061b0: 6573 736f 7273 203d 2073 656c 662e 4750  essors = self.GP
+000061c0: 5f72 765f 6172 6775 6d65 6e74 730a 2020  _rv_arguments.  
+000061d0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000061e0: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
+000061f0: 6365 7074 696f 6e28 0a20 2020 2020 2020  ception(.       
+00006200: 2020 2020 2020 2020 2027 494e 5055 5420           'INPUT 
+00006210: 4552 524f 523a 2064 6963 7479 7065 206e  ERROR: dictype n
+00006220: 6f74 2075 6e64 6572 7374 6f6f 642e 2048  ot understood. H
+00006230: 6173 2074 6f20 6265 2065 6974 6865 7220  as to be either 
+00006240: 6c63 206f 7220 7276 2e27 0a20 2020 2020  lc or rv.'.     
+00006250: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00006260: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+00006270: 286e 696e 7374 7275 6d65 6e74 7329 3a0a  (ninstruments):.
+00006280: 2020 2020 2020 2020 2020 2020 696e 7374              inst
+00006290: 7275 6d65 6e74 203d 2069 6e61 6d65 735b  rument = inames[
+000062a0: 695d 0a20 2020 2020 2020 2020 2020 2064  i].            d
+000062b0: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
+000062c0: 6d65 6e74 5d20 3d20 7b7d 0a20 2020 2020  ment] = {}.     
+000062d0: 2020 2020 2020 2023 2053 6176 6520 6966         # Save if
+000062e0: 2061 2067 6976 656e 2069 6e73 7472 756d   a given instrum
+000062f0: 656e 7420 7769 6c6c 2072 6563 6569 7665  ent will receive
+00006300: 2072 6573 616d 706c 696e 6720 2869 6e69   resampling (ini
+00006310: 7469 616c 697a 6520 7468 6973 2061 7320  tialize this as 
+00006320: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+00006330: 2020 2020 6469 6374 696f 6e61 7279 5b69      dictionary[i
+00006340: 6e73 7472 756d 656e 745d 5b27 7265 7361  nstrument]['resa
+00006350: 6d70 6c69 6e67 275d 203d 2046 616c 7365  mpling'] = False
+00006360: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
+00006370: 6176 6520 6966 2061 2067 6976 656e 2069  ave if a given i
+00006380: 6e73 7472 756d 656e 7420 6861 7320 4750  nstrument has GP
+00006390: 2066 6974 7469 6e67 204f 4e20 2869 6e69   fitting ON (ini
+000063a0: 7469 616c 697a 6520 7468 6973 2061 7320  tialize this as 
+000063b0: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+000063c0: 2020 2020 6469 6374 696f 6e61 7279 5b69      dictionary[i
+000063d0: 6e73 7472 756d 656e 745d 5b27 4750 4465  nstrument]['GPDe
+000063e0: 7472 656e 6427 5d20 3d20 4661 6c73 650a  trend'] = False.
+000063f0: 2020 2020 2020 2020 2020 2020 2320 5361              # Sa
+00006400: 7665 2069 6620 7472 616e 7369 7420 6669  ve if transit fi
+00006410: 7474 696e 6720 7769 6c6c 2062 6520 646f  tting will be do
+00006420: 6e65 2066 6f72 2061 2067 6976 656e 2064  ne for a given d
+00006430: 6174 6173 6574 2f69 6e73 7472 756d 656e  ataset/instrumen
+00006440: 7420 2874 6869 7320 6973 2073 6f20 7573  t (this is so us
+00006450: 6572 7320 6361 6e20 6669 7420 7068 6f74  ers can fit phot
+00006460: 6f6d 6574 7279 2077 6974 682c 2065 2e67  ometry with, e.g
+00006470: 2e2c 2047 5073 293a 0a20 2020 2020 2020  ., GPs):.       
+00006480: 2020 2020 2069 6620 6469 6374 7970 6520       if dictype 
+00006490: 3d3d 2027 6c63 273a 0a20 2020 2020 2020  == 'lc':.       
+000064a0: 2020 2020 2020 2020 2064 6963 7469 6f6e           diction
+000064b0: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
+000064c0: 2754 7261 6e73 6974 4669 7427 5d20 3d20  'TransitFit'] = 
+000064d0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+000064e0: 2020 2020 2020 6469 6374 696f 6e61 7279        dictionary
+000064f0: 5b69 6e73 7472 756d 656e 745d 5b27 5472  [instrument]['Tr
+00006500: 616e 7369 7446 6974 4361 7477 6f6d 616e  ansitFitCatwoman
+00006510: 275d 203d 2046 616c 7365 0a20 2020 2020  '] = False.     
+00006520: 2020 2020 2020 2020 2020 2064 6963 7469             dicti
+00006530: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
+00006540: 5d5b 2745 636c 6970 7365 4669 7427 5d20  ]['EclipseFit'] 
+00006550: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+00006560: 2020 2020 2020 2020 6469 6374 696f 6e61          dictiona
+00006570: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
+00006580: 5068 6173 6543 7572 7665 4669 7427 5d20  PhaseCurveFit'] 
+00006590: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+000065a0: 2020 2020 2020 2020 6469 6374 696f 6e61          dictiona
+000065b0: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
+000065c0: 5472 616e 4563 6c46 6974 275d 203d 2046  TranEclFit'] = F
+000065d0: 616c 7365 0a0a 2020 2020 2020 2020 6966  alse..        if
+000065e0: 2064 6963 7479 7065 203d 3d20 276c 6327   dictype == 'lc'
+000065f0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00006600: 4578 7472 6163 7420 6c69 6d62 2d64 6172  Extract limb-dar
+00006610: 6b65 6e69 6e67 206c 6177 2e20 4966 206e  kening law. If n
+00006620: 6f20 6c69 6d62 2d64 6172 6b65 6e69 6e67  o limb-darkening
+00006630: 206c 6177 2077 6173 2067 6976 656e 2062   law was given b
+00006640: 7920 7468 6520 7573 6572 2c20 6173 7375  y the user, assu
+00006650: 6d65 204c 4420 6c61 7720 6465 7065 6e64  me LD law depend
+00006660: 696e 6720 6f6e 2077 6865 7468 6572 2074  ing on whether t
+00006670: 6865 2075 7365 7220 6465 6669 6e65 6420  he user defined 
+00006680: 6120 7072 696f 7220 666f 7220 7131 206f  a prior for q1 o
+00006690: 6e6c 7920 666f 7220 610a 2020 2020 2020  nly for a.      
+000066a0: 2020 2020 2020 2320 6769 7665 6e20 696e        # given in
+000066b0: 7374 7275 6d65 6e74 2028 696e 2077 6869  strument (in whi
+000066c0: 6368 2074 6861 7420 696e 7374 7275 6d65  ch that instrume
+000066d0: 6e74 2069 7320 7365 7420 746f 2074 6865  nt is set to the
+000066e0: 206c 696e 6561 7220 6c61 7729 206f 7220   linear law) or 
+000066f0: 6120 7072 696f 7220 666f 7220 7131 2061  a prior for q1 a
+00006700: 6e64 2071 322c 2069 6e20 7768 6963 6820  nd q2, in which 
+00006710: 6361 7365 2077 6520 6173 7375 6d65 2074  case we assume t
+00006720: 6865 2075 7365 720a 2020 2020 2020 2020  he user.        
+00006730: 2020 2020 2320 7761 6e74 7320 746f 2075      # wants to u
+00006740: 7365 2061 2071 7561 6472 6174 6963 206c  se a quadratic l
+00006750: 6177 2066 6f72 2074 6861 7420 696e 7374  aw for that inst
+00006760: 7275 6d65 6e74 2e20 4966 2075 7365 7220  rument. If user 
+00006770: 6761 7665 206f 6e65 206c 696d 622d 6461  gave one limb-da
+00006780: 726b 656e 696e 6720 6c61 772c 2061 7373  rkening law, ass
+00006790: 756d 6520 7468 6174 206c 6177 2066 6f72  ume that law for
+000067a0: 2061 6c6c 2069 6e73 7472 756d 656e 7473   all instruments
+000067b0: 2074 6861 7420 6861 7665 2070 7269 6f72   that have prior
+000067c0: 7320 666f 7220 7131 2061 6e64 2071 320a  s for q1 and q2.
+000067d0: 2020 2020 2020 2020 2020 2020 2320 2869              # (i
+000067e0: 6620 6f6e 6c79 2071 3120 6973 2067 6976  f only q1 is giv
+000067f0: 656e 2c20 6173 7375 6d65 206c 696e 6561  en, assume linea
+00006800: 7220 666f 7220 7468 6f73 6520 696e 7374  r for those inst
+00006810: 7275 6d65 6e74 7329 2e20 4966 204c 4420  ruments). If LD 
+00006820: 6c61 7773 2067 6976 656e 2066 6f72 2065  laws given for e
+00006830: 7665 7279 2069 6e73 7472 756d 656e 742c  very instrument,
+00006840: 2065 7874 7261 6374 2074 6865 6d3a 0a20   extract them:. 
+00006850: 2020 2020 2020 2020 2020 2061 6c6c 5f6c             all_l
+00006860: 645f 6c61 7773 203d 2073 656c 662e 6c64  d_laws = self.ld
+00006870: 5f6c 6177 732e 7370 6c69 7428 272c 2729  _laws.split(',')
+00006880: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00006890: 6c65 6e28 616c 6c5f 6c64 5f6c 6177 7329  len(all_ld_laws)
+000068a0: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+000068b0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+000068c0: 7261 6e67 6528 6e69 6e73 7472 756d 656e  range(ninstrumen
+000068d0: 7473 293a 0a20 2020 2020 2020 2020 2020  ts):.           
+000068e0: 2020 2020 2020 2020 2069 6e73 7472 756d           instrum
+000068f0: 656e 7420 3d20 696e 616d 6573 5b69 5d0a  ent = inames[i].
+00006900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006910: 2020 2020 7131 5f67 6976 656e 203d 2046      q1_given = F
+00006920: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+00006930: 2020 2020 2020 2020 2071 325f 6769 7665           q2_give
+00006940: 6e20 3d20 4661 6c73 650a 2020 2020 2020  n = False.      
+00006950: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00006960: 7220 7061 7261 6d65 7465 7220 696e 2073  r parameter in s
+00006970: 656c 662e 7072 696f 7273 2e6b 6579 7328  elf.priors.keys(
+00006980: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00006990: 2020 2020 2020 2020 2020 2069 6620 7061             if pa
+000069a0: 7261 6d65 7465 725b 303a 325d 203d 3d20  rameter[0:2] == 
+000069b0: 2771 3127 3a0a 2020 2020 2020 2020 2020  'q1':.          
+000069c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000069d0: 2020 6966 2069 6e73 7472 756d 656e 7420    if instrument 
+000069e0: 696e 2070 6172 616d 6574 6572 2e73 706c  in parameter.spl
+000069f0: 6974 2827 5f27 295b 313a 5d3a 0a20 2020  it('_')[1:]:.   
+00006a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006a10: 2020 2020 2020 2020 2020 2020 2071 315f               q1_
+00006a20: 6769 7665 6e20 3d20 5472 7565 0a20 2020  given = True.   
+00006a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006a40: 2020 2020 2069 6620 7061 7261 6d65 7465       if paramete
+00006a50: 725b 303a 325d 203d 3d20 2771 3227 3a0a  r[0:2] == 'q2':.
+00006a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006a70: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00006a80: 6e73 7472 756d 656e 7420 696e 2070 6172  nstrument in par
+00006a90: 616d 6574 6572 2e73 706c 6974 2827 5f27  ameter.split('_'
+00006aa0: 295b 313a 5d3a 0a20 2020 2020 2020 2020  )[1:]:.         
+00006ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006ac0: 2020 2020 2020 2071 325f 6769 7665 6e20         q2_given 
+00006ad0: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
+00006ae0: 2020 2020 2020 2020 2020 2069 6620 7131             if q1
+00006af0: 5f67 6976 656e 2061 6e64 2028 6e6f 7420  _given and (not 
+00006b00: 7132 5f67 6976 656e 293a 0a20 2020 2020  q2_given):.     
+00006b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006b20: 2020 2064 6963 7469 6f6e 6172 795b 696e     dictionary[in
+00006b30: 7374 7275 6d65 6e74 5d5b 276c 646c 6177  strument]['ldlaw
+00006b40: 275d 203d 2027 6c69 6e65 6172 270a 2020  '] = 'linear'.  
+00006b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006b60: 2020 656c 6966 2071 315f 6769 7665 6e20    elif q1_given 
+00006b70: 616e 6420 7132 5f67 6976 656e 3a0a 2020  and q2_given:.  
+00006b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006b90: 2020 2020 2020 6469 6374 696f 6e61 7279        dictionary
+00006ba0: 5b69 6e73 7472 756d 656e 745d 5b27 6c64  [instrument]['ld
+00006bb0: 6c61 7727 5d20 3d20 280a 2020 2020 2020  law'] = (.      
+00006bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006bd0: 2020 2020 2020 616c 6c5f 6c64 5f6c 6177        all_ld_law
+00006be0: 735b 305d 2e73 706c 6974 2827 2d27 295b  s[0].split('-')[
+00006bf0: 2d31 5d29 2e73 706c 6974 2829 5b30 5d2e  -1]).split()[0].
+00006c00: 6c6f 7765 7228 290a 2020 2020 2020 2020  lower().        
+00006c10: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00006c20: 2028 6e6f 7420 7131 5f67 6976 656e 2920   (not q1_given) 
+00006c30: 616e 6420 7132 5f67 6976 656e 3a0a 2020  and q2_given:.  
 00006c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c50: 7261 6973 6520 4578 6365 7074 696f 6e28  raise Exception(
-00006c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006c70: 2020 2020 2020 2020 2020 2020 2027 494e               'IN
-00006c80: 5055 5420 4552 524f 523a 2069 7420 6170  PUT ERROR: it ap
-00006c90: 7065 6172 7320 7131 2066 6f72 2069 6e73  pears q1 for ins
-00006ca0: 7472 756d 656e 7420 2720 2b0a 2020 2020  trument ' +.    
-00006cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006cc0: 2020 2020 2020 2020 696e 7374 7275 6d65          instrume
-00006cd0: 6e74 202b 0a20 2020 2020 2020 2020 2020  nt +.           
-00006ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006cf0: 2027 2077 6173 206e 6f74 2064 6566 696e   ' was not defin
-00006d00: 6564 2028 6275 7420 7132 2077 6173 2920  ed (but q2 was) 
-00006d10: 696e 2074 6865 2070 7269 6f72 2066 696c  in the prior fil
-00006d20: 652e 2729 0a20 2020 2020 2020 2020 2020  e.').           
-00006d30: 2020 2020 2020 2020 2020 2020 200a 2020               .  
-00006d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006d50: 2020 656c 6966 2028 6e6f 7420 7131 5f67    elif (not q1_g
-00006d60: 6976 656e 2920 616e 6420 286e 6f74 2071  iven) and (not q
-00006d70: 325f 6769 7665 6e29 3a0a 2020 2020 2020  2_given):.      
-00006d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006d90: 2020 6469 6374 696f 6e61 7279 5b69 6e73    dictionary[ins
-00006da0: 7472 756d 656e 745d 5b27 6c64 6c61 7727  trument]['ldlaw'
-00006db0: 5d20 3d20 276e 6f6e 6527 0a0a 2020 2020  ] = 'none'..    
-00006dc0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00006dd0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00006de0: 7220 6c64 5f6c 6177 2069 6e20 616c 6c5f  r ld_law in all_
-00006df0: 6c64 5f6c 6177 733a 0a20 2020 2020 2020  ld_laws:.       
-00006e00: 2020 2020 2020 2020 2020 2020 2069 6e73               ins
-00006e10: 7472 756d 656e 742c 206c 6420 3d20 6c64  trument, ld = ld
-00006e20: 5f6c 6177 2e73 706c 6974 2827 2d27 290a  _law.split('-').
-00006e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006e40: 2020 2020 6469 6374 696f 6e61 7279 5b69      dictionary[i
-00006e50: 6e73 7472 756d 656e 742e 7370 6c69 7428  nstrument.split(
-00006e60: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00006e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006e80: 205b 305d 5d5b 276c 646c 6177 275d 203d   [0]]['ldlaw'] =
-00006e90: 206c 642e 7370 6c69 7428 295b 305d 2e6c   ld.split()[0].l
-00006ea0: 6f77 6572 2829 0a0a 2020 2020 2020 2020  ower()..        
-00006eb0: 2320 4578 7472 6163 7420 7375 7065 7273  # Extract supers
-00006ec0: 616d 706c 696e 6720 7061 7261 6d65 7465  ampling paramete
-00006ed0: 7273 2069 6620 6769 7665 6e2e 0a20 2020  rs if given..   
-00006ee0: 2020 2020 2023 2046 6f72 206e 6f77 2074       # For now t
-00006ef0: 6869 7320 6f6e 6c79 2061 6c6c 6f77 7320  his only allows 
-00006f00: 696e 7075 7473 2066 726f 6d20 6c69 6768  inputs from ligh
-00006f10: 7463 7572 7665 733b 2054 4f44 4f3a 2061  tcurves; TODO: a
-00006f20: 6464 2073 7570 6572 7361 6d70 6c69 6e67  dd supersampling
-00006f30: 2066 6f72 2052 5673 2e0a 2020 2020 2020   for RVs..      
-00006f40: 2020 6966 2069 6e73 7472 756d 656e 745f    if instrument_
-00006f50: 7375 7065 7273 616d 7020 6973 206e 6f74  supersamp is not
-00006f60: 204e 6f6e 6520 616e 6420 6469 6374 7970   None and dictyp
-00006f70: 6520 3d3d 2027 6c63 273a 0a20 2020 2020  e == 'lc':.     
-00006f80: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00006f90: 7261 6e67 6528 6c65 6e28 696e 7374 7275  range(len(instru
-00006fa0: 6d65 6e74 5f73 7570 6572 7361 6d70 2929  ment_supersamp))
-00006fb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00006fc0: 2020 6966 2073 656c 662e 7665 7262 6f73    if self.verbos
-00006fd0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00006fe0: 2020 2020 2020 2070 7269 6e74 2827 5c74         print('\t
-00006ff0: 2052 6573 616d 706c 696e 6720 6465 7465   Resampling dete
-00007000: 6374 6564 2066 6f72 2069 6e73 7472 756d  cted for instrum
-00007010: 656e 7420 272c 0a20 2020 2020 2020 2020  ent ',.         
-00007020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007030: 2069 6e73 7472 756d 656e 745f 7375 7065   instrument_supe
-00007040: 7273 616d 705b 695d 290a 2020 2020 2020  rsamp[i]).      
-00007050: 2020 2020 2020 2020 2020 6469 6374 696f            dictio
-00007060: 6e61 7279 5b69 6e73 7472 756d 656e 745f  nary[instrument_
-00007070: 7375 7065 7273 616d 705b 695d 5d5b 2772  supersamp[i]]['r
-00007080: 6573 616d 706c 696e 6727 5d20 3d20 5472  esampling'] = Tr
-00007090: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-000070a0: 2020 2064 6963 7469 6f6e 6172 795b 0a20     dictionary[. 
+00006c50: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
+00006c60: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00006c70: 7365 2045 7863 6570 7469 6f6e 280a 2020  se Exception(.  
+00006c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c90: 2020 2020 2020 2020 2020 2749 4e50 5554            'INPUT
+00006ca0: 2045 5252 4f52 3a20 6974 2061 7070 6561   ERROR: it appea
+00006cb0: 7273 2071 3120 666f 7220 696e 7374 7275  rs q1 for instru
+00006cc0: 6d65 6e74 2027 202b 0a20 2020 2020 2020  ment ' +.       
+00006cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006ce0: 2020 2020 2069 6e73 7472 756d 656e 7420       instrument 
+00006cf0: 2b0a 2020 2020 2020 2020 2020 2020 2020  +.              
+00006d00: 2020 2020 2020 2020 2020 2020 2020 2720                ' 
+00006d10: 7761 7320 6e6f 7420 6465 6669 6e65 6420  was not defined 
+00006d20: 2862 7574 2071 3220 7761 7329 2069 6e20  (but q2 was) in 
+00006d30: 7468 6520 7072 696f 7220 6669 6c65 2e27  the prior file.'
+00006d40: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00006d50: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+00006d60: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00006d70: 6c69 6620 286e 6f74 2071 315f 6769 7665  lif (not q1_give
+00006d80: 6e29 2061 6e64 2028 6e6f 7420 7132 5f67  n) and (not q2_g
+00006d90: 6976 656e 293a 0a20 2020 2020 2020 2020  iven):.         
+00006da0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00006db0: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
+00006dc0: 6d65 6e74 5d5b 276c 646c 6177 275d 203d  ment]['ldlaw'] =
+00006dd0: 2027 6e6f 6e65 270a 0a20 2020 2020 2020   'none'..       
+00006de0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00006df0: 2020 2020 2020 2020 2020 2066 6f72 206c             for l
+00006e00: 645f 6c61 7720 696e 2061 6c6c 5f6c 645f  d_law in all_ld_
+00006e10: 6c61 7773 3a0a 2020 2020 2020 2020 2020  laws:.          
+00006e20: 2020 2020 2020 2020 2020 696e 7374 7275            instru
+00006e30: 6d65 6e74 2c20 6c64 203d 206c 645f 6c61  ment, ld = ld_la
+00006e40: 772e 7370 6c69 7428 272d 2729 0a20 2020  w.split('-').   
+00006e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006e60: 2064 6963 7469 6f6e 6172 795b 696e 7374   dictionary[inst
+00006e70: 7275 6d65 6e74 2e73 706c 6974 2829 0a20  rument.split(). 
+00006e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006e90: 2020 2020 2020 2020 2020 2020 2020 5b30                [0
+00006ea0: 5d5d 5b27 6c64 6c61 7727 5d20 3d20 6c64  ]]['ldlaw'] = ld
+00006eb0: 2e73 706c 6974 2829 5b30 5d2e 6c6f 7765  .split()[0].lowe
+00006ec0: 7228 290a 0a20 2020 2020 2020 2023 2045  r()..        # E
+00006ed0: 7874 7261 6374 2073 7570 6572 7361 6d70  xtract supersamp
+00006ee0: 6c69 6e67 2070 6172 616d 6574 6572 7320  ling parameters 
+00006ef0: 6966 2067 6976 656e 2e0a 2020 2020 2020  if given..      
+00006f00: 2020 2320 466f 7220 6e6f 7720 7468 6973    # For now this
+00006f10: 206f 6e6c 7920 616c 6c6f 7773 2069 6e70   only allows inp
+00006f20: 7574 7320 6672 6f6d 206c 6967 6874 6375  uts from lightcu
+00006f30: 7276 6573 3b20 544f 444f 3a20 6164 6420  rves; TODO: add 
+00006f40: 7375 7065 7273 616d 706c 696e 6720 666f  supersampling fo
+00006f50: 7220 5256 732e 0a20 2020 2020 2020 2069  r RVs..        i
+00006f60: 6620 696e 7374 7275 6d65 6e74 5f73 7570  f instrument_sup
+00006f70: 6572 7361 6d70 2069 7320 6e6f 7420 4e6f  ersamp is not No
+00006f80: 6e65 2061 6e64 2064 6963 7479 7065 203d  ne and dictype =
+00006f90: 3d20 276c 6327 3a0a 2020 2020 2020 2020  = 'lc':.        
+00006fa0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00006fb0: 6765 286c 656e 2869 6e73 7472 756d 656e  ge(len(instrumen
+00006fc0: 745f 7375 7065 7273 616d 7029 293a 0a20  t_supersamp)):. 
+00006fd0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00006fe0: 6620 7365 6c66 2e76 6572 626f 7365 3a0a  f self.verbose:.
+00006ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007000: 2020 2020 7072 696e 7428 275c 7420 5265      print('\t Re
+00007010: 7361 6d70 6c69 6e67 2064 6574 6563 7465  sampling detecte
+00007020: 6420 666f 7220 696e 7374 7275 6d65 6e74  d for instrument
+00007030: 2027 2c0a 2020 2020 2020 2020 2020 2020   ',.            
+00007040: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00007050: 7374 7275 6d65 6e74 5f73 7570 6572 7361  strument_supersa
+00007060: 6d70 5b69 5d29 0a20 2020 2020 2020 2020  mp[i]).         
+00007070: 2020 2020 2020 2064 6963 7469 6f6e 6172         dictionar
+00007080: 795b 696e 7374 7275 6d65 6e74 5f73 7570  y[instrument_sup
+00007090: 6572 7361 6d70 5b69 5d5d 5b27 7265 7361  ersamp[i]]['resa
+000070a0: 6d70 6c69 6e67 275d 203d 2054 7275 650a  mpling'] = True.
 000070b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000070c0: 2020 2069 6e73 7472 756d 656e 745f 7375     instrument_su
-000070d0: 7065 7273 616d 705b 695d 5d5b 276e 7265  persamp[i]]['nre
-000070e0: 7361 6d70 6c69 6e67 275d 203d 206e 5f73  sampling'] = n_s
-000070f0: 7570 6572 7361 6d70 5b69 5d0a 2020 2020  upersamp[i].    
-00007100: 2020 2020 2020 2020 2020 2020 6469 6374              dict
-00007110: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
-00007120: 745f 7375 7065 7273 616d 705b 695d 5d5b  t_supersamp[i]][
-00007130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007140: 2020 2020 2027 6578 7074 696d 6572 6573       'exptimeres
-00007150: 616d 706c 696e 6727 5d20 3d20 6578 7074  ampling'] = expt
-00007160: 696d 655f 7375 7065 7273 616d 705b 695d  ime_supersamp[i]
-00007170: 0a0a 2020 2020 2020 2020 2320 4368 6563  ..        # Chec
-00007180: 6b20 7468 6174 2075 7365 7220 6761 7665  k that user gave
-00007190: 2070 6572 696f 6473 2069 6e20 6368 726f   periods in chro
-000071a0: 6e6f 6c6f 6769 6361 6c20 6f72 6465 722e  nological order.
-000071b0: 2049 6620 6e6f 742c 2072 6169 7365 2061   If not, raise a
-000071c0: 6e20 6578 6365 7074 696f 6e2c 2074 656c  n exception, tel
-000071d0: 6c20 7468 6520 7573 6572 2061 6e64 2073  l the user and s
-000071e0: 746f 7020 7468 6973 206d 6164 6e65 7373  top this madness
-000071f0: 2e0a 2020 2020 2020 2020 2320 4e6f 7465  ..        # Note
-00007200: 2077 6520 6f6e 6c79 2063 6865 636b 2069   we only check i
-00007210: 6620 6669 7865 6420 6f72 206e 6f72 6d61  f fixed or norma
-00007220: 6c2f 7472 756e 6361 7465 6420 6e6f 726d  l/truncated norm
-00007230: 616c 2e20 496e 2074 6865 2075 6e69 666f  al. In the unifo
-00007240: 726d 206f 7220 6c6f 672d 756e 6966 6f72  rm or log-unifor
-00007250: 6d20 6361 7365 732c 2077 6520 7472 7573  m cases, we trus
-00007260: 7420 7468 6520 7573 6572 206b 6e6f 7773  t the user knows
-00007270: 0a20 2020 2020 2020 2023 2077 6861 7420  .        # what 
-00007280: 7468 6579 2061 7265 2064 6f69 6e67 2e20  they are doing. 
-00007290: 5765 2064 6f6e 2774 2074 6f75 6368 2074  We don't touch t
-000072a0: 6865 2042 6574 6120 6361 7365 2062 6563  he Beta case bec
-000072b0: 6175 7365 2074 6861 7420 776f 756c 6420  ause that would 
-000072c0: 6265 206e 7574 7320 746f 2070 7574 2069  be nuts to put i
-000072d0: 6e20 6120 7072 696f 7220 616e 7977 6179  n a prior anyway
-000072e0: 7320 6d6f 7374 206f 6620 7468 6520 7469  s most of the ti
-000072f0: 6d65 2e0a 2020 2020 2020 2020 6370 5f70  me..        cp_p
-00007300: 6e75 6d62 6572 203d 206e 702e 6172 7261  number = np.arra
-00007310: 7928 5b5d 290a 2020 2020 2020 2020 6370  y([]).        cp
-00007320: 5f70 6572 696f 6420 3d20 6e70 2e61 7272  _period = np.arr
-00007330: 6179 285b 5d29 0a20 2020 2020 2020 2066  ay([]).        f
-00007340: 6f72 2070 7269 2069 6e20 7365 6c66 2e70  or pri in self.p
-00007350: 7269 6f72 732e 6b65 7973 2829 3a0a 2020  riors.keys():.  
-00007360: 2020 2020 2020 2020 2020 6966 2070 7269            if pri
-00007370: 5b30 3a32 5d20 3d3d 2027 505f 273a 0a20  [0:2] == 'P_':. 
-00007380: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00007390: 6620 7365 6c66 2e70 7269 6f72 735b 7072  f self.priors[pr
-000073a0: 695d 5b27 6469 7374 7269 6275 7469 6f6e  i]['distribution
-000073b0: 275d 2e6c 6f77 6572 2829 2069 6e20 5b0a  '].lower() in [.
-000073c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000073d0: 2020 2020 2020 2020 276e 6f72 6d61 6c27          'normal'
-000073e0: 2c20 2774 7275 6e63 6174 6564 206e 6f72  , 'truncated nor
-000073f0: 6d61 6c27 0a20 2020 2020 2020 2020 2020  mal'.           
-00007400: 2020 2020 205d 3a0a 2020 2020 2020 2020       ]:.        
-00007410: 2020 2020 2020 2020 2020 2020 6370 5f70              cp_p
-00007420: 6e75 6d62 6572 203d 206e 702e 6170 7065  number = np.appe
-00007430: 6e64 2863 705f 706e 756d 6265 722c 0a20  nd(cp_pnumber,. 
-00007440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007460: 2020 2020 2020 2020 2020 696e 7428 7072            int(pr
-00007470: 692e 7370 6c69 7428 275f 2729 5b2d 315d  i.split('_')[-1]
-00007480: 5b31 3a5d 2929 0a20 2020 2020 2020 2020  [1:])).         
-00007490: 2020 2020 2020 2020 2020 2063 705f 7065             cp_pe
-000074a0: 7269 6f64 203d 206e 702e 6170 7065 6e64  riod = np.append
-000074b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000074c0: 2020 2020 2020 2020 2020 6370 5f70 6572            cp_per
-000074d0: 696f 642c 2073 656c 662e 7072 696f 7273  iod, self.priors
-000074e0: 5b70 7269 5d5b 2768 7970 6572 7061 7261  [pri]['hyperpara
-000074f0: 6d65 7465 7273 275d 5b30 5d29 0a20 2020  meters'][0]).   
-00007500: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00007510: 6620 7365 6c66 2e70 7269 6f72 735b 7072  f self.priors[pr
-00007520: 695d 5b27 6469 7374 7269 6275 7469 6f6e  i]['distribution
-00007530: 275d 2e6c 6f77 6572 2829 203d 3d20 2766  '].lower() == 'f
-00007540: 6978 6564 273a 0a20 2020 2020 2020 2020  ixed':.         
-00007550: 2020 2020 2020 2020 2020 2063 705f 706e             cp_pn
-00007560: 756d 6265 7220 3d20 6e70 2e61 7070 656e  umber = np.appen
-00007570: 6428 6370 5f70 6e75 6d62 6572 2c0a 2020  d(cp_pnumber,.  
-00007580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000075a0: 2020 2020 2020 2020 2069 6e74 2870 7269           int(pri
-000075b0: 2e73 706c 6974 2827 5f27 295b 2d31 5d5b  .split('_')[-1][
-000075c0: 313a 5d29 290a 2020 2020 2020 2020 2020  1:])).          
-000075d0: 2020 2020 2020 2020 2020 6370 5f70 6572            cp_per
-000075e0: 696f 6420 3d20 6e70 2e61 7070 656e 6428  iod = np.append(
-000075f0: 6370 5f70 6572 696f 642c 0a20 2020 2020  cp_period,.     
-00007600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007620: 2020 2020 2073 656c 662e 7072 696f 7273       self.priors
-00007630: 5b70 7269 5d5b 2768 7970 6572 7061 7261  [pri]['hyperpara
-00007640: 6d65 7465 7273 275d 290a 2020 2020 2020  meters']).      
-00007650: 2020 6966 206c 656e 2863 705f 7065 7269    if len(cp_peri
-00007660: 6f64 2920 3e20 313a 0a20 2020 2020 2020  od) > 1:.       
-00007670: 2020 2020 2069 6478 203d 206e 702e 6172       idx = np.ar
-00007680: 6773 6f72 7428 6370 5f70 6e75 6d62 6572  gsort(cp_pnumber
-00007690: 290a 2020 2020 2020 2020 2020 2020 6350  ).            cP
-000076a0: 203d 2063 705f 7065 7269 6f64 5b69 6478   = cp_period[idx
-000076b0: 5b30 5d5d 0a20 2020 2020 2020 2020 2020  [0]].           
-000076c0: 2063 505f 6964 7820 3d20 6370 5f70 6e75   cP_idx = cp_pnu
-000076d0: 6d62 6572 5b69 6478 5b30 5d5d 0a20 2020  mber[idx[0]].   
-000076e0: 2020 2020 2020 2020 2066 6f72 2063 6964           for cid
-000076f0: 7820 696e 2069 6478 5b31 3a5d 3a0a 2020  x in idx[1:]:.  
-00007700: 2020 2020 2020 2020 2020 2020 2020 5020                P 
-00007710: 3d20 6370 5f70 6572 696f 645b 6369 6478  = cp_period[cidx
-00007720: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00007730: 2020 6966 2050 203e 2063 503a 0a20 2020    if P > cP:.   
-00007740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007750: 2063 5020 3d20 500a 2020 2020 2020 2020   cP = P.        
-00007760: 2020 2020 2020 2020 2020 2020 6350 5f69              cP_i
-00007770: 6478 203d 2063 705f 706e 756d 6265 725b  dx = cp_pnumber[
-00007780: 6369 6478 5d0a 2020 2020 2020 2020 2020  cidx].          
-00007790: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000077a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000077b0: 7072 696e 7428 275c 6e27 290a 2020 2020  print('\n').    
-000077c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000077d0: 7261 6973 6520 4578 6365 7074 696f 6e28  raise Exception(
-000077e0: 2749 4e50 5554 2045 5252 4f52 3a20 706c  'INPUT ERROR: pl
-000077f0: 616e 6574 6172 7920 7065 7269 6f64 7320  anetary periods 
-00007800: 696e 2074 6865 2070 7269 6f72 7320 6172  in the priors ar
-00007810: 6520 6e6f 7420 6f72 6465 7265 6420 696e  e not ordered in
-00007820: 2063 6872 6f6e 6f6c 6f67 6963 616c 206f   chronological o
-00007830: 7264 6572 2e20 272b 5c0a 2020 2020 2020  rder. '+\.      
-00007840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007850: 2020 2020 2020 2020 2020 2020 2020 2750                'P
-00007860: 6c61 6e65 7420 707b 303a 7d20 6861 7320  lanet p{0:} has 
-00007870: 6120 7065 7269 6f64 206f 6620 7b31 3a7d  a period of {1:}
-00007880: 2064 6179 732c 2077 6869 6c65 2070 6c61   days, while pla
-00007890: 6e65 7420 707b 323a 7d20 6861 7320 6120  net p{2:} has a 
-000078a0: 7065 7269 6f64 206f 6620 7b33 3a7d 2064  period of {3:} d
-000078b0: 6179 7320 2850 5f70 7b30 3a7d 3c50 5f70  ays (P_p{0:}<P_p
-000078c0: 7b32 3a7d 292e 272e 666f 726d 6174 2869  {2:}).'.format(i
-000078d0: 6e74 2863 705f 706e 756d 6265 725b 6369  nt(cp_pnumber[ci
-000078e0: 6478 5d29 2c50 2c69 6e74 2863 505f 6964  dx]),P,int(cP_id
-000078f0: 7829 2c63 5029 290a 0a20 2020 2020 2020  x),cP))..       
-00007900: 2023 204e 6f77 2c20 6966 2067 656e 6572   # Now, if gener
-00007910: 6174 696e 6720 6c69 6768 7463 7572 7665  ating lightcurve
-00007920: 2064 6963 742c 2063 6865 636b 2077 6865   dict, check whe
-00007930: 7468 6572 2066 6f72 2073 6f6d 6520 7068  ther for some ph
-00007940: 6f74 6f6d 6574 7269 6320 696e 7374 7275  otometric instru
-00007950: 6d65 6e74 7320 6f6e 6c79 2070 686f 746f  ments only photo
-00007960: 6d65 7472 792c 2061 6e64 206e 6f74 2061  metry, and not a
-00007970: 0a20 2020 2020 2020 2023 2074 7261 6e73  .        # trans
-00007980: 6974 2c20 7769 6c6c 2062 6520 6669 742e  it, will be fit.
-00007990: 2054 6869 7320 6973 2062 6173 6564 206f   This is based o
-000079a0: 6e20 7768 6574 6865 7220 7468 6520 7573  n whether the us
-000079b0: 6572 2067 6176 6520 6c69 6d62 2d64 6172  er gave limb-dar
-000079c0: 6b65 6e69 6e67 2063 6f65 6666 6963 6965  kening coefficie
-000079d0: 6e74 7320 666f 7220 6120 6769 7665 6e20  nts for a given 
-000079e0: 7068 6f74 6f6d 6574 7269 630a 2020 2020  photometric.    
-000079f0: 2020 2020 2320 696e 7374 7275 6d65 6e74      # instrument
-00007a00: 206f 7220 6e6f 742e 2049 6620 6769 7665   or not. If give
-00007a10: 6e2c 2074 7261 6e73 6974 2069 7320 6669  n, transit is fi
-00007a20: 742e 2049 6620 6e6f 742c 206e 6f20 7472  t. If not, no tr
-00007a30: 616e 7369 7420 6973 2066 6974 2e20 4174  ansit is fit. At
-00007a40: 2074 6865 2073 616d 6520 7469 6d65 2063   the same time c
-00007a50: 6865 636b 2069 6620 7573 6572 2077 616e  heck if user wan
-00007a60: 7473 2074 6f0a 2020 2020 2020 2020 2320  ts to.        # 
-00007a70: 6669 7420 5454 5673 2066 6f72 2074 6865  fit TTVs for the
-00007a80: 2064 6573 6972 6564 2069 6e73 7472 756d   desired instrum
-00007a90: 656e 742e 2046 6f72 2074 6869 7320 6c61  ent. For this la
-00007aa0: 7474 6572 2c20 696e 6974 6961 6c69 7a65  tter, initialize
-00007ab0: 2061 7320 6661 6c73 6520 666f 7220 6561   as false for ea
-00007ac0: 6368 2069 6e73 7472 756d 656e 7420 616e  ch instrument an
-00007ad0: 6420 6f6e 6c79 2063 6861 6e67 6520 746f  d only change to
-00007ae0: 0a20 2020 2020 2020 2023 2074 7275 6520  .        # true 
-00007af0: 6966 2074 6865 2070 7269 6f72 7320 6172  if the priors ar
-00007b00: 6520 666f 756e 643a 0a20 2020 2020 2020  e found:.       
-00007b10: 2069 6620 6469 6374 7970 6520 3d3d 2027   if dictype == '
-00007b20: 6c63 273a 0a20 2020 2020 2020 2020 2020  lc':.           
-00007b30: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00007b40: 6e69 6e73 7472 756d 656e 7473 293a 0a20  ninstruments):. 
-00007b50: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00007b60: 6963 7469 6f6e 6172 795b 696e 616d 6573  ictionary[inames
-00007b70: 5b69 5d5d 5b27 5454 5673 275d 203d 207b  [i]]['TTVs'] = {
-00007b80: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-00007b90: 2020 666f 7220 7069 2069 6e20 6e75 6d62    for pi in numb
-00007ba0: 6572 696e 675f 706c 616e 6574 733a 0a20  ering_planets:. 
-00007bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007bc0: 2020 2064 6963 7469 6f6e 6172 795b 696e     dictionary[in
-00007bd0: 616d 6573 5b69 5d5d 5b27 5454 5673 275d  ames[i]]['TTVs']
-00007be0: 5b70 695d 203d 207b 7d0a 2020 2020 2020  [pi] = {}.      
-00007bf0: 2020 2020 2020 2020 2020 2020 2020 6469                di
-00007c00: 6374 696f 6e61 7279 5b69 6e61 6d65 735b  ctionary[inames[
-00007c10: 695d 5d5b 2754 5456 7327 5d5b 7069 5d5b  i]]['TTVs'][pi][
-00007c20: 2773 7461 7475 7327 5d20 3d20 4661 6c73  'status'] = Fals
-00007c30: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00007c40: 2020 2020 2020 6469 6374 696f 6e61 7279        dictionary
-00007c50: 5b69 6e61 6d65 735b 695d 5d5b 2754 5456  [inames[i]]['TTV
-00007c60: 7327 5d5b 7069 5d5b 2770 6172 616d 6574  s'][pi]['paramet
-00007c70: 7269 7a61 7469 6f6e 275d 203d 2027 6474  rization'] = 'dt
-00007c80: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-00007c90: 2020 2020 2020 6469 6374 696f 6e61 7279        dictionary
-00007ca0: 5b69 6e61 6d65 735b 695d 5d5b 2754 5456  [inames[i]]['TTV
-00007cb0: 7327 5d5b 7069 5d5b 2774 7261 6e73 6974  s'][pi]['transit
-00007cc0: 5f6e 756d 6265 7227 5d20 3d20 5b5d 0a0a  _number'] = []..
-00007cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ce0: 666f 7220 7072 6920 696e 2073 656c 662e  for pri in self.
-00007cf0: 7072 696f 7273 2e6b 6579 7328 293a 0a0a  priors.keys():..
-00007d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007d10: 2020 2020 6966 2070 7269 5b30 3a32 5d20      if pri[0:2] 
-00007d20: 3d3d 2027 7131 273a 0a0a 2020 2020 2020  == 'q1':..      
-00007d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007d40: 2020 6966 2069 6e61 6d65 735b 695d 2069    if inames[i] i
-00007d50: 6e20 7072 692e 7370 6c69 7428 275f 2729  n pri.split('_')
-00007d60: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-00007d70: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00007d80: 6963 7469 6f6e 6172 795b 696e 616d 6573  ictionary[inames
-00007d90: 5b69 5d5d 5b27 5472 616e 7369 7446 6974  [i]]['TransitFit
-00007da0: 275d 203d 2054 7275 650a 0a20 2020 2020  '] = True..     
-00007db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007dc0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-00007dd0: 6572 626f 7365 3a0a 0a20 2020 2020 2020  erbose:..       
-00007de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007df0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00007e00: 5c74 2054 7261 6e73 6974 2066 6974 2064  \t Transit fit d
-00007e10: 6574 6563 7465 6420 666f 7220 696e 7374  etected for inst
-00007e20: 7275 6d65 6e74 2027 2c0a 2020 2020 2020  rument ',.      
-00007e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007e50: 696e 616d 6573 5b69 5d29 0a0a 2020 2020  inames[i])..    
-00007e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007e70: 6966 2070 7269 5b30 3a32 5d20 3d3d 2027  if pri[0:2] == '
-00007e80: 7031 273a 0a0a 2020 2020 2020 2020 2020  p1':..          
-00007e90: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00007ea0: 4966 2043 5720 6465 6669 6e65 6420 6f6e  If CW defined on
-00007eb0: 2069 6e73 7472 756d 656e 742c 206f 722c   instrument, or,
-00007ec0: 2074 6865 7265 2773 2061 2073 696e 676c   there's a singl
-00007ed0: 6520 4357 2066 6f72 2061 6c6c 2069 6e73  e CW for all ins
-00007ee0: 7472 756d 656e 7473 3a0a 2020 2020 2020  truments:.      
-00007ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f00: 2020 6966 2028 696e 616d 6573 5b69 5d20    if (inames[i] 
-00007f10: 696e 2070 7269 2e73 706c 6974 2827 5f27  in pri.split('_'
-00007f20: 2929 206f 7220 286c 656e 2870 7269 2e73  )) or (len(pri.s
-00007f30: 706c 6974 2827 5f27 2929 203d 3d20 3229  plit('_')) == 2)
-00007f40: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-00007f50: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00007f60: 6963 7469 6f6e 6172 795b 696e 616d 6573  ictionary[inames
-00007f70: 5b69 5d5d 5b27 5472 616e 7369 7446 6974  [i]]['TransitFit
-00007f80: 275d 203d 2054 7275 650a 2020 2020 2020  '] = True.      
-00007f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007fa0: 2020 2020 2020 6469 6374 696f 6e61 7279        dictionary
-00007fb0: 5b69 6e61 6d65 735b 695d 5d5b 2754 7261  [inames[i]]['Tra
-00007fc0: 6e73 6974 4669 7443 6174 776f 6d61 6e27  nsitFitCatwoman'
-00007fd0: 5d20 3d20 5472 7565 0a0a 2020 2020 2020  ] = True..      
-00007fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ff0: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00008000: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00008010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008020: 2020 200a 2020 2020 2020 2020 2020 2020     .            
+000070c0: 6469 6374 696f 6e61 7279 5b0a 2020 2020  dictionary[.    
+000070d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000070e0: 696e 7374 7275 6d65 6e74 5f73 7570 6572  instrument_super
+000070f0: 7361 6d70 5b69 5d5d 5b27 6e72 6573 616d  samp[i]]['nresam
+00007100: 706c 696e 6727 5d20 3d20 6e5f 7375 7065  pling'] = n_supe
+00007110: 7273 616d 705b 695d 0a20 2020 2020 2020  rsamp[i].       
+00007120: 2020 2020 2020 2020 2064 6963 7469 6f6e           diction
+00007130: 6172 795b 696e 7374 7275 6d65 6e74 5f73  ary[instrument_s
+00007140: 7570 6572 7361 6d70 5b69 5d5d 5b0a 2020  upersamp[i]][.  
+00007150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007160: 2020 2765 7870 7469 6d65 7265 7361 6d70    'exptimeresamp
+00007170: 6c69 6e67 275d 203d 2065 7870 7469 6d65  ling'] = exptime
+00007180: 5f73 7570 6572 7361 6d70 5b69 5d0a 0a20  _supersamp[i].. 
+00007190: 2020 2020 2020 2023 2043 6865 636b 2074         # Check t
+000071a0: 6861 7420 7573 6572 2067 6176 6520 7065  hat user gave pe
+000071b0: 7269 6f64 7320 696e 2063 6872 6f6e 6f6c  riods in chronol
+000071c0: 6f67 6963 616c 206f 7264 6572 2e20 4966  ogical order. If
+000071d0: 206e 6f74 2c20 7261 6973 6520 616e 2065   not, raise an e
+000071e0: 7863 6570 7469 6f6e 2c20 7465 6c6c 2074  xception, tell t
+000071f0: 6865 2075 7365 7220 616e 6420 7374 6f70  he user and stop
+00007200: 2074 6869 7320 6d61 646e 6573 732e 0a20   this madness.. 
+00007210: 2020 2020 2020 2023 204e 6f74 6520 7765         # Note we
+00007220: 206f 6e6c 7920 6368 6563 6b20 6966 2066   only check if f
+00007230: 6978 6564 206f 7220 6e6f 726d 616c 2f74  ixed or normal/t
+00007240: 7275 6e63 6174 6564 206e 6f72 6d61 6c2e  runcated normal.
+00007250: 2049 6e20 7468 6520 756e 6966 6f72 6d20   In the uniform 
+00007260: 6f72 206c 6f67 2d75 6e69 666f 726d 2063  or log-uniform c
+00007270: 6173 6573 2c20 7765 2074 7275 7374 2074  ases, we trust t
+00007280: 6865 2075 7365 7220 6b6e 6f77 730a 2020  he user knows.  
+00007290: 2020 2020 2020 2320 7768 6174 2074 6865        # what the
+000072a0: 7920 6172 6520 646f 696e 672e 2057 6520  y are doing. We 
+000072b0: 646f 6e27 7420 746f 7563 6820 7468 6520  don't touch the 
+000072c0: 4265 7461 2063 6173 6520 6265 6361 7573  Beta case becaus
+000072d0: 6520 7468 6174 2077 6f75 6c64 2062 6520  e that would be 
+000072e0: 6e75 7473 2074 6f20 7075 7420 696e 2061  nuts to put in a
+000072f0: 2070 7269 6f72 2061 6e79 7761 7973 206d   prior anyways m
+00007300: 6f73 7420 6f66 2074 6865 2074 696d 652e  ost of the time.
+00007310: 0a20 2020 2020 2020 2063 705f 706e 756d  .        cp_pnum
+00007320: 6265 7220 3d20 6e70 2e61 7272 6179 285b  ber = np.array([
+00007330: 5d29 0a20 2020 2020 2020 2063 705f 7065  ]).        cp_pe
+00007340: 7269 6f64 203d 206e 702e 6172 7261 7928  riod = np.array(
+00007350: 5b5d 290a 2020 2020 2020 2020 666f 7220  []).        for 
+00007360: 7072 6920 696e 2073 656c 662e 7072 696f  pri in self.prio
+00007370: 7273 2e6b 6579 7328 293a 0a20 2020 2020  rs.keys():.     
+00007380: 2020 2020 2020 2069 6620 7072 695b 303a         if pri[0:
+00007390: 325d 203d 3d20 2750 5f27 3a0a 2020 2020  2] == 'P_':.    
+000073a0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000073b0: 656c 662e 7072 696f 7273 5b70 7269 5d5b  elf.priors[pri][
+000073c0: 2764 6973 7472 6962 7574 696f 6e27 5d2e  'distribution'].
+000073d0: 6c6f 7765 7228 2920 696e 205b 0a20 2020  lower() in [.   
+000073e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000073f0: 2020 2020 2027 6e6f 726d 616c 272c 2027       'normal', '
+00007400: 7472 756e 6361 7465 6420 6e6f 726d 616c  truncated normal
+00007410: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
+00007420: 2020 5d3a 0a20 2020 2020 2020 2020 2020    ]:.           
+00007430: 2020 2020 2020 2020 2063 705f 706e 756d           cp_pnum
+00007440: 6265 7220 3d20 6e70 2e61 7070 656e 6428  ber = np.append(
+00007450: 6370 5f70 6e75 6d62 6572 2c0a 2020 2020  cp_pnumber,.    
+00007460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007480: 2020 2020 2020 2069 6e74 2870 7269 2e73         int(pri.s
+00007490: 706c 6974 2827 5f27 295b 2d31 5d5b 313a  plit('_')[-1][1:
+000074a0: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
+000074b0: 2020 2020 2020 2020 6370 5f70 6572 696f          cp_perio
+000074c0: 6420 3d20 6e70 2e61 7070 656e 6428 0a20  d = np.append(. 
+000074d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000074e0: 2020 2020 2020 2063 705f 7065 7269 6f64         cp_period
+000074f0: 2c20 7365 6c66 2e70 7269 6f72 735b 7072  , self.priors[pr
+00007500: 695d 5b27 6879 7065 7270 6172 616d 6574  i]['hyperparamet
+00007510: 6572 7327 5d5b 305d 290a 2020 2020 2020  ers'][0]).      
+00007520: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+00007530: 656c 662e 7072 696f 7273 5b70 7269 5d5b  elf.priors[pri][
+00007540: 2764 6973 7472 6962 7574 696f 6e27 5d2e  'distribution'].
+00007550: 6c6f 7765 7228 2920 3d3d 2027 6669 7865  lower() == 'fixe
+00007560: 6427 3a0a 2020 2020 2020 2020 2020 2020  d':.            
+00007570: 2020 2020 2020 2020 6370 5f70 6e75 6d62          cp_pnumb
+00007580: 6572 203d 206e 702e 6170 7065 6e64 2863  er = np.append(c
+00007590: 705f 706e 756d 6265 722c 0a20 2020 2020  p_pnumber,.     
+000075a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000075b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000075c0: 2020 2020 2020 696e 7428 7072 692e 7370        int(pri.sp
+000075d0: 6c69 7428 275f 2729 5b2d 315d 5b31 3a5d  lit('_')[-1][1:]
+000075e0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+000075f0: 2020 2020 2020 2063 705f 7065 7269 6f64         cp_period
+00007600: 203d 206e 702e 6170 7065 6e64 2863 705f   = np.append(cp_
+00007610: 7065 7269 6f64 2c0a 2020 2020 2020 2020  period,.        
+00007620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007640: 2020 7365 6c66 2e70 7269 6f72 735b 7072    self.priors[pr
+00007650: 695d 5b27 6879 7065 7270 6172 616d 6574  i]['hyperparamet
+00007660: 6572 7327 5d29 0a20 2020 2020 2020 2069  ers']).        i
+00007670: 6620 6c65 6e28 6370 5f70 6572 696f 6429  f len(cp_period)
+00007680: 203e 2031 3a0a 2020 2020 2020 2020 2020   > 1:.          
+00007690: 2020 6964 7820 3d20 6e70 2e61 7267 736f    idx = np.argso
+000076a0: 7274 2863 705f 706e 756d 6265 7229 0a20  rt(cp_pnumber). 
+000076b0: 2020 2020 2020 2020 2020 2063 5020 3d20             cP = 
+000076c0: 6370 5f70 6572 696f 645b 6964 785b 305d  cp_period[idx[0]
+000076d0: 5d0a 2020 2020 2020 2020 2020 2020 6350  ].            cP
+000076e0: 5f69 6478 203d 2063 705f 706e 756d 6265  _idx = cp_pnumbe
+000076f0: 725b 6964 785b 305d 5d0a 2020 2020 2020  r[idx[0]].      
+00007700: 2020 2020 2020 666f 7220 6369 6478 2069        for cidx i
+00007710: 6e20 6964 785b 313a 5d3a 0a20 2020 2020  n idx[1:]:.     
+00007720: 2020 2020 2020 2020 2020 2050 203d 2063             P = c
+00007730: 705f 7065 7269 6f64 5b63 6964 785d 0a20  p_period[cidx]. 
+00007740: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00007750: 6620 5020 3e20 6350 3a0a 2020 2020 2020  f P > cP:.      
+00007760: 2020 2020 2020 2020 2020 2020 2020 6350                cP
+00007770: 203d 2050 0a20 2020 2020 2020 2020 2020   = P.           
+00007780: 2020 2020 2020 2020 2063 505f 6964 7820           cP_idx 
+00007790: 3d20 6370 5f70 6e75 6d62 6572 5b63 6964  = cp_pnumber[cid
+000077a0: 785d 0a20 2020 2020 2020 2020 2020 2020  x].             
+000077b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000077c0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+000077d0: 6e74 2827 5c6e 2729 0a20 2020 2020 2020  nt('\n').       
+000077e0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+000077f0: 7365 2045 7863 6570 7469 6f6e 2827 494e  se Exception('IN
+00007800: 5055 5420 4552 524f 523a 2070 6c61 6e65  PUT ERROR: plane
+00007810: 7461 7279 2070 6572 696f 6473 2069 6e20  tary periods in 
+00007820: 7468 6520 7072 696f 7273 2061 7265 206e  the priors are n
+00007830: 6f74 206f 7264 6572 6564 2069 6e20 6368  ot ordered in ch
+00007840: 726f 6e6f 6c6f 6769 6361 6c20 6f72 6465  ronological orde
+00007850: 722e 2027 2b5c 0a20 2020 2020 2020 2020  r. '+\.         
+00007860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007870: 2020 2020 2020 2020 2020 2027 506c 616e             'Plan
+00007880: 6574 2070 7b30 3a7d 2068 6173 2061 2070  et p{0:} has a p
+00007890: 6572 696f 6420 6f66 207b 313a 7d20 6461  eriod of {1:} da
+000078a0: 7973 2c20 7768 696c 6520 706c 616e 6574  ys, while planet
+000078b0: 2070 7b32 3a7d 2068 6173 2061 2070 6572   p{2:} has a per
+000078c0: 696f 6420 6f66 207b 333a 7d20 6461 7973  iod of {3:} days
+000078d0: 2028 505f 707b 303a 7d3c 505f 707b 323a   (P_p{0:}<P_p{2:
+000078e0: 7d29 2e27 2e66 6f72 6d61 7428 696e 7428  }).'.format(int(
+000078f0: 6370 5f70 6e75 6d62 6572 5b63 6964 785d  cp_pnumber[cidx]
+00007900: 292c 502c 696e 7428 6350 5f69 6478 292c  ),P,int(cP_idx),
+00007910: 6350 2929 0a0a 2020 2020 2020 2020 2320  cP))..        # 
+00007920: 4e6f 772c 2069 6620 6765 6e65 7261 7469  Now, if generati
+00007930: 6e67 206c 6967 6874 6375 7276 6520 6469  ng lightcurve di
+00007940: 6374 2c20 6368 6563 6b20 7768 6574 6865  ct, check whethe
+00007950: 7220 666f 7220 736f 6d65 2070 686f 746f  r for some photo
+00007960: 6d65 7472 6963 2069 6e73 7472 756d 656e  metric instrumen
+00007970: 7473 206f 6e6c 7920 7068 6f74 6f6d 6574  ts only photomet
+00007980: 7279 2c20 616e 6420 6e6f 7420 610a 2020  ry, and not a.  
+00007990: 2020 2020 2020 2320 7472 616e 7369 742c        # transit,
+000079a0: 2077 696c 6c20 6265 2066 6974 2e20 5468   will be fit. Th
+000079b0: 6973 2069 7320 6261 7365 6420 6f6e 2077  is is based on w
+000079c0: 6865 7468 6572 2074 6865 2075 7365 7220  hether the user 
+000079d0: 6761 7665 206c 696d 622d 6461 726b 656e  gave limb-darken
+000079e0: 696e 6720 636f 6566 6669 6369 656e 7473  ing coefficients
+000079f0: 2066 6f72 2061 2067 6976 656e 2070 686f   for a given pho
+00007a00: 746f 6d65 7472 6963 0a20 2020 2020 2020  tometric.       
+00007a10: 2023 2069 6e73 7472 756d 656e 7420 6f72   # instrument or
+00007a20: 206e 6f74 2e20 4966 2067 6976 656e 2c20   not. If given, 
+00007a30: 7472 616e 7369 7420 6973 2066 6974 2e20  transit is fit. 
+00007a40: 4966 206e 6f74 2c20 6e6f 2074 7261 6e73  If not, no trans
+00007a50: 6974 2069 7320 6669 742e 2041 7420 7468  it is fit. At th
+00007a60: 6520 7361 6d65 2074 696d 6520 6368 6563  e same time chec
+00007a70: 6b20 6966 2075 7365 7220 7761 6e74 7320  k if user wants 
+00007a80: 746f 0a20 2020 2020 2020 2023 2066 6974  to.        # fit
+00007a90: 2054 5456 7320 666f 7220 7468 6520 6465   TTVs for the de
+00007aa0: 7369 7265 6420 696e 7374 7275 6d65 6e74  sired instrument
+00007ab0: 2e20 466f 7220 7468 6973 206c 6174 7465  . For this latte
+00007ac0: 722c 2069 6e69 7469 616c 697a 6520 6173  r, initialize as
+00007ad0: 2066 616c 7365 2066 6f72 2065 6163 6820   false for each 
+00007ae0: 696e 7374 7275 6d65 6e74 2061 6e64 206f  instrument and o
+00007af0: 6e6c 7920 6368 616e 6765 2074 6f0a 2020  nly change to.  
+00007b00: 2020 2020 2020 2320 7472 7565 2069 6620        # true if 
+00007b10: 7468 6520 7072 696f 7273 2061 7265 2066  the priors are f
+00007b20: 6f75 6e64 3a0a 2020 2020 2020 2020 6966  ound:.        if
+00007b30: 2064 6963 7479 7065 203d 3d20 276c 6327   dictype == 'lc'
+00007b40: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
+00007b50: 7220 6920 696e 2072 616e 6765 286e 696e  r i in range(nin
+00007b60: 7374 7275 6d65 6e74 7329 3a0a 2020 2020  struments):.    
+00007b70: 2020 2020 2020 2020 2020 2020 6469 6374              dict
+00007b80: 696f 6e61 7279 5b69 6e61 6d65 735b 695d  ionary[inames[i]
+00007b90: 5d5b 2754 5456 7327 5d20 3d20 7b7d 0a20  ]['TTVs'] = {}. 
+00007ba0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00007bb0: 6f72 2070 6920 696e 206e 756d 6265 7269  or pi in numberi
+00007bc0: 6e67 5f70 6c61 6e65 7473 3a0a 2020 2020  ng_planets:.    
+00007bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007be0: 6469 6374 696f 6e61 7279 5b69 6e61 6d65  dictionary[iname
+00007bf0: 735b 695d 5d5b 2754 5456 7327 5d5b 7069  s[i]]['TTVs'][pi
+00007c00: 5d20 3d20 7b7d 0a20 2020 2020 2020 2020  ] = {}.         
+00007c10: 2020 2020 2020 2020 2020 2064 6963 7469             dicti
+00007c20: 6f6e 6172 795b 696e 616d 6573 5b69 5d5d  onary[inames[i]]
+00007c30: 5b27 5454 5673 275d 5b70 695d 5b27 7374  ['TTVs'][pi]['st
+00007c40: 6174 7573 275d 203d 2046 616c 7365 0a20  atus'] = False. 
+00007c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007c60: 2020 2064 6963 7469 6f6e 6172 795b 696e     dictionary[in
+00007c70: 616d 6573 5b69 5d5d 5b27 5454 5673 275d  ames[i]]['TTVs']
+00007c80: 5b70 695d 5b27 7061 7261 6d65 7472 697a  [pi]['parametriz
+00007c90: 6174 696f 6e27 5d20 3d20 2764 7427 0a20  ation'] = 'dt'. 
+00007ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007cb0: 2020 2064 6963 7469 6f6e 6172 795b 696e     dictionary[in
+00007cc0: 616d 6573 5b69 5d5d 5b27 5454 5673 275d  ames[i]]['TTVs']
+00007cd0: 5b70 695d 5b27 7472 616e 7369 745f 6e75  [pi]['transit_nu
+00007ce0: 6d62 6572 275d 203d 205b 5d0a 0a20 2020  mber'] = []..   
+00007cf0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00007d00: 2070 7269 2069 6e20 7365 6c66 2e70 7269   pri in self.pri
+00007d10: 6f72 732e 6b65 7973 2829 3a0a 0a20 2020  ors.keys():..   
+00007d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007d30: 2069 6620 7072 695b 303a 325d 203d 3d20   if pri[0:2] == 
+00007d40: 2771 3127 3a0a 0a20 2020 2020 2020 2020  'q1':..         
+00007d50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00007d60: 6620 696e 616d 6573 5b69 5d20 696e 2070  f inames[i] in p
+00007d70: 7269 2e73 706c 6974 2827 5f27 293a 0a0a  ri.split('_'):..
+00007d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007d90: 2020 2020 2020 2020 2020 2020 6469 6374              dict
+00007da0: 696f 6e61 7279 5b69 6e61 6d65 735b 695d  ionary[inames[i]
+00007db0: 5d5b 2754 7261 6e73 6974 4669 7427 5d20  ]['TransitFit'] 
+00007dc0: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
+00007dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007de0: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
+00007df0: 6f73 653a 0a0a 2020 2020 2020 2020 2020  ose:..          
+00007e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007e10: 2020 2020 2020 7072 696e 7428 275c 7420        print('\t 
+00007e20: 5472 616e 7369 7420 6669 7420 6465 7465  Transit fit dete
+00007e30: 6374 6564 2066 6f72 2069 6e73 7472 756d  cted for instrum
+00007e40: 656e 7420 272c 0a20 2020 2020 2020 2020  ent ',.         
+00007e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007e60: 2020 2020 2020 2020 2020 2020 2069 6e61               ina
+00007e70: 6d65 735b 695d 290a 0a20 2020 2020 2020  mes[i])..       
+00007e80: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00007e90: 7072 695b 303a 325d 203d 3d20 2770 3127  pri[0:2] == 'p1'
+00007ea0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
+00007eb0: 2020 2020 2020 2020 2020 2023 2049 6620             # If 
+00007ec0: 4357 2064 6566 696e 6564 206f 6e20 696e  CW defined on in
+00007ed0: 7374 7275 6d65 6e74 2c20 6f72 2c20 7468  strument, or, th
+00007ee0: 6572 6527 7320 6120 7369 6e67 6c65 2043  ere's a single C
+00007ef0: 5720 666f 7220 616c 6c20 696e 7374 7275  W for all instru
+00007f00: 6d65 6e74 733a 0a20 2020 2020 2020 2020  ments:.         
+00007f10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00007f20: 6620 2869 6e61 6d65 735b 695d 2069 6e20  f (inames[i] in 
+00007f30: 7072 692e 7370 6c69 7428 275f 2729 2920  pri.split('_')) 
+00007f40: 6f72 2028 6c65 6e28 7072 692e 7370 6c69  or (len(pri.spli
+00007f50: 7428 275f 2729 2920 3d3d 2032 293a 0a0a  t('_')) == 2):..
+00007f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007f70: 2020 2020 2020 2020 2020 2020 6469 6374              dict
+00007f80: 696f 6e61 7279 5b69 6e61 6d65 735b 695d  ionary[inames[i]
+00007f90: 5d5b 2754 7261 6e73 6974 4669 7427 5d20  ]['TransitFit'] 
+00007fa0: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
+00007fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007fc0: 2020 2064 6963 7469 6f6e 6172 795b 696e     dictionary[in
+00007fd0: 616d 6573 5b69 5d5d 5b27 5472 616e 7369  ames[i]]['Transi
+00007fe0: 7446 6974 4361 7477 6f6d 616e 275d 203d  tFitCatwoman'] =
+00007ff0: 2054 7275 650a 0a20 2020 2020 2020 2020   True..         
+00008000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008010: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+00008020: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
 00008030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008040: 2020 2020 7072 696e 7428 275c 7420 5472      print('\t Tr
-00008050: 616e 7369 7420 2863 6174 776f 6d61 6e29  ansit (catwoman)
-00008060: 2066 6974 2064 6574 6563 7465 6420 666f   fit detected fo
-00008070: 7220 696e 7374 7275 6d65 6e74 2027 2c20  r instrument ', 
-00008080: 696e 616d 6573 5b69 5d29 0a0a 2020 2020  inames[i])..    
-00008090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000080a0: 6966 2070 7269 5b30 3a31 315d 203d 3d20  if pri[0:11] == 
-000080b0: 2770 6861 7365 6f66 6673 6574 273a 0a20  'phaseoffset':. 
-000080c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000080d0: 2020 2020 2020 2023 2049 6620 7068 6173         # If phas
-000080e0: 652d 6f66 6673 6574 2064 6566 696e 6564  e-offset defined
-000080f0: 206f 6e20 696e 7374 7275 6d65 6e74 2c20   on instrument, 
-00008100: 6f72 2c20 7468 6572 6527 7320 6120 7369  or, there's a si
-00008110: 6e67 6c65 206f 6e65 2066 6f72 2061 6c6c  ngle one for all
-00008120: 2069 6e73 7472 756d 656e 7473 3a0a 2020   instruments:.  
-00008130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008140: 2020 2020 2020 6966 2028 696e 616d 6573        if (inames
-00008150: 5b69 5d20 696e 2070 7269 2e73 706c 6974  [i] in pri.split
-00008160: 2827 5f27 2929 206f 7220 286c 656e 2870  ('_')) or (len(p
-00008170: 7269 2e73 706c 6974 2827 5f27 2929 203d  ri.split('_')) =
-00008180: 3d20 3229 3a0a 0a20 2020 2020 2020 2020  = 2):..         
-00008190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000081a0: 2020 2064 6963 7469 6f6e 6172 795b 696e     dictionary[in
-000081b0: 616d 6573 5b69 5d5d 5b27 5068 6173 6543  ames[i]]['PhaseC
-000081c0: 7572 7665 4669 7427 5d20 3d20 5472 7565  urveFit'] = True
-000081d0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000081e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000081f0: 2073 656c 662e 7665 7262 6f73 653a 0a0a   self.verbose:..
-00008200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008220: 7072 696e 7428 275c 7420 5068 6173 6520  print('\t Phase 
-00008230: 6375 7276 6520 6669 7420 6465 7465 6374  curve fit detect
-00008240: 6564 2066 6f72 2069 6e73 7472 756d 656e  ed for instrumen
-00008250: 7420 272c 2069 6e61 6d65 735b 695d 290a  t ', inames[i]).
-00008260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008270: 2020 2020 2069 6620 7072 695b 303a 325d       if pri[0:2]
-00008280: 203d 3d20 2766 7027 3a0a 0a20 2020 2020   == 'fp':..     
-00008290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000082a0: 2020 2023 2049 6620 616e 2065 636c 6970     # If an eclip
-000082b0: 7365 2066 6f72 2069 6e73 7472 756d 656e  se for instrumen
-000082c0: 7420 6f72 2074 6865 7265 2773 2061 2073  t or there's a s
-000082d0: 696e 676c 6520 6465 7074 6820 666f 7220  ingle depth for 
-000082e0: 616c 6c20 696e 7374 7275 6d65 6e74 733a  all instruments:
-000082f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008300: 2020 2020 2020 2020 2069 6620 2869 6e61           if (ina
-00008310: 6d65 735b 695d 2069 6e20 7072 692e 7370  mes[i] in pri.sp
-00008320: 6c69 7428 275f 2729 2920 6f72 2028 6c65  lit('_')) or (le
-00008330: 6e28 7072 692e 7370 6c69 7428 275f 2729  n(pri.split('_')
-00008340: 2920 3d3d 2032 293a 0a0a 2020 2020 2020  ) == 2):..      
-00008350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008360: 2020 2020 2020 6469 6374 696f 6e61 7279        dictionary
-00008370: 5b69 6e61 6d65 735b 695d 5d5b 2745 636c  [inames[i]]['Ecl
-00008380: 6970 7365 4669 7427 5d20 3d20 5472 7565  ipseFit'] = True
-00008390: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000083a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000083b0: 2073 656c 662e 7665 7262 6f73 653a 0a20   self.verbose:. 
-000083c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000083d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000083e0: 7269 6e74 2827 5c74 2045 636c 6970 7365  rint('\t Eclipse
-000083f0: 2066 6974 2064 6574 6563 7465 6420 666f   fit detected fo
-00008400: 7220 696e 7374 7275 6d65 6e74 2027 2c69  r instrument ',i
-00008410: 6e61 6d65 735b 695d 290a 0a20 2020 2020  names[i])..     
-00008420: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00008430: 6620 7072 695b 303a 325d 203d 3d20 2764  f pri[0:2] == 'd
-00008440: 7427 206f 7220 7072 695b 303a 325d 203d  t' or pri[0:2] =
-00008450: 3d20 2754 5f27 3a0a 2020 2020 2020 2020  = 'T_':.        
-00008460: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
-00008470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008480: 2020 2020 2020 2070 6c61 6e65 745f 6e75         planet_nu
-00008490: 6d62 6572 2c20 696e 7374 7275 6d65 6e74  mber, instrument
-000084a0: 2c20 6e74 7261 6e73 6974 203d 2070 7269  , ntransit = pri
-000084b0: 2e73 706c 6974 2827 5f27 295b 313a 5d0a  .split('_')[1:].
-000084c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000084d0: 2020 2020 2020 2020 2069 6620 696e 616d           if inam
-000084e0: 6573 5b69 5d20 3d3d 2069 6e73 7472 756d  es[i] == instrum
-000084f0: 656e 743a 0a20 2020 2020 2020 2020 2020  ent:.           
-00008500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008510: 2069 6620 7072 695b 303a 325d 203d 3d20   if pri[0:2] == 
-00008520: 2754 5f27 3a0a 2020 2020 2020 2020 2020  'T_':.          
-00008530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008540: 2020 2020 2020 6469 6374 696f 6e61 7279        dictionary
-00008550: 5b69 6e61 6d65 735b 695d 5d5b 2754 5456  [inames[i]]['TTV
-00008560: 7327 5d5b 696e 7428 0a20 2020 2020 2020  s'][int(.       
-00008570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008580: 2020 2020 2020 2020 2020 2020 2070 6c61               pla
-00008590: 6e65 745f 6e75 6d62 6572 5b31 3a5d 295d  net_number[1:])]
-000085a0: 5b27 7061 7261 6d65 7472 697a 6174 696f  ['parametrizatio
-000085b0: 6e27 5d20 3d20 2754 270a 0a20 2020 2020  n'] = 'T'..     
-000085c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000085d0: 2020 2020 2020 2064 6963 7469 6f6e 6172         dictionar
-000085e0: 795b 696e 616d 6573 5b69 5d5d 5b27 5454  y[inames[i]]['TT
-000085f0: 5673 275d 5b69 6e74 280a 2020 2020 2020  Vs'][int(.      
-00008600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008610: 2020 2020 2020 2020 2020 706c 616e 6574            planet
-00008620: 5f6e 756d 6265 725b 313a 5d29 5d5b 2773  _number[1:])]['s
-00008630: 7461 7475 7327 5d20 3d20 5472 7565 0a20  tatus'] = True. 
-00008640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008650: 2020 2020 2020 2020 2020 2064 6963 7469             dicti
-00008660: 6f6e 6172 795b 696e 616d 6573 5b69 5d5d  onary[inames[i]]
-00008670: 5b27 5454 5673 275d 5b69 6e74 280a 2020  ['TTVs'][int(.  
-00008680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008690: 2020 2020 2020 2020 2020 2020 2020 706c                pl
-000086a0: 616e 6574 5f6e 756d 6265 725b 313a 5d29  anet_number[1:])
-000086b0: 5d5b 2774 7261 6e73 6974 5f6e 756d 6265  ]['transit_numbe
-000086c0: 7227 5d2e 6170 7065 6e64 280a 2020 2020  r'].append(.    
-000086d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000086e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000086f0: 696e 7428 6e74 7261 6e73 6974 2929 0a0a  int(ntransit))..
-00008700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008710: 6966 2064 6963 7469 6f6e 6172 795b 696e  if dictionary[in
-00008720: 616d 6573 5b69 5d5d 5b27 5472 616e 7369  ames[i]]['Transi
-00008730: 7446 6974 275d 2061 6e64 2064 6963 7469  tFit'] and dicti
-00008740: 6f6e 6172 795b 696e 616d 6573 5b69 5d5d  onary[inames[i]]
-00008750: 5b27 4563 6c69 7073 6546 6974 275d 3a0a  ['EclipseFit']:.
-00008760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008770: 2020 2020 2064 6963 7469 6f6e 6172 795b       dictionary[
-00008780: 696e 616d 6573 5b69 5d5d 5b27 5472 616e  inames[i]]['Tran
-00008790: 4563 6c46 6974 275d 203d 2054 7275 650a  EclFit'] = True.
-000087a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000087b0: 2020 2020 6469 6374 696f 6e61 7279 5b69      dictionary[i
-000087c0: 6e61 6d65 735b 695d 5d5b 2754 7261 6e73  names[i]]['Trans
-000087d0: 6974 4669 7427 5d20 3d20 4661 6c73 650a  itFit'] = False.
-000087e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000087f0: 2020 2020 6469 6374 696f 6e61 7279 5b69      dictionary[i
-00008800: 6e61 6d65 735b 695d 5d5b 2745 636c 6970  names[i]]['Eclip
-00008810: 7365 4669 7427 5d20 3d20 4661 6c73 650a  seFit'] = False.
-00008820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008830: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
-00008840: 626f 7365 3a0a 0a20 2020 2020 2020 2020  bose:..         
-00008850: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00008860: 7269 6e74 2827 5c74 204a 6f69 6e74 2054  rint('\t Joint T
-00008870: 7261 6e73 6974 2061 6e64 2045 636c 6970  ransit and Eclip
-00008880: 7365 2066 6974 2064 6574 6563 7465 6420  se fit detected 
-00008890: 666f 7220 696e 7374 7275 6d65 6e74 2027  for instrument '
-000088a0: 2c69 6e61 6d65 735b 695d 290a 0a20 2020  ,inames[i])..   
-000088b0: 2020 2020 2020 2020 2066 6f72 2070 6920           for pi 
-000088c0: 696e 206e 756d 6265 7269 6e67 5f70 6c61  in numbering_pla
-000088d0: 6e65 7473 3a0a 2020 2020 2020 2020 2020  nets:.          
-000088e0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-000088f0: 616e 6765 286e 696e 7374 7275 6d65 6e74  ange(ninstrument
-00008900: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00008910: 2020 2020 2020 2020 6966 2064 6963 7469          if dicti
-00008920: 6f6e 6172 795b 696e 616d 6573 5b69 5d5d  onary[inames[i]]
-00008930: 5b27 5454 5673 275d 5b70 695d 5b27 7374  ['TTVs'][pi]['st
-00008940: 6174 7573 275d 3a0a 0a20 2020 2020 2020  atus']:..       
-00008950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008960: 2064 6963 7469 6f6e 6172 795b 0a20 2020   dictionary[.   
-00008970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008980: 2020 2020 2020 2020 2069 6e61 6d65 735b           inames[
-00008990: 695d 5d5b 2754 5456 7327 5d5b 7069 5d5b  i]]['TTVs'][pi][
-000089a0: 2774 6f74 616c 5454 5674 7261 6e73 6974  'totalTTVtransit
-000089b0: 7327 5d20 3d20 6c65 6e28 0a20 2020 2020  s'] = len(.     
-000089c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000089d0: 2020 2020 2020 2020 2020 2064 6963 7469             dicti
-000089e0: 6f6e 6172 795b 0a20 2020 2020 2020 2020  onary[.         
-000089f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a00: 2020 2020 2020 2020 2020 2069 6e61 6d65             iname
-00008a10: 735b 695d 5d5b 2754 5456 7327 5d5b 7069  s[i]]['TTVs'][pi
-00008a20: 5d5b 2774 7261 6e73 6974 5f6e 756d 6265  ]['transit_numbe
-00008a30: 7227 5d29 0a0a 2020 2020 2020 2020 2320  r'])..        # 
-00008a40: 4e6f 772c 2069 6d70 6c65 6d65 6e74 206e  Now, implement n
-00008a50: 6f69 7365 206d 6f64 656c 7320 666f 7220  oise models for 
-00008a60: 6561 6368 206f 6620 7468 6520 696e 7374  each of the inst
-00008a70: 7275 6d65 6e74 2e20 4669 7273 7420 6368  rument. First ch
-00008a80: 6563 6b20 6966 206d 6f64 656c 2073 686f  eck if model sho
-00008a90: 756c 6420 6265 2067 6c6f 6261 6c20 6f72  uld be global or
-00008aa0: 2069 6e73 7472 756d 656e 742d 6279 2d69   instrument-by-i
-00008ab0: 6e73 7472 756d 656e 742c 0a20 2020 2020  nstrument,.     
-00008ac0: 2020 2023 2062 6173 6564 206f 6e20 7468     # based on th
-00008ad0: 6520 696e 7075 7420 696e 7374 7275 6d65  e input instrume
-00008ae0: 6e74 7320 6769 7665 6e20 666f 7220 7468  nts given for th
-00008af0: 6520 4750 2072 6567 7265 7373 6f72 732e  e GP regressors.
-00008b00: 0a20 2020 2020 2020 2069 6620 676c 6f62  .        if glob
-00008b10: 616c 5f6d 6f64 656c 3a0a 2020 2020 2020  al_model:.      
-00008b20: 2020 2020 2020 6469 6374 696f 6e61 7279        dictionary
-00008b30: 5b27 676c 6f62 616c 5f6d 6f64 656c 275d  ['global_model']
-00008b40: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
-00008b50: 2020 6966 2047 505f 7265 6772 6573 736f    if GP_regresso
-00008b60: 7273 2069 7320 6e6f 7420 4e6f 6e65 3a0a  rs is not None:.
-00008b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008b80: 6469 6374 696f 6e61 7279 5b27 676c 6f62  dictionary['glob
-00008b90: 616c 5f6d 6f64 656c 275d 5b27 4750 4465  al_model']['GPDe
-00008ba0: 7472 656e 6427 5d20 3d20 5472 7565 0a20  trend'] = True. 
-00008bb0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00008bc0: 6963 7469 6f6e 6172 795b 2767 6c6f 6261  ictionary['globa
-00008bd0: 6c5f 6d6f 6465 6c27 5d5b 276e 6f69 7365  l_model']['noise
-00008be0: 5f6d 6f64 656c 275d 203d 2067 6175 7373  _model'] = gauss
-00008bf0: 6961 6e5f 7072 6f63 6573 7328 0a20 2020  ian_process(.   
-00008c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c10: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-00008c20: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00008c30: 5f74 7970 653d 6469 6374 7970 652c 0a20  _type=dictype,. 
-00008c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c50: 2020 2069 6e73 7472 756d 656e 743d 6469     instrument=di
-00008c60: 6374 7970 652c 0a20 2020 2020 2020 2020  ctype,.         
-00008c70: 2020 2020 2020 2020 2020 206d 6174 6572             mater
-00008c80: 6e5f 6570 733d 7365 6c66 2e6d 6174 6572  n_eps=self.mater
-00008c90: 6e5f 6570 732c 200a 2020 2020 2020 2020  n_eps, .        
-00008ca0: 2020 2020 2020 2020 2020 2020 6765 6f72              geor
-00008cb0: 6765 5f68 6f64 6c72 3d73 656c 662e 6765  ge_hodlr=self.ge
-00008cc0: 6f72 6765 5f68 6f64 6c72 290a 2020 2020  orge_hodlr).    
-00008cd0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00008ce0: 6f74 2064 6963 7469 6f6e 6172 795b 2767  ot dictionary['g
-00008cf0: 6c6f 6261 6c5f 6d6f 6465 6c27 5d5b 276e  lobal_model']['n
-00008d00: 6f69 7365 5f6d 6f64 656c 275d 2e69 7349  oise_model'].isI
-00008d10: 6e69 743a 0a20 2020 2020 2020 2020 2020  nit:.           
-00008d20: 2020 2020 2020 2020 2023 2049 6620 6e6f           # If no
-00008d30: 7420 696e 6974 6961 7465 642c 206d 6f73  t initiated, mos
-00008d40: 7420 6c69 6b65 6c79 206b 6572 6e65 6c20  t likely kernel 
-00008d50: 6973 2061 2063 656c 6572 6974 6520 6f6e  is a celerite on
-00008d60: 652e 2052 656f 7264 6572 2074 696d 6573  e. Reorder times
-00008d70: 2c20 7661 6c75 6573 2c20 6574 632e 2054  , values, etc. T
-00008d80: 6869 7320 6973 204f 4b20 2d2d 2d20 6973  his is OK --- is
-00008d90: 2065 7870 6563 7465 643a 0a20 2020 2020   expected:.     
-00008da0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00008db0: 6620 6469 6374 7970 6520 3d3d 2027 6c63  f dictype == 'lc
-00008dc0: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-00008dd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00008de0: 736f 7274 5f47 5028 276c 6327 290a 2020  sort_GP('lc').  
-00008df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008e00: 2020 656c 6966 2064 6963 7479 7065 203d    elif dictype =
-00008e10: 3d20 2772 7627 3a0a 2020 2020 2020 2020  = 'rv':.        
-00008e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008e30: 7365 6c66 2e73 6f72 745f 4750 2827 7276  self.sort_GP('rv
-00008e40: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
-00008e50: 2020 2020 2020 2023 2054 7279 2061 6761         # Try aga
-00008e60: 696e 3a0a 2020 2020 2020 2020 2020 2020  in:.            
-00008e70: 2020 2020 2020 2020 6469 6374 696f 6e61          dictiona
-00008e80: 7279 5b27 676c 6f62 616c 5f6d 6f64 656c  ry['global_model
-00008e90: 275d 5b0a 2020 2020 2020 2020 2020 2020  '][.            
-00008ea0: 2020 2020 2020 2020 2020 2020 276e 6f69              'noi
-00008eb0: 7365 5f6d 6f64 656c 275d 203d 2067 6175  se_model'] = gau
-00008ec0: 7373 6961 6e5f 7072 6f63 6573 7328 0a20  ssian_process(. 
-00008ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008ee0: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-00008ef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008f00: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-00008f10: 656c 5f74 7970 653d 6469 6374 7970 652c  el_type=dictype,
-00008f20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008f30: 2020 2020 2020 2020 2020 2020 2069 6e73               ins
-00008f40: 7472 756d 656e 743d 6469 6374 7970 652c  trument=dictype,
-00008f50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008f60: 2020 2020 2020 2020 2020 2020 206d 6174               mat
-00008f70: 6572 6e5f 6570 733d 7365 6c66 2e6d 6174  ern_eps=self.mat
-00008f80: 6572 6e5f 6570 732c 0a20 2020 2020 2020  ern_eps,.       
-00008f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008fa0: 2020 2020 2067 656f 7267 655f 686f 646c       george_hodl
-00008fb0: 723d 7365 6c66 2e67 656f 7267 655f 686f  r=self.george_ho
-00008fc0: 646c 7229 0a20 2020 2020 2020 2020 2020  dlr).           
-00008fd0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-00008fe0: 6469 6374 696f 6e61 7279 5b27 676c 6f62  dictionary['glob
-00008ff0: 616c 5f6d 6f64 656c 275d 5b27 6e6f 6973  al_model']['nois
-00009000: 655f 6d6f 6465 6c27 5d2e 6973 496e 6974  e_model'].isInit
-00009010: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00009020: 2020 2020 2020 2020 2020 2320 4368 6563            # Chec
-00009030: 6b2c 2062 6c61 6d65 2074 6865 2075 7365  k, blame the use
-00009040: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
-00009050: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00009060: 2045 7863 6570 7469 6f6e 280a 2020 2020   Exception(.    
-00009070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009080: 2020 2020 2020 2020 2749 4e50 5554 2045          'INPUT E
-00009090: 5252 4f52 3a20 4750 2069 6e69 7469 616c  RROR: GP initial
-000090a0: 697a 6174 696f 6e20 666f 7220 6f62 6a65  ization for obje
-000090b0: 6374 2066 6f72 2027 202b 0a20 2020 2020  ct for ' +.     
-000090c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000090d0: 2020 2020 2020 2064 6963 7479 7065 202b         dictype +
-000090e0: 2027 2067 6c6f 6261 6c20 6b65 726e 656c   ' global kernel
-000090f0: 2066 6169 6c65 642e 2729 0a20 2020 2020   failed.').     
-00009100: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00009110: 2020 2020 2020 2020 2020 2020 2064 6963               dic
-00009120: 7469 6f6e 6172 795b 2767 6c6f 6261 6c5f  tionary['global_
-00009130: 6d6f 6465 6c27 5d5b 2747 5044 6574 7265  model']['GPDetre
-00009140: 6e64 275d 203d 2046 616c 7365 0a20 2020  nd'] = False.   
-00009150: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00009160: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00009170: 7261 6e67 6528 6e69 6e73 7472 756d 656e  range(ninstrumen
-00009180: 7473 293a 0a20 2020 2020 2020 2020 2020  ts):.           
-00009190: 2020 2020 2069 6e73 7472 756d 656e 7420       instrument 
-000091a0: 3d20 696e 616d 6573 5b69 5d0a 0a20 2020  = inames[i]..   
-000091b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000091c0: 2847 505f 7265 6772 6573 736f 7273 2069  (GP_regressors i
-000091d0: 7320 6e6f 7420 4e6f 6e65 2920 616e 6420  s not None) and 
-000091e0: 2869 6e73 7472 756d 656e 7420 696e 2047  (instrument in G
-000091f0: 505f 7265 6772 6573 736f 7273 2e6b 6579  P_regressors.key
-00009200: 7328 2929 3a0a 0a20 2020 2020 2020 2020  s()):..         
-00009210: 2020 2020 2020 2020 2020 2064 6963 7469             dicti
-00009220: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
-00009230: 5d5b 2747 5044 6574 7265 6e64 275d 203d  ]['GPDetrend'] =
-00009240: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-00009250: 2020 2020 2020 2020 2020 6469 6374 696f            dictio
-00009260: 6e61 7279 5b69 6e73 7472 756d 656e 745d  nary[instrument]
-00009270: 5b27 6e6f 6973 655f 6d6f 6465 6c27 5d20  ['noise_model'] 
-00009280: 3d20 6761 7573 7369 616e 5f70 726f 6365  = gaussian_proce
-00009290: 7373 280a 2020 2020 2020 2020 2020 2020  ss(.            
-000092a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000092b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000092c0: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-000092d0: 7479 7065 3d64 6963 7479 7065 2c0a 2020  type=dictype,.  
-000092e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000092f0: 2020 2020 2020 696e 7374 7275 6d65 6e74        instrument
-00009300: 3d69 6e73 7472 756d 656e 742c 0a20 2020  =instrument,.   
-00009310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009320: 2020 2020 206d 6174 6572 6e5f 6570 733d       matern_eps=
-00009330: 7365 6c66 2e6d 6174 6572 6e5f 6570 732c  self.matern_eps,
-00009340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009350: 2020 2020 2020 2020 2067 656f 7267 655f           george_
-00009360: 686f 646c 723d 7365 6c66 2e67 656f 7267  hodlr=self.georg
-00009370: 655f 686f 646c 7229 0a20 2020 2020 2020  e_hodlr).       
-00009380: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00009390: 6e6f 7420 6469 6374 696f 6e61 7279 5b69  not dictionary[i
-000093a0: 6e73 7472 756d 656e 745d 5b27 6e6f 6973  nstrument]['nois
-000093b0: 655f 6d6f 6465 6c27 5d2e 6973 496e 6974  e_model'].isInit
-000093c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000093d0: 2020 2020 2020 2020 2020 2320 426c 616d            # Blam
-000093e0: 6520 7468 6520 7573 6572 2c20 616c 7468  e the user, alth
-000093f0: 6f75 6768 2070 6572 6861 7073 2077 6520  ough perhaps we 
-00009400: 636f 756c 6420 7369 6d70 6c79 2073 6f6c  could simply sol
-00009410: 7665 2074 6869 7320 6173 2066 6f72 2074  ve this as for t
-00009420: 6865 2067 6c6f 6261 6c20 6d6f 6465 6c6c  he global modell
-00009430: 696e 673f 3a0a 2020 2020 2020 2020 2020  ing?:.          
-00009440: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00009450: 6973 6520 4578 6365 7074 696f 6e28 0a20  ise Exception(. 
-00009460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009470: 2020 2020 2020 2020 2020 2027 494e 5055             'INPU
-00009480: 5420 4552 524f 523a 2047 5020 7265 6772  T ERROR: GP regr
-00009490: 6573 736f 7273 2066 6f72 2069 6e73 7472  essors for instr
-000094a0: 756d 656e 7420 2720 2b0a 2020 2020 2020  ument ' +.      
-000094b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000094c0: 2020 2020 2020 696e 7374 7275 6d65 6e74        instrument
-000094d0: 202b 0a20 2020 2020 2020 2020 2020 2020   +.             
-000094e0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-000094f0: 2075 7365 2063 656c 6572 6974 652c 2061   use celerite, a
-00009500: 6e64 2061 7265 206e 6f74 2069 6e20 6173  nd are not in as
-00009510: 6365 6e64 696e 6720 6f72 2064 6573 6365  cending or desce
-00009520: 6e64 696e 6720 6f72 6465 722e 2050 6c65  nding order. Ple
-00009530: 6173 652c 2067 6976 6520 7468 6520 696e  ase, give the in
-00009540: 7075 7420 696e 2074 686f 7365 206f 7264  put in those ord
-00009550: 6572 7320 2d2d 2d20 6974 2077 696c 6c20  ers --- it will 
-00009560: 6e6f 7420 776f 726b 206f 7468 6572 7369  not work othersi
-00009570: 652e 270a 2020 2020 2020 2020 2020 2020  e.'.            
-00009580: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00009590: 2020 2020 2020 2023 2043 6865 636b 2077         # Check w
-000095a0: 6869 6368 2065 6363 656e 7472 6963 6974  hich eccentricit
-000095b0: 7920 7061 7261 6d65 7472 697a 6174 696f  y parametrizatio
-000095c0: 6e20 6973 2067 6f69 6e67 2074 6f20 6265  n is going to be
-000095d0: 2075 7365 6420 666f 7220 6561 6368 2070   used for each p
-000095e0: 6c61 6e65 7420 696e 2074 6865 206a 756c  lanet in the jul
-000095f0: 6965 7420 6e75 6d62 6572 696e 6720 7363  iet numbering sc
-00009600: 6865 6d65 2e0a 2020 2020 2020 2020 2320  heme..        # 
-00009610: 3020 3d20 6563 632c 206f 6d65 6761 2020  0 = ecc, omega  
-00009620: 313a 2065 636f 736f 6d65 6761 2c65 7369  1: ecosomega,esi
-00009630: 6e6f 6d65 6761 2020 323a 2073 7172 7428  nomega  2: sqrt(
-00009640: 6529 636f 736f 6d65 6761 2c20 7371 7274  e)cosomega, sqrt
-00009650: 2865 2973 696e 6f6d 6567 610a 2020 2020  (e)sinomega.    
-00009660: 2020 2020 6469 6374 696f 6e61 7279 5b27      dictionary['
-00009670: 6563 635f 7061 7261 6d65 7472 697a 6174  ecc_parametrizat
-00009680: 696f 6e27 5d20 3d20 7b7d 0a20 2020 2020  ion'] = {}.     
-00009690: 2020 2069 6620 6469 6374 7970 6520 3d3d     if dictype ==
-000096a0: 2027 6c63 273a 0a20 2020 2020 2020 2020   'lc':.         
-000096b0: 2020 2064 6963 7469 6f6e 6172 795b 2765     dictionary['e
-000096c0: 6666 6963 6965 6e74 5f62 7027 5d20 3d20  fficient_bp'] = 
-000096d0: 7b7d 0a20 2020 2020 2020 2066 6f72 2069  {}.        for i
-000096e0: 2069 6e20 6e75 6d62 6572 696e 675f 706c   in numbering_pl
-000096f0: 616e 6574 733a 0a20 2020 2020 2020 2020  anets:.         
-00009700: 2020 2069 6620 2765 636f 736f 6d65 6761     if 'ecosomega
-00009710: 5f70 2720 2b20 7374 7228 6929 2069 6e20  _p' + str(i) in 
-00009720: 7365 6c66 2e70 7269 6f72 732e 6b65 7973  self.priors.keys
-00009730: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00009740: 2020 2020 6469 6374 696f 6e61 7279 5b27      dictionary['
-00009750: 6563 635f 7061 7261 6d65 7472 697a 6174  ecc_parametrizat
-00009760: 696f 6e27 5d5b 695d 203d 2031 0a20 2020  ion'][i] = 1.   
-00009770: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00009780: 7365 6c66 2e76 6572 626f 7365 3a0a 2020  self.verbose:.  
-00009790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000097a0: 2020 7072 696e 7428 0a20 2020 2020 2020    print(.       
-000097b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000097c0: 2027 5c74 203e 3e20 6563 6f73 6f6d 6567   '\t >> ecosomeg
-000097d0: 612c 6573 696e 6f6d 6567 6120 7061 7261  a,esinomega para
-000097e0: 6d65 7472 697a 6174 696f 6e20 6465 7465  metrization dete
-000097f0: 6374 6564 2066 6f72 2027 0a20 2020 2020  cted for '.     
-00009800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009810: 2020 202b 2064 6963 7479 7065 202b 2027     + dictype + '
-00009820: 2070 6c61 6e65 7420 7027 202b 2073 7472   planet p' + str
-00009830: 2869 2929 0a20 2020 2020 2020 2020 2020  (i)).           
-00009840: 2065 6c69 6620 2773 6563 6f73 6f6d 6567   elif 'secosomeg
-00009850: 615f 7027 202b 2073 7472 2869 2920 696e  a_p' + str(i) in
-00009860: 2073 656c 662e 7072 696f 7273 2e6b 6579   self.priors.key
-00009870: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-00009880: 2020 2020 2064 6963 7469 6f6e 6172 795b       dictionary[
-00009890: 2765 6363 5f70 6172 616d 6574 7269 7a61  'ecc_parametriza
-000098a0: 7469 6f6e 275d 5b69 5d20 3d20 320a 2020  tion'][i] = 2.  
-000098b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000098c0: 2073 656c 662e 7665 7262 6f73 653a 0a20   self.verbose:. 
-000098d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000098e0: 2020 2070 7269 6e74 280a 2020 2020 2020     print(.      
+00008040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008060: 2070 7269 6e74 2827 5c74 2054 7261 6e73   print('\t Trans
+00008070: 6974 2028 6361 7477 6f6d 616e 2920 6669  it (catwoman) fi
+00008080: 7420 6465 7465 6374 6564 2066 6f72 2069  t detected for i
+00008090: 6e73 7472 756d 656e 7420 272c 2069 6e61  nstrument ', ina
+000080a0: 6d65 735b 695d 290a 0a20 2020 2020 2020  mes[i])..       
+000080b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000080c0: 7072 695b 303a 3131 5d20 3d3d 2027 7068  pri[0:11] == 'ph
+000080d0: 6173 656f 6666 7365 7427 3a0a 2020 2020  aseoffset':.    
+000080e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000080f0: 2020 2020 2320 4966 2070 6861 7365 2d6f      # If phase-o
+00008100: 6666 7365 7420 6465 6669 6e65 6420 6f6e  ffset defined on
+00008110: 2069 6e73 7472 756d 656e 742c 206f 722c   instrument, or,
+00008120: 2074 6865 7265 2773 2061 2073 696e 676c   there's a singl
+00008130: 6520 6f6e 6520 666f 7220 616c 6c20 696e  e one for all in
+00008140: 7374 7275 6d65 6e74 733a 0a20 2020 2020  struments:.     
+00008150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008160: 2020 2069 6620 2869 6e61 6d65 735b 695d     if (inames[i]
+00008170: 2069 6e20 7072 692e 7370 6c69 7428 275f   in pri.split('_
+00008180: 2729 2920 6f72 2028 6c65 6e28 7072 692e  ')) or (len(pri.
+00008190: 7370 6c69 7428 275f 2729 2920 3d3d 2032  split('_')) == 2
+000081a0: 293a 0a0a 2020 2020 2020 2020 2020 2020  ):..            
+000081b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000081c0: 6469 6374 696f 6e61 7279 5b69 6e61 6d65  dictionary[iname
+000081d0: 735b 695d 5d5b 2750 6861 7365 4375 7276  s[i]]['PhaseCurv
+000081e0: 6546 6974 275d 203d 2054 7275 650a 0a20  eFit'] = True.. 
+000081f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008200: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00008210: 6c66 2e76 6572 626f 7365 3a0a 0a20 2020  lf.verbose:..   
+00008220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008230: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+00008240: 6e74 2827 5c74 2050 6861 7365 2063 7572  nt('\t Phase cur
+00008250: 7665 2066 6974 2064 6574 6563 7465 6420  ve fit detected 
+00008260: 666f 7220 696e 7374 7275 6d65 6e74 2027  for instrument '
+00008270: 2c20 696e 616d 6573 5b69 5d29 0a0a 2020  , inames[i])..  
+00008280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008290: 2020 6966 2070 7269 5b30 3a32 5d20 3d3d    if pri[0:2] ==
+000082a0: 2027 6670 273a 0a0a 2020 2020 2020 2020   'fp':..        
+000082b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000082c0: 2320 4966 2061 6e20 6563 6c69 7073 6520  # If an eclipse 
+000082d0: 666f 7220 696e 7374 7275 6d65 6e74 206f  for instrument o
+000082e0: 7220 7468 6572 6527 7320 6120 7369 6e67  r there's a sing
+000082f0: 6c65 2064 6570 7468 2066 6f72 2061 6c6c  le depth for all
+00008300: 2069 6e73 7472 756d 656e 7473 3a0a 2020   instruments:.  
+00008310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008320: 2020 2020 2020 6966 2028 696e 616d 6573        if (inames
+00008330: 5b69 5d20 696e 2070 7269 2e73 706c 6974  [i] in pri.split
+00008340: 2827 5f27 2929 206f 7220 286c 656e 2870  ('_')) or (len(p
+00008350: 7269 2e73 706c 6974 2827 5f27 2929 203d  ri.split('_')) =
+00008360: 3d20 3229 3a0a 0a20 2020 2020 2020 2020  = 2):..         
+00008370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008380: 2020 2064 6963 7469 6f6e 6172 795b 696e     dictionary[in
+00008390: 616d 6573 5b69 5d5d 5b27 4563 6c69 7073  ames[i]]['Eclips
+000083a0: 6546 6974 275d 203d 2054 7275 650a 0a20  eFit'] = True.. 
+000083b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000083c0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+000083d0: 6c66 2e76 6572 626f 7365 3a0a 2020 2020  lf.verbose:.    
+000083e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000083f0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00008400: 7428 275c 7420 4563 6c69 7073 6520 6669  t('\t Eclipse fi
+00008410: 7420 6465 7465 6374 6564 2066 6f72 2069  t detected for i
+00008420: 6e73 7472 756d 656e 7420 272c 696e 616d  nstrument ',inam
+00008430: 6573 5b69 5d29 0a0a 2020 2020 2020 2020  es[i])..        
+00008440: 2020 2020 2020 2020 2020 2020 6966 2070              if p
+00008450: 7269 5b30 3a32 5d20 3d3d 2027 6474 2720  ri[0:2] == 'dt' 
+00008460: 6f72 2070 7269 5b30 3a32 5d20 3d3d 2027  or pri[0:2] == '
+00008470: 545f 273a 0a20 2020 2020 2020 2020 2020  T_':.           
+00008480: 2020 2020 2020 2020 2020 200a 2020 2020             .    
+00008490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000084a0: 2020 2020 706c 616e 6574 5f6e 756d 6265      planet_numbe
+000084b0: 722c 2069 6e73 7472 756d 656e 742c 206e  r, instrument, n
+000084c0: 7472 616e 7369 7420 3d20 7072 692e 7370  transit = pri.sp
+000084d0: 6c69 7428 275f 2729 5b31 3a5d 0a0a 2020  lit('_')[1:]..  
+000084e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000084f0: 2020 2020 2020 6966 2069 6e61 6d65 735b        if inames[
+00008500: 695d 203d 3d20 696e 7374 7275 6d65 6e74  i] == instrument
+00008510: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00008520: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00008530: 2070 7269 5b30 3a32 5d20 3d3d 2027 545f   pri[0:2] == 'T_
+00008540: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
+00008550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008560: 2020 2064 6963 7469 6f6e 6172 795b 696e     dictionary[in
+00008570: 616d 6573 5b69 5d5d 5b27 5454 5673 275d  ames[i]]['TTVs']
+00008580: 5b69 6e74 280a 2020 2020 2020 2020 2020  [int(.          
+00008590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000085a0: 2020 2020 2020 2020 2020 706c 616e 6574            planet
+000085b0: 5f6e 756d 6265 725b 313a 5d29 5d5b 2770  _number[1:])]['p
+000085c0: 6172 616d 6574 7269 7a61 7469 6f6e 275d  arametrization']
+000085d0: 203d 2027 5427 0a0a 2020 2020 2020 2020   = 'T'..        
+000085e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000085f0: 2020 2020 6469 6374 696f 6e61 7279 5b69      dictionary[i
+00008600: 6e61 6d65 735b 695d 5d5b 2754 5456 7327  names[i]]['TTVs'
+00008610: 5d5b 696e 7428 0a20 2020 2020 2020 2020  ][int(.         
+00008620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008630: 2020 2020 2020 2070 6c61 6e65 745f 6e75         planet_nu
+00008640: 6d62 6572 5b31 3a5d 295d 5b27 7374 6174  mber[1:])]['stat
+00008650: 7573 275d 203d 2054 7275 650a 2020 2020  us'] = True.    
+00008660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008670: 2020 2020 2020 2020 6469 6374 696f 6e61          dictiona
+00008680: 7279 5b69 6e61 6d65 735b 695d 5d5b 2754  ry[inames[i]]['T
+00008690: 5456 7327 5d5b 696e 7428 0a20 2020 2020  TVs'][int(.     
+000086a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000086b0: 2020 2020 2020 2020 2020 2070 6c61 6e65             plane
+000086c0: 745f 6e75 6d62 6572 5b31 3a5d 295d 5b27  t_number[1:])]['
+000086d0: 7472 616e 7369 745f 6e75 6d62 6572 275d  transit_number']
+000086e0: 2e61 7070 656e 6428 0a20 2020 2020 2020  .append(.       
+000086f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008700: 2020 2020 2020 2020 2020 2020 2069 6e74               int
+00008710: 286e 7472 616e 7369 7429 290a 0a20 2020  (ntransit))..   
+00008720: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00008730: 6469 6374 696f 6e61 7279 5b69 6e61 6d65  dictionary[iname
+00008740: 735b 695d 5d5b 2754 7261 6e73 6974 4669  s[i]]['TransitFi
+00008750: 7427 5d20 616e 6420 6469 6374 696f 6e61  t'] and dictiona
+00008760: 7279 5b69 6e61 6d65 735b 695d 5d5b 2745  ry[inames[i]]['E
+00008770: 636c 6970 7365 4669 7427 5d3a 0a0a 2020  clipseFit']:..  
+00008780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008790: 2020 6469 6374 696f 6e61 7279 5b69 6e61    dictionary[ina
+000087a0: 6d65 735b 695d 5d5b 2754 7261 6e45 636c  mes[i]]['TranEcl
+000087b0: 4669 7427 5d20 3d20 5472 7565 0a20 2020  Fit'] = True.   
+000087c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000087d0: 2064 6963 7469 6f6e 6172 795b 696e 616d   dictionary[inam
+000087e0: 6573 5b69 5d5d 5b27 5472 616e 7369 7446  es[i]]['TransitF
+000087f0: 6974 275d 203d 2046 616c 7365 0a20 2020  it'] = False.   
+00008800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008810: 2064 6963 7469 6f6e 6172 795b 696e 616d   dictionary[inam
+00008820: 6573 5b69 5d5d 5b27 4563 6c69 7073 6546  es[i]]['EclipseF
+00008830: 6974 275d 203d 2046 616c 7365 0a0a 2020  it'] = False..  
+00008840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008850: 2020 6966 2073 656c 662e 7665 7262 6f73    if self.verbos
+00008860: 653a 0a0a 2020 2020 2020 2020 2020 2020  e:..            
+00008870: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00008880: 7428 275c 7420 4a6f 696e 7420 5472 616e  t('\t Joint Tran
+00008890: 7369 7420 616e 6420 4563 6c69 7073 6520  sit and Eclipse 
+000088a0: 6669 7420 6465 7465 6374 6564 2066 6f72  fit detected for
+000088b0: 2069 6e73 7472 756d 656e 7420 272c 696e   instrument ',in
+000088c0: 616d 6573 5b69 5d29 0a0a 2020 2020 2020  ames[i])..      
+000088d0: 2020 2020 2020 666f 7220 7069 2069 6e20        for pi in 
+000088e0: 6e75 6d62 6572 696e 675f 706c 616e 6574  numbering_planet
+000088f0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00008900: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00008910: 6528 6e69 6e73 7472 756d 656e 7473 293a  e(ninstruments):
+00008920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008930: 2020 2020 2069 6620 6469 6374 696f 6e61       if dictiona
+00008940: 7279 5b69 6e61 6d65 735b 695d 5d5b 2754  ry[inames[i]]['T
+00008950: 5456 7327 5d5b 7069 5d5b 2773 7461 7475  TVs'][pi]['statu
+00008960: 7327 5d3a 0a0a 2020 2020 2020 2020 2020  s']:..          
+00008970: 2020 2020 2020 2020 2020 2020 2020 6469                di
+00008980: 6374 696f 6e61 7279 5b0a 2020 2020 2020  ctionary[.      
+00008990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000089a0: 2020 2020 2020 696e 616d 6573 5b69 5d5d        inames[i]]
+000089b0: 5b27 5454 5673 275d 5b70 695d 5b27 746f  ['TTVs'][pi]['to
+000089c0: 7461 6c54 5456 7472 616e 7369 7473 275d  talTTVtransits']
+000089d0: 203d 206c 656e 280a 2020 2020 2020 2020   = len(.        
+000089e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000089f0: 2020 2020 2020 2020 6469 6374 696f 6e61          dictiona
+00008a00: 7279 5b0a 2020 2020 2020 2020 2020 2020  ry[.            
+00008a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008a20: 2020 2020 2020 2020 696e 616d 6573 5b69          inames[i
+00008a30: 5d5d 5b27 5454 5673 275d 5b70 695d 5b27  ]]['TTVs'][pi]['
+00008a40: 7472 616e 7369 745f 6e75 6d62 6572 275d  transit_number']
+00008a50: 290a 0a20 2020 2020 2020 2023 204e 6f77  )..        # Now
+00008a60: 2c20 696d 706c 656d 656e 7420 6e6f 6973  , implement nois
+00008a70: 6520 6d6f 6465 6c73 2066 6f72 2065 6163  e models for eac
+00008a80: 6820 6f66 2074 6865 2069 6e73 7472 756d  h of the instrum
+00008a90: 656e 742e 2046 6972 7374 2063 6865 636b  ent. First check
+00008aa0: 2069 6620 6d6f 6465 6c20 7368 6f75 6c64   if model should
+00008ab0: 2062 6520 676c 6f62 616c 206f 7220 696e   be global or in
+00008ac0: 7374 7275 6d65 6e74 2d62 792d 696e 7374  strument-by-inst
+00008ad0: 7275 6d65 6e74 2c0a 2020 2020 2020 2020  rument,.        
+00008ae0: 2320 6261 7365 6420 6f6e 2074 6865 2069  # based on the i
+00008af0: 6e70 7574 2069 6e73 7472 756d 656e 7473  nput instruments
+00008b00: 2067 6976 656e 2066 6f72 2074 6865 2047   given for the G
+00008b10: 5020 7265 6772 6573 736f 7273 2e0a 2020  P regressors..  
+00008b20: 2020 2020 2020 6966 2067 6c6f 6261 6c5f        if global_
+00008b30: 6d6f 6465 6c3a 0a20 2020 2020 2020 2020  model:.         
+00008b40: 2020 2064 6963 7469 6f6e 6172 795b 2767     dictionary['g
+00008b50: 6c6f 6261 6c5f 6d6f 6465 6c27 5d20 3d20  lobal_model'] = 
+00008b60: 7b7d 0a20 2020 2020 2020 2020 2020 2069  {}.            i
+00008b70: 6620 4750 5f72 6567 7265 7373 6f72 7320  f GP_regressors 
+00008b80: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00008b90: 2020 2020 2020 2020 2020 2020 2064 6963               dic
+00008ba0: 7469 6f6e 6172 795b 2767 6c6f 6261 6c5f  tionary['global_
+00008bb0: 6d6f 6465 6c27 5d5b 2747 5044 6574 7265  model']['GPDetre
+00008bc0: 6e64 275d 203d 2054 7275 650a 2020 2020  nd'] = True.    
+00008bd0: 2020 2020 2020 2020 2020 2020 6469 6374              dict
+00008be0: 696f 6e61 7279 5b27 676c 6f62 616c 5f6d  ionary['global_m
+00008bf0: 6f64 656c 275d 5b27 6e6f 6973 655f 6d6f  odel']['noise_mo
+00008c00: 6465 6c27 5d20 3d20 6761 7573 7369 616e  del'] = gaussian
+00008c10: 5f70 726f 6365 7373 280a 2020 2020 2020  _process(.      
+00008c20: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00008c30: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+00008c40: 2020 2020 2020 2020 6d6f 6465 6c5f 7479          model_ty
+00008c50: 7065 3d64 6963 7479 7065 2c0a 2020 2020  pe=dictype,.    
+00008c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008c70: 696e 7374 7275 6d65 6e74 3d64 6963 7479  instrument=dicty
+00008c80: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+00008c90: 2020 2020 2020 2020 6d61 7465 726e 5f65          matern_e
+00008ca0: 7073 3d73 656c 662e 6d61 7465 726e 5f65  ps=self.matern_e
+00008cb0: 7073 2c20 0a20 2020 2020 2020 2020 2020  ps, .           
+00008cc0: 2020 2020 2020 2020 2067 656f 7267 655f           george_
+00008cd0: 686f 646c 723d 7365 6c66 2e67 656f 7267  hodlr=self.georg
+00008ce0: 655f 686f 646c 7229 0a20 2020 2020 2020  e_hodlr).       
+00008cf0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+00008d00: 6469 6374 696f 6e61 7279 5b27 676c 6f62  dictionary['glob
+00008d10: 616c 5f6d 6f64 656c 275d 5b27 6e6f 6973  al_model']['nois
+00008d20: 655f 6d6f 6465 6c27 5d2e 6973 496e 6974  e_model'].isInit
+00008d30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00008d40: 2020 2020 2020 2320 4966 206e 6f74 2069        # If not i
+00008d50: 6e69 7469 6174 6564 2c20 6d6f 7374 206c  nitiated, most l
+00008d60: 696b 656c 7920 6b65 726e 656c 2069 7320  ikely kernel is 
+00008d70: 6120 6365 6c65 7269 7465 206f 6e65 2e20  a celerite one. 
+00008d80: 5265 6f72 6465 7220 7469 6d65 732c 2076  Reorder times, v
+00008d90: 616c 7565 732c 2065 7463 2e20 5468 6973  alues, etc. This
+00008da0: 2069 7320 4f4b 202d 2d2d 2069 7320 6578   is OK --- is ex
+00008db0: 7065 6374 6564 3a0a 2020 2020 2020 2020  pected:.        
+00008dc0: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+00008dd0: 6963 7479 7065 203d 3d20 276c 6327 3a0a  ictype == 'lc':.
+00008de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008df0: 2020 2020 2020 2020 7365 6c66 2e73 6f72          self.sor
+00008e00: 745f 4750 2827 6c63 2729 0a20 2020 2020  t_GP('lc').     
+00008e10: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00008e20: 6c69 6620 6469 6374 7970 6520 3d3d 2027  lif dictype == '
+00008e30: 7276 273a 0a20 2020 2020 2020 2020 2020  rv':.           
+00008e40: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00008e50: 662e 736f 7274 5f47 5028 2772 7627 290a  f.sort_GP('rv').
+00008e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e70: 2020 2020 2320 5472 7920 6167 6169 6e3a      # Try again:
+00008e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008e90: 2020 2020 2064 6963 7469 6f6e 6172 795b       dictionary[
+00008ea0: 2767 6c6f 6261 6c5f 6d6f 6465 6c27 5d5b  'global_model'][
+00008eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008ec0: 2020 2020 2020 2020 2027 6e6f 6973 655f           'noise_
+00008ed0: 6d6f 6465 6c27 5d20 3d20 6761 7573 7369  model'] = gaussi
+00008ee0: 616e 5f70 726f 6365 7373 280a 2020 2020  an_process(.    
+00008ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008f00: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00008f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008f20: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
+00008f30: 7479 7065 3d64 6963 7479 7065 2c0a 2020  type=dictype,.  
+00008f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008f50: 2020 2020 2020 2020 2020 696e 7374 7275            instru
+00008f60: 6d65 6e74 3d64 6963 7479 7065 2c0a 2020  ment=dictype,.  
+00008f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008f80: 2020 2020 2020 2020 2020 6d61 7465 726e            matern
+00008f90: 5f65 7073 3d73 656c 662e 6d61 7465 726e  _eps=self.matern
+00008fa0: 5f65 7073 2c0a 2020 2020 2020 2020 2020  _eps,.          
+00008fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008fc0: 2020 6765 6f72 6765 5f68 6f64 6c72 3d73    george_hodlr=s
+00008fd0: 656c 662e 6765 6f72 6765 5f68 6f64 6c72  elf.george_hodlr
+00008fe0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00008ff0: 2020 2020 2020 6966 206e 6f74 2064 6963        if not dic
+00009000: 7469 6f6e 6172 795b 2767 6c6f 6261 6c5f  tionary['global_
+00009010: 6d6f 6465 6c27 5d5b 276e 6f69 7365 5f6d  model']['noise_m
+00009020: 6f64 656c 275d 2e69 7349 6e69 743a 0a20  odel'].isInit:. 
+00009030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009040: 2020 2020 2020 2023 2043 6865 636b 2c20         # Check, 
+00009050: 626c 616d 6520 7468 6520 7573 6572 3a0a  blame the user:.
+00009060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009070: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
+00009080: 6365 7074 696f 6e28 0a20 2020 2020 2020  ception(.       
+00009090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000090a0: 2020 2020 2027 494e 5055 5420 4552 524f       'INPUT ERRO
+000090b0: 523a 2047 5020 696e 6974 6961 6c69 7a61  R: GP initializa
+000090c0: 7469 6f6e 2066 6f72 206f 626a 6563 7420  tion for object 
+000090d0: 666f 7220 2720 2b0a 2020 2020 2020 2020  for ' +.        
+000090e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000090f0: 2020 2020 6469 6374 7970 6520 2b20 2720      dictype + ' 
+00009100: 676c 6f62 616c 206b 6572 6e65 6c20 6661  global kernel fa
+00009110: 696c 6564 2e27 290a 2020 2020 2020 2020  iled.').        
+00009120: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00009130: 2020 2020 2020 2020 2020 6469 6374 696f            dictio
+00009140: 6e61 7279 5b27 676c 6f62 616c 5f6d 6f64  nary['global_mod
+00009150: 656c 275d 5b27 4750 4465 7472 656e 6427  el']['GPDetrend'
+00009160: 5d20 3d20 4661 6c73 650a 2020 2020 2020  ] = False.      
+00009170: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00009180: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00009190: 6765 286e 696e 7374 7275 6d65 6e74 7329  ge(ninstruments)
+000091a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000091b0: 2020 696e 7374 7275 6d65 6e74 203d 2069    instrument = i
+000091c0: 6e61 6d65 735b 695d 0a0a 2020 2020 2020  names[i]..      
+000091d0: 2020 2020 2020 2020 2020 6966 2028 4750            if (GP
+000091e0: 5f72 6567 7265 7373 6f72 7320 6973 206e  _regressors is n
+000091f0: 6f74 204e 6f6e 6529 2061 6e64 2028 696e  ot None) and (in
+00009200: 7374 7275 6d65 6e74 2069 6e20 4750 5f72  strument in GP_r
+00009210: 6567 7265 7373 6f72 732e 6b65 7973 2829  egressors.keys()
+00009220: 293a 0a0a 2020 2020 2020 2020 2020 2020  ):..            
+00009230: 2020 2020 2020 2020 6469 6374 696f 6e61          dictiona
+00009240: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
+00009250: 4750 4465 7472 656e 6427 5d20 3d20 5472  GPDetrend'] = Tr
+00009260: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
+00009270: 2020 2020 2020 2064 6963 7469 6f6e 6172         dictionar
+00009280: 795b 696e 7374 7275 6d65 6e74 5d5b 276e  y[instrument]['n
+00009290: 6f69 7365 5f6d 6f64 656c 275d 203d 2067  oise_model'] = g
+000092a0: 6175 7373 6961 6e5f 7072 6f63 6573 7328  aussian_process(
+000092b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000092c0: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
+000092d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000092e0: 2020 2020 2020 206d 6f64 656c 5f74 7970         model_typ
+000092f0: 653d 6469 6374 7970 652c 0a20 2020 2020  e=dictype,.     
+00009300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009310: 2020 2069 6e73 7472 756d 656e 743d 696e     instrument=in
+00009320: 7374 7275 6d65 6e74 2c0a 2020 2020 2020  strument,.      
+00009330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009340: 2020 6d61 7465 726e 5f65 7073 3d73 656c    matern_eps=sel
+00009350: 662e 6d61 7465 726e 5f65 7073 2c0a 2020  f.matern_eps,.  
+00009360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009370: 2020 2020 2020 6765 6f72 6765 5f68 6f64        george_hod
+00009380: 6c72 3d73 656c 662e 6765 6f72 6765 5f68  lr=self.george_h
+00009390: 6f64 6c72 290a 2020 2020 2020 2020 2020  odlr).          
+000093a0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+000093b0: 2064 6963 7469 6f6e 6172 795b 696e 7374   dictionary[inst
+000093c0: 7275 6d65 6e74 5d5b 276e 6f69 7365 5f6d  rument]['noise_m
+000093d0: 6f64 656c 275d 2e69 7349 6e69 743a 0a20  odel'].isInit:. 
+000093e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000093f0: 2020 2020 2020 2023 2042 6c61 6d65 2074         # Blame t
+00009400: 6865 2075 7365 722c 2061 6c74 686f 7567  he user, althoug
+00009410: 6820 7065 7268 6170 7320 7765 2063 6f75  h perhaps we cou
+00009420: 6c64 2073 696d 706c 7920 736f 6c76 6520  ld simply solve 
+00009430: 7468 6973 2061 7320 666f 7220 7468 6520  this as for the 
+00009440: 676c 6f62 616c 206d 6f64 656c 6c69 6e67  global modelling
+00009450: 3f3a 0a20 2020 2020 2020 2020 2020 2020  ?:.             
+00009460: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00009470: 2045 7863 6570 7469 6f6e 280a 2020 2020   Exception(.    
+00009480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009490: 2020 2020 2020 2020 2749 4e50 5554 2045          'INPUT E
+000094a0: 5252 4f52 3a20 4750 2072 6567 7265 7373  RROR: GP regress
+000094b0: 6f72 7320 666f 7220 696e 7374 7275 6d65  ors for instrume
+000094c0: 6e74 2027 202b 0a20 2020 2020 2020 2020  nt ' +.         
+000094d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000094e0: 2020 2069 6e73 7472 756d 656e 7420 2b0a     instrument +.
+000094f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009500: 2020 2020 2020 2020 2020 2020 2720 7573              ' us
+00009510: 6520 6365 6c65 7269 7465 2c20 616e 6420  e celerite, and 
+00009520: 6172 6520 6e6f 7420 696e 2061 7363 656e  are not in ascen
+00009530: 6469 6e67 206f 7220 6465 7363 656e 6469  ding or descendi
+00009540: 6e67 206f 7264 6572 2e20 506c 6561 7365  ng order. Please
+00009550: 2c20 6769 7665 2074 6865 2069 6e70 7574  , give the input
+00009560: 2069 6e20 7468 6f73 6520 6f72 6465 7273   in those orders
+00009570: 202d 2d2d 2069 7420 7769 6c6c 206e 6f74   --- it will not
+00009580: 2077 6f72 6b20 6f74 6865 7273 6965 2e27   work othersie.'
+00009590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000095a0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+000095b0: 2020 2020 2320 4368 6563 6b20 7768 6963      # Check whic
+000095c0: 6820 6563 6365 6e74 7269 6369 7479 2070  h eccentricity p
+000095d0: 6172 616d 6574 7269 7a61 7469 6f6e 2069  arametrization i
+000095e0: 7320 676f 696e 6720 746f 2062 6520 7573  s going to be us
+000095f0: 6564 2066 6f72 2065 6163 6820 706c 616e  ed for each plan
+00009600: 6574 2069 6e20 7468 6520 6a75 6c69 6574  et in the juliet
+00009610: 206e 756d 6265 7269 6e67 2073 6368 656d   numbering schem
+00009620: 652e 0a20 2020 2020 2020 2023 2030 203d  e..        # 0 =
+00009630: 2065 6363 2c20 6f6d 6567 6120 2031 3a20   ecc, omega  1: 
+00009640: 6563 6f73 6f6d 6567 612c 6573 696e 6f6d  ecosomega,esinom
+00009650: 6567 6120 2032 3a20 7371 7274 2865 2963  ega  2: sqrt(e)c
+00009660: 6f73 6f6d 6567 612c 2073 7172 7428 6529  osomega, sqrt(e)
+00009670: 7369 6e6f 6d65 6761 0a20 2020 2020 2020  sinomega.       
+00009680: 2064 6963 7469 6f6e 6172 795b 2765 6363   dictionary['ecc
+00009690: 5f70 6172 616d 6574 7269 7a61 7469 6f6e  _parametrization
+000096a0: 275d 203d 207b 7d0a 2020 2020 2020 2020  '] = {}.        
+000096b0: 6966 2064 6963 7479 7065 203d 3d20 276c  if dictype == 'l
+000096c0: 6327 3a0a 2020 2020 2020 2020 2020 2020  c':.            
+000096d0: 6469 6374 696f 6e61 7279 5b27 6566 6669  dictionary['effi
+000096e0: 6369 656e 745f 6270 275d 203d 207b 7d0a  cient_bp'] = {}.
+000096f0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00009700: 206e 756d 6265 7269 6e67 5f70 6c61 6e65   numbering_plane
+00009710: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
+00009720: 6966 2027 6563 6f73 6f6d 6567 615f 7027  if 'ecosomega_p'
+00009730: 202b 2073 7472 2869 2920 696e 2073 656c   + str(i) in sel
+00009740: 662e 7072 696f 7273 2e6b 6579 7328 293a  f.priors.keys():
+00009750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009760: 2064 6963 7469 6f6e 6172 795b 2765 6363   dictionary['ecc
+00009770: 5f70 6172 616d 6574 7269 7a61 7469 6f6e  _parametrization
+00009780: 275d 5b69 5d20 3d20 310a 2020 2020 2020  '][i] = 1.      
+00009790: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+000097a0: 662e 7665 7262 6f73 653a 0a20 2020 2020  f.verbose:.     
+000097b0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000097c0: 7269 6e74 280a 2020 2020 2020 2020 2020  rint(.          
+000097d0: 2020 2020 2020 2020 2020 2020 2020 275c                '\
+000097e0: 7420 3e3e 2065 636f 736f 6d65 6761 2c65  t >> ecosomega,e
+000097f0: 7369 6e6f 6d65 6761 2070 6172 616d 6574  sinomega paramet
+00009800: 7269 7a61 7469 6f6e 2064 6574 6563 7465  rization detecte
+00009810: 6420 666f 7220 270a 2020 2020 2020 2020  d for '.        
+00009820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009830: 2b20 6469 6374 7970 6520 2b20 2720 706c  + dictype + ' pl
+00009840: 616e 6574 2070 2720 2b20 7374 7228 6929  anet p' + str(i)
+00009850: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00009860: 6966 2027 7365 636f 736f 6d65 6761 5f70  if 'secosomega_p
+00009870: 2720 2b20 7374 7228 6929 2069 6e20 7365  ' + str(i) in se
+00009880: 6c66 2e70 7269 6f72 732e 6b65 7973 2829  lf.priors.keys()
+00009890: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000098a0: 2020 6469 6374 696f 6e61 7279 5b27 6563    dictionary['ec
+000098b0: 635f 7061 7261 6d65 7472 697a 6174 696f  c_parametrizatio
+000098c0: 6e27 5d5b 695d 203d 2032 0a20 2020 2020  n'][i] = 2.     
+000098d0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+000098e0: 6c66 2e76 6572 626f 7365 3a0a 2020 2020  lf.verbose:.    
 000098f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009900: 2020 275c 7420 3e3e 2073 7172 7428 6529    '\t >> sqrt(e)
-00009910: 636f 736f 6d65 6761 2c20 7371 7274 2865  cosomega, sqrt(e
-00009920: 2973 696e 6f6d 6567 6120 7061 7261 6d65  )sinomega parame
-00009930: 7472 697a 6174 696f 6e20 6465 7465 6374  trization detect
-00009940: 6564 2066 6f72 2027 0a20 2020 2020 2020  ed for '.       
-00009950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009960: 202b 2064 6963 7479 7065 202b 2027 2070   + dictype + ' p
-00009970: 6c61 6e65 7420 7027 202b 2073 7472 2869  lanet p' + str(i
-00009980: 2929 0a20 2020 2020 2020 2020 2020 2065  )).            e
-00009990: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000099a0: 2020 2020 2064 6963 7469 6f6e 6172 795b       dictionary[
-000099b0: 2765 6363 5f70 6172 616d 6574 7269 7a61  'ecc_parametriza
-000099c0: 7469 6f6e 275d 5b69 5d20 3d20 300a 2020  tion'][i] = 0.  
-000099d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000099e0: 2073 656c 662e 7665 7262 6f73 653a 0a20   self.verbose:. 
-000099f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009a00: 2020 2070 7269 6e74 2827 5c74 203e 3e20     print('\t >> 
-00009a10: 6563 632c 6f6d 6567 6120 7061 7261 6d65  ecc,omega parame
-00009a20: 7472 697a 6174 696f 6e20 6465 7465 6374  trization detect
-00009a30: 6564 2066 6f72 2027 202b 0a20 2020 2020  ed for ' +.     
-00009a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009a50: 2020 2020 2064 6963 7479 7065 202b 2027       dictype + '
-00009a60: 2070 6c61 6e65 7420 7027 202b 2073 7472   planet p' + str
-00009a70: 2869 2929 0a20 2020 2020 2020 2020 2020  (i)).           
-00009a80: 2069 6620 6469 6374 7970 6520 3d3d 2027   if dictype == '
-00009a90: 6c63 273a 0a20 2020 2020 2020 2020 2020  lc':.           
-00009aa0: 2020 2020 2023 2043 6865 636b 2069 6620       # Check if 
-00009ab0: 4573 7069 6e6f 7a61 2028 3230 3138 292c  Espinoza (2018),
-00009ac0: 2028 622c 7029 2070 6172 616d 6574 7269   (b,p) parametri
-00009ad0: 7a61 7469 6f6e 2069 7320 6f6e 3a0a 2020  zation is on:.  
-00009ae0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00009af0: 2027 7231 5f70 2720 2b20 7374 7228 6929   'r1_p' + str(i)
-00009b00: 2069 6e20 7365 6c66 2e70 7269 6f72 732e   in self.priors.
-00009b10: 6b65 7973 2829 3a0a 2020 2020 2020 2020  keys():.        
-00009b20: 2020 2020 2020 2020 2020 2020 6469 6374              dict
-00009b30: 696f 6e61 7279 5b27 6566 6669 6369 656e  ionary['efficien
-00009b40: 745f 6270 275d 5b69 5d20 3d20 5472 7565  t_bp'][i] = True
-00009b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009b60: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
-00009b70: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
-00009b80: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00009b90: 696e 7428 275c 7420 3e3e 2028 622c 7029  int('\t >> (b,p)
-00009ba0: 2070 6172 616d 6574 7269 7a61 7469 6f6e   parametrization
-00009bb0: 2064 6574 6563 7465 6420 666f 7220 2720   detected for ' 
-00009bc0: 2b0a 2020 2020 2020 2020 2020 2020 2020  +.              
-00009bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009be0: 6469 6374 7970 6520 2b20 2720 706c 616e  dictype + ' plan
-00009bf0: 6574 2070 2720 2b20 7374 7228 6929 290a  et p' + str(i)).
-00009c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009c10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00009c20: 2020 2020 2020 2020 2020 6469 6374 696f            dictio
-00009c30: 6e61 7279 5b27 6566 6669 6369 656e 745f  nary['efficient_
-00009c40: 6270 275d 5b69 5d20 3d20 4661 6c73 650a  bp'][i] = False.
-00009c50: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
-00009c60: 2069 6620 7374 656c 6c61 7220 6465 6e73   if stellar dens
-00009c70: 6974 7920 6973 2069 6e20 7468 6520 7072  ity is in the pr
-00009c80: 696f 723a 0a20 2020 2020 2020 2069 6620  ior:.        if 
-00009c90: 6469 6374 7970 6520 3d3d 2027 6c63 273a  dictype == 'lc':
-00009ca0: 0a20 2020 2020 2020 2020 2020 2064 6963  .            dic
-00009cb0: 7469 6f6e 6172 795b 2766 6974 7268 6f27  tionary['fitrho'
-00009cc0: 5d20 3d20 4661 6c73 650a 2020 2020 2020  ] = False.      
-00009cd0: 2020 2020 2020 6966 2027 7268 6f27 2069        if 'rho' i
-00009ce0: 6e20 7365 6c66 2e70 7269 6f72 732e 6b65  n self.priors.ke
-00009cf0: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
-00009d00: 2020 2020 2020 6469 6374 696f 6e61 7279        dictionary
-00009d10: 5b27 6669 7472 686f 275d 203d 2054 7275  ['fitrho'] = Tru
-00009d20: 650a 0a20 2020 2020 2020 2023 2046 6f72  e..        # For
-00009d30: 2052 5620 6469 6374 696f 6e61 7269 6573   RV dictionaries
-00009d40: 2c20 6368 6563 6b20 6966 2052 5620 7472  , check if RV tr
-00009d50: 656e 6420 7769 6c6c 2062 6520 6669 7474  end will be fitt
-00009d60: 6564 3a0a 2020 2020 2020 2020 6966 2064  ed:.        if d
-00009d70: 6963 7479 7065 203d 3d20 2772 7627 3a0a  ictype == 'rv':.
-00009d80: 2020 2020 2020 2020 2020 2020 6469 6374              dict
-00009d90: 696f 6e61 7279 5b27 6669 7472 766c 696e  ionary['fitrvlin
-00009da0: 6527 5d20 3d20 4661 6c73 650a 2020 2020  e'] = False.    
-00009db0: 2020 2020 2020 2020 6469 6374 696f 6e61          dictiona
-00009dc0: 7279 5b27 6669 7472 7671 7561 6427 5d20  ry['fitrvquad'] 
-00009dd0: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
-00009de0: 2020 2020 6966 2027 7276 5f73 6c6f 7065      if 'rv_slope
-00009df0: 2720 696e 2073 656c 662e 7072 696f 7273  ' in self.priors
-00009e00: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
-00009e10: 2020 2020 2020 2020 2069 6620 2772 765f           if 'rv_
-00009e20: 7175 6164 2720 696e 2073 656c 662e 7072  quad' in self.pr
-00009e30: 696f 7273 2e6b 6579 7328 293a 0a20 2020  iors.keys():.   
-00009e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009e50: 2064 6963 7469 6f6e 6172 795b 2766 6974   dictionary['fit
-00009e60: 7276 7175 6164 275d 203d 2054 7275 650a  rvquad'] = True.
-00009e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009e80: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
-00009e90: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
-00009ea0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00009eb0: 6e74 2827 5c74 2046 6974 7469 6e67 2071  nt('\t Fitting q
-00009ec0: 7561 6472 6174 6963 2074 7265 6e64 2074  uadratic trend t
-00009ed0: 6f20 5256 732e 2729 0a20 2020 2020 2020  o RVs.').       
-00009ee0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00009ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f00: 2020 2064 6963 7469 6f6e 6172 795b 2766     dictionary['f
-00009f10: 6974 7276 6c69 6e65 275d 203d 2054 7275  itrvline'] = Tru
-00009f20: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00009f30: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00009f40: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00009f50: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00009f60: 7269 6e74 2827 5c74 2046 6974 7469 6e67  rint('\t Fitting
-00009f70: 206c 696e 6561 7220 7472 656e 6420 746f   linear trend to
-00009f80: 2052 5673 2e27 290a 0a20 2020 2020 2020   RVs.')..       
-00009f90: 2023 2053 6176 6520 6469 6374 696f 6e61   # Save dictiona
-00009fa0: 7279 2074 6f20 7365 6c66 3a0a 2020 2020  ry to self:.    
-00009fb0: 2020 2020 6966 2064 6963 7479 7065 203d      if dictype =
-00009fc0: 3d20 276c 6327 3a0a 2020 2020 2020 2020  = 'lc':.        
-00009fd0: 2020 2020 7365 6c66 2e6c 635f 6f70 7469      self.lc_opti
-00009fe0: 6f6e 7320 3d20 6469 6374 696f 6e61 7279  ons = dictionary
-00009ff0: 0a20 2020 2020 2020 2065 6c69 6620 6469  .        elif di
-0000a000: 6374 7970 6520 3d3d 2027 7276 273a 0a20  ctype == 'rv':. 
-0000a010: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000a020: 7276 5f6f 7074 696f 6e73 203d 2064 6963  rv_options = dic
-0000a030: 7469 6f6e 6172 790a 2020 2020 2020 2020  tionary.        
-0000a040: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000a050: 2020 7261 6973 6520 4578 6365 7074 696f    raise Exceptio
-0000a060: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-0000a070: 2020 2027 494e 5055 5420 4552 524f 523a     'INPUT ERROR:
-0000a080: 2064 6963 7479 7065 206e 6f74 2075 6e64   dictype not und
-0000a090: 6572 7374 6f6f 642e 2048 6173 2074 6f20  erstood. Has to 
-0000a0a0: 6265 2065 6974 6865 7220 6c63 206f 7220  be either lc or 
-0000a0b0: 7276 2e27 0a20 2020 2020 2020 2020 2020  rv.'.           
-0000a0c0: 2029 0a0a 2020 2020 6465 6620 7365 745f   )..    def set_
-0000a0d0: 6c63 5f64 6174 6128 7365 6c66 2c20 745f  lc_data(self, t_
-0000a0e0: 6c63 2c20 795f 6c63 2c20 7965 7272 5f6c  lc, y_lc, yerr_l
-0000a0f0: 632c 2069 6e73 7472 756d 656e 7473 5f6c  c, instruments_l
-0000a100: 632c 0a20 2020 2020 2020 2020 2020 2020  c,.             
-0000a110: 2020 2020 2020 2069 6e73 7472 756d 656e         instrumen
-0000a120: 745f 696e 6465 7865 735f 6c63 2c20 6e69  t_indexes_lc, ni
-0000a130: 6e73 7472 756d 656e 7473 5f6c 632c 2069  nstruments_lc, i
-0000a140: 6e61 6d65 735f 6c63 2c0a 2020 2020 2020  names_lc,.      
-0000a150: 2020 2020 2020 2020 2020 2020 2020 6c6d                lm
-0000a160: 5f6c 635f 626f 6f6c 6561 6e2c 206c 6d5f  _lc_boolean, lm_
-0000a170: 6c63 5f61 7267 756d 656e 7473 293a 0a20  lc_arguments):. 
-0000a180: 2020 2020 2020 2073 656c 662e 745f 6c63         self.t_lc
-0000a190: 203d 2074 5f6c 632e 6173 7479 7065 2827   = t_lc.astype('
-0000a1a0: 666c 6f61 7436 3427 290a 2020 2020 2020  float64').      
-0000a1b0: 2020 7365 6c66 2e79 5f6c 6320 3d20 795f    self.y_lc = y_
-0000a1c0: 6c63 0a20 2020 2020 2020 2073 656c 662e  lc.        self.
-0000a1d0: 7965 7272 5f6c 6320 3d20 7965 7272 5f6c  yerr_lc = yerr_l
-0000a1e0: 630a 2020 2020 2020 2020 7365 6c66 2e69  c.        self.i
-0000a1f0: 6e61 6d65 735f 6c63 203d 2069 6e61 6d65  names_lc = iname
-0000a200: 735f 6c63 0a20 2020 2020 2020 2073 656c  s_lc.        sel
-0000a210: 662e 696e 7374 7275 6d65 6e74 735f 6c63  f.instruments_lc
-0000a220: 203d 2069 6e73 7472 756d 656e 7473 5f6c   = instruments_l
-0000a230: 630a 2020 2020 2020 2020 7365 6c66 2e6e  c.        self.n
-0000a240: 696e 7374 7275 6d65 6e74 735f 6c63 203d  instruments_lc =
-0000a250: 206e 696e 7374 7275 6d65 6e74 735f 6c63   ninstruments_lc
-0000a260: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
-0000a270: 7374 7275 6d65 6e74 5f69 6e64 6578 6573  strument_indexes
-0000a280: 5f6c 6320 3d20 696e 7374 7275 6d65 6e74  _lc = instrument
-0000a290: 5f69 6e64 6578 6573 5f6c 630a 2020 2020  _indexes_lc.    
-0000a2a0: 2020 2020 7365 6c66 2e6c 6d5f 6c63 5f62      self.lm_lc_b
-0000a2b0: 6f6f 6c65 616e 203d 206c 6d5f 6c63 5f62  oolean = lm_lc_b
-0000a2c0: 6f6f 6c65 616e 0a20 2020 2020 2020 2073  oolean.        s
-0000a2d0: 656c 662e 6c6d 5f6c 635f 6172 6775 6d65  elf.lm_lc_argume
-0000a2e0: 6e74 7320 3d20 6c6d 5f6c 635f 6172 6775  nts = lm_lc_argu
-0000a2f0: 6d65 6e74 730a 2020 2020 2020 2020 7365  ments.        se
-0000a300: 6c66 2e6c 635f 6461 7461 203d 2054 7275  lf.lc_data = Tru
-0000a310: 650a 0a20 2020 2064 6566 2073 6574 5f72  e..    def set_r
-0000a320: 765f 6461 7461 2873 656c 662c 2074 5f72  v_data(self, t_r
-0000a330: 762c 2079 5f72 762c 2079 6572 725f 7276  v, y_rv, yerr_rv
-0000a340: 2c20 696e 7374 7275 6d65 6e74 735f 7276  , instruments_rv
-0000a350: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000a360: 2020 2020 2020 696e 7374 7275 6d65 6e74        instrument
-0000a370: 5f69 6e64 6578 6573 5f72 762c 206e 696e  _indexes_rv, nin
-0000a380: 7374 7275 6d65 6e74 735f 7276 2c20 696e  struments_rv, in
-0000a390: 616d 6573 5f72 762c 0a20 2020 2020 2020  ames_rv,.       
-0000a3a0: 2020 2020 2020 2020 2020 2020 206c 6d5f               lm_
-0000a3b0: 7276 5f62 6f6f 6c65 616e 2c20 6c6d 5f72  rv_boolean, lm_r
-0000a3c0: 765f 6172 6775 6d65 6e74 7329 3a0a 2020  v_arguments):.  
-0000a3d0: 2020 2020 2020 7365 6c66 2e74 5f72 7620        self.t_rv 
-0000a3e0: 3d20 745f 7276 2e61 7374 7970 6528 2766  = t_rv.astype('f
-0000a3f0: 6c6f 6174 3634 2729 0a20 2020 2020 2020  loat64').       
-0000a400: 2073 656c 662e 795f 7276 203d 2079 5f72   self.y_rv = y_r
-0000a410: 760a 2020 2020 2020 2020 7365 6c66 2e79  v.        self.y
-0000a420: 6572 725f 7276 203d 2079 6572 725f 7276  err_rv = yerr_rv
-0000a430: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
-0000a440: 616d 6573 5f72 7620 3d20 696e 616d 6573  ames_rv = inames
-0000a450: 5f72 760a 2020 2020 2020 2020 7365 6c66  _rv.        self
-0000a460: 2e69 6e73 7472 756d 656e 7473 5f72 7620  .instruments_rv 
-0000a470: 3d20 696e 7374 7275 6d65 6e74 735f 7276  = instruments_rv
-0000a480: 0a20 2020 2020 2020 2073 656c 662e 6e69  .        self.ni
-0000a490: 6e73 7472 756d 656e 7473 5f72 7620 3d20  nstruments_rv = 
-0000a4a0: 6e69 6e73 7472 756d 656e 7473 5f72 760a  ninstruments_rv.
-0000a4b0: 2020 2020 2020 2020 7365 6c66 2e69 6e73          self.ins
-0000a4c0: 7472 756d 656e 745f 696e 6465 7865 735f  trument_indexes_
-0000a4d0: 7276 203d 2069 6e73 7472 756d 656e 745f  rv = instrument_
-0000a4e0: 696e 6465 7865 735f 7276 0a20 2020 2020  indexes_rv.     
-0000a4f0: 2020 2073 656c 662e 6c6d 5f72 765f 626f     self.lm_rv_bo
-0000a500: 6f6c 6561 6e20 3d20 6c6d 5f72 765f 626f  olean = lm_rv_bo
-0000a510: 6f6c 6561 6e0a 2020 2020 2020 2020 7365  olean.        se
-0000a520: 6c66 2e6c 6d5f 7276 5f61 7267 756d 656e  lf.lm_rv_argumen
-0000a530: 7473 203d 206c 6d5f 7276 5f61 7267 756d  ts = lm_rv_argum
-0000a540: 656e 7473 0a20 2020 2020 2020 2073 656c  ents.        sel
-0000a550: 662e 7276 5f64 6174 6120 3d20 5472 7565  f.rv_data = True
-0000a560: 0a0a 2020 2020 6465 6620 7361 7665 2873  ..    def save(s
-0000a570: 656c 6629 3a0a 0a20 2020 2020 2020 2069  elf):..        i
-0000a580: 6620 7365 6c66 2e6f 7574 5f66 6f6c 6465  f self.out_folde
-0000a590: 725b 2d31 5d20 213d 2027 2f27 3a0a 2020  r[-1] != '/':.  
-0000a5a0: 2020 2020 2020 2020 2020 7365 6c66 2e6f            self.o
-0000a5b0: 7574 5f66 6f6c 6465 7220 3d20 7365 6c66  ut_folder = self
-0000a5c0: 2e6f 7574 5f66 6f6c 6465 7220 2b20 272f  .out_folder + '/
-0000a5d0: 270a 0a20 2020 2020 2020 2023 2046 6972  '..        # Fir
-0000a5e0: 7374 2c20 7361 7665 206c 6967 6874 6375  st, save lightcu
-0000a5f0: 7276 6520 6461 7461 3a0a 2020 2020 2020  rve data:.      
-0000a600: 2020 6966 206e 6f74 206f 732e 7061 7468    if not os.path
-0000a610: 2e65 7869 7374 7328 7365 6c66 2e6f 7574  .exists(self.out
-0000a620: 5f66 6f6c 6465 7229 3a0a 2020 2020 2020  _folder):.      
-0000a630: 2020 2020 2020 6f73 2e6d 616b 6564 6972        os.makedir
-0000a640: 7328 7365 6c66 2e6f 7574 5f66 6f6c 6465  s(self.out_folde
-0000a650: 722c 2065 7869 7374 5f6f 6b3d 5472 7565  r, exist_ok=True
-0000a660: 290a 2020 2020 2020 2020 6966 2028 6e6f  ).        if (no
-0000a670: 7420 6f73 2e70 6174 682e 6578 6973 7473  t os.path.exists
-0000a680: 2873 656c 662e 6f75 745f 666f 6c64 6572  (self.out_folder
-0000a690: 202b 2027 6c63 2e64 6174 2729 293a 0a20   + 'lc.dat')):. 
-0000a6a0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0000a6b0: 6c66 2e6c 6366 696c 656e 616d 6520 6973  lf.lcfilename is
-0000a6c0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0000a6d0: 2020 2020 2020 2020 2020 206f 732e 7379             os.sy
-0000a6e0: 7374 656d 2827 6370 2027 202b 2073 656c  stem('cp ' + sel
-0000a6f0: 662e 6c63 6669 6c65 6e61 6d65 202b 2027  f.lcfilename + '
-0000a700: 2027 202b 2073 656c 662e 6f75 745f 666f   ' + self.out_fo
-0000a710: 6c64 6572 202b 0a20 2020 2020 2020 2020  lder +.         
-0000a720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a730: 2027 6c63 2e64 6174 2729 0a20 2020 2020   'lc.dat').     
-0000a740: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-0000a750: 2e74 5f6c 6320 6973 206e 6f74 204e 6f6e  .t_lc is not Non
-0000a760: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0000a770: 2020 2073 656c 662e 7361 7665 5f64 6174     self.save_dat
-0000a780: 6128 7365 6c66 2e6f 7574 5f66 6f6c 6465  a(self.out_folde
-0000a790: 7220 2b20 276c 632e 6461 7427 2c20 7365  r + 'lc.dat', se
-0000a7a0: 6c66 2e74 5f6c 632c 2073 656c 662e 795f  lf.t_lc, self.y_
-0000a7b0: 6c63 2c0a 2020 2020 2020 2020 2020 2020  lc,.            
-0000a7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a7d0: 2020 2073 656c 662e 7965 7272 5f6c 632c     self.yerr_lc,
-0000a7e0: 2073 656c 662e 696e 7374 7275 6d65 6e74   self.instrument
-0000a7f0: 735f 6c63 2c0a 2020 2020 2020 2020 2020  s_lc,.          
-0000a800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a810: 2020 2020 2073 656c 662e 6c6d 5f6c 635f       self.lm_lc_
-0000a820: 626f 6f6c 6561 6e2c 2073 656c 662e 6c6d  boolean, self.lm
-0000a830: 5f6c 635f 6172 6775 6d65 6e74 7329 0a0a  _lc_arguments)..
-0000a840: 2020 2020 2020 2020 2320 4e6f 7720 7261          # Now ra
-0000a850: 6469 616c 2d76 656c 6f63 6974 7920 6461  dial-velocity da
-0000a860: 7461 3a0a 2020 2020 2020 2020 6966 2028  ta:.        if (
-0000a870: 6e6f 7420 6f73 2e70 6174 682e 6578 6973  not os.path.exis
-0000a880: 7473 2873 656c 662e 6f75 745f 666f 6c64  ts(self.out_fold
-0000a890: 6572 202b 2027 7276 732e 6461 7427 2929  er + 'rvs.dat'))
-0000a8a0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0000a8b0: 2073 656c 662e 7276 6669 6c65 6e61 6d65   self.rvfilename
-0000a8c0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0000a8d0: 2020 2020 2020 2020 2020 2020 2020 6f73                os
-0000a8e0: 2e73 7973 7465 6d28 2763 7020 2720 2b20  .system('cp ' + 
-0000a8f0: 7365 6c66 2e72 7666 696c 656e 616d 6520  self.rvfilename 
-0000a900: 2b20 2720 2720 2b20 7365 6c66 2e6f 7574  + ' ' + self.out
-0000a910: 5f66 6f6c 6465 7220 2b0a 2020 2020 2020  _folder +.      
-0000a920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a930: 2020 2020 2772 7673 2e64 6174 2729 0a20      'rvs.dat'). 
-0000a940: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0000a950: 7365 6c66 2e74 5f72 7620 6973 206e 6f74  self.t_rv is not
-0000a960: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0000a970: 2020 2020 2020 2073 656c 662e 7361 7665         self.save
-0000a980: 5f64 6174 6128 7365 6c66 2e6f 7574 5f66  _data(self.out_f
-0000a990: 6f6c 6465 7220 2b20 2772 7673 2e64 6174  older + 'rvs.dat
-0000a9a0: 272c 2073 656c 662e 745f 7276 2c0a 2020  ', self.t_rv,.  
-0000a9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a9c0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000a9d0: 662e 795f 7276 2c20 7365 6c66 2e79 6572  f.y_rv, self.yer
-0000a9e0: 725f 7276 2c20 7365 6c66 2e69 6e73 7472  r_rv, self.instr
-0000a9f0: 756d 656e 7473 5f72 762c 0a20 2020 2020  uments_rv,.     
-0000aa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aa10: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-0000aa20: 6d5f 7276 5f62 6f6f 6c65 616e 2c20 7365  m_rv_boolean, se
-0000aa30: 6c66 2e6c 6d5f 7276 5f61 7267 756d 656e  lf.lm_rv_argumen
-0000aa40: 7473 290a 0a20 2020 2020 2020 2023 204e  ts)..        # N
-0000aa50: 6578 742c 2073 6176 6520 4750 2072 6567  ext, save GP reg
-0000aa60: 7265 7373 6f72 733a 0a20 2020 2020 2020  ressors:.       
-0000aa70: 2069 6620 286e 6f74 206f 732e 7061 7468   if (not os.path
-0000aa80: 2e65 7869 7374 7328 7365 6c66 2e6f 7574  .exists(self.out
-0000aa90: 5f66 6f6c 6465 7220 2b20 2747 505f 6c63  _folder + 'GP_lc
-0000aaa0: 5f72 6567 7265 7373 6f72 732e 6461 7427  _regressors.dat'
-0000aab0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-0000aac0: 6966 2073 656c 662e 4750 6c63 6570 6172  if self.GPlcepar
-0000aad0: 616d 6669 6c65 2069 7320 6e6f 7420 4e6f  amfile is not No
-0000aae0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0000aaf0: 2020 2020 6f73 2e73 7973 7465 6d28 2763      os.system('c
-0000ab00: 7020 2720 2b20 7365 6c66 2e47 506c 6365  p ' + self.GPlce
-0000ab10: 7061 7261 6d66 696c 6520 2b20 2720 2720  paramfile + ' ' 
-0000ab20: 2b20 7365 6c66 2e6f 7574 5f66 6f6c 6465  + self.out_folde
-0000ab30: 7220 2b0a 2020 2020 2020 2020 2020 2020  r +.            
-0000ab40: 2020 2020 2020 2020 2020 2020 2020 2747                'G
-0000ab50: 505f 6c63 5f72 6567 7265 7373 6f72 732e  P_lc_regressors.
-0000ab60: 6461 7427 290a 2020 2020 2020 2020 2020  dat').          
-0000ab70: 2020 656c 6966 2073 656c 662e 4750 5f6c    elif self.GP_l
-0000ab80: 635f 6172 6775 6d65 6e74 7320 6973 206e  c_arguments is n
-0000ab90: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0000aba0: 2020 2020 2020 2020 2073 656c 662e 7361           self.sa
-0000abb0: 7665 5f72 6567 7265 7373 6f72 7328 7365  ve_regressors(se
-0000abc0: 6c66 2e6f 7574 5f66 6f6c 6465 7220 2b20  lf.out_folder + 
-0000abd0: 2747 505f 6c63 5f72 6567 7265 7373 6f72  'GP_lc_regressor
-0000abe0: 732e 6461 7427 2c0a 2020 2020 2020 2020  s.dat',.        
-0000abf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ac00: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000ac10: 662e 4750 5f6c 635f 6172 6775 6d65 6e74  f.GP_lc_argument
-0000ac20: 7329 0a20 2020 2020 2020 2069 6620 286e  s).        if (n
-0000ac30: 6f74 206f 732e 7061 7468 2e65 7869 7374  ot os.path.exist
-0000ac40: 7328 7365 6c66 2e6f 7574 5f66 6f6c 6465  s(self.out_folde
-0000ac50: 7220 2b20 2747 505f 7276 5f72 6567 7265  r + 'GP_rv_regre
-0000ac60: 7373 6f72 732e 6461 7427 2929 3a0a 2020  ssors.dat')):.  
-0000ac70: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0000ac80: 662e 4750 7276 6570 6172 616d 6669 6c65  f.GPrveparamfile
-0000ac90: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0000aca0: 2020 2020 2020 2020 2020 2020 2020 6f73                os
-0000acb0: 2e73 7973 7465 6d28 2763 7020 2720 2b20  .system('cp ' + 
-0000acc0: 7365 6c66 2e47 5072 7665 7061 7261 6d66  self.GPrveparamf
-0000acd0: 696c 6520 2b20 2720 2720 2b20 7365 6c66  ile + ' ' + self
-0000ace0: 2e6f 7574 5f66 6f6c 6465 7220 2b0a 2020  .out_folder +.  
-0000acf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ad00: 2020 2020 2020 2020 2747 505f 7276 5f72          'GP_rv_r
-0000ad10: 6567 7265 7373 6f72 732e 6461 7427 290a  egressors.dat').
-0000ad20: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0000ad30: 2073 656c 662e 4750 5f72 765f 6172 6775   self.GP_rv_argu
-0000ad40: 6d65 6e74 7320 6973 206e 6f74 204e 6f6e  ments is not Non
-0000ad50: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0000ad60: 2020 2073 656c 662e 7361 7665 5f72 6567     self.save_reg
-0000ad70: 7265 7373 6f72 7328 7365 6c66 2e6f 7574  ressors(self.out
-0000ad80: 5f66 6f6c 6465 7220 2b20 2747 505f 7276  _folder + 'GP_rv
-0000ad90: 5f72 6567 7265 7373 6f72 732e 6461 7427  _regressors.dat'
-0000ada0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000adb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000adc0: 2020 2020 2020 2073 656c 662e 4750 5f72         self.GP_r
-0000add0: 765f 6172 6775 6d65 6e74 7329 0a0a 2020  v_arguments)..  
-0000ade0: 2020 2020 2020 2320 4669 6e61 6c6c 792c        # Finally,
-0000adf0: 2073 6176 6520 4c4d 2072 6567 7265 7373   save LM regress
-0000ae00: 6f72 7320 6966 2061 6e79 3a0a 2020 2020  ors if any:.    
-0000ae10: 2020 2020 6966 2028 6e6f 7420 6f73 2e70      if (not os.p
-0000ae20: 6174 682e 6578 6973 7473 2873 656c 662e  ath.exists(self.
-0000ae30: 6f75 745f 666f 6c64 6572 202b 2027 4c4d  out_folder + 'LM
-0000ae40: 5f6c 635f 7265 6772 6573 736f 7273 2e64  _lc_regressors.d
-0000ae50: 6174 2729 293a 0a20 2020 2020 2020 2020  at')):.         
-0000ae60: 2020 2069 6620 7365 6c66 2e4c 4d6c 6365     if self.LMlce
-0000ae70: 7061 7261 6d66 696c 6520 6973 206e 6f74  paramfile is not
-0000ae80: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0000ae90: 2020 2020 2020 206f 732e 7379 7374 656d         os.system
-0000aea0: 2827 6370 2027 202b 2073 656c 662e 4c4d  ('cp ' + self.LM
-0000aeb0: 6c63 6570 6172 616d 6669 6c65 202b 2027  lceparamfile + '
-0000aec0: 2027 202b 2073 656c 662e 6f75 745f 666f   ' + self.out_fo
-0000aed0: 6c64 6572 202b 0a20 2020 2020 2020 2020  lder +.         
-0000aee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aef0: 2027 4c4d 5f6c 635f 7265 6772 6573 736f   'LM_lc_regresso
-0000af00: 7273 2e64 6174 2729 0a20 2020 2020 2020  rs.dat').       
-0000af10: 2020 2020 2065 6c69 6620 7365 6c66 2e4c       elif self.L
-0000af20: 4d5f 6c63 5f61 7267 756d 656e 7473 2069  M_lc_arguments i
-0000af30: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000af40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000af50: 2e73 6176 655f 7265 6772 6573 736f 7273  .save_regressors
-0000af60: 2873 656c 662e 6f75 745f 666f 6c64 6572  (self.out_folder
-0000af70: 202b 2027 4c4d 5f6c 635f 7265 6772 6573   + 'LM_lc_regres
-0000af80: 736f 7273 2e64 6174 272c 0a20 2020 2020  sors.dat',.     
-0000af90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000afa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000afb0: 7365 6c66 2e4c 4d5f 6c63 5f61 7267 756d  self.LM_lc_argum
-0000afc0: 656e 7473 290a 2020 2020 2020 2020 6966  ents).        if
-0000afd0: 2028 6e6f 7420 6f73 2e70 6174 682e 6578   (not os.path.ex
-0000afe0: 6973 7473 2873 656c 662e 6f75 745f 666f  ists(self.out_fo
-0000aff0: 6c64 6572 202b 2027 4c4d 5f72 765f 7265  lder + 'LM_rv_re
-0000b000: 6772 6573 736f 7273 2e64 6174 2729 293a  gressors.dat')):
-0000b010: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000b020: 7365 6c66 2e4c 4d72 7665 7061 7261 6d66  self.LMrveparamf
-0000b030: 696c 6520 6973 206e 6f74 204e 6f6e 653a  ile is not None:
-0000b040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b050: 206f 732e 7379 7374 656d 2827 6370 2027   os.system('cp '
-0000b060: 202b 2073 656c 662e 4c4d 7276 6570 6172   + self.LMrvepar
-0000b070: 616d 6669 6c65 202b 2027 2027 202b 2073  amfile + ' ' + s
-0000b080: 656c 662e 6f75 745f 666f 6c64 6572 202b  elf.out_folder +
-0000b090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b0a0: 2020 2020 2020 2020 2020 2027 4c4d 5f72             'LM_r
-0000b0b0: 765f 7265 6772 6573 736f 7273 2e64 6174  v_regressors.dat
-0000b0c0: 2729 0a20 2020 2020 2020 2020 2020 2065  ').            e
-0000b0d0: 6c69 6620 7365 6c66 2e4c 4d5f 7276 5f61  lif self.LM_rv_a
-0000b0e0: 7267 756d 656e 7473 2069 7320 6e6f 7420  rguments is not 
-0000b0f0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000b100: 2020 2020 2020 7365 6c66 2e73 6176 655f        self.save_
-0000b110: 7265 6772 6573 736f 7273 2873 656c 662e  regressors(self.
-0000b120: 6f75 745f 666f 6c64 6572 202b 2027 4c4d  out_folder + 'LM
-0000b130: 5f72 765f 7265 6772 6573 736f 7273 2e64  _rv_regressors.d
-0000b140: 6174 272c 0a20 2020 2020 2020 2020 2020  at',.           
-0000b150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b160: 2020 2020 2020 2020 2020 7365 6c66 2e4c            self.L
-0000b170: 4d5f 7276 5f61 7267 756d 656e 7473 290a  M_rv_arguments).
-0000b180: 0a20 2020 2020 2020 2023 2053 6176 6520  .        # Save 
-0000b190: 7072 696f 7273 3a0a 2020 2020 2020 2020  priors:.        
-0000b1a0: 6966 2028 6e6f 7420 6f73 2e70 6174 682e  if (not os.path.
-0000b1b0: 6578 6973 7473 2873 656c 662e 6f75 745f  exists(self.out_
-0000b1c0: 666f 6c64 6572 202b 2027 7072 696f 7273  folder + 'priors
-0000b1d0: 2e64 6174 2729 293a 0a20 2020 2020 2020  .dat')):.       
-0000b1e0: 2020 2020 2073 656c 662e 7072 696f 725f       self.prior_
-0000b1f0: 666e 616d 6520 3d20 7365 6c66 2e6f 7574  fname = self.out
-0000b200: 5f66 6f6c 6465 7220 2b20 2770 7269 6f72  _folder + 'prior
-0000b210: 732e 6461 7427 0a20 2020 2020 2020 2020  s.dat'.         
-0000b220: 2020 2073 656c 662e 7361 7665 5f70 7269     self.save_pri
-0000b230: 6f72 6669 6c65 2873 656c 662e 6f75 745f  orfile(self.out_
-0000b240: 666f 6c64 6572 202b 2027 7072 696f 7273  folder + 'priors
-0000b250: 2e64 6174 2729 0a0a 2020 2020 6465 6620  .dat')..    def 
-0000b260: 6669 7428 7365 6c66 2c20 2a2a 6b77 6172  fit(self, **kwar
-0000b270: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
-0000b280: 0a20 2020 2020 2020 2050 6572 6861 7073  .        Perhaps
-0000b290: 2074 6865 206d 6f73 7420 696d 706f 7274   the most import
-0000b2a0: 616e 7420 6675 6e63 7469 6f6e 206f 6620  ant function of 
-0000b2b0: 7468 6520 6a75 6c69 6574 2064 6174 6120  the juliet data 
-0000b2c0: 6f62 6a65 6374 2e20 5468 6973 2066 756e  object. This fun
-0000b2d0: 6374 696f 6e20 6669 7473 2079 6f75 7220  ction fits your 
-0000b2e0: 6461 7461 2075 7369 6e67 2074 6865 206e  data using the n
-0000b2f0: 6573 7465 640a 2020 2020 2020 2020 7361  ested.        sa
-0000b300: 6d70 6c65 7220 6f66 2063 686f 6963 652e  mpler of choice.
-0000b310: 2054 6869 7320 7265 7475 726e 7320 6120   This returns a 
-0000b320: 7265 7375 6c74 7320 6f62 6a65 6374 2077  results object w
-0000b330: 6869 6368 2063 6f6e 7461 696e 7320 616c  hich contains al
-0000b340: 6c20 7468 6520 706f 7374 6572 696f 7273  l the posteriors
-0000b350: 2069 6e66 6f72 6d61 7469 6f6e 2e0a 2020   information..  
-0000b360: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000b370: 2020 2320 4e6f 7465 2074 6869 7320 7265    # Note this re
-0000b380: 7475 726e 2063 616c 6c20 6372 6561 7465  turn call create
-0000b390: 7320 6120 6669 7420 2a6f 626a 6563 742a  s a fit *object*
-0000b3a0: 2077 6974 6820 7468 6520 6375 7272 656e   with the curren
-0000b3b0: 7420 6461 7461 206f 626a 6563 742e 2054  t data object. T
-0000b3c0: 6865 2066 6974 2063 6c61 7373 2064 6566  he fit class def
-0000b3d0: 696e 6974 696f 6e20 6973 2062 656c 6f77  inition is below
-0000b3e0: 2e0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0000b3f0: 2066 6974 2873 656c 662c 202a 2a6b 7761   fit(self, **kwa
-0000b400: 7267 7329 0a0a 2020 2020 6465 6620 5f5f  rgs)..    def __
-0000b410: 696e 6974 5f5f 2873 656c 662c 7072 696f  init__(self,prio
-0000b420: 7273 203d 204e 6f6e 652c 2073 7461 7274  rs = None, start
-0000b430: 696e 675f 706f 696e 7420 3d20 4e6f 6e65  ing_point = None
-0000b440: 2c20 696e 7075 745f 666f 6c64 6572 203d  , input_folder =
-0000b450: 204e 6f6e 652c 2074 5f6c 6320 3d20 4e6f   None, t_lc = No
-0000b460: 6e65 2c20 795f 6c63 203d 204e 6f6e 652c  ne, y_lc = None,
-0000b470: 2079 6572 725f 6c63 203d 204e 6f6e 652c   yerr_lc = None,
-0000b480: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
-0000b490: 2020 2020 745f 7276 203d 204e 6f6e 652c      t_rv = None,
-0000b4a0: 2079 5f72 7620 3d20 4e6f 6e65 2c20 7965   y_rv = None, ye
-0000b4b0: 7272 5f72 7620 3d20 4e6f 6e65 2c20 4750  rr_rv = None, GP
-0000b4c0: 5f72 6567 7265 7373 6f72 735f 6c63 203d  _regressors_lc =
-0000b4d0: 204e 6f6e 652c 206c 696e 6561 725f 7265   None, linear_re
+00009900: 7072 696e 7428 0a20 2020 2020 2020 2020  print(.         
+00009910: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00009920: 5c74 203e 3e20 7371 7274 2865 2963 6f73  \t >> sqrt(e)cos
+00009930: 6f6d 6567 612c 2073 7172 7428 6529 7369  omega, sqrt(e)si
+00009940: 6e6f 6d65 6761 2070 6172 616d 6574 7269  nomega parametri
+00009950: 7a61 7469 6f6e 2064 6574 6563 7465 6420  zation detected 
+00009960: 666f 7220 270a 2020 2020 2020 2020 2020  for '.          
+00009970: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
+00009980: 6469 6374 7970 6520 2b20 2720 706c 616e  dictype + ' plan
+00009990: 6574 2070 2720 2b20 7374 7228 6929 290a  et p' + str(i)).
+000099a0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000099b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000099c0: 2020 6469 6374 696f 6e61 7279 5b27 6563    dictionary['ec
+000099d0: 635f 7061 7261 6d65 7472 697a 6174 696f  c_parametrizatio
+000099e0: 6e27 5d5b 695d 203d 2030 0a20 2020 2020  n'][i] = 0.     
+000099f0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00009a00: 6c66 2e76 6572 626f 7365 3a0a 2020 2020  lf.verbose:.    
+00009a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009a20: 7072 696e 7428 275c 7420 3e3e 2065 6363  print('\t >> ecc
+00009a30: 2c6f 6d65 6761 2070 6172 616d 6574 7269  ,omega parametri
+00009a40: 7a61 7469 6f6e 2064 6574 6563 7465 6420  zation detected 
+00009a50: 666f 7220 2720 2b0a 2020 2020 2020 2020  for ' +.        
+00009a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009a70: 2020 6469 6374 7970 6520 2b20 2720 706c    dictype + ' pl
+00009a80: 616e 6574 2070 2720 2b20 7374 7228 6929  anet p' + str(i)
+00009a90: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00009aa0: 2064 6963 7479 7065 203d 3d20 276c 6327   dictype == 'lc'
+00009ab0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00009ac0: 2020 2320 4368 6563 6b20 6966 2045 7370    # Check if Esp
+00009ad0: 696e 6f7a 6120 2832 3031 3829 2c20 2862  inoza (2018), (b
+00009ae0: 2c70 2920 7061 7261 6d65 7472 697a 6174  ,p) parametrizat
+00009af0: 696f 6e20 6973 206f 6e3a 0a20 2020 2020  ion is on:.     
+00009b00: 2020 2020 2020 2020 2020 2069 6620 2772             if 'r
+00009b10: 315f 7027 202b 2073 7472 2869 2920 696e  1_p' + str(i) in
+00009b20: 2073 656c 662e 7072 696f 7273 2e6b 6579   self.priors.key
+00009b30: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+00009b40: 2020 2020 2020 2020 2064 6963 7469 6f6e           diction
+00009b50: 6172 795b 2765 6666 6963 6965 6e74 5f62  ary['efficient_b
+00009b60: 7027 5d5b 695d 203d 2054 7275 650a 2020  p'][i] = True.  
+00009b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009b80: 2020 6966 2073 656c 662e 7665 7262 6f73    if self.verbos
+00009b90: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00009ba0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00009bb0: 2827 5c74 203e 3e20 2862 2c70 2920 7061  ('\t >> (b,p) pa
+00009bc0: 7261 6d65 7472 697a 6174 696f 6e20 6465  rametrization de
+00009bd0: 7465 6374 6564 2066 6f72 2027 202b 0a20  tected for ' +. 
+00009be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009bf0: 2020 2020 2020 2020 2020 2020 2064 6963               dic
+00009c00: 7479 7065 202b 2027 2070 6c61 6e65 7420  type + ' planet 
+00009c10: 7027 202b 2073 7472 2869 2929 0a20 2020  p' + str(i)).   
+00009c20: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00009c30: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00009c40: 2020 2020 2020 2064 6963 7469 6f6e 6172         dictionar
+00009c50: 795b 2765 6666 6963 6965 6e74 5f62 7027  y['efficient_bp'
+00009c60: 5d5b 695d 203d 2046 616c 7365 0a0a 2020  ][i] = False..  
+00009c70: 2020 2020 2020 2320 4368 6563 6b20 6966        # Check if
+00009c80: 2073 7465 6c6c 6172 2064 656e 7369 7479   stellar density
+00009c90: 2069 7320 696e 2074 6865 2070 7269 6f72   is in the prior
+00009ca0: 3a0a 2020 2020 2020 2020 6966 2064 6963  :.        if dic
+00009cb0: 7479 7065 203d 3d20 276c 6327 3a0a 2020  type == 'lc':.  
+00009cc0: 2020 2020 2020 2020 2020 6469 6374 696f            dictio
+00009cd0: 6e61 7279 5b27 6669 7472 686f 275d 203d  nary['fitrho'] =
+00009ce0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+00009cf0: 2020 2069 6620 2772 686f 2720 696e 2073     if 'rho' in s
+00009d00: 656c 662e 7072 696f 7273 2e6b 6579 7328  elf.priors.keys(
+00009d10: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00009d20: 2020 2064 6963 7469 6f6e 6172 795b 2766     dictionary['f
+00009d30: 6974 7268 6f27 5d20 3d20 5472 7565 0a0a  itrho'] = True..
+00009d40: 2020 2020 2020 2020 2320 466f 7220 5256          # For RV
+00009d50: 2064 6963 7469 6f6e 6172 6965 732c 2063   dictionaries, c
+00009d60: 6865 636b 2069 6620 5256 2074 7265 6e64  heck if RV trend
+00009d70: 2077 696c 6c20 6265 2066 6974 7465 643a   will be fitted:
+00009d80: 0a20 2020 2020 2020 2069 6620 6469 6374  .        if dict
+00009d90: 7970 6520 3d3d 2027 7276 273a 0a20 2020  ype == 'rv':.   
+00009da0: 2020 2020 2020 2020 2064 6963 7469 6f6e           diction
+00009db0: 6172 795b 2766 6974 7276 6c69 6e65 275d  ary['fitrvline']
+00009dc0: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00009dd0: 2020 2020 2064 6963 7469 6f6e 6172 795b       dictionary[
+00009de0: 2766 6974 7276 7175 6164 275d 203d 2046  'fitrvquad'] = F
+00009df0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+00009e00: 2069 6620 2772 765f 736c 6f70 6527 2069   if 'rv_slope' i
+00009e10: 6e20 7365 6c66 2e70 7269 6f72 732e 6b65  n self.priors.ke
+00009e20: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
+00009e30: 2020 2020 2020 6966 2027 7276 5f71 7561        if 'rv_qua
+00009e40: 6427 2069 6e20 7365 6c66 2e70 7269 6f72  d' in self.prior
+00009e50: 732e 6b65 7973 2829 3a0a 2020 2020 2020  s.keys():.      
+00009e60: 2020 2020 2020 2020 2020 2020 2020 6469                di
+00009e70: 6374 696f 6e61 7279 5b27 6669 7472 7671  ctionary['fitrvq
+00009e80: 7561 6427 5d20 3d20 5472 7565 0a20 2020  uad'] = True.   
+00009e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ea0: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
+00009eb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00009ec0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00009ed0: 275c 7420 4669 7474 696e 6720 7175 6164  '\t Fitting quad
+00009ee0: 7261 7469 6320 7472 656e 6420 746f 2052  ratic trend to R
+00009ef0: 5673 2e27 290a 2020 2020 2020 2020 2020  Vs.').          
+00009f00: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00009f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009f20: 6469 6374 696f 6e61 7279 5b27 6669 7472  dictionary['fitr
+00009f30: 766c 696e 6527 5d20 3d20 5472 7565 0a20  vline'] = True. 
+00009f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009f50: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+00009f60: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00009f70: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00009f80: 7428 275c 7420 4669 7474 696e 6720 6c69  t('\t Fitting li
+00009f90: 6e65 6172 2074 7265 6e64 2074 6f20 5256  near trend to RV
+00009fa0: 732e 2729 0a0a 2020 2020 2020 2020 2320  s.')..        # 
+00009fb0: 5361 7665 2064 6963 7469 6f6e 6172 7920  Save dictionary 
+00009fc0: 746f 2073 656c 663a 0a20 2020 2020 2020  to self:.       
+00009fd0: 2069 6620 6469 6374 7970 6520 3d3d 2027   if dictype == '
+00009fe0: 6c63 273a 0a20 2020 2020 2020 2020 2020  lc':.           
+00009ff0: 2073 656c 662e 6c63 5f6f 7074 696f 6e73   self.lc_options
+0000a000: 203d 2064 6963 7469 6f6e 6172 790a 2020   = dictionary.  
+0000a010: 2020 2020 2020 656c 6966 2064 6963 7479        elif dicty
+0000a020: 7065 203d 3d20 2772 7627 3a0a 2020 2020  pe == 'rv':.    
+0000a030: 2020 2020 2020 2020 7365 6c66 2e72 765f          self.rv_
+0000a040: 6f70 7469 6f6e 7320 3d20 6469 6374 696f  options = dictio
+0000a050: 6e61 7279 0a20 2020 2020 2020 2065 6c73  nary.        els
+0000a060: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0000a070: 6169 7365 2045 7863 6570 7469 6f6e 280a  aise Exception(.
+0000a080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a090: 2749 4e50 5554 2045 5252 4f52 3a20 6469  'INPUT ERROR: di
+0000a0a0: 6374 7970 6520 6e6f 7420 756e 6465 7273  ctype not unders
+0000a0b0: 746f 6f64 2e20 4861 7320 746f 2062 6520  tood. Has to be 
+0000a0c0: 6569 7468 6572 206c 6320 6f72 2072 762e  either lc or rv.
+0000a0d0: 270a 2020 2020 2020 2020 2020 2020 290a  '.            ).
+0000a0e0: 0a20 2020 2064 6566 2073 6574 5f6c 635f  .    def set_lc_
+0000a0f0: 6461 7461 2873 656c 662c 2074 5f6c 632c  data(self, t_lc,
+0000a100: 2079 5f6c 632c 2079 6572 725f 6c63 2c20   y_lc, yerr_lc, 
+0000a110: 696e 7374 7275 6d65 6e74 735f 6c63 2c0a  instruments_lc,.
+0000a120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a130: 2020 2020 696e 7374 7275 6d65 6e74 5f69      instrument_i
+0000a140: 6e64 6578 6573 5f6c 632c 206e 696e 7374  ndexes_lc, ninst
+0000a150: 7275 6d65 6e74 735f 6c63 2c20 696e 616d  ruments_lc, inam
+0000a160: 6573 5f6c 632c 0a20 2020 2020 2020 2020  es_lc,.         
+0000a170: 2020 2020 2020 2020 2020 206c 6d5f 6c63             lm_lc
+0000a180: 5f62 6f6f 6c65 616e 2c20 6c6d 5f6c 635f  _boolean, lm_lc_
+0000a190: 6172 6775 6d65 6e74 7329 3a0a 2020 2020  arguments):.    
+0000a1a0: 2020 2020 7365 6c66 2e74 5f6c 6320 3d20      self.t_lc = 
+0000a1b0: 745f 6c63 2e61 7374 7970 6528 2766 6c6f  t_lc.astype('flo
+0000a1c0: 6174 3634 2729 0a20 2020 2020 2020 2073  at64').        s
+0000a1d0: 656c 662e 795f 6c63 203d 2079 5f6c 630a  elf.y_lc = y_lc.
+0000a1e0: 2020 2020 2020 2020 7365 6c66 2e79 6572          self.yer
+0000a1f0: 725f 6c63 203d 2079 6572 725f 6c63 0a20  r_lc = yerr_lc. 
+0000a200: 2020 2020 2020 2073 656c 662e 696e 616d         self.inam
+0000a210: 6573 5f6c 6320 3d20 696e 616d 6573 5f6c  es_lc = inames_l
+0000a220: 630a 2020 2020 2020 2020 7365 6c66 2e69  c.        self.i
+0000a230: 6e73 7472 756d 656e 7473 5f6c 6320 3d20  nstruments_lc = 
+0000a240: 696e 7374 7275 6d65 6e74 735f 6c63 0a20  instruments_lc. 
+0000a250: 2020 2020 2020 2073 656c 662e 6e69 6e73         self.nins
+0000a260: 7472 756d 656e 7473 5f6c 6320 3d20 6e69  truments_lc = ni
+0000a270: 6e73 7472 756d 656e 7473 5f6c 630a 2020  nstruments_lc.  
+0000a280: 2020 2020 2020 7365 6c66 2e69 6e73 7472        self.instr
+0000a290: 756d 656e 745f 696e 6465 7865 735f 6c63  ument_indexes_lc
+0000a2a0: 203d 2069 6e73 7472 756d 656e 745f 696e   = instrument_in
+0000a2b0: 6465 7865 735f 6c63 0a20 2020 2020 2020  dexes_lc.       
+0000a2c0: 2073 656c 662e 6c6d 5f6c 635f 626f 6f6c   self.lm_lc_bool
+0000a2d0: 6561 6e20 3d20 6c6d 5f6c 635f 626f 6f6c  ean = lm_lc_bool
+0000a2e0: 6561 6e0a 2020 2020 2020 2020 7365 6c66  ean.        self
+0000a2f0: 2e6c 6d5f 6c63 5f61 7267 756d 656e 7473  .lm_lc_arguments
+0000a300: 203d 206c 6d5f 6c63 5f61 7267 756d 656e   = lm_lc_argumen
+0000a310: 7473 0a20 2020 2020 2020 2073 656c 662e  ts.        self.
+0000a320: 6c63 5f64 6174 6120 3d20 5472 7565 0a0a  lc_data = True..
+0000a330: 2020 2020 6465 6620 7365 745f 7276 5f64      def set_rv_d
+0000a340: 6174 6128 7365 6c66 2c20 745f 7276 2c20  ata(self, t_rv, 
+0000a350: 795f 7276 2c20 7965 7272 5f72 762c 2069  y_rv, yerr_rv, i
+0000a360: 6e73 7472 756d 656e 7473 5f72 762c 0a20  nstruments_rv,. 
+0000a370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a380: 2020 2069 6e73 7472 756d 656e 745f 696e     instrument_in
+0000a390: 6465 7865 735f 7276 2c20 6e69 6e73 7472  dexes_rv, ninstr
+0000a3a0: 756d 656e 7473 5f72 762c 2069 6e61 6d65  uments_rv, iname
+0000a3b0: 735f 7276 2c0a 2020 2020 2020 2020 2020  s_rv,.          
+0000a3c0: 2020 2020 2020 2020 2020 6c6d 5f72 765f            lm_rv_
+0000a3d0: 626f 6f6c 6561 6e2c 206c 6d5f 7276 5f61  boolean, lm_rv_a
+0000a3e0: 7267 756d 656e 7473 293a 0a20 2020 2020  rguments):.     
+0000a3f0: 2020 2073 656c 662e 745f 7276 203d 2074     self.t_rv = t
+0000a400: 5f72 762e 6173 7479 7065 2827 666c 6f61  _rv.astype('floa
+0000a410: 7436 3427 290a 2020 2020 2020 2020 7365  t64').        se
+0000a420: 6c66 2e79 5f72 7620 3d20 795f 7276 0a20  lf.y_rv = y_rv. 
+0000a430: 2020 2020 2020 2073 656c 662e 7965 7272         self.yerr
+0000a440: 5f72 7620 3d20 7965 7272 5f72 760a 2020  _rv = yerr_rv.  
+0000a450: 2020 2020 2020 7365 6c66 2e69 6e61 6d65        self.iname
+0000a460: 735f 7276 203d 2069 6e61 6d65 735f 7276  s_rv = inames_rv
+0000a470: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
+0000a480: 7374 7275 6d65 6e74 735f 7276 203d 2069  struments_rv = i
+0000a490: 6e73 7472 756d 656e 7473 5f72 760a 2020  nstruments_rv.  
+0000a4a0: 2020 2020 2020 7365 6c66 2e6e 696e 7374        self.ninst
+0000a4b0: 7275 6d65 6e74 735f 7276 203d 206e 696e  ruments_rv = nin
+0000a4c0: 7374 7275 6d65 6e74 735f 7276 0a20 2020  struments_rv.   
+0000a4d0: 2020 2020 2073 656c 662e 696e 7374 7275       self.instru
+0000a4e0: 6d65 6e74 5f69 6e64 6578 6573 5f72 7620  ment_indexes_rv 
+0000a4f0: 3d20 696e 7374 7275 6d65 6e74 5f69 6e64  = instrument_ind
+0000a500: 6578 6573 5f72 760a 2020 2020 2020 2020  exes_rv.        
+0000a510: 7365 6c66 2e6c 6d5f 7276 5f62 6f6f 6c65  self.lm_rv_boole
+0000a520: 616e 203d 206c 6d5f 7276 5f62 6f6f 6c65  an = lm_rv_boole
+0000a530: 616e 0a20 2020 2020 2020 2073 656c 662e  an.        self.
+0000a540: 6c6d 5f72 765f 6172 6775 6d65 6e74 7320  lm_rv_arguments 
+0000a550: 3d20 6c6d 5f72 765f 6172 6775 6d65 6e74  = lm_rv_argument
+0000a560: 730a 2020 2020 2020 2020 7365 6c66 2e72  s.        self.r
+0000a570: 765f 6461 7461 203d 2054 7275 650a 0a20  v_data = True.. 
+0000a580: 2020 2064 6566 2073 6176 6528 7365 6c66     def save(self
+0000a590: 293a 0a0a 2020 2020 2020 2020 6966 2073  ):..        if s
+0000a5a0: 656c 662e 6f75 745f 666f 6c64 6572 5b2d  elf.out_folder[-
+0000a5b0: 315d 2021 3d20 272f 273a 0a20 2020 2020  1] != '/':.     
+0000a5c0: 2020 2020 2020 2073 656c 662e 6f75 745f         self.out_
+0000a5d0: 666f 6c64 6572 203d 2073 656c 662e 6f75  folder = self.ou
+0000a5e0: 745f 666f 6c64 6572 202b 2027 2f27 0a0a  t_folder + '/'..
+0000a5f0: 2020 2020 2020 2020 2320 4669 7273 742c          # First,
+0000a600: 2073 6176 6520 6c69 6768 7463 7572 7665   save lightcurve
+0000a610: 2064 6174 613a 0a20 2020 2020 2020 2069   data:.        i
+0000a620: 6620 6e6f 7420 6f73 2e70 6174 682e 6578  f not os.path.ex
+0000a630: 6973 7473 2873 656c 662e 6f75 745f 666f  ists(self.out_fo
+0000a640: 6c64 6572 293a 0a20 2020 2020 2020 2020  lder):.         
+0000a650: 2020 206f 732e 6d61 6b65 6469 7273 2873     os.makedirs(s
+0000a660: 656c 662e 6f75 745f 666f 6c64 6572 2c20  elf.out_folder, 
+0000a670: 6578 6973 745f 6f6b 3d54 7275 6529 0a20  exist_ok=True). 
+0000a680: 2020 2020 2020 2069 6620 286e 6f74 206f         if (not o
+0000a690: 732e 7061 7468 2e65 7869 7374 7328 7365  s.path.exists(se
+0000a6a0: 6c66 2e6f 7574 5f66 6f6c 6465 7220 2b20  lf.out_folder + 
+0000a6b0: 276c 632e 6461 7427 2929 3a0a 2020 2020  'lc.dat')):.    
+0000a6c0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0000a6d0: 6c63 6669 6c65 6e61 6d65 2069 7320 6e6f  lcfilename is no
+0000a6e0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0000a6f0: 2020 2020 2020 2020 6f73 2e73 7973 7465          os.syste
+0000a700: 6d28 2763 7020 2720 2b20 7365 6c66 2e6c  m('cp ' + self.l
+0000a710: 6366 696c 656e 616d 6520 2b20 2720 2720  cfilename + ' ' 
+0000a720: 2b20 7365 6c66 2e6f 7574 5f66 6f6c 6465  + self.out_folde
+0000a730: 7220 2b0a 2020 2020 2020 2020 2020 2020  r +.            
+0000a740: 2020 2020 2020 2020 2020 2020 2020 276c                'l
+0000a750: 632e 6461 7427 290a 2020 2020 2020 2020  c.dat').        
+0000a760: 2020 2020 656c 6966 2073 656c 662e 745f      elif self.t_
+0000a770: 6c63 2069 7320 6e6f 7420 4e6f 6e65 3a0a  lc is not None:.
+0000a780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a790: 7365 6c66 2e73 6176 655f 6461 7461 2873  self.save_data(s
+0000a7a0: 656c 662e 6f75 745f 666f 6c64 6572 202b  elf.out_folder +
+0000a7b0: 2027 6c63 2e64 6174 272c 2073 656c 662e   'lc.dat', self.
+0000a7c0: 745f 6c63 2c20 7365 6c66 2e79 5f6c 632c  t_lc, self.y_lc,
+0000a7d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a7f0: 7365 6c66 2e79 6572 725f 6c63 2c20 7365  self.yerr_lc, se
+0000a800: 6c66 2e69 6e73 7472 756d 656e 7473 5f6c  lf.instruments_l
+0000a810: 632c 0a20 2020 2020 2020 2020 2020 2020  c,.             
+0000a820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a830: 2020 7365 6c66 2e6c 6d5f 6c63 5f62 6f6f    self.lm_lc_boo
+0000a840: 6c65 616e 2c20 7365 6c66 2e6c 6d5f 6c63  lean, self.lm_lc
+0000a850: 5f61 7267 756d 656e 7473 290a 0a20 2020  _arguments)..   
+0000a860: 2020 2020 2023 204e 6f77 2072 6164 6961       # Now radia
+0000a870: 6c2d 7665 6c6f 6369 7479 2064 6174 613a  l-velocity data:
+0000a880: 0a20 2020 2020 2020 2069 6620 286e 6f74  .        if (not
+0000a890: 206f 732e 7061 7468 2e65 7869 7374 7328   os.path.exists(
+0000a8a0: 7365 6c66 2e6f 7574 5f66 6f6c 6465 7220  self.out_folder 
+0000a8b0: 2b20 2772 7673 2e64 6174 2729 293a 0a20  + 'rvs.dat')):. 
+0000a8c0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0000a8d0: 6c66 2e72 7666 696c 656e 616d 6520 6973  lf.rvfilename is
+0000a8e0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0000a8f0: 2020 2020 2020 2020 2020 206f 732e 7379             os.sy
+0000a900: 7374 656d 2827 6370 2027 202b 2073 656c  stem('cp ' + sel
+0000a910: 662e 7276 6669 6c65 6e61 6d65 202b 2027  f.rvfilename + '
+0000a920: 2027 202b 2073 656c 662e 6f75 745f 666f   ' + self.out_fo
+0000a930: 6c64 6572 202b 0a20 2020 2020 2020 2020  lder +.         
+0000a940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a950: 2027 7276 732e 6461 7427 290a 2020 2020   'rvs.dat').    
+0000a960: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+0000a970: 662e 745f 7276 2069 7320 6e6f 7420 4e6f  f.t_rv is not No
+0000a980: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000a990: 2020 2020 7365 6c66 2e73 6176 655f 6461      self.save_da
+0000a9a0: 7461 2873 656c 662e 6f75 745f 666f 6c64  ta(self.out_fold
+0000a9b0: 6572 202b 2027 7276 732e 6461 7427 2c20  er + 'rvs.dat', 
+0000a9c0: 7365 6c66 2e74 5f72 762c 0a20 2020 2020  self.t_rv,.     
+0000a9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a9e0: 2020 2020 2020 2020 2020 7365 6c66 2e79            self.y
+0000a9f0: 5f72 762c 2073 656c 662e 7965 7272 5f72  _rv, self.yerr_r
+0000aa00: 762c 2073 656c 662e 696e 7374 7275 6d65  v, self.instrume
+0000aa10: 6e74 735f 7276 2c0a 2020 2020 2020 2020  nts_rv,.        
+0000aa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aa30: 2020 2020 2020 2073 656c 662e 6c6d 5f72         self.lm_r
+0000aa40: 765f 626f 6f6c 6561 6e2c 2073 656c 662e  v_boolean, self.
+0000aa50: 6c6d 5f72 765f 6172 6775 6d65 6e74 7329  lm_rv_arguments)
+0000aa60: 0a0a 2020 2020 2020 2020 2320 4e65 7874  ..        # Next
+0000aa70: 2c20 7361 7665 2047 5020 7265 6772 6573  , save GP regres
+0000aa80: 736f 7273 3a0a 2020 2020 2020 2020 6966  sors:.        if
+0000aa90: 2028 6e6f 7420 6f73 2e70 6174 682e 6578   (not os.path.ex
+0000aaa0: 6973 7473 2873 656c 662e 6f75 745f 666f  ists(self.out_fo
+0000aab0: 6c64 6572 202b 2027 4750 5f6c 635f 7265  lder + 'GP_lc_re
+0000aac0: 6772 6573 736f 7273 2e64 6174 2729 293a  gressors.dat')):
+0000aad0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000aae0: 7365 6c66 2e47 506c 6365 7061 7261 6d66  self.GPlceparamf
+0000aaf0: 696c 6520 6973 206e 6f74 204e 6f6e 653a  ile is not None:
+0000ab00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ab10: 206f 732e 7379 7374 656d 2827 6370 2027   os.system('cp '
+0000ab20: 202b 2073 656c 662e 4750 6c63 6570 6172   + self.GPlcepar
+0000ab30: 616d 6669 6c65 202b 2027 2027 202b 2073  amfile + ' ' + s
+0000ab40: 656c 662e 6f75 745f 666f 6c64 6572 202b  elf.out_folder +
+0000ab50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ab60: 2020 2020 2020 2020 2020 2027 4750 5f6c             'GP_l
+0000ab70: 635f 7265 6772 6573 736f 7273 2e64 6174  c_regressors.dat
+0000ab80: 2729 0a20 2020 2020 2020 2020 2020 2065  ').            e
+0000ab90: 6c69 6620 7365 6c66 2e47 505f 6c63 5f61  lif self.GP_lc_a
+0000aba0: 7267 756d 656e 7473 2069 7320 6e6f 7420  rguments is not 
+0000abb0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000abc0: 2020 2020 2020 7365 6c66 2e73 6176 655f        self.save_
+0000abd0: 7265 6772 6573 736f 7273 2873 656c 662e  regressors(self.
+0000abe0: 6f75 745f 666f 6c64 6572 202b 2027 4750  out_folder + 'GP
+0000abf0: 5f6c 635f 7265 6772 6573 736f 7273 2e64  _lc_regressors.d
+0000ac00: 6174 272c 0a20 2020 2020 2020 2020 2020  at',.           
+0000ac10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ac20: 2020 2020 2020 2020 2020 7365 6c66 2e47            self.G
+0000ac30: 505f 6c63 5f61 7267 756d 656e 7473 290a  P_lc_arguments).
+0000ac40: 2020 2020 2020 2020 6966 2028 6e6f 7420          if (not 
+0000ac50: 6f73 2e70 6174 682e 6578 6973 7473 2873  os.path.exists(s
+0000ac60: 656c 662e 6f75 745f 666f 6c64 6572 202b  elf.out_folder +
+0000ac70: 2027 4750 5f72 765f 7265 6772 6573 736f   'GP_rv_regresso
+0000ac80: 7273 2e64 6174 2729 293a 0a20 2020 2020  rs.dat')):.     
+0000ac90: 2020 2020 2020 2069 6620 7365 6c66 2e47         if self.G
+0000aca0: 5072 7665 7061 7261 6d66 696c 6520 6973  Prveparamfile is
+0000acb0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0000acc0: 2020 2020 2020 2020 2020 206f 732e 7379             os.sy
+0000acd0: 7374 656d 2827 6370 2027 202b 2073 656c  stem('cp ' + sel
+0000ace0: 662e 4750 7276 6570 6172 616d 6669 6c65  f.GPrveparamfile
+0000acf0: 202b 2027 2027 202b 2073 656c 662e 6f75   + ' ' + self.ou
+0000ad00: 745f 666f 6c64 6572 202b 0a20 2020 2020  t_folder +.     
+0000ad10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ad20: 2020 2020 2027 4750 5f72 765f 7265 6772       'GP_rv_regr
+0000ad30: 6573 736f 7273 2e64 6174 2729 0a20 2020  essors.dat').   
+0000ad40: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
+0000ad50: 6c66 2e47 505f 7276 5f61 7267 756d 656e  lf.GP_rv_argumen
+0000ad60: 7473 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ts is not None:.
+0000ad70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ad80: 7365 6c66 2e73 6176 655f 7265 6772 6573  self.save_regres
+0000ad90: 736f 7273 2873 656c 662e 6f75 745f 666f  sors(self.out_fo
+0000ada0: 6c64 6572 202b 2027 4750 5f72 765f 7265  lder + 'GP_rv_re
+0000adb0: 6772 6573 736f 7273 2e64 6174 272c 0a20  gressors.dat',. 
+0000adc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000add0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ade0: 2020 2020 7365 6c66 2e47 505f 7276 5f61      self.GP_rv_a
+0000adf0: 7267 756d 656e 7473 290a 0a20 2020 2020  rguments)..     
+0000ae00: 2020 2023 2046 696e 616c 6c79 2c20 7361     # Finally, sa
+0000ae10: 7665 204c 4d20 7265 6772 6573 736f 7273  ve LM regressors
+0000ae20: 2069 6620 616e 793a 0a20 2020 2020 2020   if any:.       
+0000ae30: 2069 6620 286e 6f74 206f 732e 7061 7468   if (not os.path
+0000ae40: 2e65 7869 7374 7328 7365 6c66 2e6f 7574  .exists(self.out
+0000ae50: 5f66 6f6c 6465 7220 2b20 274c 4d5f 6c63  _folder + 'LM_lc
+0000ae60: 5f72 6567 7265 7373 6f72 732e 6461 7427  _regressors.dat'
+0000ae70: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+0000ae80: 6966 2073 656c 662e 4c4d 6c63 6570 6172  if self.LMlcepar
+0000ae90: 616d 6669 6c65 2069 7320 6e6f 7420 4e6f  amfile is not No
+0000aea0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000aeb0: 2020 2020 6f73 2e73 7973 7465 6d28 2763      os.system('c
+0000aec0: 7020 2720 2b20 7365 6c66 2e4c 4d6c 6365  p ' + self.LMlce
+0000aed0: 7061 7261 6d66 696c 6520 2b20 2720 2720  paramfile + ' ' 
+0000aee0: 2b20 7365 6c66 2e6f 7574 5f66 6f6c 6465  + self.out_folde
+0000aef0: 7220 2b0a 2020 2020 2020 2020 2020 2020  r +.            
+0000af00: 2020 2020 2020 2020 2020 2020 2020 274c                'L
+0000af10: 4d5f 6c63 5f72 6567 7265 7373 6f72 732e  M_lc_regressors.
+0000af20: 6461 7427 290a 2020 2020 2020 2020 2020  dat').          
+0000af30: 2020 656c 6966 2073 656c 662e 4c4d 5f6c    elif self.LM_l
+0000af40: 635f 6172 6775 6d65 6e74 7320 6973 206e  c_arguments is n
+0000af50: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0000af60: 2020 2020 2020 2020 2073 656c 662e 7361           self.sa
+0000af70: 7665 5f72 6567 7265 7373 6f72 7328 7365  ve_regressors(se
+0000af80: 6c66 2e6f 7574 5f66 6f6c 6465 7220 2b20  lf.out_folder + 
+0000af90: 274c 4d5f 6c63 5f72 6567 7265 7373 6f72  'LM_lc_regressor
+0000afa0: 732e 6461 7427 2c0a 2020 2020 2020 2020  s.dat',.        
+0000afb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000afc0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000afd0: 662e 4c4d 5f6c 635f 6172 6775 6d65 6e74  f.LM_lc_argument
+0000afe0: 7329 0a20 2020 2020 2020 2069 6620 286e  s).        if (n
+0000aff0: 6f74 206f 732e 7061 7468 2e65 7869 7374  ot os.path.exist
+0000b000: 7328 7365 6c66 2e6f 7574 5f66 6f6c 6465  s(self.out_folde
+0000b010: 7220 2b20 274c 4d5f 7276 5f72 6567 7265  r + 'LM_rv_regre
+0000b020: 7373 6f72 732e 6461 7427 2929 3a0a 2020  ssors.dat')):.  
+0000b030: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0000b040: 662e 4c4d 7276 6570 6172 616d 6669 6c65  f.LMrveparamfile
+0000b050: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0000b060: 2020 2020 2020 2020 2020 2020 2020 6f73                os
+0000b070: 2e73 7973 7465 6d28 2763 7020 2720 2b20  .system('cp ' + 
+0000b080: 7365 6c66 2e4c 4d72 7665 7061 7261 6d66  self.LMrveparamf
+0000b090: 696c 6520 2b20 2720 2720 2b20 7365 6c66  ile + ' ' + self
+0000b0a0: 2e6f 7574 5f66 6f6c 6465 7220 2b0a 2020  .out_folder +.  
+0000b0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b0c0: 2020 2020 2020 2020 274c 4d5f 7276 5f72          'LM_rv_r
+0000b0d0: 6567 7265 7373 6f72 732e 6461 7427 290a  egressors.dat').
+0000b0e0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0000b0f0: 2073 656c 662e 4c4d 5f72 765f 6172 6775   self.LM_rv_argu
+0000b100: 6d65 6e74 7320 6973 206e 6f74 204e 6f6e  ments is not Non
+0000b110: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000b120: 2020 2073 656c 662e 7361 7665 5f72 6567     self.save_reg
+0000b130: 7265 7373 6f72 7328 7365 6c66 2e6f 7574  ressors(self.out
+0000b140: 5f66 6f6c 6465 7220 2b20 274c 4d5f 7276  _folder + 'LM_rv
+0000b150: 5f72 6567 7265 7373 6f72 732e 6461 7427  _regressors.dat'
+0000b160: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000b170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b180: 2020 2020 2020 2073 656c 662e 4c4d 5f72         self.LM_r
+0000b190: 765f 6172 6775 6d65 6e74 7329 0a0a 2020  v_arguments)..  
+0000b1a0: 2020 2020 2020 2320 5361 7665 2070 7269        # Save pri
+0000b1b0: 6f72 733a 0a20 2020 2020 2020 2069 6620  ors:.        if 
+0000b1c0: 286e 6f74 206f 732e 7061 7468 2e65 7869  (not os.path.exi
+0000b1d0: 7374 7328 7365 6c66 2e6f 7574 5f66 6f6c  sts(self.out_fol
+0000b1e0: 6465 7220 2b20 2770 7269 6f72 732e 6461  der + 'priors.da
+0000b1f0: 7427 2929 3a0a 2020 2020 2020 2020 2020  t')):.          
+0000b200: 2020 7365 6c66 2e70 7269 6f72 5f66 6e61    self.prior_fna
+0000b210: 6d65 203d 2073 656c 662e 6f75 745f 666f  me = self.out_fo
+0000b220: 6c64 6572 202b 2027 7072 696f 7273 2e64  lder + 'priors.d
+0000b230: 6174 270a 2020 2020 2020 2020 2020 2020  at'.            
+0000b240: 7365 6c66 2e73 6176 655f 7072 696f 7266  self.save_priorf
+0000b250: 696c 6528 7365 6c66 2e6f 7574 5f66 6f6c  ile(self.out_fol
+0000b260: 6465 7220 2b20 2770 7269 6f72 732e 6461  der + 'priors.da
+0000b270: 7427 290a 0a20 2020 2064 6566 2066 6974  t')..    def fit
+0000b280: 2873 656c 662c 202a 2a6b 7761 7267 7329  (self, **kwargs)
+0000b290: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0000b2a0: 2020 2020 2020 5065 7268 6170 7320 7468        Perhaps th
+0000b2b0: 6520 6d6f 7374 2069 6d70 6f72 7461 6e74  e most important
+0000b2c0: 2066 756e 6374 696f 6e20 6f66 2074 6865   function of the
+0000b2d0: 206a 756c 6965 7420 6461 7461 206f 626a   juliet data obj
+0000b2e0: 6563 742e 2054 6869 7320 6675 6e63 7469  ect. This functi
+0000b2f0: 6f6e 2066 6974 7320 796f 7572 2064 6174  on fits your dat
+0000b300: 6120 7573 696e 6720 7468 6520 6e65 7374  a using the nest
+0000b310: 6564 0a20 2020 2020 2020 2073 616d 706c  ed.        sampl
+0000b320: 6572 206f 6620 6368 6f69 6365 2e20 5468  er of choice. Th
+0000b330: 6973 2072 6574 7572 6e73 2061 2072 6573  is returns a res
+0000b340: 756c 7473 206f 626a 6563 7420 7768 6963  ults object whic
+0000b350: 6820 636f 6e74 6169 6e73 2061 6c6c 2074  h contains all t
+0000b360: 6865 2070 6f73 7465 7269 6f72 7320 696e  he posteriors in
+0000b370: 666f 726d 6174 696f 6e2e 0a20 2020 2020  formation..     
+0000b380: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+0000b390: 204e 6f74 6520 7468 6973 2072 6574 7572   Note this retur
+0000b3a0: 6e20 6361 6c6c 2063 7265 6174 6573 2061  n call creates a
+0000b3b0: 2066 6974 202a 6f62 6a65 6374 2a20 7769   fit *object* wi
+0000b3c0: 7468 2074 6865 2063 7572 7265 6e74 2064  th the current d
+0000b3d0: 6174 6120 6f62 6a65 6374 2e20 5468 6520  ata object. The 
+0000b3e0: 6669 7420 636c 6173 7320 6465 6669 6e69  fit class defini
+0000b3f0: 7469 6f6e 2069 7320 6265 6c6f 772e 0a20  tion is below.. 
+0000b400: 2020 2020 2020 2072 6574 7572 6e20 6669         return fi
+0000b410: 7428 7365 6c66 2c20 2a2a 6b77 6172 6773  t(self, **kwargs
+0000b420: 290a 0a20 2020 2064 6566 205f 5f69 6e69  )..    def __ini
+0000b430: 745f 5f28 7365 6c66 2c70 7269 6f72 7320  t__(self,priors 
+0000b440: 3d20 4e6f 6e65 2c20 7374 6172 7469 6e67  = None, starting
+0000b450: 5f70 6f69 6e74 203d 204e 6f6e 652c 2069  _point = None, i
+0000b460: 6e70 7574 5f66 6f6c 6465 7220 3d20 4e6f  nput_folder = No
+0000b470: 6e65 2c20 745f 6c63 203d 204e 6f6e 652c  ne, t_lc = None,
+0000b480: 2079 5f6c 6320 3d20 4e6f 6e65 2c20 7965   y_lc = None, ye
+0000b490: 7272 5f6c 6320 3d20 4e6f 6e65 2c20 5c0a  rr_lc = None, \.
+0000b4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b4b0: 2074 5f72 7620 3d20 4e6f 6e65 2c20 795f   t_rv = None, y_
+0000b4c0: 7276 203d 204e 6f6e 652c 2079 6572 725f  rv = None, yerr_
+0000b4d0: 7276 203d 204e 6f6e 652c 2047 505f 7265  rv = None, GP_re
 0000b4e0: 6772 6573 736f 7273 5f6c 6320 3d20 4e6f  gressors_lc = No
-0000b4f0: 6e65 2c20 5c0a 2020 2020 2020 2020 2020  ne, \.          
-0000b500: 2020 2020 2020 2047 505f 7265 6772 6573         GP_regres
-0000b510: 736f 7273 5f72 7620 3d20 4e6f 6e65 2c20  sors_rv = None, 
-0000b520: 6c69 6e65 6172 5f72 6567 7265 7373 6f72  linear_regressor
-0000b530: 735f 7276 203d 204e 6f6e 652c 0a20 2020  s_rv = None,.   
-0000b540: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
-0000b550: 745f 666f 6c64 6572 203d 204e 6f6e 652c  t_folder = None,
-0000b560: 206c 6366 696c 656e 616d 6520 3d20 4e6f   lcfilename = No
-0000b570: 6e65 2c20 7276 6669 6c65 6e61 6d65 203d  ne, rvfilename =
-0000b580: 204e 6f6e 652c 2047 506c 6365 7061 7261   None, GPlcepara
-0000b590: 6d66 696c 6520 3d20 4e6f 6e65 2c5c 0a20  mfile = None,\. 
-0000b5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b5b0: 4750 7276 6570 6172 616d 6669 6c65 203d  GPrveparamfile =
-0000b5c0: 204e 6f6e 652c 204c 4d6c 6365 7061 7261   None, LMlcepara
-0000b5d0: 6d66 696c 6520 3d20 4e6f 6e65 2c20 4c4d  mfile = None, LM
-0000b5e0: 7276 6570 6172 616d 6669 6c65 203d 204e  rveparamfile = N
-0000b5f0: 6f6e 652c 206c 6374 696d 6564 6566 203d  one, lctimedef =
-0000b600: 2027 5444 4227 2c20 7276 7469 6d65 6465   'TDB', rvtimede
-0000b610: 6620 3d20 2755 5443 272c 5c0a 2020 2020  f = 'UTC',\.    
-0000b620: 2020 2020 2020 2020 2020 2020 206c 645f               ld_
-0000b630: 6c61 7773 203d 2027 7175 6164 7261 7469  laws = 'quadrati
-0000b640: 6327 2c20 7072 696f 7266 696c 6520 3d20  c', priorfile = 
-0000b650: 4e6f 6e65 2c20 6c63 5f6e 5f73 7570 6572  None, lc_n_super
-0000b660: 7361 6d70 203d 204e 6f6e 652c 206c 635f  samp = None, lc_
-0000b670: 6578 7074 696d 655f 7375 7065 7273 616d  exptime_supersam
-0000b680: 7020 3d20 4e6f 6e65 2c20 5c0a 2020 2020  p = None, \.    
-0000b690: 2020 2020 2020 2020 2020 2020 206c 635f               lc_
-0000b6a0: 696e 7374 7275 6d65 6e74 5f73 7570 6572  instrument_super
-0000b6b0: 7361 6d70 203d 204e 6f6e 652c 206d 6167  samp = None, mag
-0000b6c0: 5f74 6f5f 666c 7578 203d 2054 7275 652c  _to_flux = True,
-0000b6d0: 2076 6572 626f 7365 203d 2046 616c 7365   verbose = False
-0000b6e0: 2c20 6d61 7465 726e 5f65 7073 203d 2030  , matern_eps = 0
-0000b6f0: 2e30 312c 2067 656f 7267 655f 686f 646c  .01, george_hodl
-0000b700: 7220 3d20 5472 7565 2c20 5c0a 2020 2020  r = True, \.    
-0000b710: 2020 2020 2020 2020 2020 2020 2070 6963               pic
-0000b720: 6b6c 655f 656e 636f 6469 6e67 203d 204e  kle_encoding = N
-0000b730: 6f6e 6529 3a0a 0a20 2020 2020 2020 2073  one):..        s
-0000b740: 656c 662e 6c63 6669 6c65 6e61 6d65 203d  elf.lcfilename =
-0000b750: 206c 6366 696c 656e 616d 650a 2020 2020   lcfilename.    
-0000b760: 2020 2020 7365 6c66 2e72 7666 696c 656e      self.rvfilen
-0000b770: 616d 6520 3d20 7276 6669 6c65 6e61 6d65  ame = rvfilename
-0000b780: 0a20 2020 2020 2020 2073 656c 662e 4750  .        self.GP
-0000b790: 6c63 6570 6172 616d 6669 6c65 203d 2047  lceparamfile = G
-0000b7a0: 506c 6365 7061 7261 6d66 696c 650a 2020  Plceparamfile.  
-0000b7b0: 2020 2020 2020 7365 6c66 2e47 5072 7665        self.GPrve
-0000b7c0: 7061 7261 6d66 696c 6520 3d20 4750 7276  paramfile = GPrv
-0000b7d0: 6570 6172 616d 6669 6c65 0a20 2020 2020  eparamfile.     
-0000b7e0: 2020 2073 656c 662e 4c4d 6c63 6570 6172     self.LMlcepar
-0000b7f0: 616d 6669 6c65 203d 204c 4d6c 6365 7061  amfile = LMlcepa
-0000b800: 7261 6d66 696c 650a 2020 2020 2020 2020  ramfile.        
-0000b810: 7365 6c66 2e4c 4d72 7665 7061 7261 6d66  self.LMrveparamf
-0000b820: 696c 6520 3d20 4c4d 7276 6570 6172 616d  ile = LMrveparam
-0000b830: 6669 6c65 0a20 2020 2020 2020 2073 656c  file.        sel
-0000b840: 662e 7665 7262 6f73 6520 3d20 7665 7262  f.verbose = verb
-0000b850: 6f73 650a 2020 2020 2020 2020 7365 6c66  ose.        self
-0000b860: 2e70 6963 6b6c 655f 656e 636f 6469 6e67  .pickle_encoding
-0000b870: 203d 2070 6963 6b6c 655f 656e 636f 6469   = pickle_encodi
-0000b880: 6e67 0a20 2020 2020 2020 2073 656c 662e  ng.        self.
-0000b890: 7374 6172 7469 6e67 5f70 6f69 6e74 203d  starting_point =
-0000b8a0: 2073 7461 7274 696e 675f 706f 696e 740a   starting_point.
-0000b8b0: 0a20 2020 2020 2020 2023 2047 5020 6f70  .        # GP op
-0000b8c0: 7469 6f6e 733a 0a20 2020 2020 2020 2073  tions:.        s
-0000b8d0: 656c 662e 6d61 7465 726e 5f65 7073 203d  elf.matern_eps =
-0000b8e0: 206d 6174 6572 6e5f 6570 7320 2023 2045   matern_eps  # E
-0000b8f0: 7073 696c 6f6e 2070 6172 616d 6574 6572  psilon parameter
-0000b900: 2066 6f72 2063 656c 6572 6974 6520 4d61   for celerite Ma
-0000b910: 7465 726e 3332 5465 726d 0a20 2020 2020  tern32Term.     
-0000b920: 2020 2073 656c 662e 6765 6f72 6765 5f68     self.george_h
-0000b930: 6f64 6c72 203d 2067 656f 7267 655f 686f  odlr = george_ho
-0000b940: 646c 7220 2320 5768 6574 6572 2074 6f20  dlr # Wheter to 
-0000b950: 7573 6520 484f 444c 5220 736f 6c76 6572  use HODLR solver
-0000b960: 206f 7220 6e6f 7420 2873 6565 3a20 6874   or not (see: ht
-0000b970: 7470 3a2f 2f64 666d 2e69 6f2f 6765 6f72  tp://dfm.io/geor
-0000b980: 6765 2f63 7572 7265 6e74 2f75 7365 722f  ge/current/user/
-0000b990: 736f 6c76 6572 732f 290a 0a20 2020 2020  solvers/)..     
-0000b9a0: 2020 2023 2049 6e69 7469 616c 697a 6520     # Initialize 
-0000b9b0: 6461 7461 206f 7074 696f 6e73 2066 6f72  data options for
-0000b9c0: 206c 6967 6874 6375 7276 6573 3a0a 2020   lightcurves:.  
-0000b9d0: 2020 2020 2020 7365 6c66 2e74 5f6c 6320        self.t_lc 
-0000b9e0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
-0000b9f0: 656c 662e 795f 6c63 203d 204e 6f6e 650a  elf.y_lc = None.
-0000ba00: 2020 2020 2020 2020 7365 6c66 2e79 6572          self.yer
-0000ba10: 725f 6c63 203d 204e 6f6e 650a 2020 2020  r_lc = None.    
-0000ba20: 2020 2020 7365 6c66 2e69 6e73 7472 756d      self.instrum
-0000ba30: 656e 7473 5f6c 6320 3d20 4e6f 6e65 0a20  ents_lc = None. 
-0000ba40: 2020 2020 2020 2073 656c 662e 6e69 6e73         self.nins
-0000ba50: 7472 756d 656e 7473 5f6c 6320 3d20 4e6f  truments_lc = No
-0000ba60: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
-0000ba70: 696e 616d 6573 5f6c 6320 3d20 4e6f 6e65  inames_lc = None
-0000ba80: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
-0000ba90: 7374 7275 6d65 6e74 5f69 6e64 6578 6573  strument_indexes
-0000baa0: 5f6c 6320 3d20 4e6f 6e65 0a20 2020 2020  _lc = None.     
-0000bab0: 2020 2073 656c 662e 6c6d 5f6c 635f 626f     self.lm_lc_bo
-0000bac0: 6f6c 6561 6e20 3d20 4e6f 6e65 0a20 2020  olean = None.   
-0000bad0: 2020 2020 2073 656c 662e 6c6d 5f6c 635f       self.lm_lc_
-0000bae0: 6172 6775 6d65 6e74 7320 3d20 4e6f 6e65  arguments = None
-0000baf0: 0a20 2020 2020 2020 2073 656c 662e 4750  .        self.GP
-0000bb00: 5f6c 635f 6172 6775 6d65 6e74 7320 3d20  _lc_arguments = 
-0000bb10: 4e6f 6e65 0a20 2020 2020 2020 2073 656c  None.        sel
-0000bb20: 662e 4c4d 5f6c 635f 6172 6775 6d65 6e74  f.LM_lc_argument
-0000bb30: 7320 3d20 4e6f 6e65 0a20 2020 2020 2020  s = None.       
-0000bb40: 2073 656c 662e 6c63 7469 6d65 6465 6620   self.lctimedef 
-0000bb50: 3d20 6c63 7469 6d65 6465 660a 2020 2020  = lctimedef.    
-0000bb60: 2020 2020 7365 6c66 2e6c 645f 6c61 7773      self.ld_laws
-0000bb70: 203d 206c 645f 6c61 7773 0a20 2020 2020   = ld_laws.     
-0000bb80: 2020 2073 656c 662e 6c63 5f6e 5f73 7570     self.lc_n_sup
-0000bb90: 6572 7361 6d70 203d 206c 635f 6e5f 7375  ersamp = lc_n_su
-0000bba0: 7065 7273 616d 700a 2020 2020 2020 2020  persamp.        
-0000bbb0: 7365 6c66 2e6c 635f 6578 7074 696d 655f  self.lc_exptime_
-0000bbc0: 7375 7065 7273 616d 7020 3d20 6c63 5f65  supersamp = lc_e
-0000bbd0: 7870 7469 6d65 5f73 7570 6572 7361 6d70  xptime_supersamp
-0000bbe0: 0a20 2020 2020 2020 2073 656c 662e 6c63  .        self.lc
-0000bbf0: 5f69 6e73 7472 756d 656e 745f 7375 7065  _instrument_supe
-0000bc00: 7273 616d 7020 3d20 6c63 5f69 6e73 7472  rsamp = lc_instr
-0000bc10: 756d 656e 745f 7375 7065 7273 616d 700a  ument_supersamp.
-0000bc20: 2020 2020 2020 2020 7365 6c66 2e6c 635f          self.lc_
-0000bc30: 6461 7461 203d 2046 616c 7365 0a20 2020  data = False.   
-0000bc40: 2020 2020 2073 656c 662e 676c 6f62 616c       self.global
-0000bc50: 5f6c 635f 6d6f 6465 6c20 3d20 4661 6c73  _lc_model = Fals
-0000bc60: 650a 2020 2020 2020 2020 7365 6c66 2e6c  e.        self.l
-0000bc70: 635f 6f70 7469 6f6e 7320 3d20 7b7d 0a0a  c_options = {}..
-0000bc80: 2020 2020 2020 2020 2320 496e 6974 6961          # Initia
-0000bc90: 6c69 7a65 2064 6174 6120 6f70 7469 6f6e  lize data option
-0000bca0: 7320 666f 7220 5256 733a 0a20 2020 2020  s for RVs:.     
-0000bcb0: 2020 2073 656c 662e 745f 7276 203d 204e     self.t_rv = N
-0000bcc0: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
-0000bcd0: 2e79 5f72 7620 3d20 4e6f 6e65 0a20 2020  .y_rv = None.   
-0000bce0: 2020 2020 2073 656c 662e 7965 7272 5f72       self.yerr_r
-0000bcf0: 7620 3d20 4e6f 6e65 0a20 2020 2020 2020  v = None.       
-0000bd00: 2073 656c 662e 696e 7374 7275 6d65 6e74   self.instrument
-0000bd10: 735f 7276 203d 204e 6f6e 650a 2020 2020  s_rv = None.    
-0000bd20: 2020 2020 7365 6c66 2e6e 696e 7374 7275      self.ninstru
-0000bd30: 6d65 6e74 735f 7276 203d 204e 6f6e 650a  ments_rv = None.
-0000bd40: 2020 2020 2020 2020 7365 6c66 2e69 6e61          self.ina
-0000bd50: 6d65 735f 7276 203d 204e 6f6e 650a 2020  mes_rv = None.  
-0000bd60: 2020 2020 2020 7365 6c66 2e69 6e73 7472        self.instr
-0000bd70: 756d 656e 745f 696e 6465 7865 735f 7276  ument_indexes_rv
-0000bd80: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-0000bd90: 7365 6c66 2e6c 6d5f 7276 5f62 6f6f 6c65  self.lm_rv_boole
-0000bda0: 616e 203d 204e 6f6e 650a 2020 2020 2020  an = None.      
-0000bdb0: 2020 7365 6c66 2e6c 6d5f 7276 5f61 7267    self.lm_rv_arg
-0000bdc0: 756d 656e 7473 203d 204e 6f6e 650a 2020  uments = None.  
-0000bdd0: 2020 2020 2020 7365 6c66 2e47 505f 7276        self.GP_rv
-0000bde0: 5f61 7267 756d 656e 7473 203d 204e 6f6e  _arguments = Non
-0000bdf0: 650a 2020 2020 2020 2020 7365 6c66 2e4c  e.        self.L
-0000be00: 4d5f 7276 5f61 7267 756d 656e 7473 203d  M_rv_arguments =
-0000be10: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
-0000be20: 6c66 2e72 7674 696d 6564 6566 203d 2072  lf.rvtimedef = r
-0000be30: 7674 696d 6564 6566 0a20 2020 2020 2020  vtimedef.       
-0000be40: 2073 656c 662e 7276 5f64 6174 6120 3d20   self.rv_data = 
-0000be50: 4661 6c73 650a 2020 2020 2020 2020 7365  False.        se
-0000be60: 6c66 2e67 6c6f 6261 6c5f 7276 5f6d 6f64  lf.global_rv_mod
-0000be70: 656c 203d 2046 616c 7365 0a20 2020 2020  el = False.     
-0000be80: 2020 2073 656c 662e 7276 5f6f 7074 696f     self.rv_optio
-0000be90: 6e73 203d 207b 7d0a 0a20 2020 2020 2020  ns = {}..       
-0000bea0: 2073 656c 662e 6f75 745f 666f 6c64 6572   self.out_folder
-0000beb0: 203d 204e 6f6e 650a 0a20 2020 2020 2020   = None..       
-0000bec0: 2069 6620 696e 7075 745f 666f 6c64 6572   if input_folder
-0000bed0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0000bee0: 2020 2020 2020 2020 2020 6966 2069 6e70            if inp
-0000bef0: 7574 5f66 6f6c 6465 725b 2d31 5d20 213d  ut_folder[-1] !=
-0000bf00: 2027 2f27 3a0a 2020 2020 2020 2020 2020   '/':.          
-0000bf10: 2020 2020 2020 7365 6c66 2e69 6e70 7574        self.input
-0000bf20: 5f66 6f6c 6465 7220 3d20 696e 7075 745f  _folder = input_
-0000bf30: 666f 6c64 6572 202b 2027 2f27 0a20 2020  folder + '/'.   
-0000bf40: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0000bf50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000bf60: 656c 662e 696e 7075 745f 666f 6c64 6572  elf.input_folder
-0000bf70: 203d 2069 6e70 7574 5f66 6f6c 6465 720a   = input_folder.
-0000bf80: 2020 2020 2020 2020 2020 2020 6966 206f              if o
-0000bf90: 732e 7061 7468 2e65 7869 7374 7328 7365  s.path.exists(se
-0000bfa0: 6c66 2e69 6e70 7574 5f66 6f6c 6465 7220  lf.input_folder 
-0000bfb0: 2b20 276c 632e 6461 7427 293a 0a20 2020  + 'lc.dat'):.   
-0000bfc0: 2020 2020 2020 2020 2020 2020 206c 6366               lcf
-0000bfd0: 696c 656e 616d 6520 3d20 7365 6c66 2e69  ilename = self.i
-0000bfe0: 6e70 7574 5f66 6f6c 6465 7220 2b20 276c  nput_folder + 'l
-0000bff0: 632e 6461 7427 0a20 2020 2020 2020 2020  c.dat'.         
-0000c000: 2020 2069 6620 6f73 2e70 6174 682e 6578     if os.path.ex
-0000c010: 6973 7473 2873 656c 662e 696e 7075 745f  ists(self.input_
-0000c020: 666f 6c64 6572 202b 2027 7276 732e 6461  folder + 'rvs.da
-0000c030: 7427 293a 0a20 2020 2020 2020 2020 2020  t'):.           
-0000c040: 2020 2020 2072 7666 696c 656e 616d 6520       rvfilename 
-0000c050: 3d20 7365 6c66 2e69 6e70 7574 5f66 6f6c  = self.input_fol
-0000c060: 6465 7220 2b20 2772 7673 2e64 6174 270a  der + 'rvs.dat'.
-0000c070: 2020 2020 2020 2020 2020 2020 6966 2028              if (
-0000c080: 6e6f 7420 6f73 2e70 6174 682e 6578 6973  not os.path.exis
-0000c090: 7473 2873 656c 662e 696e 7075 745f 666f  ts(self.input_fo
-0000c0a0: 6c64 6572 202b 2027 6c63 2e64 6174 2729  lder + 'lc.dat')
-0000c0b0: 2920 616e 6420 280a 2020 2020 2020 2020  ) and (.        
-0000c0c0: 2020 2020 2020 2020 2020 2020 6e6f 7420              not 
-0000c0d0: 6f73 2e70 6174 682e 6578 6973 7473 2873  os.path.exists(s
-0000c0e0: 656c 662e 696e 7075 745f 666f 6c64 6572  elf.input_folder
-0000c0f0: 202b 2027 7276 732e 6461 7427 2929 3a0a   + 'rvs.dat')):.
-0000c100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c110: 7261 6973 6520 4578 6365 7074 696f 6e28  raise Exception(
-0000c120: 2749 4e50 5554 2045 5252 4f52 3a20 4e6f  'INPUT ERROR: No
-0000c130: 206c 6967 6874 6375 7276 6520 6461 7461   lightcurve data
-0000c140: 2066 696c 6520 286c 632e 6461 7429 206f   file (lc.dat) o
-0000c150: 7220 7261 6469 616c 2d76 656c 6f63 6974  r radial-velocit
-0000c160: 7920 6461 7461 2066 696c 6520 2872 7673  y data file (rvs
-0000c170: 2e64 6174 2920 666f 756e 6420 696e 2066  .dat) found in f
-0000c180: 6f6c 6465 7220 272b 7365 6c66 2e69 6e70  older '+self.inp
-0000c190: 7574 5f66 6f6c 6465 722b 5c0a 2020 2020  ut_folder+\.    
-0000c1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c1b0: 2020 2020 2020 2020 2020 2020 272e 205c              '. \
-0000c1c0: 6e20 4372 6561 7465 2074 6865 6d20 616e  n Create them an
-0000c1d0: 6420 7472 7920 6167 6169 6e2e 2046 6f72  d try again. For
-0000c1e0: 2064 6574 6169 6c73 2c20 6368 6563 6b20   details, check 
-0000c1f0: 6a75 6c69 6574 2e6c 6f61 643f 2729 0a20  juliet.load?'). 
-0000c200: 2020 2020 2020 2020 2020 2069 6620 6f73             if os
-0000c210: 2e70 6174 682e 6578 6973 7473 2873 656c  .path.exists(sel
-0000c220: 662e 696e 7075 745f 666f 6c64 6572 202b  f.input_folder +
-0000c230: 2027 4750 5f6c 635f 7265 6772 6573 736f   'GP_lc_regresso
-0000c240: 7273 2e64 6174 2729 3a0a 2020 2020 2020  rs.dat'):.      
-0000c250: 2020 2020 2020 2020 2020 4750 6c63 6570            GPlcep
-0000c260: 6172 616d 6669 6c65 203d 2073 656c 662e  aramfile = self.
-0000c270: 696e 7075 745f 666f 6c64 6572 202b 2027  input_folder + '
-0000c280: 4750 5f6c 635f 7265 6772 6573 736f 7273  GP_lc_regressors
-0000c290: 2e64 6174 270a 2020 2020 2020 2020 2020  .dat'.          
-0000c2a0: 2020 6966 206f 732e 7061 7468 2e65 7869    if os.path.exi
-0000c2b0: 7374 7328 7365 6c66 2e69 6e70 7574 5f66  sts(self.input_f
-0000c2c0: 6f6c 6465 7220 2b20 2747 505f 7276 5f72  older + 'GP_rv_r
-0000c2d0: 6567 7265 7373 6f72 732e 6461 7427 293a  egressors.dat'):
-0000c2e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c2f0: 2047 5072 7665 7061 7261 6d66 696c 6520   GPrveparamfile 
-0000c300: 3d20 7365 6c66 2e69 6e70 7574 5f66 6f6c  = self.input_fol
-0000c310: 6465 7220 2b20 2747 505f 7276 5f72 6567  der + 'GP_rv_reg
-0000c320: 7265 7373 6f72 732e 6461 7427 0a20 2020  ressors.dat'.   
-0000c330: 2020 2020 2020 2020 2069 6620 6f73 2e70           if os.p
-0000c340: 6174 682e 6578 6973 7473 2873 656c 662e  ath.exists(self.
-0000c350: 696e 7075 745f 666f 6c64 6572 202b 2027  input_folder + '
-0000c360: 4c4d 5f6c 635f 7265 6772 6573 736f 7273  LM_lc_regressors
-0000c370: 2e64 6174 2729 3a0a 2020 2020 2020 2020  .dat'):.        
-0000c380: 2020 2020 2020 2020 4c4d 6c63 6570 6172          LMlcepar
-0000c390: 616d 6669 6c65 203d 2073 656c 662e 696e  amfile = self.in
-0000c3a0: 7075 745f 666f 6c64 6572 202b 2027 4c4d  put_folder + 'LM
-0000c3b0: 5f6c 635f 7265 6772 6573 736f 7273 2e64  _lc_regressors.d
-0000c3c0: 6174 270a 2020 2020 2020 2020 2020 2020  at'.            
-0000c3d0: 6966 206f 732e 7061 7468 2e65 7869 7374  if os.path.exist
-0000c3e0: 7328 7365 6c66 2e69 6e70 7574 5f66 6f6c  s(self.input_fol
-0000c3f0: 6465 7220 2b20 274c 4d5f 7276 5f72 6567  der + 'LM_rv_reg
-0000c400: 7265 7373 6f72 732e 6461 7427 293a 0a20  ressors.dat'):. 
-0000c410: 2020 2020 2020 2020 2020 2020 2020 204c                 L
-0000c420: 4d72 7665 7061 7261 6d66 696c 6520 3d20  Mrveparamfile = 
-0000c430: 7365 6c66 2e69 6e70 7574 5f66 6f6c 6465  self.input_folde
-0000c440: 7220 2b20 274c 4d5f 7276 5f72 6567 7265  r + 'LM_rv_regre
-0000c450: 7373 6f72 732e 6461 7427 0a20 2020 2020  ssors.dat'.     
-0000c460: 2020 2020 2020 2069 6620 6f73 2e70 6174         if os.pat
-0000c470: 682e 6578 6973 7473 2873 656c 662e 696e  h.exists(self.in
-0000c480: 7075 745f 666f 6c64 6572 202b 2027 7072  put_folder + 'pr
-0000c490: 696f 7273 2e64 6174 2729 3a0a 2020 2020  iors.dat'):.    
-0000c4a0: 2020 2020 2020 2020 2020 2020 7072 696f              prio
-0000c4b0: 7273 203d 2073 656c 662e 696e 7075 745f  rs = self.input_
-0000c4c0: 666f 6c64 6572 202b 2027 7072 696f 7273  folder + 'priors
-0000c4d0: 2e64 6174 270a 2020 2020 2020 2020 2020  .dat'.          
-0000c4e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000c4f0: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
-0000c500: 6365 7074 696f 6e28 2749 4e50 5554 2045  ception('INPUT E
-0000c510: 5252 4f52 3a20 5072 696f 7220 6669 6c65  RROR: Prior file
-0000c520: 2028 7072 696f 7273 2e64 6174 2920 6e6f   (priors.dat) no
-0000c530: 7420 666f 756e 6420 696e 2066 6f6c 6465  t found in folde
-0000c540: 7220 272b 7365 6c66 2e69 6e70 7574 5f66  r '+self.input_f
-0000c550: 6f6c 6465 722b 272e 272b 5c0a 2020 2020  older+'.'+\.    
-0000c560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c570: 2020 2020 2020 2020 2020 2020 2743 7265              'Cre
-0000c580: 6174 6520 6974 2061 6e64 2074 7279 2061  ate it and try a
-0000c590: 6761 696e 2e20 466f 7220 6465 7461 696c  gain. For detail
-0000c5a0: 732c 2063 6865 636b 206a 756c 6965 742e  s, check juliet.
-0000c5b0: 6c6f 6164 3f27 290a 2020 2020 2020 2020  load?').        
-0000c5c0: 2020 2020 2320 4966 2074 6865 7265 2069      # If there i
-0000c5d0: 7320 616e 2069 6e70 7574 2066 6f6c 6465  s an input folde
-0000c5e0: 7220 616e 6420 6e6f 206f 7574 5f66 6f6c  r and no out_fol
-0000c5f0: 6465 722c 2074 6865 6e20 7369 6d70 6c79  der, then simply
-0000c600: 2073 6574 2074 6865 206f 7574 5f66 6f6c   set the out_fol
-0000c610: 6465 7220 6173 2074 6865 2069 6e70 7574  der as the input
-0000c620: 5f66 6f6c 6465 720a 2020 2020 2020 2020  _folder.        
-0000c630: 2020 2020 2320 666f 7220 6561 7365 2069      # for ease i
-0000c640: 6e20 7468 6520 6c61 7465 7220 6675 6e63  n the later func
-0000c650: 7469 6f6e 7320 286d 6f72 6520 666f 7220  tions (more for 
-0000c660: 7265 706c 6f74 7469 6e67 2070 7572 706f  replotting purpo
-0000c670: 7365 7329 0a20 2020 2020 2020 2020 2020  ses).           
-0000c680: 2023 2053 6f2c 206f 6e65 2063 616e 2073   # So, one can s
-0000c690: 696d 706c 7920 646f 2074 6869 7320 746f  imply do this to
-0000c6a0: 206f 6274 6169 6e20 7468 6520 706f 7374   obtain the post
-0000c6b0: 6572 696f 7273 3a0a 2020 2020 2020 2020  eriors:.        
-0000c6c0: 2020 2020 2320 3e20 6461 7461 7365 7420      # > dataset 
-0000c6d0: 3d20 6a75 6c69 6574 2e6c 6f61 6428 696e  = juliet.load(in
-0000c6e0: 7075 745f 666f 6c64 6572 3d66 6f6c 6465  put_folder=folde
-0000c6f0: 7229 2023 2074 6f20 7265 6c6f 6164 2074  r) # to reload t
-0000c700: 6865 2070 7269 6f72 732c 2064 6174 612c  he priors, data,
-0000c710: 2065 7463 2e0a 2020 2020 2020 2020 2020   etc..          
-0000c720: 2020 2320 3e20 7265 7375 6c74 7320 3d20    # > results = 
-0000c730: 6461 7461 7365 742e 6669 7428 2920 2320  dataset.fit() # 
-0000c740: 746f 206f 6274 6169 6e20 7468 6520 7265  to obtain the re
-0000c750: 7375 6c74 7320 616c 7265 6164 7920 666f  sults already fo
-0000c760: 756e 6420 696e 2074 6865 2069 6e70 7574  und in the input
-0000c770: 5f66 6f6c 6465 720a 2020 2020 2020 2020  _folder.        
-0000c780: 2020 2020 2320 3e20 706f 7374 6572 696f      # > posterio
-0000c790: 7273 203d 2072 6573 756c 7473 2e70 6f73  rs = results.pos
-0000c7a0: 7465 7269 6f72 730a 2020 2020 2020 2020  teriors.        
-0000c7b0: 2020 2020 6966 206f 7574 5f66 6f6c 6465      if out_folde
-0000c7c0: 7220 6973 204e 6f6e 653a 0a20 2020 2020  r is None:.     
-0000c7d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000c7e0: 6f75 745f 666f 6c64 6572 203d 2073 656c  out_folder = sel
-0000c7f0: 662e 696e 7075 745f 666f 6c64 6572 0a20  f.input_folder. 
-0000c800: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000c810: 2020 2020 2020 2020 2073 656c 662e 696e           self.in
-0000c820: 7075 745f 666f 6c64 6572 203d 204e 6f6e  put_folder = Non
-0000c830: 650a 0a20 2020 2020 2020 2069 6620 7479  e..        if ty
-0000c840: 7065 2870 7269 6f72 7329 203d 3d20 7374  pe(priors) == st
-0000c850: 723a 0a0a 2020 2020 2020 2020 2020 2073  r:..           s
-0000c860: 656c 662e 7072 696f 725f 666e 616d 6520  elf.prior_fname 
-0000c870: 3d20 7072 696f 7273 0a20 2020 2020 2020  = priors.       
-0000c880: 2020 2020 7072 696f 7273 2c20 6e5f 7472      priors, n_tr
-0000c890: 616e 7369 742c 206e 5f72 762c 206e 756d  ansit, n_rv, num
-0000c8a0: 6265 7269 6e67 5f74 7261 6e73 6974 2c20  bering_transit, 
-0000c8b0: 6e75 6d62 6572 696e 675f 7276 2c20 6e5f  numbering_rv, n_
-0000c8c0: 7061 7261 6d73 2c20 7374 6172 7469 6e67  params, starting
-0000c8d0: 5f70 6f69 6e74 203d 2072 6561 6470 7269  _point = readpri
-0000c8e0: 6f72 7328 7072 696f 7273 290a 2020 2020  ors(priors).    
-0000c8f0: 2020 2020 2020 2023 2053 6176 6520 696e         # Save in
-0000c900: 666f 726d 6174 696f 6e20 7374 6f72 6564  formation stored
-0000c910: 2069 6e20 7468 6520 7072 696f 723a 2074   in the prior: t
-0000c920: 6865 2064 6963 7469 6f6e 6172 792c 206e  he dictionary, n
-0000c930: 756d 6265 7220 6f66 2074 7261 6e73 6974  umber of transit
-0000c940: 696e 6720 706c 616e 6574 732c 0a20 2020  ing planets,.   
-0000c950: 2020 2020 2020 2020 2320 6e75 6d62 6572          # number
-0000c960: 206f 6620 5256 2070 6c61 6e65 7473 2c20   of RV planets, 
-0000c970: 6e75 6d62 6572 696e 6720 6f66 2074 7261  numbering of tra
-0000c980: 6e73 6974 696e 6720 616e 6420 7276 2070  nsiting and rv p
-0000c990: 6c61 6e65 7473 2028 652e 672e 2c20 6966  lanets (e.g., if
-0000c9a0: 2070 3120 616e 6420 7033 2074 7261 6e73   p1 and p3 trans
-0000c9b0: 6974 0a20 2020 2020 2020 2020 2020 2320  it.           # 
-0000c9c0: 616e 6420 616c 6c20 6f66 2074 6865 6d20  and all of them 
-0000c9d0: 6172 6520 5256 2070 6c61 6e65 7473 2c20  are RV planets, 
-0000c9e0: 6e75 6d62 6572 696e 675f 7472 616e 7369  numbering_transi
-0000c9f0: 7420 3d20 5b31 2c33 5d20 616e 6420 6e75  t = [1,3] and nu
-0000ca00: 6d62 6572 696e 675f 7276 203d 205b 312c  mbering_rv = [1,
-0000ca10: 322c 335d 292e 0a20 2020 2020 2020 2020  2,3])..         
-0000ca20: 2020 2320 5361 7665 2061 6c73 6f20 6e75    # Save also nu
-0000ca30: 6d62 6572 206f 6620 2a66 7265 652a 2070  mber of *free* p
-0000ca40: 6172 616d 6574 6572 7320 2846 4958 4544  arameters (FIXED
-0000ca50: 2064 6f6e 2774 2063 6f75 6e74 2068 6572   don't count her
-0000ca60: 6529 2e0a 2020 2020 2020 2020 2020 2073  e)..           s
-0000ca70: 656c 662e 7072 696f 7273 203d 2070 7269  elf.priors = pri
-0000ca80: 6f72 730a 2020 2020 2020 2020 2020 2073  ors.           s
-0000ca90: 656c 662e 6e5f 7472 616e 7369 7469 6e67  elf.n_transiting
-0000caa0: 5f70 6c61 6e65 7473 203d 206e 5f74 7261  _planets = n_tra
-0000cab0: 6e73 6974 0a20 2020 2020 2020 2020 2020  nsit.           
-0000cac0: 7365 6c66 2e6e 5f72 765f 706c 616e 6574  self.n_rv_planet
-0000cad0: 7320 3d20 6e5f 7276 0a20 2020 2020 2020  s = n_rv.       
-0000cae0: 2020 2020 7365 6c66 2e6e 756d 6265 7269      self.numberi
-0000caf0: 6e67 5f74 7261 6e73 6974 696e 675f 706c  ng_transiting_pl
-0000cb00: 616e 6574 7320 3d20 6e75 6d62 6572 696e  anets = numberin
-0000cb10: 675f 7472 616e 7369 740a 2020 2020 2020  g_transit.      
-0000cb20: 2020 2020 2073 656c 662e 6e75 6d62 6572       self.number
-0000cb30: 696e 675f 7276 5f70 6c61 6e65 7473 203d  ing_rv_planets =
-0000cb40: 206e 756d 6265 7269 6e67 5f72 760a 2020   numbering_rv.  
-0000cb50: 2020 2020 2020 2020 2073 656c 662e 6e70           self.np
-0000cb60: 6172 616d 7320 3d20 6e5f 7061 7261 6d73  arams = n_params
-0000cb70: 0a20 2020 2020 2020 2020 2020 7365 6c66  .           self
-0000cb80: 2e73 7461 7274 696e 675f 706f 696e 7420  .starting_point 
-0000cb90: 3d20 7374 6172 7469 6e67 5f70 6f69 6e74  = starting_point
-0000cba0: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
-0000cbb0: 2020 2020 2020 656c 6966 2074 7970 6528        elif type(
-0000cbc0: 7072 696f 7273 2920 3d3d 2064 6963 743a  priors) == dict:
-0000cbd0: 0a20 2020 2020 2020 2020 2020 2023 2044  .            # D
-0000cbe0: 6963 7469 6f6e 6172 7920 7761 7320 7061  ictionary was pa
-0000cbf0: 7373 6564 2c20 736f 2073 6176 6520 6974  ssed, so save it
-0000cc00: 2e0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0000cc10: 6c66 2e70 7269 6f72 7320 3d20 7072 696f  lf.priors = prio
-0000cc20: 7273 0a20 2020 2020 2020 2020 2020 2023  rs.            #
-0000cc30: 2045 7874 7261 6374 2073 616d 6520 696e   Extract same in
-0000cc40: 666f 2061 7320 6162 6f76 6520 6966 2d73  fo as above if-s
-0000cc50: 7461 7465 6d65 6e74 2062 7574 2075 7369  tatement but usi
-0000cc60: 6e67 206f 6e6c 7920 7468 6520 6469 6374  ng only the dict
-0000cc70: 696f 6e61 7279 3a0a 2020 2020 2020 2020  ionary:.        
-0000cc80: 2020 2020 6e5f 7472 616e 7369 742c 206e      n_transit, n
-0000cc90: 5f72 762c 206e 756d 6265 7269 6e67 5f74  _rv, numbering_t
-0000cca0: 7261 6e73 6974 2c20 6e75 6d62 6572 696e  ransit, numberin
-0000ccb0: 675f 7276 2c20 6e5f 7061 7261 6d73 203d  g_rv, n_params =
-0000ccc0: 2072 6561 6470 7269 6f72 7328 0a20 2020   readpriors(.   
-0000ccd0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0000cce0: 6f72 7329 0a20 2020 2020 2020 2020 2020  ors).           
-0000ccf0: 2023 2053 6176 6520 696e 666f 726d 6174   # Save informat
-0000cd00: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
-0000cd10: 2073 656c 662e 6e5f 7472 616e 7369 7469   self.n_transiti
-0000cd20: 6e67 5f70 6c61 6e65 7473 203d 206e 5f74  ng_planets = n_t
-0000cd30: 7261 6e73 6974 0a20 2020 2020 2020 2020  ransit.         
-0000cd40: 2020 2073 656c 662e 6e5f 7276 5f70 6c61     self.n_rv_pla
-0000cd50: 6e65 7473 203d 206e 5f72 760a 2020 2020  nets = n_rv.    
-0000cd60: 2020 2020 2020 2020 7365 6c66 2e6e 756d          self.num
-0000cd70: 6265 7269 6e67 5f74 7261 6e73 6974 696e  bering_transitin
-0000cd80: 675f 706c 616e 6574 7320 3d20 6e75 6d62  g_planets = numb
-0000cd90: 6572 696e 675f 7472 616e 7369 740a 2020  ering_transit.  
-0000cda0: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
-0000cdb0: 756d 6265 7269 6e67 5f72 765f 706c 616e  umbering_rv_plan
-0000cdc0: 6574 7320 3d20 6e75 6d62 6572 696e 675f  ets = numbering_
-0000cdd0: 7276 0a20 2020 2020 2020 2020 2020 2073  rv.            s
-0000cde0: 656c 662e 6e70 6172 616d 7320 3d20 6e5f  elf.nparams = n_
-0000cdf0: 7061 7261 6d73 0a20 2020 2020 2020 2020  params.         
-0000ce00: 2020 2073 656c 662e 7072 696f 725f 666e     self.prior_fn
-0000ce10: 616d 6520 3d20 4e6f 6e65 0a20 2020 2020  ame = None.     
-0000ce20: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000ce30: 2020 2020 2072 6169 7365 2045 7863 6570       raise Excep
-0000ce40: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-0000ce50: 2020 2020 2020 2749 4e50 5554 2045 5252        'INPUT ERR
-0000ce60: 4f52 3a20 5072 696f 7220 6669 6c65 2069  OR: Prior file i
-0000ce70: 7320 6e6f 7420 6120 7374 7269 6e67 206f  s not a string o
-0000ce80: 7220 6120 6469 6374 696f 6e61 7279 2028  r a dictionary (
-0000ce90: 616e 6420 6974 2068 6173 2074 6f29 2e20  and it has to). 
-0000cea0: 446f 206a 756c 6965 742e 6c6f 6164 3f20  Do juliet.load? 
-0000ceb0: 666f 7220 6465 7461 696c 732e 270a 2020  for details.'.  
-0000cec0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0000ced0: 2020 2020 2023 2044 6566 696e 6520 6361       # Define ca
-0000cee0: 7365 7320 696e 2077 6869 6368 2064 6174  ses in which dat
-0000cef0: 6120 6973 2067 6976 656e 2074 6872 6f75  a is given throu
-0000cf00: 6768 2066 696c 6573 3a0a 2020 2020 2020  gh files:.      
-0000cf10: 2020 6966 2028 745f 6c63 2069 7320 4e6f    if (t_lc is No
-0000cf20: 6e65 293a 0a20 2020 2020 2020 2020 2020  ne):.           
-0000cf30: 2069 6620 6c63 6669 6c65 6e61 6d65 2069   if lcfilename i
-0000cf40: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000cf50: 2020 2020 2020 2020 2020 2020 745f 6c63              t_lc
-0000cf60: 2c79 5f6c 632c 7965 7272 5f6c 632c 696e  ,y_lc,yerr_lc,in
-0000cf70: 7374 7275 6d65 6e74 735f 6c63 2c69 6e73  struments_lc,ins
-0000cf80: 7472 756d 656e 745f 696e 6465 7865 735f  trument_indexes_
-0000cf90: 6c63 2c6e 696e 7374 7275 6d65 6e74 735f  lc,ninstruments_
-0000cfa0: 6c63 2c69 6e61 6d65 735f 6c63 2c6c 6d5f  lc,inames_lc,lm_
-0000cfb0: 6c63 5f62 6f6f 6c65 616e 2c6c 6d5f 6c63  lc_boolean,lm_lc
-0000cfc0: 5f61 7267 756d 656e 7473 203d 205c 0a20  _arguments = \. 
-0000cfd0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000cfe0: 6561 645f 6461 7461 286c 6366 696c 656e  ead_data(lcfilen
-0000cff0: 616d 6529 0a0a 2020 2020 2020 2020 2020  ame)..          
-0000d000: 2020 2020 2020 2320 5361 7665 2064 6174        # Save dat
-0000d010: 6120 746f 206f 626a 6563 743a 0a0a 2020  a to object:..  
-0000d020: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000d030: 6c66 2e73 6574 5f6c 635f 6461 7461 2874  lf.set_lc_data(t
-0000d040: 5f6c 632c 2079 5f6c 632c 2079 6572 725f  _lc, y_lc, yerr_
-0000d050: 6c63 2c20 696e 7374 7275 6d65 6e74 735f  lc, instruments_
-0000d060: 6c63 2c0a 2020 2020 2020 2020 2020 2020  lc,.            
-0000d070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d080: 2020 2020 2069 6e73 7472 756d 656e 745f       instrument_
-0000d090: 696e 6465 7865 735f 6c63 2c20 6e69 6e73  indexes_lc, nins
-0000d0a0: 7472 756d 656e 7473 5f6c 632c 0a20 2020  truments_lc,.   
-0000d0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d0c0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0000d0d0: 616d 6573 5f6c 632c 206c 6d5f 6c63 5f62  ames_lc, lm_lc_b
-0000d0e0: 6f6f 6c65 616e 2c20 6c6d 5f6c 635f 6172  oolean, lm_lc_ar
-0000d0f0: 6775 6d65 6e74 7329 0a0a 2020 2020 2020  guments)..      
-0000d100: 2020 6966 2028 745f 7276 2069 7320 4e6f    if (t_rv is No
-0000d110: 6e65 293a 0a20 2020 2020 2020 2020 2020  ne):.           
-0000d120: 2069 6620 7276 6669 6c65 6e61 6d65 2069   if rvfilename i
-0000d130: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000d140: 2020 2020 2020 2020 2020 2020 745f 7276              t_rv
-0000d150: 2c79 5f72 762c 7965 7272 5f72 762c 696e  ,y_rv,yerr_rv,in
-0000d160: 7374 7275 6d65 6e74 735f 7276 2c69 6e73  struments_rv,ins
-0000d170: 7472 756d 656e 745f 696e 6465 7865 735f  trument_indexes_
-0000d180: 7276 2c6e 696e 7374 7275 6d65 6e74 735f  rv,ninstruments_
-0000d190: 7276 2c69 6e61 6d65 735f 7276 2c6c 6d5f  rv,inames_rv,lm_
-0000d1a0: 7276 5f62 6f6f 6c65 616e 2c6c 6d5f 7276  rv_boolean,lm_rv
-0000d1b0: 5f61 7267 756d 656e 7473 203d 205c 0a20  _arguments = \. 
-0000d1c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000d1d0: 6561 645f 6461 7461 2872 7666 696c 656e  ead_data(rvfilen
-0000d1e0: 616d 6529 0a0a 2020 2020 2020 2020 2020  ame)..          
-0000d1f0: 2020 2020 2020 2320 5361 7665 2064 6174        # Save dat
-0000d200: 6120 746f 206f 626a 6563 743a 0a20 2020  a to object:.   
-0000d210: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000d220: 662e 7365 745f 7276 5f64 6174 6128 745f  f.set_rv_data(t_
-0000d230: 7276 2c20 795f 7276 2c20 7965 7272 5f72  rv, y_rv, yerr_r
-0000d240: 762c 2069 6e73 7472 756d 656e 7473 5f72  v, instruments_r
-0000d250: 762c 0a20 2020 2020 2020 2020 2020 2020  v,.             
-0000d260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d270: 2020 2020 696e 7374 7275 6d65 6e74 5f69      instrument_i
-0000d280: 6e64 6578 6573 5f72 762c 206e 696e 7374  ndexes_rv, ninst
-0000d290: 7275 6d65 6e74 735f 7276 2c0a 2020 2020  ruments_rv,.    
-0000d2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d2b0: 2020 2020 2020 2020 2020 2020 2069 6e61               ina
-0000d2c0: 6d65 735f 7276 2c20 6c6d 5f72 765f 626f  mes_rv, lm_rv_bo
-0000d2d0: 6f6c 6561 6e2c 206c 6d5f 7276 5f61 7267  olean, lm_rv_arg
-0000d2e0: 756d 656e 7473 290a 0a20 2020 2020 2020  uments)..       
-0000d2f0: 2069 6620 2874 5f6c 6320 6973 204e 6f6e   if (t_lc is Non
-0000d300: 6520 616e 6420 745f 7276 2069 7320 4e6f  e and t_rv is No
-0000d310: 6e65 293a 0a20 2020 2020 2020 2020 2020  ne):.           
-0000d320: 2069 6620 286c 6366 696c 656e 616d 6520   if (lcfilename 
-0000d330: 6973 204e 6f6e 6529 2061 6e64 2028 7276  is None) and (rv
-0000d340: 6669 6c65 6e61 6d65 2069 7320 4e6f 6e65  filename is None
-0000d350: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0000d360: 2020 2072 6169 7365 2045 7863 6570 7469     raise Excepti
-0000d370: 6f6e 2827 494e 5055 5420 4552 524f 523a  on('INPUT ERROR:
-0000d380: 204e 6f20 636f 6d70 6c65 7465 2064 6174   No complete dat
-0000d390: 6173 6574 2028 7068 6f74 6f6d 6574 7269  aset (photometri
-0000d3a0: 6320 6f72 2072 6164 6961 6c2d 7665 6c6f  c or radial-velo
-0000d3b0: 6369 7479 2920 6769 7665 6e2e 5c6e 272b  city) given.\n'+
-0000d3c0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0000d3d0: 2020 2020 2020 2020 2720 4d61 6b65 2073          ' Make s
-0000d3e0: 7572 6520 746f 2066 6565 6420 7469 6d65  ure to feed time
-0000d3f0: 7320 2874 5f6c 6320 616e 642f 6f72 2074  s (t_lc and/or t
-0000d400: 5f72 7629 2c20 7661 6c75 6573 2028 795f  _rv), values (y_
-0000d410: 6c63 2061 6e64 2f6f 7220 795f 7276 292c  lc and/or y_rv),
-0000d420: 205c 6e27 2b5c 0a20 2020 2020 2020 2020   \n'+\.         
-0000d430: 2020 2020 2020 2020 2020 2020 2027 2065               ' e
-0000d440: 7272 6f72 7320 2879 6572 725f 6c63 2061  rrors (yerr_lc a
-0000d450: 6e64 2f6f 7220 7965 7272 5f72 7629 2e27  nd/or yerr_rv).'
-0000d460: 290a 0a20 2020 2020 2020 2023 2052 6561  )..        # Rea
-0000d470: 6420 4750 2072 6567 7265 7373 6f72 7320  d GP regressors 
-0000d480: 6966 2067 6976 656e 2074 6872 6f75 6768  if given through
-0000d490: 2066 696c 6573 206f 7220 6172 7261 7973   files or arrays
-0000d4a0: 2e20 5468 6520 666f 726d 6572 2074 616b  . The former tak
-0000d4b0: 6573 2070 7269 6f72 6974 792e 2046 6972  es priority. Fir
-0000d4c0: 7374 206c 6967 6874 6375 7276 653a 0a20  st lightcurve:. 
-0000d4d0: 2020 2020 2020 2069 6620 4750 6c63 6570         if GPlcep
-0000d4e0: 6172 616d 6669 6c65 2069 7320 6e6f 7420  aramfile is not 
-0000d4f0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000d500: 2020 7365 6c66 2e47 505f 6c63 5f61 7267    self.GP_lc_arg
-0000d510: 756d 656e 7473 2c20 7365 6c66 2e67 6c6f  uments, self.glo
-0000d520: 6261 6c5f 6c63 5f6d 6f64 656c 203d 2072  bal_lc_model = r
-0000d530: 6561 6447 5065 7061 7261 6d73 280a 2020  eadGPeparams(.  
-0000d540: 2020 2020 2020 2020 2020 2020 2020 4750                GP
-0000d550: 6c63 6570 6172 616d 6669 6c65 290a 2020  lceparamfile).  
-0000d560: 2020 2020 2020 656c 6966 2047 505f 7265        elif GP_re
-0000d570: 6772 6573 736f 7273 5f6c 6320 6973 206e  gressors_lc is n
-0000d580: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0000d590: 2020 2020 2073 656c 662e 4750 5f6c 635f       self.GP_lc_
-0000d5a0: 6172 6775 6d65 6e74 7320 3d20 4750 5f72  arguments = GP_r
-0000d5b0: 6567 7265 7373 6f72 735f 6c63 0a20 2020  egressors_lc.   
-0000d5c0: 2020 2020 2020 2020 2069 6e73 7472 756d           instrum
-0000d5d0: 656e 7473 203d 2073 6574 286c 6973 7428  ents = set(list(
-0000d5e0: 7365 6c66 2e47 505f 6c63 5f61 7267 756d  self.GP_lc_argum
-0000d5f0: 656e 7473 2e6b 6579 7328 2929 290a 0a20  ents.keys())).. 
-0000d600: 2020 2020 2020 2023 2053 616d 6520 7468         # Same th
-0000d610: 696e 6720 666f 7220 5256 733a 0a20 2020  ing for RVs:.   
-0000d620: 2020 2020 2069 6620 4750 7276 6570 6172       if GPrvepar
-0000d630: 616d 6669 6c65 2069 7320 6e6f 7420 4e6f  amfile is not No
-0000d640: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0000d650: 7365 6c66 2e47 505f 7276 5f61 7267 756d  self.GP_rv_argum
-0000d660: 656e 7473 2c20 7365 6c66 2e67 6c6f 6261  ents, self.globa
-0000d670: 6c5f 7276 5f6d 6f64 656c 203d 2072 6561  l_rv_model = rea
-0000d680: 6447 5065 7061 7261 6d73 280a 2020 2020  dGPeparams(.    
-0000d690: 2020 2020 2020 2020 2020 2020 4750 7276              GPrv
-0000d6a0: 6570 6172 616d 6669 6c65 290a 2020 2020  eparamfile).    
-0000d6b0: 2020 2020 656c 6966 2047 505f 7265 6772      elif GP_regr
-0000d6c0: 6573 736f 7273 5f72 7620 6973 206e 6f74  essors_rv is not
-0000d6d0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0000d6e0: 2020 2073 656c 662e 4750 5f72 765f 6172     self.GP_rv_ar
-0000d6f0: 6775 6d65 6e74 7320 3d20 4750 5f72 6567  guments = GP_reg
-0000d700: 7265 7373 6f72 735f 7276 0a20 2020 2020  ressors_rv.     
-0000d710: 2020 2020 2020 2069 6e73 7472 756d 656e         instrumen
-0000d720: 7473 203d 2073 6574 286c 6973 7428 7365  ts = set(list(se
-0000d730: 6c66 2e47 505f 7276 5f61 7267 756d 656e  lf.GP_rv_argumen
-0000d740: 7473 2e6b 6579 7328 2929 290a 0a20 2020  ts.keys()))..   
-0000d750: 2020 2020 2023 2053 616d 6520 7468 696e       # Same thin
-0000d760: 6720 666f 7220 6c69 6e65 6172 2072 6567  g for linear reg
-0000d770: 7265 7373 6f72 7320 696e 2063 6173 6520  ressors in case 
-0000d780: 7468 6579 2077 6572 6520 6769 7665 6e20  they were given 
-0000d790: 696e 2061 2073 6570 6172 6174 6520 6669  in a separate fi
-0000d7a0: 6c65 3a0a 2020 2020 2020 2020 6966 204c  le:.        if L
-0000d7b0: 4d6c 6365 7061 7261 6d66 696c 6520 6973  Mlceparamfile is
-0000d7c0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0000d7d0: 2020 2020 2020 204c 4d5f 6c63 5f61 7267         LM_lc_arg
-0000d7e0: 756d 656e 7473 2c20 6475 6d6d 795f 7661  uments, dummy_va
-0000d7f0: 7220 3d20 7265 6164 4750 6570 6172 616d  r = readGPeparam
-0000d800: 7328 4c4d 6c63 6570 6172 616d 6669 6c65  s(LMlceparamfile
-0000d810: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-0000d820: 7220 6c6d 6920 696e 206c 6973 7428 4c4d  r lmi in list(LM
-0000d830: 5f6c 635f 6172 6775 6d65 6e74 732e 6b65  _lc_arguments.ke
-0000d840: 7973 2829 293a 0a20 2020 2020 2020 2020  ys()):.         
-0000d850: 2020 2020 2020 206c 6d5f 6c63 5f62 6f6f         lm_lc_boo
-0000d860: 6c65 616e 5b6c 6d69 5d20 3d20 5472 7565  lean[lmi] = True
-0000d870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d880: 206c 6d5f 6c63 5f61 7267 756d 656e 7473   lm_lc_arguments
-0000d890: 5b6c 6d69 5d20 3d20 4c4d 5f6c 635f 6172  [lmi] = LM_lc_ar
-0000d8a0: 6775 6d65 6e74 735b 6c6d 695d 0a0a 2020  guments[lmi]..  
-0000d8b0: 2020 2020 2020 2320 5361 6d65 2074 6869        # Same thi
-0000d8c0: 6e67 2066 6f72 2052 5673 3a0a 2020 2020  ng for RVs:.    
-0000d8d0: 2020 2020 6966 204c 4d72 7665 7061 7261      if LMrvepara
-0000d8e0: 6d66 696c 6520 6973 206e 6f74 204e 6f6e  mfile is not Non
-0000d8f0: 653a 0a20 2020 2020 2020 2020 2020 204c  e:.            L
-0000d900: 4d5f 7276 5f61 7267 756d 656e 7473 2c20  M_rv_arguments, 
-0000d910: 6475 6d6d 795f 7661 7220 3d20 7265 6164  dummy_var = read
-0000d920: 4750 6570 6172 616d 7328 4c4d 7276 6570  GPeparams(LMrvep
-0000d930: 6172 616d 6669 6c65 290a 2020 2020 2020  aramfile).      
-0000d940: 2020 2020 2020 666f 7220 6c6d 6920 696e        for lmi in
-0000d950: 206c 6973 7428 4c4d 5f72 765f 6172 6775   list(LM_rv_argu
-0000d960: 6d65 6e74 732e 6b65 7973 2829 293a 0a20  ments.keys()):. 
-0000d970: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0000d980: 6d5f 7276 5f62 6f6f 6c65 616e 5b6c 6d69  m_rv_boolean[lmi
-0000d990: 5d20 3d20 5472 7565 0a20 2020 2020 2020  ] = True.       
-0000d9a0: 2020 2020 2020 2020 206c 6d5f 7276 5f61           lm_rv_a
-0000d9b0: 7267 756d 656e 7473 5b6c 6d69 5d20 3d20  rguments[lmi] = 
-0000d9c0: 4c4d 5f72 765f 6172 6775 6d65 6e74 735b  LM_rv_arguments[
-0000d9d0: 6c6d 695d 0a0a 2020 2020 2020 2020 2320  lmi]..        # 
-0000d9e0: 4966 2064 6174 6120 6769 7665 6e20 7468  If data given th
-0000d9f0: 726f 7567 6820 6469 7265 6374 2061 7272  rough direct arr
-0000da00: 6179 7320 2869 2e65 2e2c 206e 6f74 2064  ays (i.e., not d
-0000da10: 6174 6120 6669 6c65 7329 2c20 6765 6e65  ata files), gene
-0000da20: 7261 7465 2073 6f6d 6520 7573 6566 756c  rate some useful
-0000da30: 2069 6e74 6572 6e61 6c20 6c69 6768 7463   internal lightc
-0000da40: 7572 7665 2061 7272 6179 733a 2069 6e61  urve arrays: ina
-0000da50: 6d65 735f 6c63 2c20 7768 6963 6820 6861  mes_lc, which ha
-0000da60: 7665 2074 6865 2064 6966 6665 7265 6e74  ve the different
-0000da70: 206c 6967 6874 6375 7276 6520 696e 7374   lightcurve inst
-0000da80: 7275 6d65 6e74 206e 616d 6573 2c0a 2020  rument names,.  
-0000da90: 2020 2020 2020 2320 696e 7374 7275 6d65        # instrume
-0000daa0: 6e74 5f69 6e64 6578 6573 5f6c 6320 2864  nt_indexes_lc (d
-0000dab0: 6963 7469 6f6e 6172 7920 7468 6174 2068  ictionary that h
-0000dac0: 6f6c 6473 2c20 666f 7220 6561 6368 2069  olds, for each i
-0000dad0: 6e73 7472 756d 656e 742c 2074 6865 2069  nstrument, the i
-0000dae0: 6e64 6578 6573 2074 6861 7420 6861 7665  ndexes that have
-0000daf0: 2074 6865 2074 696d 652f 6c69 6768 7463   the time/lightc
-0000db00: 7572 7665 2064 6174 6120 666f 7220 7468  urve data for th
-0000db10: 6174 2070 6172 7469 6375 6c61 7220 696e  at particular in
-0000db20: 7374 7275 6d65 6e74 292c 206c 6d5f 6c63  strument), lm_lc
-0000db30: 5f62 6f6f 6c65 616e 2028 6469 6374 696f  _boolean (dictio
-0000db40: 6e61 7279 206f 660a 2020 2020 2020 2020  nary of.        
-0000db50: 2320 626f 6f6c 6561 6e73 3b20 5472 7565  # booleans; True
-0000db60: 2066 6f72 2061 6e20 696e 7374 7275 6d65   for an instrume
-0000db70: 6e74 2069 6620 6974 2068 6173 206c 696e  nt if it has lin
-0000db80: 6561 7220 7265 6772 6573 736f 7273 292c  ear regressors),
-0000db90: 206c 6d5f 6c63 5f61 7267 756d 656e 7473   lm_lc_arguments
-0000dba0: 2028 6469 6374 696f 6e61 7279 2063 6f6e   (dictionary con
-0000dbb0: 7461 696e 696e 6720 7468 6520 6c69 6e65  taining the line
-0000dbc0: 6172 2072 6567 7265 7373 6f72 7320 666f  ar regressors fo
-0000dbd0: 7220 6561 6368 2069 6e73 7472 756d 656e  r each instrumen
-0000dbe0: 7429 2c20 6574 632e 3a0a 2020 2020 2020  t), etc.:.      
-0000dbf0: 2020 6966 2028 6c63 6669 6c65 6e61 6d65    if (lcfilename
-0000dc00: 2069 7320 4e6f 6e65 2920 616e 6420 2874   is None) and (t
-0000dc10: 5f6c 6320 6973 206e 6f74 204e 6f6e 6529  _lc is not None)
-0000dc20: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0000dc30: 4669 7273 7420 6368 6563 6b20 7573 6572  First check user
-0000dc40: 2067 6176 6520 616c 6c20 6461 7461 3a0a   gave all data:.
-0000dc50: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-0000dc60: 745f 6572 726f 725f 6361 7463 6865 7228  t_error_catcher(
-0000dc70: 745f 6c63 2c20 795f 6c63 2c20 7965 7272  t_lc, y_lc, yerr
-0000dc80: 5f6c 632c 2027 6c69 6768 7463 7572 7665  _lc, 'lightcurve
-0000dc90: 2729 0a20 2020 2020 2020 2020 2020 2023  ').            #
-0000dca0: 2043 6f6e 7665 7274 2074 696d 6573 2074   Convert times t
-0000dcb0: 6f20 666c 6f61 7436 3420 2862 6174 6d61  o float64 (batma
-0000dcc0: 6e20 7265 616c 6c79 2068 6174 6573 206e  n really hates n
-0000dcd0: 6f6e 2d66 6c6f 6174 3634 2069 6e70 7574  on-float64 input
-0000dce0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-0000dcf0: 666f 7220 696e 7374 7275 6d65 6e74 2069  for instrument i
-0000dd00: 6e20 745f 6c63 2e6b 6579 7328 293a 0a20  n t_lc.keys():. 
-0000dd10: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0000dd20: 5f6c 635b 696e 7374 7275 6d65 6e74 5d20  _lc[instrument] 
-0000dd30: 3d20 745f 6c63 5b69 6e73 7472 756d 656e  = t_lc[instrumen
-0000dd40: 745d 2e61 7374 7970 6528 2766 6c6f 6174  t].astype('float
-0000dd50: 3634 2729 0a20 2020 2020 2020 2020 2020  64').           
-0000dd60: 2023 2043 7265 6174 6520 676c 6f62 616c   # Create global
-0000dd70: 2061 7272 6179 733a 0a20 2020 2020 2020   arrays:.       
-0000dd80: 2020 2020 2074 676c 6f62 616c 5f6c 632c       tglobal_lc,
-0000dd90: 2079 676c 6f62 616c 5f6c 632c 2079 676c   yglobal_lc, ygl
-0000dda0: 6f62 616c 6572 725f 6c63 2c20 696e 7374  obalerr_lc, inst
-0000ddb0: 7275 6d65 6e74 735f 6c63 203d 2073 656c  ruments_lc = sel
-0000ddc0: 662e 636f 6e76 6572 745f 696e 7075 745f  f.convert_input_
-0000ddd0: 6461 7461 280a 2020 2020 2020 2020 2020  data(.          
-0000dde0: 2020 2020 2020 745f 6c63 2c20 795f 6c63        t_lc, y_lc
-0000ddf0: 2c20 7965 7272 5f6c 6329 0a20 2020 2020  , yerr_lc).     
-0000de00: 2020 2020 2020 2023 2053 6176 6520 6461         # Save da
-0000de10: 7461 2069 6e20 6120 666f 726d 6174 2075  ta in a format u
-0000de20: 7365 6675 6c20 666f 7220 676c 6f62 616c  seful for global
-0000de30: 206d 6f64 656c 6c69 6e67 3a0a 2020 2020   modelling:.    
-0000de40: 2020 2020 2020 2020 696e 616d 6573 5f6c          inames_l
-0000de50: 632c 2069 6e73 7472 756d 656e 745f 696e  c, instrument_in
-0000de60: 6465 7865 735f 6c63 2c20 6c6d 5f6c 635f  dexes_lc, lm_lc_
-0000de70: 626f 6f6c 6561 6e20 3d20 7365 6c66 2e64  boolean = self.d
-0000de80: 6174 615f 7072 6570 6172 6174 696f 6e28  ata_preparation(
-0000de90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000dea0: 2074 676c 6f62 616c 5f6c 632c 2069 6e73   tglobal_lc, ins
-0000deb0: 7472 756d 656e 7473 5f6c 632c 206c 696e  truments_lc, lin
-0000dec0: 6561 725f 7265 6772 6573 736f 7273 5f6c  ear_regressors_l
-0000ded0: 6329 0a20 2020 2020 2020 2020 2020 206c  c).            l
-0000dee0: 6d5f 6c63 5f61 7267 756d 656e 7473 203d  m_lc_arguments =
-0000def0: 206c 696e 6561 725f 7265 6772 6573 736f   linear_regresso
-0000df00: 7273 5f6c 630a 2020 2020 2020 2020 2020  rs_lc.          
-0000df10: 2020 6e69 6e73 7472 756d 656e 7473 5f6c    ninstruments_l
-0000df20: 6320 3d20 6c65 6e28 696e 616d 6573 5f6c  c = len(inames_l
-0000df30: 6329 0a0a 2020 2020 2020 2020 2020 2020  c)..            
-0000df40: 2320 5361 7665 2064 6174 6120 746f 206f  # Save data to o
-0000df50: 626a 6563 743a 0a20 2020 2020 2020 2020  bject:.         
-0000df60: 2020 2073 656c 662e 7365 745f 6c63 5f64     self.set_lc_d
-0000df70: 6174 6128 7467 6c6f 6261 6c5f 6c63 2c20  ata(tglobal_lc, 
-0000df80: 7967 6c6f 6261 6c5f 6c63 2c20 7967 6c6f  yglobal_lc, yglo
-0000df90: 6261 6c65 7272 5f6c 632c 0a20 2020 2020  balerr_lc,.     
-0000dfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dfb0: 2020 2020 2020 2020 696e 7374 7275 6d65          instrume
-0000dfc0: 6e74 735f 6c63 2c20 696e 7374 7275 6d65  nts_lc, instrume
-0000dfd0: 6e74 5f69 6e64 6578 6573 5f6c 632c 0a20  nt_indexes_lc,. 
-0000dfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dff0: 2020 2020 2020 2020 2020 2020 6e69 6e73              nins
-0000e000: 7472 756d 656e 7473 5f6c 632c 2069 6e61  truments_lc, ina
-0000e010: 6d65 735f 6c63 2c20 6c6d 5f6c 635f 626f  mes_lc, lm_lc_bo
-0000e020: 6f6c 6561 6e2c 0a20 2020 2020 2020 2020  olean,.         
-0000e030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e040: 2020 2020 6c6d 5f6c 635f 6172 6775 6d65      lm_lc_argume
-0000e050: 6e74 7329 0a0a 2020 2020 2020 2020 2020  nts)..          
-0000e060: 2020 2320 5361 7665 2069 6e70 7574 2064    # Save input d
-0000e070: 6963 7469 6f6e 6172 6965 733a 0a20 2020  ictionaries:.   
-0000e080: 2020 2020 2020 2020 2073 656c 662e 7469           self.ti
-0000e090: 6d65 735f 6c63 203d 2074 5f6c 630a 2020  mes_lc = t_lc.  
-0000e0a0: 2020 2020 2020 2020 2020 7365 6c66 2e64            self.d
-0000e0b0: 6174 615f 6c63 203d 2079 5f6c 630a 2020  ata_lc = y_lc.  
-0000e0c0: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
-0000e0d0: 7272 6f72 735f 6c63 203d 2079 6572 725f  rrors_lc = yerr_
-0000e0e0: 6c63 0a20 2020 2020 2020 2065 6c69 6620  lc.        elif 
-0000e0f0: 745f 6c63 2069 7320 6e6f 7420 4e6f 6e65  t_lc is not None
-0000e100: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0000e110: 496e 2074 6869 7320 6361 7365 2c20 636f  In this case, co
-0000e120: 6e76 6572 7420 6461 7461 2069 6e20 6172  nvert data in ar
-0000e130: 7261 792d 666f 726d 2074 6f20 6469 6374  ray-form to dict
-0000e140: 696f 6e61 7269 6573 2c20 7361 7665 2074  ionaries, save t
-0000e150: 6865 6d20 736f 2075 7365 7220 6361 6e20  hem so user can 
-0000e160: 6561 7369 6c79 2075 7365 2074 6865 6d3a  easily use them:
-0000e170: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
-0000e180: 6573 5f6c 632c 2064 6174 615f 6c63 2c20  es_lc, data_lc, 
-0000e190: 6572 726f 7273 5f6c 6320 3d20 7365 6c66  errors_lc = self
-0000e1a0: 2e63 6f6e 7665 7274 5f74 6f5f 6469 6374  .convert_to_dict
-0000e1b0: 696f 6e61 7279 280a 2020 2020 2020 2020  ionary(.        
-0000e1c0: 2020 2020 2020 2020 745f 6c63 2c20 795f          t_lc, y_
-0000e1d0: 6c63 2c20 7965 7272 5f6c 632c 2069 6e73  lc, yerr_lc, ins
-0000e1e0: 7472 756d 656e 745f 696e 6465 7865 735f  trument_indexes_
-0000e1f0: 6c63 290a 2020 2020 2020 2020 2020 2020  lc).            
-0000e200: 7365 6c66 2e74 696d 6573 5f6c 6320 3d20  self.times_lc = 
-0000e210: 7469 6d65 735f 6c63 0a20 2020 2020 2020  times_lc.       
-0000e220: 2020 2020 2073 656c 662e 6461 7461 5f6c       self.data_l
-0000e230: 6320 3d20 6461 7461 5f6c 630a 2020 2020  c = data_lc.    
-0000e240: 2020 2020 2020 2020 7365 6c66 2e65 7272          self.err
-0000e250: 6f72 735f 6c63 203d 2065 7272 6f72 735f  ors_lc = errors_
-0000e260: 6c63 0a0a 2020 2020 2020 2020 2320 5361  lc..        # Sa
-0000e270: 6d65 2066 6f72 2072 6164 6961 6c2d 7665  me for radial-ve
-0000e280: 6c6f 6369 7479 2064 6174 613a 0a20 2020  locity data:.   
-0000e290: 2020 2020 2069 6620 2872 7666 696c 656e       if (rvfilen
-0000e2a0: 616d 6520 6973 204e 6f6e 6529 2061 6e64  ame is None) and
-0000e2b0: 2028 745f 7276 2069 7320 6e6f 7420 4e6f   (t_rv is not No
-0000e2c0: 6e65 293a 0a20 2020 2020 2020 2020 2020  ne):.           
-0000e2d0: 2069 6e70 7574 5f65 7272 6f72 5f63 6174   input_error_cat
-0000e2e0: 6368 6572 2874 5f72 762c 2079 5f72 762c  cher(t_rv, y_rv,
-0000e2f0: 2079 6572 725f 7276 2c20 2772 6164 6961   yerr_rv, 'radia
-0000e300: 6c2d 7665 6c6f 6369 7479 2729 0a20 2020  l-velocity').   
-0000e310: 2020 2020 2020 2020 2074 676c 6f62 616c           tglobal
-0000e320: 5f72 762c 2079 676c 6f62 616c 5f72 762c  _rv, yglobal_rv,
-0000e330: 2079 676c 6f62 616c 6572 725f 7276 2c20   yglobalerr_rv, 
-0000e340: 696e 7374 7275 6d65 6e74 735f 7276 203d  instruments_rv =
-0000e350: 2073 656c 662e 636f 6e76 6572 745f 696e   self.convert_in
-0000e360: 7075 745f 6461 7461 280a 2020 2020 2020  put_data(.      
-0000e370: 2020 2020 2020 2020 2020 745f 7276 2c20            t_rv, 
-0000e380: 795f 7276 2c20 7965 7272 5f72 7629 0a20  y_rv, yerr_rv). 
-0000e390: 2020 2020 2020 2020 2020 2069 6e61 6d65             iname
-0000e3a0: 735f 7276 2c20 696e 7374 7275 6d65 6e74  s_rv, instrument
-0000e3b0: 5f69 6e64 6578 6573 5f72 762c 206c 6d5f  _indexes_rv, lm_
-0000e3c0: 7276 5f62 6f6f 6c65 616e 203d 2073 656c  rv_boolean = sel
-0000e3d0: 662e 6461 7461 5f70 7265 7061 7261 7469  f.data_preparati
-0000e3e0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-0000e3f0: 2020 2020 7467 6c6f 6261 6c5f 7276 2c20      tglobal_rv, 
-0000e400: 696e 7374 7275 6d65 6e74 735f 7276 2c20  instruments_rv, 
-0000e410: 6c69 6e65 6172 5f72 6567 7265 7373 6f72  linear_regressor
-0000e420: 735f 7276 290a 2020 2020 2020 2020 2020  s_rv).          
-0000e430: 2020 6c6d 5f72 765f 6172 6775 6d65 6e74    lm_rv_argument
-0000e440: 7320 3d20 6c69 6e65 6172 5f72 6567 7265  s = linear_regre
-0000e450: 7373 6f72 735f 7276 0a20 2020 2020 2020  ssors_rv.       
-0000e460: 2020 2020 206e 696e 7374 7275 6d65 6e74       ninstrument
-0000e470: 735f 7276 203d 206c 656e 2869 6e61 6d65  s_rv = len(iname
-0000e480: 735f 7276 290a 0a20 2020 2020 2020 2020  s_rv)..         
-0000e490: 2020 2023 2053 6176 6520 6461 7461 2074     # Save data t
-0000e4a0: 6f20 6f62 6a65 6374 3a0a 0a20 2020 2020  o object:..     
-0000e4b0: 2020 2020 2020 2073 656c 662e 7365 745f         self.set_
-0000e4c0: 7276 5f64 6174 6128 7467 6c6f 6261 6c5f  rv_data(tglobal_
-0000e4d0: 7276 2c20 7967 6c6f 6261 6c5f 7276 2c20  rv, yglobal_rv, 
-0000e4e0: 7967 6c6f 6261 6c65 7272 5f72 762c 0a20  yglobalerr_rv,. 
-0000e4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e500: 2020 2020 2020 2020 2020 2020 696e 7374              inst
-0000e510: 7275 6d65 6e74 735f 7276 2c20 696e 7374  ruments_rv, inst
-0000e520: 7275 6d65 6e74 5f69 6e64 6578 6573 5f72  rument_indexes_r
-0000e530: 762c 0a20 2020 2020 2020 2020 2020 2020  v,.             
-0000e540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e550: 6e69 6e73 7472 756d 656e 7473 5f72 762c  ninstruments_rv,
-0000e560: 2069 6e61 6d65 735f 7276 2c20 6c6d 5f72   inames_rv, lm_r
-0000e570: 765f 626f 6f6c 6561 6e2c 0a20 2020 2020  v_boolean,.     
-0000e580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e590: 2020 2020 2020 2020 6c6d 5f72 765f 6172          lm_rv_ar
-0000e5a0: 6775 6d65 6e74 7329 0a0a 2020 2020 2020  guments)..      
-0000e5b0: 2020 2020 2020 2320 5361 7665 2069 6e70        # Save inp
-0000e5c0: 7574 2064 6963 7469 6f6e 6172 6965 733a  ut dictionaries:
-0000e5d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000e5e0: 662e 7469 6d65 735f 7276 203d 2074 5f72  f.times_rv = t_r
-0000e5f0: 760a 2020 2020 2020 2020 2020 2020 7365  v.            se
-0000e600: 6c66 2e64 6174 615f 7276 203d 2079 5f72  lf.data_rv = y_r
-0000e610: 760a 2020 2020 2020 2020 2020 2020 7365  v.            se
-0000e620: 6c66 2e65 7272 6f72 735f 7276 203d 2079  lf.errors_rv = y
-0000e630: 6572 725f 7276 0a20 2020 2020 2020 2065  err_rv.        e
-0000e640: 6c69 6620 745f 7276 2069 7320 6e6f 7420  lif t_rv is not 
-0000e650: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000e660: 2020 2320 496e 2074 6869 7320 6361 7365    # In this case
-0000e670: 2c20 636f 6e76 6572 7420 6461 7461 2069  , convert data i
-0000e680: 6e20 6172 7261 792d 666f 726d 2074 6f20  n array-form to 
-0000e690: 6469 6374 696f 6e61 7269 6573 2c20 7361  dictionaries, sa
-0000e6a0: 7665 2074 6865 6d20 736f 2075 7365 7220  ve them so user 
-0000e6b0: 6361 6e20 6561 7369 6c79 2075 7365 2074  can easily use t
-0000e6c0: 6865 6d3a 0a20 2020 2020 2020 2020 2020  hem:.           
-0000e6d0: 2074 696d 6573 5f72 762c 2064 6174 615f   times_rv, data_
-0000e6e0: 7276 2c20 6572 726f 7273 5f72 7620 3d20  rv, errors_rv = 
-0000e6f0: 7365 6c66 2e63 6f6e 7665 7274 5f74 6f5f  self.convert_to_
-0000e700: 6469 6374 696f 6e61 7279 280a 2020 2020  dictionary(.    
-0000e710: 2020 2020 2020 2020 2020 2020 745f 7276              t_rv
-0000e720: 2c20 795f 7276 2c20 7965 7272 5f72 762c  , y_rv, yerr_rv,
-0000e730: 2069 6e73 7472 756d 656e 745f 696e 6465   instrument_inde
-0000e740: 7865 735f 7276 290a 2020 2020 2020 2020  xes_rv).        
-0000e750: 2020 2020 7365 6c66 2e74 696d 6573 5f72      self.times_r
-0000e760: 7620 3d20 7469 6d65 735f 7276 0a20 2020  v = times_rv.   
-0000e770: 2020 2020 2020 2020 2073 656c 662e 6461           self.da
-0000e780: 7461 5f72 7620 3d20 6461 7461 5f72 760a  ta_rv = data_rv.
-0000e790: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000e7a0: 2e65 7272 6f72 735f 7276 203d 2065 7272  .errors_rv = err
-0000e7b0: 6f72 735f 7276 0a0a 2020 2020 2020 2020  ors_rv..        
-0000e7c0: 2320 4966 206f 7574 5f66 6f6c 6465 7220  # If out_folder 
-0000e7d0: 646f 6573 206e 6f74 2065 7869 7374 2c20  does not exist, 
-0000e7e0: 6372 6561 7465 2069 742c 2061 6e64 2073  create it, and s
-0000e7f0: 6176 6520 6461 7461 2074 6f20 6974 3a0a  ave data to it:.
-0000e800: 2020 2020 2020 2020 6966 206f 7574 5f66          if out_f
-0000e810: 6f6c 6465 7220 6973 206e 6f74 204e 6f6e  older is not Non
-0000e820: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0000e830: 656c 662e 6f75 745f 666f 6c64 6572 203d  elf.out_folder =
-0000e840: 206f 7574 5f66 6f6c 6465 720a 2020 2020   out_folder.    
-0000e850: 2020 2020 2020 2020 7365 6c66 2e73 6176          self.sav
-0000e860: 6528 290a 0a20 2020 2020 2020 2023 2046  e()..        # F
-0000e870: 696e 616c 6c79 2c20 6765 6e65 7261 7465  inally, generate
-0000e880: 2064 6174 6164 6963 7473 2c20 7468 6174   datadicts, that
-0000e890: 2077 696c 6c20 7361 7665 2069 6e66 6f72   will save infor
-0000e8a0: 6d61 7469 6f6e 2061 626f 7574 2074 6865  mation about the
-0000e8b0: 2066 6974 732c 2069 6e63 6c75 6469 6e67   fits, including
-0000e8c0: 2067 6175 7373 6961 6e5f 7072 6f63 6573   gaussian_proces
-0000e8d0: 7320 6f62 6a65 6374 7320 666f 7220 6561  s objects for ea
-0000e8e0: 6368 2069 6e73 7472 756d 656e 7420 7468  ch instrument th
-0000e8f0: 6174 2072 6571 7569 7265 7320 6974 0a20  at requires it. 
-0000e900: 2020 2020 2020 2023 2028 696e 636c 7564         # (includ
-0000e910: 696e 6720 7468 6520 6361 7365 206f 6620  ing the case of 
-0000e920: 676c 6f62 616c 206d 6f64 656c 7329 3a0a  global models):.
-0000e930: 2020 2020 2020 2020 6966 2074 5f6c 6320          if t_lc 
-0000e940: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0000e950: 2020 2020 2020 2020 2073 656c 662e 6765           self.ge
-0000e960: 6e65 7261 7465 5f64 6174 6164 6963 7428  nerate_datadict(
-0000e970: 276c 6327 290a 2020 2020 2020 2020 6966  'lc').        if
-0000e980: 2074 5f72 7620 6973 206e 6f74 204e 6f6e   t_rv is not Non
-0000e990: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0000e9a0: 656c 662e 6765 6e65 7261 7465 5f64 6174  elf.generate_dat
-0000e9b0: 6164 6963 7428 2772 7627 290a 0a0a 6d63  adict('rv')...mc
-0000e9c0: 6d63 5f73 616d 706c 6572 7320 3d20 5b27  mc_samplers = ['
-0000e9d0: 656d 6365 6527 2c20 277a 6575 7327 5d0a  emcee', 'zeus'].
-0000e9e0: 0a63 6c61 7373 2066 6974 286f 626a 6563  .class fit(objec
-0000e9f0: 7429 3a0a 2020 2020 2222 220a 2020 2020  t):.    """.    
-0000ea00: 4769 7665 6e20 6120 6a75 6c69 6574 2064  Given a juliet d
-0000ea10: 6174 6120 6f62 6a65 6374 2c20 7468 6973  ata object, this
-0000ea20: 2063 6c61 7373 2070 6572 666f 726d 7320   class performs 
-0000ea30: 6120 6669 7420 746f 2074 6865 2064 6174  a fit to the dat
-0000ea40: 6120 616e 6420 7265 7475 726e 7320 6120  a and returns a 
-0000ea50: 7265 7375 6c74 7320 6f62 6a65 6374 2074  results object t
-0000ea60: 6f20 6578 706c 6f72 6520 7468 650a 2020  o explore the.  
-0000ea70: 2020 7265 7375 6c74 732e 2045 7861 6d70    results. Examp
-0000ea80: 6c65 2075 7361 6765 3a0a 0a20 2020 2020  le usage:..     
-0000ea90: 2020 2020 2020 2020 2020 3e3e 3e20 7265            >>> re
-0000eaa0: 7375 6c74 7320 3d20 6a75 6c69 6574 2e66  sults = juliet.f
-0000eab0: 6974 2864 6174 6129 0a0a 2020 2020 3a70  it(data)..    :p
-0000eac0: 6172 616d 2064 6174 613a 2028 6a75 6c69  aram data: (juli
-0000ead0: 6574 206f 626a 6563 7429 0a20 2020 2020  et object).     
-0000eae0: 2020 2041 6e20 6f62 6a65 6374 2063 6f6e     An object con
-0000eaf0: 7461 696e 696e 6720 616c 6c20 7468 6520  taining all the 
-0000eb00: 696e 666f 726d 6174 696f 6e20 7265 6761  information rega
-0000eb10: 7264 696e 6720 7468 6520 6461 7461 2074  rding the data t
-0000eb20: 6f20 6265 2066 6974 7465 642c 2069 6e63  o be fitted, inc
-0000eb30: 6c75 6469 6e67 206f 7074 696f 6e73 206f  luding options o
-0000eb40: 6620 7468 6520 6669 742e 0a20 2020 2020  f the fit..     
-0000eb50: 2020 2047 656e 6572 6174 6564 2076 6961     Generated via
-0000eb60: 206a 756c 6965 742e 6c6f 6164 2829 2e0a   juliet.load()..
-0000eb70: 0a20 2020 204f 6e20 746f 7020 6f66 2060  .    On top of `
-0000eb80: 6064 6174 6160 602c 2061 2073 6572 6965  `data``, a serie
-0000eb90: 7320 6f66 2065 7874 7261 206b 6579 776f  s of extra keywo
-0000eba0: 7264 7320 6361 6e20 6265 2069 6e63 6c75  rds can be inclu
-0000ebb0: 6465 643a 0a0a 2020 2020 3a70 6172 616d  ded:..    :param
-0000ebc0: 2073 616d 706c 6572 3a20 286f 7074 696f   sampler: (optio
-0000ebd0: 6e61 6c2c 2073 7472 696e 6729 0a20 2020  nal, string).   
-0000ebe0: 2020 2020 2053 7472 696e 6720 6465 6669       String defi
-0000ebf0: 6e69 6e67 2074 6865 2073 616d 706c 6572  ning the sampler
-0000ec00: 2074 6f20 6265 2075 7365 6420 6f6e 2074   to be used on t
-0000ec10: 6865 2066 6974 2e20 4375 7272 656e 7420  he fit. Current 
-0000ec20: 706f 7373 6962 6c65 206f 7074 696f 6e73  possible options
-0000ec30: 2069 6e63 6c75 6465 2060 606d 756c 7469   include ``multi
-0000ec40: 6e65 7374 6060 2074 6f20 7573 6520 6050  nest`` to use `P
-0000ec50: 794d 756c 7469 4e65 7374 203c 6874 7470  yMultiNest <http
-0000ec60: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f4a  s://github.com/J
-0000ec70: 6f68 616e 6e65 7342 7563 686e 6572 2f50  ohannesBuchner/P
-0000ec80: 794d 756c 7469 4e65 7374 3e60 5f20 2876  yMultiNest>`_ (v
-0000ec90: 6961 2069 6d70 6f72 7461 6e63 6520 6e65  ia importance ne
-0000eca0: 7374 6564 2073 616d 706c 696e 6729 2c0a  sted sampling),.
-0000ecb0: 2020 2020 2020 2020 6060 6479 6e65 7374          ``dynest
-0000ecc0: 7960 6020 746f 2075 7365 2060 4479 6e65  y`` to use `Dyne
-0000ecd0: 7374 7920 3c68 7474 7073 3a2f 2f67 6974  sty <https://git
-0000ece0: 6875 622e 636f 6d2f 6a6f 7368 7370 6561  hub.com/joshspea
-0000ecf0: 676c 652f 6479 6e65 7374 793e 605f 2773  gle/dynesty>`_'s
-0000ed00: 2069 6d70 6f72 7461 6e63 6520 6e65 7374   importance nest
-0000ed10: 6564 2073 616d 706c 696e 672c 2060 6064  ed sampling, ``d
-0000ed20: 796e 616d 6963 5f64 796e 6573 7479 6060  ynamic_dynesty``
-0000ed30: 2074 6f20 7573 6520 4479 6e65 7374 7927   to use Dynesty'
-0000ed40: 7320 6479 6e61 6d69 6320 6e65 7374 6564  s dynamic nested
-0000ed50: 2073 616d 706c 696e 6720 616c 676f 7269   sampling algori
-0000ed60: 7468 6d2c 2060 6075 6c74 7261 6e65 7374  thm, ``ultranest
-0000ed70: 6060 2074 6f20 7573 650a 2020 2020 2020  `` to use.      
-0000ed80: 2020 6055 6c74 7261 6e65 7374 203c 6874    `Ultranest <ht
-0000ed90: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-0000eda0: 2f4a 6f68 616e 6e65 7342 7563 686e 6572  /JohannesBuchner
-0000edb0: 2f55 6c74 7261 4e65 7374 2f3e 605f 2c20  /UltraNest/>`_, 
-0000edc0: 6060 736c 6963 6573 616d 706c 6572 5f75  ``slicesampler_u
-0000edd0: 6c74 7261 6e65 7374 6060 2074 6f20 7573  ltranest`` to us
-0000ede0: 6520 556c 7472 616e 6573 7427 7320 736c  e Ultranest's sl
-0000edf0: 6963 6520 7361 6d70 6c65 7220 616e 6420  ice sampler and 
-0000ee00: 6060 656d 6365 6560 6020 746f 2075 7365  ``emcee`` to use
-0000ee10: 2060 656d 6365 6520 3c68 7474 7073 3a2f   `emcee <https:/
-0000ee20: 2f67 6974 6875 622e 636f 6d2f 6466 6d2f  /github.com/dfm/
-0000ee30: 656d 6365 653e 605f 2e20 4465 6661 756c  emcee>`_. Defaul
-0000ee40: 7420 6973 0a20 2020 2020 2020 2060 606d  t is.        ``m
-0000ee50: 756c 7469 6e65 7374 6060 2069 6620 5079  ultinest`` if Py
-0000ee60: 4d75 6c74 694e 6573 7420 6973 2069 6e73  MultiNest is ins
-0000ee70: 7461 6c6c 6564 3b20 6060 6479 6e65 7374  talled; ``dynest
-0000ee80: 7960 6020 6966 206e 6f74 2e0a 0a20 2020  y`` if not...   
-0000ee90: 203a 7061 7261 6d20 6e5f 6c69 7665 5f70   :param n_live_p
-0000eea0: 6f69 6e74 733a 2028 6f70 7469 6f6e 616c  oints: (optional
-0000eeb0: 2c20 696e 7429 0a20 2020 2020 2020 204e  , int).        N
-0000eec0: 756d 6265 7220 6f66 206c 6976 652d 706f  umber of live-po
-0000eed0: 696e 7473 2074 6f20 7573 6520 6f6e 2074  ints to use on t
-0000eee0: 6865 206e 6573 7465 6420 7361 6d70 6c69  he nested sampli
-0000eef0: 6e67 2073 616d 706c 6572 732e 2044 6566  ng samplers. Def
-0000ef00: 6175 6c74 2069 7320 3530 302e 0a0a 2020  ault is 500...  
-0000ef10: 2020 3a70 6172 616d 206e 7761 6c6b 6572    :param nwalker
-0000ef20: 733a 2028 6f70 7469 6f6e 616c 2069 6620  s: (optional if 
-0000ef30: 7573 696e 6720 656d 6365 652c 2069 6e74  using emcee, int
-0000ef40: 290a 2020 2020 2020 2020 4e75 6d62 6572  ).        Number
-0000ef50: 206f 6620 7761 6c6b 6572 7320 746f 2075   of walkers to u
-0000ef60: 7365 2062 7920 656d 6365 652e 2044 6566  se by emcee. Def
-0000ef70: 6175 6c74 2069 7320 3130 302e 0a0a 2020  ault is 100...  
-0000ef80: 2020 3a70 6172 616d 206e 7374 6570 733a    :param nsteps:
-0000ef90: 2028 6f70 7469 6f6e 616c 2069 6620 7573   (optional if us
-0000efa0: 696e 6720 4d43 4d43 2c20 696e 7429 0a20  ing MCMC, int). 
-0000efb0: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
-0000efc0: 2073 7465 7073 2f6a 756d 7073 2074 6f20   steps/jumps to 
-0000efd0: 7065 7266 6f72 6d20 6f6e 2074 6865 204d  perform on the M
-0000efe0: 434d 4320 7275 6e2e 2044 6566 6175 6c74  CMC run. Default
-0000eff0: 2069 7320 3330 302e 0a0a 2020 2020 3a70   is 300...    :p
-0000f000: 6172 616d 206e 6275 726e 696e 3a20 286f  aram nburnin: (o
-0000f010: 7074 696f 6e61 6c20 6966 2075 7369 6e67  ptional if using
-0000f020: 204d 434d 432c 2069 6e74 290a 2020 2020   MCMC, int).    
-0000f030: 2020 2020 4e75 6d62 6572 206f 6620 6275      Number of bu
-0000f040: 726e 696e 2073 7465 7073 2f6a 756d 7073  rnin steps/jumps
-0000f050: 2077 6865 6e20 7065 7266 6f72 6d69 6e67   when performing
-0000f060: 2074 6865 204d 434d 4320 7275 6e2e 2044   the MCMC run. D
-0000f070: 6566 6175 6c74 2069 7320 3530 302e 0a0a  efault is 500...
-0000f080: 2020 2020 3a70 6172 616d 2065 6d63 6565      :param emcee
-0000f090: 5f66 6163 746f 723a 2028 6f70 7469 6f6e  _factor: (option
-0000f0a0: 616c 2c20 666f 7220 656d 6365 6520 6f6e  al, for emcee on
-0000f0b0: 6c79 2c20 666c 6f61 7429 0a20 2020 2020  ly, float).     
-0000f0c0: 2020 2046 6163 746f 7220 6d75 6c74 6970     Factor multip
-0000f0d0: 6c79 696e 6720 7468 6520 7374 616e 6461  lying the standa
-0000f0e0: 7264 2d67 6175 7373 6961 6e20 6261 6c6c  rd-gaussian ball
-0000f0f0: 2061 726f 756e 6420 7768 6963 6820 7468   around which th
-0000f100: 6520 696e 6974 6961 6c20 706f 7369 7469  e initial positi
-0000f110: 6f6e 2069 7320 7065 7274 7572 6265 6420  on is perturbed 
-0000f120: 666f 7220 6561 6368 2077 616c 6b65 722e  for each walker.
-0000f130: 2044 6566 6175 6c74 2069 7320 3165 2d34   Default is 1e-4
-0000f140: 2e0a 0a20 2020 203a 7061 7261 6d20 6563  ...    :param ec
-0000f150: 636c 696d 3a20 286f 7074 696f 6e61 6c2c  clim: (optional,
-0000f160: 2066 6c6f 6174 290a 2020 2020 2020 2020   float).        
-0000f170: 5570 7065 7220 6c69 6d69 7420 6f6e 2074  Upper limit on t
-0000f180: 6865 206d 6178 696d 756d 2065 6363 656e  he maximum eccen
-0000f190: 7472 6963 6974 7920 746f 2073 616d 706c  tricity to sampl
-0000f1a0: 652e 2044 6566 6175 6c74 2069 7320 6060  e. Default is ``
-0000f1b0: 3160 602e 0a0a 2020 2020 3a70 6172 616d  1``...    :param
-0000f1c0: 2070 6c3a 2028 6f70 7469 6f6e 616c 2c20   pl: (optional, 
-0000f1d0: 666c 6f61 7429 0a20 2020 2020 2020 2049  float).        I
-0000f1e0: 6620 7468 6520 6060 2872 312c 7232 2960  f the ``(r1,r2)`
-0000f1f0: 6020 7061 7261 6d65 7472 697a 6174 696f  ` parametrizatio
-0000f200: 6e20 666f 7220 6060 2862 2c70 2960 6020  n for ``(b,p)`` 
-0000f210: 6973 2075 7365 642c 2074 6869 7320 6465  is used, this de
-0000f220: 6669 6e65 7320 7468 6520 6c6f 7765 7220  fines the lower 
-0000f230: 6c69 6d69 7420 6f66 2074 6865 2070 6c61  limit of the pla
-0000f240: 6e65 742d 746f 2d73 7461 7220 7261 6469  net-to-star radi
-0000f250: 7573 2072 6174 696f 2074 6f20 6265 2073  us ratio to be s
-0000f260: 616d 706c 6564 2e0a 2020 2020 2020 2020  ampled..        
-0000f270: 4465 6661 756c 7420 6973 2060 6030 6060  Default is ``0``
-0000f280: 2e0a 0a20 2020 203a 7061 7261 6d20 7075  ...    :param pu
-0000f290: 3a20 286f 7074 696f 6e61 6c2c 2066 6c6f  : (optional, flo
-0000f2a0: 6174 290a 2020 2020 2020 2020 5361 6d65  at).        Same
-0000f2b0: 2061 7320 6060 706c 6060 2c20 6275 7420   as ``pl``, but 
-0000f2c0: 666f 7220 7468 6520 7570 7065 7220 6c69  for the upper li
-0000f2d0: 6d69 742e 2044 6566 6175 6c74 2069 7320  mit. Default is 
-0000f2e0: 6060 3160 602e 0a0a 2020 2020 3a70 6172  ``1``...    :par
-0000f2f0: 616d 2074 613a 2028 6f70 7469 6f6e 616c  am ta: (optional
-0000f300: 2c20 666c 6f61 7429 0a20 2020 2020 2020  , float).       
-0000f310: 2054 696d 6520 746f 2062 6520 7375 6273   Time to be subs
-0000f320: 7472 6163 7465 6420 746f 2074 6865 2069  tracted to the i
-0000f330: 6e70 7574 2074 696d 6573 2069 6e20 6f72  nput times in or
-0000f340: 6465 7220 746f 2067 656e 6572 6174 6520  der to generate 
-0000f350: 7468 6520 6c69 6e65 6172 2061 6e64 2f6f  the linear and/o
-0000f360: 7220 7175 6164 7261 7469 6320 7472 656e  r quadratic tren
-0000f370: 6420 746f 2062 6520 6164 6465 6420 746f  d to be added to
-0000f380: 2074 6865 206d 6f64 656c 2e0a 2020 2020   the model..    
-0000f390: 2020 2020 4465 6661 756c 7420 6973 2032      Default is 2
-0000f3a0: 3435 3834 3630 2e0a 0a20 2020 203a 7061  458460...    :pa
-0000f3b0: 7261 6d20 6e74 6872 6561 6473 3a20 286f  ram nthreads: (o
-0000f3c0: 7074 696e 616c 2c20 696e 7429 0a20 2020  ptinal, int).   
-0000f3d0: 2020 2020 2044 6566 696e 6520 7468 6520       Define the 
-0000f3e0: 6e75 6d62 6572 206f 6620 7468 7265 6164  number of thread
-0000f3f0: 7320 746f 2075 7365 2077 6974 6869 6e20  s to use within 
-0000f400: 6479 6e65 7374 7920 6f72 2065 6d63 6565  dynesty or emcee
-0000f410: 2e20 4465 6661 756c 7420 6973 2074 6f20  . Default is to 
-0000f420: 7573 6520 6a75 7374 2031 2e20 4e6f 7465  use just 1. Note
-0000f430: 2074 6869 7320 7769 6c6c 206e 6f74 2069   this will not i
-0000f440: 6d70 6163 7420 5079 4d75 6c74 694e 6573  mpact PyMultiNes
-0000f450: 7420 6f72 2055 6c74 7261 4e65 7374 2072  t or UltraNest r
-0000f460: 756e 7320 2d2d 2d20 7468 6573 6520 6361  uns --- these ca
-0000f470: 6e20 6265 2070 6172 616c 6c65 6c69 7a65  n be parallelize
-0000f480: 6420 7669 6120 4d50 4920 6f6e 6c79 2e0a  d via MPI only..
-0000f490: 0a20 2020 203a 7061 7261 6d20 6c69 6768  .    :param ligh
-0000f4a0: 745f 7472 6176 656c 5f64 656c 6179 3a20  t_travel_delay: 
-0000f4b0: 286f 7074 696e 616c 2c20 626f 6f6c 290a  (optinal, bool).
-0000f4c0: 2020 2020 2020 2020 426f 6f6c 6561 6e20          Boolean 
-0000f4d0: 696e 6469 6361 7469 6e67 2069 6620 6c69  indicating if li
-0000f4e0: 6768 7420 7472 6176 656c 2074 696d 6520  ght travel time 
-0000f4f0: 6465 6c61 7920 7761 6e74 7320 746f 2062  delay wants to b
-0000f500: 6520 696e 636c 7564 6564 206f 6e20 6563  e included on ec
-0000f510: 6c69 7073 6520 7469 6d65 2063 616c 6375  lipse time calcu
-0000f520: 6c61 7469 6f6e 732e 0a0a 2020 2020 3a70  lations...    :p
-0000f530: 6172 616d 2073 7465 6c6c 6172 5f72 6164  aram stellar_rad
-0000f540: 6975 733a 2028 6f70 7469 6f6e 616c 2c20  ius: (optional, 
-0000f550: 666c 6f61 7429 0a20 2020 2020 2020 2053  float).        S
-0000f560: 7465 6c6c 6172 2072 6164 6975 7320 696e  tellar radius in
-0000f570: 2075 6e69 7473 206f 6620 736f 6c61 722d   units of solar-
-0000f580: 7261 6469 6920 746f 2075 7365 2066 6f72  radii to use for
-0000f590: 2074 6865 206c 6967 6874 2074 7261 7665   the light trave
-0000f5a0: 6c20 7469 6d65 2063 6f72 7265 6374 696f  l time correctio
-0000f5b0: 6e73 2e0a 0a20 2020 2049 6e20 6164 6469  ns...    In addi
-0000f5c0: 7469 6f6e 2c20 616e 7920 6e75 6d62 6572  tion, any number
-0000f5d0: 206f 6620 6578 7472 6120 6f70 7469 6f6e   of extra option
-0000f5e0: 616c 206b 6579 776f 7264 7320 6361 6e20  al keywords can 
-0000f5f0: 6265 2067 6976 656e 2074 6f20 7468 6520  be given to the 
-0000f600: 6361 6c6c 2c20 7768 6963 6820 7769 6c6c  call, which will
-0000f610: 2062 6520 6469 7265 6374 6c79 2069 6e67   be directly ing
-0000f620: 6573 7465 6420 696e 746f 2074 6865 2073  ested into the s
-0000f630: 616d 706c 6572 206f 6620 6368 6f69 6365  ampler of choice
-0000f640: 2e20 466f 7220 6120 6675 6c6c 206c 6973  . For a full lis
-0000f650: 7420 6f66 206f 7074 696f 6e61 6c20 6b65  t of optional ke
-0000f660: 7977 6f72 6473 2066 6f72 2e2e 2e0a 0a20  ywords for..... 
-0000f670: 2020 202d 202e 2e2e 5079 4d75 6c74 694e     - ...PyMultiN
-0000f680: 6573 742c 2063 6865 636b 2074 6865 2064  est, check the d
-0000f690: 6f63 7374 7269 6e67 206f 6620 6060 5079  ocstring of ``Py
-0000f6a0: 4d75 6c74 694e 6573 7460 6027 7320 6060  MultiNest``'s ``
-0000f6b0: 7275 6e60 6020 6066 756e 6374 696f 6e20  run`` `function 
-0000f6c0: 3c68 7474 7073 3a2f 2f67 6974 6875 622e  <https://github.
-0000f6d0: 636f 6d2f 4a6f 6861 6e6e 6573 4275 6368  com/JohannesBuch
-0000f6e0: 6e65 722f 5079 4d75 6c74 694e 6573 742f  ner/PyMultiNest/
-0000f6f0: 626c 6f62 2f6d 6173 7465 722f 7079 6d75  blob/master/pymu
-0000f700: 6c74 696e 6573 742f 7275 6e2e 7079 3e60  ltinest/run.py>`
-0000f710: 5f2e 0a0a 2020 2020 2d20 2e2e 2e61 6e79  _...    - ...any
-0000f720: 206f 6620 7468 6520 6e65 7374 6564 2073   of the nested s
-0000f730: 616d 706c 696e 6720 616c 676f 7269 7468  ampling algorith
-0000f740: 6d73 2069 6e20 6060 6479 6e65 7374 7960  ms in ``dynesty`
-0000f750: 602c 2073 6565 2074 6865 2064 6f63 7374  `, see the docst
-0000f760: 7269 6e67 206f 6e20 7468 6520 6060 7275  ring on the ``ru
-0000f770: 6e5f 6e65 7374 6564 6060 2060 6675 6e63  n_nested`` `func
-0000f780: 7469 6f6e 203c 6874 7470 733a 2f2f 6479  tion <https://dy
-0000f790: 6e65 7374 792e 7265 6164 7468 6564 6f63  nesty.readthedoc
-0000f7a0: 732e 696f 2f65 6e2f 6c61 7465 7374 2f61  s.io/en/latest/a
-0000f7b0: 7069 2e68 746d 6c23 6479 6e65 7374 792e  pi.html#dynesty.
-0000f7c0: 6479 6e61 6d69 6373 616d 706c 6572 2e44  dynamicsampler.D
-0000f7d0: 796e 616d 6963 5361 6d70 6c65 722e 7275  ynamicSampler.ru
-0000f7e0: 6e5f 6e65 7374 6564 3e60 5f2e 0a0a 2020  n_nested>`_...  
-0000f7f0: 2020 2d20 2e2e 2e74 6865 206e 6f6e 2d64    - ...the non-d
-0000f800: 796e 616d 6963 206e 6573 7465 6420 7361  ynamic nested sa
-0000f810: 6d70 6c69 6e67 2061 6c67 6f72 6974 686d  mpling algorithm
-0000f820: 2069 6d70 6c65 6d65 6e74 6564 2069 6e20   implemented in 
-0000f830: 6060 6479 6e65 7374 7960 602c 2073 6565  ``dynesty``, see
-0000f840: 2074 6865 2064 6f63 7374 7269 6e67 206f   the docstring o
-0000f850: 6e20 6060 6479 6e65 7374 792e 6479 6e65  n ``dynesty.dyne
-0000f860: 7374 792e 4e65 7374 6564 5361 6d70 6c65  sty.NestedSample
-0000f870: 7260 6020 696e 2060 6479 6e65 7374 7927  r`` in `dynesty'
-0000f880: 7320 646f 6375 6d65 6e74 6174 696f 6e20  s documentation 
-0000f890: 3c68 7474 7073 3a2f 2f64 796e 6573 7479  <https://dynesty
-0000f8a0: 2e72 6561 6474 6865 646f 6373 2e69 6f2f  .readthedocs.io/
-0000f8b0: 656e 2f6c 6174 6573 742f 6170 692e 6874  en/latest/api.ht
-0000f8c0: 6d6c 3e60 5f2e 0a0a 2020 2020 2d20 2e2e  ml>`_...    - ..
-0000f8d0: 2e74 6865 2064 796e 616d 6963 206e 6573  .the dynamic nes
-0000f8e0: 7465 6420 7361 6d70 6c69 6e67 2069 6e20  ted sampling in 
-0000f8f0: 6060 6479 6e65 7374 7960 6020 6368 6563  ``dynesty`` chec
-0000f900: 6b20 7468 6520 646f 6373 7472 696e 6720  k the docstring 
-0000f910: 666f 7220 6060 6479 6e65 7374 792e 6479  for ``dynesty.dy
-0000f920: 6e65 7374 792e 4479 6e61 6d69 634e 6573  nesty.DynamicNes
-0000f930: 7465 6453 616d 706c 6572 6060 2069 6e20  tedSampler`` in 
-0000f940: 6064 796e 6573 7479 2773 2064 6f63 756d  `dynesty's docum
-0000f950: 656e 7461 7469 6f6e 203c 6874 7470 733a  entation <https:
-0000f960: 2f2f 6479 6e65 7374 792e 7265 6164 7468  //dynesty.readth
-0000f970: 6564 6f63 732e 696f 2f65 6e2f 6c61 7465  edocs.io/en/late
-0000f980: 7374 2f61 7069 2e68 746d 6c3e 605f 2e0a  st/api.html>`_..
-0000f990: 0a20 2020 202d 202e 2e2e 7468 6520 6060  .    - ...the ``
-0000f9a0: 756c 7472 616e 6573 7460 6020 7361 6d70  ultranest`` samp
-0000f9b0: 6c65 722c 2073 6565 2074 6865 2064 6f63  ler, see the doc
-0000f9c0: 7374 7269 6e67 2066 6f72 2060 756c 7472  string for `ultr
-0000f9d0: 616e 6573 742e 696e 7465 6772 6174 696f  anest.integratio
-0000f9e0: 6e72 2e52 6561 6374 6976 654e 6573 7465  nr.ReactiveNeste
-0000f9f0: 6453 616d 706c 6572 6020 696e 2060 756c  dSampler` in `ul
-0000fa00: 7472 616e 6573 7427 7320 646f 6375 6d65  tranest's docume
-0000fa10: 6e74 6174 696f 6e20 3c68 7474 7073 3a2f  ntation <https:/
-0000fa20: 2f6a 6f68 616e 6e65 7362 7563 686e 6572  /johannesbuchner
-0000fa30: 2e67 6974 6875 622e 696f 2f55 6c74 7261  .github.io/Ultra
-0000fa40: 4e65 7374 2f75 6c74 7261 6e65 7374 2e68  Nest/ultranest.h
-0000fa50: 746d 6c23 756c 7472 616e 6573 742e 696e  tml#ultranest.in
-0000fa60: 7465 6772 6174 6f72 2e52 6561 6374 6976  tegrator.Reactiv
-0000fa70: 654e 6573 7465 6453 616d 706c 6572 3e60  eNestedSampler>`
-0000fa80: 5f0a 0a20 2020 2046 696e 616c 6c79 2c20  _..    Finally, 
-0000fa90: 7369 6e63 6520 6060 6a75 6c69 6574 6060  since ``juliet``
-0000faa0: 2076 6572 7369 6f6e 2032 2e30 2e32 362c   version 2.0.26,
-0000fab0: 2074 6865 2066 6f6c 6c6f 7769 6e67 206b   the following k
-0000fac0: 6579 776f 7264 7320 6861 7665 2062 6565  eywords have bee
-0000fad0: 6e20 6465 7072 6563 6174 6564 2c20 616e  n deprecated, an
-0000fae0: 6420 6172 6520 7265 636f 6d6d 656e 6465  d are recommende
-0000faf0: 6420 746f 2062 6520 7265 6d6f 7665 6420  d to be removed 
-0000fb00: 6672 6f6d 2063 6f64 6520 7573 696e 6720  from code using 
-0000fb10: 6060 6a75 6c69 6574 6060 2061 7320 7468  ``juliet`` as th
-0000fb20: 6579 0a20 2020 2077 696c 6c20 6265 2072  ey.    will be r
-0000fb30: 656d 6f76 6564 2073 6f6d 6574 696d 6520  emoved sometime 
-0000fb40: 696e 2074 6865 2066 7574 7572 653a 0a0a  in the future:..
-0000fb50: 2020 2020 3a70 6172 616d 2075 7365 5f64      :param use_d
-0000fb60: 796e 6573 7479 3a20 286f 7074 696f 6e61  ynesty: (optiona
-0000fb70: 6c2c 2062 6f6f 6c65 616e 290a 2020 2020  l, boolean).    
-0000fb80: 2020 2020 4966 2060 6054 7275 6560 602c      If ``True``,
-0000fb90: 2075 7365 2064 796e 6573 7479 2069 6e73   use dynesty ins
-0000fba0: 7465 6164 206f 6620 604d 756c 7469 4e65  tead of `MultiNe
-0000fbb0: 7374 6020 666f 7220 706f 7374 6572 696f  st` for posterio
-0000fbc0: 7220 7361 6d70 6c69 6e67 2061 6e64 2065  r sampling and e
-0000fbd0: 7669 6465 6e63 6520 6576 616c 7561 7469  vidence evaluati
-0000fbe0: 6f6e 2e20 4465 6661 756c 7420 6973 0a20  on. Default is. 
-0000fbf0: 2020 2020 2020 2060 6046 616c 7365 6060         ``False``
-0000fc00: 2c20 756e 6c65 7373 2060 4d75 6c74 694e  , unless `MultiN
-0000fc10: 6573 7460 2076 6961 2060 6070 796d 756c  est` via ``pymul
-0000fc20: 7469 6e65 7374 6060 2069 7320 6e6f 7420  tinest`` is not 
-0000fc30: 776f 726b 696e 6720 6f6e 2074 6865 2073  working on the s
-0000fc40: 7973 7465 6d2e 0a0a 2020 2020 3a70 6172  ystem...    :par
-0000fc50: 616d 2064 796e 616d 6963 3a20 286f 7074  am dynamic: (opt
-0000fc60: 696f 6e61 6c2c 2062 6f6f 6c65 616e 290a  ional, boolean).
-0000fc70: 2020 2020 2020 2020 4966 2060 6054 7275          If ``Tru
-0000fc80: 6560 602c 2075 7365 2064 796e 616d 6963  e``, use dynamic
-0000fc90: 204e 6573 7465 6420 5361 6d70 6c69 6e67   Nested Sampling
-0000fca0: 2077 6974 6820 6479 6e65 7374 792e 2044   with dynesty. D
-0000fcb0: 6566 6175 6c74 2069 7320 6060 4661 6c73  efault is ``Fals
-0000fcc0: 6560 602e 0a0a 2020 2020 3a70 6172 616d  e``...    :param
-0000fcd0: 2064 796e 6573 7479 5f62 6f75 6e64 3a20   dynesty_bound: 
-0000fce0: 286f 7074 696f 6e61 6c2c 2073 7472 696e  (optional, strin
-0000fcf0: 6729 0a20 2020 2020 2020 2044 6566 696e  g).        Defin
-0000fd00: 6520 7468 6520 6479 6e65 7374 7920 626f  e the dynesty bo
-0000fd10: 756e 6420 6d65 7468 6f64 2074 6f20 7573  und method to us
-0000fd20: 6520 2863 7572 7265 6e74 6c79 2065 6974  e (currently eit
-0000fd30: 6865 7220 6060 7369 6e67 6c65 6060 206f  her ``single`` o
-0000fd40: 7220 6060 6d75 6c74 6960 602c 2074 6f20  r ``multi``, to 
-0000fd50: 7573 6520 6569 7468 6572 2073 696e 676c  use either singl
-0000fd60: 6520 656c 6c69 7073 6f69 6473 206f 7220  e ellipsoids or 
-0000fd70: 6d75 6c74 6970 6c65 0a20 2020 2020 2020  multiple.       
-0000fd80: 2065 6c6c 6970 736f 6964 7329 2e20 4465   ellipsoids). De
-0000fd90: 6661 756c 7420 6973 2060 606d 756c 7469  fault is ``multi
-0000fda0: 6060 2028 666f 7220 6465 7461 696c 732c  `` (for details,
-0000fdb0: 2073 6565 2074 6865 2060 6479 6e65 7374   see the `dynest
-0000fdc0: 7920 4150 4920 3c68 7474 7073 3a2f 2f64  y API <https://d
-0000fdd0: 796e 6573 7479 2e72 6561 6474 6865 646f  ynesty.readthedo
-0000fde0: 6373 2e69 6f2f 656e 2f6c 6174 6573 742f  cs.io/en/latest/
-0000fdf0: 6170 692e 6874 6d6c 3e60 5f29 2e0a 0a20  api.html>`_)... 
-0000fe00: 2020 203a 7061 7261 6d20 6479 6e65 7374     :param dynest
-0000fe10: 795f 7361 6d70 6c65 3a20 286f 7074 696f  y_sample: (optio
-0000fe20: 6e61 6c2c 2073 7472 696e 6729 0a20 2020  nal, string).   
-0000fe30: 2020 2020 2044 6566 696e 6520 7468 6520       Define the 
-0000fe40: 7361 6d70 6c69 6e67 206d 6574 686f 6420  sampling method 
-0000fe50: 666f 7220 6479 6e65 7374 7920 746f 2075  for dynesty to u
-0000fe60: 7365 2e20 4465 6661 756c 7420 6973 2060  se. Default is `
-0000fe70: 6072 7761 6c6b 6060 2e20 4163 636f 7266  `rwalk``. Accorf
-0000fe80: 696e 6720 746f 2074 6865 2060 6479 6e65  ing to the `dyne
-0000fe90: 7374 7920 4150 4920 3c68 7474 7073 3a2f  sty API <https:/
-0000fea0: 2f64 796e 6573 7479 2e72 6561 6474 6865  /dynesty.readthe
-0000feb0: 646f 6373 2e69 6f2f 656e 2f6c 6174 6573  docs.io/en/lates
-0000fec0: 742f 6170 692e 6874 6d6c 3e60 5f2c 0a20  t/api.html>`_,. 
-0000fed0: 2020 2020 2020 2074 6869 7320 7368 6f75         this shou
-0000fee0: 6c64 2062 6520 6368 616e 6765 6420 6465  ld be changed de
-0000fef0: 7065 6e64 696e 6720 6f6e 2074 6865 206e  pending on the n
-0000ff00: 756d 6265 7220 6f66 2070 6172 616d 6574  umber of paramet
-0000ff10: 6572 7320 6265 696e 6720 6669 7474 6564  ers being fitted
-0000ff20: 2e20 4966 2073 6d61 6c6c 6572 2074 6861  . If smaller tha
-0000ff30: 6e20 6162 6f75 7420 3230 2c20 6060 7277  n about 20, ``rw
-0000ff40: 616c 6b60 6020 6973 206f 7074 696d 616c  alk`` is optimal
-0000ff50: 2e20 466f 7220 6c61 7267 6572 2064 696d  . For larger dim
-0000ff60: 656e 7369 6f6e 732c 0a20 2020 2020 2020  ensions,.       
-0000ff70: 2060 6073 6c69 6365 6060 206f 7220 6060   ``slice`` or ``
-0000ff80: 7273 6c69 6365 6060 2073 686f 756c 6420  rslice`` should 
-0000ff90: 6265 2075 7365 642e 0a0a 2020 2020 3a70  be used...    :p
-0000ffa0: 6172 616d 2064 796e 6573 7479 5f6e 7468  aram dynesty_nth
-0000ffb0: 7265 6164 733a 2028 6f70 7469 6f6e 616c  reads: (optional
-0000ffc0: 2c20 696e 7429 0a20 2020 2020 2020 2044  , int).        D
-0000ffd0: 6566 696e 6520 7468 6520 6e75 6d62 6572  efine the number
-0000ffe0: 206f 6620 7468 7265 6164 7320 746f 2075   of threads to u
-0000fff0: 7365 2077 6974 6869 6e20 6479 6e65 7374  se within dynest
-00010000: 792e 2044 6566 6175 6c74 2069 7320 746f  y. Default is to
-00010010: 2075 7365 206a 7573 7420 312e 0a0a 2020   use just 1...  
-00010020: 2020 3a70 6172 616d 2064 796e 6573 7479    :param dynesty
-00010030: 5f6e 5f65 6666 6563 7469 7665 3a20 286f  _n_effective: (o
-00010040: 7074 696f 6e61 6c2c 2069 6e74 290a 2020  ptional, int).  
-00010050: 2020 2020 2020 4d69 6e69 6d75 6d20 6e75        Minimum nu
-00010060: 6d62 6572 206f 6620 6566 6665 6374 6976  mber of effectiv
-00010070: 6520 706f 7374 6572 696f 7220 7361 6d70  e posterior samp
-00010080: 6c65 7320 7768 656e 2075 7369 6e67 2060  les when using `
-00010090: 6064 796e 6573 7479 6060 2e20 4966 2074  `dynesty``. If t
-000100a0: 6865 2065 7374 696d 6174 6564 20e2 809c  he estimated ...
-000100b0: 6566 6665 6374 6976 6520 7361 6d70 6c65  effective sample
-000100c0: 2073 697a 65e2 809d 2065 7863 6565 6473   size... exceeds
-000100d0: 2074 6869 7320 6e75 6d62 6572 2c20 7361   this number, sa
-000100e0: 6d70 6c69 6e67 2077 696c 6c20 7465 726d  mpling will term
-000100f0: 696e 6174 652e 2044 6566 6175 6c74 2069  inate. Default i
-00010100: 7320 6060 4e6f 6e65 6060 2e0a 0a20 2020  s ``None``...   
-00010110: 203a 7061 7261 6d20 6479 6e65 7374 795f   :param dynesty_
-00010120: 7573 655f 7374 6f70 3a20 286f 7074 696f  use_stop: (optio
-00010130: 6e61 6c2c 2062 6f6f 6c65 616e 290a 2020  nal, boolean).  
-00010140: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
-00010150: 2065 7661 6c75 6174 6520 7468 6520 6060   evaluate the ``
-00010160: 6479 6e65 7374 7960 6020 7374 6f70 7069  dynesty`` stoppi
-00010170: 6e67 2066 756e 6374 696f 6e20 6166 7465  ng function afte
-00010180: 7220 6561 6368 2062 6174 6368 2e20 4469  r each batch. Di
-00010190: 7361 626c 696e 6720 7468 6973 2063 616e  sabling this can
-000101a0: 2069 6d70 726f 7665 2070 6572 666f 726d   improve perform
-000101b0: 616e 6365 2069 6620 6f74 6865 7220 7374  ance if other st
-000101c0: 6f70 7069 6e67 2063 7269 7465 7269 6120  opping criteria 
-000101d0: 7375 6368 2061 7320 6d61 7863 616c 6c20  such as maxcall 
-000101e0: 6172 6520 616c 7265 6164 7920 7370 6563  are already spec
-000101f0: 6966 6965 642e 0a20 2020 2020 2020 2044  ified..        D
-00010200: 6566 6175 6c74 2069 7320 6060 5472 7565  efault is ``True
-00010210: 6060 2e0a 0a20 2020 203a 7061 7261 6d20  ``...    :param 
-00010220: 6479 6e65 7374 795f 7573 655f 706f 6f6c  dynesty_use_pool
-00010230: 3a20 286f 7074 696f 6e61 6c2c 2064 6963  : (optional, dic
-00010240: 7429 0a20 2020 2020 2020 2041 2064 6963  t).        A dic
-00010250: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
-00010260: 6e67 2066 6c61 6773 2069 6e64 6963 6174  ng flags indicat
-00010270: 696e 6720 7768 6572 6520 6120 706f 6f6c  ing where a pool
-00010280: 2069 6e20 6060 6479 6e65 7374 7960 6020   in ``dynesty`` 
-00010290: 7368 6f75 6c64 2062 6520 7573 6564 2074  should be used t
-000102a0: 6f20 6578 6563 7574 6520 6f70 6572 6174  o execute operat
-000102b0: 696f 6e73 2069 6e20 7061 7261 6c6c 656c  ions in parallel
-000102c0: 2e20 5468 6573 6520 676f 7665 726e 2077  . These govern w
-000102d0: 6865 7468 6572 2060 6070 7269 6f72 5f74  hether ``prior_t
-000102e0: 7261 6e73 666f 726d 6060 2069 7320 6578  ransform`` is ex
-000102f0: 6563 7574 6564 2069 6e20 7061 7261 6c6c  ecuted in parall
-00010300: 656c 2064 7572 696e 670a 2020 2020 2020  el during.      
-00010310: 2020 696e 6974 6961 6c69 7a61 7469 6f6e    initialization
-00010320: 2028 6060 2770 7269 6f72 5f74 7261 6e73   (``'prior_trans
-00010330: 666f 726d 2760 6029 2c20 6c6f 676c 696b  form'``), loglik
-00010340: 656c 6968 6f6f 6420 6973 2065 7865 6375  elihood is execu
-00010350: 7465 6420 696e 2070 6172 616c 6c65 6c20  ted in parallel 
-00010360: 6475 7269 6e67 2069 6e69 7469 616c 697a  during initializ
-00010370: 6174 696f 6e20 2860 6027 6c6f 676c 696b  ation (``'loglik
-00010380: 656c 6968 6f6f 6427 6060 292c 206c 6976  elihood'``), liv
-00010390: 6520 706f 696e 7473 2061 7265 2070 726f  e points are pro
-000103a0: 706f 7365 6420 696e 2070 6172 616c 6c65  posed in paralle
-000103b0: 6c20 6475 7269 6e67 2061 2072 756e 0a20  l during a run. 
-000103c0: 2020 2020 2020 2028 6060 2770 726f 706f         (``'propo
-000103d0: 7365 5f70 6f69 6e74 2760 6029 2c20 616e  se_point'``), an
-000103e0: 6420 626f 756e 6469 6e67 2064 6973 7472  d bounding distr
-000103f0: 6962 7574 696f 6e73 2061 7265 2075 7064  ibutions are upd
-00010400: 6174 6564 2069 6e20 7061 7261 6c6c 656c  ated in parallel
-00010410: 2064 7572 696e 6720 6120 7275 6e20 2860   during a run (`
-00010420: 6027 7570 6461 7465 5f62 6f75 6e64 2760  `'update_bound'`
-00010430: 6029 2e20 4465 6661 756c 7420 6973 2054  `). Default is T
-00010440: 7275 6520 666f 7220 616c 6c20 6f70 7469  rue for all opti
-00010450: 6f6e 732e 0a0a 2020 2020 2222 220a 0a20  ons...    """.. 
-00010460: 2020 2064 6566 2073 6574 5f70 7269 6f72     def set_prior
-00010470: 5f74 7261 6e73 666f 726d 2873 656c 6629  _transform(self)
-00010480: 3a0a 2020 2020 2020 2020 666f 7220 706e  :.        for pn
-00010490: 616d 6520 696e 2073 656c 662e 6d6f 6465  ame in self.mode
-000104a0: 6c5f 7061 7261 6d65 7465 7273 3a0a 2020  l_parameters:.  
-000104b0: 2020 2020 2020 2020 2020 6469 7374 5f6e            dist_n
-000104c0: 616d 6520 3d20 7365 6c66 2e64 6174 612e  ame = self.data.
-000104d0: 7072 696f 7273 5b70 6e61 6d65 5d5b 2764  priors[pname]['d
-000104e0: 6973 7472 6962 7574 696f 6e27 5d2e 6c6f  istribution'].lo
-000104f0: 7765 7228 290a 2020 2020 2020 2020 2020  wer().          
-00010500: 2020 6966 2064 6973 745f 6e61 6d65 2021    if dist_name !
-00010510: 3d20 2766 6978 6564 273a 0a20 2020 2020  = 'fixed':.     
-00010520: 2020 2020 2020 2020 2020 2069 6620 6469             if di
-00010530: 7374 5f6e 616d 6520 3d3d 2027 756e 6966  st_name == 'unif
-00010540: 6f72 6d27 3a0a 2020 2020 2020 2020 2020  orm':.          
-00010550: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
-00010560: 7261 6e73 666f 726d 5f70 7269 6f72 5b70  ransform_prior[p
-00010570: 6e61 6d65 5d20 3d20 7472 616e 7366 6f72  name] = transfor
-00010580: 6d5f 756e 6966 6f72 6d0a 2020 2020 2020  m_uniform.      
-00010590: 2020 2020 2020 2020 2020 6966 2064 6973            if dis
-000105a0: 745f 6e61 6d65 203d 3d20 276e 6f72 6d61  t_name == 'norma
-000105b0: 6c27 3a0a 2020 2020 2020 2020 2020 2020  l':.            
-000105c0: 2020 2020 2020 2020 7365 6c66 2e74 7261          self.tra
-000105d0: 6e73 666f 726d 5f70 7269 6f72 5b70 6e61  nsform_prior[pna
-000105e0: 6d65 5d20 3d20 7472 616e 7366 6f72 6d5f  me] = transform_
-000105f0: 6e6f 726d 616c 0a20 2020 2020 2020 2020  normal.         
-00010600: 2020 2020 2020 2069 6620 6469 7374 5f6e         if dist_n
-00010610: 616d 6520 3d3d 2027 7472 756e 6361 7465  ame == 'truncate
-00010620: 646e 6f72 6d61 6c27 3a0a 2020 2020 2020  dnormal':.      
-00010630: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00010640: 6c66 2e74 7261 6e73 666f 726d 5f70 7269  lf.transform_pri
-00010650: 6f72 5b70 6e61 6d65 5d20 3d20 7472 616e  or[pname] = tran
-00010660: 7366 6f72 6d5f 7472 756e 6361 7465 645f  sform_truncated_
-00010670: 6e6f 726d 616c 0a0a 2020 2020 2020 2020  normal..        
-00010680: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00010690: 6461 7461 2e70 7269 6f72 735b 706e 616d  data.priors[pnam
-000106a0: 655d 5b0a 2020 2020 2020 2020 2020 2020  e][.            
-000106b0: 2020 2020 2020 2020 2020 2020 2764 6973              'dis
-000106c0: 7472 6962 7574 696f 6e27 5d20 3d3d 2027  tribution'] == '
-000106d0: 6a65 6666 7265 7973 2720 6f72 2073 656c  jeffreys' or sel
-000106e0: 662e 6461 7461 2e70 7269 6f72 735b 0a20  f.data.priors[. 
-000106f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010700: 2020 2020 2020 2020 2020 2070 6e61 6d65             pname
-00010710: 5d5b 2764 6973 7472 6962 7574 696f 6e27  ]['distribution'
-00010720: 5d20 3d3d 2027 6c6f 6775 6e69 666f 726d  ] == 'loguniform
-00010730: 273a 0a0a 2020 2020 2020 2020 2020 2020  ':..            
-00010740: 2020 2020 2020 2020 7365 6c66 2e74 7261          self.tra
-00010750: 6e73 666f 726d 5f70 7269 6f72 5b70 6e61  nsform_prior[pna
-00010760: 6d65 5d20 3d20 7472 616e 7366 6f72 6d5f  me] = transform_
-00010770: 6c6f 6775 6e69 666f 726d 0a20 2020 2020  loguniform.     
-00010780: 2020 2020 2020 2020 2020 2069 6620 6469             if di
-00010790: 7374 5f6e 616d 6520 3d3d 2027 6265 7461  st_name == 'beta
-000107a0: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-000107b0: 2020 2020 2020 2073 656c 662e 7472 616e         self.tran
-000107c0: 7366 6f72 6d5f 7072 696f 725b 706e 616d  sform_prior[pnam
-000107d0: 655d 203d 2074 7261 6e73 666f 726d 5f62  e] = transform_b
-000107e0: 6574 610a 2020 2020 2020 2020 2020 2020  eta.            
-000107f0: 2020 2020 6966 2064 6973 745f 6e61 6d65      if dist_name
-00010800: 203d 3d20 2765 7870 6f6e 656e 7469 616c   == 'exponential
-00010810: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-00010820: 2020 2020 2020 2073 656c 662e 7472 616e         self.tran
-00010830: 7366 6f72 6d5f 7072 696f 725b 706e 616d  sform_prior[pnam
-00010840: 655d 203d 2074 7261 6e73 666f 726d 5f65  e] = transform_e
-00010850: 7870 6f6e 656e 7469 616c 0a20 2020 2020  xponential.     
-00010860: 2020 2020 2020 2020 2020 2069 6620 6469             if di
-00010870: 7374 5f6e 616d 6520 3d3d 2027 6d6f 646a  st_name == 'modj
-00010880: 6566 6672 6579 7327 3a0a 2020 2020 2020  effreys':.      
-00010890: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000108a0: 6c66 2e74 7261 6e73 666f 726d 5f70 7269  lf.transform_pri
-000108b0: 6f72 5b70 6e61 6d65 5d20 3d20 7472 616e  or[pname] = tran
-000108c0: 7366 6f72 6d5f 6d6f 6469 6669 6564 6a65  sform_modifiedje
-000108d0: 6666 7265 7973 0a0a 2020 2020 6465 6620  ffreys..    def 
-000108e0: 7365 745f 6c6f 6770 7269 6f72 7328 7365  set_logpriors(se
-000108f0: 6c66 293a 0a20 2020 2020 2020 2066 6f72  lf):.        for
-00010900: 2070 6e61 6d65 2069 6e20 7365 6c66 2e6d   pname in self.m
-00010910: 6f64 656c 5f70 6172 616d 6574 6572 733a  odel_parameters:
-00010920: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
-00010930: 745f 6e61 6d65 203d 2073 656c 662e 6461  t_name = self.da
-00010940: 7461 2e70 7269 6f72 735b 706e 616d 655d  ta.priors[pname]
-00010950: 5b27 6469 7374 7269 6275 7469 6f6e 275d  ['distribution']
-00010960: 2e6c 6f77 6572 2829 0a20 2020 2020 2020  .lower().       
-00010970: 2020 2020 2069 6620 6469 7374 5f6e 616d       if dist_nam
-00010980: 6520 213d 2027 6669 7865 6427 3a0a 2020  e != 'fixed':.  
-00010990: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000109a0: 2064 6973 745f 6e61 6d65 203d 3d20 2775   dist_name == 'u
-000109b0: 6e69 666f 726d 273a 0a20 2020 2020 2020  niform':.       
-000109c0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000109d0: 662e 6576 616c 7561 7465 5f6c 6f67 7072  f.evaluate_logpr
-000109e0: 696f 725b 706e 616d 655d 203d 2065 7661  ior[pname] = eva
-000109f0: 6c75 6174 655f 756e 6966 6f72 6d0a 2020  luate_uniform.  
-00010a00: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00010a10: 2064 6973 745f 6e61 6d65 203d 3d20 276e   dist_name == 'n
-00010a20: 6f72 6d61 6c27 3a0a 2020 2020 2020 2020  ormal':.        
-00010a30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00010a40: 2e65 7661 6c75 6174 655f 6c6f 6770 7269  .evaluate_logpri
-00010a50: 6f72 5b70 6e61 6d65 5d20 3d20 6576 616c  or[pname] = eval
-00010a60: 7561 7465 5f6e 6f72 6d61 6c0a 2020 2020  uate_normal.    
-00010a70: 2020 2020 2020 2020 2020 2020 6966 2064              if d
-00010a80: 6973 745f 6e61 6d65 203d 3d20 2774 7275  ist_name == 'tru
-00010a90: 6e63 6174 6564 6e6f 726d 616c 273a 0a20  ncatednormal':. 
-00010aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ab0: 2020 2073 656c 662e 6576 616c 7561 7465     self.evaluate
-00010ac0: 5f6c 6f67 7072 696f 725b 706e 616d 655d  _logprior[pname]
-00010ad0: 203d 2065 7661 6c75 6174 655f 7472 756e   = evaluate_trun
-00010ae0: 6361 7465 645f 6e6f 726d 616c 0a0a 2020  cated_normal..  
-00010af0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00010b00: 2073 656c 662e 6461 7461 2e70 7269 6f72   self.data.prior
-00010b10: 735b 706e 616d 655d 5b0a 2020 2020 2020  s[pname][.      
-00010b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b30: 2020 2764 6973 7472 6962 7574 696f 6e27    'distribution'
-00010b40: 5d20 3d3d 2027 6a65 6666 7265 7973 2720  ] == 'jeffreys' 
-00010b50: 6f72 2073 656c 662e 6461 7461 2e70 7269  or self.data.pri
-00010b60: 6f72 735b 0a20 2020 2020 2020 2020 2020  ors[.           
-00010b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b80: 2070 6e61 6d65 5d5b 2764 6973 7472 6962   pname]['distrib
-00010b90: 7574 696f 6e27 5d20 3d3d 2027 6c6f 6775  ution'] == 'logu
-00010ba0: 6e69 666f 726d 273a 0a0a 2020 2020 2020  niform':..      
-00010bb0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00010bc0: 6c66 2e65 7661 6c75 6174 655f 6c6f 6770  lf.evaluate_logp
-00010bd0: 7269 6f72 5b70 6e61 6d65 5d20 3d20 6576  rior[pname] = ev
-00010be0: 616c 7561 7465 5f6c 6f67 756e 6966 6f72  aluate_logunifor
-00010bf0: 6d0a 2020 2020 2020 2020 2020 2020 2020  m.              
-00010c00: 2020 6966 2064 6973 745f 6e61 6d65 203d    if dist_name =
-00010c10: 3d20 2762 6574 6127 3a0a 2020 2020 2020  = 'beta':.      
-00010c20: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00010c30: 6c66 2e65 7661 6c75 6174 655f 6c6f 6770  lf.evaluate_logp
-00010c40: 7269 6f72 5b70 6e61 6d65 5d20 3d20 6576  rior[pname] = ev
-00010c50: 616c 7561 7465 5f62 6574 610a 2020 2020  aluate_beta.    
-00010c60: 2020 2020 2020 2020 2020 2020 6966 2064              if d
-00010c70: 6973 745f 6e61 6d65 203d 3d20 2765 7870  ist_name == 'exp
-00010c80: 6f6e 656e 7469 616c 273a 0a20 2020 2020  onential':.     
-00010c90: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00010ca0: 656c 662e 6576 616c 7561 7465 5f6c 6f67  elf.evaluate_log
-00010cb0: 7072 696f 725b 706e 616d 655d 203d 2065  prior[pname] = e
-00010cc0: 7661 6c75 6174 655f 6578 706f 6e65 6e74  valuate_exponent
-00010cd0: 6961 6c0a 2020 2020 2020 2020 2020 2020  ial.            
-00010ce0: 2020 2020 6966 2064 6973 745f 6e61 6d65      if dist_name
-00010cf0: 203d 3d20 276d 6f64 6a65 6666 7265 7973   == 'modjeffreys
-00010d00: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-00010d10: 2020 2020 2020 2073 656c 662e 6576 616c         self.eval
-00010d20: 7561 7465 5f6c 6f67 7072 696f 725b 706e  uate_logprior[pn
-00010d30: 616d 655d 203d 2065 7661 6c75 6174 655f  ame] = evaluate_
-00010d40: 6d6f 6469 6669 6564 6a65 6666 7265 7973  modifiedjeffreys
-00010d50: 0a0a 2020 2020 2320 5072 696f 7220 7472  ..    # Prior tr
-00010d60: 616e 7366 6f72 6d20 666f 7220 6e65 7374  ansform for nest
-00010d70: 6564 2073 616d 706c 6572 733a 0a20 2020  ed samplers:.   
-00010d80: 2064 6566 2070 7269 6f72 5f74 7261 6e73   def prior_trans
-00010d90: 666f 726d 2873 656c 662c 2063 7562 652c  form(self, cube,
-00010da0: 206e 6469 6d3d 4e6f 6e65 2c20 6e70 6172   ndim=None, npar
-00010db0: 616d 733d 4e6f 6e65 293a 0a20 2020 2020  ams=None):.     
-00010dc0: 2020 2070 636f 756e 7465 7220 3d20 300a     pcounter = 0.
-00010dd0: 2020 2020 2020 2020 666f 7220 706e 616d          for pnam
-00010de0: 6520 696e 2073 656c 662e 6d6f 6465 6c5f  e in self.model_
-00010df0: 7061 7261 6d65 7465 7273 3a0a 2020 2020  parameters:.    
-00010e00: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00010e10: 6461 7461 2e70 7269 6f72 735b 706e 616d  data.priors[pnam
-00010e20: 655d 5b27 6469 7374 7269 6275 7469 6f6e  e]['distribution
-00010e30: 275d 2e6c 6f77 6572 2829 2021 3d20 2766  '].lower() != 'f
-00010e40: 6978 6564 273a 0a20 2020 2020 2020 2020  ixed':.         
-00010e50: 2020 2020 2020 2063 7562 655b 7063 6f75         cube[pcou
-00010e60: 6e74 6572 5d20 3d20 7365 6c66 2e74 7261  nter] = self.tra
-00010e70: 6e73 666f 726d 5f70 7269 6f72 5b70 6e61  nsform_prior[pna
-00010e80: 6d65 5d28 6375 6265 5b70 636f 756e 7465  me](cube[pcounte
-00010e90: 725d 2c20 5c0a 2020 2020 2020 2020 2020  r], \.          
-00010ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010eb0: 2020 2020 2020 2073 656c 662e 6461 7461         self.data
-00010ec0: 2e70 7269 6f72 735b 706e 616d 655d 5b27  .priors[pname]['
-00010ed0: 6879 7065 7270 6172 616d 6574 6572 7327  hyperparameters'
-00010ee0: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-00010ef0: 2020 2070 636f 756e 7465 7220 2b3d 2031     pcounter += 1
-00010f00: 0a0a 2020 2020 2320 5072 696f 7220 7472  ..    # Prior tr
-00010f10: 616e 7366 6f72 6d20 666f 7220 6e65 7374  ansform for nest
-00010f20: 6564 2073 616d 706c 6572 7320 2874 6869  ed samplers (thi
-00010f30: 7320 6f6e 6520 7370 6974 7320 7468 6520  s one spits the 
-00010f40: 7472 616e 7366 6f72 6d65 6420 7072 696f  transformed prio
-00010f50: 7273 2066 726f 6d20 7468 6520 756e 6974  rs from the unit
-00010f60: 2063 7562 6529 3a0a 2020 2020 6465 6620   cube):.    def 
-00010f70: 7072 696f 725f 7472 616e 7366 6f72 6d5f  prior_transform_
-00010f80: 7228 7365 6c66 2c20 6375 6265 293a 0a20  r(self, cube):. 
-00010f90: 2020 2020 2020 2070 636f 756e 7465 7220         pcounter 
-00010fa0: 3d20 300a 2020 2020 2020 2020 7472 616e  = 0.        tran
-00010fb0: 7366 6f72 6d65 645f 7072 696f 7273 203d  sformed_priors =
-00010fc0: 206e 702e 636f 7079 2873 656c 662e 7472   np.copy(self.tr
-00010fd0: 616e 7366 6f72 6d65 645f 7072 696f 7273  ansformed_priors
-00010fe0: 290a 2020 2020 2020 2020 666f 7220 706e  ).        for pn
-00010ff0: 616d 6520 696e 2073 656c 662e 6d6f 6465  ame in self.mode
-00011000: 6c5f 7061 7261 6d65 7465 7273 3a0a 2020  l_parameters:.  
-00011010: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00011020: 662e 6461 7461 2e70 7269 6f72 735b 706e  f.data.priors[pn
-00011030: 616d 655d 5b27 6469 7374 7269 6275 7469  ame]['distributi
-00011040: 6f6e 275d 2e6c 6f77 6572 2829 2021 3d20  on'].lower() != 
-00011050: 2766 6978 6564 273a 0a20 2020 2020 2020  'fixed':.       
-00011060: 2020 2020 2020 2020 2074 7261 6e73 666f           transfo
-00011070: 726d 6564 5f70 7269 6f72 735b 7063 6f75  rmed_priors[pcou
-00011080: 6e74 6572 5d20 3d20 7365 6c66 2e74 7261  nter] = self.tra
-00011090: 6e73 666f 726d 5f70 7269 6f72 5b70 6e61  nsform_prior[pna
-000110a0: 6d65 5d28 6375 6265 5b70 636f 756e 7465  me](cube[pcounte
-000110b0: 725d 2c20 5c0a 2020 2020 2020 2020 2020  r], \.          
-000110c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000110d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000110e0: 2020 2020 2073 656c 662e 6461 7461 2e70       self.data.p
-000110f0: 7269 6f72 735b 706e 616d 655d 5b27 6879  riors[pname]['hy
-00011100: 7065 7270 6172 616d 6574 6572 7327 5d29  perparameters'])
-00011110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011120: 2070 636f 756e 7465 7220 2b3d 2031 0a20   pcounter += 1. 
-00011130: 2020 2020 2020 2072 6574 7572 6e20 7472         return tr
-00011140: 616e 7366 6f72 6d65 645f 7072 696f 7273  ansformed_priors
-00011150: 0a0a 2020 2020 2320 4c6f 672d 7072 696f  ..    # Log-prio
-00011160: 7220 666f 7220 4d43 4d43 7320 2872 6574  r for MCMCs (ret
-00011170: 7572 6e73 2065 7661 6c75 6174 6564 2070  urns evaluated p
-00011180: 7269 6f72 293a 0a20 2020 2064 6566 206c  rior):.    def l
-00011190: 6f67 7072 696f 7228 7365 6c66 2c20 7468  ogprior(self, th
-000111a0: 6574 6129 3a0a 2020 2020 2020 2020 7063  eta):.        pc
-000111b0: 6f75 6e74 6572 203d 2030 0a20 2020 2020  ounter = 0.     
-000111c0: 2020 2074 6f74 616c 5f6c 6f67 7072 696f     total_logprio
-000111d0: 7220 3d20 302e 0a20 2020 2020 2020 2066  r = 0..        f
-000111e0: 6f72 2070 6e61 6d65 2069 6e20 7365 6c66  or pname in self
-000111f0: 2e6d 6f64 656c 5f70 6172 616d 6574 6572  .model_parameter
-00011200: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
-00011210: 6620 7365 6c66 2e64 6174 612e 7072 696f  f self.data.prio
-00011220: 7273 5b70 6e61 6d65 5d5b 2764 6973 7472  rs[pname]['distr
-00011230: 6962 7574 696f 6e27 5d2e 6c6f 7765 7228  ibution'].lower(
-00011240: 2920 213d 2027 6669 7865 6427 3a0a 2020  ) != 'fixed':.  
-00011250: 2020 2020 2020 2020 2020 2020 2020 746f                to
-00011260: 7461 6c5f 6c6f 6770 7269 6f72 202b 3d20  tal_logprior += 
-00011270: 7365 6c66 2e65 7661 6c75 6174 655f 6c6f  self.evaluate_lo
-00011280: 6770 7269 6f72 5b70 6e61 6d65 5d28 7468  gprior[pname](th
-00011290: 6574 615b 7063 6f75 6e74 6572 5d2c 205c  eta[pcounter], \
-000112a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000112b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000112c0: 2020 2073 656c 662e 6461 7461 2e70 7269     self.data.pri
-000112d0: 6f72 735b 706e 616d 655d 5b27 6879 7065  ors[pname]['hype
-000112e0: 7270 6172 616d 6574 6572 7327 5d29 0a20  rparameters']). 
-000112f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00011300: 636f 756e 7465 7220 2b3d 2031 0a20 2020  counter += 1.   
-00011310: 2020 2020 2072 6574 7572 6e20 746f 7461       return tota
-00011320: 6c5f 6c6f 6770 7269 6f72 0a0a 2020 2020  l_logprior..    
-00011330: 6465 6620 6c6f 676c 696b 6528 7365 6c66  def loglike(self
-00011340: 2c20 6375 6265 2c20 6e64 696d 3d4e 6f6e  , cube, ndim=Non
-00011350: 652c 206e 7061 7261 6d73 3d4e 6f6e 6529  e, nparams=None)
-00011360: 3a0a 2020 2020 2020 2020 2320 4576 616c  :.        # Eval
-00011370: 7561 7465 2074 6865 206a 6f69 6e74 206c  uate the joint l
-00011380: 6f67 2d6c 696b 656c 6968 6f6f 642e 2046  og-likelihood. F
-00011390: 6f72 2074 6869 732c 2066 6972 7374 2065  or this, first e
-000113a0: 7874 7261 6374 2061 6c6c 2069 6e70 7574  xtract all input
-000113b0: 733a 0a20 2020 2020 2020 2070 636f 756e  s:.        pcoun
-000113c0: 7465 7220 3d20 300a 2020 2020 2020 2020  ter = 0.        
-000113d0: 666f 7220 706e 616d 6520 696e 2073 656c  for pname in sel
-000113e0: 662e 6d6f 6465 6c5f 7061 7261 6d65 7465  f.model_paramete
-000113f0: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
-00011400: 6966 2073 656c 662e 6461 7461 2e70 7269  if self.data.pri
-00011410: 6f72 735b 706e 616d 655d 5b27 6469 7374  ors[pname]['dist
-00011420: 7269 6275 7469 6f6e 275d 2e6c 6f77 6572  ribution'].lower
-00011430: 2829 2021 3d20 2766 6978 6564 273a 0a20  () != 'fixed':. 
-00011440: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00011450: 656c 662e 706f 7374 6572 696f 7273 5b70  elf.posteriors[p
-00011460: 6e61 6d65 5d20 3d20 6375 6265 5b70 636f  name] = cube[pco
-00011470: 756e 7465 725d 0a20 2020 2020 2020 2020  unter].         
-00011480: 2020 2020 2020 2070 636f 756e 7465 7220         pcounter 
-00011490: 2b3d 2031 0a20 2020 2020 2020 2023 2049  += 1.        # I
-000114a0: 6e69 7469 616c 697a 6520 6c6f 672d 6c69  nitialize log-li
-000114b0: 6b65 6c69 686f 6f64 3a0a 2020 2020 2020  kelihood:.      
-000114c0: 2020 6c6f 675f 6c69 6b65 6c69 686f 6f64    log_likelihood
-000114d0: 203d 2030 2e30 0a0a 2020 2020 2020 2020   = 0.0..        
-000114e0: 2320 4576 616c 7561 7465 2070 686f 746f  # Evaluate photo
-000114f0: 6d65 7472 6963 206d 6f64 656c 2066 6972  metric model fir
-00011500: 7374 3a0a 2020 2020 2020 2020 6966 2073  st:.        if s
-00011510: 656c 662e 6461 7461 2e74 5f6c 6320 6973  elf.data.t_lc is
-00011520: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00011530: 2020 2020 2020 2073 656c 662e 6c63 2e67         self.lc.g
-00011540: 656e 6572 6174 6528 7365 6c66 2e70 6f73  enerate(self.pos
-00011550: 7465 7269 6f72 7329 0a20 2020 2020 2020  teriors).       
-00011560: 2020 2020 2069 6620 7365 6c66 2e6c 632e       if self.lc.
-00011570: 6d6f 6465 6c4f 4b3a 0a20 2020 2020 2020  modelOK:.       
-00011580: 2020 2020 2020 2020 206c 6f67 5f6c 696b           log_lik
-00011590: 656c 6968 6f6f 6420 2b3d 2073 656c 662e  elihood += self.
-000115a0: 6c63 2e67 6574 5f6c 6f67 5f6c 696b 656c  lc.get_log_likel
-000115b0: 6968 6f6f 6428 7365 6c66 2e70 6f73 7465  ihood(self.poste
-000115c0: 7269 6f72 7329 0a20 2020 2020 2020 2020  riors).         
-000115d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000115e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000115f0: 2d31 6531 3031 0a20 2020 2020 2020 2023  -1e101.        #
-00011600: 204e 6f77 2052 5620 6d6f 6465 6c3a 0a20   Now RV model:. 
-00011610: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
-00011620: 6174 612e 745f 7276 2069 7320 6e6f 7420  ata.t_rv is not 
-00011630: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00011640: 2020 7365 6c66 2e72 762e 6765 6e65 7261    self.rv.genera
-00011650: 7465 2873 656c 662e 706f 7374 6572 696f  te(self.posterio
-00011660: 7273 290a 2020 2020 2020 2020 2020 2020  rs).            
-00011670: 6966 2073 656c 662e 7276 2e6d 6f64 656c  if self.rv.model
-00011680: 4f4b 3a0a 2020 2020 2020 2020 2020 2020  OK:.            
-00011690: 2020 2020 6c6f 675f 6c69 6b65 6c69 686f      log_likeliho
-000116a0: 6f64 202b 3d20 7365 6c66 2e72 762e 6765  od += self.rv.ge
-000116b0: 745f 6c6f 675f 6c69 6b65 6c69 686f 6f64  t_log_likelihood
-000116c0: 2873 656c 662e 706f 7374 6572 696f 7273  (self.posteriors
-000116d0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-000116e0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000116f0: 2020 2020 7265 7475 726e 202d 3165 3130      return -1e10
-00011700: 310a 2020 2020 2020 2020 2320 5265 7475  1.        # Retu
-00011710: 726e 2074 6f74 616c 206c 6f67 2d6c 696b  rn total log-lik
-00011720: 656c 6968 6f6f 643a 0a20 2020 2020 2020  elihood:.       
-00011730: 2072 6574 7572 6e20 6c6f 675f 6c69 6b65   return log_like
-00011740: 6c69 686f 6f64 0a0a 2020 2020 2320 4c6f  lihood..    # Lo
-00011750: 672d 7072 6f62 6162 696c 6974 7920 666f  g-probability fo
-00011760: 7220 4d43 4d43 2073 616d 706c 6572 733a  r MCMC samplers:
-00011770: 0a20 2020 2064 6566 206c 6f67 7072 6f62  .    def logprob
-00011780: 2873 656c 662c 2074 6865 7461 293a 0a20  (self, theta):. 
-00011790: 2020 2020 2020 206c 7020 3d20 7365 6c66         lp = self
-000117a0: 2e6c 6f67 7072 696f 7228 7468 6574 6129  .logprior(theta)
-000117b0: 202b 2073 656c 662e 6c6f 676c 696b 6528   + self.loglike(
-000117c0: 7468 6574 6129 0a20 2020 2020 2020 2069  theta).        i
-000117d0: 6620 6e70 2e69 736e 616e 286c 7029 3a0a  f np.isnan(lp):.
-000117e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000117f0: 726e 202d 6e70 2e69 6e66 0a20 2020 2020  rn -np.inf.     
-00011800: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00011810: 2020 2020 2072 6574 7572 6e20 6c70 0a0a       return lp..
-00011820: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00011830: 2873 656c 662c 2064 6174 612c 2073 616d  (self, data, sam
-00011840: 706c 6572 203d 2027 6d75 6c74 696e 6573  pler = 'multines
-00011850: 7427 2c20 6e5f 6c69 7665 5f70 6f69 6e74  t', n_live_point
-00011860: 7320 3d20 3530 302c 206e 7761 6c6b 6572  s = 500, nwalker
-00011870: 7320 3d20 3130 302c 206e 7374 6570 7320  s = 100, nsteps 
-00011880: 3d20 3330 302c 206e 6275 726e 696e 203d  = 300, nburnin =
-00011890: 2035 3030 2c20 656d 6365 655f 6661 6374   500, emcee_fact
-000118a0: 6f72 203d 2031 652d 342c 205c 0a20 2020  or = 1e-4, \.   
-000118b0: 2020 2020 2020 2020 2020 2020 2020 6563                ec
-000118c0: 636c 696d 203d 2031 2e2c 2070 6c20 3d20  clim = 1., pl = 
-000118d0: 302e 302c 2070 7520 3d20 312e 302c 2074  0.0, pu = 1.0, t
-000118e0: 6120 3d20 3234 3538 3436 302e 2c20 6e74  a = 2458460., nt
-000118f0: 6872 6561 6473 203d 204e 6f6e 652c 206c  hreads = None, l
-00011900: 6967 6874 5f74 7261 7665 6c5f 6465 6c61  ight_travel_dela
-00011910: 7920 3d20 4661 6c73 652c 2073 7465 6c6c  y = False, stell
-00011920: 6172 5f72 6164 6975 7320 3d20 4e6f 6e65  ar_radius = None
-00011930: 2c20 5c0a 2020 2020 2020 2020 2020 2020  , \.            
-00011940: 2020 2020 2075 7365 5f75 6c74 7261 6e65       use_ultrane
-00011950: 7374 203d 2046 616c 7365 2c20 7573 655f  st = False, use_
-00011960: 6479 6e65 7374 7920 3d20 4661 6c73 652c  dynesty = False,
-00011970: 2064 796e 616d 6963 203d 2046 616c 7365   dynamic = False
-00011980: 2c20 6479 6e65 7374 795f 626f 756e 6420  , dynesty_bound 
-00011990: 3d20 276d 756c 7469 272c 2064 796e 6573  = 'multi', dynes
-000119a0: 7479 5f73 616d 706c 653d 2772 7761 6c6b  ty_sample='rwalk
-000119b0: 272c 2064 796e 6573 7479 5f6e 7468 7265  ', dynesty_nthre
-000119c0: 6164 7320 3d20 4e6f 6e65 2c20 5c0a 2020  ads = None, \.  
-000119d0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000119e0: 796e 6573 7479 5f6e 5f65 6666 6563 7469  ynesty_n_effecti
-000119f0: 7665 203d 206e 702e 696e 662c 2064 796e  ve = np.inf, dyn
-00011a00: 6573 7479 5f75 7365 5f73 746f 7020 3d20  esty_use_stop = 
-00011a10: 5472 7565 2c20 6479 6e65 7374 795f 7573  True, dynesty_us
-00011a20: 655f 706f 6f6c 203d 204e 6f6e 652c 202a  e_pool = None, *
-00011a30: 2a6b 7761 7267 7329 3a0a 0a20 2020 2020  *kwargs):..     
-00011a40: 2020 2023 2044 6566 696e 6520 6f75 7470     # Define outp
-00011a50: 7574 2072 6573 756c 7473 206f 626a 6563  ut results objec
-00011a60: 743a 0a20 2020 2020 2020 2073 656c 662e  t:.        self.
-00011a70: 7265 7375 6c74 7320 3d20 4e6f 6e65 0a0a  results = None..
-00011a80: 2020 2020 2020 2020 2320 5361 7665 2073          # Save s
-00011a90: 616d 706c 6572 2069 6e70 7574 7320 696e  ampler inputs in
-00011aa0: 2063 6173 6520 7573 6572 7320 6172 6520   case users are 
-00011ab0: 7374 696c 6c20 7573 696e 6720 6f6c 6420  still using old 
-00011ac0: 6465 6669 6e69 7469 6f6e 730a 2020 2020  definitions.    
-00011ad0: 2020 2020 7365 6c66 2e75 7365 5f75 6c74      self.use_ult
-00011ae0: 7261 6e65 7374 203d 2075 7365 5f75 6c74  ranest = use_ult
-00011af0: 7261 6e65 7374 0a20 2020 2020 2020 2073  ranest.        s
-00011b00: 656c 662e 7573 655f 6479 6e65 7374 7920  elf.use_dynesty 
-00011b10: 3d20 7573 655f 6479 6e65 7374 790a 2020  = use_dynesty.  
-00011b20: 2020 2020 2020 7365 6c66 2e64 796e 616d        self.dynam
-00011b30: 6963 203d 2064 796e 616d 6963 0a20 2020  ic = dynamic.   
-00011b40: 2020 2020 2073 656c 662e 6479 6e65 7374       self.dynest
-00011b50: 795f 626f 756e 6420 3d20 6479 6e65 7374  y_bound = dynest
-00011b60: 795f 626f 756e 640a 2020 2020 2020 2020  y_bound.        
-00011b70: 7365 6c66 2e64 796e 6573 7479 5f73 616d  self.dynesty_sam
-00011b80: 706c 6520 3d20 6479 6e65 7374 795f 7361  ple = dynesty_sa
-00011b90: 6d70 6c65 0a20 2020 2020 2020 2073 656c  mple.        sel
-00011ba0: 662e 6479 6e65 7374 795f 6e74 6872 6561  f.dynesty_nthrea
-00011bb0: 6473 203d 2064 796e 6573 7479 5f6e 7468  ds = dynesty_nth
-00011bc0: 7265 6164 730a 2020 2020 2020 2020 7365  reads.        se
-00011bd0: 6c66 2e64 796e 6573 7479 5f6e 5f65 6666  lf.dynesty_n_eff
-00011be0: 6563 7469 7665 203d 2064 796e 6573 7479  ective = dynesty
-00011bf0: 5f6e 5f65 6666 6563 7469 7665 0a20 2020  _n_effective.   
-00011c00: 2020 2020 2073 656c 662e 6479 6e65 7374       self.dynest
-00011c10: 795f 7573 655f 7374 6f70 203d 2064 796e  y_use_stop = dyn
-00011c20: 6573 7479 5f75 7365 5f73 746f 700a 2020  esty_use_stop.  
-00011c30: 2020 2020 2020 7365 6c66 2e64 796e 6573        self.dynes
-00011c40: 7479 5f75 7365 5f70 6f6f 6c20 3d20 6479  ty_use_pool = dy
-00011c50: 6e65 7374 795f 7573 655f 706f 6f6c 0a0a  nesty_use_pool..
-00011c60: 2020 2020 2020 2020 2320 4e6f 7720 6578          # Now ex
-00011c70: 7472 6163 7420 7361 6d70 6c65 7220 6f70  tract sampler op
-00011c80: 7469 6f6e 733a 0a20 2020 2020 2020 2073  tions:.        s
-00011c90: 656c 662e 7361 6d70 6c65 7220 3d20 7361  elf.sampler = sa
-00011ca0: 6d70 6c65 720a 2020 2020 2020 2020 7365  mpler.        se
-00011cb0: 6c66 2e6e 5f6c 6976 655f 706f 696e 7473  lf.n_live_points
-00011cc0: 203d 206e 5f6c 6976 655f 706f 696e 7473   = n_live_points
-00011cd0: 0a20 2020 2020 2020 2073 656c 662e 6e77  .        self.nw
-00011ce0: 616c 6b65 7273 203d 206e 7761 6c6b 6572  alkers = nwalker
-00011cf0: 730a 2020 2020 2020 2020 7365 6c66 2e6e  s.        self.n
-00011d00: 7374 6570 7320 3d20 6e73 7465 7073 0a20  steps = nsteps. 
-00011d10: 2020 2020 2020 2073 656c 662e 656d 6365         self.emce
-00011d20: 655f 6661 6374 6f72 203d 2065 6d63 6565  e_factor = emcee
-00011d30: 5f66 6163 746f 720a 2020 2020 2020 2020  _factor.        
-00011d40: 7365 6c66 2e6e 6275 726e 696e 203d 206e  self.nburnin = n
-00011d50: 6275 726e 696e 0a20 2020 2020 2020 2073  burnin.        s
-00011d60: 656c 662e 6e74 6872 6561 6473 203d 206e  elf.nthreads = n
-00011d70: 7468 7265 6164 730a 0a20 2020 2020 2020  threads..       
-00011d80: 2023 2045 7874 7261 6374 2070 6879 7369   # Extract physi
-00011d90: 6361 6c20 6d6f 6465 6c20 6465 7461 696c  cal model detail
-00011da0: 733a 0a20 2020 2020 2020 2073 656c 662e  s:.        self.
-00011db0: 6c69 6768 745f 7472 6176 656c 5f64 656c  light_travel_del
-00011dc0: 6179 203d 206c 6967 6874 5f74 7261 7665  ay = light_trave
-00011dd0: 6c5f 6465 6c61 790a 2020 2020 2020 2020  l_delay.        
-00011de0: 6966 2073 656c 662e 6c69 6768 745f 7472  if self.light_tr
-00011df0: 6176 656c 5f64 656c 6179 2061 6e64 2028  avel_delay and (
-00011e00: 7374 656c 6c61 725f 7261 6469 7573 2069  stellar_radius i
-00011e10: 7320 4e6f 6e65 293a 0a0a 2020 2020 2020  s None):..      
-00011e20: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
-00011e30: 7074 696f 6e28 2745 7272 6f72 3a20 6966  ption('Error: if
-00011e40: 206c 6967 6874 5f74 7261 7665 6c5f 6465   light_travel_de
-00011e50: 6c61 7920 6973 2061 6374 6976 6174 6564  lay is activated
-00011e60: 2c20 6120 7374 656c 6c61 7220 7261 6469  , a stellar radi
-00011e70: 7573 206e 6565 6473 2074 6f20 6265 2067  us needs to be g
-00011e80: 6976 656e 2061 7320 7765 6c6c 2076 6961  iven as well via
-00011e90: 2073 7465 6c6c 6172 5f72 6164 6975 7320   stellar_radius 
-00011ea0: 3d20 796f 7572 7661 6c75 653b 2065 2e67  = yourvalue; e.g
-00011eb0: 2e2c 2064 6174 6173 6574 2e66 6974 282e  ., dataset.fit(.
-00011ec0: 2e2e 2c20 6c69 6768 745f 7472 6176 656c  .., light_travel
-00011ed0: 5f64 656c 6179 203d 2054 7275 652c 2073  _delay = True, s
-00011ee0: 7465 6c6c 6172 5f72 6164 6975 7320 3d20  tellar_radius = 
-00011ef0: 312e 3132 3334 292e 2729 0a20 2020 2020  1.1234).').     
-00011f00: 2020 200a 2020 2020 2020 2020 7365 6c66     .        self
-00011f10: 2e73 7465 6c6c 6172 5f72 6164 6975 7320  .stellar_radius 
-00011f20: 3d20 7374 656c 6c61 725f 7261 6469 7573  = stellar_radius
-00011f30: 0a0a 2020 2020 2020 2020 2320 5570 6461  ..        # Upda
-00011f40: 7465 2073 616d 706c 6572 2069 6e70 7574  te sampler input
-00011f50: 7320 696e 2063 6173 6520 7573 6572 2073  s in case user s
-00011f60: 7469 6c6c 2075 7369 6e67 2064 6570 7265  till using depre
-00011f70: 6361 7465 6420 696e 7075 7473 2e20 5765  cated inputs. We
-00011f80: 276c 6c20 7265 6d6f 7665 2074 6869 7320  'll remove this 
-00011f90: 696e 2073 6f6d 6520 6675 7475 7265 2e20  in some future. 
-00011fa0: 4669 7273 742c 2064 6566 696e 6520 7374  First, define st
-00011fb0: 616e 6461 7264 2070 7265 2d66 6978 2061  andard pre-fix a
-00011fc0: 6e64 2073 7566 6978 2066 6f72 2074 6865  nd sufix for the
-00011fd0: 2077 6172 6e69 6e67 733a 0a20 2020 2020   warnings:.     
-00011fe0: 2020 2077 7331 203d 2027 5741 524e 494e     ws1 = 'WARNIN
-00011ff0: 473a 2075 7365 206f 6620 7468 6520 270a  G: use of the '.
-00012000: 2020 2020 2020 2020 7773 3220 3d20 2720          ws2 = ' 
-00012010: 6172 6775 6d65 6e74 2069 7320 6465 7072  argument is depr
-00012020: 6563 6174 6564 2061 6e64 2077 696c 6c20  ecated and will 
-00012030: 6265 2072 656d 6f76 6564 2069 6e20 6675  be removed in fu
-00012040: 7475 7265 206a 756c 6965 7420 7665 7273  ture juliet vers
-00012050: 696f 6e73 2e20 5573 6520 7468 6520 270a  ions. Use the '.
-00012060: 2020 2020 2020 2020 7773 3320 3d20 2720          ws3 = ' 
-00012070: 696e 7374 6561 643b 2066 6f72 206d 6f72  instead; for mor
-00012080: 6520 696e 666f 726d 6174 696f 6e2c 2063  e information, c
-00012090: 6865 636b 2074 6865 2041 5049 206f 6620  heck the API of 
-000120a0: 6a75 6c69 6574 2e66 6974 3a20 6874 7470  juliet.fit: http
-000120b0: 733a 2f2f 6a75 6c69 6574 2e72 6561 6474  s://juliet.readt
-000120c0: 6865 646f 6373 2e69 6f2f 656e 2f6c 6174  hedocs.io/en/lat
-000120d0: 6573 742f 7573 6572 2f61 7069 2e68 746d  est/user/api.htm
-000120e0: 6c23 6a75 6c69 6574 2e66 6974 270a 2020  l#juliet.fit'.  
-000120f0: 2020 2020 2020 6966 2073 656c 662e 7573        if self.us
-00012100: 655f 756c 7472 616e 6573 743a 0a20 2020  e_ultranest:.   
-00012110: 2020 2020 2020 2020 2073 656c 662e 7361           self.sa
-00012120: 6d70 6c65 7220 3d20 2775 6c74 7261 6e65  mpler = 'ultrane
-00012130: 7374 270a 2020 2020 2020 2020 2020 2020  st'.            
-00012140: 7072 696e 7428 7773 3120 2b20 2775 7365  print(ws1 + 'use
-00012150: 5f75 6c74 7261 6e65 7374 2720 2b20 7773  _ultranest' + ws
-00012160: 3220 2b20 2722 7361 6d70 6c65 7222 2073  2 + '"sampler" s
-00012170: 7472 696e 6727 202b 2077 7333 290a 2020  tring' + ws3).  
-00012180: 2020 2020 2020 6966 2073 656c 662e 7573        if self.us
-00012190: 655f 6479 6e65 7374 793a 0a20 2020 2020  e_dynesty:.     
-000121a0: 2020 2020 2020 2070 7269 6e74 2877 7331         print(ws1
-000121b0: 202b 2027 7573 655f 6479 6e65 7374 7927   + 'use_dynesty'
-000121c0: 202b 2077 7332 202b 2027 2273 616d 706c   + ws2 + '"sampl
-000121d0: 6572 2220 7374 7269 6e67 2720 2b20 7773  er" string' + ws
-000121e0: 3329 0a20 2020 2020 2020 2020 2020 2073  3).            s
-000121f0: 656c 662e 7361 6d70 6c65 7220 3d20 2764  elf.sampler = 'd
-00012200: 796e 6573 7479 270a 2020 2020 2020 2020  ynesty'.        
-00012210: 2020 2020 6966 2073 656c 662e 6479 6e61      if self.dyna
-00012220: 6d69 633a 0a20 2020 2020 2020 2020 2020  mic:.           
-00012230: 2020 2020 2073 656c 662e 7361 6d70 6c65       self.sample
-00012240: 7220 3d20 2764 796e 616d 6963 5f64 796e  r = 'dynamic_dyn
-00012250: 6573 7479 270a 2020 2020 2020 2020 2020  esty'.          
-00012260: 2020 2020 2020 7072 696e 7428 7773 3120        print(ws1 
-00012270: 2b20 2764 796e 616d 6963 2720 2b20 7773  + 'dynamic' + ws
-00012280: 3220 2b20 2722 7361 6d70 6c65 7222 2073  2 + '"sampler" s
-00012290: 7472 696e 6727 202b 2077 7333 290a 2020  tring' + ws3).  
-000122a0: 2020 2020 2020 2020 2020 2320 4164 6420            # Add 
-000122b0: 7468 6520 6f74 6865 7220 6465 7072 6563  the other deprec
-000122c0: 6174 6564 2066 6c61 6773 2074 6f20 7468  ated flags to th
-000122d0: 6520 6b77 6172 6773 3a0a 2020 2020 2020  e kwargs:.      
-000122e0: 2020 2020 2020 6966 2073 656c 662e 6479        if self.dy
-000122f0: 6e65 7374 795f 626f 756e 6420 213d 2027  nesty_bound != '
-00012300: 6d75 6c74 6927 3a0a 2020 2020 2020 2020  multi':.        
-00012310: 2020 2020 2020 2020 7072 696e 7428 7773          print(ws
-00012320: 3120 2b20 2764 796e 6573 7479 5f62 6f75  1 + 'dynesty_bou
-00012330: 6e64 2720 2b20 7773 3220 2b20 2722 626f  nd' + ws2 + '"bo
-00012340: 756e 6422 2061 7267 756d 656e 7427 202b  und" argument' +
-00012350: 2077 7333 290a 2020 2020 2020 2020 2020   ws3).          
-00012360: 2020 2020 2020 2320 6b77 6172 6773 2074        # kwargs t
-00012370: 616b 6520 7072 6573 6564 656e 6365 3a0a  ake presedence:.
-00012380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012390: 6966 2027 626f 756e 6427 206e 6f74 2069  if 'bound' not i
-000123a0: 6e20 6b77 6172 6773 2e6b 6579 7328 293a  n kwargs.keys():
-000123b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000123c0: 2020 2020 206b 7761 7267 735b 2762 6f75       kwargs['bou
-000123d0: 6e64 275d 203d 2073 656c 662e 6479 6e65  nd'] = self.dyne
-000123e0: 7374 795f 626f 756e 640a 2020 2020 2020  sty_bound.      
-000123f0: 2020 2020 2020 6966 2073 656c 662e 6479        if self.dy
-00012400: 6e65 7374 795f 7361 6d70 6c65 2021 3d20  nesty_sample != 
-00012410: 2772 7761 6c6b 273a 0a20 2020 2020 2020  'rwalk':.       
-00012420: 2020 2020 2020 2020 2070 7269 6e74 2877           print(w
-00012430: 7331 202b 2027 6479 6e65 7374 795f 7361  s1 + 'dynesty_sa
-00012440: 6d70 6c65 2720 2b20 7773 3220 2b20 2722  mple' + ws2 + '"
-00012450: 7361 6d70 6c65 2220 6172 6775 6d65 6e74  sample" argument
-00012460: 2720 2b20 7773 3329 0a20 2020 2020 2020  ' + ws3).       
-00012470: 2020 2020 2020 2020 2023 206b 7761 7267           # kwarg
-00012480: 7320 7461 6b65 2070 7265 7365 6465 6e63  s take presedenc
-00012490: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000124a0: 2020 2069 6620 2773 616d 706c 6527 206e     if 'sample' n
-000124b0: 6f74 2069 6e20 6b77 6172 6773 2e6b 6579  ot in kwargs.key
-000124c0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-000124d0: 2020 2020 2020 2020 206b 7761 7267 735b           kwargs[
-000124e0: 2773 616d 706c 6527 5d20 3d20 7365 6c66  'sample'] = self
-000124f0: 2e64 796e 6573 7479 5f73 616d 706c 650a  .dynesty_sample.
-00012500: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00012510: 656c 662e 6479 6e65 7374 795f 6e74 6872  elf.dynesty_nthr
-00012520: 6561 6473 2069 7320 6e6f 7420 4e6f 6e65  eads is not None
-00012530: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00012540: 2020 7072 696e 7428 7773 3120 2b20 2764    print(ws1 + 'd
-00012550: 796e 6573 7479 5f6e 7468 7265 6164 7327  ynesty_nthreads'
-00012560: 202b 2077 7332 202b 2027 226e 7468 7265   + ws2 + '"nthre
-00012570: 6164 7322 2061 7267 756d 656e 7427 202b  ads" argument' +
-00012580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012590: 2020 2020 2020 2077 7333 290a 2020 2020         ws3).    
-000125a0: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
-000125b0: 6520 6e74 6872 6561 6473 2061 7267 756d  e nthreads argum
-000125c0: 656e 7420 7461 6b65 7320 7072 6573 6564  ent takes presed
-000125d0: 656e 6365 206e 6f77 3a0a 2020 2020 2020  ence now:.      
-000125e0: 2020 2020 2020 2020 2020 6966 206e 7468            if nth
-000125f0: 7265 6164 7320 6973 204e 6f6e 653a 0a20  reads is None:. 
-00012600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012610: 2020 2073 656c 662e 6e74 6872 6561 6473     self.nthreads
-00012620: 203d 2073 656c 662e 6479 6e65 7374 795f   = self.dynesty_
-00012630: 6e74 6872 6561 6473 0a20 2020 2020 2020  nthreads.       
-00012640: 2020 2020 2069 6620 7365 6c66 2e64 796e       if self.dyn
-00012650: 6573 7479 5f6e 5f65 6666 6563 7469 7665  esty_n_effective
-00012660: 2069 7320 6e6f 7420 6e70 2e69 6e66 3a0a   is not np.inf:.
-00012670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012680: 7072 696e 7428 7773 3120 2b20 2764 796e  print(ws1 + 'dyn
-00012690: 6573 7479 5f6e 5f65 6666 6563 7469 7665  esty_n_effective
-000126a0: 2720 2b20 7773 3220 2b0a 2020 2020 2020  ' + ws2 +.      
-000126b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000126c0: 2722 6e5f 6566 6665 6374 6976 6522 2061  '"n_effective" a
-000126d0: 7267 756d 656e 7427 202b 2077 7333 290a  rgument' + ws3).
-000126e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000126f0: 2320 6b77 6172 6773 2074 616b 6520 7072  # kwargs take pr
-00012700: 6573 6564 656e 6365 3a0a 2020 2020 2020  esedence:.      
-00012710: 2020 2020 2020 2020 2020 6966 2027 6e5f            if 'n_
-00012720: 6566 6665 6374 6976 6527 206e 6f74 2069  effective' not i
-00012730: 6e20 6b77 6172 6773 2e6b 6579 7328 293a  n kwargs.keys():
-00012740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012750: 2020 2020 206b 7761 7267 735b 276e 5f65       kwargs['n_e
-00012760: 6666 6563 7469 7665 275d 203d 2073 656c  ffective'] = sel
-00012770: 662e 6479 6e65 7374 795f 6e5f 6566 6665  f.dynesty_n_effe
-00012780: 6374 6976 650a 2020 2020 2020 2020 2020  ctive.          
-00012790: 2020 6966 206e 6f74 2073 656c 662e 6479    if not self.dy
-000127a0: 6e65 7374 795f 7573 655f 7374 6f70 3a0a  nesty_use_stop:.
-000127b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000127c0: 7072 696e 7428 7773 3120 2b20 2764 796e  print(ws1 + 'dyn
-000127d0: 6573 7479 5f75 7365 5f73 746f 7027 202b  esty_use_stop' +
-000127e0: 2077 7332 202b 2027 2275 7365 5f73 746f   ws2 + '"use_sto
-000127f0: 7022 2061 7267 756d 656e 7427 202b 0a20  p" argument' +. 
-00012800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012810: 2020 2020 2077 7333 290a 2020 2020 2020       ws3).      
-00012820: 2020 2020 2020 2020 2020 2320 6b77 6172            # kwar
-00012830: 6773 2074 616b 6520 7072 6573 6564 656e  gs take preseden
-00012840: 6365 3a0a 2020 2020 2020 2020 2020 2020  ce:.            
-00012850: 2020 2020 6966 2027 7573 655f 7374 6f70      if 'use_stop
-00012860: 2720 6e6f 7420 696e 206b 7761 7267 732e  ' not in kwargs.
-00012870: 6b65 7973 2829 3a0a 2020 2020 2020 2020  keys():.        
-00012880: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
-00012890: 6773 5b27 7573 655f 7374 6f70 275d 203d  gs['use_stop'] =
-000128a0: 2073 656c 662e 6479 6e65 7374 795f 7573   self.dynesty_us
-000128b0: 655f 7374 6f70 0a20 2020 2020 2020 2020  e_stop.         
-000128c0: 2020 2069 6620 7365 6c66 2e64 796e 6573     if self.dynes
-000128d0: 7479 5f75 7365 5f70 6f6f 6c20 6973 206e  ty_use_pool is n
-000128e0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-000128f0: 2020 2020 2020 2020 2070 7269 6e74 2877           print(w
-00012900: 7331 202b 2027 6479 6e65 7374 795f 7573  s1 + 'dynesty_us
-00012910: 655f 706f 6f6c 2720 2b20 7773 3220 2b20  e_pool' + ws2 + 
-00012920: 2722 7573 655f 706f 6f6c 2220 6172 6775  '"use_pool" argu
-00012930: 6d65 6e74 2720 2b0a 2020 2020 2020 2020  ment' +.        
-00012940: 2020 2020 2020 2020 2020 2020 2020 7773                ws
-00012950: 3329 0a20 2020 2020 2020 2020 2020 2020  3).             
-00012960: 2020 2023 206b 7761 7267 7320 7461 6b65     # kwargs take
-00012970: 2070 7265 7365 6465 6e63 653a 0a20 2020   presedence:.   
-00012980: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00012990: 2775 7365 5f70 6f6f 6c27 206e 6f74 2069  'use_pool' not i
-000129a0: 6e20 6b77 6172 6773 2e6b 6579 7328 293a  n kwargs.keys():
-000129b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000129c0: 2020 2020 206b 7761 7267 735b 2775 7365       kwargs['use
-000129d0: 5f70 6f6f 6c27 5d20 3d20 7365 6c66 2e64  _pool'] = self.d
-000129e0: 796e 6573 7479 5f75 7365 5f70 6f6f 6c0a  ynesty_use_pool.
-000129f0: 0a20 2020 2020 2020 2023 2044 6566 696e  .        # Defin
-00012a00: 6520 2865 786f 2d29 616c 676f 7269 7468  e (exo-)algorith
-00012a10: 6d69 6320 6f70 7469 6f6e 733a 0a20 2020  mic options:.   
-00012a20: 2020 2020 2073 656c 662e 6563 636c 696d       self.ecclim
-00012a30: 203d 2065 6363 6c69 6d0a 2020 2020 2020   = ecclim.      
-00012a40: 2020 7365 6c66 2e70 6c20 3d20 706c 0a20    self.pl = pl. 
-00012a50: 2020 2020 2020 2073 656c 662e 7075 203d         self.pu =
-00012a60: 2070 750a 2020 2020 2020 2020 7365 6c66   pu.        self
-00012a70: 2e74 6120 3d20 7461 0a0a 2020 2020 2020  .ta = ta..      
-00012a80: 2020 2320 496e 6865 7274 2064 6174 6120    # Inhert data 
-00012a90: 6f62 6a65 6374 3a0a 2020 2020 2020 2020  object:.        
-00012aa0: 7365 6c66 2e64 6174 6120 3d20 6461 7461  self.data = data
-00012ab0: 0a0a 2020 2020 2020 2020 2320 496e 6865  ..        # Inhe
-00012ac0: 7274 2074 6865 206f 7574 7075 7420 666f  rt the output fo
-00012ad0: 6c64 6572 3a0a 2020 2020 2020 2020 7365  lder:.        se
-00012ae0: 6c66 2e6f 7574 5f66 6f6c 6465 7220 3d20  lf.out_folder = 
-00012af0: 6461 7461 2e6f 7574 5f66 6f6c 6465 720a  data.out_folder.
-00012b00: 2020 2020 2020 2020 7365 6c66 2e74 7261          self.tra
-00012b10: 6e73 666f 726d 6564 5f70 7269 6f72 7320  nsformed_priors 
-00012b20: 3d20 6e70 2e7a 6572 6f73 2873 656c 662e  = np.zeros(self.
-00012b30: 6461 7461 2e6e 7061 7261 6d73 290a 0a20  data.nparams).. 
-00012b40: 2020 2020 2020 2023 2044 6566 696e 6520         # Define 
-00012b50: 7072 6566 6978 6573 2069 6e20 6361 7365  prefixes in case
-00012b60: 2073 6176 696e 6720 6973 2074 7572 6e65   saving is turne
-00012b70: 6420 6f6e 2028 692e 652e 2c20 7573 6572  d on (i.e., user
-00012b80: 2070 6173 7365 6420 616e 206f 7574 5f66   passed an out_f
-00012b90: 6f6c 6465 7229 2e20 5079 4d75 6c74 694e  older). PyMultiN
-00012ba0: 6573 7420 616e 6420 6479 6e65 7374 7920  est and dynesty 
-00012bb0: 6f6e 6573 2061 7265 2073 6574 2062 7920  ones are set by 
-00012bc0: 6861 6e64 2e20 466f 7220 7468 6520 7265  hand. For the re
-00012bd0: 7374 2c20 7573 6520 7468 6520 6e65 770a  st, use the new.
-00012be0: 2020 2020 2020 2020 2320 7361 6d70 6c65          # sample
-00012bf0: 7220 7374 7269 6e67 2064 6972 6563 746c  r string directl
-00012c00: 793a 0a20 2020 2020 2020 2069 6620 7365  y:.        if se
-00012c10: 6c66 2e73 616d 706c 6572 203d 3d20 276d  lf.sampler == 'm
-00012c20: 756c 7469 6e65 7374 273a 0a20 2020 2020  ultinest':.     
-00012c30: 2020 2020 2020 2073 656c 662e 7361 6d70         self.samp
-00012c40: 6c65 725f 7072 6566 6978 203d 2027 270a  ler_prefix = ''.
-00012c50: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-00012c60: 662e 7361 6d70 6c65 7220 3d3d 2027 6479  f.sampler == 'dy
-00012c70: 6e65 7374 7927 3a0a 2020 2020 2020 2020  nesty':.        
-00012c80: 2020 2020 7365 6c66 2e73 616d 706c 6572      self.sampler
-00012c90: 5f70 7265 6669 7820 3d20 275f 6479 6e65  _prefix = '_dyne
-00012ca0: 7374 795f 4e53 5f27 0a20 2020 2020 2020  sty_NS_'.       
-00012cb0: 2065 6c69 6620 7365 6c66 2e73 616d 706c   elif self.sampl
-00012cc0: 6572 203d 3d20 2764 796e 616d 6963 5f64  er == 'dynamic_d
-00012cd0: 796e 6573 7479 273a 0a20 2020 2020 2020  ynesty':.       
-00012ce0: 2020 2020 2073 656c 662e 7361 6d70 6c65       self.sample
-00012cf0: 725f 7072 6566 6978 203d 2027 5f64 796e  r_prefix = '_dyn
-00012d00: 6573 7479 5f44 4e53 5f27 0a20 2020 2020  esty_DNS_'.     
-00012d10: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00012d20: 2020 2020 2073 656c 662e 7361 6d70 6c65       self.sample
-00012d30: 725f 7072 6566 6978 203d 2073 656c 662e  r_prefix = self.
-00012d40: 7361 6d70 6c65 7220 2b20 275f 270a 0a20  sampler + '_'.. 
-00012d50: 2020 2020 2020 2023 2042 6566 6f72 6520         # Before 
-00012d60: 7374 6172 7469 6e67 2c20 6368 6563 6b20  starting, check 
-00012d70: 6966 2066 6f72 6365 5f64 796e 6573 7479  if force_dynesty
-00012d80: 206f 7220 666f 7263 655f 7079 6d75 6c74   or force_pymult
-00012d90: 696e 6573 7420 6973 206f 6e3b 2063 6861  inest is on; cha
-00012da0: 6e67 6520 6f70 7469 6f6e 7320 6163 636f  nge options acco
-00012db0: 7264 696e 676c 793a 0a20 2020 2020 2020  rdingly:.       
-00012dc0: 2069 6620 666f 7263 655f 6479 6e65 7374   if force_dynest
-00012dd0: 7920 616e 6420 2873 656c 662e 7361 6d70  y and (self.samp
-00012de0: 6c65 7220 3d3d 2027 6d75 6c74 696e 6573  ler == 'multines
-00012df0: 7427 293a 0a20 2020 2020 2020 2020 2020  t'):.           
-00012e00: 2070 7269 6e74 280a 2020 2020 2020 2020   print(.        
-00012e10: 2020 2020 2020 2020 2750 794d 756c 7469          'PyMulti
-00012e20: 6e65 7374 2069 6e73 7461 6c6c 6174 696f  nest installatio
-00012e30: 6e20 6e6f 7420 6465 7465 6374 6564 2e20  n not detected. 
-00012e40: 466f 7263 696e 6720 6479 6e65 7374 7920  Forcing dynesty 
-00012e50: 6173 2074 6865 2073 616d 706c 6572 2e27  as the sampler.'
-00012e60: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00012e70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00012e80: 7361 6d70 6c65 7220 3d20 2764 796e 6573  sampler = 'dynes
-00012e90: 7479 270a 2020 2020 2020 2020 2020 2020  ty'.            
-00012ea0: 7365 6c66 2e73 616d 706c 6572 5f70 7265  self.sampler_pre
-00012eb0: 6669 7820 3d20 275f 6479 6e65 7374 795f  fix = '_dynesty_
-00012ec0: 4e53 5f27 0a20 2020 2020 2020 2020 200a  NS_'.          .
-00012ed0: 2020 2020 2020 2020 6966 2066 6f72 6365          if force
-00012ee0: 5f70 796d 756c 7469 6e65 7374 2061 6e64  _pymultinest and
-00012ef0: 2028 7365 6c66 2e73 616d 706c 6572 203d   (self.sampler =
-00012f00: 3d20 2764 796e 6573 7479 2729 3a0a 2020  = 'dynesty'):.  
-00012f10: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00012f20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012f30: 2027 6479 6e65 7374 7920 696e 7374 616c   'dynesty instal
-00012f40: 6c61 7469 6f6e 206e 6f74 2064 6574 6563  lation not detec
-00012f50: 7465 642e 2046 6f72 6369 6e67 2050 794d  ted. Forcing PyM
-00012f60: 756c 7469 6e65 7374 2061 7320 7468 6520  ultinest as the 
-00012f70: 7361 6d70 6c65 722e 270a 2020 2020 2020  sampler.'.      
-00012f80: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00012f90: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
-00012fa0: 2073 656c 662e 7361 6d70 6c65 7220 3d20   self.sampler = 
-00012fb0: 276d 756c 7469 6e65 7374 270a 2020 2020  'multinest'.    
-00012fc0: 2020 2020 2020 2020 7365 6c66 2e73 616d          self.sam
-00012fd0: 706c 6572 5f70 7265 6669 7820 3d20 2727  pler_prefix = ''
-00012fe0: 0a0a 2020 2020 2020 2020 2320 4765 6e65  ..        # Gene
-00012ff0: 7261 7465 2061 2070 6f73 7465 7269 6f72  rate a posterior
-00013000: 7320 7365 6c66 2074 6861 7420 7769 6c6c  s self that will
-00013010: 2073 6176 6520 7468 6520 6375 7272 656e   save the curren
-00013020: 7420 7661 6c75 6573 206f 6620 6561 6368  t values of each
-00013030: 206f 6620 7468 6520 7061 7261 6d65 7465   of the paramete
-00013040: 7273 2e20 496e 6974 6961 6c69 7a61 7469  rs. Initializati
-00013050: 6f6e 2076 616c 7565 2069 7320 756e 696d  on value is unim
-00013060: 706f 7274 616e 7420 666f 7220 6e65 7374  portant for nest
-00013070: 6564 2073 616d 706c 6572 733b 0a20 2020  ed samplers;.   
-00013080: 2020 2020 2023 2069 6620 4d43 4d43 2c20       # if MCMC, 
-00013090: 7468 6973 2073 6176 6573 2074 6865 2069  this saves the i
-000130a0: 6e69 7469 616c 2070 6172 616d 6574 6572  nitial parameter
-000130b0: 2076 616c 7565 733a 0a20 2020 2020 2020   values:.       
-000130c0: 2073 656c 662e 706f 7374 6572 696f 7273   self.posteriors
-000130d0: 203d 207b 7d0a 2020 2020 2020 2020 7365   = {}.        se
-000130e0: 6c66 2e6d 6f64 656c 5f70 6172 616d 6574  lf.model_paramet
-000130f0: 6572 7320 3d20 6c69 7374 2873 656c 662e  ers = list(self.
-00013100: 6461 7461 2e70 7269 6f72 732e 6b65 7973  data.priors.keys
-00013110: 2829 290a 2020 2020 2020 2020 7365 6c66  ()).        self
-00013120: 2e70 6172 616d 6e61 6d65 7320 3d20 5b5d  .paramnames = []
-00013130: 0a20 2020 2020 2020 2066 6f72 2070 6e61  .        for pna
-00013140: 6d65 2069 6e20 7365 6c66 2e6d 6f64 656c  me in self.model
-00013150: 5f70 6172 616d 6574 6572 733a 0a0a 2020  _parameters:..  
-00013160: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00013170: 662e 6461 7461 2e70 7269 6f72 735b 706e  f.data.priors[pn
-00013180: 616d 655d 5b27 6469 7374 7269 6275 7469  ame]['distributi
-00013190: 6f6e 275d 203d 3d20 2766 6978 6564 273a  on'] == 'fixed':
-000131a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000131b0: 2073 656c 662e 706f 7374 6572 696f 7273   self.posteriors
-000131c0: 5b70 6e61 6d65 5d20 3d20 7365 6c66 2e64  [pname] = self.d
-000131d0: 6174 612e 7072 696f 7273 5b70 6e61 6d65  ata.priors[pname
-000131e0: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
-000131f0: 2020 2020 2020 2027 6879 7065 7270 6172         'hyperpar
-00013200: 616d 6574 6572 7327 5d0a 0a20 2020 2020  ameters']..     
-00013210: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00013220: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00013230: 7365 6c66 2e73 616d 706c 6572 2069 6e20  self.sampler in 
-00013240: 6d63 6d63 5f73 616d 706c 6572 733a 0a20  mcmc_samplers:. 
-00013250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013260: 2020 2073 656c 662e 706f 7374 6572 696f     self.posterio
-00013270: 7273 5b70 6e61 6d65 5d20 3d20 7365 6c66  rs[pname] = self
-00013280: 2e64 6174 612e 7374 6172 7469 6e67 5f70  .data.starting_p
-00013290: 6f69 6e74 5b70 6e61 6d65 5d0a 2020 2020  oint[pname].    
-000132a0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000132b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000132c0: 2020 2020 2020 7365 6c66 2e70 6f73 7465        self.poste
-000132d0: 7269 6f72 735b 0a20 2020 2020 2020 2020  riors[.         
-000132e0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000132f0: 6e61 6d65 5d20 3d20 302e 2020 2373 656c  name] = 0.  #sel
-00013300: 662e 6461 7461 2e70 7269 6f72 735b 706e  f.data.priors[pn
-00013310: 616d 655d 5b27 6376 616c 7565 275d 0a20  ame]['cvalue']. 
-00013320: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00013330: 656c 662e 7061 7261 6d6e 616d 6573 2e61  elf.paramnames.a
-00013340: 7070 656e 6428 706e 616d 6529 0a20 2020  ppend(pname).   
-00013350: 2020 2020 2023 2046 6f72 2065 6163 6820       # For each 
-00013360: 6f66 2074 6865 2076 6172 6961 626c 6573  of the variables
-00013370: 2069 6e20 7468 6520 7072 696f 7220 7468   in the prior th
-00013380: 6174 2069 7320 6e6f 7420 6669 7865 642c  at is not fixed,
-00013390: 2064 6566 696e 6520 616e 2069 6e74 6572   define an inter
-000133a0: 6e61 6c20 6469 6374 696f 6e61 7279 2074  nal dictionary t
-000133b0: 6861 7420 7769 6c6c 2073 6176 6520 7468  hat will save th
-000133c0: 650a 2020 2020 2020 2020 2320 636f 7272  e.        # corr
-000133d0: 6573 706f 6e64 696e 6720 7472 616e 7366  esponding transf
-000133e0: 6f72 6d61 7469 6f6e 2066 756e 6374 696f  ormation functio
-000133f0: 6e20 746f 2074 6865 2070 7269 6f72 2063  n to the prior c
-00013400: 6f72 7265 7370 6f6e 6469 6e67 2074 6f20  orresponding to 
-00013410: 7468 6174 2076 6172 6961 626c 652e 2049  that variable. I
-00013420: 6465 6120 6973 2074 6861 7420 7769 7468  dea is that with
-00013430: 2074 6869 7320 6f6e 650a 2020 2020 2020   this one.      
-00013440: 2020 2320 7369 6d70 6c79 2064 6f65 7320    # simply does 
-00013450: 7365 6c66 2e74 7261 6e73 666f 726d 5f70  self.transform_p
-00013460: 7269 6f72 5b76 6172 6961 626c 655f 6e61  rior[variable_na
-00013470: 6d65 5d28 7661 6c75 6529 2061 6e64 2079  me](value) and y
-00013480: 6f75 2067 6574 2074 6865 2074 7261 6e73  ou get the trans
-00013490: 666f 726d 6564 2076 616c 7565 2074 6f20  formed value to 
-000134a0: 7468 6520 302c 3120 7072 696f 722e 0a20  the 0,1 prior.. 
-000134b0: 2020 2020 2020 2023 2054 6869 7320 6176         # This av
-000134c0: 6f69 6473 2068 6176 696e 6720 746f 206b  oids having to k
-000134d0: 6565 7020 7472 6163 6b20 6f66 2074 6865  eep track of the
-000134e0: 2070 7269 6f72 2064 6973 7472 6962 7574   prior distribut
-000134f0: 696f 6e20 6f6e 2065 6163 6820 6f66 2074  ion on each of t
-00013500: 6865 2069 7465 7261 7469 6f6e 732e 2054  he iterations. T
-00013510: 6869 7320 6973 206f 6e6c 7920 7573 6566  his is only usef
-00013520: 756c 2066 6f72 0a20 2020 2020 2020 2023  ul for.        #
-00013530: 206e 6573 7465 6420 7361 6d70 6c65 7273   nested samplers
-00013540: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
-00013550: 662e 7361 6d70 6c65 7220 6e6f 7420 696e  f.sampler not in
-00013560: 206d 636d 635f 7361 6d70 6c65 7273 3a0a   mcmc_samplers:.
-00013570: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00013580: 2e74 7261 6e73 666f 726d 5f70 7269 6f72  .transform_prior
-00013590: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
-000135a0: 2020 7365 6c66 2e73 6574 5f70 7269 6f72    self.set_prior
-000135b0: 5f74 7261 6e73 666f 726d 2829 0a20 2020  _transform().   
-000135c0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000135d0: 2020 2020 2020 2073 656c 662e 6576 616c         self.eval
-000135e0: 7561 7465 5f6c 6f67 7072 696f 7220 3d20  uate_logprior = 
-000135f0: 7b7d 0a20 2020 2020 2020 2020 2020 2073  {}.            s
-00013600: 656c 662e 7365 745f 6c6f 6770 7269 6f72  elf.set_logprior
-00013610: 7328 290a 0a20 2020 2020 2020 2023 2047  s()..        # G
-00013620: 656e 6572 6174 6520 6c69 6768 742d 6375  enerate light-cu
-00013630: 7276 6520 616e 6420 7261 6469 616c 2d76  rve and radial-v
-00013640: 656c 6f63 6974 7920 6d6f 6465 6c73 3a0a  elocity models:.
-00013650: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00013660: 6461 7461 2e74 5f6c 6320 6973 206e 6f74  data.t_lc is not
-00013670: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00013680: 2020 2073 656c 662e 6c63 203d 206d 6f64     self.lc = mod
-00013690: 656c 2873 656c 662e 6461 7461 2c0a 2020  el(self.data,.  
-000136a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000136b0: 2020 2020 2020 2020 2020 6d6f 6465 6c74            modelt
-000136c0: 7970 653d 276c 6327 2c0a 2020 2020 2020  ype='lc',.      
-000136d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000136e0: 2020 2020 2020 706c 3d73 656c 662e 706c        pl=self.pl
-000136f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013700: 2020 2020 2020 2020 2020 2020 2020 7075                pu
-00013710: 3d73 656c 662e 7075 2c0a 2020 2020 2020  =self.pu,.      
-00013720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013730: 2020 2020 2020 6563 636c 696d 3d73 656c        ecclim=sel
-00013740: 662e 6563 636c 696d 2c0a 2020 2020 2020  f.ecclim,.      
-00013750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013760: 2020 2020 2020 6c69 6768 745f 7472 6176        light_trav
-00013770: 656c 5f64 656c 6179 203d 2073 656c 662e  el_delay = self.
-00013780: 6c69 6768 745f 7472 6176 656c 5f64 656c  light_travel_del
-00013790: 6179 2c0a 2020 2020 2020 2020 2020 2020  ay,.            
-000137a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000137b0: 7374 656c 6c61 725f 7261 6469 7573 203d  stellar_radius =
-000137c0: 2073 656c 662e 7374 656c 6c61 725f 7261   self.stellar_ra
-000137d0: 6469 7573 2c0a 2020 2020 2020 2020 2020  dius,.          
-000137e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000137f0: 2020 6c6f 675f 6c69 6b65 5f63 616c 633d    log_like_calc=
-00013800: 5472 7565 290a 2020 2020 2020 2020 6966  True).        if
-00013810: 2073 656c 662e 6461 7461 2e74 5f72 7620   self.data.t_rv 
-00013820: 6973 206e 6f74 204e 6f6e 653a 0a0a 2020  is not None:..  
-00013830: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
-00013840: 7620 3d20 6d6f 6465 6c28 7365 6c66 2e64  v = model(self.d
-00013850: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
-00013860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013870: 206d 6f64 656c 7479 7065 3d27 7276 272c   modeltype='rv',
-00013880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013890: 2020 2020 2020 2020 2020 2020 2065 6363               ecc
-000138a0: 6c69 6d3d 7365 6c66 2e65 6363 6c69 6d2c  lim=self.ecclim,
-000138b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000138c0: 2020 2020 2020 2020 2020 2020 2074 613d               ta=
-000138d0: 7365 6c66 2e74 612c 0a20 2020 2020 2020  self.ta,.       
-000138e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000138f0: 2020 2020 206c 6f67 5f6c 696b 655f 6361       log_like_ca
-00013900: 6c63 3d54 7275 6529 0a0a 2020 2020 2020  lc=True)..      
-00013910: 2020 2320 4669 7273 742c 2063 6865 636b    # First, check
-00013920: 2069 6620 6120 7275 6e20 6861 7320 616c   if a run has al
-00013930: 7265 6164 7920 6265 656e 2070 6572 666f  ready been perfo
-00013940: 726d 6564 2077 6974 6820 7468 6520 7573  rmed with the us
-00013950: 6572 2d64 6566 696e 6564 2073 616d 706c  er-defined sampl
-00013960: 6572 2e20 4966 2069 7420 6861 736e 2774  er. If it hasn't
-00013970: 2c20 7275 6e20 6974 2e0a 2020 2020 2020  , run it..      
-00013980: 2020 2320 4966 2069 7420 6861 7320 2864    # If it has (d
-00013990: 6574 6563 7465 6420 7468 726f 7567 6820  etected through 
-000139a0: 6974 7320 6f75 7470 7574 2066 696c 656e  its output filen
-000139b0: 616d 6529 2c20 736b 6970 2072 756e 6e69  ame), skip runni
-000139c0: 6e67 2061 6761 696e 2061 6e64 206a 756d  ng again and jum
-000139d0: 7020 7374 7261 6967 6874 2074 6f20 6c6f  p straight to lo
-000139e0: 6164 696e 6720 7468 650a 2020 2020 2020  ading the.      
-000139f0: 2020 2320 6461 7461 3a0a 2020 2020 2020    # data:.      
-00013a00: 2020 6f75 7420 3d20 7b7d 0a20 2020 2020    out = {}.     
-00013a10: 2020 2072 756e 5361 6d70 6c65 7220 3d20     runSampler = 
-00013a20: 4661 6c73 650a 2020 2020 2020 2020 6966  False.        if
-00013a30: 2073 656c 662e 6f75 745f 666f 6c64 6572   self.out_folder
-00013a40: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00013a50: 2020 2020 2020 7365 6c66 2e6f 7574 5f66        self.out_f
-00013a60: 6f6c 6465 7220 3d20 6f73 2e67 6574 6377  older = os.getcw
-00013a70: 6428 2920 2b20 272f 270a 2020 2020 2020  d() + '/'.      
-00013a80: 2020 6966 2028 6e6f 7420 6f73 2e70 6174    if (not os.pat
-00013a90: 682e 6578 6973 7473 2873 656c 662e 6f75  h.exists(self.ou
-00013aa0: 745f 666f 6c64 6572 202b 2073 656c 662e  t_folder + self.
-00013ab0: 7361 6d70 6c65 725f 7072 6566 6978 202b  sampler_prefix +
-00013ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ae0: 2770 6f73 7465 7269 6f72 732e 706b 6c27  'posteriors.pkl'
-00013af0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00013b00: 7275 6e53 616d 706c 6572 203d 2054 7275  runSampler = Tru
-00013b10: 650a 0a20 2020 2020 2020 2023 2049 6620  e..        # If 
-00013b20: 7275 6e53 616d 706c 6572 2069 7320 5472  runSampler is Tr
-00013b30: 7565 2c20 7468 656e 2072 756e 2074 6865  ue, then run the
-00013b40: 2073 616d 706c 6572 206f 6620 6368 6f69   sampler of choi
-00013b50: 6365 3a0a 2020 2020 2020 2020 6966 2072  ce:.        if r
-00013b60: 756e 5361 6d70 6c65 723a 0a20 2020 2020  unSampler:.     
-00013b70: 2020 2020 2020 2069 6620 2775 6c74 7261         if 'ultra
-00013b80: 6e65 7374 2720 696e 2073 656c 662e 7361  nest' in self.sa
-00013b90: 6d70 6c65 723a 0a20 2020 2020 2020 2020  mpler:.         
-00013ba0: 2020 2020 2020 2066 726f 6d20 756c 7472         from ultr
-00013bb0: 616e 6573 7420 696d 706f 7274 2052 6561  anest import Rea
-00013bc0: 6374 6976 654e 6573 7465 6453 616d 706c  ctiveNestedSampl
-00013bd0: 6572 0a0a 2020 2020 2020 2020 2020 2020  er..            
-00013be0: 2020 2020 2320 4d61 7463 6820 6b77 6172      # Match kwar
-00013bf0: 6773 2074 6f20 706f 7373 6962 6c65 2052  gs to possible R
-00013c00: 6561 6374 6976 654e 6573 7465 6453 616d  eactiveNestedSam
-00013c10: 706c 6572 206b 6579 776f 7264 732e 2046  pler keywords. F
-00013c20: 6972 7374 2c20 6578 7472 6163 7420 706f  irst, extract po
-00013c30: 7373 6962 6c65 2061 7267 756d 656e 7473  ssible arguments
-00013c40: 206f 6620 5265 6163 7469 7665 4e65 7374   of ReactiveNest
-00013c50: 6564 5361 6d70 6c65 723a 0a20 2020 2020  edSampler:.     
-00013c60: 2020 2020 2020 2020 2020 2061 7267 7320             args 
-00013c70: 3d20 5265 6163 7469 7665 4e65 7374 6564  = ReactiveNested
-00013c80: 5361 6d70 6c65 722e 5f5f 696e 6974 5f5f  Sampler.__init__
-00013c90: 2e5f 5f63 6f64 655f 5f2e 636f 5f76 6172  .__code__.co_var
-00013ca0: 6e61 6d65 730a 2020 2020 2020 2020 2020  names.          
-00013cb0: 2020 2020 2020 726e 735f 6172 6773 203d        rns_args =
-00013cc0: 207b 7d0a 2020 2020 2020 2020 2020 2020   {}.            
-00013cd0: 2020 2020 2320 4669 7273 742c 2064 6566      # First, def
-00013ce0: 696e 6520 736f 6d65 2073 7461 6e64 6172  ine some standar
-00013cf0: 6420 6f6e 6573 3a0a 2020 2020 2020 2020  d ones:.        
-00013d00: 2020 2020 2020 2020 726e 735f 6172 6773          rns_args
-00013d10: 5b27 7472 616e 7366 6f72 6d27 5d20 3d20  ['transform'] = 
-00013d20: 7365 6c66 2e70 7269 6f72 5f74 7261 6e73  self.prior_trans
-00013d30: 666f 726d 5f72 0a20 2020 2020 2020 2020  form_r.         
-00013d40: 2020 2020 2020 2072 6e73 5f61 7267 735b         rns_args[
-00013d50: 276c 6f67 5f64 6972 275d 203d 2073 656c  'log_dir'] = sel
-00013d60: 662e 6f75 745f 666f 6c64 6572 0a20 2020  f.out_folder.   
-00013d70: 2020 2020 2020 2020 2020 2020 2072 6e73               rns
-00013d80: 5f61 7267 735b 2772 6573 756d 6527 5d20  _args['resume'] 
-00013d90: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
-00013da0: 2020 2020 2020 2023 204e 6f77 2065 7874         # Now ext
-00013db0: 7261 6374 2061 7267 756d 656e 7473 2066  ract arguments f
-00013dc0: 726f 6d20 6b77 6172 6773 3b20 7468 6579  rom kwargs; they
-00013dd0: 2074 616b 6520 7072 6573 6564 656e 6365   take presedence
-00013de0: 206f 7665 7220 7468 6520 7374 616e 6461   over the standa
-00013df0: 7264 206f 6e65 7320 6162 6f76 653a 0a20  rd ones above:. 
-00013e00: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00013e10: 6f72 2061 7267 2069 6e20 6172 6773 3a0a  or arg in args:.
-00013e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e30: 2020 2020 6966 2061 7267 2069 6e20 6b77      if arg in kw
-00013e40: 6172 6773 3a0a 2020 2020 2020 2020 2020  args:.          
-00013e50: 2020 2020 2020 2020 2020 2020 2020 726e                rn
-00013e60: 735f 6172 6773 5b61 7267 5d20 3d20 6b77  s_args[arg] = kw
-00013e70: 6172 6773 5b61 7267 5d0a 2020 2020 2020  args[arg].      
-00013e80: 2020 2020 2020 2020 2020 2320 2e2e 2e61            # ...a
-00013e90: 6e64 206c 6f61 6420 7468 6520 7361 6d70  nd load the samp
-00013ea0: 6c65 723a 0a20 2020 2020 2020 2020 2020  ler:.           
-00013eb0: 2020 2020 2073 616d 706c 6572 203d 2052       sampler = R
-00013ec0: 6561 6374 6976 654e 6573 7465 6453 616d  eactiveNestedSam
-00013ed0: 706c 6572 2873 656c 662e 7061 7261 6d6e  pler(self.paramn
-00013ee0: 616d 6573 2c20 7365 6c66 2e6c 6f67 6c69  ames, self.logli
-00013ef0: 6b65 2c0a 2020 2020 2020 2020 2020 2020  ke,.            
-00013f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f20: 2020 2020 2a2a 726e 735f 6172 6773 290a      **rns_args).
-00013f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013f40: 2069 6620 2773 6c69 6365 7361 6d70 6c65   if 'slicesample
-00013f50: 7227 2069 6e20 7365 6c66 2e73 616d 706c  r' in self.sampl
-00013f60: 6572 3a0a 2020 2020 2020 2020 2020 2020  er:.            
-00013f70: 2020 2020 2020 2020 696d 706f 7274 2075          import u
-00013f80: 6c74 7261 6e65 7374 2e73 7465 7073 616d  ltranest.stepsam
-00013f90: 706c 6572 0a0a 2020 2020 2020 2020 2020  pler..          
-00013fa0: 2020 2020 2020 2020 2020 2320 4d61 7463            # Matc
-00013fb0: 6820 6b77 6172 6673 2074 6f20 706f 7373  h kwarfs to poss
-00013fc0: 6962 6c65 2061 7267 7320 696e 2052 6567  ible args in Reg
-00013fd0: 696f 6e53 6c69 6365 5361 6d70 6c65 723a  ionSliceSampler:
-00013fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013ff0: 2020 2020 2061 7267 7320 3d20 756c 7472       args = ultr
-00014000: 616e 6573 742e 7374 6570 7361 6d70 6c65  anest.stepsample
-00014010: 722e 536c 6963 6553 616d 706c 6572 2e5f  r.SliceSampler._
-00014020: 5f69 6e69 745f 5f2e 5f5f 636f 6465 5f5f  _init__.__code__
-00014030: 2e63 6f5f 7661 726e 616d 6573 0a20 2020  .co_varnames.   
-00014040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014050: 2072 7373 5f61 7267 7320 3d20 7b7d 0a20   rss_args = {}. 
-00014060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014070: 2020 2023 2046 6972 7374 2c20 6465 6669     # First, defi
-00014080: 6e65 2073 7461 6e64 6172 6420 6f6e 6573  ne standard ones
-00014090: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000140a0: 2020 2020 2020 7273 735f 6172 6773 5b27        rss_args['
-000140b0: 6e73 7465 7073 275d 203d 2034 3030 0a20  nsteps'] = 400. 
-000140c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000140d0: 2020 2072 7373 5f61 7267 735b 2761 6461     rss_args['ada
-000140e0: 7074 6976 655f 6e73 7465 7073 275d 203d  ptive_nsteps'] =
-000140f0: 2027 6d6f 7665 2d64 6973 7461 6e63 6527   'move-distance'
-00014100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014110: 2020 2020 2023 2045 7874 7261 6374 206b       # Extract k
-00014120: 7761 7267 732c 2061 6464 2074 6865 6d20  wargs, add them 
-00014130: 696e 3a0a 2020 2020 2020 2020 2020 2020  in:.            
-00014140: 2020 2020 2020 2020 666f 7220 6172 6720          for arg 
-00014150: 696e 2061 7267 733a 0a20 2020 2020 2020  in args:.       
-00014160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014170: 2069 6620 6172 6720 696e 206b 7761 7267   if arg in kwarg
-00014180: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00014190: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000141a0: 7373 5f61 7267 735b 6172 675d 203d 206b  ss_args[arg] = k
-000141b0: 7761 7267 735b 6172 675d 0a0a 2020 2020  wargs[arg]..    
-000141c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000141d0: 2320 4170 706c 7920 7374 6570 7361 6d70  # Apply stepsamp
-000141e0: 6c65 723a 0a20 2020 2020 2020 2020 2020  ler:.           
-000141f0: 2020 2020 2020 2020 2073 616d 706c 6572           sampler
-00014200: 2e73 7465 7073 616d 706c 6572 203d 2075  .stepsampler = u
-00014210: 6c74 7261 6e65 7374 2e73 7465 7073 616d  ltranest.stepsam
-00014220: 706c 6572 2e52 6567 696f 6e53 6c69 6365  pler.RegionSlice
-00014230: 5361 6d70 6c65 7228 0a20 2020 2020 2020  Sampler(.       
-00014240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014250: 202a 2a72 7373 5f61 7267 7329 0a0a 2020   **rss_args)..  
-00014260: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00014270: 4e6f 7720 646f 2074 6865 2073 616d 6520  Now do the same 
-00014280: 666f 7220 5265 6163 7469 7665 4e65 7374  for ReactiveNest
-00014290: 6564 5361 6d70 6c65 722e 7275 6e20 2d2d  edSampler.run --
-000142a0: 2d20 6c6f 6164 2061 6e79 206b 7761 7267  - load any kwarg
-000142b0: 7320 7468 6520 7573 6572 2068 6173 2067  s the user has g
-000142c0: 6976 656e 2061 7320 696e 7075 743a 0a20  iven as input:. 
-000142d0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000142e0: 7267 7320 3d20 5265 6163 7469 7665 4e65  rgs = ReactiveNe
-000142f0: 7374 6564 5361 6d70 6c65 722e 7275 6e2e  stedSampler.run.
-00014300: 5f5f 636f 6465 5f5f 2e63 6f5f 7661 726e  __code__.co_varn
-00014310: 616d 6573 0a20 2020 2020 2020 2020 2020  ames.           
-00014320: 2020 2020 2072 6e73 5f72 756e 5f61 7267       rns_run_arg
-00014330: 7320 3d20 7b7d 0a20 2020 2020 2020 2020  s = {}.         
-00014340: 2020 2020 2020 2023 2044 6566 696e 6520         # Define 
-00014350: 736f 6d65 2073 7461 6e64 6172 6420 6f6e  some standard on
-00014360: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00014370: 2020 2020 726e 735f 7275 6e5f 6172 6773      rns_run_args
-00014380: 5b27 6672 6163 5f72 656d 6169 6e27 5d20  ['frac_remain'] 
-00014390: 3d20 302e 310a 2020 2020 2020 2020 2020  = 0.1.          
-000143a0: 2020 2020 2020 726e 735f 7275 6e5f 6172        rns_run_ar
-000143b0: 6773 5b27 6d69 6e5f 6e75 6d5f 6c69 7665  gs['min_num_live
-000143c0: 5f70 6f69 6e74 7327 5d20 3d20 7365 6c66  _points'] = self
-000143d0: 2e6e 5f6c 6976 655f 706f 696e 7473 0a20  .n_live_points. 
-000143e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000143f0: 6e73 5f72 756e 5f61 7267 735b 276d 6178  ns_run_args['max
-00014400: 5f6e 756d 5f69 6d70 726f 7665 6d65 6e74  _num_improvement
-00014410: 5f6c 6f6f 7073 275d 203d 2031 0a20 2020  _loops'] = 1.   
-00014420: 2020 2020 2020 2020 2020 2020 2023 204c               # L
-00014430: 6f61 6420 7468 6520 6f6e 6573 2066 726f  oad the ones fro
-00014440: 6d20 7468 6520 6b77 6172 6773 3a0a 2020  m the kwargs:.  
-00014450: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00014460: 7220 6172 6720 696e 2061 7267 733a 0a20  r arg in args:. 
-00014470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014480: 2020 2069 6620 6172 6720 696e 206b 7761     if arg in kwa
-00014490: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-000144a0: 2020 2020 2020 2020 2020 2020 2072 6e73               rns
-000144b0: 5f72 756e 5f61 7267 735b 6172 675d 203d  _run_args[arg] =
-000144c0: 206b 7761 7267 735b 6172 675d 0a20 2020   kwargs[arg].   
-000144d0: 2020 2020 2020 2020 2020 2020 2023 2052               # R
-000144e0: 756e 2074 6865 2073 616d 706c 6572 3a0a  un the sampler:.
-000144f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014500: 7265 7375 6c74 7320 3d20 7361 6d70 6c65  results = sample
-00014510: 722e 7275 6e28 2a2a 726e 735f 7275 6e5f  r.run(**rns_run_
-00014520: 6172 6773 290a 2020 2020 2020 2020 2020  args).          
-00014530: 2020 2020 2020 7361 6d70 6c65 722e 7072        sampler.pr
-00014540: 696e 745f 7265 7375 6c74 7328 290a 2020  int_results().  
-00014550: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-00014560: 6d70 6c65 722e 706c 6f74 2829 0a0a 2020  mpler.plot()..  
-00014570: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00014580: 5361 7665 2075 6c74 7261 6e65 7374 206f  Save ultranest o
-00014590: 7574 7075 7473 3a0a 2020 2020 2020 2020  utputs:.        
-000145a0: 2020 2020 2020 2020 6f75 745b 2775 6c74          out['ult
-000145b0: 7261 6e65 7374 5f6f 7574 7075 7427 5d20  ranest_output'] 
-000145c0: 3d20 7265 7375 6c74 730a 2020 2020 2020  = results.      
-000145d0: 2020 2020 2020 2020 2020 2320 4765 7420            # Get 
-000145e0: 7765 6967 6874 6564 2070 6f73 7465 7269  weighted posteri
-000145f0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
-00014600: 2020 2020 706f 7374 6572 696f 725f 7361      posterior_sa
-00014610: 6d70 6c65 7320 3d20 7265 7375 6c74 735b  mples = results[
-00014620: 2773 616d 706c 6573 275d 0a20 2020 2020  'samples'].     
-00014630: 2020 2020 2020 2020 2020 2023 2047 6574             # Get
-00014640: 206c 6e5a 3a0a 2020 2020 2020 2020 2020   lnZ:.          
-00014650: 2020 2020 2020 6f75 745b 276c 6e5a 275d        out['lnZ']
-00014660: 203d 2072 6573 756c 7473 5b27 6c6f 677a   = results['logz
-00014670: 275d 0a20 2020 2020 2020 2020 2020 2020  '].             
-00014680: 2020 206f 7574 5b27 6c6e 5a65 7272 275d     out['lnZerr']
-00014690: 203d 2072 6573 756c 7473 5b27 6c6f 677a   = results['logz
-000146a0: 6572 7227 5d0a 0a20 2020 2020 2020 2020  err']..         
-000146b0: 2020 2065 6c69 6620 276d 756c 7469 6e65     elif 'multine
-000146c0: 7374 2720 696e 2073 656c 662e 7361 6d70  st' in self.samp
-000146d0: 6c65 723a 0a20 2020 2020 2020 2020 2020  ler:.           
-000146e0: 2020 2020 2023 2041 7320 646f 6e65 2066       # As done f
-000146f0: 6f72 2075 6c74 7261 6e65 7374 2061 626f  or ultranest abo
-00014700: 7665 2c20 7363 616e 2070 6f73 7369 626c  ve, scan possibl
-00014710: 6520 6172 6775 6d65 6e74 7320 666f 7220  e arguments for 
-00014720: 7079 6d75 6c74 696e 6573 742e 7275 6e3a  pymultinest.run:
-00014730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014740: 2061 7267 7320 3d20 7079 6d75 6c74 696e   args = pymultin
-00014750: 6573 742e 7275 6e2e 5f5f 636f 6465 5f5f  est.run.__code__
-00014760: 2e63 6f5f 7661 726e 616d 6573 0a20 2020  .co_varnames.   
-00014770: 2020 2020 2020 2020 2020 2020 206d 6e5f               mn_
-00014780: 6172 6773 203d 207b 7d0a 2020 2020 2020  args = {}.      
-00014790: 2020 2020 2020 2020 2020 2320 4465 6669            # Defi
-000147a0: 6e65 2073 6f6d 6520 7374 616e 6461 7264  ne some standard
-000147b0: 206f 6e65 733a 0a20 2020 2020 2020 2020   ones:.         
-000147c0: 2020 2020 2020 206d 6e5f 6172 6773 5b27         mn_args['
-000147d0: 6e5f 6c69 7665 5f70 6f69 6e74 7327 5d20  n_live_points'] 
-000147e0: 3d20 7365 6c66 2e6e 5f6c 6976 655f 706f  = self.n_live_po
-000147f0: 696e 7473 0a20 2020 2020 2020 2020 2020  ints.           
-00014800: 2020 2020 206d 6e5f 6172 6773 5b27 6d61       mn_args['ma
-00014810: 785f 6d6f 6465 7327 5d20 3d20 3130 300a  x_modes'] = 100.
-00014820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014830: 6d6e 5f61 7267 735b 276f 7574 7075 7466  mn_args['outputf
-00014840: 696c 6573 5f62 6173 656e 616d 6527 5d20  iles_basename'] 
-00014850: 3d20 7365 6c66 2e6f 7574 5f66 6f6c 6465  = self.out_folde
-00014860: 7220 2b20 276a 6f6d 6e65 7374 5f27 0a20  r + 'jomnest_'. 
-00014870: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00014880: 6e5f 6172 6773 5b27 7265 7375 6d65 275d  n_args['resume']
-00014890: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
-000148a0: 2020 2020 2020 2020 206d 6e5f 6172 6773           mn_args
-000148b0: 5b27 7665 7262 6f73 6527 5d20 3d20 7365  ['verbose'] = se
-000148c0: 6c66 2e64 6174 612e 7665 7262 6f73 650a  lf.data.verbose.
-000148d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000148e0: 2320 4e6f 7720 6578 7472 6163 7420 6172  # Now extract ar
-000148f0: 6775 6d65 6e74 7320 6672 6f6d 206b 7761  guments from kwa
-00014900: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-00014910: 2020 2020 2066 6f72 2061 7267 2069 6e20       for arg in 
-00014920: 6172 6773 3a0a 2020 2020 2020 2020 2020  args:.          
-00014930: 2020 2020 2020 2020 2020 6966 2061 7267            if arg
-00014940: 2069 6e20 6b77 6172 6773 3a0a 2020 2020   in kwargs:.    
-00014950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014960: 2020 2020 6d6e 5f61 7267 735b 6172 675d      mn_args[arg]
-00014970: 203d 206b 7761 7267 735b 6172 675d 0a20   = kwargs[arg]. 
-00014980: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00014990: 2044 6566 696e 6520 7468 6520 7361 6d70   Define the samp
-000149a0: 6c65 723a 0a20 2020 2020 2020 2020 2020  ler:.           
-000149b0: 2020 2020 2070 796d 756c 7469 6e65 7374       pymultinest
-000149c0: 2e72 756e 2873 656c 662e 6c6f 676c 696b  .run(self.loglik
-000149d0: 652c 2073 656c 662e 7072 696f 725f 7472  e, self.prior_tr
-000149e0: 616e 7366 6f72 6d2c 0a20 2020 2020 2020  ansform,.       
-000149f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a00: 2020 2020 2020 2020 2073 656c 662e 6461           self.da
-00014a10: 7461 2e6e 7061 7261 6d73 2c20 2a2a 6d6e  ta.nparams, **mn
-00014a20: 5f61 7267 7329 0a0a 2020 2020 2020 2020  _args)..        
-00014a30: 2020 2020 2020 2020 2320 4e6f 772c 2077          # Now, w
-00014a40: 6974 6820 7468 6520 7361 6d70 6c65 7220  ith the sampler 
-00014a50: 6465 6669 6e65 642c 2072 6570 6561 7420  defined, repeat 
-00014a60: 7468 6520 7361 6d65 2061 7320 6162 6f76  the same as abov
-00014a70: 6520 666f 7220 7468 6520 7079 6d75 6c74  e for the pymult
-00014a80: 696e 6573 742e 416e 616c 797a 6572 206f  inest.Analyzer o
-00014a90: 626a 6563 743a 0a20 2020 2020 2020 2020  bject:.         
-00014aa0: 2020 2020 2020 2061 7267 7320 3d20 7079         args = py
-00014ab0: 6d75 6c74 696e 6573 742e 416e 616c 797a  multinest.Analyz
-00014ac0: 6572 2e5f 5f69 6e69 745f 5f2e 5f5f 636f  er.__init__.__co
-00014ad0: 6465 5f5f 2e63 6f5f 7661 726e 616d 6573  de__.co_varnames
-00014ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014af0: 206d 6e61 5f61 7267 7320 3d20 7b7d 0a20   mna_args = {}. 
-00014b00: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00014b10: 2044 6566 696e 6520 7374 616e 6461 7264   Define standard
-00014b20: 206f 6e65 733a 0a20 2020 2020 2020 2020   ones:.         
-00014b30: 2020 2020 2020 206d 6e61 5f61 7267 735b         mna_args[
-00014b40: 276f 7574 7075 7466 696c 6573 5f62 6173  'outputfiles_bas
-00014b50: 656e 616d 6527 5d20 3d20 7365 6c66 2e6f  ename'] = self.o
-00014b60: 7574 5f66 6f6c 6465 7220 2b20 276a 6f6d  ut_folder + 'jom
-00014b70: 6e65 7374 5f27 0a20 2020 2020 2020 2020  nest_'.         
-00014b80: 2020 2020 2020 206d 6e61 5f61 7267 735b         mna_args[
-00014b90: 276e 5f70 6172 616d 7327 5d20 3d20 7365  'n_params'] = se
-00014ba0: 6c66 2e64 6174 612e 6e70 6172 616d 730a  lf.data.nparams.
-00014bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014bc0: 2320 4c6f 6164 2074 6865 206f 6e65 7320  # Load the ones 
-00014bd0: 6672 6f6d 206b 7761 7267 733a 0a20 2020  from kwargs:.   
-00014be0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00014bf0: 2061 7267 2069 6e20 6172 6773 3a0a 2020   arg in args:.  
-00014c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c10: 2020 6966 2061 7267 2069 6e20 6b77 6172    if arg in kwar
-00014c20: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
-00014c30: 2020 2020 2020 2020 2020 2020 6d6e 615f              mna_
-00014c40: 6172 6773 5b61 7267 5d20 3d20 6b77 6172  args[arg] = kwar
-00014c50: 6773 5b61 7267 5d0a 2020 2020 2020 2020  gs[arg].        
-00014c60: 2020 2020 2020 2020 2320 5275 6e20 616e          # Run an
-00014c70: 6420 6765 7420 6f75 7470 7574 3a0a 2020  d get output:.  
-00014c80: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
-00014c90: 7470 7574 203d 2070 796d 756c 7469 6e65  tput = pymultine
-00014ca0: 7374 2e41 6e61 6c79 7a65 7228 2a2a 6d6e  st.Analyzer(**mn
-00014cb0: 615f 6172 6773 290a 2020 2020 2020 2020  a_args).        
-00014cc0: 2020 2020 2020 2020 2320 4765 7420 6f75          # Get ou
-00014cd0: 7420 7061 7261 6d65 7465 7273 3a20 7468  t parameters: th
-00014ce0: 6973 206d 6174 7269 7820 6861 7320 2873  is matrix has (s
-00014cf0: 616d 706c 6573 2c6e 5f70 6172 616d 732b  amples,n_params+
-00014d00: 3129 3a0a 2020 2020 2020 2020 2020 2020  1):.            
-00014d10: 2020 2020 706f 7374 6572 696f 725f 7361      posterior_sa
-00014d20: 6d70 6c65 7320 3d20 6f75 7470 7574 2e67  mples = output.g
-00014d30: 6574 5f65 7175 616c 5f77 6569 6768 7465  et_equal_weighte
-00014d40: 645f 706f 7374 6572 696f 7228 0a20 2020  d_posterior(.   
-00014d50: 2020 2020 2020 2020 2020 2020 2029 5b3a               )[:
-00014d60: 2c20 3a2d 315d 0a20 2020 2020 2020 2020  , :-1].         
-00014d70: 2020 2020 2020 2023 2047 6574 2049 4e53         # Get INS
-00014d80: 206c 6e5a 3a0a 2020 2020 2020 2020 2020   lnZ:.          
-00014d90: 2020 2020 2020 6f75 745b 276c 6e5a 275d        out['lnZ']
-00014da0: 203d 206f 7574 7075 742e 6765 745f 7374   = output.get_st
-00014db0: 6174 7328 295b 2767 6c6f 6261 6c20 6576  ats()['global ev
-00014dc0: 6964 656e 6365 275d 0a20 2020 2020 2020  idence'].       
-00014dd0: 2020 2020 2020 2020 206f 7574 5b27 6c6e           out['ln
-00014de0: 5a65 7272 275d 203d 206f 7574 7075 742e  Zerr'] = output.
-00014df0: 6765 745f 7374 6174 7328 295b 2767 6c6f  get_stats()['glo
-00014e00: 6261 6c20 6576 6964 656e 6365 2065 7272  bal evidence err
-00014e10: 6f72 275d 0a0a 2020 2020 2020 2020 2020  or']..          
-00014e20: 2020 656c 6966 2027 6479 6e65 7374 7927    elif 'dynesty'
-00014e30: 2069 6e20 7365 6c66 2e73 616d 706c 6572   in self.sampler
-00014e40: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-00014e50: 2020 2069 6620 7365 6c66 2e73 616d 706c     if self.sampl
-00014e60: 6572 203d 3d20 2764 796e 616d 6963 5f64  er == 'dynamic_d
-00014e70: 796e 6573 7479 273a 0a0a 2020 2020 2020  ynesty':..      
-00014e80: 2020 2020 2020 2020 2020 2020 2020 4479                Dy
-00014e90: 6e65 7374 7953 616d 706c 6572 203d 2064  nestySampler = d
-00014ea0: 796e 6573 7479 2e44 796e 616d 6963 4e65  ynesty.DynamicNe
-00014eb0: 7374 6564 5361 6d70 6c65 720a 0a20 2020  stedSampler..   
-00014ec0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00014ed0: 6620 7365 6c66 2e73 616d 706c 6572 203d  f self.sampler =
-00014ee0: 3d20 2764 796e 6573 7479 273a 0a0a 2020  = 'dynesty':..  
-00014ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f00: 2020 4479 6e65 7374 7953 616d 706c 6572    DynestySampler
-00014f10: 203d 2064 796e 6573 7479 2e4e 6573 7465   = dynesty.Neste
-00014f20: 6453 616d 706c 6572 0a0a 2020 2020 2020  dSampler..      
-00014f30: 2020 2020 2020 2020 2020 2320 546f 2072            # To r
-00014f40: 756e 2064 796e 6573 7479 2c20 7765 2064  un dynesty, we d
-00014f50: 6f20 6974 2061 206c 6974 746c 6520 6269  o it a little bi
-00014f60: 7420 6469 6666 6572 656e 7420 6465 7065  t different depe
-00014f70: 6e64 696e 6720 6966 2077 6520 6172 6520  nding if we are 
-00014f80: 646f 696e 6720 6d75 6c74 6974 6872 6561  doing multithrea
-00014f90: 6469 6e67 206f 7220 6e6f 743a 0a20 2020  ding or not:.   
-00014fa0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00014fb0: 7365 6c66 2e6e 7468 7265 6164 7320 6973  self.nthreads is
-00014fc0: 204e 6f6e 653a 0a0a 2020 2020 2020 2020   None:..        
-00014fd0: 2020 2020 2020 2020 2020 2020 2320 4173              # As
-00014fe0: 2077 6974 6820 7468 6520 6f74 6865 7220   with the other 
-00014ff0: 7361 6d70 6c65 7273 2c20 6669 7273 7420  samplers, first 
-00015000: 6578 7472 6163 7420 6c69 7374 206f 6620  extract list of 
-00015010: 706f 7373 6962 6c65 2061 7267 733a 0a20  possible args:. 
-00015020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015030: 2020 2061 7267 7320 3d20 7661 7273 2844     args = vars(D
-00015040: 796e 6573 7479 5361 6d70 6c65 7229 2e6b  ynestySampler).k
-00015050: 6579 7328 290a 2020 2020 2020 2020 2020  eys().          
-00015060: 2020 2020 2020 2020 2020 645f 6172 6773            d_args
-00015070: 203d 207b 7d0a 0a20 2020 2020 2020 2020   = {}..         
-00015080: 2020 2020 2020 2020 2020 2023 2044 6566             # Def
-00015090: 696e 6520 736f 6d65 2073 7461 6e64 6172  ine some standar
-000150a0: 6420 6f6e 6573 2028 666f 7220 6261 636b  d ones (for back
-000150b0: 2d63 6f6d 7061 7469 6269 6c69 7479 2077  -compatibility w
-000150c0: 6974 6820 7072 6576 696f 7573 206a 756c  ith previous jul
-000150d0: 6965 7420 7665 7273 696f 6e73 293a 0a20  iet versions):. 
-000150e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000150f0: 2020 2064 5f61 7267 735b 2762 6f75 6e64     d_args['bound
-00015100: 275d 203d 2027 6d75 6c74 6927 0a20 2020  '] = 'multi'.   
+0000b4f0: 6e65 2c20 6c69 6e65 6172 5f72 6567 7265  ne, linear_regre
+0000b500: 7373 6f72 735f 6c63 203d 204e 6f6e 652c  ssors_lc = None,
+0000b510: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+0000b520: 2020 2020 4750 5f72 6567 7265 7373 6f72      GP_regressor
+0000b530: 735f 7276 203d 204e 6f6e 652c 206c 696e  s_rv = None, lin
+0000b540: 6561 725f 7265 6772 6573 736f 7273 5f72  ear_regressors_r
+0000b550: 7620 3d20 4e6f 6e65 2c0a 2020 2020 2020  v = None,.      
+0000b560: 2020 2020 2020 2020 2020 206f 7574 5f66             out_f
+0000b570: 6f6c 6465 7220 3d20 4e6f 6e65 2c20 6c63  older = None, lc
+0000b580: 6669 6c65 6e61 6d65 203d 204e 6f6e 652c  filename = None,
+0000b590: 2072 7666 696c 656e 616d 6520 3d20 4e6f   rvfilename = No
+0000b5a0: 6e65 2c20 4750 6c63 6570 6172 616d 6669  ne, GPlceparamfi
+0000b5b0: 6c65 203d 204e 6f6e 652c 5c0a 2020 2020  le = None,\.    
+0000b5c0: 2020 2020 2020 2020 2020 2020 2047 5072               GPr
+0000b5d0: 7665 7061 7261 6d66 696c 6520 3d20 4e6f  veparamfile = No
+0000b5e0: 6e65 2c20 4c4d 6c63 6570 6172 616d 6669  ne, LMlceparamfi
+0000b5f0: 6c65 203d 204e 6f6e 652c 204c 4d72 7665  le = None, LMrve
+0000b600: 7061 7261 6d66 696c 6520 3d20 4e6f 6e65  paramfile = None
+0000b610: 2c20 6c63 7469 6d65 6465 6620 3d20 2754  , lctimedef = 'T
+0000b620: 4442 272c 2072 7674 696d 6564 6566 203d  DB', rvtimedef =
+0000b630: 2027 5554 4327 2c5c 0a20 2020 2020 2020   'UTC',\.       
+0000b640: 2020 2020 2020 2020 2020 6c64 5f6c 6177            ld_law
+0000b650: 7320 3d20 2771 7561 6472 6174 6963 272c  s = 'quadratic',
+0000b660: 2070 7269 6f72 6669 6c65 203d 204e 6f6e   priorfile = Non
+0000b670: 652c 206c 635f 6e5f 7375 7065 7273 616d  e, lc_n_supersam
+0000b680: 7020 3d20 4e6f 6e65 2c20 6c63 5f65 7870  p = None, lc_exp
+0000b690: 7469 6d65 5f73 7570 6572 7361 6d70 203d  time_supersamp =
+0000b6a0: 204e 6f6e 652c 205c 0a20 2020 2020 2020   None, \.       
+0000b6b0: 2020 2020 2020 2020 2020 6c63 5f69 6e73            lc_ins
+0000b6c0: 7472 756d 656e 745f 7375 7065 7273 616d  trument_supersam
+0000b6d0: 7020 3d20 4e6f 6e65 2c20 6d61 675f 746f  p = None, mag_to
+0000b6e0: 5f66 6c75 7820 3d20 5472 7565 2c20 7665  _flux = True, ve
+0000b6f0: 7262 6f73 6520 3d20 4661 6c73 652c 206d  rbose = False, m
+0000b700: 6174 6572 6e5f 6570 7320 3d20 302e 3031  atern_eps = 0.01
+0000b710: 2c20 6765 6f72 6765 5f68 6f64 6c72 203d  , george_hodlr =
+0000b720: 2054 7275 652c 205c 0a20 2020 2020 2020   True, \.       
+0000b730: 2020 2020 2020 2020 2020 7069 636b 6c65            pickle
+0000b740: 5f65 6e63 6f64 696e 6720 3d20 4e6f 6e65  _encoding = None
+0000b750: 293a 0a0a 2020 2020 2020 2020 7365 6c66  ):..        self
+0000b760: 2e6c 6366 696c 656e 616d 6520 3d20 6c63  .lcfilename = lc
+0000b770: 6669 6c65 6e61 6d65 0a20 2020 2020 2020  filename.       
+0000b780: 2073 656c 662e 7276 6669 6c65 6e61 6d65   self.rvfilename
+0000b790: 203d 2072 7666 696c 656e 616d 650a 2020   = rvfilename.  
+0000b7a0: 2020 2020 2020 7365 6c66 2e47 506c 6365        self.GPlce
+0000b7b0: 7061 7261 6d66 696c 6520 3d20 4750 6c63  paramfile = GPlc
+0000b7c0: 6570 6172 616d 6669 6c65 0a20 2020 2020  eparamfile.     
+0000b7d0: 2020 2073 656c 662e 4750 7276 6570 6172     self.GPrvepar
+0000b7e0: 616d 6669 6c65 203d 2047 5072 7665 7061  amfile = GPrvepa
+0000b7f0: 7261 6d66 696c 650a 2020 2020 2020 2020  ramfile.        
+0000b800: 7365 6c66 2e4c 4d6c 6365 7061 7261 6d66  self.LMlceparamf
+0000b810: 696c 6520 3d20 4c4d 6c63 6570 6172 616d  ile = LMlceparam
+0000b820: 6669 6c65 0a20 2020 2020 2020 2073 656c  file.        sel
+0000b830: 662e 4c4d 7276 6570 6172 616d 6669 6c65  f.LMrveparamfile
+0000b840: 203d 204c 4d72 7665 7061 7261 6d66 696c   = LMrveparamfil
+0000b850: 650a 2020 2020 2020 2020 7365 6c66 2e76  e.        self.v
+0000b860: 6572 626f 7365 203d 2076 6572 626f 7365  erbose = verbose
+0000b870: 0a20 2020 2020 2020 2073 656c 662e 7069  .        self.pi
+0000b880: 636b 6c65 5f65 6e63 6f64 696e 6720 3d20  ckle_encoding = 
+0000b890: 7069 636b 6c65 5f65 6e63 6f64 696e 670a  pickle_encoding.
+0000b8a0: 2020 2020 2020 2020 7365 6c66 2e73 7461          self.sta
+0000b8b0: 7274 696e 675f 706f 696e 7420 3d20 7374  rting_point = st
+0000b8c0: 6172 7469 6e67 5f70 6f69 6e74 0a0a 2020  arting_point..  
+0000b8d0: 2020 2020 2020 2320 4750 206f 7074 696f        # GP optio
+0000b8e0: 6e73 3a0a 2020 2020 2020 2020 7365 6c66  ns:.        self
+0000b8f0: 2e6d 6174 6572 6e5f 6570 7320 3d20 6d61  .matern_eps = ma
+0000b900: 7465 726e 5f65 7073 2020 2320 4570 7369  tern_eps  # Epsi
+0000b910: 6c6f 6e20 7061 7261 6d65 7465 7220 666f  lon parameter fo
+0000b920: 7220 6365 6c65 7269 7465 204d 6174 6572  r celerite Mater
+0000b930: 6e33 3254 6572 6d0a 2020 2020 2020 2020  n32Term.        
+0000b940: 7365 6c66 2e67 656f 7267 655f 686f 646c  self.george_hodl
+0000b950: 7220 3d20 6765 6f72 6765 5f68 6f64 6c72  r = george_hodlr
+0000b960: 2023 2057 6865 7465 7220 746f 2075 7365   # Wheter to use
+0000b970: 2048 4f44 4c52 2073 6f6c 7665 7220 6f72   HODLR solver or
+0000b980: 206e 6f74 2028 7365 653a 2068 7474 703a   not (see: http:
+0000b990: 2f2f 6466 6d2e 696f 2f67 656f 7267 652f  //dfm.io/george/
+0000b9a0: 6375 7272 656e 742f 7573 6572 2f73 6f6c  current/user/sol
+0000b9b0: 7665 7273 2f29 0a0a 2020 2020 2020 2020  vers/)..        
+0000b9c0: 2320 496e 6974 6961 6c69 7a65 2064 6174  # Initialize dat
+0000b9d0: 6120 6f70 7469 6f6e 7320 666f 7220 6c69  a options for li
+0000b9e0: 6768 7463 7572 7665 733a 0a20 2020 2020  ghtcurves:.     
+0000b9f0: 2020 2073 656c 662e 745f 6c63 203d 204e     self.t_lc = N
+0000ba00: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
+0000ba10: 2e79 5f6c 6320 3d20 4e6f 6e65 0a20 2020  .y_lc = None.   
+0000ba20: 2020 2020 2073 656c 662e 7965 7272 5f6c       self.yerr_l
+0000ba30: 6320 3d20 4e6f 6e65 0a20 2020 2020 2020  c = None.       
+0000ba40: 2073 656c 662e 696e 7374 7275 6d65 6e74   self.instrument
+0000ba50: 735f 6c63 203d 204e 6f6e 650a 2020 2020  s_lc = None.    
+0000ba60: 2020 2020 7365 6c66 2e6e 696e 7374 7275      self.ninstru
+0000ba70: 6d65 6e74 735f 6c63 203d 204e 6f6e 650a  ments_lc = None.
+0000ba80: 2020 2020 2020 2020 7365 6c66 2e69 6e61          self.ina
+0000ba90: 6d65 735f 6c63 203d 204e 6f6e 650a 2020  mes_lc = None.  
+0000baa0: 2020 2020 2020 7365 6c66 2e69 6e73 7472        self.instr
+0000bab0: 756d 656e 745f 696e 6465 7865 735f 6c63  ument_indexes_lc
+0000bac0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+0000bad0: 7365 6c66 2e6c 6d5f 6c63 5f62 6f6f 6c65  self.lm_lc_boole
+0000bae0: 616e 203d 204e 6f6e 650a 2020 2020 2020  an = None.      
+0000baf0: 2020 7365 6c66 2e6c 6d5f 6c63 5f61 7267    self.lm_lc_arg
+0000bb00: 756d 656e 7473 203d 204e 6f6e 650a 2020  uments = None.  
+0000bb10: 2020 2020 2020 7365 6c66 2e47 505f 6c63        self.GP_lc
+0000bb20: 5f61 7267 756d 656e 7473 203d 204e 6f6e  _arguments = Non
+0000bb30: 650a 2020 2020 2020 2020 7365 6c66 2e4c  e.        self.L
+0000bb40: 4d5f 6c63 5f61 7267 756d 656e 7473 203d  M_lc_arguments =
+0000bb50: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
+0000bb60: 6c66 2e6c 6374 696d 6564 6566 203d 206c  lf.lctimedef = l
+0000bb70: 6374 696d 6564 6566 0a20 2020 2020 2020  ctimedef.       
+0000bb80: 2073 656c 662e 6c64 5f6c 6177 7320 3d20   self.ld_laws = 
+0000bb90: 6c64 5f6c 6177 730a 2020 2020 2020 2020  ld_laws.        
+0000bba0: 7365 6c66 2e6c 635f 6e5f 7375 7065 7273  self.lc_n_supers
+0000bbb0: 616d 7020 3d20 6c63 5f6e 5f73 7570 6572  amp = lc_n_super
+0000bbc0: 7361 6d70 0a20 2020 2020 2020 2073 656c  samp.        sel
+0000bbd0: 662e 6c63 5f65 7870 7469 6d65 5f73 7570  f.lc_exptime_sup
+0000bbe0: 6572 7361 6d70 203d 206c 635f 6578 7074  ersamp = lc_expt
+0000bbf0: 696d 655f 7375 7065 7273 616d 700a 2020  ime_supersamp.  
+0000bc00: 2020 2020 2020 7365 6c66 2e6c 635f 696e        self.lc_in
+0000bc10: 7374 7275 6d65 6e74 5f73 7570 6572 7361  strument_supersa
+0000bc20: 6d70 203d 206c 635f 696e 7374 7275 6d65  mp = lc_instrume
+0000bc30: 6e74 5f73 7570 6572 7361 6d70 0a20 2020  nt_supersamp.   
+0000bc40: 2020 2020 2073 656c 662e 6c63 5f64 6174       self.lc_dat
+0000bc50: 6120 3d20 4661 6c73 650a 2020 2020 2020  a = False.      
+0000bc60: 2020 7365 6c66 2e67 6c6f 6261 6c5f 6c63    self.global_lc
+0000bc70: 5f6d 6f64 656c 203d 2046 616c 7365 0a20  _model = False. 
+0000bc80: 2020 2020 2020 2073 656c 662e 6c63 5f6f         self.lc_o
+0000bc90: 7074 696f 6e73 203d 207b 7d0a 0a20 2020  ptions = {}..   
+0000bca0: 2020 2020 2023 2049 6e69 7469 616c 697a       # Initializ
+0000bcb0: 6520 6461 7461 206f 7074 696f 6e73 2066  e data options f
+0000bcc0: 6f72 2052 5673 3a0a 2020 2020 2020 2020  or RVs:.        
+0000bcd0: 7365 6c66 2e74 5f72 7620 3d20 4e6f 6e65  self.t_rv = None
+0000bce0: 0a20 2020 2020 2020 2073 656c 662e 795f  .        self.y_
+0000bcf0: 7276 203d 204e 6f6e 650a 2020 2020 2020  rv = None.      
+0000bd00: 2020 7365 6c66 2e79 6572 725f 7276 203d    self.yerr_rv =
+0000bd10: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
+0000bd20: 6c66 2e69 6e73 7472 756d 656e 7473 5f72  lf.instruments_r
+0000bd30: 7620 3d20 4e6f 6e65 0a20 2020 2020 2020  v = None.       
+0000bd40: 2073 656c 662e 6e69 6e73 7472 756d 656e   self.ninstrumen
+0000bd50: 7473 5f72 7620 3d20 4e6f 6e65 0a20 2020  ts_rv = None.   
+0000bd60: 2020 2020 2073 656c 662e 696e 616d 6573       self.inames
+0000bd70: 5f72 7620 3d20 4e6f 6e65 0a20 2020 2020  _rv = None.     
+0000bd80: 2020 2073 656c 662e 696e 7374 7275 6d65     self.instrume
+0000bd90: 6e74 5f69 6e64 6578 6573 5f72 7620 3d20  nt_indexes_rv = 
+0000bda0: 4e6f 6e65 0a20 2020 2020 2020 2073 656c  None.        sel
+0000bdb0: 662e 6c6d 5f72 765f 626f 6f6c 6561 6e20  f.lm_rv_boolean 
+0000bdc0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
+0000bdd0: 656c 662e 6c6d 5f72 765f 6172 6775 6d65  elf.lm_rv_argume
+0000bde0: 6e74 7320 3d20 4e6f 6e65 0a20 2020 2020  nts = None.     
+0000bdf0: 2020 2073 656c 662e 4750 5f72 765f 6172     self.GP_rv_ar
+0000be00: 6775 6d65 6e74 7320 3d20 4e6f 6e65 0a20  guments = None. 
+0000be10: 2020 2020 2020 2073 656c 662e 4c4d 5f72         self.LM_r
+0000be20: 765f 6172 6775 6d65 6e74 7320 3d20 4e6f  v_arguments = No
+0000be30: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
+0000be40: 7276 7469 6d65 6465 6620 3d20 7276 7469  rvtimedef = rvti
+0000be50: 6d65 6465 660a 2020 2020 2020 2020 7365  medef.        se
+0000be60: 6c66 2e72 765f 6461 7461 203d 2046 616c  lf.rv_data = Fal
+0000be70: 7365 0a20 2020 2020 2020 2073 656c 662e  se.        self.
+0000be80: 676c 6f62 616c 5f72 765f 6d6f 6465 6c20  global_rv_model 
+0000be90: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+0000bea0: 7365 6c66 2e72 765f 6f70 7469 6f6e 7320  self.rv_options 
+0000beb0: 3d20 7b7d 0a0a 2020 2020 2020 2020 7365  = {}..        se
+0000bec0: 6c66 2e6f 7574 5f66 6f6c 6465 7220 3d20  lf.out_folder = 
+0000bed0: 4e6f 6e65 0a0a 2020 2020 2020 2020 6966  None..        if
+0000bee0: 2069 6e70 7574 5f66 6f6c 6465 7220 6973   input_folder is
+0000bef0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0000bf00: 2020 2020 2020 2069 6620 696e 7075 745f         if input_
+0000bf10: 666f 6c64 6572 5b2d 315d 2021 3d20 272f  folder[-1] != '/
+0000bf20: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
+0000bf30: 2020 2073 656c 662e 696e 7075 745f 666f     self.input_fo
+0000bf40: 6c64 6572 203d 2069 6e70 7574 5f66 6f6c  lder = input_fol
+0000bf50: 6465 7220 2b20 272f 270a 2020 2020 2020  der + '/'.      
+0000bf60: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000bf70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000bf80: 2e69 6e70 7574 5f66 6f6c 6465 7220 3d20  .input_folder = 
+0000bf90: 696e 7075 745f 666f 6c64 6572 0a20 2020  input_folder.   
+0000bfa0: 2020 2020 2020 2020 2069 6620 6f73 2e70           if os.p
+0000bfb0: 6174 682e 6578 6973 7473 2873 656c 662e  ath.exists(self.
+0000bfc0: 696e 7075 745f 666f 6c64 6572 202b 2027  input_folder + '
+0000bfd0: 6c63 2e64 6174 2729 3a0a 2020 2020 2020  lc.dat'):.      
+0000bfe0: 2020 2020 2020 2020 2020 6c63 6669 6c65            lcfile
+0000bff0: 6e61 6d65 203d 2073 656c 662e 696e 7075  name = self.inpu
+0000c000: 745f 666f 6c64 6572 202b 2027 6c63 2e64  t_folder + 'lc.d
+0000c010: 6174 270a 2020 2020 2020 2020 2020 2020  at'.            
+0000c020: 6966 206f 732e 7061 7468 2e65 7869 7374  if os.path.exist
+0000c030: 7328 7365 6c66 2e69 6e70 7574 5f66 6f6c  s(self.input_fol
+0000c040: 6465 7220 2b20 2772 7673 2e64 6174 2729  der + 'rvs.dat')
+0000c050: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000c060: 2020 7276 6669 6c65 6e61 6d65 203d 2073    rvfilename = s
+0000c070: 656c 662e 696e 7075 745f 666f 6c64 6572  elf.input_folder
+0000c080: 202b 2027 7276 732e 6461 7427 0a20 2020   + 'rvs.dat'.   
+0000c090: 2020 2020 2020 2020 2069 6620 286e 6f74           if (not
+0000c0a0: 206f 732e 7061 7468 2e65 7869 7374 7328   os.path.exists(
+0000c0b0: 7365 6c66 2e69 6e70 7574 5f66 6f6c 6465  self.input_folde
+0000c0c0: 7220 2b20 276c 632e 6461 7427 2929 2061  r + 'lc.dat')) a
+0000c0d0: 6e64 2028 0a20 2020 2020 2020 2020 2020  nd (.           
+0000c0e0: 2020 2020 2020 2020 206e 6f74 206f 732e           not os.
+0000c0f0: 7061 7468 2e65 7869 7374 7328 7365 6c66  path.exists(self
+0000c100: 2e69 6e70 7574 5f66 6f6c 6465 7220 2b20  .input_folder + 
+0000c110: 2772 7673 2e64 6174 2729 293a 0a20 2020  'rvs.dat')):.   
+0000c120: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0000c130: 7365 2045 7863 6570 7469 6f6e 2827 494e  se Exception('IN
+0000c140: 5055 5420 4552 524f 523a 204e 6f20 6c69  PUT ERROR: No li
+0000c150: 6768 7463 7572 7665 2064 6174 6120 6669  ghtcurve data fi
+0000c160: 6c65 2028 6c63 2e64 6174 2920 6f72 2072  le (lc.dat) or r
+0000c170: 6164 6961 6c2d 7665 6c6f 6369 7479 2064  adial-velocity d
+0000c180: 6174 6120 6669 6c65 2028 7276 732e 6461  ata file (rvs.da
+0000c190: 7429 2066 6f75 6e64 2069 6e20 666f 6c64  t) found in fold
+0000c1a0: 6572 2027 2b73 656c 662e 696e 7075 745f  er '+self.input_
+0000c1b0: 666f 6c64 6572 2b5c 0a20 2020 2020 2020  folder+\.       
+0000c1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c1d0: 2020 2020 2020 2020 2027 2e20 5c6e 2043           '. \n C
+0000c1e0: 7265 6174 6520 7468 656d 2061 6e64 2074  reate them and t
+0000c1f0: 7279 2061 6761 696e 2e20 466f 7220 6465  ry again. For de
+0000c200: 7461 696c 732c 2063 6865 636b 206a 756c  tails, check jul
+0000c210: 6965 742e 6c6f 6164 3f27 290a 2020 2020  iet.load?').    
+0000c220: 2020 2020 2020 2020 6966 206f 732e 7061          if os.pa
+0000c230: 7468 2e65 7869 7374 7328 7365 6c66 2e69  th.exists(self.i
+0000c240: 6e70 7574 5f66 6f6c 6465 7220 2b20 2747  nput_folder + 'G
+0000c250: 505f 6c63 5f72 6567 7265 7373 6f72 732e  P_lc_regressors.
+0000c260: 6461 7427 293a 0a20 2020 2020 2020 2020  dat'):.         
+0000c270: 2020 2020 2020 2047 506c 6365 7061 7261         GPlcepara
+0000c280: 6d66 696c 6520 3d20 7365 6c66 2e69 6e70  mfile = self.inp
+0000c290: 7574 5f66 6f6c 6465 7220 2b20 2747 505f  ut_folder + 'GP_
+0000c2a0: 6c63 5f72 6567 7265 7373 6f72 732e 6461  lc_regressors.da
+0000c2b0: 7427 0a20 2020 2020 2020 2020 2020 2069  t'.            i
+0000c2c0: 6620 6f73 2e70 6174 682e 6578 6973 7473  f os.path.exists
+0000c2d0: 2873 656c 662e 696e 7075 745f 666f 6c64  (self.input_fold
+0000c2e0: 6572 202b 2027 4750 5f72 765f 7265 6772  er + 'GP_rv_regr
+0000c2f0: 6573 736f 7273 2e64 6174 2729 3a0a 2020  essors.dat'):.  
+0000c300: 2020 2020 2020 2020 2020 2020 2020 4750                GP
+0000c310: 7276 6570 6172 616d 6669 6c65 203d 2073  rveparamfile = s
+0000c320: 656c 662e 696e 7075 745f 666f 6c64 6572  elf.input_folder
+0000c330: 202b 2027 4750 5f72 765f 7265 6772 6573   + 'GP_rv_regres
+0000c340: 736f 7273 2e64 6174 270a 2020 2020 2020  sors.dat'.      
+0000c350: 2020 2020 2020 6966 206f 732e 7061 7468        if os.path
+0000c360: 2e65 7869 7374 7328 7365 6c66 2e69 6e70  .exists(self.inp
+0000c370: 7574 5f66 6f6c 6465 7220 2b20 274c 4d5f  ut_folder + 'LM_
+0000c380: 6c63 5f72 6567 7265 7373 6f72 732e 6461  lc_regressors.da
+0000c390: 7427 293a 0a20 2020 2020 2020 2020 2020  t'):.           
+0000c3a0: 2020 2020 204c 4d6c 6365 7061 7261 6d66       LMlceparamf
+0000c3b0: 696c 6520 3d20 7365 6c66 2e69 6e70 7574  ile = self.input
+0000c3c0: 5f66 6f6c 6465 7220 2b20 274c 4d5f 6c63  _folder + 'LM_lc
+0000c3d0: 5f72 6567 7265 7373 6f72 732e 6461 7427  _regressors.dat'
+0000c3e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000c3f0: 6f73 2e70 6174 682e 6578 6973 7473 2873  os.path.exists(s
+0000c400: 656c 662e 696e 7075 745f 666f 6c64 6572  elf.input_folder
+0000c410: 202b 2027 4c4d 5f72 765f 7265 6772 6573   + 'LM_rv_regres
+0000c420: 736f 7273 2e64 6174 2729 3a0a 2020 2020  sors.dat'):.    
+0000c430: 2020 2020 2020 2020 2020 2020 4c4d 7276              LMrv
+0000c440: 6570 6172 616d 6669 6c65 203d 2073 656c  eparamfile = sel
+0000c450: 662e 696e 7075 745f 666f 6c64 6572 202b  f.input_folder +
+0000c460: 2027 4c4d 5f72 765f 7265 6772 6573 736f   'LM_rv_regresso
+0000c470: 7273 2e64 6174 270a 2020 2020 2020 2020  rs.dat'.        
+0000c480: 2020 2020 6966 206f 732e 7061 7468 2e65      if os.path.e
+0000c490: 7869 7374 7328 7365 6c66 2e69 6e70 7574  xists(self.input
+0000c4a0: 5f66 6f6c 6465 7220 2b20 2770 7269 6f72  _folder + 'prior
+0000c4b0: 732e 6461 7427 293a 0a20 2020 2020 2020  s.dat'):.       
+0000c4c0: 2020 2020 2020 2020 2070 7269 6f72 7320           priors 
+0000c4d0: 3d20 7365 6c66 2e69 6e70 7574 5f66 6f6c  = self.input_fol
+0000c4e0: 6465 7220 2b20 2770 7269 6f72 732e 6461  der + 'priors.da
+0000c4f0: 7427 0a20 2020 2020 2020 2020 2020 2065  t'.            e
+0000c500: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000c510: 2020 2020 2072 6169 7365 2045 7863 6570       raise Excep
+0000c520: 7469 6f6e 2827 494e 5055 5420 4552 524f  tion('INPUT ERRO
+0000c530: 523a 2050 7269 6f72 2066 696c 6520 2870  R: Prior file (p
+0000c540: 7269 6f72 732e 6461 7429 206e 6f74 2066  riors.dat) not f
+0000c550: 6f75 6e64 2069 6e20 666f 6c64 6572 2027  ound in folder '
+0000c560: 2b73 656c 662e 696e 7075 745f 666f 6c64  +self.input_fold
+0000c570: 6572 2b27 2e27 2b5c 0a20 2020 2020 2020  er+'.'+\.       
+0000c580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c590: 2020 2020 2020 2020 2027 4372 6561 7465           'Create
+0000c5a0: 2069 7420 616e 6420 7472 7920 6167 6169   it and try agai
+0000c5b0: 6e2e 2046 6f72 2064 6574 6169 6c73 2c20  n. For details, 
+0000c5c0: 6368 6563 6b20 6a75 6c69 6574 2e6c 6f61  check juliet.loa
+0000c5d0: 643f 2729 0a20 2020 2020 2020 2020 2020  d?').           
+0000c5e0: 2023 2049 6620 7468 6572 6520 6973 2061   # If there is a
+0000c5f0: 6e20 696e 7075 7420 666f 6c64 6572 2061  n input folder a
+0000c600: 6e64 206e 6f20 6f75 745f 666f 6c64 6572  nd no out_folder
+0000c610: 2c20 7468 656e 2073 696d 706c 7920 7365  , then simply se
+0000c620: 7420 7468 6520 6f75 745f 666f 6c64 6572  t the out_folder
+0000c630: 2061 7320 7468 6520 696e 7075 745f 666f   as the input_fo
+0000c640: 6c64 6572 0a20 2020 2020 2020 2020 2020  lder.           
+0000c650: 2023 2066 6f72 2065 6173 6520 696e 2074   # for ease in t
+0000c660: 6865 206c 6174 6572 2066 756e 6374 696f  he later functio
+0000c670: 6e73 2028 6d6f 7265 2066 6f72 2072 6570  ns (more for rep
+0000c680: 6c6f 7474 696e 6720 7075 7270 6f73 6573  lotting purposes
+0000c690: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+0000c6a0: 536f 2c20 6f6e 6520 6361 6e20 7369 6d70  So, one can simp
+0000c6b0: 6c79 2064 6f20 7468 6973 2074 6f20 6f62  ly do this to ob
+0000c6c0: 7461 696e 2074 6865 2070 6f73 7465 7269  tain the posteri
+0000c6d0: 6f72 733a 0a20 2020 2020 2020 2020 2020  ors:.           
+0000c6e0: 2023 203e 2064 6174 6173 6574 203d 206a   # > dataset = j
+0000c6f0: 756c 6965 742e 6c6f 6164 2869 6e70 7574  uliet.load(input
+0000c700: 5f66 6f6c 6465 723d 666f 6c64 6572 2920  _folder=folder) 
+0000c710: 2320 746f 2072 656c 6f61 6420 7468 6520  # to reload the 
+0000c720: 7072 696f 7273 2c20 6461 7461 2c20 6574  priors, data, et
+0000c730: 632e 0a20 2020 2020 2020 2020 2020 2023  c..            #
+0000c740: 203e 2072 6573 756c 7473 203d 2064 6174   > results = dat
+0000c750: 6173 6574 2e66 6974 2829 2023 2074 6f20  aset.fit() # to 
+0000c760: 6f62 7461 696e 2074 6865 2072 6573 756c  obtain the resul
+0000c770: 7473 2061 6c72 6561 6479 2066 6f75 6e64  ts already found
+0000c780: 2069 6e20 7468 6520 696e 7075 745f 666f   in the input_fo
+0000c790: 6c64 6572 0a20 2020 2020 2020 2020 2020  lder.           
+0000c7a0: 2023 203e 2070 6f73 7465 7269 6f72 7320   # > posteriors 
+0000c7b0: 3d20 7265 7375 6c74 732e 706f 7374 6572  = results.poster
+0000c7c0: 696f 7273 0a20 2020 2020 2020 2020 2020  iors.           
+0000c7d0: 2069 6620 6f75 745f 666f 6c64 6572 2069   if out_folder i
+0000c7e0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0000c7f0: 2020 2020 2020 2020 7365 6c66 2e6f 7574          self.out
+0000c800: 5f66 6f6c 6465 7220 3d20 7365 6c66 2e69  _folder = self.i
+0000c810: 6e70 7574 5f66 6f6c 6465 720a 2020 2020  nput_folder.    
+0000c820: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000c830: 2020 2020 2020 7365 6c66 2e69 6e70 7574        self.input
+0000c840: 5f66 6f6c 6465 7220 3d20 4e6f 6e65 0a0a  _folder = None..
+0000c850: 2020 2020 2020 2020 6966 2074 7970 6528          if type(
+0000c860: 7072 696f 7273 2920 3d3d 2073 7472 3a0a  priors) == str:.
+0000c870: 0a20 2020 2020 2020 2020 2020 7365 6c66  .           self
+0000c880: 2e70 7269 6f72 5f66 6e61 6d65 203d 2070  .prior_fname = p
+0000c890: 7269 6f72 730a 2020 2020 2020 2020 2020  riors.          
+0000c8a0: 2070 7269 6f72 732c 206e 5f74 7261 6e73   priors, n_trans
+0000c8b0: 6974 2c20 6e5f 7276 2c20 6e75 6d62 6572  it, n_rv, number
+0000c8c0: 696e 675f 7472 616e 7369 742c 206e 756d  ing_transit, num
+0000c8d0: 6265 7269 6e67 5f72 762c 206e 5f70 6172  bering_rv, n_par
+0000c8e0: 616d 732c 2073 7461 7274 696e 675f 706f  ams, starting_po
+0000c8f0: 696e 7420 3d20 7265 6164 7072 696f 7273  int = readpriors
+0000c900: 2870 7269 6f72 7329 0a20 2020 2020 2020  (priors).       
+0000c910: 2020 2020 2320 5361 7665 2069 6e66 6f72      # Save infor
+0000c920: 6d61 7469 6f6e 2073 746f 7265 6420 696e  mation stored in
+0000c930: 2074 6865 2070 7269 6f72 3a20 7468 6520   the prior: the 
+0000c940: 6469 6374 696f 6e61 7279 2c20 6e75 6d62  dictionary, numb
+0000c950: 6572 206f 6620 7472 616e 7369 7469 6e67  er of transiting
+0000c960: 2070 6c61 6e65 7473 2c0a 2020 2020 2020   planets,.      
+0000c970: 2020 2020 2023 206e 756d 6265 7220 6f66       # number of
+0000c980: 2052 5620 706c 616e 6574 732c 206e 756d   RV planets, num
+0000c990: 6265 7269 6e67 206f 6620 7472 616e 7369  bering of transi
+0000c9a0: 7469 6e67 2061 6e64 2072 7620 706c 616e  ting and rv plan
+0000c9b0: 6574 7320 2865 2e67 2e2c 2069 6620 7031  ets (e.g., if p1
+0000c9c0: 2061 6e64 2070 3320 7472 616e 7369 740a   and p3 transit.
+0000c9d0: 2020 2020 2020 2020 2020 2023 2061 6e64             # and
+0000c9e0: 2061 6c6c 206f 6620 7468 656d 2061 7265   all of them are
+0000c9f0: 2052 5620 706c 616e 6574 732c 206e 756d   RV planets, num
+0000ca00: 6265 7269 6e67 5f74 7261 6e73 6974 203d  bering_transit =
+0000ca10: 205b 312c 335d 2061 6e64 206e 756d 6265   [1,3] and numbe
+0000ca20: 7269 6e67 5f72 7620 3d20 5b31 2c32 2c33  ring_rv = [1,2,3
+0000ca30: 5d29 2e0a 2020 2020 2020 2020 2020 2023  ])..           #
+0000ca40: 2053 6176 6520 616c 736f 206e 756d 6265   Save also numbe
+0000ca50: 7220 6f66 202a 6672 6565 2a20 7061 7261  r of *free* para
+0000ca60: 6d65 7465 7273 2028 4649 5845 4420 646f  meters (FIXED do
+0000ca70: 6e27 7420 636f 756e 7420 6865 7265 292e  n't count here).
+0000ca80: 0a20 2020 2020 2020 2020 2020 7365 6c66  .           self
+0000ca90: 2e70 7269 6f72 7320 3d20 7072 696f 7273  .priors = priors
+0000caa0: 0a20 2020 2020 2020 2020 2020 7365 6c66  .           self
+0000cab0: 2e6e 5f74 7261 6e73 6974 696e 675f 706c  .n_transiting_pl
+0000cac0: 616e 6574 7320 3d20 6e5f 7472 616e 7369  anets = n_transi
+0000cad0: 740a 2020 2020 2020 2020 2020 2073 656c  t.           sel
+0000cae0: 662e 6e5f 7276 5f70 6c61 6e65 7473 203d  f.n_rv_planets =
+0000caf0: 206e 5f72 760a 2020 2020 2020 2020 2020   n_rv.          
+0000cb00: 2073 656c 662e 6e75 6d62 6572 696e 675f   self.numbering_
+0000cb10: 7472 616e 7369 7469 6e67 5f70 6c61 6e65  transiting_plane
+0000cb20: 7473 203d 206e 756d 6265 7269 6e67 5f74  ts = numbering_t
+0000cb30: 7261 6e73 6974 0a20 2020 2020 2020 2020  ransit.         
+0000cb40: 2020 7365 6c66 2e6e 756d 6265 7269 6e67    self.numbering
+0000cb50: 5f72 765f 706c 616e 6574 7320 3d20 6e75  _rv_planets = nu
+0000cb60: 6d62 6572 696e 675f 7276 0a20 2020 2020  mbering_rv.     
+0000cb70: 2020 2020 2020 7365 6c66 2e6e 7061 7261        self.npara
+0000cb80: 6d73 203d 206e 5f70 6172 616d 730a 2020  ms = n_params.  
+0000cb90: 2020 2020 2020 2020 2073 656c 662e 7374           self.st
+0000cba0: 6172 7469 6e67 5f70 6f69 6e74 203d 2073  arting_point = s
+0000cbb0: 7461 7274 696e 675f 706f 696e 740a 2020  tarting_point.  
+0000cbc0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+0000cbd0: 2020 2065 6c69 6620 7479 7065 2870 7269     elif type(pri
+0000cbe0: 6f72 7329 203d 3d20 6469 6374 3a0a 2020  ors) == dict:.  
+0000cbf0: 2020 2020 2020 2020 2020 2320 4469 6374            # Dict
+0000cc00: 696f 6e61 7279 2077 6173 2070 6173 7365  ionary was passe
+0000cc10: 642c 2073 6f20 7361 7665 2069 742e 0a20  d, so save it.. 
+0000cc20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000cc30: 7072 696f 7273 203d 2070 7269 6f72 730a  priors = priors.
+0000cc40: 2020 2020 2020 2020 2020 2020 2320 4578              # Ex
+0000cc50: 7472 6163 7420 7361 6d65 2069 6e66 6f20  tract same info 
+0000cc60: 6173 2061 626f 7665 2069 662d 7374 6174  as above if-stat
+0000cc70: 656d 656e 7420 6275 7420 7573 696e 6720  ement but using 
+0000cc80: 6f6e 6c79 2074 6865 2064 6963 7469 6f6e  only the diction
+0000cc90: 6172 793a 0a20 2020 2020 2020 2020 2020  ary:.           
+0000cca0: 206e 5f74 7261 6e73 6974 2c20 6e5f 7276   n_transit, n_rv
+0000ccb0: 2c20 6e75 6d62 6572 696e 675f 7472 616e  , numbering_tran
+0000ccc0: 7369 742c 206e 756d 6265 7269 6e67 5f72  sit, numbering_r
+0000ccd0: 762c 206e 5f70 6172 616d 7320 3d20 7265  v, n_params = re
+0000cce0: 6164 7072 696f 7273 280a 2020 2020 2020  adpriors(.      
+0000ccf0: 2020 2020 2020 2020 2020 7072 696f 7273            priors
+0000cd00: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+0000cd10: 5361 7665 2069 6e66 6f72 6d61 7469 6f6e  Save information
+0000cd20: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0000cd30: 6c66 2e6e 5f74 7261 6e73 6974 696e 675f  lf.n_transiting_
+0000cd40: 706c 616e 6574 7320 3d20 6e5f 7472 616e  planets = n_tran
+0000cd50: 7369 740a 2020 2020 2020 2020 2020 2020  sit.            
+0000cd60: 7365 6c66 2e6e 5f72 765f 706c 616e 6574  self.n_rv_planet
+0000cd70: 7320 3d20 6e5f 7276 0a20 2020 2020 2020  s = n_rv.       
+0000cd80: 2020 2020 2073 656c 662e 6e75 6d62 6572       self.number
+0000cd90: 696e 675f 7472 616e 7369 7469 6e67 5f70  ing_transiting_p
+0000cda0: 6c61 6e65 7473 203d 206e 756d 6265 7269  lanets = numberi
+0000cdb0: 6e67 5f74 7261 6e73 6974 0a20 2020 2020  ng_transit.     
+0000cdc0: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
+0000cdd0: 6572 696e 675f 7276 5f70 6c61 6e65 7473  ering_rv_planets
+0000cde0: 203d 206e 756d 6265 7269 6e67 5f72 760a   = numbering_rv.
+0000cdf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000ce00: 2e6e 7061 7261 6d73 203d 206e 5f70 6172  .nparams = n_par
+0000ce10: 616d 730a 2020 2020 2020 2020 2020 2020  ams.            
+0000ce20: 7365 6c66 2e70 7269 6f72 5f66 6e61 6d65  self.prior_fname
+0000ce30: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+0000ce40: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000ce50: 2020 7261 6973 6520 4578 6365 7074 696f    raise Exceptio
+0000ce60: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+0000ce70: 2020 2027 494e 5055 5420 4552 524f 523a     'INPUT ERROR:
+0000ce80: 2050 7269 6f72 2066 696c 6520 6973 206e   Prior file is n
+0000ce90: 6f74 2061 2073 7472 696e 6720 6f72 2061  ot a string or a
+0000cea0: 2064 6963 7469 6f6e 6172 7920 2861 6e64   dictionary (and
+0000ceb0: 2069 7420 6861 7320 746f 292e 2044 6f20   it has to). Do 
+0000cec0: 6a75 6c69 6574 2e6c 6f61 643f 2066 6f72  juliet.load? for
+0000ced0: 2064 6574 6169 6c73 2e27 0a20 2020 2020   details.'.     
+0000cee0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000cef0: 2020 2320 4465 6669 6e65 2063 6173 6573    # Define cases
+0000cf00: 2069 6e20 7768 6963 6820 6461 7461 2069   in which data i
+0000cf10: 7320 6769 7665 6e20 7468 726f 7567 6820  s given through 
+0000cf20: 6669 6c65 733a 0a20 2020 2020 2020 2069  files:.        i
+0000cf30: 6620 2874 5f6c 6320 6973 204e 6f6e 6529  f (t_lc is None)
+0000cf40: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0000cf50: 206c 6366 696c 656e 616d 6520 6973 206e   lcfilename is n
+0000cf60: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0000cf70: 2020 2020 2020 2020 2074 5f6c 632c 795f           t_lc,y_
+0000cf80: 6c63 2c79 6572 725f 6c63 2c69 6e73 7472  lc,yerr_lc,instr
+0000cf90: 756d 656e 7473 5f6c 632c 696e 7374 7275  uments_lc,instru
+0000cfa0: 6d65 6e74 5f69 6e64 6578 6573 5f6c 632c  ment_indexes_lc,
+0000cfb0: 6e69 6e73 7472 756d 656e 7473 5f6c 632c  ninstruments_lc,
+0000cfc0: 696e 616d 6573 5f6c 632c 6c6d 5f6c 635f  inames_lc,lm_lc_
+0000cfd0: 626f 6f6c 6561 6e2c 6c6d 5f6c 635f 6172  boolean,lm_lc_ar
+0000cfe0: 6775 6d65 6e74 7320 3d20 5c0a 2020 2020  guments = \.    
+0000cff0: 2020 2020 2020 2020 2020 2020 7265 6164              read
+0000d000: 5f64 6174 6128 6c63 6669 6c65 6e61 6d65  _data(lcfilename
+0000d010: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000d020: 2020 2023 2053 6176 6520 6461 7461 2074     # Save data t
+0000d030: 6f20 6f62 6a65 6374 3a0a 0a20 2020 2020  o object:..     
+0000d040: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000d050: 7365 745f 6c63 5f64 6174 6128 745f 6c63  set_lc_data(t_lc
+0000d060: 2c20 795f 6c63 2c20 7965 7272 5f6c 632c  , y_lc, yerr_lc,
+0000d070: 2069 6e73 7472 756d 656e 7473 5f6c 632c   instruments_lc,
+0000d080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d0a0: 2020 696e 7374 7275 6d65 6e74 5f69 6e64    instrument_ind
+0000d0b0: 6578 6573 5f6c 632c 206e 696e 7374 7275  exes_lc, ninstru
+0000d0c0: 6d65 6e74 735f 6c63 2c0a 2020 2020 2020  ments_lc,.      
+0000d0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d0e0: 2020 2020 2020 2020 2020 2069 6e61 6d65             iname
+0000d0f0: 735f 6c63 2c20 6c6d 5f6c 635f 626f 6f6c  s_lc, lm_lc_bool
+0000d100: 6561 6e2c 206c 6d5f 6c63 5f61 7267 756d  ean, lm_lc_argum
+0000d110: 656e 7473 290a 0a20 2020 2020 2020 2069  ents)..        i
+0000d120: 6620 2874 5f72 7620 6973 204e 6f6e 6529  f (t_rv is None)
+0000d130: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0000d140: 2072 7666 696c 656e 616d 6520 6973 206e   rvfilename is n
+0000d150: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0000d160: 2020 2020 2020 2020 2074 5f72 762c 795f           t_rv,y_
+0000d170: 7276 2c79 6572 725f 7276 2c69 6e73 7472  rv,yerr_rv,instr
+0000d180: 756d 656e 7473 5f72 762c 696e 7374 7275  uments_rv,instru
+0000d190: 6d65 6e74 5f69 6e64 6578 6573 5f72 762c  ment_indexes_rv,
+0000d1a0: 6e69 6e73 7472 756d 656e 7473 5f72 762c  ninstruments_rv,
+0000d1b0: 696e 616d 6573 5f72 762c 6c6d 5f72 765f  inames_rv,lm_rv_
+0000d1c0: 626f 6f6c 6561 6e2c 6c6d 5f72 765f 6172  boolean,lm_rv_ar
+0000d1d0: 6775 6d65 6e74 7320 3d20 5c0a 2020 2020  guments = \.    
+0000d1e0: 2020 2020 2020 2020 2020 2020 7265 6164              read
+0000d1f0: 5f64 6174 6128 7276 6669 6c65 6e61 6d65  _data(rvfilename
+0000d200: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000d210: 2020 2023 2053 6176 6520 6461 7461 2074     # Save data t
+0000d220: 6f20 6f62 6a65 6374 3a0a 2020 2020 2020  o object:.      
+0000d230: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+0000d240: 6574 5f72 765f 6461 7461 2874 5f72 762c  et_rv_data(t_rv,
+0000d250: 2079 5f72 762c 2079 6572 725f 7276 2c20   y_rv, yerr_rv, 
+0000d260: 696e 7374 7275 6d65 6e74 735f 7276 2c0a  instruments_rv,.
+0000d270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d290: 2069 6e73 7472 756d 656e 745f 696e 6465   instrument_inde
+0000d2a0: 7865 735f 7276 2c20 6e69 6e73 7472 756d  xes_rv, ninstrum
+0000d2b0: 656e 7473 5f72 762c 0a20 2020 2020 2020  ents_rv,.       
+0000d2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d2d0: 2020 2020 2020 2020 2020 696e 616d 6573            inames
+0000d2e0: 5f72 762c 206c 6d5f 7276 5f62 6f6f 6c65  _rv, lm_rv_boole
+0000d2f0: 616e 2c20 6c6d 5f72 765f 6172 6775 6d65  an, lm_rv_argume
+0000d300: 6e74 7329 0a0a 2020 2020 2020 2020 6966  nts)..        if
+0000d310: 2028 745f 6c63 2069 7320 4e6f 6e65 2061   (t_lc is None a
+0000d320: 6e64 2074 5f72 7620 6973 204e 6f6e 6529  nd t_rv is None)
+0000d330: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0000d340: 2028 6c63 6669 6c65 6e61 6d65 2069 7320   (lcfilename is 
+0000d350: 4e6f 6e65 2920 616e 6420 2872 7666 696c  None) and (rvfil
+0000d360: 656e 616d 6520 6973 204e 6f6e 6529 3a0a  ename is None):.
+0000d370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d380: 7261 6973 6520 4578 6365 7074 696f 6e28  raise Exception(
+0000d390: 2749 4e50 5554 2045 5252 4f52 3a20 4e6f  'INPUT ERROR: No
+0000d3a0: 2063 6f6d 706c 6574 6520 6461 7461 7365   complete datase
+0000d3b0: 7420 2870 686f 746f 6d65 7472 6963 206f  t (photometric o
+0000d3c0: 7220 7261 6469 616c 2d76 656c 6f63 6974  r radial-velocit
+0000d3d0: 7929 2067 6976 656e 2e5c 6e27 2b5c 0a20  y) given.\n'+\. 
+0000d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d3f0: 2020 2020 2027 204d 616b 6520 7375 7265       ' Make sure
+0000d400: 2074 6f20 6665 6564 2074 696d 6573 2028   to feed times (
+0000d410: 745f 6c63 2061 6e64 2f6f 7220 745f 7276  t_lc and/or t_rv
+0000d420: 292c 2076 616c 7565 7320 2879 5f6c 6320  ), values (y_lc 
+0000d430: 616e 642f 6f72 2079 5f72 7629 2c20 5c6e  and/or y_rv), \n
+0000d440: 272b 5c0a 2020 2020 2020 2020 2020 2020  '+\.            
+0000d450: 2020 2020 2020 2020 2020 2720 6572 726f            ' erro
+0000d460: 7273 2028 7965 7272 5f6c 6320 616e 642f  rs (yerr_lc and/
+0000d470: 6f72 2079 6572 725f 7276 292e 2729 0a0a  or yerr_rv).')..
+0000d480: 2020 2020 2020 2020 2320 5265 6164 2047          # Read G
+0000d490: 5020 7265 6772 6573 736f 7273 2069 6620  P regressors if 
+0000d4a0: 6769 7665 6e20 7468 726f 7567 6820 6669  given through fi
+0000d4b0: 6c65 7320 6f72 2061 7272 6179 732e 2054  les or arrays. T
+0000d4c0: 6865 2066 6f72 6d65 7220 7461 6b65 7320  he former takes 
+0000d4d0: 7072 696f 7269 7479 2e20 4669 7273 7420  priority. First 
+0000d4e0: 6c69 6768 7463 7572 7665 3a0a 2020 2020  lightcurve:.    
+0000d4f0: 2020 2020 6966 2047 506c 6365 7061 7261      if GPlcepara
+0000d500: 6d66 696c 6520 6973 206e 6f74 204e 6f6e  mfile is not Non
+0000d510: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+0000d520: 656c 662e 4750 5f6c 635f 6172 6775 6d65  elf.GP_lc_argume
+0000d530: 6e74 732c 2073 656c 662e 676c 6f62 616c  nts, self.global
+0000d540: 5f6c 635f 6d6f 6465 6c20 3d20 7265 6164  _lc_model = read
+0000d550: 4750 6570 6172 616d 7328 0a20 2020 2020  GPeparams(.     
+0000d560: 2020 2020 2020 2020 2020 2047 506c 6365             GPlce
+0000d570: 7061 7261 6d66 696c 6529 0a20 2020 2020  paramfile).     
+0000d580: 2020 2065 6c69 6620 4750 5f72 6567 7265     elif GP_regre
+0000d590: 7373 6f72 735f 6c63 2069 7320 6e6f 7420  ssors_lc is not 
+0000d5a0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000d5b0: 2020 7365 6c66 2e47 505f 6c63 5f61 7267    self.GP_lc_arg
+0000d5c0: 756d 656e 7473 203d 2047 505f 7265 6772  uments = GP_regr
+0000d5d0: 6573 736f 7273 5f6c 630a 2020 2020 2020  essors_lc.      
+0000d5e0: 2020 2020 2020 696e 7374 7275 6d65 6e74        instrument
+0000d5f0: 7320 3d20 7365 7428 6c69 7374 2873 656c  s = set(list(sel
+0000d600: 662e 4750 5f6c 635f 6172 6775 6d65 6e74  f.GP_lc_argument
+0000d610: 732e 6b65 7973 2829 2929 0a0a 2020 2020  s.keys()))..    
+0000d620: 2020 2020 2320 5361 6d65 2074 6869 6e67      # Same thing
+0000d630: 2066 6f72 2052 5673 3a0a 2020 2020 2020   for RVs:.      
+0000d640: 2020 6966 2047 5072 7665 7061 7261 6d66    if GPrveparamf
+0000d650: 696c 6520 6973 206e 6f74 204e 6f6e 653a  ile is not None:
+0000d660: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000d670: 662e 4750 5f72 765f 6172 6775 6d65 6e74  f.GP_rv_argument
+0000d680: 732c 2073 656c 662e 676c 6f62 616c 5f72  s, self.global_r
+0000d690: 765f 6d6f 6465 6c20 3d20 7265 6164 4750  v_model = readGP
+0000d6a0: 6570 6172 616d 7328 0a20 2020 2020 2020  eparams(.       
+0000d6b0: 2020 2020 2020 2020 2047 5072 7665 7061           GPrvepa
+0000d6c0: 7261 6d66 696c 6529 0a20 2020 2020 2020  ramfile).       
+0000d6d0: 2065 6c69 6620 4750 5f72 6567 7265 7373   elif GP_regress
+0000d6e0: 6f72 735f 7276 2069 7320 6e6f 7420 4e6f  ors_rv is not No
+0000d6f0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000d700: 7365 6c66 2e47 505f 7276 5f61 7267 756d  self.GP_rv_argum
+0000d710: 656e 7473 203d 2047 505f 7265 6772 6573  ents = GP_regres
+0000d720: 736f 7273 5f72 760a 2020 2020 2020 2020  sors_rv.        
+0000d730: 2020 2020 696e 7374 7275 6d65 6e74 7320      instruments 
+0000d740: 3d20 7365 7428 6c69 7374 2873 656c 662e  = set(list(self.
+0000d750: 4750 5f72 765f 6172 6775 6d65 6e74 732e  GP_rv_arguments.
+0000d760: 6b65 7973 2829 2929 0a0a 2020 2020 2020  keys()))..      
+0000d770: 2020 2320 5361 6d65 2074 6869 6e67 2066    # Same thing f
+0000d780: 6f72 206c 696e 6561 7220 7265 6772 6573  or linear regres
+0000d790: 736f 7273 2069 6e20 6361 7365 2074 6865  sors in case the
+0000d7a0: 7920 7765 7265 2067 6976 656e 2069 6e20  y were given in 
+0000d7b0: 6120 7365 7061 7261 7465 2066 696c 653a  a separate file:
+0000d7c0: 0a20 2020 2020 2020 2069 6620 4c4d 6c63  .        if LMlc
+0000d7d0: 6570 6172 616d 6669 6c65 2069 7320 6e6f  eparamfile is no
+0000d7e0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0000d7f0: 2020 2020 4c4d 5f6c 635f 6172 6775 6d65      LM_lc_argume
+0000d800: 6e74 732c 2064 756d 6d79 5f76 6172 203d  nts, dummy_var =
+0000d810: 2072 6561 6447 5065 7061 7261 6d73 284c   readGPeparams(L
+0000d820: 4d6c 6365 7061 7261 6d66 696c 6529 0a20  Mlceparamfile). 
+0000d830: 2020 2020 2020 2020 2020 2066 6f72 206c             for l
+0000d840: 6d69 2069 6e20 6c69 7374 284c 4d5f 6c63  mi in list(LM_lc
+0000d850: 5f61 7267 756d 656e 7473 2e6b 6579 7328  _arguments.keys(
+0000d860: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+0000d870: 2020 2020 6c6d 5f6c 635f 626f 6f6c 6561      lm_lc_boolea
+0000d880: 6e5b 6c6d 695d 203d 2054 7275 650a 2020  n[lmi] = True.  
+0000d890: 2020 2020 2020 2020 2020 2020 2020 6c6d                lm
+0000d8a0: 5f6c 635f 6172 6775 6d65 6e74 735b 6c6d  _lc_arguments[lm
+0000d8b0: 695d 203d 204c 4d5f 6c63 5f61 7267 756d  i] = LM_lc_argum
+0000d8c0: 656e 7473 5b6c 6d69 5d0a 0a20 2020 2020  ents[lmi]..     
+0000d8d0: 2020 2023 2053 616d 6520 7468 696e 6720     # Same thing 
+0000d8e0: 666f 7220 5256 733a 0a20 2020 2020 2020  for RVs:.       
+0000d8f0: 2069 6620 4c4d 7276 6570 6172 616d 6669   if LMrveparamfi
+0000d900: 6c65 2069 7320 6e6f 7420 4e6f 6e65 3a0a  le is not None:.
+0000d910: 2020 2020 2020 2020 2020 2020 4c4d 5f72              LM_r
+0000d920: 765f 6172 6775 6d65 6e74 732c 2064 756d  v_arguments, dum
+0000d930: 6d79 5f76 6172 203d 2072 6561 6447 5065  my_var = readGPe
+0000d940: 7061 7261 6d73 284c 4d72 7665 7061 7261  params(LMrvepara
+0000d950: 6d66 696c 6529 0a20 2020 2020 2020 2020  mfile).         
+0000d960: 2020 2066 6f72 206c 6d69 2069 6e20 6c69     for lmi in li
+0000d970: 7374 284c 4d5f 7276 5f61 7267 756d 656e  st(LM_rv_argumen
+0000d980: 7473 2e6b 6579 7328 2929 3a0a 2020 2020  ts.keys()):.    
+0000d990: 2020 2020 2020 2020 2020 2020 6c6d 5f72              lm_r
+0000d9a0: 765f 626f 6f6c 6561 6e5b 6c6d 695d 203d  v_boolean[lmi] =
+0000d9b0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+0000d9c0: 2020 2020 2020 6c6d 5f72 765f 6172 6775        lm_rv_argu
+0000d9d0: 6d65 6e74 735b 6c6d 695d 203d 204c 4d5f  ments[lmi] = LM_
+0000d9e0: 7276 5f61 7267 756d 656e 7473 5b6c 6d69  rv_arguments[lmi
+0000d9f0: 5d0a 0a20 2020 2020 2020 2023 2049 6620  ]..        # If 
+0000da00: 6461 7461 2067 6976 656e 2074 6872 6f75  data given throu
+0000da10: 6768 2064 6972 6563 7420 6172 7261 7973  gh direct arrays
+0000da20: 2028 692e 652e 2c20 6e6f 7420 6461 7461   (i.e., not data
+0000da30: 2066 696c 6573 292c 2067 656e 6572 6174   files), generat
+0000da40: 6520 736f 6d65 2075 7365 6675 6c20 696e  e some useful in
+0000da50: 7465 726e 616c 206c 6967 6874 6375 7276  ternal lightcurv
+0000da60: 6520 6172 7261 7973 3a20 696e 616d 6573  e arrays: inames
+0000da70: 5f6c 632c 2077 6869 6368 2068 6176 6520  _lc, which have 
+0000da80: 7468 6520 6469 6666 6572 656e 7420 6c69  the different li
+0000da90: 6768 7463 7572 7665 2069 6e73 7472 756d  ghtcurve instrum
+0000daa0: 656e 7420 6e61 6d65 732c 0a20 2020 2020  ent names,.     
+0000dab0: 2020 2023 2069 6e73 7472 756d 656e 745f     # instrument_
+0000dac0: 696e 6465 7865 735f 6c63 2028 6469 6374  indexes_lc (dict
+0000dad0: 696f 6e61 7279 2074 6861 7420 686f 6c64  ionary that hold
+0000dae0: 732c 2066 6f72 2065 6163 6820 696e 7374  s, for each inst
+0000daf0: 7275 6d65 6e74 2c20 7468 6520 696e 6465  rument, the inde
+0000db00: 7865 7320 7468 6174 2068 6176 6520 7468  xes that have th
+0000db10: 6520 7469 6d65 2f6c 6967 6874 6375 7276  e time/lightcurv
+0000db20: 6520 6461 7461 2066 6f72 2074 6861 7420  e data for that 
+0000db30: 7061 7274 6963 756c 6172 2069 6e73 7472  particular instr
+0000db40: 756d 656e 7429 2c20 6c6d 5f6c 635f 626f  ument), lm_lc_bo
+0000db50: 6f6c 6561 6e20 2864 6963 7469 6f6e 6172  olean (dictionar
+0000db60: 7920 6f66 0a20 2020 2020 2020 2023 2062  y of.        # b
+0000db70: 6f6f 6c65 616e 733b 2054 7275 6520 666f  ooleans; True fo
+0000db80: 7220 616e 2069 6e73 7472 756d 656e 7420  r an instrument 
+0000db90: 6966 2069 7420 6861 7320 6c69 6e65 6172  if it has linear
+0000dba0: 2072 6567 7265 7373 6f72 7329 2c20 6c6d   regressors), lm
+0000dbb0: 5f6c 635f 6172 6775 6d65 6e74 7320 2864  _lc_arguments (d
+0000dbc0: 6963 7469 6f6e 6172 7920 636f 6e74 6169  ictionary contai
+0000dbd0: 6e69 6e67 2074 6865 206c 696e 6561 7220  ning the linear 
+0000dbe0: 7265 6772 6573 736f 7273 2066 6f72 2065  regressors for e
+0000dbf0: 6163 6820 696e 7374 7275 6d65 6e74 292c  ach instrument),
+0000dc00: 2065 7463 2e3a 0a20 2020 2020 2020 2069   etc.:.        i
+0000dc10: 6620 286c 6366 696c 656e 616d 6520 6973  f (lcfilename is
+0000dc20: 204e 6f6e 6529 2061 6e64 2028 745f 6c63   None) and (t_lc
+0000dc30: 2069 7320 6e6f 7420 4e6f 6e65 293a 0a20   is not None):. 
+0000dc40: 2020 2020 2020 2020 2020 2023 2046 6972             # Fir
+0000dc50: 7374 2063 6865 636b 2075 7365 7220 6761  st check user ga
+0000dc60: 7665 2061 6c6c 2064 6174 613a 0a20 2020  ve all data:.   
+0000dc70: 2020 2020 2020 2020 2069 6e70 7574 5f65           input_e
+0000dc80: 7272 6f72 5f63 6174 6368 6572 2874 5f6c  rror_catcher(t_l
+0000dc90: 632c 2079 5f6c 632c 2079 6572 725f 6c63  c, y_lc, yerr_lc
+0000dca0: 2c20 276c 6967 6874 6375 7276 6527 290a  , 'lightcurve').
+0000dcb0: 2020 2020 2020 2020 2020 2020 2320 436f              # Co
+0000dcc0: 6e76 6572 7420 7469 6d65 7320 746f 2066  nvert times to f
+0000dcd0: 6c6f 6174 3634 2028 6261 746d 616e 2072  loat64 (batman r
+0000dce0: 6561 6c6c 7920 6861 7465 7320 6e6f 6e2d  eally hates non-
+0000dcf0: 666c 6f61 7436 3420 696e 7075 7473 293a  float64 inputs):
+0000dd00: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0000dd10: 2069 6e73 7472 756d 656e 7420 696e 2074   instrument in t
+0000dd20: 5f6c 632e 6b65 7973 2829 3a0a 2020 2020  _lc.keys():.    
+0000dd30: 2020 2020 2020 2020 2020 2020 745f 6c63              t_lc
+0000dd40: 5b69 6e73 7472 756d 656e 745d 203d 2074  [instrument] = t
+0000dd50: 5f6c 635b 696e 7374 7275 6d65 6e74 5d2e  _lc[instrument].
+0000dd60: 6173 7479 7065 2827 666c 6f61 7436 3427  astype('float64'
+0000dd70: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+0000dd80: 4372 6561 7465 2067 6c6f 6261 6c20 6172  Create global ar
+0000dd90: 7261 7973 3a0a 2020 2020 2020 2020 2020  rays:.          
+0000dda0: 2020 7467 6c6f 6261 6c5f 6c63 2c20 7967    tglobal_lc, yg
+0000ddb0: 6c6f 6261 6c5f 6c63 2c20 7967 6c6f 6261  lobal_lc, ygloba
+0000ddc0: 6c65 7272 5f6c 632c 2069 6e73 7472 756d  lerr_lc, instrum
+0000ddd0: 656e 7473 5f6c 6320 3d20 7365 6c66 2e63  ents_lc = self.c
+0000dde0: 6f6e 7665 7274 5f69 6e70 7574 5f64 6174  onvert_input_dat
+0000ddf0: 6128 0a20 2020 2020 2020 2020 2020 2020  a(.             
+0000de00: 2020 2074 5f6c 632c 2079 5f6c 632c 2079     t_lc, y_lc, y
+0000de10: 6572 725f 6c63 290a 2020 2020 2020 2020  err_lc).        
+0000de20: 2020 2020 2320 5361 7665 2064 6174 6120      # Save data 
+0000de30: 696e 2061 2066 6f72 6d61 7420 7573 6566  in a format usef
+0000de40: 756c 2066 6f72 2067 6c6f 6261 6c20 6d6f  ul for global mo
+0000de50: 6465 6c6c 696e 673a 0a20 2020 2020 2020  delling:.       
+0000de60: 2020 2020 2069 6e61 6d65 735f 6c63 2c20       inames_lc, 
+0000de70: 696e 7374 7275 6d65 6e74 5f69 6e64 6578  instrument_index
+0000de80: 6573 5f6c 632c 206c 6d5f 6c63 5f62 6f6f  es_lc, lm_lc_boo
+0000de90: 6c65 616e 203d 2073 656c 662e 6461 7461  lean = self.data
+0000dea0: 5f70 7265 7061 7261 7469 6f6e 280a 2020  _preparation(.  
+0000deb0: 2020 2020 2020 2020 2020 2020 2020 7467                tg
+0000dec0: 6c6f 6261 6c5f 6c63 2c20 696e 7374 7275  lobal_lc, instru
+0000ded0: 6d65 6e74 735f 6c63 2c20 6c69 6e65 6172  ments_lc, linear
+0000dee0: 5f72 6567 7265 7373 6f72 735f 6c63 290a  _regressors_lc).
+0000def0: 2020 2020 2020 2020 2020 2020 6c6d 5f6c              lm_l
+0000df00: 635f 6172 6775 6d65 6e74 7320 3d20 6c69  c_arguments = li
+0000df10: 6e65 6172 5f72 6567 7265 7373 6f72 735f  near_regressors_
+0000df20: 6c63 0a20 2020 2020 2020 2020 2020 206e  lc.            n
+0000df30: 696e 7374 7275 6d65 6e74 735f 6c63 203d  instruments_lc =
+0000df40: 206c 656e 2869 6e61 6d65 735f 6c63 290a   len(inames_lc).
+0000df50: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
+0000df60: 6176 6520 6461 7461 2074 6f20 6f62 6a65  ave data to obje
+0000df70: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
+0000df80: 7365 6c66 2e73 6574 5f6c 635f 6461 7461  self.set_lc_data
+0000df90: 2874 676c 6f62 616c 5f6c 632c 2079 676c  (tglobal_lc, ygl
+0000dfa0: 6f62 616c 5f6c 632c 2079 676c 6f62 616c  obal_lc, yglobal
+0000dfb0: 6572 725f 6c63 2c0a 2020 2020 2020 2020  err_lc,.        
+0000dfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dfd0: 2020 2020 2069 6e73 7472 756d 656e 7473       instruments
+0000dfe0: 5f6c 632c 2069 6e73 7472 756d 656e 745f  _lc, instrument_
+0000dff0: 696e 6465 7865 735f 6c63 2c0a 2020 2020  indexes_lc,.    
+0000e000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e010: 2020 2020 2020 2020 206e 696e 7374 7275           ninstru
+0000e020: 6d65 6e74 735f 6c63 2c20 696e 616d 6573  ments_lc, inames
+0000e030: 5f6c 632c 206c 6d5f 6c63 5f62 6f6f 6c65  _lc, lm_lc_boole
+0000e040: 616e 2c0a 2020 2020 2020 2020 2020 2020  an,.            
+0000e050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e060: 206c 6d5f 6c63 5f61 7267 756d 656e 7473   lm_lc_arguments
+0000e070: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+0000e080: 2053 6176 6520 696e 7075 7420 6469 6374   Save input dict
+0000e090: 696f 6e61 7269 6573 3a0a 2020 2020 2020  ionaries:.      
+0000e0a0: 2020 2020 2020 7365 6c66 2e74 696d 6573        self.times
+0000e0b0: 5f6c 6320 3d20 745f 6c63 0a20 2020 2020  _lc = t_lc.     
+0000e0c0: 2020 2020 2020 2073 656c 662e 6461 7461         self.data
+0000e0d0: 5f6c 6320 3d20 795f 6c63 0a20 2020 2020  _lc = y_lc.     
+0000e0e0: 2020 2020 2020 2073 656c 662e 6572 726f         self.erro
+0000e0f0: 7273 5f6c 6320 3d20 7965 7272 5f6c 630a  rs_lc = yerr_lc.
+0000e100: 2020 2020 2020 2020 656c 6966 2074 5f6c          elif t_l
+0000e110: 6320 6973 206e 6f74 204e 6f6e 653a 0a20  c is not None:. 
+0000e120: 2020 2020 2020 2020 2020 2023 2049 6e20             # In 
+0000e130: 7468 6973 2063 6173 652c 2063 6f6e 7665  this case, conve
+0000e140: 7274 2064 6174 6120 696e 2061 7272 6179  rt data in array
+0000e150: 2d66 6f72 6d20 746f 2064 6963 7469 6f6e  -form to diction
+0000e160: 6172 6965 732c 2073 6176 6520 7468 656d  aries, save them
+0000e170: 2073 6f20 7573 6572 2063 616e 2065 6173   so user can eas
+0000e180: 696c 7920 7573 6520 7468 656d 3a0a 2020  ily use them:.  
+0000e190: 2020 2020 2020 2020 2020 7469 6d65 735f            times_
+0000e1a0: 6c63 2c20 6461 7461 5f6c 632c 2065 7272  lc, data_lc, err
+0000e1b0: 6f72 735f 6c63 203d 2073 656c 662e 636f  ors_lc = self.co
+0000e1c0: 6e76 6572 745f 746f 5f64 6963 7469 6f6e  nvert_to_diction
+0000e1d0: 6172 7928 0a20 2020 2020 2020 2020 2020  ary(.           
+0000e1e0: 2020 2020 2074 5f6c 632c 2079 5f6c 632c       t_lc, y_lc,
+0000e1f0: 2079 6572 725f 6c63 2c20 696e 7374 7275   yerr_lc, instru
+0000e200: 6d65 6e74 5f69 6e64 6578 6573 5f6c 6329  ment_indexes_lc)
+0000e210: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000e220: 662e 7469 6d65 735f 6c63 203d 2074 696d  f.times_lc = tim
+0000e230: 6573 5f6c 630a 2020 2020 2020 2020 2020  es_lc.          
+0000e240: 2020 7365 6c66 2e64 6174 615f 6c63 203d    self.data_lc =
+0000e250: 2064 6174 615f 6c63 0a20 2020 2020 2020   data_lc.       
+0000e260: 2020 2020 2073 656c 662e 6572 726f 7273       self.errors
+0000e270: 5f6c 6320 3d20 6572 726f 7273 5f6c 630a  _lc = errors_lc.
+0000e280: 0a20 2020 2020 2020 2023 2053 616d 6520  .        # Same 
+0000e290: 666f 7220 7261 6469 616c 2d76 656c 6f63  for radial-veloc
+0000e2a0: 6974 7920 6461 7461 3a0a 2020 2020 2020  ity data:.      
+0000e2b0: 2020 6966 2028 7276 6669 6c65 6e61 6d65    if (rvfilename
+0000e2c0: 2069 7320 4e6f 6e65 2920 616e 6420 2874   is None) and (t
+0000e2d0: 5f72 7620 6973 206e 6f74 204e 6f6e 6529  _rv is not None)
+0000e2e0: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+0000e2f0: 7075 745f 6572 726f 725f 6361 7463 6865  put_error_catche
+0000e300: 7228 745f 7276 2c20 795f 7276 2c20 7965  r(t_rv, y_rv, ye
+0000e310: 7272 5f72 762c 2027 7261 6469 616c 2d76  rr_rv, 'radial-v
+0000e320: 656c 6f63 6974 7927 290a 2020 2020 2020  elocity').      
+0000e330: 2020 2020 2020 7467 6c6f 6261 6c5f 7276        tglobal_rv
+0000e340: 2c20 7967 6c6f 6261 6c5f 7276 2c20 7967  , yglobal_rv, yg
+0000e350: 6c6f 6261 6c65 7272 5f72 762c 2069 6e73  lobalerr_rv, ins
+0000e360: 7472 756d 656e 7473 5f72 7620 3d20 7365  truments_rv = se
+0000e370: 6c66 2e63 6f6e 7665 7274 5f69 6e70 7574  lf.convert_input
+0000e380: 5f64 6174 6128 0a20 2020 2020 2020 2020  _data(.         
+0000e390: 2020 2020 2020 2074 5f72 762c 2079 5f72         t_rv, y_r
+0000e3a0: 762c 2079 6572 725f 7276 290a 2020 2020  v, yerr_rv).    
+0000e3b0: 2020 2020 2020 2020 696e 616d 6573 5f72          inames_r
+0000e3c0: 762c 2069 6e73 7472 756d 656e 745f 696e  v, instrument_in
+0000e3d0: 6465 7865 735f 7276 2c20 6c6d 5f72 765f  dexes_rv, lm_rv_
+0000e3e0: 626f 6f6c 6561 6e20 3d20 7365 6c66 2e64  boolean = self.d
+0000e3f0: 6174 615f 7072 6570 6172 6174 696f 6e28  ata_preparation(
+0000e400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e410: 2074 676c 6f62 616c 5f72 762c 2069 6e73   tglobal_rv, ins
+0000e420: 7472 756d 656e 7473 5f72 762c 206c 696e  truments_rv, lin
+0000e430: 6561 725f 7265 6772 6573 736f 7273 5f72  ear_regressors_r
+0000e440: 7629 0a20 2020 2020 2020 2020 2020 206c  v).            l
+0000e450: 6d5f 7276 5f61 7267 756d 656e 7473 203d  m_rv_arguments =
+0000e460: 206c 696e 6561 725f 7265 6772 6573 736f   linear_regresso
+0000e470: 7273 5f72 760a 2020 2020 2020 2020 2020  rs_rv.          
+0000e480: 2020 6e69 6e73 7472 756d 656e 7473 5f72    ninstruments_r
+0000e490: 7620 3d20 6c65 6e28 696e 616d 6573 5f72  v = len(inames_r
+0000e4a0: 7629 0a0a 2020 2020 2020 2020 2020 2020  v)..            
+0000e4b0: 2320 5361 7665 2064 6174 6120 746f 206f  # Save data to o
+0000e4c0: 626a 6563 743a 0a0a 2020 2020 2020 2020  bject:..        
+0000e4d0: 2020 2020 7365 6c66 2e73 6574 5f72 765f      self.set_rv_
+0000e4e0: 6461 7461 2874 676c 6f62 616c 5f72 762c  data(tglobal_rv,
+0000e4f0: 2079 676c 6f62 616c 5f72 762c 2079 676c   yglobal_rv, ygl
+0000e500: 6f62 616c 6572 725f 7276 2c0a 2020 2020  obalerr_rv,.    
+0000e510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e520: 2020 2020 2020 2020 2069 6e73 7472 756d           instrum
+0000e530: 656e 7473 5f72 762c 2069 6e73 7472 756d  ents_rv, instrum
+0000e540: 656e 745f 696e 6465 7865 735f 7276 2c0a  ent_indexes_rv,.
+0000e550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e560: 2020 2020 2020 2020 2020 2020 206e 696e               nin
+0000e570: 7374 7275 6d65 6e74 735f 7276 2c20 696e  struments_rv, in
+0000e580: 616d 6573 5f72 762c 206c 6d5f 7276 5f62  ames_rv, lm_rv_b
+0000e590: 6f6f 6c65 616e 2c0a 2020 2020 2020 2020  oolean,.        
+0000e5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e5b0: 2020 2020 206c 6d5f 7276 5f61 7267 756d       lm_rv_argum
+0000e5c0: 656e 7473 290a 0a20 2020 2020 2020 2020  ents)..         
+0000e5d0: 2020 2023 2053 6176 6520 696e 7075 7420     # Save input 
+0000e5e0: 6469 6374 696f 6e61 7269 6573 3a0a 2020  dictionaries:.  
+0000e5f0: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
+0000e600: 696d 6573 5f72 7620 3d20 745f 7276 0a20  imes_rv = t_rv. 
+0000e610: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000e620: 6461 7461 5f72 7620 3d20 795f 7276 0a20  data_rv = y_rv. 
+0000e630: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000e640: 6572 726f 7273 5f72 7620 3d20 7965 7272  errors_rv = yerr
+0000e650: 5f72 760a 2020 2020 2020 2020 656c 6966  _rv.        elif
+0000e660: 2074 5f72 7620 6973 206e 6f74 204e 6f6e   t_rv is not Non
+0000e670: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+0000e680: 2049 6e20 7468 6973 2063 6173 652c 2063   In this case, c
+0000e690: 6f6e 7665 7274 2064 6174 6120 696e 2061  onvert data in a
+0000e6a0: 7272 6179 2d66 6f72 6d20 746f 2064 6963  rray-form to dic
+0000e6b0: 7469 6f6e 6172 6965 732c 2073 6176 6520  tionaries, save 
+0000e6c0: 7468 656d 2073 6f20 7573 6572 2063 616e  them so user can
+0000e6d0: 2065 6173 696c 7920 7573 6520 7468 656d   easily use them
+0000e6e0: 3a0a 2020 2020 2020 2020 2020 2020 7469  :.            ti
+0000e6f0: 6d65 735f 7276 2c20 6461 7461 5f72 762c  mes_rv, data_rv,
+0000e700: 2065 7272 6f72 735f 7276 203d 2073 656c   errors_rv = sel
+0000e710: 662e 636f 6e76 6572 745f 746f 5f64 6963  f.convert_to_dic
+0000e720: 7469 6f6e 6172 7928 0a20 2020 2020 2020  tionary(.       
+0000e730: 2020 2020 2020 2020 2074 5f72 762c 2079           t_rv, y
+0000e740: 5f72 762c 2079 6572 725f 7276 2c20 696e  _rv, yerr_rv, in
+0000e750: 7374 7275 6d65 6e74 5f69 6e64 6578 6573  strument_indexes
+0000e760: 5f72 7629 0a20 2020 2020 2020 2020 2020  _rv).           
+0000e770: 2073 656c 662e 7469 6d65 735f 7276 203d   self.times_rv =
+0000e780: 2074 696d 6573 5f72 760a 2020 2020 2020   times_rv.      
+0000e790: 2020 2020 2020 7365 6c66 2e64 6174 615f        self.data_
+0000e7a0: 7276 203d 2064 6174 615f 7276 0a20 2020  rv = data_rv.   
+0000e7b0: 2020 2020 2020 2020 2073 656c 662e 6572           self.er
+0000e7c0: 726f 7273 5f72 7620 3d20 6572 726f 7273  rors_rv = errors
+0000e7d0: 5f72 760a 0a20 2020 2020 2020 2023 2049  _rv..        # I
+0000e7e0: 6620 6f75 745f 666f 6c64 6572 2064 6f65  f out_folder doe
+0000e7f0: 7320 6e6f 7420 6578 6973 742c 2063 7265  s not exist, cre
+0000e800: 6174 6520 6974 2c20 616e 6420 7361 7665  ate it, and save
+0000e810: 2064 6174 6120 746f 2069 743a 0a20 2020   data to it:.   
+0000e820: 2020 2020 2069 6620 6f75 745f 666f 6c64       if out_fold
+0000e830: 6572 2069 7320 6e6f 7420 4e6f 6e65 3a0a  er is not None:.
+0000e840: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000e850: 2e6f 7574 5f66 6f6c 6465 7220 3d20 6f75  .out_folder = ou
+0000e860: 745f 666f 6c64 6572 0a20 2020 2020 2020  t_folder.       
+0000e870: 2020 2020 2073 656c 662e 7361 7665 2829       self.save()
+0000e880: 0a0a 2020 2020 2020 2020 2320 4669 6e61  ..        # Fina
+0000e890: 6c6c 792c 2067 656e 6572 6174 6520 6461  lly, generate da
+0000e8a0: 7461 6469 6374 732c 2074 6861 7420 7769  tadicts, that wi
+0000e8b0: 6c6c 2073 6176 6520 696e 666f 726d 6174  ll save informat
+0000e8c0: 696f 6e20 6162 6f75 7420 7468 6520 6669  ion about the fi
+0000e8d0: 7473 2c20 696e 636c 7564 696e 6720 6761  ts, including ga
+0000e8e0: 7573 7369 616e 5f70 726f 6365 7373 206f  ussian_process o
+0000e8f0: 626a 6563 7473 2066 6f72 2065 6163 6820  bjects for each 
+0000e900: 696e 7374 7275 6d65 6e74 2074 6861 7420  instrument that 
+0000e910: 7265 7175 6972 6573 2069 740a 2020 2020  requires it.    
+0000e920: 2020 2020 2320 2869 6e63 6c75 6469 6e67      # (including
+0000e930: 2074 6865 2063 6173 6520 6f66 2067 6c6f   the case of glo
+0000e940: 6261 6c20 6d6f 6465 6c73 293a 0a20 2020  bal models):.   
+0000e950: 2020 2020 2069 6620 745f 6c63 2069 7320       if t_lc is 
+0000e960: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0000e970: 2020 2020 2020 7365 6c66 2e67 656e 6572        self.gener
+0000e980: 6174 655f 6461 7461 6469 6374 2827 6c63  ate_datadict('lc
+0000e990: 2729 0a20 2020 2020 2020 2069 6620 745f  ').        if t_
+0000e9a0: 7276 2069 7320 6e6f 7420 4e6f 6e65 3a0a  rv is not None:.
+0000e9b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000e9c0: 2e67 656e 6572 6174 655f 6461 7461 6469  .generate_datadi
+0000e9d0: 6374 2827 7276 2729 0a0a 0a6d 636d 635f  ct('rv')...mcmc_
+0000e9e0: 7361 6d70 6c65 7273 203d 205b 2765 6d63  samplers = ['emc
+0000e9f0: 6565 272c 2027 7a65 7573 275d 0a0a 636c  ee', 'zeus']..cl
+0000ea00: 6173 7320 6669 7428 6f62 6a65 6374 293a  ass fit(object):
+0000ea10: 0a20 2020 2022 2222 0a20 2020 2047 6976  .    """.    Giv
+0000ea20: 656e 2061 206a 756c 6965 7420 6461 7461  en a juliet data
+0000ea30: 206f 626a 6563 742c 2074 6869 7320 636c   object, this cl
+0000ea40: 6173 7320 7065 7266 6f72 6d73 2061 2066  ass performs a f
+0000ea50: 6974 2074 6f20 7468 6520 6461 7461 2061  it to the data a
+0000ea60: 6e64 2072 6574 7572 6e73 2061 2072 6573  nd returns a res
+0000ea70: 756c 7473 206f 626a 6563 7420 746f 2065  ults object to e
+0000ea80: 7870 6c6f 7265 2074 6865 0a20 2020 2072  xplore the.    r
+0000ea90: 6573 756c 7473 2e20 4578 616d 706c 6520  esults. Example 
+0000eaa0: 7573 6167 653a 0a0a 2020 2020 2020 2020  usage:..        
+0000eab0: 2020 2020 2020 203e 3e3e 2072 6573 756c         >>> resul
+0000eac0: 7473 203d 206a 756c 6965 742e 6669 7428  ts = juliet.fit(
+0000ead0: 6461 7461 290a 0a20 2020 203a 7061 7261  data)..    :para
+0000eae0: 6d20 6461 7461 3a20 286a 756c 6965 7420  m data: (juliet 
+0000eaf0: 6f62 6a65 6374 290a 2020 2020 2020 2020  object).        
+0000eb00: 416e 206f 626a 6563 7420 636f 6e74 6169  An object contai
+0000eb10: 6e69 6e67 2061 6c6c 2074 6865 2069 6e66  ning all the inf
+0000eb20: 6f72 6d61 7469 6f6e 2072 6567 6172 6469  ormation regardi
+0000eb30: 6e67 2074 6865 2064 6174 6120 746f 2062  ng the data to b
+0000eb40: 6520 6669 7474 6564 2c20 696e 636c 7564  e fitted, includ
+0000eb50: 696e 6720 6f70 7469 6f6e 7320 6f66 2074  ing options of t
+0000eb60: 6865 2066 6974 2e0a 2020 2020 2020 2020  he fit..        
+0000eb70: 4765 6e65 7261 7465 6420 7669 6120 6a75  Generated via ju
+0000eb80: 6c69 6574 2e6c 6f61 6428 292e 0a0a 2020  liet.load()...  
+0000eb90: 2020 4f6e 2074 6f70 206f 6620 6060 6461    On top of ``da
+0000eba0: 7461 6060 2c20 6120 7365 7269 6573 206f  ta``, a series o
+0000ebb0: 6620 6578 7472 6120 6b65 7977 6f72 6473  f extra keywords
+0000ebc0: 2063 616e 2062 6520 696e 636c 7564 6564   can be included
+0000ebd0: 3a0a 0a20 2020 203a 7061 7261 6d20 7361  :..    :param sa
+0000ebe0: 6d70 6c65 723a 2028 6f70 7469 6f6e 616c  mpler: (optional
+0000ebf0: 2c20 7374 7269 6e67 290a 2020 2020 2020  , string).      
+0000ec00: 2020 5374 7269 6e67 2064 6566 696e 696e    String definin
+0000ec10: 6720 7468 6520 7361 6d70 6c65 7220 746f  g the sampler to
+0000ec20: 2062 6520 7573 6564 206f 6e20 7468 6520   be used on the 
+0000ec30: 6669 742e 2043 7572 7265 6e74 2070 6f73  fit. Current pos
+0000ec40: 7369 626c 6520 6f70 7469 6f6e 7320 696e  sible options in
+0000ec50: 636c 7564 6520 6060 6d75 6c74 696e 6573  clude ``multines
+0000ec60: 7460 6020 746f 2075 7365 2060 5079 4d75  t`` to use `PyMu
+0000ec70: 6c74 694e 6573 7420 3c68 7474 7073 3a2f  ltiNest <https:/
+0000ec80: 2f67 6974 6875 622e 636f 6d2f 4a6f 6861  /github.com/Joha
+0000ec90: 6e6e 6573 4275 6368 6e65 722f 5079 4d75  nnesBuchner/PyMu
+0000eca0: 6c74 694e 6573 743e 605f 2028 7669 6120  ltiNest>`_ (via 
+0000ecb0: 696d 706f 7274 616e 6365 206e 6573 7465  importance neste
+0000ecc0: 6420 7361 6d70 6c69 6e67 292c 0a20 2020  d sampling),.   
+0000ecd0: 2020 2020 2060 6064 796e 6573 7479 6060       ``dynesty``
+0000ece0: 2074 6f20 7573 6520 6044 796e 6573 7479   to use `Dynesty
+0000ecf0: 203c 6874 7470 733a 2f2f 6769 7468 7562   <https://github
+0000ed00: 2e63 6f6d 2f6a 6f73 6873 7065 6167 6c65  .com/joshspeagle
+0000ed10: 2f64 796e 6573 7479 3e60 5f27 7320 696d  /dynesty>`_'s im
+0000ed20: 706f 7274 616e 6365 206e 6573 7465 6420  portance nested 
+0000ed30: 7361 6d70 6c69 6e67 2c20 6060 6479 6e61  sampling, ``dyna
+0000ed40: 6d69 635f 6479 6e65 7374 7960 6020 746f  mic_dynesty`` to
+0000ed50: 2075 7365 2044 796e 6573 7479 2773 2064   use Dynesty's d
+0000ed60: 796e 616d 6963 206e 6573 7465 6420 7361  ynamic nested sa
+0000ed70: 6d70 6c69 6e67 2061 6c67 6f72 6974 686d  mpling algorithm
+0000ed80: 2c20 6060 756c 7472 616e 6573 7460 6020  , ``ultranest`` 
+0000ed90: 746f 2075 7365 0a20 2020 2020 2020 2060  to use.        `
+0000eda0: 556c 7472 616e 6573 7420 3c68 7474 7073  Ultranest <https
+0000edb0: 3a2f 2f67 6974 6875 622e 636f 6d2f 4a6f  ://github.com/Jo
+0000edc0: 6861 6e6e 6573 4275 6368 6e65 722f 556c  hannesBuchner/Ul
+0000edd0: 7472 614e 6573 742f 3e60 5f2c 2060 6073  traNest/>`_, ``s
+0000ede0: 6c69 6365 7361 6d70 6c65 725f 756c 7472  licesampler_ultr
+0000edf0: 616e 6573 7460 6020 746f 2075 7365 2055  anest`` to use U
+0000ee00: 6c74 7261 6e65 7374 2773 2073 6c69 6365  ltranest's slice
+0000ee10: 2073 616d 706c 6572 2061 6e64 2060 6065   sampler and ``e
+0000ee20: 6d63 6565 6060 2074 6f20 7573 6520 6065  mcee`` to use `e
+0000ee30: 6d63 6565 203c 6874 7470 733a 2f2f 6769  mcee <https://gi
+0000ee40: 7468 7562 2e63 6f6d 2f64 666d 2f65 6d63  thub.com/dfm/emc
+0000ee50: 6565 3e60 5f2e 2044 6566 6175 6c74 2069  ee>`_. Default i
+0000ee60: 730a 2020 2020 2020 2020 6060 6d75 6c74  s.        ``mult
+0000ee70: 696e 6573 7460 6020 6966 2050 794d 756c  inest`` if PyMul
+0000ee80: 7469 4e65 7374 2069 7320 696e 7374 616c  tiNest is instal
+0000ee90: 6c65 643b 2060 6064 796e 6573 7479 6060  led; ``dynesty``
+0000eea0: 2069 6620 6e6f 742e 0a0a 2020 2020 3a70   if not...    :p
+0000eeb0: 6172 616d 206e 5f6c 6976 655f 706f 696e  aram n_live_poin
+0000eec0: 7473 3a20 286f 7074 696f 6e61 6c2c 2069  ts: (optional, i
+0000eed0: 6e74 290a 2020 2020 2020 2020 4e75 6d62  nt).        Numb
+0000eee0: 6572 206f 6620 6c69 7665 2d70 6f69 6e74  er of live-point
+0000eef0: 7320 746f 2075 7365 206f 6e20 7468 6520  s to use on the 
+0000ef00: 6e65 7374 6564 2073 616d 706c 696e 6720  nested sampling 
+0000ef10: 7361 6d70 6c65 7273 2e20 4465 6661 756c  samplers. Defaul
+0000ef20: 7420 6973 2035 3030 2e0a 0a20 2020 203a  t is 500...    :
+0000ef30: 7061 7261 6d20 6e77 616c 6b65 7273 3a20  param nwalkers: 
+0000ef40: 286f 7074 696f 6e61 6c20 6966 2075 7369  (optional if usi
+0000ef50: 6e67 2065 6d63 6565 2c20 696e 7429 0a20  ng emcee, int). 
+0000ef60: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
+0000ef70: 2077 616c 6b65 7273 2074 6f20 7573 6520   walkers to use 
+0000ef80: 6279 2065 6d63 6565 2e20 4465 6661 756c  by emcee. Defaul
+0000ef90: 7420 6973 2031 3030 2e0a 0a20 2020 203a  t is 100...    :
+0000efa0: 7061 7261 6d20 6e73 7465 7073 3a20 286f  param nsteps: (o
+0000efb0: 7074 696f 6e61 6c20 6966 2075 7369 6e67  ptional if using
+0000efc0: 204d 434d 432c 2069 6e74 290a 2020 2020   MCMC, int).    
+0000efd0: 2020 2020 4e75 6d62 6572 206f 6620 7374      Number of st
+0000efe0: 6570 732f 6a75 6d70 7320 746f 2070 6572  eps/jumps to per
+0000eff0: 666f 726d 206f 6e20 7468 6520 4d43 4d43  form on the MCMC
+0000f000: 2072 756e 2e20 4465 6661 756c 7420 6973   run. Default is
+0000f010: 2033 3030 2e0a 0a20 2020 203a 7061 7261   300...    :para
+0000f020: 6d20 6e62 7572 6e69 6e3a 2028 6f70 7469  m nburnin: (opti
+0000f030: 6f6e 616c 2069 6620 7573 696e 6720 4d43  onal if using MC
+0000f040: 4d43 2c20 696e 7429 0a20 2020 2020 2020  MC, int).       
+0000f050: 204e 756d 6265 7220 6f66 2062 7572 6e69   Number of burni
+0000f060: 6e20 7374 6570 732f 6a75 6d70 7320 7768  n steps/jumps wh
+0000f070: 656e 2070 6572 666f 726d 696e 6720 7468  en performing th
+0000f080: 6520 4d43 4d43 2072 756e 2e20 4465 6661  e MCMC run. Defa
+0000f090: 756c 7420 6973 2035 3030 2e0a 0a20 2020  ult is 500...   
+0000f0a0: 203a 7061 7261 6d20 656d 6365 655f 6661   :param emcee_fa
+0000f0b0: 6374 6f72 3a20 286f 7074 696f 6e61 6c2c  ctor: (optional,
+0000f0c0: 2066 6f72 2065 6d63 6565 206f 6e6c 792c   for emcee only,
+0000f0d0: 2066 6c6f 6174 290a 2020 2020 2020 2020   float).        
+0000f0e0: 4661 6374 6f72 206d 756c 7469 706c 7969  Factor multiplyi
+0000f0f0: 6e67 2074 6865 2073 7461 6e64 6172 642d  ng the standard-
+0000f100: 6761 7573 7369 616e 2062 616c 6c20 6172  gaussian ball ar
+0000f110: 6f75 6e64 2077 6869 6368 2074 6865 2069  ound which the i
+0000f120: 6e69 7469 616c 2070 6f73 6974 696f 6e20  nitial position 
+0000f130: 6973 2070 6572 7475 7262 6564 2066 6f72  is perturbed for
+0000f140: 2065 6163 6820 7761 6c6b 6572 2e20 4465   each walker. De
+0000f150: 6661 756c 7420 6973 2031 652d 342e 0a0a  fault is 1e-4...
+0000f160: 2020 2020 3a70 6172 616d 2065 6363 6c69      :param eccli
+0000f170: 6d3a 2028 6f70 7469 6f6e 616c 2c20 666c  m: (optional, fl
+0000f180: 6f61 7429 0a20 2020 2020 2020 2055 7070  oat).        Upp
+0000f190: 6572 206c 696d 6974 206f 6e20 7468 6520  er limit on the 
+0000f1a0: 6d61 7869 6d75 6d20 6563 6365 6e74 7269  maximum eccentri
+0000f1b0: 6369 7479 2074 6f20 7361 6d70 6c65 2e20  city to sample. 
+0000f1c0: 4465 6661 756c 7420 6973 2060 6031 6060  Default is ``1``
+0000f1d0: 2e0a 0a20 2020 203a 7061 7261 6d20 706c  ...    :param pl
+0000f1e0: 3a20 286f 7074 696f 6e61 6c2c 2066 6c6f  : (optional, flo
+0000f1f0: 6174 290a 2020 2020 2020 2020 4966 2074  at).        If t
+0000f200: 6865 2060 6028 7231 2c72 3229 6060 2070  he ``(r1,r2)`` p
+0000f210: 6172 616d 6574 7269 7a61 7469 6f6e 2066  arametrization f
+0000f220: 6f72 2060 6028 622c 7029 6060 2069 7320  or ``(b,p)`` is 
+0000f230: 7573 6564 2c20 7468 6973 2064 6566 696e  used, this defin
+0000f240: 6573 2074 6865 206c 6f77 6572 206c 696d  es the lower lim
+0000f250: 6974 206f 6620 7468 6520 706c 616e 6574  it of the planet
+0000f260: 2d74 6f2d 7374 6172 2072 6164 6975 7320  -to-star radius 
+0000f270: 7261 7469 6f20 746f 2062 6520 7361 6d70  ratio to be samp
+0000f280: 6c65 642e 0a20 2020 2020 2020 2044 6566  led..        Def
+0000f290: 6175 6c74 2069 7320 6060 3060 602e 0a0a  ault is ``0``...
+0000f2a0: 2020 2020 3a70 6172 616d 2070 753a 2028      :param pu: (
+0000f2b0: 6f70 7469 6f6e 616c 2c20 666c 6f61 7429  optional, float)
+0000f2c0: 0a20 2020 2020 2020 2053 616d 6520 6173  .        Same as
+0000f2d0: 2060 6070 6c60 602c 2062 7574 2066 6f72   ``pl``, but for
+0000f2e0: 2074 6865 2075 7070 6572 206c 696d 6974   the upper limit
+0000f2f0: 2e20 4465 6661 756c 7420 6973 2060 6031  . Default is ``1
+0000f300: 6060 2e0a 0a20 2020 203a 7061 7261 6d20  ``...    :param 
+0000f310: 7461 3a20 286f 7074 696f 6e61 6c2c 2066  ta: (optional, f
+0000f320: 6c6f 6174 290a 2020 2020 2020 2020 5469  loat).        Ti
+0000f330: 6d65 2074 6f20 6265 2073 7562 7374 7261  me to be substra
+0000f340: 6374 6564 2074 6f20 7468 6520 696e 7075  cted to the inpu
+0000f350: 7420 7469 6d65 7320 696e 206f 7264 6572  t times in order
+0000f360: 2074 6f20 6765 6e65 7261 7465 2074 6865   to generate the
+0000f370: 206c 696e 6561 7220 616e 642f 6f72 2071   linear and/or q
+0000f380: 7561 6472 6174 6963 2074 7265 6e64 2074  uadratic trend t
+0000f390: 6f20 6265 2061 6464 6564 2074 6f20 7468  o be added to th
+0000f3a0: 6520 6d6f 6465 6c2e 0a20 2020 2020 2020  e model..       
+0000f3b0: 2044 6566 6175 6c74 2069 7320 3234 3538   Default is 2458
+0000f3c0: 3436 302e 0a0a 2020 2020 3a70 6172 616d  460...    :param
+0000f3d0: 206e 7468 7265 6164 733a 2028 6f70 7469   nthreads: (opti
+0000f3e0: 6e61 6c2c 2069 6e74 290a 2020 2020 2020  nal, int).      
+0000f3f0: 2020 4465 6669 6e65 2074 6865 206e 756d    Define the num
+0000f400: 6265 7220 6f66 2074 6872 6561 6473 2074  ber of threads t
+0000f410: 6f20 7573 6520 7769 7468 696e 2064 796e  o use within dyn
+0000f420: 6573 7479 206f 7220 656d 6365 652e 2044  esty or emcee. D
+0000f430: 6566 6175 6c74 2069 7320 746f 2075 7365  efault is to use
+0000f440: 206a 7573 7420 312e 204e 6f74 6520 7468   just 1. Note th
+0000f450: 6973 2077 696c 6c20 6e6f 7420 696d 7061  is will not impa
+0000f460: 6374 2050 794d 756c 7469 4e65 7374 206f  ct PyMultiNest o
+0000f470: 7220 556c 7472 614e 6573 7420 7275 6e73  r UltraNest runs
+0000f480: 202d 2d2d 2074 6865 7365 2063 616e 2062   --- these can b
+0000f490: 6520 7061 7261 6c6c 656c 697a 6564 2076  e parallelized v
+0000f4a0: 6961 204d 5049 206f 6e6c 792e 0a0a 2020  ia MPI only...  
+0000f4b0: 2020 3a70 6172 616d 206c 6967 6874 5f74    :param light_t
+0000f4c0: 7261 7665 6c5f 6465 6c61 793a 2028 6f70  ravel_delay: (op
+0000f4d0: 7469 6e61 6c2c 2062 6f6f 6c29 0a20 2020  tinal, bool).   
+0000f4e0: 2020 2020 2042 6f6f 6c65 616e 2069 6e64       Boolean ind
+0000f4f0: 6963 6174 696e 6720 6966 206c 6967 6874  icating if light
+0000f500: 2074 7261 7665 6c20 7469 6d65 2064 656c   travel time del
+0000f510: 6179 2077 616e 7473 2074 6f20 6265 2069  ay wants to be i
+0000f520: 6e63 6c75 6465 6420 6f6e 2065 636c 6970  ncluded on eclip
+0000f530: 7365 2074 696d 6520 6361 6c63 756c 6174  se time calculat
+0000f540: 696f 6e73 2e0a 0a20 2020 203a 7061 7261  ions...    :para
+0000f550: 6d20 7374 656c 6c61 725f 7261 6469 7573  m stellar_radius
+0000f560: 3a20 286f 7074 696f 6e61 6c2c 2066 6c6f  : (optional, flo
+0000f570: 6174 290a 2020 2020 2020 2020 5374 656c  at).        Stel
+0000f580: 6c61 7220 7261 6469 7573 2069 6e20 756e  lar radius in un
+0000f590: 6974 7320 6f66 2073 6f6c 6172 2d72 6164  its of solar-rad
+0000f5a0: 6969 2074 6f20 7573 6520 666f 7220 7468  ii to use for th
+0000f5b0: 6520 6c69 6768 7420 7472 6176 656c 2074  e light travel t
+0000f5c0: 696d 6520 636f 7272 6563 7469 6f6e 732e  ime corrections.
+0000f5d0: 0a0a 2020 2020 496e 2061 6464 6974 696f  ..    In additio
+0000f5e0: 6e2c 2061 6e79 206e 756d 6265 7220 6f66  n, any number of
+0000f5f0: 2065 7874 7261 206f 7074 696f 6e61 6c20   extra optional 
+0000f600: 6b65 7977 6f72 6473 2063 616e 2062 6520  keywords can be 
+0000f610: 6769 7665 6e20 746f 2074 6865 2063 616c  given to the cal
+0000f620: 6c2c 2077 6869 6368 2077 696c 6c20 6265  l, which will be
+0000f630: 2064 6972 6563 746c 7920 696e 6765 7374   directly ingest
+0000f640: 6564 2069 6e74 6f20 7468 6520 7361 6d70  ed into the samp
+0000f650: 6c65 7220 6f66 2063 686f 6963 652e 2046  ler of choice. F
+0000f660: 6f72 2061 2066 756c 6c20 6c69 7374 206f  or a full list o
+0000f670: 6620 6f70 7469 6f6e 616c 206b 6579 776f  f optional keywo
+0000f680: 7264 7320 666f 722e 2e2e 0a0a 2020 2020  rds for.....    
+0000f690: 2d20 2e2e 2e50 794d 756c 7469 4e65 7374  - ...PyMultiNest
+0000f6a0: 2c20 6368 6563 6b20 7468 6520 646f 6373  , check the docs
+0000f6b0: 7472 696e 6720 6f66 2060 6050 794d 756c  tring of ``PyMul
+0000f6c0: 7469 4e65 7374 6060 2773 2060 6072 756e  tiNest``'s ``run
+0000f6d0: 6060 2060 6675 6e63 7469 6f6e 203c 6874  `` `function <ht
+0000f6e0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+0000f6f0: 2f4a 6f68 616e 6e65 7342 7563 686e 6572  /JohannesBuchner
+0000f700: 2f50 794d 756c 7469 4e65 7374 2f62 6c6f  /PyMultiNest/blo
+0000f710: 622f 6d61 7374 6572 2f70 796d 756c 7469  b/master/pymulti
+0000f720: 6e65 7374 2f72 756e 2e70 793e 605f 2e0a  nest/run.py>`_..
+0000f730: 0a20 2020 202d 202e 2e2e 616e 7920 6f66  .    - ...any of
+0000f740: 2074 6865 206e 6573 7465 6420 7361 6d70   the nested samp
+0000f750: 6c69 6e67 2061 6c67 6f72 6974 686d 7320  ling algorithms 
+0000f760: 696e 2060 6064 796e 6573 7479 6060 2c20  in ``dynesty``, 
+0000f770: 7365 6520 7468 6520 646f 6373 7472 696e  see the docstrin
+0000f780: 6720 6f6e 2074 6865 2060 6072 756e 5f6e  g on the ``run_n
+0000f790: 6573 7465 6460 6020 6066 756e 6374 696f  ested`` `functio
+0000f7a0: 6e20 3c68 7474 7073 3a2f 2f64 796e 6573  n <https://dynes
+0000f7b0: 7479 2e72 6561 6474 6865 646f 6373 2e69  ty.readthedocs.i
+0000f7c0: 6f2f 656e 2f6c 6174 6573 742f 6170 692e  o/en/latest/api.
+0000f7d0: 6874 6d6c 2364 796e 6573 7479 2e64 796e  html#dynesty.dyn
+0000f7e0: 616d 6963 7361 6d70 6c65 722e 4479 6e61  amicsampler.Dyna
+0000f7f0: 6d69 6353 616d 706c 6572 2e72 756e 5f6e  micSampler.run_n
+0000f800: 6573 7465 643e 605f 2e0a 0a20 2020 202d  ested>`_...    -
+0000f810: 202e 2e2e 7468 6520 6e6f 6e2d 6479 6e61   ...the non-dyna
+0000f820: 6d69 6320 6e65 7374 6564 2073 616d 706c  mic nested sampl
+0000f830: 696e 6720 616c 676f 7269 7468 6d20 696d  ing algorithm im
+0000f840: 706c 656d 656e 7465 6420 696e 2060 6064  plemented in ``d
+0000f850: 796e 6573 7479 6060 2c20 7365 6520 7468  ynesty``, see th
+0000f860: 6520 646f 6373 7472 696e 6720 6f6e 2060  e docstring on `
+0000f870: 6064 796e 6573 7479 2e64 796e 6573 7479  `dynesty.dynesty
+0000f880: 2e4e 6573 7465 6453 616d 706c 6572 6060  .NestedSampler``
+0000f890: 2069 6e20 6064 796e 6573 7479 2773 2064   in `dynesty's d
+0000f8a0: 6f63 756d 656e 7461 7469 6f6e 203c 6874  ocumentation <ht
+0000f8b0: 7470 733a 2f2f 6479 6e65 7374 792e 7265  tps://dynesty.re
+0000f8c0: 6164 7468 6564 6f63 732e 696f 2f65 6e2f  adthedocs.io/en/
+0000f8d0: 6c61 7465 7374 2f61 7069 2e68 746d 6c3e  latest/api.html>
+0000f8e0: 605f 2e0a 0a20 2020 202d 202e 2e2e 7468  `_...    - ...th
+0000f8f0: 6520 6479 6e61 6d69 6320 6e65 7374 6564  e dynamic nested
+0000f900: 2073 616d 706c 696e 6720 696e 2060 6064   sampling in ``d
+0000f910: 796e 6573 7479 6060 2063 6865 636b 2074  ynesty`` check t
+0000f920: 6865 2064 6f63 7374 7269 6e67 2066 6f72  he docstring for
+0000f930: 2060 6064 796e 6573 7479 2e64 796e 6573   ``dynesty.dynes
+0000f940: 7479 2e44 796e 616d 6963 4e65 7374 6564  ty.DynamicNested
+0000f950: 5361 6d70 6c65 7260 6020 696e 2060 6479  Sampler`` in `dy
+0000f960: 6e65 7374 7927 7320 646f 6375 6d65 6e74  nesty's document
+0000f970: 6174 696f 6e20 3c68 7474 7073 3a2f 2f64  ation <https://d
+0000f980: 796e 6573 7479 2e72 6561 6474 6865 646f  ynesty.readthedo
+0000f990: 6373 2e69 6f2f 656e 2f6c 6174 6573 742f  cs.io/en/latest/
+0000f9a0: 6170 692e 6874 6d6c 3e60 5f2e 0a0a 2020  api.html>`_...  
+0000f9b0: 2020 2d20 2e2e 2e74 6865 2060 6075 6c74    - ...the ``ult
+0000f9c0: 7261 6e65 7374 6060 2073 616d 706c 6572  ranest`` sampler
+0000f9d0: 2c20 7365 6520 7468 6520 646f 6373 7472  , see the docstr
+0000f9e0: 696e 6720 666f 7220 6075 6c74 7261 6e65  ing for `ultrane
+0000f9f0: 7374 2e69 6e74 6567 7261 7469 6f6e 722e  st.integrationr.
+0000fa00: 5265 6163 7469 7665 4e65 7374 6564 5361  ReactiveNestedSa
+0000fa10: 6d70 6c65 7260 2069 6e20 6075 6c74 7261  mpler` in `ultra
+0000fa20: 6e65 7374 2773 2064 6f63 756d 656e 7461  nest's documenta
+0000fa30: 7469 6f6e 203c 6874 7470 733a 2f2f 6a6f  tion <https://jo
+0000fa40: 6861 6e6e 6573 6275 6368 6e65 722e 6769  hannesbuchner.gi
+0000fa50: 7468 7562 2e69 6f2f 556c 7472 614e 6573  thub.io/UltraNes
+0000fa60: 742f 756c 7472 616e 6573 742e 6874 6d6c  t/ultranest.html
+0000fa70: 2375 6c74 7261 6e65 7374 2e69 6e74 6567  #ultranest.integ
+0000fa80: 7261 746f 722e 5265 6163 7469 7665 4e65  rator.ReactiveNe
+0000fa90: 7374 6564 5361 6d70 6c65 723e 605f 0a0a  stedSampler>`_..
+0000faa0: 2020 2020 4669 6e61 6c6c 792c 2073 696e      Finally, sin
+0000fab0: 6365 2060 606a 756c 6965 7460 6020 7665  ce ``juliet`` ve
+0000fac0: 7273 696f 6e20 322e 302e 3236 2c20 7468  rsion 2.0.26, th
+0000fad0: 6520 666f 6c6c 6f77 696e 6720 6b65 7977  e following keyw
+0000fae0: 6f72 6473 2068 6176 6520 6265 656e 2064  ords have been d
+0000faf0: 6570 7265 6361 7465 642c 2061 6e64 2061  eprecated, and a
+0000fb00: 7265 2072 6563 6f6d 6d65 6e64 6564 2074  re recommended t
+0000fb10: 6f20 6265 2072 656d 6f76 6564 2066 726f  o be removed fro
+0000fb20: 6d20 636f 6465 2075 7369 6e67 2060 606a  m code using ``j
+0000fb30: 756c 6965 7460 6020 6173 2074 6865 790a  uliet`` as they.
+0000fb40: 2020 2020 7769 6c6c 2062 6520 7265 6d6f      will be remo
+0000fb50: 7665 6420 736f 6d65 7469 6d65 2069 6e20  ved sometime in 
+0000fb60: 7468 6520 6675 7475 7265 3a0a 0a20 2020  the future:..   
+0000fb70: 203a 7061 7261 6d20 7573 655f 6479 6e65   :param use_dyne
+0000fb80: 7374 793a 2028 6f70 7469 6f6e 616c 2c20  sty: (optional, 
+0000fb90: 626f 6f6c 6561 6e29 0a20 2020 2020 2020  boolean).       
+0000fba0: 2049 6620 6060 5472 7565 6060 2c20 7573   If ``True``, us
+0000fbb0: 6520 6479 6e65 7374 7920 696e 7374 6561  e dynesty instea
+0000fbc0: 6420 6f66 2060 4d75 6c74 694e 6573 7460  d of `MultiNest`
+0000fbd0: 2066 6f72 2070 6f73 7465 7269 6f72 2073   for posterior s
+0000fbe0: 616d 706c 696e 6720 616e 6420 6576 6964  ampling and evid
+0000fbf0: 656e 6365 2065 7661 6c75 6174 696f 6e2e  ence evaluation.
+0000fc00: 2044 6566 6175 6c74 2069 730a 2020 2020   Default is.    
+0000fc10: 2020 2020 6060 4661 6c73 6560 602c 2075      ``False``, u
+0000fc20: 6e6c 6573 7320 604d 756c 7469 4e65 7374  nless `MultiNest
+0000fc30: 6020 7669 6120 6060 7079 6d75 6c74 696e  ` via ``pymultin
+0000fc40: 6573 7460 6020 6973 206e 6f74 2077 6f72  est`` is not wor
+0000fc50: 6b69 6e67 206f 6e20 7468 6520 7379 7374  king on the syst
+0000fc60: 656d 2e0a 0a20 2020 203a 7061 7261 6d20  em...    :param 
+0000fc70: 6479 6e61 6d69 633a 2028 6f70 7469 6f6e  dynamic: (option
+0000fc80: 616c 2c20 626f 6f6c 6561 6e29 0a20 2020  al, boolean).   
+0000fc90: 2020 2020 2049 6620 6060 5472 7565 6060       If ``True``
+0000fca0: 2c20 7573 6520 6479 6e61 6d69 6320 4e65  , use dynamic Ne
+0000fcb0: 7374 6564 2053 616d 706c 696e 6720 7769  sted Sampling wi
+0000fcc0: 7468 2064 796e 6573 7479 2e20 4465 6661  th dynesty. Defa
+0000fcd0: 756c 7420 6973 2060 6046 616c 7365 6060  ult is ``False``
+0000fce0: 2e0a 0a20 2020 203a 7061 7261 6d20 6479  ...    :param dy
+0000fcf0: 6e65 7374 795f 626f 756e 643a 2028 6f70  nesty_bound: (op
+0000fd00: 7469 6f6e 616c 2c20 7374 7269 6e67 290a  tional, string).
+0000fd10: 2020 2020 2020 2020 4465 6669 6e65 2074          Define t
+0000fd20: 6865 2064 796e 6573 7479 2062 6f75 6e64  he dynesty bound
+0000fd30: 206d 6574 686f 6420 746f 2075 7365 2028   method to use (
+0000fd40: 6375 7272 656e 746c 7920 6569 7468 6572  currently either
+0000fd50: 2060 6073 696e 676c 6560 6020 6f72 2060   ``single`` or `
+0000fd60: 606d 756c 7469 6060 2c20 746f 2075 7365  `multi``, to use
+0000fd70: 2065 6974 6865 7220 7369 6e67 6c65 2065   either single e
+0000fd80: 6c6c 6970 736f 6964 7320 6f72 206d 756c  llipsoids or mul
+0000fd90: 7469 706c 650a 2020 2020 2020 2020 656c  tiple.        el
+0000fda0: 6c69 7073 6f69 6473 292e 2044 6566 6175  lipsoids). Defau
+0000fdb0: 6c74 2069 7320 6060 6d75 6c74 6960 6020  lt is ``multi`` 
+0000fdc0: 2866 6f72 2064 6574 6169 6c73 2c20 7365  (for details, se
+0000fdd0: 6520 7468 6520 6064 796e 6573 7479 2041  e the `dynesty A
+0000fde0: 5049 203c 6874 7470 733a 2f2f 6479 6e65  PI <https://dyne
+0000fdf0: 7374 792e 7265 6164 7468 6564 6f63 732e  sty.readthedocs.
+0000fe00: 696f 2f65 6e2f 6c61 7465 7374 2f61 7069  io/en/latest/api
+0000fe10: 2e68 746d 6c3e 605f 292e 0a0a 2020 2020  .html>`_)...    
+0000fe20: 3a70 6172 616d 2064 796e 6573 7479 5f73  :param dynesty_s
+0000fe30: 616d 706c 653a 2028 6f70 7469 6f6e 616c  ample: (optional
+0000fe40: 2c20 7374 7269 6e67 290a 2020 2020 2020  , string).      
+0000fe50: 2020 4465 6669 6e65 2074 6865 2073 616d    Define the sam
+0000fe60: 706c 696e 6720 6d65 7468 6f64 2066 6f72  pling method for
+0000fe70: 2064 796e 6573 7479 2074 6f20 7573 652e   dynesty to use.
+0000fe80: 2044 6566 6175 6c74 2069 7320 6060 7277   Default is ``rw
+0000fe90: 616c 6b60 602e 2041 6363 6f72 6669 6e67  alk``. Accorfing
+0000fea0: 2074 6f20 7468 6520 6064 796e 6573 7479   to the `dynesty
+0000feb0: 2041 5049 203c 6874 7470 733a 2f2f 6479   API <https://dy
+0000fec0: 6e65 7374 792e 7265 6164 7468 6564 6f63  nesty.readthedoc
+0000fed0: 732e 696f 2f65 6e2f 6c61 7465 7374 2f61  s.io/en/latest/a
+0000fee0: 7069 2e68 746d 6c3e 605f 2c0a 2020 2020  pi.html>`_,.    
+0000fef0: 2020 2020 7468 6973 2073 686f 756c 6420      this should 
+0000ff00: 6265 2063 6861 6e67 6564 2064 6570 656e  be changed depen
+0000ff10: 6469 6e67 206f 6e20 7468 6520 6e75 6d62  ding on the numb
+0000ff20: 6572 206f 6620 7061 7261 6d65 7465 7273  er of parameters
+0000ff30: 2062 6569 6e67 2066 6974 7465 642e 2049   being fitted. I
+0000ff40: 6620 736d 616c 6c65 7220 7468 616e 2061  f smaller than a
+0000ff50: 626f 7574 2032 302c 2060 6072 7761 6c6b  bout 20, ``rwalk
+0000ff60: 6060 2069 7320 6f70 7469 6d61 6c2e 2046  `` is optimal. F
+0000ff70: 6f72 206c 6172 6765 7220 6469 6d65 6e73  or larger dimens
+0000ff80: 696f 6e73 2c0a 2020 2020 2020 2020 6060  ions,.        ``
+0000ff90: 736c 6963 6560 6020 6f72 2060 6072 736c  slice`` or ``rsl
+0000ffa0: 6963 6560 6020 7368 6f75 6c64 2062 6520  ice`` should be 
+0000ffb0: 7573 6564 2e0a 0a20 2020 203a 7061 7261  used...    :para
+0000ffc0: 6d20 6479 6e65 7374 795f 6e74 6872 6561  m dynesty_nthrea
+0000ffd0: 6473 3a20 286f 7074 696f 6e61 6c2c 2069  ds: (optional, i
+0000ffe0: 6e74 290a 2020 2020 2020 2020 4465 6669  nt).        Defi
+0000fff0: 6e65 2074 6865 206e 756d 6265 7220 6f66  ne the number of
+00010000: 2074 6872 6561 6473 2074 6f20 7573 6520   threads to use 
+00010010: 7769 7468 696e 2064 796e 6573 7479 2e20  within dynesty. 
+00010020: 4465 6661 756c 7420 6973 2074 6f20 7573  Default is to us
+00010030: 6520 6a75 7374 2031 2e0a 0a20 2020 203a  e just 1...    :
+00010040: 7061 7261 6d20 6479 6e65 7374 795f 6e5f  param dynesty_n_
+00010050: 6566 6665 6374 6976 653a 2028 6f70 7469  effective: (opti
+00010060: 6f6e 616c 2c20 696e 7429 0a20 2020 2020  onal, int).     
+00010070: 2020 204d 696e 696d 756d 206e 756d 6265     Minimum numbe
+00010080: 7220 6f66 2065 6666 6563 7469 7665 2070  r of effective p
+00010090: 6f73 7465 7269 6f72 2073 616d 706c 6573  osterior samples
+000100a0: 2077 6865 6e20 7573 696e 6720 6060 6479   when using ``dy
+000100b0: 6e65 7374 7960 602e 2049 6620 7468 6520  nesty``. If the 
+000100c0: 6573 7469 6d61 7465 6420 e280 9c65 6666  estimated ...eff
+000100d0: 6563 7469 7665 2073 616d 706c 6520 7369  ective sample si
+000100e0: 7a65 e280 9d20 6578 6365 6564 7320 7468  ze... exceeds th
+000100f0: 6973 206e 756d 6265 722c 2073 616d 706c  is number, sampl
+00010100: 696e 6720 7769 6c6c 2074 6572 6d69 6e61  ing will termina
+00010110: 7465 2e20 4465 6661 756c 7420 6973 2060  te. Default is `
+00010120: 604e 6f6e 6560 602e 0a0a 2020 2020 3a70  `None``...    :p
+00010130: 6172 616d 2064 796e 6573 7479 5f75 7365  aram dynesty_use
+00010140: 5f73 746f 703a 2028 6f70 7469 6f6e 616c  _stop: (optional
+00010150: 2c20 626f 6f6c 6561 6e29 0a20 2020 2020  , boolean).     
+00010160: 2020 2057 6865 7468 6572 2074 6f20 6576     Whether to ev
+00010170: 616c 7561 7465 2074 6865 2060 6064 796e  aluate the ``dyn
+00010180: 6573 7479 6060 2073 746f 7070 696e 6720  esty`` stopping 
+00010190: 6675 6e63 7469 6f6e 2061 6674 6572 2065  function after e
+000101a0: 6163 6820 6261 7463 682e 2044 6973 6162  ach batch. Disab
+000101b0: 6c69 6e67 2074 6869 7320 6361 6e20 696d  ling this can im
+000101c0: 7072 6f76 6520 7065 7266 6f72 6d61 6e63  prove performanc
+000101d0: 6520 6966 206f 7468 6572 2073 746f 7070  e if other stopp
+000101e0: 696e 6720 6372 6974 6572 6961 2073 7563  ing criteria suc
+000101f0: 6820 6173 206d 6178 6361 6c6c 2061 7265  h as maxcall are
+00010200: 2061 6c72 6561 6479 2073 7065 6369 6669   already specifi
+00010210: 6564 2e0a 2020 2020 2020 2020 4465 6661  ed..        Defa
+00010220: 756c 7420 6973 2060 6054 7275 6560 602e  ult is ``True``.
+00010230: 0a0a 2020 2020 3a70 6172 616d 2064 796e  ..    :param dyn
+00010240: 6573 7479 5f75 7365 5f70 6f6f 6c3a 2028  esty_use_pool: (
+00010250: 6f70 7469 6f6e 616c 2c20 6469 6374 290a  optional, dict).
+00010260: 2020 2020 2020 2020 4120 6469 6374 696f          A dictio
+00010270: 6e61 7279 2063 6f6e 7461 696e 696e 6720  nary containing 
+00010280: 666c 6167 7320 696e 6469 6361 7469 6e67  flags indicating
+00010290: 2077 6865 7265 2061 2070 6f6f 6c20 696e   where a pool in
+000102a0: 2060 6064 796e 6573 7479 6060 2073 686f   ``dynesty`` sho
+000102b0: 756c 6420 6265 2075 7365 6420 746f 2065  uld be used to e
+000102c0: 7865 6375 7465 206f 7065 7261 7469 6f6e  xecute operation
+000102d0: 7320 696e 2070 6172 616c 6c65 6c2e 2054  s in parallel. T
+000102e0: 6865 7365 2067 6f76 6572 6e20 7768 6574  hese govern whet
+000102f0: 6865 7220 6060 7072 696f 725f 7472 616e  her ``prior_tran
+00010300: 7366 6f72 6d60 6020 6973 2065 7865 6375  sform`` is execu
+00010310: 7465 6420 696e 2070 6172 616c 6c65 6c20  ted in parallel 
+00010320: 6475 7269 6e67 0a20 2020 2020 2020 2069  during.        i
+00010330: 6e69 7469 616c 697a 6174 696f 6e20 2860  nitialization (`
+00010340: 6027 7072 696f 725f 7472 616e 7366 6f72  `'prior_transfor
+00010350: 6d27 6060 292c 206c 6f67 6c69 6b65 6c69  m'``), loglikeli
+00010360: 686f 6f64 2069 7320 6578 6563 7574 6564  hood is executed
+00010370: 2069 6e20 7061 7261 6c6c 656c 2064 7572   in parallel dur
+00010380: 696e 6720 696e 6974 6961 6c69 7a61 7469  ing initializati
+00010390: 6f6e 2028 6060 276c 6f67 6c69 6b65 6c69  on (``'loglikeli
+000103a0: 686f 6f64 2760 6029 2c20 6c69 7665 2070  hood'``), live p
+000103b0: 6f69 6e74 7320 6172 6520 7072 6f70 6f73  oints are propos
+000103c0: 6564 2069 6e20 7061 7261 6c6c 656c 2064  ed in parallel d
+000103d0: 7572 696e 6720 6120 7275 6e0a 2020 2020  uring a run.    
+000103e0: 2020 2020 2860 6027 7072 6f70 6f73 655f      (``'propose_
+000103f0: 706f 696e 7427 6060 292c 2061 6e64 2062  point'``), and b
+00010400: 6f75 6e64 696e 6720 6469 7374 7269 6275  ounding distribu
+00010410: 7469 6f6e 7320 6172 6520 7570 6461 7465  tions are update
+00010420: 6420 696e 2070 6172 616c 6c65 6c20 6475  d in parallel du
+00010430: 7269 6e67 2061 2072 756e 2028 6060 2775  ring a run (``'u
+00010440: 7064 6174 655f 626f 756e 6427 6060 292e  pdate_bound'``).
+00010450: 2044 6566 6175 6c74 2069 7320 5472 7565   Default is True
+00010460: 2066 6f72 2061 6c6c 206f 7074 696f 6e73   for all options
+00010470: 2e0a 0a20 2020 2022 2222 0a0a 2020 2020  ...    """..    
+00010480: 6465 6620 7365 745f 7072 696f 725f 7472  def set_prior_tr
+00010490: 616e 7366 6f72 6d28 7365 6c66 293a 0a20  ansform(self):. 
+000104a0: 2020 2020 2020 2066 6f72 2070 6e61 6d65         for pname
+000104b0: 2069 6e20 7365 6c66 2e6d 6f64 656c 5f70   in self.model_p
+000104c0: 6172 616d 6574 6572 733a 0a20 2020 2020  arameters:.     
+000104d0: 2020 2020 2020 2064 6973 745f 6e61 6d65         dist_name
+000104e0: 203d 2073 656c 662e 6461 7461 2e70 7269   = self.data.pri
+000104f0: 6f72 735b 706e 616d 655d 5b27 6469 7374  ors[pname]['dist
+00010500: 7269 6275 7469 6f6e 275d 2e6c 6f77 6572  ribution'].lower
+00010510: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
+00010520: 6620 6469 7374 5f6e 616d 6520 213d 2027  f dist_name != '
+00010530: 6669 7865 6427 3a0a 2020 2020 2020 2020  fixed':.        
+00010540: 2020 2020 2020 2020 6966 2064 6973 745f          if dist_
+00010550: 6e61 6d65 203d 3d20 2775 6e69 666f 726d  name == 'uniform
+00010560: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
+00010570: 2020 2020 2020 2073 656c 662e 7472 616e         self.tran
+00010580: 7366 6f72 6d5f 7072 696f 725b 706e 616d  sform_prior[pnam
+00010590: 655d 203d 2074 7261 6e73 666f 726d 5f75  e] = transform_u
+000105a0: 6e69 666f 726d 0a20 2020 2020 2020 2020  niform.         
+000105b0: 2020 2020 2020 2069 6620 6469 7374 5f6e         if dist_n
+000105c0: 616d 6520 3d3d 2027 6e6f 726d 616c 273a  ame == 'normal':
+000105d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000105e0: 2020 2020 2073 656c 662e 7472 616e 7366       self.transf
+000105f0: 6f72 6d5f 7072 696f 725b 706e 616d 655d  orm_prior[pname]
+00010600: 203d 2074 7261 6e73 666f 726d 5f6e 6f72   = transform_nor
+00010610: 6d61 6c0a 2020 2020 2020 2020 2020 2020  mal.            
+00010620: 2020 2020 6966 2064 6973 745f 6e61 6d65      if dist_name
+00010630: 203d 3d20 2774 7275 6e63 6174 6564 6e6f   == 'truncatedno
+00010640: 726d 616c 273a 0a20 2020 2020 2020 2020  rmal':.         
+00010650: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00010660: 7472 616e 7366 6f72 6d5f 7072 696f 725b  transform_prior[
+00010670: 706e 616d 655d 203d 2074 7261 6e73 666f  pname] = transfo
+00010680: 726d 5f74 7275 6e63 6174 6564 5f6e 6f72  rm_truncated_nor
+00010690: 6d61 6c0a 0a20 2020 2020 2020 2020 2020  mal..           
+000106a0: 2020 2020 2069 6620 7365 6c66 2e64 6174       if self.dat
+000106b0: 612e 7072 696f 7273 5b70 6e61 6d65 5d5b  a.priors[pname][
+000106c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000106d0: 2020 2020 2020 2020 2027 6469 7374 7269           'distri
+000106e0: 6275 7469 6f6e 275d 203d 3d20 276a 6566  bution'] == 'jef
+000106f0: 6672 6579 7327 206f 7220 7365 6c66 2e64  freys' or self.d
+00010700: 6174 612e 7072 696f 7273 5b0a 2020 2020  ata.priors[.    
+00010710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010720: 2020 2020 2020 2020 706e 616d 655d 5b27          pname]['
+00010730: 6469 7374 7269 6275 7469 6f6e 275d 203d  distribution'] =
+00010740: 3d20 276c 6f67 756e 6966 6f72 6d27 3a0a  = 'loguniform':.
+00010750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010760: 2020 2020 2073 656c 662e 7472 616e 7366       self.transf
+00010770: 6f72 6d5f 7072 696f 725b 706e 616d 655d  orm_prior[pname]
+00010780: 203d 2074 7261 6e73 666f 726d 5f6c 6f67   = transform_log
+00010790: 756e 6966 6f72 6d0a 2020 2020 2020 2020  uniform.        
+000107a0: 2020 2020 2020 2020 6966 2064 6973 745f          if dist_
+000107b0: 6e61 6d65 203d 3d20 2762 6574 6127 3a0a  name == 'beta':.
+000107c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000107d0: 2020 2020 7365 6c66 2e74 7261 6e73 666f      self.transfo
+000107e0: 726d 5f70 7269 6f72 5b70 6e61 6d65 5d20  rm_prior[pname] 
+000107f0: 3d20 7472 616e 7366 6f72 6d5f 6265 7461  = transform_beta
+00010800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010810: 2069 6620 6469 7374 5f6e 616d 6520 3d3d   if dist_name ==
+00010820: 2027 6578 706f 6e65 6e74 6961 6c27 3a0a   'exponential':.
+00010830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010840: 2020 2020 7365 6c66 2e74 7261 6e73 666f      self.transfo
+00010850: 726d 5f70 7269 6f72 5b70 6e61 6d65 5d20  rm_prior[pname] 
+00010860: 3d20 7472 616e 7366 6f72 6d5f 6578 706f  = transform_expo
+00010870: 6e65 6e74 6961 6c0a 2020 2020 2020 2020  nential.        
+00010880: 2020 2020 2020 2020 6966 2064 6973 745f          if dist_
+00010890: 6e61 6d65 203d 3d20 276d 6f64 6a65 6666  name == 'modjeff
+000108a0: 7265 7973 273a 0a20 2020 2020 2020 2020  reys':.         
+000108b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000108c0: 7472 616e 7366 6f72 6d5f 7072 696f 725b  transform_prior[
+000108d0: 706e 616d 655d 203d 2074 7261 6e73 666f  pname] = transfo
+000108e0: 726d 5f6d 6f64 6966 6965 646a 6566 6672  rm_modifiedjeffr
+000108f0: 6579 730a 0a20 2020 2064 6566 2073 6574  eys..    def set
+00010900: 5f6c 6f67 7072 696f 7273 2873 656c 6629  _logpriors(self)
+00010910: 3a0a 2020 2020 2020 2020 666f 7220 706e  :.        for pn
+00010920: 616d 6520 696e 2073 656c 662e 6d6f 6465  ame in self.mode
+00010930: 6c5f 7061 7261 6d65 7465 7273 3a0a 2020  l_parameters:.  
+00010940: 2020 2020 2020 2020 2020 6469 7374 5f6e            dist_n
+00010950: 616d 6520 3d20 7365 6c66 2e64 6174 612e  ame = self.data.
+00010960: 7072 696f 7273 5b70 6e61 6d65 5d5b 2764  priors[pname]['d
+00010970: 6973 7472 6962 7574 696f 6e27 5d2e 6c6f  istribution'].lo
+00010980: 7765 7228 290a 2020 2020 2020 2020 2020  wer().          
+00010990: 2020 6966 2064 6973 745f 6e61 6d65 2021    if dist_name !
+000109a0: 3d20 2766 6978 6564 273a 0a20 2020 2020  = 'fixed':.     
+000109b0: 2020 2020 2020 2020 2020 2069 6620 6469             if di
+000109c0: 7374 5f6e 616d 6520 3d3d 2027 756e 6966  st_name == 'unif
+000109d0: 6f72 6d27 3a0a 2020 2020 2020 2020 2020  orm':.          
+000109e0: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+000109f0: 7661 6c75 6174 655f 6c6f 6770 7269 6f72  valuate_logprior
+00010a00: 5b70 6e61 6d65 5d20 3d20 6576 616c 7561  [pname] = evalua
+00010a10: 7465 5f75 6e69 666f 726d 0a20 2020 2020  te_uniform.     
+00010a20: 2020 2020 2020 2020 2020 2069 6620 6469             if di
+00010a30: 7374 5f6e 616d 6520 3d3d 2027 6e6f 726d  st_name == 'norm
+00010a40: 616c 273a 0a20 2020 2020 2020 2020 2020  al':.           
+00010a50: 2020 2020 2020 2020 2073 656c 662e 6576           self.ev
+00010a60: 616c 7561 7465 5f6c 6f67 7072 696f 725b  aluate_logprior[
+00010a70: 706e 616d 655d 203d 2065 7661 6c75 6174  pname] = evaluat
+00010a80: 655f 6e6f 726d 616c 0a20 2020 2020 2020  e_normal.       
+00010a90: 2020 2020 2020 2020 2069 6620 6469 7374           if dist
+00010aa0: 5f6e 616d 6520 3d3d 2027 7472 756e 6361  _name == 'trunca
+00010ab0: 7465 646e 6f72 6d61 6c27 3a0a 2020 2020  tednormal':.    
+00010ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ad0: 7365 6c66 2e65 7661 6c75 6174 655f 6c6f  self.evaluate_lo
+00010ae0: 6770 7269 6f72 5b70 6e61 6d65 5d20 3d20  gprior[pname] = 
+00010af0: 6576 616c 7561 7465 5f74 7275 6e63 6174  evaluate_truncat
+00010b00: 6564 5f6e 6f72 6d61 6c0a 0a20 2020 2020  ed_normal..     
+00010b10: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00010b20: 6c66 2e64 6174 612e 7072 696f 7273 5b70  lf.data.priors[p
+00010b30: 6e61 6d65 5d5b 0a20 2020 2020 2020 2020  name][.         
+00010b40: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00010b50: 6469 7374 7269 6275 7469 6f6e 275d 203d  distribution'] =
+00010b60: 3d20 276a 6566 6672 6579 7327 206f 7220  = 'jeffreys' or 
+00010b70: 7365 6c66 2e64 6174 612e 7072 696f 7273  self.data.priors
+00010b80: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00010b90: 2020 2020 2020 2020 2020 2020 2020 706e                pn
+00010ba0: 616d 655d 5b27 6469 7374 7269 6275 7469  ame]['distributi
+00010bb0: 6f6e 275d 203d 3d20 276c 6f67 756e 6966  on'] == 'logunif
+00010bc0: 6f72 6d27 3a0a 0a20 2020 2020 2020 2020  orm':..         
+00010bd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00010be0: 6576 616c 7561 7465 5f6c 6f67 7072 696f  evaluate_logprio
+00010bf0: 725b 706e 616d 655d 203d 2065 7661 6c75  r[pname] = evalu
+00010c00: 6174 655f 6c6f 6775 6e69 666f 726d 0a20  ate_loguniform. 
+00010c10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00010c20: 6620 6469 7374 5f6e 616d 6520 3d3d 2027  f dist_name == '
+00010c30: 6265 7461 273a 0a20 2020 2020 2020 2020  beta':.         
+00010c40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00010c50: 6576 616c 7561 7465 5f6c 6f67 7072 696f  evaluate_logprio
+00010c60: 725b 706e 616d 655d 203d 2065 7661 6c75  r[pname] = evalu
+00010c70: 6174 655f 6265 7461 0a20 2020 2020 2020  ate_beta.       
+00010c80: 2020 2020 2020 2020 2069 6620 6469 7374           if dist
+00010c90: 5f6e 616d 6520 3d3d 2027 6578 706f 6e65  _name == 'expone
+00010ca0: 6e74 6961 6c27 3a0a 2020 2020 2020 2020  ntial':.        
+00010cb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00010cc0: 2e65 7661 6c75 6174 655f 6c6f 6770 7269  .evaluate_logpri
+00010cd0: 6f72 5b70 6e61 6d65 5d20 3d20 6576 616c  or[pname] = eval
+00010ce0: 7561 7465 5f65 7870 6f6e 656e 7469 616c  uate_exponential
+00010cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010d00: 2069 6620 6469 7374 5f6e 616d 6520 3d3d   if dist_name ==
+00010d10: 2027 6d6f 646a 6566 6672 6579 7327 3a0a   'modjeffreys':.
+00010d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d30: 2020 2020 7365 6c66 2e65 7661 6c75 6174      self.evaluat
+00010d40: 655f 6c6f 6770 7269 6f72 5b70 6e61 6d65  e_logprior[pname
+00010d50: 5d20 3d20 6576 616c 7561 7465 5f6d 6f64  ] = evaluate_mod
+00010d60: 6966 6965 646a 6566 6672 6579 730a 0a20  ifiedjeffreys.. 
+00010d70: 2020 2023 2050 7269 6f72 2074 7261 6e73     # Prior trans
+00010d80: 666f 726d 2066 6f72 206e 6573 7465 6420  form for nested 
+00010d90: 7361 6d70 6c65 7273 3a0a 2020 2020 6465  samplers:.    de
+00010da0: 6620 7072 696f 725f 7472 616e 7366 6f72  f prior_transfor
+00010db0: 6d28 7365 6c66 2c20 6375 6265 2c20 6e64  m(self, cube, nd
+00010dc0: 696d 3d4e 6f6e 652c 206e 7061 7261 6d73  im=None, nparams
+00010dd0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00010de0: 7063 6f75 6e74 6572 203d 2030 0a20 2020  pcounter = 0.   
+00010df0: 2020 2020 2066 6f72 2070 6e61 6d65 2069       for pname i
+00010e00: 6e20 7365 6c66 2e6d 6f64 656c 5f70 6172  n self.model_par
+00010e10: 616d 6574 6572 733a 0a20 2020 2020 2020  ameters:.       
+00010e20: 2020 2020 2069 6620 7365 6c66 2e64 6174       if self.dat
+00010e30: 612e 7072 696f 7273 5b70 6e61 6d65 5d5b  a.priors[pname][
+00010e40: 2764 6973 7472 6962 7574 696f 6e27 5d2e  'distribution'].
+00010e50: 6c6f 7765 7228 2920 213d 2027 6669 7865  lower() != 'fixe
+00010e60: 6427 3a0a 2020 2020 2020 2020 2020 2020  d':.            
+00010e70: 2020 2020 6375 6265 5b70 636f 756e 7465      cube[pcounte
+00010e80: 725d 203d 2073 656c 662e 7472 616e 7366  r] = self.transf
+00010e90: 6f72 6d5f 7072 696f 725b 706e 616d 655d  orm_prior[pname]
+00010ea0: 2863 7562 655b 7063 6f75 6e74 6572 5d2c  (cube[pcounter],
+00010eb0: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+00010ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ed0: 2020 2020 7365 6c66 2e64 6174 612e 7072      self.data.pr
+00010ee0: 696f 7273 5b70 6e61 6d65 5d5b 2768 7970  iors[pname]['hyp
+00010ef0: 6572 7061 7261 6d65 7465 7273 275d 290a  erparameters']).
+00010f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010f10: 7063 6f75 6e74 6572 202b 3d20 310a 0a20  pcounter += 1.. 
+00010f20: 2020 2023 2050 7269 6f72 2074 7261 6e73     # Prior trans
+00010f30: 666f 726d 2066 6f72 206e 6573 7465 6420  form for nested 
+00010f40: 7361 6d70 6c65 7273 2028 7468 6973 206f  samplers (this o
+00010f50: 6e65 2073 7069 7473 2074 6865 2074 7261  ne spits the tra
+00010f60: 6e73 666f 726d 6564 2070 7269 6f72 7320  nsformed priors 
+00010f70: 6672 6f6d 2074 6865 2075 6e69 7420 6375  from the unit cu
+00010f80: 6265 293a 0a20 2020 2064 6566 2070 7269  be):.    def pri
+00010f90: 6f72 5f74 7261 6e73 666f 726d 5f72 2873  or_transform_r(s
+00010fa0: 656c 662c 2063 7562 6529 3a0a 2020 2020  elf, cube):.    
+00010fb0: 2020 2020 7063 6f75 6e74 6572 203d 2030      pcounter = 0
+00010fc0: 0a20 2020 2020 2020 2074 7261 6e73 666f  .        transfo
+00010fd0: 726d 6564 5f70 7269 6f72 7320 3d20 6e70  rmed_priors = np
+00010fe0: 2e63 6f70 7928 7365 6c66 2e74 7261 6e73  .copy(self.trans
+00010ff0: 666f 726d 6564 5f70 7269 6f72 7329 0a20  formed_priors). 
+00011000: 2020 2020 2020 2066 6f72 2070 6e61 6d65         for pname
+00011010: 2069 6e20 7365 6c66 2e6d 6f64 656c 5f70   in self.model_p
+00011020: 6172 616d 6574 6572 733a 0a20 2020 2020  arameters:.     
+00011030: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
+00011040: 6174 612e 7072 696f 7273 5b70 6e61 6d65  ata.priors[pname
+00011050: 5d5b 2764 6973 7472 6962 7574 696f 6e27  ]['distribution'
+00011060: 5d2e 6c6f 7765 7228 2920 213d 2027 6669  ].lower() != 'fi
+00011070: 7865 6427 3a0a 2020 2020 2020 2020 2020  xed':.          
+00011080: 2020 2020 2020 7472 616e 7366 6f72 6d65        transforme
+00011090: 645f 7072 696f 7273 5b70 636f 756e 7465  d_priors[pcounte
+000110a0: 725d 203d 2073 656c 662e 7472 616e 7366  r] = self.transf
+000110b0: 6f72 6d5f 7072 696f 725b 706e 616d 655d  orm_prior[pname]
+000110c0: 2863 7562 655b 7063 6f75 6e74 6572 5d2c  (cube[pcounter],
+000110d0: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+000110e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000110f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011100: 2020 7365 6c66 2e64 6174 612e 7072 696f    self.data.prio
+00011110: 7273 5b70 6e61 6d65 5d5b 2768 7970 6572  rs[pname]['hyper
+00011120: 7061 7261 6d65 7465 7273 275d 290a 2020  parameters']).  
+00011130: 2020 2020 2020 2020 2020 2020 2020 7063                pc
+00011140: 6f75 6e74 6572 202b 3d20 310a 2020 2020  ounter += 1.    
+00011150: 2020 2020 7265 7475 726e 2074 7261 6e73      return trans
+00011160: 666f 726d 6564 5f70 7269 6f72 730a 0a20  formed_priors.. 
+00011170: 2020 2023 204c 6f67 2d70 7269 6f72 2066     # Log-prior f
+00011180: 6f72 204d 434d 4373 2028 7265 7475 726e  or MCMCs (return
+00011190: 7320 6576 616c 7561 7465 6420 7072 696f  s evaluated prio
+000111a0: 7229 3a0a 2020 2020 6465 6620 6c6f 6770  r):.    def logp
+000111b0: 7269 6f72 2873 656c 662c 2074 6865 7461  rior(self, theta
+000111c0: 293a 0a20 2020 2020 2020 2070 636f 756e  ):.        pcoun
+000111d0: 7465 7220 3d20 300a 2020 2020 2020 2020  ter = 0.        
+000111e0: 746f 7461 6c5f 6c6f 6770 7269 6f72 203d  total_logprior =
+000111f0: 2030 2e0a 2020 2020 2020 2020 666f 7220   0..        for 
+00011200: 706e 616d 6520 696e 2073 656c 662e 6d6f  pname in self.mo
+00011210: 6465 6c5f 7061 7261 6d65 7465 7273 3a0a  del_parameters:.
+00011220: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00011230: 656c 662e 6461 7461 2e70 7269 6f72 735b  elf.data.priors[
+00011240: 706e 616d 655d 5b27 6469 7374 7269 6275  pname]['distribu
+00011250: 7469 6f6e 275d 2e6c 6f77 6572 2829 2021  tion'].lower() !
+00011260: 3d20 2766 6978 6564 273a 0a20 2020 2020  = 'fixed':.     
+00011270: 2020 2020 2020 2020 2020 2074 6f74 616c             total
+00011280: 5f6c 6f67 7072 696f 7220 2b3d 2073 656c  _logprior += sel
+00011290: 662e 6576 616c 7561 7465 5f6c 6f67 7072  f.evaluate_logpr
+000112a0: 696f 725b 706e 616d 655d 2874 6865 7461  ior[pname](theta
+000112b0: 5b70 636f 756e 7465 725d 2c20 5c0a 2020  [pcounter], \.  
+000112c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000112d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000112e0: 7365 6c66 2e64 6174 612e 7072 696f 7273  self.data.priors
+000112f0: 5b70 6e61 6d65 5d5b 2768 7970 6572 7061  [pname]['hyperpa
+00011300: 7261 6d65 7465 7273 275d 290a 2020 2020  rameters']).    
+00011310: 2020 2020 2020 2020 2020 2020 7063 6f75              pcou
+00011320: 6e74 6572 202b 3d20 310a 2020 2020 2020  nter += 1.      
+00011330: 2020 7265 7475 726e 2074 6f74 616c 5f6c    return total_l
+00011340: 6f67 7072 696f 720a 0a20 2020 2064 6566  ogprior..    def
+00011350: 206c 6f67 6c69 6b65 2873 656c 662c 2063   loglike(self, c
+00011360: 7562 652c 206e 6469 6d3d 4e6f 6e65 2c20  ube, ndim=None, 
+00011370: 6e70 6172 616d 733d 4e6f 6e65 293a 0a20  nparams=None):. 
+00011380: 2020 2020 2020 2023 2045 7661 6c75 6174         # Evaluat
+00011390: 6520 7468 6520 6a6f 696e 7420 6c6f 672d  e the joint log-
+000113a0: 6c69 6b65 6c69 686f 6f64 2e20 466f 7220  likelihood. For 
+000113b0: 7468 6973 2c20 6669 7273 7420 6578 7472  this, first extr
+000113c0: 6163 7420 616c 6c20 696e 7075 7473 3a0a  act all inputs:.
+000113d0: 2020 2020 2020 2020 7063 6f75 6e74 6572          pcounter
+000113e0: 203d 2030 0a20 2020 2020 2020 2066 6f72   = 0.        for
+000113f0: 2070 6e61 6d65 2069 6e20 7365 6c66 2e6d   pname in self.m
+00011400: 6f64 656c 5f70 6172 616d 6574 6572 733a  odel_parameters:
+00011410: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00011420: 7365 6c66 2e64 6174 612e 7072 696f 7273  self.data.priors
+00011430: 5b70 6e61 6d65 5d5b 2764 6973 7472 6962  [pname]['distrib
+00011440: 7574 696f 6e27 5d2e 6c6f 7765 7228 2920  ution'].lower() 
+00011450: 213d 2027 6669 7865 6427 3a0a 2020 2020  != 'fixed':.    
+00011460: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00011470: 2e70 6f73 7465 7269 6f72 735b 706e 616d  .posteriors[pnam
+00011480: 655d 203d 2063 7562 655b 7063 6f75 6e74  e] = cube[pcount
+00011490: 6572 5d0a 2020 2020 2020 2020 2020 2020  er].            
+000114a0: 2020 2020 7063 6f75 6e74 6572 202b 3d20      pcounter += 
+000114b0: 310a 2020 2020 2020 2020 2320 496e 6974  1.        # Init
+000114c0: 6961 6c69 7a65 206c 6f67 2d6c 696b 656c  ialize log-likel
+000114d0: 6968 6f6f 643a 0a20 2020 2020 2020 206c  ihood:.        l
+000114e0: 6f67 5f6c 696b 656c 6968 6f6f 6420 3d20  og_likelihood = 
+000114f0: 302e 300a 0a20 2020 2020 2020 2023 2045  0.0..        # E
+00011500: 7661 6c75 6174 6520 7068 6f74 6f6d 6574  valuate photomet
+00011510: 7269 6320 6d6f 6465 6c20 6669 7273 743a  ric model first:
+00011520: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00011530: 2e64 6174 612e 745f 6c63 2069 7320 6e6f  .data.t_lc is no
+00011540: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00011550: 2020 2020 7365 6c66 2e6c 632e 6765 6e65      self.lc.gene
+00011560: 7261 7465 2873 656c 662e 706f 7374 6572  rate(self.poster
+00011570: 696f 7273 290a 2020 2020 2020 2020 2020  iors).          
+00011580: 2020 6966 2073 656c 662e 6c63 2e6d 6f64    if self.lc.mod
+00011590: 656c 4f4b 3a0a 2020 2020 2020 2020 2020  elOK:.          
+000115a0: 2020 2020 2020 6c6f 675f 6c69 6b65 6c69        log_likeli
+000115b0: 686f 6f64 202b 3d20 7365 6c66 2e6c 632e  hood += self.lc.
+000115c0: 6765 745f 6c6f 675f 6c69 6b65 6c69 686f  get_log_likeliho
+000115d0: 6f64 2873 656c 662e 706f 7374 6572 696f  od(self.posterio
+000115e0: 7273 290a 2020 2020 2020 2020 2020 2020  rs).            
+000115f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00011600: 2020 2020 2020 7265 7475 726e 202d 3165        return -1e
+00011610: 3130 310a 2020 2020 2020 2020 2320 4e6f  101.        # No
+00011620: 7720 5256 206d 6f64 656c 3a0a 2020 2020  w RV model:.    
+00011630: 2020 2020 6966 2073 656c 662e 6461 7461      if self.data
+00011640: 2e74 5f72 7620 6973 206e 6f74 204e 6f6e  .t_rv is not Non
+00011650: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00011660: 656c 662e 7276 2e67 656e 6572 6174 6528  elf.rv.generate(
+00011670: 7365 6c66 2e70 6f73 7465 7269 6f72 7329  self.posteriors)
+00011680: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00011690: 7365 6c66 2e72 762e 6d6f 6465 6c4f 4b3a  self.rv.modelOK:
+000116a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000116b0: 206c 6f67 5f6c 696b 656c 6968 6f6f 6420   log_likelihood 
+000116c0: 2b3d 2073 656c 662e 7276 2e67 6574 5f6c  += self.rv.get_l
+000116d0: 6f67 5f6c 696b 656c 6968 6f6f 6428 7365  og_likelihood(se
+000116e0: 6c66 2e70 6f73 7465 7269 6f72 7329 0a20  lf.posteriors). 
+000116f0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00011700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011710: 2072 6574 7572 6e20 2d31 6531 3031 0a20   return -1e101. 
+00011720: 2020 2020 2020 2023 2052 6574 7572 6e20         # Return 
+00011730: 746f 7461 6c20 6c6f 672d 6c69 6b65 6c69  total log-likeli
+00011740: 686f 6f64 3a0a 2020 2020 2020 2020 7265  hood:.        re
+00011750: 7475 726e 206c 6f67 5f6c 696b 656c 6968  turn log_likelih
+00011760: 6f6f 640a 0a20 2020 2023 204c 6f67 2d70  ood..    # Log-p
+00011770: 726f 6261 6269 6c69 7479 2066 6f72 204d  robability for M
+00011780: 434d 4320 7361 6d70 6c65 7273 3a0a 2020  CMC samplers:.  
+00011790: 2020 6465 6620 6c6f 6770 726f 6228 7365    def logprob(se
+000117a0: 6c66 2c20 7468 6574 6129 3a0a 2020 2020  lf, theta):.    
+000117b0: 2020 2020 6c70 203d 2073 656c 662e 6c6f      lp = self.lo
+000117c0: 6770 7269 6f72 2874 6865 7461 2920 2b20  gprior(theta) + 
+000117d0: 7365 6c66 2e6c 6f67 6c69 6b65 2874 6865  self.loglike(the
+000117e0: 7461 290a 2020 2020 2020 2020 6966 206e  ta).        if n
+000117f0: 702e 6973 6e61 6e28 6c70 293a 0a20 2020  p.isnan(lp):.   
+00011800: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00011810: 2d6e 702e 696e 660a 2020 2020 2020 2020  -np.inf.        
+00011820: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00011830: 2020 7265 7475 726e 206c 700a 0a20 2020    return lp..   
+00011840: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+00011850: 6c66 2c20 6461 7461 2c20 7361 6d70 6c65  lf, data, sample
+00011860: 7220 3d20 276d 756c 7469 6e65 7374 272c  r = 'multinest',
+00011870: 206e 5f6c 6976 655f 706f 696e 7473 203d   n_live_points =
+00011880: 2035 3030 2c20 6e77 616c 6b65 7273 203d   500, nwalkers =
+00011890: 2031 3030 2c20 6e73 7465 7073 203d 2033   100, nsteps = 3
+000118a0: 3030 2c20 6e62 7572 6e69 6e20 3d20 3530  00, nburnin = 50
+000118b0: 302c 2065 6d63 6565 5f66 6163 746f 7220  0, emcee_factor 
+000118c0: 3d20 3165 2d34 2c20 5c0a 2020 2020 2020  = 1e-4, \.      
+000118d0: 2020 2020 2020 2020 2020 2065 6363 6c69             eccli
+000118e0: 6d20 3d20 312e 2c20 706c 203d 2030 2e30  m = 1., pl = 0.0
+000118f0: 2c20 7075 203d 2031 2e30 2c20 7461 203d  , pu = 1.0, ta =
+00011900: 2032 3435 3834 3630 2e2c 206e 7468 7265   2458460., nthre
+00011910: 6164 7320 3d20 4e6f 6e65 2c20 6c69 6768  ads = None, ligh
+00011920: 745f 7472 6176 656c 5f64 656c 6179 203d  t_travel_delay =
+00011930: 2046 616c 7365 2c20 7374 656c 6c61 725f   False, stellar_
+00011940: 7261 6469 7573 203d 204e 6f6e 652c 205c  radius = None, \
+00011950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011960: 2020 7573 655f 756c 7472 616e 6573 7420    use_ultranest 
+00011970: 3d20 4661 6c73 652c 2075 7365 5f64 796e  = False, use_dyn
+00011980: 6573 7479 203d 2046 616c 7365 2c20 6479  esty = False, dy
+00011990: 6e61 6d69 6320 3d20 4661 6c73 652c 2064  namic = False, d
+000119a0: 796e 6573 7479 5f62 6f75 6e64 203d 2027  ynesty_bound = '
+000119b0: 6d75 6c74 6927 2c20 6479 6e65 7374 795f  multi', dynesty_
+000119c0: 7361 6d70 6c65 3d27 7277 616c 6b27 2c20  sample='rwalk', 
+000119d0: 6479 6e65 7374 795f 6e74 6872 6561 6473  dynesty_nthreads
+000119e0: 203d 204e 6f6e 652c 205c 0a20 2020 2020   = None, \.     
+000119f0: 2020 2020 2020 2020 2020 2020 6479 6e65              dyne
+00011a00: 7374 795f 6e5f 6566 6665 6374 6976 6520  sty_n_effective 
+00011a10: 3d20 6e70 2e69 6e66 2c20 6479 6e65 7374  = np.inf, dynest
+00011a20: 795f 7573 655f 7374 6f70 203d 2054 7275  y_use_stop = Tru
+00011a30: 652c 2064 796e 6573 7479 5f75 7365 5f70  e, dynesty_use_p
+00011a40: 6f6f 6c20 3d20 4e6f 6e65 2c20 2a2a 6b77  ool = None, **kw
+00011a50: 6172 6773 293a 0a0a 2020 2020 2020 2020  args):..        
+00011a60: 2320 4465 6669 6e65 206f 7574 7075 7420  # Define output 
+00011a70: 7265 7375 6c74 7320 6f62 6a65 6374 3a0a  results object:.
+00011a80: 2020 2020 2020 2020 7365 6c66 2e72 6573          self.res
+00011a90: 756c 7473 203d 204e 6f6e 650a 0a20 2020  ults = None..   
+00011aa0: 2020 2020 2023 2053 6176 6520 7361 6d70       # Save samp
+00011ab0: 6c65 7220 696e 7075 7473 2069 6e20 6361  ler inputs in ca
+00011ac0: 7365 2075 7365 7273 2061 7265 2073 7469  se users are sti
+00011ad0: 6c6c 2075 7369 6e67 206f 6c64 2064 6566  ll using old def
+00011ae0: 696e 6974 696f 6e73 0a20 2020 2020 2020  initions.       
+00011af0: 2073 656c 662e 7573 655f 756c 7472 616e   self.use_ultran
+00011b00: 6573 7420 3d20 7573 655f 756c 7472 616e  est = use_ultran
+00011b10: 6573 740a 2020 2020 2020 2020 7365 6c66  est.        self
+00011b20: 2e75 7365 5f64 796e 6573 7479 203d 2075  .use_dynesty = u
+00011b30: 7365 5f64 796e 6573 7479 0a20 2020 2020  se_dynesty.     
+00011b40: 2020 2073 656c 662e 6479 6e61 6d69 6320     self.dynamic 
+00011b50: 3d20 6479 6e61 6d69 630a 2020 2020 2020  = dynamic.      
+00011b60: 2020 7365 6c66 2e64 796e 6573 7479 5f62    self.dynesty_b
+00011b70: 6f75 6e64 203d 2064 796e 6573 7479 5f62  ound = dynesty_b
+00011b80: 6f75 6e64 0a20 2020 2020 2020 2073 656c  ound.        sel
+00011b90: 662e 6479 6e65 7374 795f 7361 6d70 6c65  f.dynesty_sample
+00011ba0: 203d 2064 796e 6573 7479 5f73 616d 706c   = dynesty_sampl
+00011bb0: 650a 2020 2020 2020 2020 7365 6c66 2e64  e.        self.d
+00011bc0: 796e 6573 7479 5f6e 7468 7265 6164 7320  ynesty_nthreads 
+00011bd0: 3d20 6479 6e65 7374 795f 6e74 6872 6561  = dynesty_nthrea
+00011be0: 6473 0a20 2020 2020 2020 2073 656c 662e  ds.        self.
+00011bf0: 6479 6e65 7374 795f 6e5f 6566 6665 6374  dynesty_n_effect
+00011c00: 6976 6520 3d20 6479 6e65 7374 795f 6e5f  ive = dynesty_n_
+00011c10: 6566 6665 6374 6976 650a 2020 2020 2020  effective.      
+00011c20: 2020 7365 6c66 2e64 796e 6573 7479 5f75    self.dynesty_u
+00011c30: 7365 5f73 746f 7020 3d20 6479 6e65 7374  se_stop = dynest
+00011c40: 795f 7573 655f 7374 6f70 0a20 2020 2020  y_use_stop.     
+00011c50: 2020 2073 656c 662e 6479 6e65 7374 795f     self.dynesty_
+00011c60: 7573 655f 706f 6f6c 203d 2064 796e 6573  use_pool = dynes
+00011c70: 7479 5f75 7365 5f70 6f6f 6c0a 0a20 2020  ty_use_pool..   
+00011c80: 2020 2020 2023 204e 6f77 2065 7874 7261       # Now extra
+00011c90: 6374 2073 616d 706c 6572 206f 7074 696f  ct sampler optio
+00011ca0: 6e73 3a0a 2020 2020 2020 2020 7365 6c66  ns:.        self
+00011cb0: 2e73 616d 706c 6572 203d 2073 616d 706c  .sampler = sampl
+00011cc0: 6572 0a20 2020 2020 2020 2073 656c 662e  er.        self.
+00011cd0: 6e5f 6c69 7665 5f70 6f69 6e74 7320 3d20  n_live_points = 
+00011ce0: 6e5f 6c69 7665 5f70 6f69 6e74 730a 2020  n_live_points.  
+00011cf0: 2020 2020 2020 7365 6c66 2e6e 7761 6c6b        self.nwalk
+00011d00: 6572 7320 3d20 6e77 616c 6b65 7273 0a20  ers = nwalkers. 
+00011d10: 2020 2020 2020 2073 656c 662e 6e73 7465         self.nste
+00011d20: 7073 203d 206e 7374 6570 730a 2020 2020  ps = nsteps.    
+00011d30: 2020 2020 7365 6c66 2e65 6d63 6565 5f66      self.emcee_f
+00011d40: 6163 746f 7220 3d20 656d 6365 655f 6661  actor = emcee_fa
+00011d50: 6374 6f72 0a20 2020 2020 2020 2073 656c  ctor.        sel
+00011d60: 662e 6e62 7572 6e69 6e20 3d20 6e62 7572  f.nburnin = nbur
+00011d70: 6e69 6e0a 2020 2020 2020 2020 7365 6c66  nin.        self
+00011d80: 2e6e 7468 7265 6164 7320 3d20 6e74 6872  .nthreads = nthr
+00011d90: 6561 6473 0a0a 2020 2020 2020 2020 2320  eads..        # 
+00011da0: 4578 7472 6163 7420 7068 7973 6963 616c  Extract physical
+00011db0: 206d 6f64 656c 2064 6574 6169 6c73 3a0a   model details:.
+00011dc0: 2020 2020 2020 2020 7365 6c66 2e6c 6967          self.lig
+00011dd0: 6874 5f74 7261 7665 6c5f 6465 6c61 7920  ht_travel_delay 
+00011de0: 3d20 6c69 6768 745f 7472 6176 656c 5f64  = light_travel_d
+00011df0: 656c 6179 0a20 2020 2020 2020 2069 6620  elay.        if 
+00011e00: 7365 6c66 2e6c 6967 6874 5f74 7261 7665  self.light_trave
+00011e10: 6c5f 6465 6c61 7920 616e 6420 2873 7465  l_delay and (ste
+00011e20: 6c6c 6172 5f72 6164 6975 7320 6973 204e  llar_radius is N
+00011e30: 6f6e 6529 3a0a 0a20 2020 2020 2020 2020  one):..         
+00011e40: 2020 2072 6169 7365 2045 7863 6570 7469     raise Excepti
+00011e50: 6f6e 2827 4572 726f 723a 2069 6620 6c69  on('Error: if li
+00011e60: 6768 745f 7472 6176 656c 5f64 656c 6179  ght_travel_delay
+00011e70: 2069 7320 6163 7469 7661 7465 642c 2061   is activated, a
+00011e80: 2073 7465 6c6c 6172 2072 6164 6975 7320   stellar radius 
+00011e90: 6e65 6564 7320 746f 2062 6520 6769 7665  needs to be give
+00011ea0: 6e20 6173 2077 656c 6c20 7669 6120 7374  n as well via st
+00011eb0: 656c 6c61 725f 7261 6469 7573 203d 2079  ellar_radius = y
+00011ec0: 6f75 7276 616c 7565 3b20 652e 672e 2c20  ourvalue; e.g., 
+00011ed0: 6461 7461 7365 742e 6669 7428 2e2e 2e2c  dataset.fit(...,
+00011ee0: 206c 6967 6874 5f74 7261 7665 6c5f 6465   light_travel_de
+00011ef0: 6c61 7920 3d20 5472 7565 2c20 7374 656c  lay = True, stel
+00011f00: 6c61 725f 7261 6469 7573 203d 2031 2e31  lar_radius = 1.1
+00011f10: 3233 3429 2e27 290a 2020 2020 2020 2020  234).').        
+00011f20: 0a20 2020 2020 2020 2073 656c 662e 7374  .        self.st
+00011f30: 656c 6c61 725f 7261 6469 7573 203d 2073  ellar_radius = s
+00011f40: 7465 6c6c 6172 5f72 6164 6975 730a 0a20  tellar_radius.. 
+00011f50: 2020 2020 2020 2023 2055 7064 6174 6520         # Update 
+00011f60: 7361 6d70 6c65 7220 696e 7075 7473 2069  sampler inputs i
+00011f70: 6e20 6361 7365 2075 7365 7220 7374 696c  n case user stil
+00011f80: 6c20 7573 696e 6720 6465 7072 6563 6174  l using deprecat
+00011f90: 6564 2069 6e70 7574 732e 2057 6527 6c6c  ed inputs. We'll
+00011fa0: 2072 656d 6f76 6520 7468 6973 2069 6e20   remove this in 
+00011fb0: 736f 6d65 2066 7574 7572 652e 2046 6972  some future. Fir
+00011fc0: 7374 2c20 6465 6669 6e65 2073 7461 6e64  st, define stand
+00011fd0: 6172 6420 7072 652d 6669 7820 616e 6420  ard pre-fix and 
+00011fe0: 7375 6669 7820 666f 7220 7468 6520 7761  sufix for the wa
+00011ff0: 726e 696e 6773 3a0a 2020 2020 2020 2020  rnings:.        
+00012000: 7773 3120 3d20 2757 4152 4e49 4e47 3a20  ws1 = 'WARNING: 
+00012010: 7573 6520 6f66 2074 6865 2027 0a20 2020  use of the '.   
+00012020: 2020 2020 2077 7332 203d 2027 2061 7267       ws2 = ' arg
+00012030: 756d 656e 7420 6973 2064 6570 7265 6361  ument is depreca
+00012040: 7465 6420 616e 6420 7769 6c6c 2062 6520  ted and will be 
+00012050: 7265 6d6f 7665 6420 696e 2066 7574 7572  removed in futur
+00012060: 6520 6a75 6c69 6574 2076 6572 7369 6f6e  e juliet version
+00012070: 732e 2055 7365 2074 6865 2027 0a20 2020  s. Use the '.   
+00012080: 2020 2020 2077 7333 203d 2027 2069 6e73       ws3 = ' ins
+00012090: 7465 6164 3b20 666f 7220 6d6f 7265 2069  tead; for more i
+000120a0: 6e66 6f72 6d61 7469 6f6e 2c20 6368 6563  nformation, chec
+000120b0: 6b20 7468 6520 4150 4920 6f66 206a 756c  k the API of jul
+000120c0: 6965 742e 6669 743a 2068 7474 7073 3a2f  iet.fit: https:/
+000120d0: 2f6a 756c 6965 742e 7265 6164 7468 6564  /juliet.readthed
+000120e0: 6f63 732e 696f 2f65 6e2f 6c61 7465 7374  ocs.io/en/latest
+000120f0: 2f75 7365 722f 6170 692e 6874 6d6c 236a  /user/api.html#j
+00012100: 756c 6965 742e 6669 7427 0a20 2020 2020  uliet.fit'.     
+00012110: 2020 2069 6620 7365 6c66 2e75 7365 5f75     if self.use_u
+00012120: 6c74 7261 6e65 7374 3a0a 2020 2020 2020  ltranest:.      
+00012130: 2020 2020 2020 7365 6c66 2e73 616d 706c        self.sampl
+00012140: 6572 203d 2027 756c 7472 616e 6573 7427  er = 'ultranest'
+00012150: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00012160: 6e74 2877 7331 202b 2027 7573 655f 756c  nt(ws1 + 'use_ul
+00012170: 7472 616e 6573 7427 202b 2077 7332 202b  tranest' + ws2 +
+00012180: 2027 2273 616d 706c 6572 2220 7374 7269   '"sampler" stri
+00012190: 6e67 2720 2b20 7773 3329 0a20 2020 2020  ng' + ws3).     
+000121a0: 2020 2069 6620 7365 6c66 2e75 7365 5f64     if self.use_d
+000121b0: 796e 6573 7479 3a0a 2020 2020 2020 2020  ynesty:.        
+000121c0: 2020 2020 7072 696e 7428 7773 3120 2b20      print(ws1 + 
+000121d0: 2775 7365 5f64 796e 6573 7479 2720 2b20  'use_dynesty' + 
+000121e0: 7773 3220 2b20 2722 7361 6d70 6c65 7222  ws2 + '"sampler"
+000121f0: 2073 7472 696e 6727 202b 2077 7333 290a   string' + ws3).
+00012200: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00012210: 2e73 616d 706c 6572 203d 2027 6479 6e65  .sampler = 'dyne
+00012220: 7374 7927 0a20 2020 2020 2020 2020 2020  sty'.           
+00012230: 2069 6620 7365 6c66 2e64 796e 616d 6963   if self.dynamic
+00012240: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00012250: 2020 7365 6c66 2e73 616d 706c 6572 203d    self.sampler =
+00012260: 2027 6479 6e61 6d69 635f 6479 6e65 7374   'dynamic_dynest
+00012270: 7927 0a20 2020 2020 2020 2020 2020 2020  y'.             
+00012280: 2020 2070 7269 6e74 2877 7331 202b 2027     print(ws1 + '
+00012290: 6479 6e61 6d69 6327 202b 2077 7332 202b  dynamic' + ws2 +
+000122a0: 2027 2273 616d 706c 6572 2220 7374 7269   '"sampler" stri
+000122b0: 6e67 2720 2b20 7773 3329 0a20 2020 2020  ng' + ws3).     
+000122c0: 2020 2020 2020 2023 2041 6464 2074 6865         # Add the
+000122d0: 206f 7468 6572 2064 6570 7265 6361 7465   other deprecate
+000122e0: 6420 666c 6167 7320 746f 2074 6865 206b  d flags to the k
+000122f0: 7761 7267 733a 0a20 2020 2020 2020 2020  wargs:.         
+00012300: 2020 2069 6620 7365 6c66 2e64 796e 6573     if self.dynes
+00012310: 7479 5f62 6f75 6e64 2021 3d20 276d 756c  ty_bound != 'mul
+00012320: 7469 273a 0a20 2020 2020 2020 2020 2020  ti':.           
+00012330: 2020 2020 2070 7269 6e74 2877 7331 202b       print(ws1 +
+00012340: 2027 6479 6e65 7374 795f 626f 756e 6427   'dynesty_bound'
+00012350: 202b 2077 7332 202b 2027 2262 6f75 6e64   + ws2 + '"bound
+00012360: 2220 6172 6775 6d65 6e74 2720 2b20 7773  " argument' + ws
+00012370: 3329 0a20 2020 2020 2020 2020 2020 2020  3).             
+00012380: 2020 2023 206b 7761 7267 7320 7461 6b65     # kwargs take
+00012390: 2070 7265 7365 6465 6e63 653a 0a20 2020   presedence:.   
+000123a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000123b0: 2762 6f75 6e64 2720 6e6f 7420 696e 206b  'bound' not in k
+000123c0: 7761 7267 732e 6b65 7973 2829 3a0a 2020  wargs.keys():.  
+000123d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000123e0: 2020 6b77 6172 6773 5b27 626f 756e 6427    kwargs['bound'
+000123f0: 5d20 3d20 7365 6c66 2e64 796e 6573 7479  ] = self.dynesty
+00012400: 5f62 6f75 6e64 0a20 2020 2020 2020 2020  _bound.         
+00012410: 2020 2069 6620 7365 6c66 2e64 796e 6573     if self.dynes
+00012420: 7479 5f73 616d 706c 6520 213d 2027 7277  ty_sample != 'rw
+00012430: 616c 6b27 3a0a 2020 2020 2020 2020 2020  alk':.          
+00012440: 2020 2020 2020 7072 696e 7428 7773 3120        print(ws1 
+00012450: 2b20 2764 796e 6573 7479 5f73 616d 706c  + 'dynesty_sampl
+00012460: 6527 202b 2077 7332 202b 2027 2273 616d  e' + ws2 + '"sam
+00012470: 706c 6522 2061 7267 756d 656e 7427 202b  ple" argument' +
+00012480: 2077 7333 290a 2020 2020 2020 2020 2020   ws3).          
+00012490: 2020 2020 2020 2320 6b77 6172 6773 2074        # kwargs t
+000124a0: 616b 6520 7072 6573 6564 656e 6365 3a0a  ake presedence:.
+000124b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000124c0: 6966 2027 7361 6d70 6c65 2720 6e6f 7420  if 'sample' not 
+000124d0: 696e 206b 7761 7267 732e 6b65 7973 2829  in kwargs.keys()
+000124e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000124f0: 2020 2020 2020 6b77 6172 6773 5b27 7361        kwargs['sa
+00012500: 6d70 6c65 275d 203d 2073 656c 662e 6479  mple'] = self.dy
+00012510: 6e65 7374 795f 7361 6d70 6c65 0a20 2020  nesty_sample.   
+00012520: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00012530: 2e64 796e 6573 7479 5f6e 7468 7265 6164  .dynesty_nthread
+00012540: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+00012550: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00012560: 7269 6e74 2877 7331 202b 2027 6479 6e65  rint(ws1 + 'dyne
+00012570: 7374 795f 6e74 6872 6561 6473 2720 2b20  sty_nthreads' + 
+00012580: 7773 3220 2b20 2722 6e74 6872 6561 6473  ws2 + '"nthreads
+00012590: 2220 6172 6775 6d65 6e74 2720 2b0a 2020  " argument' +.  
+000125a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000125b0: 2020 2020 7773 3329 0a20 2020 2020 2020      ws3).       
+000125c0: 2020 2020 2020 2020 2023 2054 6865 206e           # The n
+000125d0: 7468 7265 6164 7320 6172 6775 6d65 6e74  threads argument
+000125e0: 2074 616b 6573 2070 7265 7365 6465 6e63   takes presedenc
+000125f0: 6520 6e6f 773a 0a20 2020 2020 2020 2020  e now:.         
+00012600: 2020 2020 2020 2069 6620 6e74 6872 6561         if nthrea
+00012610: 6473 2069 7320 4e6f 6e65 3a0a 2020 2020  ds is None:.    
+00012620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012630: 7365 6c66 2e6e 7468 7265 6164 7320 3d20  self.nthreads = 
+00012640: 7365 6c66 2e64 796e 6573 7479 5f6e 7468  self.dynesty_nth
+00012650: 7265 6164 730a 2020 2020 2020 2020 2020  reads.          
+00012660: 2020 6966 2073 656c 662e 6479 6e65 7374    if self.dynest
+00012670: 795f 6e5f 6566 6665 6374 6976 6520 6973  y_n_effective is
+00012680: 206e 6f74 206e 702e 696e 663a 0a20 2020   not np.inf:.   
+00012690: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+000126a0: 6e74 2877 7331 202b 2027 6479 6e65 7374  nt(ws1 + 'dynest
+000126b0: 795f 6e5f 6566 6665 6374 6976 6527 202b  y_n_effective' +
+000126c0: 2077 7332 202b 0a20 2020 2020 2020 2020   ws2 +.         
+000126d0: 2020 2020 2020 2020 2020 2020 2027 226e               '"n
+000126e0: 5f65 6666 6563 7469 7665 2220 6172 6775  _effective" argu
+000126f0: 6d65 6e74 2720 2b20 7773 3329 0a20 2020  ment' + ws3).   
+00012700: 2020 2020 2020 2020 2020 2020 2023 206b               # k
+00012710: 7761 7267 7320 7461 6b65 2070 7265 7365  wargs take prese
+00012720: 6465 6e63 653a 0a20 2020 2020 2020 2020  dence:.         
+00012730: 2020 2020 2020 2069 6620 276e 5f65 6666         if 'n_eff
+00012740: 6563 7469 7665 2720 6e6f 7420 696e 206b  ective' not in k
+00012750: 7761 7267 732e 6b65 7973 2829 3a0a 2020  wargs.keys():.  
+00012760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012770: 2020 6b77 6172 6773 5b27 6e5f 6566 6665    kwargs['n_effe
+00012780: 6374 6976 6527 5d20 3d20 7365 6c66 2e64  ctive'] = self.d
+00012790: 796e 6573 7479 5f6e 5f65 6666 6563 7469  ynesty_n_effecti
+000127a0: 7665 0a20 2020 2020 2020 2020 2020 2069  ve.            i
+000127b0: 6620 6e6f 7420 7365 6c66 2e64 796e 6573  f not self.dynes
+000127c0: 7479 5f75 7365 5f73 746f 703a 0a20 2020  ty_use_stop:.   
+000127d0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+000127e0: 6e74 2877 7331 202b 2027 6479 6e65 7374  nt(ws1 + 'dynest
+000127f0: 795f 7573 655f 7374 6f70 2720 2b20 7773  y_use_stop' + ws
+00012800: 3220 2b20 2722 7573 655f 7374 6f70 2220  2 + '"use_stop" 
+00012810: 6172 6775 6d65 6e74 2720 2b0a 2020 2020  argument' +.    
+00012820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012830: 2020 7773 3329 0a20 2020 2020 2020 2020    ws3).         
+00012840: 2020 2020 2020 2023 206b 7761 7267 7320         # kwargs 
+00012850: 7461 6b65 2070 7265 7365 6465 6e63 653a  take presedence:
+00012860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012870: 2069 6620 2775 7365 5f73 746f 7027 206e   if 'use_stop' n
+00012880: 6f74 2069 6e20 6b77 6172 6773 2e6b 6579  ot in kwargs.key
+00012890: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+000128a0: 2020 2020 2020 2020 206b 7761 7267 735b           kwargs[
+000128b0: 2775 7365 5f73 746f 7027 5d20 3d20 7365  'use_stop'] = se
+000128c0: 6c66 2e64 796e 6573 7479 5f75 7365 5f73  lf.dynesty_use_s
+000128d0: 746f 700a 2020 2020 2020 2020 2020 2020  top.            
+000128e0: 6966 2073 656c 662e 6479 6e65 7374 795f  if self.dynesty_
+000128f0: 7573 655f 706f 6f6c 2069 7320 6e6f 7420  use_pool is not 
+00012900: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00012910: 2020 2020 2020 7072 696e 7428 7773 3120        print(ws1 
+00012920: 2b20 2764 796e 6573 7479 5f75 7365 5f70  + 'dynesty_use_p
+00012930: 6f6f 6c27 202b 2077 7332 202b 2027 2275  ool' + ws2 + '"u
+00012940: 7365 5f70 6f6f 6c22 2061 7267 756d 656e  se_pool" argumen
+00012950: 7427 202b 0a20 2020 2020 2020 2020 2020  t' +.           
+00012960: 2020 2020 2020 2020 2020 2077 7333 290a             ws3).
+00012970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012980: 2320 6b77 6172 6773 2074 616b 6520 7072  # kwargs take pr
+00012990: 6573 6564 656e 6365 3a0a 2020 2020 2020  esedence:.      
+000129a0: 2020 2020 2020 2020 2020 6966 2027 7573            if 'us
+000129b0: 655f 706f 6f6c 2720 6e6f 7420 696e 206b  e_pool' not in k
+000129c0: 7761 7267 732e 6b65 7973 2829 3a0a 2020  wargs.keys():.  
+000129d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000129e0: 2020 6b77 6172 6773 5b27 7573 655f 706f    kwargs['use_po
+000129f0: 6f6c 275d 203d 2073 656c 662e 6479 6e65  ol'] = self.dyne
+00012a00: 7374 795f 7573 655f 706f 6f6c 0a0a 2020  sty_use_pool..  
+00012a10: 2020 2020 2020 2320 4465 6669 6e65 2028        # Define (
+00012a20: 6578 6f2d 2961 6c67 6f72 6974 686d 6963  exo-)algorithmic
+00012a30: 206f 7074 696f 6e73 3a0a 2020 2020 2020   options:.      
+00012a40: 2020 7365 6c66 2e65 6363 6c69 6d20 3d20    self.ecclim = 
+00012a50: 6563 636c 696d 0a20 2020 2020 2020 2073  ecclim.        s
+00012a60: 656c 662e 706c 203d 2070 6c0a 2020 2020  elf.pl = pl.    
+00012a70: 2020 2020 7365 6c66 2e70 7520 3d20 7075      self.pu = pu
+00012a80: 0a20 2020 2020 2020 2073 656c 662e 7461  .        self.ta
+00012a90: 203d 2074 610a 0a20 2020 2020 2020 2023   = ta..        #
+00012aa0: 2049 6e68 6572 7420 6461 7461 206f 626a   Inhert data obj
+00012ab0: 6563 743a 0a20 2020 2020 2020 2073 656c  ect:.        sel
+00012ac0: 662e 6461 7461 203d 2064 6174 610a 0a20  f.data = data.. 
+00012ad0: 2020 2020 2020 2023 2049 6e68 6572 7420         # Inhert 
+00012ae0: 7468 6520 6f75 7470 7574 2066 6f6c 6465  the output folde
+00012af0: 723a 0a20 2020 2020 2020 2073 656c 662e  r:.        self.
+00012b00: 6f75 745f 666f 6c64 6572 203d 2064 6174  out_folder = dat
+00012b10: 612e 6f75 745f 666f 6c64 6572 0a20 2020  a.out_folder.   
+00012b20: 2020 2020 2073 656c 662e 7472 616e 7366       self.transf
+00012b30: 6f72 6d65 645f 7072 696f 7273 203d 206e  ormed_priors = n
+00012b40: 702e 7a65 726f 7328 7365 6c66 2e64 6174  p.zeros(self.dat
+00012b50: 612e 6e70 6172 616d 7329 0a0a 2020 2020  a.nparams)..    
+00012b60: 2020 2020 2320 4465 6669 6e65 2070 7265      # Define pre
+00012b70: 6669 7865 7320 696e 2063 6173 6520 7361  fixes in case sa
+00012b80: 7669 6e67 2069 7320 7475 726e 6564 206f  ving is turned o
+00012b90: 6e20 2869 2e65 2e2c 2075 7365 7220 7061  n (i.e., user pa
+00012ba0: 7373 6564 2061 6e20 6f75 745f 666f 6c64  ssed an out_fold
+00012bb0: 6572 292e 2050 794d 756c 7469 4e65 7374  er). PyMultiNest
+00012bc0: 2061 6e64 2064 796e 6573 7479 206f 6e65   and dynesty one
+00012bd0: 7320 6172 6520 7365 7420 6279 2068 616e  s are set by han
+00012be0: 642e 2046 6f72 2074 6865 2072 6573 742c  d. For the rest,
+00012bf0: 2075 7365 2074 6865 206e 6577 0a20 2020   use the new.   
+00012c00: 2020 2020 2023 2073 616d 706c 6572 2073       # sampler s
+00012c10: 7472 696e 6720 6469 7265 6374 6c79 3a0a  tring directly:.
+00012c20: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00012c30: 7361 6d70 6c65 7220 3d3d 2027 6d75 6c74  sampler == 'mult
+00012c40: 696e 6573 7427 3a0a 2020 2020 2020 2020  inest':.        
+00012c50: 2020 2020 7365 6c66 2e73 616d 706c 6572      self.sampler
+00012c60: 5f70 7265 6669 7820 3d20 2727 0a20 2020  _prefix = ''.   
+00012c70: 2020 2020 2065 6c69 6620 7365 6c66 2e73       elif self.s
+00012c80: 616d 706c 6572 203d 3d20 2764 796e 6573  ampler == 'dynes
+00012c90: 7479 273a 0a20 2020 2020 2020 2020 2020  ty':.           
+00012ca0: 2073 656c 662e 7361 6d70 6c65 725f 7072   self.sampler_pr
+00012cb0: 6566 6978 203d 2027 5f64 796e 6573 7479  efix = '_dynesty
+00012cc0: 5f4e 535f 270a 2020 2020 2020 2020 656c  _NS_'.        el
+00012cd0: 6966 2073 656c 662e 7361 6d70 6c65 7220  if self.sampler 
+00012ce0: 3d3d 2027 6479 6e61 6d69 635f 6479 6e65  == 'dynamic_dyne
+00012cf0: 7374 7927 3a0a 2020 2020 2020 2020 2020  sty':.          
+00012d00: 2020 7365 6c66 2e73 616d 706c 6572 5f70    self.sampler_p
+00012d10: 7265 6669 7820 3d20 275f 6479 6e65 7374  refix = '_dynest
+00012d20: 795f 444e 535f 270a 2020 2020 2020 2020  y_DNS_'.        
+00012d30: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00012d40: 2020 7365 6c66 2e73 616d 706c 6572 5f70    self.sampler_p
+00012d50: 7265 6669 7820 3d20 7365 6c66 2e73 616d  refix = self.sam
+00012d60: 706c 6572 202b 2027 5f27 0a0a 2020 2020  pler + '_'..    
+00012d70: 2020 2020 2320 4265 666f 7265 2073 7461      # Before sta
+00012d80: 7274 696e 672c 2063 6865 636b 2069 6620  rting, check if 
+00012d90: 666f 7263 655f 6479 6e65 7374 7920 6f72  force_dynesty or
+00012da0: 2066 6f72 6365 5f70 796d 756c 7469 6e65   force_pymultine
+00012db0: 7374 2069 7320 6f6e 3b20 6368 616e 6765  st is on; change
+00012dc0: 206f 7074 696f 6e73 2061 6363 6f72 6469   options accordi
+00012dd0: 6e67 6c79 3a0a 2020 2020 2020 2020 6966  ngly:.        if
+00012de0: 2066 6f72 6365 5f64 796e 6573 7479 2061   force_dynesty a
+00012df0: 6e64 2028 7365 6c66 2e73 616d 706c 6572  nd (self.sampler
+00012e00: 203d 3d20 276d 756c 7469 6e65 7374 2729   == 'multinest')
+00012e10: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
+00012e20: 696e 7428 0a20 2020 2020 2020 2020 2020  int(.           
+00012e30: 2020 2020 2027 5079 4d75 6c74 696e 6573       'PyMultines
+00012e40: 7420 696e 7374 616c 6c61 7469 6f6e 206e  t installation n
+00012e50: 6f74 2064 6574 6563 7465 642e 2046 6f72  ot detected. For
+00012e60: 6369 6e67 2064 796e 6573 7479 2061 7320  cing dynesty as 
+00012e70: 7468 6520 7361 6d70 6c65 722e 270a 2020  the sampler.'.  
+00012e80: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00012e90: 2020 2020 2020 2020 7365 6c66 2e73 616d          self.sam
+00012ea0: 706c 6572 203d 2027 6479 6e65 7374 7927  pler = 'dynesty'
+00012eb0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00012ec0: 662e 7361 6d70 6c65 725f 7072 6566 6978  f.sampler_prefix
+00012ed0: 203d 2027 5f64 796e 6573 7479 5f4e 535f   = '_dynesty_NS_
+00012ee0: 270a 2020 2020 2020 2020 2020 0a20 2020  '.          .   
+00012ef0: 2020 2020 2069 6620 666f 7263 655f 7079       if force_py
+00012f00: 6d75 6c74 696e 6573 7420 616e 6420 2873  multinest and (s
+00012f10: 656c 662e 7361 6d70 6c65 7220 3d3d 2027  elf.sampler == '
+00012f20: 6479 6e65 7374 7927 293a 0a20 2020 2020  dynesty'):.     
+00012f30: 2020 2020 2020 2070 7269 6e74 280a 2020         print(.  
+00012f40: 2020 2020 2020 2020 2020 2020 2020 2764                'd
+00012f50: 796e 6573 7479 2069 6e73 7461 6c6c 6174  ynesty installat
+00012f60: 696f 6e20 6e6f 7420 6465 7465 6374 6564  ion not detected
+00012f70: 2e20 466f 7263 696e 6720 5079 4d75 6c74  . Forcing PyMult
+00012f80: 696e 6573 7420 6173 2074 6865 2073 616d  inest as the sam
+00012f90: 706c 6572 2e27 0a20 2020 2020 2020 2020  pler.'.         
+00012fa0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00012fb0: 200a 2020 2020 2020 2020 2020 2020 7365   .            se
+00012fc0: 6c66 2e73 616d 706c 6572 203d 2027 6d75  lf.sampler = 'mu
+00012fd0: 6c74 696e 6573 7427 0a20 2020 2020 2020  ltinest'.       
+00012fe0: 2020 2020 2073 656c 662e 7361 6d70 6c65       self.sample
+00012ff0: 725f 7072 6566 6978 203d 2027 270a 0a20  r_prefix = ''.. 
+00013000: 2020 2020 2020 2023 2047 656e 6572 6174         # Generat
+00013010: 6520 6120 706f 7374 6572 696f 7273 2073  e a posteriors s
+00013020: 656c 6620 7468 6174 2077 696c 6c20 7361  elf that will sa
+00013030: 7665 2074 6865 2063 7572 7265 6e74 2076  ve the current v
+00013040: 616c 7565 7320 6f66 2065 6163 6820 6f66  alues of each of
+00013050: 2074 6865 2070 6172 616d 6574 6572 732e   the parameters.
+00013060: 2049 6e69 7469 616c 697a 6174 696f 6e20   Initialization 
+00013070: 7661 6c75 6520 6973 2075 6e69 6d70 6f72  value is unimpor
+00013080: 7461 6e74 2066 6f72 206e 6573 7465 6420  tant for nested 
+00013090: 7361 6d70 6c65 7273 3b0a 2020 2020 2020  samplers;.      
+000130a0: 2020 2320 6966 204d 434d 432c 2074 6869    # if MCMC, thi
+000130b0: 7320 7361 7665 7320 7468 6520 696e 6974  s saves the init
+000130c0: 6961 6c20 7061 7261 6d65 7465 7220 7661  ial parameter va
+000130d0: 6c75 6573 3a0a 2020 2020 2020 2020 7365  lues:.        se
+000130e0: 6c66 2e70 6f73 7465 7269 6f72 7320 3d20  lf.posteriors = 
+000130f0: 7b7d 0a20 2020 2020 2020 2073 656c 662e  {}.        self.
+00013100: 6d6f 6465 6c5f 7061 7261 6d65 7465 7273  model_parameters
+00013110: 203d 206c 6973 7428 7365 6c66 2e64 6174   = list(self.dat
+00013120: 612e 7072 696f 7273 2e6b 6579 7328 2929  a.priors.keys())
+00013130: 0a20 2020 2020 2020 2073 656c 662e 7061  .        self.pa
+00013140: 7261 6d6e 616d 6573 203d 205b 5d0a 2020  ramnames = [].  
+00013150: 2020 2020 2020 666f 7220 706e 616d 6520        for pname 
+00013160: 696e 2073 656c 662e 6d6f 6465 6c5f 7061  in self.model_pa
+00013170: 7261 6d65 7465 7273 3a0a 0a20 2020 2020  rameters:..     
+00013180: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
+00013190: 6174 612e 7072 696f 7273 5b70 6e61 6d65  ata.priors[pname
+000131a0: 5d5b 2764 6973 7472 6962 7574 696f 6e27  ]['distribution'
+000131b0: 5d20 3d3d 2027 6669 7865 6427 3a0a 2020  ] == 'fixed':.  
+000131c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000131d0: 6c66 2e70 6f73 7465 7269 6f72 735b 706e  lf.posteriors[pn
+000131e0: 616d 655d 203d 2073 656c 662e 6461 7461  ame] = self.data
+000131f0: 2e70 7269 6f72 735b 706e 616d 655d 5b0a  .priors[pname][.
+00013200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013210: 2020 2020 2768 7970 6572 7061 7261 6d65      'hyperparame
+00013220: 7465 7273 275d 0a0a 2020 2020 2020 2020  ters']..        
+00013230: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00013240: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00013250: 662e 7361 6d70 6c65 7220 696e 206d 636d  f.sampler in mcm
+00013260: 635f 7361 6d70 6c65 7273 3a0a 2020 2020  c_samplers:.    
+00013270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013280: 7365 6c66 2e70 6f73 7465 7269 6f72 735b  self.posteriors[
+00013290: 706e 616d 655d 203d 2073 656c 662e 6461  pname] = self.da
+000132a0: 7461 2e73 7461 7274 696e 675f 706f 696e  ta.starting_poin
+000132b0: 745b 706e 616d 655d 0a20 2020 2020 2020  t[pname].       
+000132c0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+000132d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000132e0: 2020 2073 656c 662e 706f 7374 6572 696f     self.posterio
+000132f0: 7273 5b0a 2020 2020 2020 2020 2020 2020  rs[.            
+00013300: 2020 2020 2020 2020 2020 2020 706e 616d              pnam
+00013310: 655d 203d 2030 2e20 2023 7365 6c66 2e64  e] = 0.  #self.d
+00013320: 6174 612e 7072 696f 7273 5b70 6e61 6d65  ata.priors[pname
+00013330: 5d5b 2763 7661 6c75 6527 5d0a 2020 2020  ]['cvalue'].    
+00013340: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00013350: 2e70 6172 616d 6e61 6d65 732e 6170 7065  .paramnames.appe
+00013360: 6e64 2870 6e61 6d65 290a 2020 2020 2020  nd(pname).      
+00013370: 2020 2320 466f 7220 6561 6368 206f 6620    # For each of 
+00013380: 7468 6520 7661 7269 6162 6c65 7320 696e  the variables in
+00013390: 2074 6865 2070 7269 6f72 2074 6861 7420   the prior that 
+000133a0: 6973 206e 6f74 2066 6978 6564 2c20 6465  is not fixed, de
+000133b0: 6669 6e65 2061 6e20 696e 7465 726e 616c  fine an internal
+000133c0: 2064 6963 7469 6f6e 6172 7920 7468 6174   dictionary that
+000133d0: 2077 696c 6c20 7361 7665 2074 6865 0a20   will save the. 
+000133e0: 2020 2020 2020 2023 2063 6f72 7265 7370         # corresp
+000133f0: 6f6e 6469 6e67 2074 7261 6e73 666f 726d  onding transform
+00013400: 6174 696f 6e20 6675 6e63 7469 6f6e 2074  ation function t
+00013410: 6f20 7468 6520 7072 696f 7220 636f 7272  o the prior corr
+00013420: 6573 706f 6e64 696e 6720 746f 2074 6861  esponding to tha
+00013430: 7420 7661 7269 6162 6c65 2e20 4964 6561  t variable. Idea
+00013440: 2069 7320 7468 6174 2077 6974 6820 7468   is that with th
+00013450: 6973 206f 6e65 0a20 2020 2020 2020 2023  is one.        #
+00013460: 2073 696d 706c 7920 646f 6573 2073 656c   simply does sel
+00013470: 662e 7472 616e 7366 6f72 6d5f 7072 696f  f.transform_prio
+00013480: 725b 7661 7269 6162 6c65 5f6e 616d 655d  r[variable_name]
+00013490: 2876 616c 7565 2920 616e 6420 796f 7520  (value) and you 
+000134a0: 6765 7420 7468 6520 7472 616e 7366 6f72  get the transfor
+000134b0: 6d65 6420 7661 6c75 6520 746f 2074 6865  med value to the
+000134c0: 2030 2c31 2070 7269 6f72 2e0a 2020 2020   0,1 prior..    
+000134d0: 2020 2020 2320 5468 6973 2061 766f 6964      # This avoid
+000134e0: 7320 6861 7669 6e67 2074 6f20 6b65 6570  s having to keep
+000134f0: 2074 7261 636b 206f 6620 7468 6520 7072   track of the pr
+00013500: 696f 7220 6469 7374 7269 6275 7469 6f6e  ior distribution
+00013510: 206f 6e20 6561 6368 206f 6620 7468 6520   on each of the 
+00013520: 6974 6572 6174 696f 6e73 2e20 5468 6973  iterations. This
+00013530: 2069 7320 6f6e 6c79 2075 7365 6675 6c20   is only useful 
+00013540: 666f 720a 2020 2020 2020 2020 2320 6e65  for.        # ne
+00013550: 7374 6564 2073 616d 706c 6572 733a 0a20  sted samplers:. 
+00013560: 2020 2020 2020 2069 6620 7365 6c66 2e73         if self.s
+00013570: 616d 706c 6572 206e 6f74 2069 6e20 6d63  ampler not in mc
+00013580: 6d63 5f73 616d 706c 6572 733a 0a20 2020  mc_samplers:.   
+00013590: 2020 2020 2020 2020 2073 656c 662e 7472           self.tr
+000135a0: 616e 7366 6f72 6d5f 7072 696f 7220 3d20  ansform_prior = 
+000135b0: 7b7d 0a20 2020 2020 2020 2020 2020 2073  {}.            s
+000135c0: 656c 662e 7365 745f 7072 696f 725f 7472  elf.set_prior_tr
+000135d0: 616e 7366 6f72 6d28 290a 2020 2020 2020  ansform().      
+000135e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000135f0: 2020 2020 7365 6c66 2e65 7661 6c75 6174      self.evaluat
+00013600: 655f 6c6f 6770 7269 6f72 203d 207b 7d0a  e_logprior = {}.
+00013610: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00013620: 2e73 6574 5f6c 6f67 7072 696f 7273 2829  .set_logpriors()
+00013630: 0a0a 2020 2020 2020 2020 2320 4765 6e65  ..        # Gene
+00013640: 7261 7465 206c 6967 6874 2d63 7572 7665  rate light-curve
+00013650: 2061 6e64 2072 6164 6961 6c2d 7665 6c6f   and radial-velo
+00013660: 6369 7479 206d 6f64 656c 733a 0a20 2020  city models:.   
+00013670: 2020 2020 2069 6620 7365 6c66 2e64 6174       if self.dat
+00013680: 612e 745f 6c63 2069 7320 6e6f 7420 4e6f  a.t_lc is not No
+00013690: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+000136a0: 7365 6c66 2e6c 6320 3d20 6d6f 6465 6c28  self.lc = model(
+000136b0: 7365 6c66 2e64 6174 612c 0a20 2020 2020  self.data,.     
+000136c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000136d0: 2020 2020 2020 206d 6f64 656c 7479 7065         modeltype
+000136e0: 3d27 6c63 272c 0a20 2020 2020 2020 2020  ='lc',.         
+000136f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013700: 2020 2070 6c3d 7365 6c66 2e70 6c2c 0a20     pl=self.pl,. 
+00013710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013720: 2020 2020 2020 2020 2020 2070 753d 7365             pu=se
+00013730: 6c66 2e70 752c 0a20 2020 2020 2020 2020  lf.pu,.         
+00013740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013750: 2020 2065 6363 6c69 6d3d 7365 6c66 2e65     ecclim=self.e
+00013760: 6363 6c69 6d2c 0a20 2020 2020 2020 2020  cclim,.         
+00013770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013780: 2020 206c 6967 6874 5f74 7261 7665 6c5f     light_travel_
+00013790: 6465 6c61 7920 3d20 7365 6c66 2e6c 6967  delay = self.lig
+000137a0: 6874 5f74 7261 7665 6c5f 6465 6c61 792c  ht_travel_delay,
+000137b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000137c0: 2020 2020 2020 2020 2020 2020 2073 7465               ste
+000137d0: 6c6c 6172 5f72 6164 6975 7320 3d20 7365  llar_radius = se
+000137e0: 6c66 2e73 7465 6c6c 6172 5f72 6164 6975  lf.stellar_radiu
+000137f0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00013800: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00013810: 6f67 5f6c 696b 655f 6361 6c63 3d54 7275  og_like_calc=Tru
+00013820: 6529 0a20 2020 2020 2020 2069 6620 7365  e).        if se
+00013830: 6c66 2e64 6174 612e 745f 7276 2069 7320  lf.data.t_rv is 
+00013840: 6e6f 7420 4e6f 6e65 3a0a 0a20 2020 2020  not None:..     
+00013850: 2020 2020 2020 2073 656c 662e 7276 203d         self.rv =
+00013860: 206d 6f64 656c 2873 656c 662e 6461 7461   model(self.data
+00013870: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00013880: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+00013890: 6465 6c74 7970 653d 2772 7627 2c0a 2020  deltype='rv',.  
+000138a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000138b0: 2020 2020 2020 2020 2020 6563 636c 696d            ecclim
+000138c0: 3d73 656c 662e 6563 636c 696d 2c0a 2020  =self.ecclim,.  
+000138d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000138e0: 2020 2020 2020 2020 2020 7461 3d73 656c            ta=sel
+000138f0: 662e 7461 2c0a 2020 2020 2020 2020 2020  f.ta,.          
+00013900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013910: 2020 6c6f 675f 6c69 6b65 5f63 616c 633d    log_like_calc=
+00013920: 5472 7565 290a 0a20 2020 2020 2020 2023  True)..        #
+00013930: 2046 6972 7374 2c20 6368 6563 6b20 6966   First, check if
+00013940: 2061 2072 756e 2068 6173 2061 6c72 6561   a run has alrea
+00013950: 6479 2062 6565 6e20 7065 7266 6f72 6d65  dy been performe
+00013960: 6420 7769 7468 2074 6865 2075 7365 722d  d with the user-
+00013970: 6465 6669 6e65 6420 7361 6d70 6c65 722e  defined sampler.
+00013980: 2049 6620 6974 2068 6173 6e27 742c 2072   If it hasn't, r
+00013990: 756e 2069 742e 0a20 2020 2020 2020 2023  un it..        #
+000139a0: 2049 6620 6974 2068 6173 2028 6465 7465   If it has (dete
+000139b0: 6374 6564 2074 6872 6f75 6768 2069 7473  cted through its
+000139c0: 206f 7574 7075 7420 6669 6c65 6e61 6d65   output filename
+000139d0: 292c 2073 6b69 7020 7275 6e6e 696e 6720  ), skip running 
+000139e0: 6167 6169 6e20 616e 6420 6a75 6d70 2073  again and jump s
+000139f0: 7472 6169 6768 7420 746f 206c 6f61 6469  traight to loadi
+00013a00: 6e67 2074 6865 0a20 2020 2020 2020 2023  ng the.        #
+00013a10: 2064 6174 613a 0a20 2020 2020 2020 206f   data:.        o
+00013a20: 7574 203d 207b 7d0a 2020 2020 2020 2020  ut = {}.        
+00013a30: 7275 6e53 616d 706c 6572 203d 2046 616c  runSampler = Fal
+00013a40: 7365 0a20 2020 2020 2020 2069 6620 7365  se.        if se
+00013a50: 6c66 2e6f 7574 5f66 6f6c 6465 7220 6973  lf.out_folder is
+00013a60: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00013a70: 2020 2073 656c 662e 6f75 745f 666f 6c64     self.out_fold
+00013a80: 6572 203d 206f 732e 6765 7463 7764 2829  er = os.getcwd()
+00013a90: 202b 2027 2f27 0a20 2020 2020 2020 2069   + '/'.        i
+00013aa0: 6620 286e 6f74 206f 732e 7061 7468 2e65  f (not os.path.e
+00013ab0: 7869 7374 7328 7365 6c66 2e6f 7574 5f66  xists(self.out_f
+00013ac0: 6f6c 6465 7220 2b20 7365 6c66 2e73 616d  older + self.sam
+00013ad0: 706c 6572 5f70 7265 6669 7820 2b0a 2020  pler_prefix +.  
+00013ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013af0: 2020 2020 2020 2020 2020 2020 2027 706f               'po
+00013b00: 7374 6572 696f 7273 2e70 6b6c 2729 293a  steriors.pkl')):
+00013b10: 0a20 2020 2020 2020 2020 2020 2072 756e  .            run
+00013b20: 5361 6d70 6c65 7220 3d20 5472 7565 0a0a  Sampler = True..
+00013b30: 2020 2020 2020 2020 2320 4966 2072 756e          # If run
+00013b40: 5361 6d70 6c65 7220 6973 2054 7275 652c  Sampler is True,
+00013b50: 2074 6865 6e20 7275 6e20 7468 6520 7361   then run the sa
+00013b60: 6d70 6c65 7220 6f66 2063 686f 6963 653a  mpler of choice:
+00013b70: 0a20 2020 2020 2020 2069 6620 7275 6e53  .        if runS
+00013b80: 616d 706c 6572 3a0a 2020 2020 2020 2020  ampler:.        
+00013b90: 2020 2020 6966 2027 756c 7472 616e 6573      if 'ultranes
+00013ba0: 7427 2069 6e20 7365 6c66 2e73 616d 706c  t' in self.sampl
+00013bb0: 6572 3a0a 2020 2020 2020 2020 2020 2020  er:.            
+00013bc0: 2020 2020 6672 6f6d 2075 6c74 7261 6e65      from ultrane
+00013bd0: 7374 2069 6d70 6f72 7420 5265 6163 7469  st import Reacti
+00013be0: 7665 4e65 7374 6564 5361 6d70 6c65 720a  veNestedSampler.
+00013bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013c00: 2023 204d 6174 6368 206b 7761 7267 7320   # Match kwargs 
+00013c10: 746f 2070 6f73 7369 626c 6520 5265 6163  to possible Reac
+00013c20: 7469 7665 4e65 7374 6564 5361 6d70 6c65  tiveNestedSample
+00013c30: 7220 6b65 7977 6f72 6473 2e20 4669 7273  r keywords. Firs
+00013c40: 742c 2065 7874 7261 6374 2070 6f73 7369  t, extract possi
+00013c50: 626c 6520 6172 6775 6d65 6e74 7320 6f66  ble arguments of
+00013c60: 2052 6561 6374 6976 654e 6573 7465 6453   ReactiveNestedS
+00013c70: 616d 706c 6572 3a0a 2020 2020 2020 2020  ampler:.        
+00013c80: 2020 2020 2020 2020 6172 6773 203d 2052          args = R
+00013c90: 6561 6374 6976 654e 6573 7465 6453 616d  eactiveNestedSam
+00013ca0: 706c 6572 2e5f 5f69 6e69 745f 5f2e 5f5f  pler.__init__.__
+00013cb0: 636f 6465 5f5f 2e63 6f5f 7661 726e 616d  code__.co_varnam
+00013cc0: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
+00013cd0: 2020 2072 6e73 5f61 7267 7320 3d20 7b7d     rns_args = {}
+00013ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013cf0: 2023 2046 6972 7374 2c20 6465 6669 6e65   # First, define
+00013d00: 2073 6f6d 6520 7374 616e 6461 7264 206f   some standard o
+00013d10: 6e65 733a 0a20 2020 2020 2020 2020 2020  nes:.           
+00013d20: 2020 2020 2072 6e73 5f61 7267 735b 2774       rns_args['t
+00013d30: 7261 6e73 666f 726d 275d 203d 2073 656c  ransform'] = sel
+00013d40: 662e 7072 696f 725f 7472 616e 7366 6f72  f.prior_transfor
+00013d50: 6d5f 720a 2020 2020 2020 2020 2020 2020  m_r.            
+00013d60: 2020 2020 726e 735f 6172 6773 5b27 6c6f      rns_args['lo
+00013d70: 675f 6469 7227 5d20 3d20 7365 6c66 2e6f  g_dir'] = self.o
+00013d80: 7574 5f66 6f6c 6465 720a 2020 2020 2020  ut_folder.      
+00013d90: 2020 2020 2020 2020 2020 726e 735f 6172            rns_ar
+00013da0: 6773 5b27 7265 7375 6d65 275d 203d 2054  gs['resume'] = T
+00013db0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+00013dc0: 2020 2020 2320 4e6f 7720 6578 7472 6163      # Now extrac
+00013dd0: 7420 6172 6775 6d65 6e74 7320 6672 6f6d  t arguments from
+00013de0: 206b 7761 7267 733b 2074 6865 7920 7461   kwargs; they ta
+00013df0: 6b65 2070 7265 7365 6465 6e63 6520 6f76  ke presedence ov
+00013e00: 6572 2074 6865 2073 7461 6e64 6172 6420  er the standard 
+00013e10: 6f6e 6573 2061 626f 7665 3a0a 2020 2020  ones above:.    
+00013e20: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00013e30: 6172 6720 696e 2061 7267 733a 0a20 2020  arg in args:.   
+00013e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013e50: 2069 6620 6172 6720 696e 206b 7761 7267   if arg in kwarg
+00013e60: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00013e70: 2020 2020 2020 2020 2020 2072 6e73 5f61             rns_a
+00013e80: 7267 735b 6172 675d 203d 206b 7761 7267  rgs[arg] = kwarg
+00013e90: 735b 6172 675d 0a20 2020 2020 2020 2020  s[arg].         
+00013ea0: 2020 2020 2020 2023 202e 2e2e 616e 6420         # ...and 
+00013eb0: 6c6f 6164 2074 6865 2073 616d 706c 6572  load the sampler
+00013ec0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00013ed0: 2020 7361 6d70 6c65 7220 3d20 5265 6163    sampler = Reac
+00013ee0: 7469 7665 4e65 7374 6564 5361 6d70 6c65  tiveNestedSample
+00013ef0: 7228 7365 6c66 2e70 6172 616d 6e61 6d65  r(self.paramname
+00013f00: 732c 2073 656c 662e 6c6f 676c 696b 652c  s, self.loglike,
+00013f10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f40: 202a 2a72 6e73 5f61 7267 7329 0a0a 2020   **rns_args)..  
+00013f50: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00013f60: 2027 736c 6963 6573 616d 706c 6572 2720   'slicesampler' 
+00013f70: 696e 2073 656c 662e 7361 6d70 6c65 723a  in self.sampler:
+00013f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013f90: 2020 2020 2069 6d70 6f72 7420 756c 7472       import ultr
+00013fa0: 616e 6573 742e 7374 6570 7361 6d70 6c65  anest.stepsample
+00013fb0: 720a 0a20 2020 2020 2020 2020 2020 2020  r..             
+00013fc0: 2020 2020 2020 2023 204d 6174 6368 206b         # Match k
+00013fd0: 7761 7266 7320 746f 2070 6f73 7369 626c  warfs to possibl
+00013fe0: 6520 6172 6773 2069 6e20 5265 6769 6f6e  e args in Region
+00013ff0: 536c 6963 6553 616d 706c 6572 3a0a 2020  SliceSampler:.  
+00014000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014010: 2020 6172 6773 203d 2075 6c74 7261 6e65    args = ultrane
+00014020: 7374 2e73 7465 7073 616d 706c 6572 2e53  st.stepsampler.S
+00014030: 6c69 6365 5361 6d70 6c65 722e 5f5f 696e  liceSampler.__in
+00014040: 6974 5f5f 2e5f 5f63 6f64 655f 5f2e 636f  it__.__code__.co
+00014050: 5f76 6172 6e61 6d65 730a 2020 2020 2020  _varnames.      
+00014060: 2020 2020 2020 2020 2020 2020 2020 7273                rs
+00014070: 735f 6172 6773 203d 207b 7d0a 2020 2020  s_args = {}.    
+00014080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014090: 2320 4669 7273 742c 2064 6566 696e 6520  # First, define 
+000140a0: 7374 616e 6461 7264 206f 6e65 733a 0a20  standard ones:. 
+000140b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000140c0: 2020 2072 7373 5f61 7267 735b 276e 7374     rss_args['nst
+000140d0: 6570 7327 5d20 3d20 3430 300a 2020 2020  eps'] = 400.    
+000140e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000140f0: 7273 735f 6172 6773 5b27 6164 6170 7469  rss_args['adapti
+00014100: 7665 5f6e 7374 6570 7327 5d20 3d20 276d  ve_nsteps'] = 'm
+00014110: 6f76 652d 6469 7374 616e 6365 270a 2020  ove-distance'.  
+00014120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014130: 2020 2320 4578 7472 6163 7420 6b77 6172    # Extract kwar
+00014140: 6773 2c20 6164 6420 7468 656d 2069 6e3a  gs, add them in:
+00014150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014160: 2020 2020 2066 6f72 2061 7267 2069 6e20       for arg in 
+00014170: 6172 6773 3a0a 2020 2020 2020 2020 2020  args:.          
+00014180: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00014190: 2061 7267 2069 6e20 6b77 6172 6773 3a0a   arg in kwargs:.
+000141a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000141b0: 2020 2020 2020 2020 2020 2020 7273 735f              rss_
+000141c0: 6172 6773 5b61 7267 5d20 3d20 6b77 6172  args[arg] = kwar
+000141d0: 6773 5b61 7267 5d0a 0a20 2020 2020 2020  gs[arg]..       
+000141e0: 2020 2020 2020 2020 2020 2020 2023 2041               # A
+000141f0: 7070 6c79 2073 7465 7073 616d 706c 6572  pply stepsampler
+00014200: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014210: 2020 2020 2020 7361 6d70 6c65 722e 7374        sampler.st
+00014220: 6570 7361 6d70 6c65 7220 3d20 756c 7472  epsampler = ultr
+00014230: 616e 6573 742e 7374 6570 7361 6d70 6c65  anest.stepsample
+00014240: 722e 5265 6769 6f6e 536c 6963 6553 616d  r.RegionSliceSam
+00014250: 706c 6572 280a 2020 2020 2020 2020 2020  pler(.          
+00014260: 2020 2020 2020 2020 2020 2020 2020 2a2a                **
+00014270: 7273 735f 6172 6773 290a 0a20 2020 2020  rss_args)..     
+00014280: 2020 2020 2020 2020 2020 2023 204e 6f77             # Now
+00014290: 2064 6f20 7468 6520 7361 6d65 2066 6f72   do the same for
+000142a0: 2052 6561 6374 6976 654e 6573 7465 6453   ReactiveNestedS
+000142b0: 616d 706c 6572 2e72 756e 202d 2d2d 206c  ampler.run --- l
+000142c0: 6f61 6420 616e 7920 6b77 6172 6773 2074  oad any kwargs t
+000142d0: 6865 2075 7365 7220 6861 7320 6769 7665  he user has give
+000142e0: 6e20 6173 2069 6e70 7574 3a0a 2020 2020  n as input:.    
+000142f0: 2020 2020 2020 2020 2020 2020 6172 6773              args
+00014300: 203d 2052 6561 6374 6976 654e 6573 7465   = ReactiveNeste
+00014310: 6453 616d 706c 6572 2e72 756e 2e5f 5f63  dSampler.run.__c
+00014320: 6f64 655f 5f2e 636f 5f76 6172 6e61 6d65  ode__.co_varname
+00014330: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00014340: 2020 726e 735f 7275 6e5f 6172 6773 203d    rns_run_args =
+00014350: 207b 7d0a 2020 2020 2020 2020 2020 2020   {}.            
+00014360: 2020 2020 2320 4465 6669 6e65 2073 6f6d      # Define som
+00014370: 6520 7374 616e 6461 7264 206f 6e65 733a  e standard ones:
+00014380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014390: 2072 6e73 5f72 756e 5f61 7267 735b 2766   rns_run_args['f
+000143a0: 7261 635f 7265 6d61 696e 275d 203d 2030  rac_remain'] = 0
+000143b0: 2e31 0a20 2020 2020 2020 2020 2020 2020  .1.             
+000143c0: 2020 2072 6e73 5f72 756e 5f61 7267 735b     rns_run_args[
+000143d0: 276d 696e 5f6e 756d 5f6c 6976 655f 706f  'min_num_live_po
+000143e0: 696e 7473 275d 203d 2073 656c 662e 6e5f  ints'] = self.n_
+000143f0: 6c69 7665 5f70 6f69 6e74 730a 2020 2020  live_points.    
+00014400: 2020 2020 2020 2020 2020 2020 726e 735f              rns_
+00014410: 7275 6e5f 6172 6773 5b27 6d61 785f 6e75  run_args['max_nu
+00014420: 6d5f 696d 7072 6f76 656d 656e 745f 6c6f  m_improvement_lo
+00014430: 6f70 7327 5d20 3d20 310a 2020 2020 2020  ops'] = 1.      
+00014440: 2020 2020 2020 2020 2020 2320 4c6f 6164            # Load
+00014450: 2074 6865 206f 6e65 7320 6672 6f6d 2074   the ones from t
+00014460: 6865 206b 7761 7267 733a 0a20 2020 2020  he kwargs:.     
+00014470: 2020 2020 2020 2020 2020 2066 6f72 2061             for a
+00014480: 7267 2069 6e20 6172 6773 3a0a 2020 2020  rg in args:.    
+00014490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000144a0: 6966 2061 7267 2069 6e20 6b77 6172 6773  if arg in kwargs
+000144b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000144c0: 2020 2020 2020 2020 2020 726e 735f 7275            rns_ru
+000144d0: 6e5f 6172 6773 5b61 7267 5d20 3d20 6b77  n_args[arg] = kw
+000144e0: 6172 6773 5b61 7267 5d0a 2020 2020 2020  args[arg].      
+000144f0: 2020 2020 2020 2020 2020 2320 5275 6e20            # Run 
+00014500: 7468 6520 7361 6d70 6c65 723a 0a20 2020  the sampler:.   
+00014510: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00014520: 756c 7473 203d 2073 616d 706c 6572 2e72  ults = sampler.r
+00014530: 756e 282a 2a72 6e73 5f72 756e 5f61 7267  un(**rns_run_arg
+00014540: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+00014550: 2020 2073 616d 706c 6572 2e70 7269 6e74     sampler.print
+00014560: 5f72 6573 756c 7473 2829 0a20 2020 2020  _results().     
+00014570: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+00014580: 6572 2e70 6c6f 7428 290a 0a20 2020 2020  er.plot()..     
+00014590: 2020 2020 2020 2020 2020 2023 2053 6176             # Sav
+000145a0: 6520 756c 7472 616e 6573 7420 6f75 7470  e ultranest outp
+000145b0: 7574 733a 0a20 2020 2020 2020 2020 2020  uts:.           
+000145c0: 2020 2020 206f 7574 5b27 756c 7472 616e       out['ultran
+000145d0: 6573 745f 6f75 7470 7574 275d 203d 2072  est_output'] = r
+000145e0: 6573 756c 7473 0a20 2020 2020 2020 2020  esults.         
+000145f0: 2020 2020 2020 2023 2047 6574 2077 6569         # Get wei
+00014600: 6768 7465 6420 706f 7374 6572 696f 723a  ghted posterior:
+00014610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014620: 2070 6f73 7465 7269 6f72 5f73 616d 706c   posterior_sampl
+00014630: 6573 203d 2072 6573 756c 7473 5b27 7361  es = results['sa
+00014640: 6d70 6c65 7327 5d0a 2020 2020 2020 2020  mples'].        
+00014650: 2020 2020 2020 2020 2320 4765 7420 6c6e          # Get ln
+00014660: 5a3a 0a20 2020 2020 2020 2020 2020 2020  Z:.             
+00014670: 2020 206f 7574 5b27 6c6e 5a27 5d20 3d20     out['lnZ'] = 
+00014680: 7265 7375 6c74 735b 276c 6f67 7a27 5d0a  results['logz'].
+00014690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000146a0: 6f75 745b 276c 6e5a 6572 7227 5d20 3d20  out['lnZerr'] = 
+000146b0: 7265 7375 6c74 735b 276c 6f67 7a65 7272  results['logzerr
+000146c0: 275d 0a0a 2020 2020 2020 2020 2020 2020  ']..            
+000146d0: 656c 6966 2027 6d75 6c74 696e 6573 7427  elif 'multinest'
+000146e0: 2069 6e20 7365 6c66 2e73 616d 706c 6572   in self.sampler
+000146f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014700: 2020 2320 4173 2064 6f6e 6520 666f 7220    # As done for 
+00014710: 756c 7472 616e 6573 7420 6162 6f76 652c  ultranest above,
+00014720: 2073 6361 6e20 706f 7373 6962 6c65 2061   scan possible a
+00014730: 7267 756d 656e 7473 2066 6f72 2070 796d  rguments for pym
+00014740: 756c 7469 6e65 7374 2e72 756e 3a0a 2020  ultinest.run:.  
+00014750: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+00014760: 6773 203d 2070 796d 756c 7469 6e65 7374  gs = pymultinest
+00014770: 2e72 756e 2e5f 5f63 6f64 655f 5f2e 636f  .run.__code__.co
+00014780: 5f76 6172 6e61 6d65 730a 2020 2020 2020  _varnames.      
+00014790: 2020 2020 2020 2020 2020 6d6e 5f61 7267            mn_arg
+000147a0: 7320 3d20 7b7d 0a20 2020 2020 2020 2020  s = {}.         
+000147b0: 2020 2020 2020 2023 2044 6566 696e 6520         # Define 
+000147c0: 736f 6d65 2073 7461 6e64 6172 6420 6f6e  some standard on
+000147d0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+000147e0: 2020 2020 6d6e 5f61 7267 735b 276e 5f6c      mn_args['n_l
+000147f0: 6976 655f 706f 696e 7473 275d 203d 2073  ive_points'] = s
+00014800: 656c 662e 6e5f 6c69 7665 5f70 6f69 6e74  elf.n_live_point
+00014810: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00014820: 2020 6d6e 5f61 7267 735b 276d 6178 5f6d    mn_args['max_m
+00014830: 6f64 6573 275d 203d 2031 3030 0a20 2020  odes'] = 100.   
+00014840: 2020 2020 2020 2020 2020 2020 206d 6e5f               mn_
+00014850: 6172 6773 5b27 6f75 7470 7574 6669 6c65  args['outputfile
+00014860: 735f 6261 7365 6e61 6d65 275d 203d 2073  s_basename'] = s
+00014870: 656c 662e 6f75 745f 666f 6c64 6572 202b  elf.out_folder +
+00014880: 2027 6a6f 6d6e 6573 745f 270a 2020 2020   'jomnest_'.    
+00014890: 2020 2020 2020 2020 2020 2020 6d6e 5f61              mn_a
+000148a0: 7267 735b 2772 6573 756d 6527 5d20 3d20  rgs['resume'] = 
+000148b0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+000148c0: 2020 2020 2020 6d6e 5f61 7267 735b 2776        mn_args['v
+000148d0: 6572 626f 7365 275d 203d 2073 656c 662e  erbose'] = self.
+000148e0: 6461 7461 2e76 6572 626f 7365 0a20 2020  data.verbose.   
+000148f0: 2020 2020 2020 2020 2020 2020 2023 204e               # N
+00014900: 6f77 2065 7874 7261 6374 2061 7267 756d  ow extract argum
+00014910: 656e 7473 2066 726f 6d20 6b77 6172 6773  ents from kwargs
+00014920: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014930: 2020 666f 7220 6172 6720 696e 2061 7267    for arg in arg
+00014940: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00014950: 2020 2020 2020 2069 6620 6172 6720 696e         if arg in
+00014960: 206b 7761 7267 733a 0a20 2020 2020 2020   kwargs:.       
+00014970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014980: 206d 6e5f 6172 6773 5b61 7267 5d20 3d20   mn_args[arg] = 
+00014990: 6b77 6172 6773 5b61 7267 5d0a 2020 2020  kwargs[arg].    
+000149a0: 2020 2020 2020 2020 2020 2020 2320 4465              # De
+000149b0: 6669 6e65 2074 6865 2073 616d 706c 6572  fine the sampler
+000149c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000149d0: 2020 7079 6d75 6c74 696e 6573 742e 7275    pymultinest.ru
+000149e0: 6e28 7365 6c66 2e6c 6f67 6c69 6b65 2c20  n(self.loglike, 
+000149f0: 7365 6c66 2e70 7269 6f72 5f74 7261 6e73  self.prior_trans
+00014a00: 666f 726d 2c0a 2020 2020 2020 2020 2020  form,.          
+00014a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a20: 2020 2020 2020 7365 6c66 2e64 6174 612e        self.data.
+00014a30: 6e70 6172 616d 732c 202a 2a6d 6e5f 6172  nparams, **mn_ar
+00014a40: 6773 290a 0a20 2020 2020 2020 2020 2020  gs)..           
+00014a50: 2020 2020 2023 204e 6f77 2c20 7769 7468       # Now, with
+00014a60: 2074 6865 2073 616d 706c 6572 2064 6566   the sampler def
+00014a70: 696e 6564 2c20 7265 7065 6174 2074 6865  ined, repeat the
+00014a80: 2073 616d 6520 6173 2061 626f 7665 2066   same as above f
+00014a90: 6f72 2074 6865 2070 796d 756c 7469 6e65  or the pymultine
+00014aa0: 7374 2e41 6e61 6c79 7a65 7220 6f62 6a65  st.Analyzer obje
+00014ab0: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
+00014ac0: 2020 2020 6172 6773 203d 2070 796d 756c      args = pymul
+00014ad0: 7469 6e65 7374 2e41 6e61 6c79 7a65 722e  tinest.Analyzer.
+00014ae0: 5f5f 696e 6974 5f5f 2e5f 5f63 6f64 655f  __init__.__code_
+00014af0: 5f2e 636f 5f76 6172 6e61 6d65 730a 2020  _.co_varnames.  
+00014b00: 2020 2020 2020 2020 2020 2020 2020 6d6e                mn
+00014b10: 615f 6172 6773 203d 207b 7d0a 2020 2020  a_args = {}.    
+00014b20: 2020 2020 2020 2020 2020 2020 2320 4465              # De
+00014b30: 6669 6e65 2073 7461 6e64 6172 6420 6f6e  fine standard on
+00014b40: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00014b50: 2020 2020 6d6e 615f 6172 6773 5b27 6f75      mna_args['ou
+00014b60: 7470 7574 6669 6c65 735f 6261 7365 6e61  tputfiles_basena
+00014b70: 6d65 275d 203d 2073 656c 662e 6f75 745f  me'] = self.out_
+00014b80: 666f 6c64 6572 202b 2027 6a6f 6d6e 6573  folder + 'jomnes
+00014b90: 745f 270a 2020 2020 2020 2020 2020 2020  t_'.            
+00014ba0: 2020 2020 6d6e 615f 6172 6773 5b27 6e5f      mna_args['n_
+00014bb0: 7061 7261 6d73 275d 203d 2073 656c 662e  params'] = self.
+00014bc0: 6461 7461 2e6e 7061 7261 6d73 0a20 2020  data.nparams.   
+00014bd0: 2020 2020 2020 2020 2020 2020 2023 204c               # L
+00014be0: 6f61 6420 7468 6520 6f6e 6573 2066 726f  oad the ones fro
+00014bf0: 6d20 6b77 6172 6773 3a0a 2020 2020 2020  m kwargs:.      
+00014c00: 2020 2020 2020 2020 2020 666f 7220 6172            for ar
+00014c10: 6720 696e 2061 7267 733a 0a20 2020 2020  g in args:.     
+00014c20: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00014c30: 6620 6172 6720 696e 206b 7761 7267 733a  f arg in kwargs:
+00014c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014c50: 2020 2020 2020 2020 206d 6e61 5f61 7267           mna_arg
+00014c60: 735b 6172 675d 203d 206b 7761 7267 735b  s[arg] = kwargs[
+00014c70: 6172 675d 0a20 2020 2020 2020 2020 2020  arg].           
+00014c80: 2020 2020 2023 2052 756e 2061 6e64 2067       # Run and g
+00014c90: 6574 206f 7574 7075 743a 0a20 2020 2020  et output:.     
+00014ca0: 2020 2020 2020 2020 2020 206f 7574 7075             outpu
+00014cb0: 7420 3d20 7079 6d75 6c74 696e 6573 742e  t = pymultinest.
+00014cc0: 416e 616c 797a 6572 282a 2a6d 6e61 5f61  Analyzer(**mna_a
+00014cd0: 7267 7329 0a20 2020 2020 2020 2020 2020  rgs).           
+00014ce0: 2020 2020 2023 2047 6574 206f 7574 2070       # Get out p
+00014cf0: 6172 616d 6574 6572 733a 2074 6869 7320  arameters: this 
+00014d00: 6d61 7472 6978 2068 6173 2028 7361 6d70  matrix has (samp
+00014d10: 6c65 732c 6e5f 7061 7261 6d73 2b31 293a  les,n_params+1):
+00014d20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014d30: 2070 6f73 7465 7269 6f72 5f73 616d 706c   posterior_sampl
+00014d40: 6573 203d 206f 7574 7075 742e 6765 745f  es = output.get_
+00014d50: 6571 7561 6c5f 7765 6967 6874 6564 5f70  equal_weighted_p
+00014d60: 6f73 7465 7269 6f72 280a 2020 2020 2020  osterior(.      
+00014d70: 2020 2020 2020 2020 2020 295b 3a2c 203a            )[:, :
+00014d80: 2d31 5d0a 2020 2020 2020 2020 2020 2020  -1].            
+00014d90: 2020 2020 2320 4765 7420 494e 5320 6c6e      # Get INS ln
+00014da0: 5a3a 0a20 2020 2020 2020 2020 2020 2020  Z:.             
+00014db0: 2020 206f 7574 5b27 6c6e 5a27 5d20 3d20     out['lnZ'] = 
+00014dc0: 6f75 7470 7574 2e67 6574 5f73 7461 7473  output.get_stats
+00014dd0: 2829 5b27 676c 6f62 616c 2065 7669 6465  ()['global evide
+00014de0: 6e63 6527 5d0a 2020 2020 2020 2020 2020  nce'].          
+00014df0: 2020 2020 2020 6f75 745b 276c 6e5a 6572        out['lnZer
+00014e00: 7227 5d20 3d20 6f75 7470 7574 2e67 6574  r'] = output.get
+00014e10: 5f73 7461 7473 2829 5b27 676c 6f62 616c  _stats()['global
+00014e20: 2065 7669 6465 6e63 6520 6572 726f 7227   evidence error'
+00014e30: 5d0a 0a20 2020 2020 2020 2020 2020 2065  ]..            e
+00014e40: 6c69 6620 2764 796e 6573 7479 2720 696e  lif 'dynesty' in
+00014e50: 2073 656c 662e 7361 6d70 6c65 723a 0a0a   self.sampler:..
+00014e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e70: 6966 2073 656c 662e 7361 6d70 6c65 7220  if self.sampler 
+00014e80: 3d3d 2027 6479 6e61 6d69 635f 6479 6e65  == 'dynamic_dyne
+00014e90: 7374 7927 3a0a 0a20 2020 2020 2020 2020  sty':..         
+00014ea0: 2020 2020 2020 2020 2020 2044 796e 6573             Dynes
+00014eb0: 7479 5361 6d70 6c65 7220 3d20 6479 6e65  tySampler = dyne
+00014ec0: 7374 792e 4479 6e61 6d69 634e 6573 7465  sty.DynamicNeste
+00014ed0: 6453 616d 706c 6572 0a0a 2020 2020 2020  dSampler..      
+00014ee0: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+00014ef0: 656c 662e 7361 6d70 6c65 7220 3d3d 2027  elf.sampler == '
+00014f00: 6479 6e65 7374 7927 3a0a 0a20 2020 2020  dynesty':..     
+00014f10: 2020 2020 2020 2020 2020 2020 2020 2044                 D
+00014f20: 796e 6573 7479 5361 6d70 6c65 7220 3d20  ynestySampler = 
+00014f30: 6479 6e65 7374 792e 4e65 7374 6564 5361  dynesty.NestedSa
+00014f40: 6d70 6c65 720a 0a20 2020 2020 2020 2020  mpler..         
+00014f50: 2020 2020 2020 2023 2054 6f20 7275 6e20         # To run 
+00014f60: 6479 6e65 7374 792c 2077 6520 646f 2069  dynesty, we do i
+00014f70: 7420 6120 6c69 7474 6c65 2062 6974 2064  t a little bit d
+00014f80: 6966 6665 7265 6e74 2064 6570 656e 6469  ifferent dependi
+00014f90: 6e67 2069 6620 7765 2061 7265 2064 6f69  ng if we are doi
+00014fa0: 6e67 206d 756c 7469 7468 7265 6164 696e  ng multithreadin
+00014fb0: 6720 6f72 206e 6f74 3a0a 2020 2020 2020  g or not:.      
+00014fc0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00014fd0: 662e 6e74 6872 6561 6473 2069 7320 4e6f  f.nthreads is No
+00014fe0: 6e65 3a0a 0a20 2020 2020 2020 2020 2020  ne:..           
+00014ff0: 2020 2020 2020 2020 2023 2041 7320 7769           # As wi
+00015000: 7468 2074 6865 206f 7468 6572 2073 616d  th the other sam
+00015010: 706c 6572 732c 2066 6972 7374 2065 7874  plers, first ext
+00015020: 7261 6374 206c 6973 7420 6f66 2070 6f73  ract list of pos
+00015030: 7369 626c 6520 6172 6773 2028 7472 792d  sible args (try-
+00015040: 6578 6365 7074 2066 6f72 2062 6163 6b2d  except for back-
+00015050: 636f 6d70 6174 6962 696c 6974 7920 7769  compatibility wi
+00015060: 7468 2070 7269 6f72 2064 796e 6573 7479  th prior dynesty
+00015070: 2076 6572 7369 6f6e 7329 3a0a 2020 2020   versions):.    
+00015080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015090: 7472 793a 0a0a 2020 2020 2020 2020 2020  try:..          
+000150a0: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+000150b0: 6773 203d 2076 6172 7328 4479 6e65 7374  gs = vars(Dynest
+000150c0: 7953 616d 706c 6572 295b 275f 5f69 6e69  ySampler)['__ini
+000150d0: 745f 5f27 5d2e 5f5f 636f 6465 5f5f 2e63  t__'].__code__.c
+000150e0: 6f5f 7661 726e 616d 6573 0a0a 2020 2020  o_varnames..    
+000150f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015100: 6578 6365 7074 3a0a 0a20 2020 2020 2020  except:..       
 00015110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015120: 2064 5f61 7267 735b 2773 616d 706c 6527   d_args['sample'
-00015130: 5d20 3d20 2772 7761 6c6b 270a 2020 2020  ] = 'rwalk'.    
-00015140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015150: 645f 6172 6773 5b27 6e6c 6976 6527 5d20  d_args['nlive'] 
-00015160: 3d20 7365 6c66 2e6e 5f6c 6976 655f 706f  = self.n_live_po
-00015170: 696e 7473 0a0a 2020 2020 2020 2020 2020  ints..          
-00015180: 2020 2020 2020 2020 2020 2320 4d61 7463            # Matc
-00015190: 6820 7468 656d 2077 6974 6820 6b77 6172  h them with kwar
-000151a0: 6773 2028 6b77 6172 6773 2074 616b 6520  gs (kwargs take 
-000151b0: 7072 6566 6572 656e 6365 293a 0a20 2020  preference):.   
-000151c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000151d0: 2066 6f72 2061 7267 2069 6e20 6172 6773   for arg in args
-000151e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000151f0: 2020 2020 2020 2020 2020 6966 2061 7267            if arg
-00015200: 2069 6e20 6b77 6172 6773 3a0a 2020 2020   in kwargs:.    
-00015210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015220: 2020 2020 2020 2020 645f 6172 6773 5b61          d_args[a
-00015230: 7267 5d20 3d20 6b77 6172 6773 5b61 7267  rg] = kwargs[arg
-00015240: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00015250: 2020 2020 2020 2023 2044 6566 696e 6520         # Define 
-00015260: 7468 6520 7361 6d70 6c65 723a 0a20 2020  the sampler:.   
-00015270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015280: 2073 616d 706c 6572 203d 2044 796e 6573   sampler = Dynes
-00015290: 7479 5361 6d70 6c65 7228 7365 6c66 2e6c  tySampler(self.l
-000152a0: 6f67 6c69 6b65 2c0a 2020 2020 2020 2020  oglike,.        
+00015120: 2061 7267 7320 3d20 7661 7273 2844 796e   args = vars(Dyn
+00015130: 6573 7479 5361 6d70 6c65 7229 2e6b 6579  estySampler).key
+00015140: 7328 290a 0a20 2020 2020 2020 2020 2020  s()..           
+00015150: 2020 2020 2020 2020 2064 5f61 7267 7320           d_args 
+00015160: 3d20 7b7d 0a0a 2020 2020 2020 2020 2020  = {}..          
+00015170: 2020 2020 2020 2020 2020 2320 4465 6669            # Defi
+00015180: 6e65 2073 6f6d 6520 7374 616e 6461 7264  ne some standard
+00015190: 206f 6e65 7320 2866 6f72 2062 6163 6b2d   ones (for back-
+000151a0: 636f 6d70 6174 6962 696c 6974 7920 7769  compatibility wi
+000151b0: 7468 2070 7265 7669 6f75 7320 6a75 6c69  th previous juli
+000151c0: 6574 2076 6572 7369 6f6e 7329 3a0a 2020  et versions):.  
+000151d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000151e0: 2020 645f 6172 6773 5b27 626f 756e 6427    d_args['bound'
+000151f0: 5d20 3d20 276d 756c 7469 270a 2020 2020  ] = 'multi'.    
+00015200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015210: 645f 6172 6773 5b27 7361 6d70 6c65 275d  d_args['sample']
+00015220: 203d 2027 7277 616c 6b27 0a20 2020 2020   = 'rwalk'.     
+00015230: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00015240: 5f61 7267 735b 276e 6c69 7665 275d 203d  _args['nlive'] =
+00015250: 2073 656c 662e 6e5f 6c69 7665 5f70 6f69   self.n_live_poi
+00015260: 6e74 730a 0a20 2020 2020 2020 2020 2020  nts..           
+00015270: 2020 2020 2020 2020 2023 204d 6174 6368           # Match
+00015280: 2074 6865 6d20 7769 7468 206b 7761 7267   them with kwarg
+00015290: 7320 286b 7761 7267 7320 7461 6b65 2070  s (kwargs take p
+000152a0: 7265 6665 7265 6e63 6529 3a0a 2020 2020  reference):.    
 000152b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000152c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000152d0: 2020 2020 2073 656c 662e 7072 696f 725f       self.prior_
-000152e0: 7472 616e 7366 6f72 6d5f 722c 0a20 2020  transform_r,.   
-000152f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000152c0: 666f 7220 6172 6720 696e 2061 7267 733a  for arg in args:
+000152d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000152e0: 2020 2020 2020 2020 2069 6620 6172 6720           if arg 
+000152f0: 696e 206b 7761 7267 733a 0a20 2020 2020  in kwargs:.     
 00015300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015310: 2020 2020 2020 2020 2020 7365 6c66 2e64            self.d
-00015320: 6174 612e 6e70 6172 616d 732c 202a 2a64  ata.nparams, **d
-00015330: 5f61 7267 7329 0a0a 2020 2020 2020 2020  _args)..        
-00015340: 2020 2020 2020 2020 2020 2020 2320 4e6f              # No
-00015350: 7720 646f 2074 6865 2073 616d 6520 666f  w do the same fo
-00015360: 7220 7468 6520 6163 7475 616c 2073 616d  r the actual sam
-00015370: 706c 6572 3a0a 2020 2020 2020 2020 2020  pler:.          
-00015380: 2020 2020 2020 2020 2020 6172 6773 203d            args =
-00015390: 2076 6172 7328 7361 6d70 6c65 7229 2e6b   vars(sampler).k
-000153a0: 6579 7328 290a 2020 2020 2020 2020 2020  eys().          
-000153b0: 2020 2020 2020 2020 2020 6473 5f61 7267            ds_arg
-000153c0: 7320 3d20 7b7d 0a0a 2020 2020 2020 2020  s = {}..        
-000153d0: 2020 2020 2020 2020 2020 2020 2320 4c6f              # Lo
-000153e0: 6164 206f 6e65 7320 6672 6f6d 206b 7761  ad ones from kwa
-000153f0: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-00015400: 2020 2020 2020 2020 2066 6f72 2061 7267           for arg
-00015410: 2069 6e20 6172 6773 3a0a 2020 2020 2020   in args:.      
-00015420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015430: 2020 6966 2061 7267 2069 6e20 6b77 6172    if arg in kwar
-00015440: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
-00015450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015460: 6473 5f61 7267 735b 6172 675d 203d 206b  ds_args[arg] = k
-00015470: 7761 7267 735b 6172 675d 0a0a 2020 2020  wargs[arg]..    
-00015480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015490: 2320 4e6f 7720 7275 6e3a 0a20 2020 2020  # Now run:.     
-000154a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000154b0: 616d 706c 6572 2e72 756e 5f6e 6573 7465  ampler.run_neste
-000154c0: 6428 2a2a 6473 5f61 7267 7329 0a0a 2020  d(**ds_args)..  
-000154d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000154e0: 2020 2320 416e 6420 6578 7472 6163 7420    # And extract 
-000154f0: 7265 7375 6c74 730a 2020 2020 2020 2020  results.        
-00015500: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00015510: 6c74 7320 3d20 7361 6d70 6c65 722e 7265  lts = sampler.re
-00015520: 7375 6c74 730a 0a20 2020 2020 2020 2020  sults..         
-00015530: 2020 2020 2020 2065 6c73 653a 0a0a 2020         else:..  
-00015540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015550: 2020 2320 4265 666f 7265 2072 756e 6e69    # Before runni
-00015560: 6e67 2074 6865 2077 686f 6c65 206d 756c  ng the whole mul
-00015570: 7469 7468 7265 6164 206d 6167 6963 2c20  tithread magic, 
-00015580: 6d61 7463 6820 6b77 6172 6773 2077 6974  match kwargs wit
-00015590: 6820 6675 6e63 7469 6f6e 616c 2061 7267  h functional arg
-000155a0: 756d 656e 7473 3a0a 2020 2020 2020 2020  uments:.        
-000155b0: 2020 2020 2020 2020 2020 2020 6172 6773              args
-000155c0: 203d 2076 6172 7328 4479 6e65 7374 7953   = vars(DynestyS
-000155d0: 616d 706c 6572 292e 6b65 7973 2829 0a20  ampler).keys(). 
-000155e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000155f0: 2020 2064 5f61 7267 7320 3d20 7b7d 0a0a     d_args = {}..
-00015600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015610: 2020 2020 2320 4465 6669 6e65 2073 6f6d      # Define som
-00015620: 6520 7374 616e 6461 7264 206f 6e65 7320  e standard ones 
-00015630: 2866 6f72 2062 6163 6b2d 636f 6d70 6174  (for back-compat
-00015640: 6962 696c 6974 7920 7769 7468 2070 7265  ibility with pre
-00015650: 7669 6f75 7320 6a75 6c69 6574 2076 6572  vious juliet ver
-00015660: 7369 6f6e 7329 3a0a 2020 2020 2020 2020  sions):.        
-00015670: 2020 2020 2020 2020 2020 2020 645f 6172              d_ar
-00015680: 6773 5b27 626f 756e 6427 5d20 3d20 276d  gs['bound'] = 'm
-00015690: 756c 7469 270a 2020 2020 2020 2020 2020  ulti'.          
-000156a0: 2020 2020 2020 2020 2020 645f 6172 6773            d_args
-000156b0: 5b27 7361 6d70 6c65 275d 203d 2027 7277  ['sample'] = 'rw
-000156c0: 616c 6b27 0a20 2020 2020 2020 2020 2020  alk'.           
-000156d0: 2020 2020 2020 2020 2064 5f61 7267 735b           d_args[
-000156e0: 276e 6c69 7665 275d 203d 2073 656c 662e  'nlive'] = self.
-000156f0: 6e5f 6c69 7665 5f70 6f69 6e74 730a 0a20  n_live_points.. 
-00015700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015710: 2020 2023 204d 6174 6368 2074 6865 6d20     # Match them 
-00015720: 7769 7468 206b 7761 7267 733a 0a20 2020  with kwargs:.   
-00015730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015740: 2066 6f72 2061 7267 2069 6e20 6172 6773   for arg in args
-00015750: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015760: 2020 2020 2020 2020 2020 6966 2061 7267            if arg
-00015770: 2069 6e20 6b77 6172 6773 3a0a 2020 2020   in kwargs:.    
+00015310: 2020 2020 2020 2064 5f61 7267 735b 6172         d_args[ar
+00015320: 675d 203d 206b 7761 7267 735b 6172 675d  g] = kwargs[arg]
+00015330: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015340: 2020 2020 2020 2320 4465 6669 6e65 2074        # Define t
+00015350: 6865 2073 616d 706c 6572 3a0a 2020 2020  he sampler:.    
+00015360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015370: 7361 6d70 6c65 7220 3d20 4479 6e65 7374  sampler = Dynest
+00015380: 7953 616d 706c 6572 2873 656c 662e 6c6f  ySampler(self.lo
+00015390: 676c 696b 652c 0a20 2020 2020 2020 2020  glike,.         
+000153a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000153b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000153c0: 2020 2020 7365 6c66 2e70 7269 6f72 5f74      self.prior_t
+000153d0: 7261 6e73 666f 726d 5f72 2c0a 2020 2020  ransform_r,.    
+000153e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000153f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015400: 2020 2020 2020 2020 2073 656c 662e 6461           self.da
+00015410: 7461 2e6e 7061 7261 6d73 2c20 2a2a 645f  ta.nparams, **d_
+00015420: 6172 6773 290a 0a20 2020 2020 2020 2020  args)..         
+00015430: 2020 2020 2020 2020 2020 2023 204e 6f77             # Now
+00015440: 2064 6f20 7468 6520 7361 6d65 2066 6f72   do the same for
+00015450: 2074 6865 2061 6374 7561 6c20 7361 6d70   the actual samp
+00015460: 6c65 723a 0a20 2020 2020 2020 2020 2020  ler:.           
+00015470: 2020 2020 2020 2020 2061 7267 7320 3d20           args = 
+00015480: 7661 7273 2873 616d 706c 6572 292e 6b65  vars(sampler).ke
+00015490: 7973 2829 0a20 2020 2020 2020 2020 2020  ys().           
+000154a0: 2020 2020 2020 2020 2064 735f 6172 6773           ds_args
+000154b0: 203d 207b 7d0a 0a20 2020 2020 2020 2020   = {}..         
+000154c0: 2020 2020 2020 2020 2020 2023 204c 6f61             # Loa
+000154d0: 6420 6f6e 6573 2066 726f 6d20 6b77 6172  d ones from kwar
+000154e0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+000154f0: 2020 2020 2020 2020 666f 7220 6172 6720          for arg 
+00015500: 696e 2061 7267 733a 0a20 2020 2020 2020  in args:.       
+00015510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015520: 2069 6620 6172 6720 696e 206b 7761 7267   if arg in kwarg
+00015530: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00015540: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00015550: 735f 6172 6773 5b61 7267 5d20 3d20 6b77  s_args[arg] = kw
+00015560: 6172 6773 5b61 7267 5d0a 0a20 2020 2020  args[arg]..     
+00015570: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00015580: 204e 6f77 2072 756e 3a0a 2020 2020 2020   Now run:.      
+00015590: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+000155a0: 6d70 6c65 722e 7275 6e5f 6e65 7374 6564  mpler.run_nested
+000155b0: 282a 2a64 735f 6172 6773 290a 0a20 2020  (**ds_args)..   
+000155c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000155d0: 2023 2041 6e64 2065 7874 7261 6374 2072   # And extract r
+000155e0: 6573 756c 7473 0a20 2020 2020 2020 2020  esults.         
+000155f0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00015600: 7473 203d 2073 616d 706c 6572 2e72 6573  ts = sampler.res
+00015610: 756c 7473 0a0a 2020 2020 2020 2020 2020  ults..          
+00015620: 2020 2020 2020 656c 7365 3a0a 0a20 2020        else:..   
+00015630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015640: 2023 2042 6566 6f72 6520 7275 6e6e 696e   # Before runnin
+00015650: 6720 7468 6520 7768 6f6c 6520 6d75 6c74  g the whole mult
+00015660: 6974 6872 6561 6420 6d61 6769 632c 206d  ithread magic, m
+00015670: 6174 6368 206b 7761 7267 7320 7769 7468  atch kwargs with
+00015680: 2066 756e 6374 696f 6e61 6c20 6172 6775   functional argu
+00015690: 6d65 6e74 7320 2874 7279 2d65 7863 6570  ments (try-excep
+000156a0: 7420 0a20 2020 2020 2020 2020 2020 2020  t .             
+000156b0: 2020 2020 2020 2023 2066 6f72 2062 6163         # for bac
+000156c0: 6b2d 636f 6d70 6174 6962 696c 6974 7920  k-compatibility 
+000156d0: 7769 7468 2070 7269 6f72 2064 796e 6573  with prior dynes
+000156e0: 7479 2076 6572 7369 6f6e 7329 3a0a 2020  ty versions):.  
+000156f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015700: 2020 7472 793a 200a 0a20 2020 2020 2020    try: ..       
+00015710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015720: 2061 7267 7320 3d20 7661 7273 2844 796e   args = vars(Dyn
+00015730: 6573 7479 5361 6d70 6c65 7229 5b27 5f5f  estySampler)['__
+00015740: 696e 6974 5f5f 275d 2e5f 5f63 6f64 655f  init__'].__code_
+00015750: 5f2e 636f 5f76 6172 6e61 6d65 730a 0a20  _.co_varnames.. 
+00015760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015770: 2020 2065 7863 6570 743a 0a0a 2020 2020     except:..    
 00015780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015790: 2020 2020 2020 2020 645f 6172 6773 5b61          d_args[a
-000157a0: 7267 5d20 3d20 6b77 6172 6773 5b61 7267  rg] = kwargs[arg
-000157b0: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
-000157c0: 2020 2020 2020 2023 204e 6f77 2064 6566         # Now def
-000157d0: 696e 6520 6120 6d6f 636b 2073 616d 706c  ine a mock sampl
-000157e0: 6572 2074 6f20 7265 7472 6965 7665 2076  er to retrieve v
-000157f0: 6172 6961 626c 6520 6e61 6d65 733a 0a20  ariable names:. 
-00015800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015810: 2020 206d 6f63 6b5f 7361 6d70 6c65 7220     mock_sampler 
-00015820: 3d20 4479 6e65 7374 7953 616d 706c 6572  = DynestySampler
-00015830: 2873 656c 662e 6c6f 676c 696b 652c 0a20  (self.loglike,. 
-00015840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015870: 2073 656c 662e 7072 696f 725f 7472 616e   self.prior_tran
-00015880: 7366 6f72 6d5f 722c 0a20 2020 2020 2020  sform_r,.       
-00015890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015790: 2020 2020 6172 6773 203d 2076 6172 7328      args = vars(
+000157a0: 4479 6e65 7374 7953 616d 706c 6572 292e  DynestySampler).
+000157b0: 6b65 7973 2829 0a0a 2020 2020 2020 2020  keys()..        
+000157c0: 2020 2020 2020 2020 2020 2020 645f 6172              d_ar
+000157d0: 6773 203d 207b 7d0a 0a20 2020 2020 2020  gs = {}..       
+000157e0: 2020 2020 2020 2020 2020 2020 2023 2044               # D
+000157f0: 6566 696e 6520 736f 6d65 2073 7461 6e64  efine some stand
+00015800: 6172 6420 6f6e 6573 2028 666f 7220 6261  ard ones (for ba
+00015810: 636b 2d63 6f6d 7061 7469 6269 6c69 7479  ck-compatibility
+00015820: 2077 6974 6820 7072 6576 696f 7573 206a   with previous j
+00015830: 756c 6965 7420 7665 7273 696f 6e73 293a  uliet versions):
+00015840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015850: 2020 2020 2064 5f61 7267 735b 2762 6f75       d_args['bou
+00015860: 6e64 275d 203d 2027 6d75 6c74 6927 0a20  nd'] = 'multi'. 
+00015870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015880: 2020 2064 5f61 7267 735b 2773 616d 706c     d_args['sampl
+00015890: 6527 5d20 3d20 2772 7761 6c6b 270a 2020  e'] = 'rwalk'.  
 000158a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000158b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000158c0: 6461 7461 2e6e 7061 7261 6d73 2c20 2a2a  data.nparams, **
-000158d0: 645f 6172 6773 290a 2020 2020 2020 2020  d_args).        
-000158e0: 2020 2020 2020 2020 2020 2020 2320 4578              # Ex
-000158f0: 7472 6163 7420 6172 6773 3a0a 2020 2020  tract args:.    
-00015900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015910: 6172 6773 203d 2076 6172 7328 6d6f 636b  args = vars(mock
-00015920: 5f73 616d 706c 6572 292e 6b65 7973 2829  _sampler).keys()
-00015930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015940: 2020 2020 2064 735f 6172 6773 203d 207b       ds_args = {
-00015950: 7d0a 0a20 2020 2020 2020 2020 2020 2020  }..             
-00015960: 2020 2020 2020 2023 204c 6f61 6420 6f6e         # Load on
-00015970: 6573 2066 726f 6d20 6b77 6172 6773 3a0a  es from kwargs:.
-00015980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015990: 2020 2020 666f 7220 6172 6720 696e 2061      for arg in a
-000159a0: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-000159b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000159c0: 6172 6720 696e 206b 7761 7267 733a 0a20  arg in kwargs:. 
-000159d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000159e0: 2020 2020 2020 2020 2020 2064 735f 6172             ds_ar
-000159f0: 6773 5b61 7267 5d20 3d20 6b77 6172 6773  gs[arg] = kwargs
-00015a00: 5b61 7267 5d0a 0a20 2020 2020 2020 2020  [arg]..         
-00015a10: 2020 2020 2020 2020 2020 2023 204e 6f77             # Now
-00015a20: 2072 756e 2061 6c6c 2077 6974 6820 6d75   run all with mu
-00015a30: 6c74 6970 726f 6365 7373 696e 673a 0a20  ltiprocessing:. 
-00015a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015a50: 2020 2077 6974 6820 636f 6e74 6578 746c     with contextl
-00015a60: 6962 2e63 6c6f 7369 6e67 2850 6f6f 6c28  ib.closing(Pool(
-00015a70: 7072 6f63 6573 7365 733d 7365 6c66 2e6e  processes=self.n
-00015a80: 7468 7265 6164 7320 2d0a 2020 2020 2020  threads -.      
-00015a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ab0: 2020 2020 2020 2020 2020 2031 2929 2061             1)) a
-00015ac0: 7320 6578 6563 7574 6f72 3a0a 2020 2020  s executor:.    
-00015ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ae0: 2020 2020 7361 6d70 6c65 7220 3d20 4479      sampler = Dy
-00015af0: 6e65 7374 7953 616d 706c 6572 2873 656c  nestySampler(sel
-00015b00: 662e 6c6f 676c 696b 652c 0a20 2020 2020  f.loglike,.     
-00015b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00015b40: 2e70 7269 6f72 5f74 7261 6e73 666f 726d  .prior_transform
-00015b50: 5f72 2c0a 2020 2020 2020 2020 2020 2020  _r,.            
-00015b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b80: 2020 2020 2073 656c 662e 6461 7461 2e6e       self.data.n
-00015b90: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
-00015ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000158b0: 2020 645f 6172 6773 5b27 6e6c 6976 6527    d_args['nlive'
+000158c0: 5d20 3d20 7365 6c66 2e6e 5f6c 6976 655f  ] = self.n_live_
+000158d0: 706f 696e 7473 0a0a 2020 2020 2020 2020  points..        
+000158e0: 2020 2020 2020 2020 2020 2020 2320 4d61              # Ma
+000158f0: 7463 6820 7468 656d 2077 6974 6820 6b77  tch them with kw
+00015900: 6172 6773 3a0a 2020 2020 2020 2020 2020  args:.          
+00015910: 2020 2020 2020 2020 2020 666f 7220 6172            for ar
+00015920: 6720 696e 2061 7267 733a 0a20 2020 2020  g in args:.     
+00015930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015940: 2020 2069 6620 6172 6720 696e 206b 7761     if arg in kwa
+00015950: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+00015960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015970: 2064 5f61 7267 735b 6172 675d 203d 206b   d_args[arg] = k
+00015980: 7761 7267 735b 6172 675d 0a0a 2020 2020  wargs[arg]..    
+00015990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000159a0: 2320 4e6f 7720 6465 6669 6e65 2061 206d  # Now define a m
+000159b0: 6f63 6b20 7361 6d70 6c65 7220 746f 2072  ock sampler to r
+000159c0: 6574 7269 6576 6520 7661 7269 6162 6c65  etrieve variable
+000159d0: 206e 616d 6573 3a0a 2020 2020 2020 2020   names:.        
+000159e0: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
+000159f0: 5f73 616d 706c 6572 203d 2044 796e 6573  _sampler = Dynes
+00015a00: 7479 5361 6d70 6c65 7228 7365 6c66 2e6c  tySampler(self.l
+00015a10: 6f67 6c69 6b65 2c0a 2020 2020 2020 2020  oglike,.        
+00015a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015a40: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00015a50: 7269 6f72 5f74 7261 6e73 666f 726d 5f72  rior_transform_r
+00015a60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015a90: 2020 2020 7365 6c66 2e64 6174 612e 6e70      self.data.np
+00015aa0: 6172 616d 732c 202a 2a64 5f61 7267 7329  arams, **d_args)
+00015ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015ac0: 2020 2020 2023 2045 7874 7261 6374 2061       # Extract a
+00015ad0: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+00015ae0: 2020 2020 2020 2020 2061 7267 7320 3d20           args = 
+00015af0: 7661 7273 286d 6f63 6b5f 7361 6d70 6c65  vars(mock_sample
+00015b00: 7229 2e6b 6579 7328 290a 2020 2020 2020  r).keys().      
+00015b10: 2020 2020 2020 2020 2020 2020 2020 6473                ds
+00015b20: 5f61 7267 7320 3d20 7b7d 0a0a 2020 2020  _args = {}..    
+00015b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b40: 2320 4c6f 6164 206f 6e65 7320 6672 6f6d  # Load ones from
+00015b50: 206b 7761 7267 733a 0a20 2020 2020 2020   kwargs:.       
+00015b60: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00015b70: 2061 7267 2069 6e20 6172 6773 3a0a 2020   arg in args:.  
+00015b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b90: 2020 2020 2020 6966 2061 7267 2069 6e20        if arg in 
+00015ba0: 6b77 6172 6773 3a0a 2020 2020 2020 2020  kwargs:.        
 00015bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015bc0: 2020 2020 2020 2020 2070 6f6f 6c3d 6578           pool=ex
-00015bd0: 6563 7574 6f72 2c0a 2020 2020 2020 2020  ecutor,.        
+00015bc0: 2020 2020 6473 5f61 7267 735b 6172 675d      ds_args[arg]
+00015bd0: 203d 206b 7761 7267 735b 6172 675d 0a0a   = kwargs[arg]..
 00015be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c00: 2020 2020 2020 2020 2071 7565 7565 5f73           queue_s
-00015c10: 697a 653d 7365 6c66 2e6e 7468 7265 6164  ize=self.nthread
-00015c20: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00015bf0: 2020 2020 2320 4e6f 7720 7275 6e20 616c      # Now run al
+00015c00: 6c20 7769 7468 206d 756c 7469 7072 6f63  l with multiproc
+00015c10: 6573 7369 6e67 3a0a 2020 2020 2020 2020  essing:.        
+00015c20: 2020 2020 2020 2020 2020 2020 2222 220a              """.
 00015c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c50: 2020 2020 2a2a 645f 6172 6773 290a 2020      **d_args).  
-00015c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c70: 2020 2020 2020 7361 6d70 6c65 722e 7275        sampler.ru
-00015c80: 6e5f 6e65 7374 6564 282a 2a64 735f 6172  n_nested(**ds_ar
-00015c90: 6773 290a 2020 2020 2020 2020 2020 2020  gs).            
-00015ca0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00015cb0: 6c74 7320 3d20 7361 6d70 6c65 722e 7265  lts = sampler.re
-00015cc0: 7375 6c74 730a 0a20 2020 2020 2020 2020  sults..         
-00015cd0: 2020 2020 2020 2023 2045 7874 7261 6374         # Extract
-00015ce0: 2064 796e 6573 7479 206f 7574 7075 7473   dynesty outputs
-00015cf0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015d00: 2020 6f75 745b 2764 796e 6573 7479 5f6f    out['dynesty_o
-00015d10: 7574 7075 7427 5d20 3d20 7265 7375 6c74  utput'] = result
-00015d20: 730a 0a20 2020 2020 2020 2020 2020 2020  s..             
-00015d30: 2020 2023 2047 6574 2077 6569 6768 7465     # Get weighte
-00015d40: 6420 706f 7374 6572 696f 723a 0a20 2020  d posterior:.   
-00015d50: 2020 2020 2020 2020 2020 2020 2077 6569               wei
-00015d60: 6768 7473 203d 206e 702e 6578 7028 7265  ghts = np.exp(re
-00015d70: 7375 6c74 735b 276c 6f67 7774 275d 202d  sults['logwt'] -
-00015d80: 2072 6573 756c 7473 5b27 6c6f 677a 275d   results['logz']
-00015d90: 5b2d 315d 290a 2020 2020 2020 2020 2020  [-1]).          
-00015da0: 2020 2020 2020 706f 7374 6572 696f 725f        posterior_
-00015db0: 7361 6d70 6c65 7320 3d20 7265 7361 6d70  samples = resamp
-00015dc0: 6c65 5f65 7175 616c 2872 6573 756c 7473  le_equal(results
-00015dd0: 2e73 616d 706c 6573 2c20 7765 6967 6874  .samples, weight
-00015de0: 7329 0a0a 2020 2020 2020 2020 2020 2020  s)..            
-00015df0: 2020 2020 2320 4765 7420 6c6e 5a3a 0a20      # Get lnZ:. 
-00015e00: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00015e10: 7574 5b27 6c6e 5a27 5d20 3d20 7265 7375  ut['lnZ'] = resu
-00015e20: 6c74 732e 6c6f 677a 5b2d 315d 0a20 2020  lts.logz[-1].   
-00015e30: 2020 2020 2020 2020 2020 2020 206f 7574               out
-00015e40: 5b27 6c6e 5a65 7272 275d 203d 2072 6573  ['lnZerr'] = res
-00015e50: 756c 7473 2e6c 6f67 7a65 7272 5b2d 315d  ults.logzerr[-1]
-00015e60: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00015e70: 6966 2027 656d 6365 6527 2069 6e20 7365  if 'emcee' in se
-00015e80: 6c66 2e73 616d 706c 6572 3a0a 2020 2020  lf.sampler:.    
-00015e90: 2020 2020 2020 2020 2020 2020 2320 496e              # In
-00015ea0: 6974 6961 7465 2073 7461 7274 696e 6720  itiate starting 
-00015eb0: 706f 696e 7420 666f 7220 6561 6368 2077  point for each w
-00015ec0: 616c 6b65 722e 2054 6f20 7468 6973 2065  alker. To this e
-00015ed0: 6e64 2c20 6669 7273 7420 6c6f 6164 2073  nd, first load s
-00015ee0: 7461 7274 696e 6720 7661 6c75 6573 2e0a  tarting values..
-00015ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f00: 696e 6974 6961 6c5f 706f 7369 7469 6f6e  initial_position
-00015f10: 203d 206e 702e 6172 7261 7928 5b5d 290a   = np.array([]).
-00015f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f30: 666f 7220 706e 616d 6520 696e 2073 656c  for pname in sel
-00015f40: 662e 6d6f 6465 6c5f 7061 7261 6d65 7465  f.model_paramete
-00015f50: 7273 3a0a 0a20 2020 2020 2020 2020 2020  rs:..           
-00015f60: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00015f70: 2e64 6174 612e 7072 696f 7273 5b70 6e61  .data.priors[pna
-00015f80: 6d65 5d5b 2764 6973 7472 6962 7574 696f  me]['distributio
-00015f90: 6e27 5d20 213d 2027 6669 7865 6427 3a0a  n'] != 'fixed':.
-00015fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015fb0: 2020 2020 2020 2020 2069 6e69 7469 616c           initial
-00015fc0: 5f70 6f73 6974 696f 6e20 3d20 6e70 2e61  _position = np.a
-00015fd0: 7070 656e 6428 696e 6974 6961 6c5f 706f  ppend(initial_po
-00015fe0: 7369 7469 6f6e 2c0a 2020 2020 2020 2020  sition,.        
+00015c40: 2020 2020 7769 7468 2063 6f6e 7465 7874      with context
+00015c50: 6c69 622e 636c 6f73 696e 6728 506f 6f6c  lib.closing(Pool
+00015c60: 2870 726f 6365 7373 6573 3d73 656c 662e  (processes=self.
+00015c70: 6e74 6872 6561 6473 202d 0a20 2020 2020  nthreads -.     
+00015c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ca0: 2020 2020 2020 2020 2020 2020 3129 2920              1)) 
+00015cb0: 6173 2065 7865 6375 746f 723a 0a20 2020  as executor:.   
+00015cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015cd0: 2020 2020 2073 616d 706c 6572 203d 2044       sampler = D
+00015ce0: 796e 6573 7479 5361 6d70 6c65 7228 7365  ynestySampler(se
+00015cf0: 6c66 2e6c 6f67 6c69 6b65 2c0a 2020 2020  lf.loglike,.    
+00015d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d20: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00015d30: 662e 7072 696f 725f 7472 616e 7366 6f72  f.prior_transfor
+00015d40: 6d5f 722c 0a20 2020 2020 2020 2020 2020  m_r,.           
+00015d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d70: 2020 2020 2020 7365 6c66 2e64 6174 612e        self.data.
+00015d80: 6e70 6172 616d 732c 0a20 2020 2020 2020  nparams,.       
+00015d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015db0: 2020 2020 2020 2020 2020 706f 6f6c 3d65            pool=e
+00015dc0: 7865 6375 746f 722c 0a20 2020 2020 2020  xecutor,.       
+00015dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015df0: 2020 2020 2020 2020 2020 7175 6575 655f            queue_
+00015e00: 7369 7a65 3d73 656c 662e 6e74 6872 6561  size=self.nthrea
+00015e10: 6473 2c0a 2020 2020 2020 2020 2020 2020  ds,.            
+00015e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015e40: 2020 2020 202a 2a64 5f61 7267 7329 0a20       **d_args). 
+00015e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015e60: 2020 2020 2020 2073 616d 706c 6572 2e72         sampler.r
+00015e70: 756e 5f6e 6573 7465 6428 2a2a 6473 5f61  un_nested(**ds_a
+00015e80: 7267 7329 0a20 2020 2020 2020 2020 2020  rgs).           
+00015e90: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00015ea0: 756c 7473 203d 2073 616d 706c 6572 2e72  ults = sampler.r
+00015eb0: 6573 756c 7473 0a0a 2020 2020 2020 2020  esults..        
+00015ec0: 2020 2020 2020 2020 2020 2020 2222 220a              """.
+00015ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ee0: 2020 2020 7769 7468 206d 702e 506f 6f6c      with mp.Pool
+00015ef0: 2873 656c 662e 6e74 6872 6561 6473 2920  (self.nthreads) 
+00015f00: 6173 2070 6f6f 6c3a 0a0a 2020 2020 2020  as pool:..      
+00015f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f20: 2020 7361 6d70 6c65 7220 3d20 4479 6e65    sampler = Dyne
+00015f30: 7374 7953 616d 706c 6572 2873 656c 662e  stySampler(self.
+00015f40: 6c6f 676c 696b 652c 0a20 2020 2020 2020  loglike,.       
+00015f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f70: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00015f80: 7269 6f72 5f74 7261 6e73 666f 726d 5f72  rior_transform_r
+00015f90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015fc0: 2020 2073 656c 662e 6461 7461 2e6e 7061     self.data.npa
+00015fd0: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
+00015fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00015ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016010: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00016020: 662e 706f 7374 6572 696f 7273 5b70 6e61  f.posteriors[pna
-00016030: 6d65 5d29 0a0a 2020 2020 2020 2020 2020  me])..          
-00016040: 2020 2020 2020 2320 5065 7274 7572 6220        # Perturb 
-00016050: 696e 6974 6961 6c20 706f 7369 7469 6f6e  initial position
-00016060: 2066 6f72 2065 6163 6820 6f66 2074 6865   for each of the
-00016070: 2077 616c 6b65 7273 3a0a 2020 2020 2020   walkers:.      
-00016080: 2020 2020 2020 2020 2020 706f 7320 3d20            pos = 
-00016090: 696e 6974 6961 6c5f 706f 7369 7469 6f6e  initial_position
-000160a0: 202b 2073 656c 662e 656d 6365 655f 6661   + self.emcee_fa
-000160b0: 6374 6f72 202a 206e 702e 7261 6e64 6f6d  ctor * np.random
-000160c0: 2e72 616e 646e 280a 2020 2020 2020 2020  .randn(.        
-000160d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000160e0: 2e6e 7761 6c6b 6572 732c 206c 656e 2869  .nwalkers, len(i
-000160f0: 6e69 7469 616c 5f70 6f73 6974 696f 6e29  nitial_position)
-00016100: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00016110: 2020 2023 2042 6566 6f72 6520 7065 7266     # Before perf
-00016120: 6f72 6d69 6e67 2074 6865 2073 616d 706c  orming the sampl
-00016130: 696e 672c 2063 6174 6368 2061 6e79 206b  ing, catch any k
-00016140: 7761 7267 7320 7468 6174 2067 6f20 746f  wargs that go to
-00016150: 2045 6e73 656d 626c 6553 616d 706c 6572   EnsembleSampler
-00016160: 3b20 7265 7374 206f 6620 6b77 6172 6773  ; rest of kwargs
-00016170: 2061 7265 2061 7373 756d 6564 2074 6f20   are assumed to 
-00016180: 676f 0a20 2020 2020 2020 2020 2020 2020  go.             
-00016190: 2020 2023 2074 6f20 7275 6e5f 6d63 6d63     # to run_mcmc
-000161a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000161b0: 2020 6172 6773 203d 2065 6d63 6565 2e45    args = emcee.E
-000161c0: 6e73 656d 626c 6553 616d 706c 6572 2e5f  nsembleSampler._
-000161d0: 5f69 6e69 745f 5f2e 5f5f 636f 6465 5f5f  _init__.__code__
-000161e0: 2e63 6f5f 7661 726e 616d 6573 0a20 2020  .co_varnames.   
-000161f0: 2020 2020 2020 2020 2020 2020 2045 535f               ES_
-00016200: 6172 6773 203d 207b 7d0a 2020 2020 2020  args = {}.      
-00016210: 2020 2020 2020 2020 2020 7275 6e6d 636d            runmcm
-00016220: 635f 6172 6773 203d 207b 7d0a 0a20 2020  c_args = {}..   
-00016230: 2020 2020 2020 2020 2020 2020 2023 204d               # M
-00016240: 6174 6368 2074 6865 6d20 7769 7468 206b  atch them with k
-00016250: 7761 7267 7320 286b 7761 7267 7320 7461  wargs (kwargs ta
-00016260: 6b65 2070 7265 6665 7265 6e63 6529 3a0a  ke preference):.
-00016270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016280: 666f 7220 6172 6720 696e 2061 7267 733a  for arg in args:
-00016290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000162a0: 2020 2020 2069 6620 6172 6720 696e 206b       if arg in k
-000162b0: 7761 7267 733a 0a20 2020 2020 2020 2020  wargs:.         
-000162c0: 2020 2020 2020 2020 2020 2020 2020 2045                 E
-000162d0: 535f 6172 6773 5b61 7267 5d20 3d20 6b77  S_args[arg] = kw
-000162e0: 6172 6773 5b61 7267 5d0a 2020 2020 2020  args[arg].      
-000162f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016300: 2020 6b77 6172 6773 2e70 6f70 2861 7267    kwargs.pop(arg
-00016310: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00016320: 2020 2023 204e 6f77 2070 6572 666f 726d     # Now perform
-00016330: 2074 6865 2073 616d 706c 696e 672e 2049   the sampling. I
-00016340: 6620 6e74 6872 6561 6473 2069 7320 6465  f nthreads is de
-00016350: 6669 6e65 642c 2070 6172 616c 6c65 6c69  fined, paralleli
-00016360: 7a65 2e20 4966 206e 6f74 2c20 676f 2074  ze. If not, go t
-00016370: 6865 2073 6572 6961 6c20 7761 793a 0a20  he serial way:. 
-00016380: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00016390: 6620 7365 6c66 2e6e 7468 7265 6164 7320  f self.nthreads 
-000163a0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-000163b0: 2020 2020 2020 2020 2020 2020 2073 616d               sam
-000163c0: 706c 6572 203d 2065 6d63 6565 2e45 6e73  pler = emcee.Ens
-000163d0: 656d 626c 6553 616d 706c 6572 2873 656c  embleSampler(sel
-000163e0: 662e 6e77 616c 6b65 7273 2c0a 2020 2020  f.nwalkers,.    
-000163f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016420: 7365 6c66 2e64 6174 612e 6e70 6172 616d  self.data.nparam
-00016430: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00016000: 2020 2020 2020 2070 6f6f 6c20 3d20 706f         pool = po
+00016010: 6f6c 2c20 0a20 2020 2020 2020 2020 2020  ol, .           
+00016020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016040: 2020 2020 2020 7175 6575 655f 7369 7a65        queue_size
+00016050: 3d73 656c 662e 6e74 6872 6561 6473 2c0a  =self.nthreads,.
+00016060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016090: 202a 2a64 5f61 7267 7329 0a0a 2020 2020   **d_args)..    
+000160a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000160b0: 2020 2020 7361 6d70 6c65 722e 7275 6e5f      sampler.run_
+000160c0: 6e65 7374 6564 282a 2a64 735f 6172 6773  nested(**ds_args
+000160d0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+000160e0: 2020 2020 2020 2072 6573 756c 7473 203d         results =
+000160f0: 2073 616d 706c 6572 2e72 6573 756c 7473   sampler.results
+00016100: 200a 0a20 2020 2020 2020 2020 2020 2020   ..             
+00016110: 2020 2023 2045 7874 7261 6374 2064 796e     # Extract dyn
+00016120: 6573 7479 206f 7574 7075 7473 3a0a 2020  esty outputs:.  
+00016130: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
+00016140: 745b 2764 796e 6573 7479 5f6f 7574 7075  t['dynesty_outpu
+00016150: 7427 5d20 3d20 7265 7375 6c74 730a 0a20  t'] = results.. 
+00016160: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00016170: 2047 6574 2077 6569 6768 7465 6420 706f   Get weighted po
+00016180: 7374 6572 696f 723a 0a20 2020 2020 2020  sterior:.       
+00016190: 2020 2020 2020 2020 2077 6569 6768 7473           weights
+000161a0: 203d 206e 702e 6578 7028 7265 7375 6c74   = np.exp(result
+000161b0: 735b 276c 6f67 7774 275d 202d 2072 6573  s['logwt'] - res
+000161c0: 756c 7473 5b27 6c6f 677a 275d 5b2d 315d  ults['logz'][-1]
+000161d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000161e0: 2020 706f 7374 6572 696f 725f 7361 6d70    posterior_samp
+000161f0: 6c65 7320 3d20 7265 7361 6d70 6c65 5f65  les = resample_e
+00016200: 7175 616c 2872 6573 756c 7473 2e73 616d  qual(results.sam
+00016210: 706c 6573 2c20 7765 6967 6874 7329 0a0a  ples, weights)..
+00016220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016230: 2320 4765 7420 6c6e 5a3a 0a20 2020 2020  # Get lnZ:.     
+00016240: 2020 2020 2020 2020 2020 206f 7574 5b27             out['
+00016250: 6c6e 5a27 5d20 3d20 7265 7375 6c74 732e  lnZ'] = results.
+00016260: 6c6f 677a 5b2d 315d 0a20 2020 2020 2020  logz[-1].       
+00016270: 2020 2020 2020 2020 206f 7574 5b27 6c6e           out['ln
+00016280: 5a65 7272 275d 203d 2072 6573 756c 7473  Zerr'] = results
+00016290: 2e6c 6f67 7a65 7272 5b2d 315d 0a0a 2020  .logzerr[-1]..  
+000162a0: 2020 2020 2020 2020 2020 656c 6966 2027            elif '
+000162b0: 656d 6365 6527 2069 6e20 7365 6c66 2e73  emcee' in self.s
+000162c0: 616d 706c 6572 3a0a 2020 2020 2020 2020  ampler:.        
+000162d0: 2020 2020 2020 2020 2320 496e 6974 6961          # Initia
+000162e0: 7465 2073 7461 7274 696e 6720 706f 696e  te starting poin
+000162f0: 7420 666f 7220 6561 6368 2077 616c 6b65  t for each walke
+00016300: 722e 2054 6f20 7468 6973 2065 6e64 2c20  r. To this end, 
+00016310: 6669 7273 7420 6c6f 6164 2073 7461 7274  first load start
+00016320: 696e 6720 7661 6c75 6573 2e0a 2020 2020  ing values..    
+00016330: 2020 2020 2020 2020 2020 2020 696e 6974              init
+00016340: 6961 6c5f 706f 7369 7469 6f6e 203d 206e  ial_position = n
+00016350: 702e 6172 7261 7928 5b5d 290a 2020 2020  p.array([]).    
+00016360: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00016370: 706e 616d 6520 696e 2073 656c 662e 6d6f  pname in self.mo
+00016380: 6465 6c5f 7061 7261 6d65 7465 7273 3a0a  del_parameters:.
+00016390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000163a0: 2020 2020 2069 6620 7365 6c66 2e64 6174       if self.dat
+000163b0: 612e 7072 696f 7273 5b70 6e61 6d65 5d5b  a.priors[pname][
+000163c0: 2764 6973 7472 6962 7574 696f 6e27 5d20  'distribution'] 
+000163d0: 213d 2027 6669 7865 6427 3a0a 0a20 2020  != 'fixed':..   
+000163e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000163f0: 2020 2020 2069 6e69 7469 616c 5f70 6f73       initial_pos
+00016400: 6974 696f 6e20 3d20 6e70 2e61 7070 656e  ition = np.appen
+00016410: 6428 696e 6974 6961 6c5f 706f 7369 7469  d(initial_positi
+00016420: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00016430: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016460: 2020 2020 2020 2073 656c 662e 6c6f 6770         self.logp
-00016470: 726f 622c 202a 2a45 535f 6172 6773 290a  rob, **ES_args).
-00016480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016490: 2020 2020 7361 6d70 6c65 722e 7275 6e5f      sampler.run_
-000164a0: 6d63 6d63 2870 6f73 2c20 7365 6c66 2e6e  mcmc(pos, self.n
-000164b0: 7374 6570 7320 2b20 7365 6c66 2e6e 6275  steps + self.nbu
-000164c0: 726e 696e 2c20 2a2a 6b77 6172 6773 290a  rnin, **kwargs).
-000164d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000164e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000164f0: 2020 2020 2020 2020 2020 7769 7468 2063            with c
-00016500: 6f6e 7465 7874 6c69 622e 636c 6f73 696e  ontextlib.closin
-00016510: 6728 506f 6f6c 2870 726f 6365 7373 6573  g(Pool(processes
-00016520: 3d73 656c 662e 6e74 6872 6561 6473 202d  =self.nthreads -
-00016530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016560: 2020 3129 2920 6173 2065 7865 6375 746f    1)) as executo
-00016570: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
-00016580: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
-00016590: 6572 203d 2065 6d63 6565 2e45 6e73 656d  er = emcee.Ensem
-000165a0: 626c 6553 616d 706c 6572 2873 656c 662e  bleSampler(self.
-000165b0: 6e77 616c 6b65 7273 2c0a 2020 2020 2020  nwalkers,.      
-000165c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000165d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000165e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000165f0: 2020 7365 6c66 2e64 6174 612e 6e70 6172    self.data.npar
-00016600: 616d 732c 0a20 2020 2020 2020 2020 2020  ams,.           
-00016610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016630: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00016640: 662e 6c6f 6770 726f 622c 0a20 2020 2020  f.logprob,.     
-00016650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016680: 2020 2070 6f6f 6c3d 6578 6563 7574 6f72     pool=executor
-00016690: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000166a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000166b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000166c0: 2020 2020 2020 2020 2020 2a2a 4553 5f61            **ES_a
-000166d0: 7267 7329 0a20 2020 2020 2020 2020 2020  rgs).           
-000166e0: 2020 2020 2020 2020 2020 2020 2073 616d               sam
-000166f0: 706c 6572 2e72 756e 5f6d 636d 6328 706f  pler.run_mcmc(po
-00016700: 732c 2073 656c 662e 6e73 7465 7073 202b  s, self.nsteps +
-00016710: 2073 656c 662e 6e62 7572 6e69 6e2c 0a20   self.nburnin,. 
-00016720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016740: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
-00016750: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00016760: 2020 2023 2053 746f 7265 2070 6f73 7465     # Store poste
-00016770: 7269 6f72 2073 616d 706c 6573 2e20 4669  rior samples. Fi
-00016780: 7273 742c 2073 746f 7265 2074 6865 2073  rst, store the s
-00016790: 616d 706c 6573 2066 6f72 2065 6163 6820  amples for each 
-000167a0: 7761 6c6b 6572 3a0a 2020 2020 2020 2020  walker:.        
-000167b0: 2020 2020 2020 2020 6f75 745b 2770 6f73          out['pos
-000167c0: 7465 7269 6f72 735f 7065 725f 7761 6c6b  teriors_per_walk
-000167d0: 6572 275d 203d 2073 616d 706c 6572 2e67  er'] = sampler.g
-000167e0: 6574 5f63 6861 696e 2829 0a0a 2020 2020  et_chain()..    
-000167f0: 2020 2020 2020 2020 2020 2020 2320 416e              # An
-00016800: 6420 6e6f 7720 7374 6f72 6520 706f 7374  d now store post
-00016810: 6572 696f 7273 2077 6974 6820 616c 6c20  eriors with all 
-00016820: 7761 6c6b 6572 7320 666c 6174 7465 6e65  walkers flattene
-00016830: 6420 6f75 743a 0a20 2020 2020 2020 2020  d out:.         
-00016840: 2020 2020 2020 2070 6f73 7465 7269 6f72         posterior
-00016850: 5f73 616d 706c 6573 203d 2073 616d 706c  _samples = sampl
-00016860: 6572 2e67 6574 5f63 6861 696e 2864 6973  er.get_chain(dis
-00016870: 6361 7264 3d73 656c 662e 6e62 7572 6e69  card=self.nburni
-00016880: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
+00016450: 2020 2020 2020 2020 2073 656c 662e 706f           self.po
+00016460: 7374 6572 696f 7273 5b70 6e61 6d65 5d29  steriors[pname])
+00016470: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00016480: 2020 2320 5065 7274 7572 6220 696e 6974    # Perturb init
+00016490: 6961 6c20 706f 7369 7469 6f6e 2066 6f72  ial position for
+000164a0: 2065 6163 6820 6f66 2074 6865 2077 616c   each of the wal
+000164b0: 6b65 7273 3a0a 2020 2020 2020 2020 2020  kers:.          
+000164c0: 2020 2020 2020 706f 7320 3d20 696e 6974        pos = init
+000164d0: 6961 6c5f 706f 7369 7469 6f6e 202b 2073  ial_position + s
+000164e0: 656c 662e 656d 6365 655f 6661 6374 6f72  elf.emcee_factor
+000164f0: 202a 206e 702e 7261 6e64 6f6d 2e72 616e   * np.random.ran
+00016500: 646e 280a 2020 2020 2020 2020 2020 2020  dn(.            
+00016510: 2020 2020 2020 2020 7365 6c66 2e6e 7761          self.nwa
+00016520: 6c6b 6572 732c 206c 656e 2869 6e69 7469  lkers, len(initi
+00016530: 616c 5f70 6f73 6974 696f 6e29 290a 0a20  al_position)).. 
+00016540: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00016550: 2042 6566 6f72 6520 7065 7266 6f72 6d69   Before performi
+00016560: 6e67 2074 6865 2073 616d 706c 696e 672c  ng the sampling,
+00016570: 2063 6174 6368 2061 6e79 206b 7761 7267   catch any kwarg
+00016580: 7320 7468 6174 2067 6f20 746f 2045 6e73  s that go to Ens
+00016590: 656d 626c 6553 616d 706c 6572 3b20 7265  embleSampler; re
+000165a0: 7374 206f 6620 6b77 6172 6773 2061 7265  st of kwargs are
+000165b0: 2061 7373 756d 6564 2074 6f20 676f 0a20   assumed to go. 
+000165c0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+000165d0: 2074 6f20 7275 6e5f 6d63 6d63 3a0a 2020   to run_mcmc:.  
+000165e0: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+000165f0: 6773 203d 2065 6d63 6565 2e45 6e73 656d  gs = emcee.Ensem
+00016600: 626c 6553 616d 706c 6572 2e5f 5f69 6e69  bleSampler.__ini
+00016610: 745f 5f2e 5f5f 636f 6465 5f5f 2e63 6f5f  t__.__code__.co_
+00016620: 7661 726e 616d 6573 0a20 2020 2020 2020  varnames.       
+00016630: 2020 2020 2020 2020 2045 535f 6172 6773           ES_args
+00016640: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
+00016650: 2020 2020 2020 7275 6e6d 636d 635f 6172        runmcmc_ar
+00016660: 6773 203d 207b 7d0a 0a20 2020 2020 2020  gs = {}..       
+00016670: 2020 2020 2020 2020 2023 204d 6174 6368           # Match
+00016680: 2074 6865 6d20 7769 7468 206b 7761 7267   them with kwarg
+00016690: 7320 286b 7761 7267 7320 7461 6b65 2070  s (kwargs take p
+000166a0: 7265 6665 7265 6e63 6529 3a0a 2020 2020  reference):.    
+000166b0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000166c0: 6172 6720 696e 2061 7267 733a 0a20 2020  arg in args:.   
+000166d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000166e0: 2069 6620 6172 6720 696e 206b 7761 7267   if arg in kwarg
+000166f0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00016700: 2020 2020 2020 2020 2020 2045 535f 6172             ES_ar
+00016710: 6773 5b61 7267 5d20 3d20 6b77 6172 6773  gs[arg] = kwargs
+00016720: 5b61 7267 5d0a 2020 2020 2020 2020 2020  [arg].          
+00016730: 2020 2020 2020 2020 2020 2020 2020 6b77                kw
+00016740: 6172 6773 2e70 6f70 2861 7267 290a 0a20  args.pop(arg).. 
+00016750: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00016760: 204e 6f77 2070 6572 666f 726d 2074 6865   Now perform the
+00016770: 2073 616d 706c 696e 672e 2049 6620 6e74   sampling. If nt
+00016780: 6872 6561 6473 2069 7320 6465 6669 6e65  hreads is define
+00016790: 642c 2070 6172 616c 6c65 6c69 7a65 2e20  d, parallelize. 
+000167a0: 4966 206e 6f74 2c20 676f 2074 6865 2073  If not, go the s
+000167b0: 6572 6961 6c20 7761 793a 0a20 2020 2020  erial way:.     
+000167c0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+000167d0: 6c66 2e6e 7468 7265 6164 7320 6973 204e  lf.nthreads is N
+000167e0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000167f0: 2020 2020 2020 2020 2073 616d 706c 6572           sampler
+00016800: 203d 2065 6d63 6565 2e45 6e73 656d 626c   = emcee.Ensembl
+00016810: 6553 616d 706c 6572 2873 656c 662e 6e77  eSampler(self.nw
+00016820: 616c 6b65 7273 2c0a 2020 2020 2020 2020  alkers,.        
+00016830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016850: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00016860: 2e64 6174 612e 6e70 6172 616d 732c 0a20  .data.nparams,. 
+00016870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016880: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000168a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000168b0: 2020 2020 2020 2020 2066 6c61 743d 5472           flat=Tr
-000168c0: 7565 290a 0a20 2020 2020 2020 2020 2020  ue)..           
-000168d0: 2065 6c69 6620 277a 6575 7327 2069 6e20   elif 'zeus' in 
-000168e0: 7365 6c66 2e73 616d 706c 6572 3a0a 2020  self.sampler:.  
-000168f0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00016900: 4964 656e 7469 6361 6c20 696d 706c 656d  Identical implem
-00016910: 656e 7461 7469 6f6e 2074 6f20 656d 6365  entation to emce
-00016920: 652e 2e2e 3f0a 2020 2020 2020 2020 2020  e...?.          
-00016930: 2020 2020 2020 2320 496e 6974 6961 7465        # Initiate
-00016940: 2073 7461 7274 696e 6720 706f 696e 7420   starting point 
-00016950: 666f 7220 6561 6368 2077 616c 6b65 722e  for each walker.
-00016960: 2054 6f20 7468 6973 2065 6e64 2c20 6669   To this end, fi
-00016970: 7273 7420 6c6f 6164 2073 7461 7274 696e  rst load startin
-00016980: 6720 7661 6c75 6573 2e0a 2020 2020 2020  g values..      
-00016990: 2020 2020 2020 2020 2020 696e 6974 6961            initia
-000169a0: 6c5f 706f 7369 7469 6f6e 203d 206e 702e  l_position = np.
-000169b0: 6172 7261 7928 5b5d 290a 2020 2020 2020  array([]).      
-000169c0: 2020 2020 2020 2020 2020 666f 7220 706e            for pn
-000169d0: 616d 6520 696e 2073 656c 662e 6d6f 6465  ame in self.mode
-000169e0: 6c5f 7061 7261 6d65 7465 7273 3a0a 2020  l_parameters:.  
-000169f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a00: 2020 6966 2073 656c 662e 6461 7461 2e70    if self.data.p
-00016a10: 7269 6f72 735b 706e 616d 655d 5b27 6469  riors[pname]['di
-00016a20: 7374 7269 6275 7469 6f6e 275d 2021 3d20  stribution'] != 
-00016a30: 2766 6978 6564 273a 0a20 2020 2020 2020  'fixed':.       
-00016a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a50: 2069 6e69 7469 616c 5f70 6f73 6974 696f   initial_positio
-00016a60: 6e20 3d20 6e70 2e61 7070 656e 6428 696e  n = np.append(in
-00016a70: 6974 6961 6c5f 706f 7369 7469 6f6e 2c20  itial_position, 
-00016a80: 7365 6c66 2e70 6f73 7465 7269 6f72 735b  self.posteriors[
-00016a90: 706e 616d 655d 290a 0a20 2020 2020 2020  pname])..       
-00016aa0: 2020 2020 2020 2020 2023 2050 6572 7475           # Pertu
-00016ab0: 7262 2069 6e69 7469 616c 2070 6f73 6974  rb initial posit
-00016ac0: 696f 6e20 666f 7220 6561 6368 206f 6620  ion for each of 
-00016ad0: 7468 6520 7761 6c6b 6572 733a 0a20 2020  the walkers:.   
-00016ae0: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
-00016af0: 203d 2069 6e69 7469 616c 5f70 6f73 6974   = initial_posit
-00016b00: 696f 6e20 2b20 7365 6c66 2e65 6d63 6565  ion + self.emcee
-00016b10: 5f66 6163 746f 7220 2a20 6e70 2e72 616e  _factor * np.ran
-00016b20: 646f 6d2e 7261 6e64 6e28 7365 6c66 2e6e  dom.randn(self.n
-00016b30: 7761 6c6b 6572 732c 206c 656e 2869 6e69  walkers, len(ini
-00016b40: 7469 616c 5f70 6f73 6974 696f 6e29 290a  tial_position)).
-00016b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016b60: 2023 2042 6566 6f72 6520 7065 7266 6f72   # Before perfor
-00016b70: 6d69 6e67 2074 6865 2073 616d 706c 696e  ming the samplin
-00016b80: 672c 2063 6174 6368 2061 6e79 206b 7761  g, catch any kwa
-00016b90: 7267 7320 7468 6174 2067 6f20 746f 2045  rgs that go to E
-00016ba0: 6e73 656d 626c 6553 616d 706c 6572 3b20  nsembleSampler; 
-00016bb0: 7265 7374 206f 6620 6b77 6172 6773 2061  rest of kwargs a
-00016bc0: 7265 2061 7373 756d 6564 2074 6f20 676f  re assumed to go
-00016bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016be0: 2023 2074 6f20 7275 6e5f 6d63 6d63 3a0a   # to run_mcmc:.
-00016bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c00: 6172 6773 203d 207a 6575 732e 456e 7365  args = zeus.Ense
-00016c10: 6d62 6c65 5361 6d70 6c65 722e 5f5f 696e  mbleSampler.__in
-00016c20: 6974 5f5f 2e5f 5f63 6f64 655f 5f2e 636f  it__.__code__.co
-00016c30: 5f76 6172 6e61 6d65 730a 2020 2020 2020  _varnames.      
-00016c40: 2020 2020 2020 2020 2020 7a65 7573 5f61            zeus_a
-00016c50: 7267 7320 3d20 7b7d 0a20 2020 2020 2020  rgs = {}.       
-00016c60: 2020 2020 2020 2020 2072 756e 6d63 6d63           runmcmc
-00016c70: 5f61 7267 7320 3d20 7b7d 0a0a 2020 2020  _args = {}..    
-00016c80: 2020 2020 2020 2020 2020 2020 2320 4d61              # Ma
-00016c90: 7463 6820 7468 656d 2077 6974 6820 6b77  tch them with kw
-00016ca0: 6172 6773 2028 6b77 6172 6773 2074 616b  args (kwargs tak
-00016cb0: 6520 7072 6566 6572 656e 6365 293a 0a20  e preference):. 
-00016cc0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00016cd0: 6f72 2061 7267 2069 6e20 6172 6773 3a0a  or arg in args:.
+000168a0: 2020 2073 656c 662e 6c6f 6770 726f 622c     self.logprob,
+000168b0: 202a 2a45 535f 6172 6773 290a 2020 2020   **ES_args).    
+000168c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000168d0: 7361 6d70 6c65 722e 7275 6e5f 6d63 6d63  sampler.run_mcmc
+000168e0: 2870 6f73 2c20 7365 6c66 2e6e 7374 6570  (pos, self.nstep
+000168f0: 7320 2b20 7365 6c66 2e6e 6275 726e 696e  s + self.nburnin
+00016900: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
+00016910: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00016920: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016930: 2020 2020 2020 7769 7468 2063 6f6e 7465        with conte
+00016940: 7874 6c69 622e 636c 6f73 696e 6728 506f  xtlib.closing(Po
+00016950: 6f6c 2870 726f 6365 7373 6573 3d73 656c  ol(processes=sel
+00016960: 662e 6e74 6872 6561 6473 202d 0a20 2020  f.nthreads -.   
+00016970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016990: 2020 2020 2020 2020 2020 2020 2020 3129                1)
+000169a0: 2920 6173 2065 7865 6375 746f 723a 0a20  ) as executor:. 
+000169b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169c0: 2020 2020 2020 2073 616d 706c 6572 203d         sampler =
+000169d0: 2065 6d63 6565 2e45 6e73 656d 626c 6553   emcee.EnsembleS
+000169e0: 616d 706c 6572 2873 656c 662e 6e77 616c  ampler(self.nwal
+000169f0: 6b65 7273 2c0a 2020 2020 2020 2020 2020  kers,.          
+00016a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a20: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00016a30: 6c66 2e64 6174 612e 6e70 6172 616d 732c  lf.data.nparams,
+00016a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a70: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+00016a80: 6770 726f 622c 0a20 2020 2020 2020 2020  gprob,.         
+00016a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ab0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00016ac0: 6f6f 6c3d 6578 6563 7574 6f72 2c0a 2020  ool=executor,.  
+00016ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b00: 2020 2020 2020 2a2a 4553 5f61 7267 7329        **ES_args)
+00016b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016b20: 2020 2020 2020 2020 2073 616d 706c 6572           sampler
+00016b30: 2e72 756e 5f6d 636d 6328 706f 732c 2073  .run_mcmc(pos, s
+00016b40: 656c 662e 6e73 7465 7073 202b 2073 656c  elf.nsteps + sel
+00016b50: 662e 6e62 7572 6e69 6e2c 0a20 2020 2020  f.nburnin,.     
+00016b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b80: 2020 2020 2a2a 6b77 6172 6773 290a 0a20      **kwargs).. 
+00016b90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00016ba0: 2053 746f 7265 2070 6f73 7465 7269 6f72   Store posterior
+00016bb0: 2073 616d 706c 6573 2e20 4669 7273 742c   samples. First,
+00016bc0: 2073 746f 7265 2074 6865 2073 616d 706c   store the sampl
+00016bd0: 6573 2066 6f72 2065 6163 6820 7761 6c6b  es for each walk
+00016be0: 6572 3a0a 2020 2020 2020 2020 2020 2020  er:.            
+00016bf0: 2020 2020 6f75 745b 2770 6f73 7465 7269      out['posteri
+00016c00: 6f72 735f 7065 725f 7761 6c6b 6572 275d  ors_per_walker']
+00016c10: 203d 2073 616d 706c 6572 2e67 6574 5f63   = sampler.get_c
+00016c20: 6861 696e 2829 0a0a 2020 2020 2020 2020  hain()..        
+00016c30: 2020 2020 2020 2020 2320 416e 6420 6e6f          # And no
+00016c40: 7720 7374 6f72 6520 706f 7374 6572 696f  w store posterio
+00016c50: 7273 2077 6974 6820 616c 6c20 7761 6c6b  rs with all walk
+00016c60: 6572 7320 666c 6174 7465 6e65 6420 6f75  ers flattened ou
+00016c70: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+00016c80: 2020 2070 6f73 7465 7269 6f72 5f73 616d     posterior_sam
+00016c90: 706c 6573 203d 2073 616d 706c 6572 2e67  ples = sampler.g
+00016ca0: 6574 5f63 6861 696e 2864 6973 6361 7264  et_chain(discard
+00016cb0: 3d73 656c 662e 6e62 7572 6e69 6e2c 0a20  =self.nburnin,. 
+00016cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cf0: 2020 2020 6966 2061 7267 2069 6e20 6b77      if arg in kw
-00016d00: 6172 6773 3a0a 2020 2020 2020 2020 2020  args:.          
-00016d10: 2020 2020 2020 2020 2020 2020 2020 7a65                ze
-00016d20: 7573 5f61 7267 735b 6172 675d 203d 206b  us_args[arg] = k
-00016d30: 7761 7267 735b 6172 675d 0a20 2020 2020  wargs[arg].     
-00016d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d50: 2020 206b 7761 7267 732e 706f 7028 6172     kwargs.pop(ar
-00016d60: 6729 0a0a 2020 2020 2020 2020 2020 2020  g)..            
-00016d70: 2020 2020 2320 4e6f 7720 7065 7266 6f72      # Now perfor
-00016d80: 6d20 7468 6520 7361 6d70 6c69 6e67 2e20  m the sampling. 
-00016d90: 4966 206e 7468 7265 6164 7320 6973 2064  If nthreads is d
-00016da0: 6566 696e 6564 2c20 7061 7261 6c6c 656c  efined, parallel
-00016db0: 697a 652e 2049 6620 6e6f 742c 2067 6f20  ize. If not, go 
-00016dc0: 7468 6520 7365 7269 616c 2077 6179 3a0a  the serial way:.
-00016dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016de0: 6966 2073 656c 662e 6e74 6872 6561 6473  if self.nthreads
-00016df0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00016e00: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-00016e10: 6d70 6c65 7220 3d20 7a65 7573 2e45 6e73  mpler = zeus.Ens
-00016e20: 656d 626c 6553 616d 706c 6572 2873 656c  embleSampler(sel
-00016e30: 662e 6e77 616c 6b65 7273 2c20 7365 6c66  f.nwalkers, self
-00016e40: 2e64 6174 612e 6e70 6172 616d 732c 2073  .data.nparams, s
-00016e50: 656c 662e 6c6f 6770 726f 622c 202a 2a7a  elf.logprob, **z
-00016e60: 6575 735f 6172 6773 290a 2020 2020 2020  eus_args).      
-00016e70: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-00016e80: 6d70 6c65 722e 7275 6e5f 6d63 6d63 2870  mpler.run_mcmc(p
-00016e90: 6f73 2c20 7365 6c66 2e6e 7374 6570 7320  os, self.nsteps 
-00016ea0: 2b20 7365 6c66 2e6e 6275 726e 696e 2c20  + self.nburnin, 
-00016eb0: 2a2a 6b77 6172 6773 290a 2020 2020 2020  **kwargs).      
-00016ec0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00016ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ee0: 2020 2020 7769 7468 2063 6f6e 7465 7874      with context
-00016ef0: 6c69 622e 636c 6f73 696e 6728 506f 6f6c  lib.closing(Pool
-00016f00: 2870 726f 6365 7373 6573 3d73 656c 662e  (processes=self.
-00016f10: 6e74 6872 6561 6473 2d31 2929 2061 7320  nthreads-1)) as 
-00016f20: 6578 6563 7574 6f72 3a0a 2020 2020 2020  executor:.      
-00016f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f40: 2020 7361 6d70 6c65 7220 3d20 7a65 7573    sampler = zeus
-00016f50: 2e45 6e73 656d 626c 6553 616d 706c 6572  .EnsembleSampler
-00016f60: 2873 656c 662e 6e77 616c 6b65 7273 2c20  (self.nwalkers, 
-00016f70: 7365 6c66 2e64 6174 612e 6e70 6172 616d  self.data.nparam
-00016f80: 732c 2073 656c 662e 6c6f 6770 726f 622c  s, self.logprob,
-00016f90: 2070 6f6f 6c20 3d20 6578 6563 7574 6f72   pool = executor
-00016fa0: 2c20 2a2a 7a65 7573 5f61 7267 7329 0a20  , **zeus_args). 
-00016fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016fc0: 2020 2020 2020 2073 616d 706c 6572 2e72         sampler.r
-00016fd0: 756e 5f6d 636d 6328 706f 732c 2073 656c  un_mcmc(pos, sel
-00016fe0: 662e 6e73 7465 7073 202b 2073 656c 662e  f.nsteps + self.
-00016ff0: 6e62 7572 6e69 6e2c 202a 2a6b 7761 7267  nburnin, **kwarg
-00017000: 7329 0a0a 2020 2020 2020 2020 2020 2020  s)..            
-00017010: 2020 2020 2320 5374 6f72 6520 706f 7374      # Store post
-00017020: 6572 696f 7220 7361 6d70 6c65 732e 2046  erior samples. F
-00017030: 6972 7374 2c20 7374 6f72 6520 7468 6520  irst, store the 
-00017040: 7361 6d70 6c65 7320 666f 7220 6561 6368  samples for each
-00017050: 2077 616c 6b65 723a 0a20 2020 2020 2020   walker:.       
-00017060: 2020 2020 2020 2020 206f 7574 5b27 706f           out['po
-00017070: 7374 6572 696f 7273 5f70 6572 5f77 616c  steriors_per_wal
-00017080: 6b65 7227 5d20 3d20 7361 6d70 6c65 722e  ker'] = sampler.
-00017090: 6765 745f 6368 6169 6e28 290a 0a20 2020  get_chain()..   
-000170a0: 2020 2020 2020 2020 2020 2020 2023 2041               # A
-000170b0: 6e64 206e 6f77 2073 746f 7265 2070 6f73  nd now store pos
-000170c0: 7465 7269 6f72 7320 7769 7468 2061 6c6c  teriors with all
-000170d0: 2077 616c 6b65 7273 2066 6c61 7474 656e   walkers flatten
-000170e0: 6564 206f 7574 3a0a 0a20 2020 2020 2020  ed out:..       
-000170f0: 2020 2020 2020 2020 2070 6f73 7465 7269           posteri
-00017100: 6f72 5f73 616d 706c 6573 203d 2073 616d  or_samples = sam
-00017110: 706c 6572 2e67 6574 5f63 6861 696e 2864  pler.get_chain(d
-00017120: 6973 6361 7264 203d 2073 656c 662e 6e62  iscard = self.nb
-00017130: 7572 6e69 6e2c 200a 2020 2020 2020 2020  urnin, .        
-00017140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017160: 2020 2020 2020 2020 2020 2020 2020 666c                fl
-00017170: 6174 203d 2054 7275 6529 0a0a 2020 2020  at = True)..    
-00017180: 2020 2020 2020 2020 2320 5361 7665 2070          # Save p
-00017190: 6f73 7465 7269 6f72 2073 616d 706c 6573  osterior samples
-000171a0: 2061 7320 6f75 7470 7574 7465 6420 6279   as outputted by
-000171b0: 204d 756c 7469 6e65 7374 2f44 796e 6573   Multinest/Dynes
-000171c0: 7479 3a0a 2020 2020 2020 2020 2020 2020  ty:.            
-000171d0: 6f75 745b 2770 6f73 7465 7269 6f72 5f73  out['posterior_s
-000171e0: 616d 706c 6573 275d 203d 207b 7d0a 2020  amples'] = {}.  
-000171f0: 2020 2020 2020 2020 2020 6f75 745b 2770            out['p
-00017200: 6f73 7465 7269 6f72 5f73 616d 706c 6573  osterior_samples
-00017210: 275d 5b27 756e 6e61 6d65 6427 5d20 3d20  ']['unnamed'] = 
-00017220: 706f 7374 6572 696f 725f 7361 6d70 6c65  posterior_sample
-00017230: 730a 0a20 2020 2020 2020 2020 2020 2023  s..            #
-00017240: 2053 6176 6520 6c6f 672d 6c69 6b65 6c69   Save log-likeli
-00017250: 686f 6f64 206f 6620 6561 6368 206f 6620  hood of each of 
-00017260: 7468 6520 7361 6d70 6c65 733a 0a20 2020  the samples:.   
-00017270: 2020 2020 2020 2020 206f 7574 5b27 706f           out['po
-00017280: 7374 6572 696f 725f 7361 6d70 6c65 7327  sterior_samples'
-00017290: 5d5b 276c 6f67 6c69 6b65 275d 203d 206e  ]['loglike'] = n
-000172a0: 702e 7a65 726f 7328 0a20 2020 2020 2020  p.zeros(.       
-000172b0: 2020 2020 2020 2020 2070 6f73 7465 7269           posteri
-000172c0: 6f72 5f73 616d 706c 6573 2e73 6861 7065  or_samples.shape
-000172d0: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
-000172e0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-000172f0: 706f 7374 6572 696f 725f 7361 6d70 6c65  posterior_sample
-00017300: 732e 7368 6170 655b 305d 293a 0a20 2020  s.shape[0]):.   
-00017310: 2020 2020 2020 2020 2020 2020 206f 7574               out
-00017320: 5b27 706f 7374 6572 696f 725f 7361 6d70  ['posterior_samp
-00017330: 6c65 7327 5d5b 276c 6f67 6c69 6b65 275d  les']['loglike']
-00017340: 5b69 5d20 3d20 7365 6c66 2e6c 6f67 6c69  [i] = self.logli
-00017350: 6b65 280a 2020 2020 2020 2020 2020 2020  ke(.            
-00017360: 2020 2020 2020 2020 706f 7374 6572 696f          posterio
-00017370: 725f 7361 6d70 6c65 735b 692c 203a 5d29  r_samples[i, :])
-00017380: 0a0a 2020 2020 2020 2020 2020 2020 7063  ..            pc
-00017390: 6f75 6e74 6572 203d 2030 0a20 2020 2020  ounter = 0.     
-000173a0: 2020 2020 2020 2066 6f72 2070 6e61 6d65         for pname
-000173b0: 2069 6e20 7365 6c66 2e6d 6f64 656c 5f70   in self.model_p
-000173c0: 6172 616d 6574 6572 733a 0a20 2020 2020  arameters:.     
-000173d0: 2020 2020 2020 2020 2020 2069 6620 6461             if da
-000173e0: 7461 2e70 7269 6f72 735b 706e 616d 655d  ta.priors[pname]
-000173f0: 5b27 6469 7374 7269 6275 7469 6f6e 275d  ['distribution']
-00017400: 2021 3d20 2766 6978 6564 273a 0a20 2020   != 'fixed':.   
-00017410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017420: 2073 656c 662e 706f 7374 6572 696f 7273   self.posteriors
-00017430: 5b70 6e61 6d65 5d20 3d20 6e70 2e6d 6564  [pname] = np.med
-00017440: 6961 6e28 0a20 2020 2020 2020 2020 2020  ian(.           
-00017450: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
-00017460: 7465 7269 6f72 5f73 616d 706c 6573 5b3a  terior_samples[:
-00017470: 2c20 7063 6f75 6e74 6572 5d29 0a20 2020  , pcounter]).   
-00017480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017490: 206f 7574 5b27 706f 7374 6572 696f 725f   out['posterior_
-000174a0: 7361 6d70 6c65 7327 5d5b 0a20 2020 2020  samples'][.     
-000174b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174c0: 2020 2070 6e61 6d65 5d20 3d20 706f 7374     pname] = post
-000174d0: 6572 696f 725f 7361 6d70 6c65 735b 3a2c  erior_samples[:,
-000174e0: 2070 636f 756e 7465 725d 0a20 2020 2020   pcounter].     
-000174f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00017500: 636f 756e 7465 7220 2b3d 2031 0a0a 2020  counter += 1..  
-00017510: 2020 2020 2020 2020 2020 2320 476f 2074            # Go t
-00017520: 6872 6f75 6768 2074 6865 2070 6f73 7465  hrough the poste
-00017530: 7269 6f72 2073 616d 706c 6573 2074 6f20  rior samples to 
-00017540: 7365 6520 6966 2064 7420 6f72 2054 2c20  see if dt or T, 
-00017550: 7468 6520 5454 5620 7061 7261 6d65 7465  the TTV paramete
-00017560: 7273 2c20 6172 6520 7072 6573 656e 742e  rs, are present.
-00017570: 2049 6620 7468 6579 2061 7265 2c20 6164   If they are, ad
-00017580: 6420 746f 2074 6865 2070 6f73 7465 7269  d to the posteri
-00017590: 6f72 2064 6963 7469 6f6e 6172 790a 2020  or dictionary.  
-000175a0: 2020 2020 2020 2020 2020 2320 282e 706b            # (.pk
-000175b0: 6c29 2061 6e64 2066 696c 6520 282e 6461  l) and file (.da
-000175c0: 7429 2074 6865 2063 6f72 7265 7370 6f6e  t) the correspon
-000175d0: 6469 6e67 2074 696d 652d 6f66 2d74 7261  ding time-of-tra
-000175e0: 6e73 6974 2063 656e 7465 722c 2069 6620  nsit center, if 
-000175f0: 7468 6520 6474 2070 6172 616d 6574 7269  the dt parametri
-00017600: 7a61 7469 6f6e 2069 7320 6265 696e 6720  zation is being 
-00017610: 7573 6564 2c20 7768 6963 6820 6973 2074  used, which is t
-00017620: 6865 2061 6374 7561 6c0a 2020 2020 2020  he actual.      
-00017630: 2020 2020 2020 2320 6f62 7365 7276 6162        # observab
-00017640: 6c65 2066 6f6c 6b73 2064 6f69 6e67 2064  le folks doing d
-00017650: 796e 616d 6963 7320 7573 7561 6c6c 7920  ynamics usually 
-00017660: 7761 6e74 2e20 4966 2074 6865 2054 2070  want. If the T p
-00017670: 6172 616d 6574 7269 7a61 7469 6f6e 2069  arametrization i
-00017680: 7320 6265 696e 6720 7573 6564 2c20 7772  s being used, wr
-00017690: 6974 6520 646f 776e 2074 6865 2070 6572  ite down the per
-000176a0: 696f 6420 616e 6420 7430 2069 6d70 6c69  iod and t0 impli
-000176b0: 6564 2062 790a 2020 2020 2020 2020 2020  ed by.          
-000176c0: 2020 2320 7468 6f73 6520 5427 733a 0a20    # those T's:. 
-000176d0: 2020 2020 2020 2020 2020 2066 6974 7465             fitte
-000176e0: 645f 7061 7261 6d65 7465 7273 203d 206c  d_parameters = l
-000176f0: 6973 7428 6f75 745b 2770 6f73 7465 7269  ist(out['posteri
-00017700: 6f72 5f73 616d 706c 6573 275d 2e6b 6579  or_samples'].key
-00017710: 7328 2929 0a20 2020 2020 2020 2020 2020  s()).           
-00017720: 2066 6972 7374 5469 6d65 2c20 5470 6172   firstTime, Tpar
-00017730: 616d 6574 7269 7a61 7469 6f6e 203d 2054  ametrization = T
-00017740: 7275 652c 2046 616c 7365 0a20 2020 2020  rue, False.     
-00017750: 2020 2020 2020 2066 6f72 2070 6f73 7465         for poste
-00017760: 7269 6f72 5f70 6172 616d 6574 6572 2069  rior_parameter i
-00017770: 6e20 6669 7474 6564 5f70 6172 616d 6574  n fitted_paramet
-00017780: 6572 733a 0a20 2020 2020 2020 2020 2020  ers:.           
-00017790: 2020 2020 2070 7665 6374 6f72 203d 2070       pvector = p
-000177a0: 6f73 7465 7269 6f72 5f70 6172 616d 6574  osterior_paramet
-000177b0: 6572 2e73 706c 6974 2827 5f27 290a 2020  er.split('_').  
-000177c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000177d0: 2070 7665 6374 6f72 5b30 5d20 3d3d 2027   pvector[0] == '
-000177e0: 6474 273a 0a20 2020 2020 2020 2020 2020  dt':.           
-000177f0: 2020 2020 2020 2020 2023 2045 7874 7261           # Extra
-00017800: 6374 2070 6c61 6e65 7420 6e75 6d62 6572  ct planet number
-00017810: 2028 706e 756d 2c20 652e 672e 2c20 2770   (pnum, e.g., 'p
-00017820: 3127 292c 2069 6e73 7472 756d 656e 7420  1'), instrument 
-00017830: 2869 6e73 2c20 652e 672e 2c20 2754 4553  (ins, e.g., 'TES
-00017840: 5327 2920 616e 6420 7472 616e 7369 7420  S') and transit 
-00017850: 6e75 6d62 6572 2028 746e 756d 2c20 652e  number (tnum, e.
-00017860: 672e 2c20 272d 3127 293a 0a20 2020 2020  g., '-1'):.     
-00017870: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00017880: 6e75 6d2c 2069 6e73 2c20 746e 756d 203d  num, ins, tnum =
-00017890: 2070 7665 6374 6f72 5b31 3a5d 0a20 2020   pvector[1:].   
-000178a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000178b0: 2023 2045 7874 7261 6374 2074 6865 2070   # Extract the p
-000178c0: 6572 696f 643b 2063 6865 636b 2069 6620  eriod; check if 
-000178d0: 6974 2077 6173 2066 6974 7465 642e 2049  it was fitted. I
-000178e0: 6620 6e6f 742c 2061 7373 756d 6520 6974  f not, assume it
-000178f0: 2077 6173 2066 6978 6564 3a0a 2020 2020   was fixed:.    
-00017900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017910: 6966 2027 505f 2720 2b20 706e 756d 2069  if 'P_' + pnum i
-00017920: 6e20 6669 7474 6564 5f70 6172 616d 6574  n fitted_paramet
-00017930: 6572 733a 0a20 2020 2020 2020 2020 2020  ers:.           
-00017940: 2020 2020 2020 2020 2020 2020 2050 203d               P =
-00017950: 206f 7574 5b27 706f 7374 6572 696f 725f   out['posterior_
-00017960: 7361 6d70 6c65 7327 5d5b 2750 5f27 202b  samples']['P_' +
-00017970: 2070 6e75 6d5d 0a20 2020 2020 2020 2020   pnum].         
-00017980: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00017990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000179a0: 2020 2020 2020 2020 2050 203d 2064 6174           P = dat
-000179b0: 612e 7072 696f 7273 5b27 505f 2720 2b20  a.priors['P_' + 
-000179c0: 706e 756d 5d5b 2768 7970 6572 7061 7261  pnum]['hyperpara
-000179d0: 6d65 7465 7273 275d 0a20 2020 2020 2020  meters'].       
-000179e0: 2020 2020 2020 2020 2020 2020 2023 2053               # S
-000179f0: 616d 6520 666f 7220 7430 3a0a 2020 2020  ame for t0:.    
-00017a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a10: 6966 2027 7430 5f27 202b 2070 6e75 6d20  if 't0_' + pnum 
-00017a20: 696e 2066 6974 7465 645f 7061 7261 6d65  in fitted_parame
-00017a30: 7465 7273 3a0a 2020 2020 2020 2020 2020  ters:.          
-00017a40: 2020 2020 2020 2020 2020 2020 2020 7430                t0
-00017a50: 203d 206f 7574 5b27 706f 7374 6572 696f   = out['posterio
-00017a60: 725f 7361 6d70 6c65 7327 5d5b 2774 305f  r_samples']['t0_
-00017a70: 2720 2b20 706e 756d 5d0a 2020 2020 2020  ' + pnum].      
-00017a80: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00017a90: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00017aa0: 2020 2020 2020 2020 2020 2020 7430 203d              t0 =
-00017ab0: 2064 6174 612e 7072 696f 7273 5b27 7430   data.priors['t0
-00017ac0: 5f27 202b 2070 6e75 6d5d 5b27 6879 7065  _' + pnum]['hype
-00017ad0: 7270 6172 616d 6574 6572 7327 5d0a 2020  rparameters'].  
-00017ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017af0: 2020 2320 4861 7669 6e67 2065 7874 7261    # Having extra
-00017b00: 6374 6564 2050 2061 6e64 2074 302c 2067  cted P and t0, g
-00017b10: 656e 6572 6174 6520 7468 6520 7469 6d65  enerate the time
-00017b20: 2d6f 662d 7472 616e 7369 7420 6365 6e74  -of-transit cent
-00017b30: 6572 2066 6f72 2074 6865 2063 7572 7265  er for the curre
-00017b40: 6e74 2074 7261 6e73 6974 3a0a 2020 2020  nt transit:.    
-00017b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b60: 6f75 745b 2770 6f73 7465 7269 6f72 5f73  out['posterior_s
-00017b70: 616d 706c 6573 275d 5b0a 2020 2020 2020  amples'][.      
-00017b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b90: 2020 2754 5f27 202b 2070 6e75 6d20 2b20    'T_' + pnum + 
-00017ba0: 275f 2720 2b20 696e 7320 2b20 275f 2720  '_' + ins + '_' 
-00017bb0: 2b0a 2020 2020 2020 2020 2020 2020 2020  +.              
-00017bc0: 2020 2020 2020 2020 2020 746e 756d 5d20            tnum] 
-00017bd0: 3d20 7430 202b 206e 702e 646f 7562 6c65  = t0 + np.double
-00017be0: 2874 6e75 6d29 202a 2050 202b 206f 7574  (tnum) * P + out
-00017bf0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00017c00: 2020 2020 2020 2020 2020 2020 2020 2770                'p
-00017c10: 6f73 7465 7269 6f72 5f73 616d 706c 6573  osterior_samples
-00017c20: 275d 5b70 6f73 7465 7269 6f72 5f70 6172  '][posterior_par
-00017c30: 616d 6574 6572 5d0a 2020 2020 2020 2020  ameter].        
-00017c40: 2020 2020 2020 2020 6966 2070 7665 6374          if pvect
-00017c50: 6f72 5b30 5d20 3d3d 2027 5427 3a0a 2020  or[0] == 'T':.  
-00017c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c70: 2020 6966 2066 6972 7374 5469 6d65 3a0a    if firstTime:.
-00017c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c90: 2020 2020 2020 2020 5470 6172 616d 6574          Tparamet
-00017ca0: 7269 7a61 7469 6f6e 203d 2054 7275 650a  rization = True.
-00017cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017cc0: 2020 2020 2020 2020 5464 6963 7420 3d20          Tdict = 
-00017cd0: 7b7d 0a20 2020 2020 2020 2020 2020 2020  {}.             
-00017ce0: 2020 2020 2020 2020 2020 2066 6972 7374             first
-00017cf0: 5469 6d65 203d 2046 616c 7365 0a20 2020  Time = False.   
-00017d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017d10: 2023 2045 7874 7261 6374 2070 6c61 6e65   # Extract plane
-00017d20: 7420 6e75 6d62 6572 2028 706e 756d 2c20  t number (pnum, 
-00017d30: 652e 672e 2c20 2770 3127 292c 2069 6e73  e.g., 'p1'), ins
-00017d40: 7472 756d 656e 7420 2869 6e73 2c20 652e  trument (ins, e.
-00017d50: 672e 2c20 2754 4553 5327 2920 616e 6420  g., 'TESS') and 
-00017d60: 7472 616e 7369 7420 6e75 6d62 6572 2028  transit number (
-00017d70: 746e 756d 2c20 652e 672e 2c20 272d 3127  tnum, e.g., '-1'
-00017d80: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00017d90: 2020 2020 2020 2070 6e75 6d2c 2069 6e73         pnum, ins
-00017da0: 2c20 746e 756d 203d 2070 7665 6374 6f72  , tnum = pvector
-00017db0: 5b31 3a5d 0a20 2020 2020 2020 2020 2020  [1:].           
-00017dc0: 2020 2020 2020 2020 2069 6620 706e 756d           if pnum
-00017dd0: 206e 6f74 2069 6e20 6c69 7374 2854 6469   not in list(Tdi
-00017de0: 6374 2e6b 6579 7328 2929 3a0a 2020 2020  ct.keys()):.    
-00017df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017e00: 2020 2020 5464 6963 745b 706e 756d 5d20      Tdict[pnum] 
-00017e10: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
-00017e20: 2020 2020 2020 2020 2054 6469 6374 5b70           Tdict[p
-00017e30: 6e75 6d5d 5b69 6e74 280a 2020 2020 2020  num][int(.      
-00017e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017e50: 2020 746e 756d 295d 203d 206f 7574 5b27    tnum)] = out['
-00017e60: 706f 7374 6572 696f 725f 7361 6d70 6c65  posterior_sample
-00017e70: 7327 5d5b 706f 7374 6572 696f 725f 7061  s'][posterior_pa
-00017e80: 7261 6d65 7465 725d 0a20 2020 2020 2020  rameter].       
-00017e90: 2020 2020 2069 6620 5470 6172 616d 6574       if Tparamet
-00017ea0: 7269 7a61 7469 6f6e 3a0a 2020 2020 2020  rization:.      
-00017eb0: 2020 2020 2020 2020 2020 666f 7220 706e            for pn
-00017ec0: 756d 2069 6e20 6c69 7374 2854 6469 6374  um in list(Tdict
-00017ed0: 2e6b 6579 7328 2929 3a0a 2020 2020 2020  .keys()):.      
-00017ee0: 2020 2020 2020 2020 2020 2020 2020 616c                al
-00017ef0: 6c5f 6e73 203d 206e 702e 6172 7261 7928  l_ns = np.array(
-00017f00: 6c69 7374 2854 6469 6374 5b70 6e75 6d5d  list(Tdict[pnum]
-00017f10: 2e6b 6579 7328 2929 290a 2020 2020 2020  .keys())).      
-00017f20: 2020 2020 2020 2020 2020 2020 2020 4e73                Ns
-00017f30: 616d 706c 6573 203d 206c 656e 2854 6469  amples = len(Tdi
-00017f40: 6374 5b70 6e75 6d5d 5b61 6c6c 5f6e 735b  ct[pnum][all_ns[
-00017f50: 305d 5d29 0a20 2020 2020 2020 2020 2020  0]]).           
-00017f60: 2020 2020 2020 2020 206f 7574 5b27 706f           out['po
-00017f70: 7374 6572 696f 725f 7361 6d70 6c65 7327  sterior_samples'
-00017f80: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
-00017f90: 2020 2020 2020 2020 2020 2027 505f 2720             'P_' 
-00017fa0: 2b20 706e 756d 5d2c 206f 7574 5b27 706f  + pnum], out['po
-00017fb0: 7374 6572 696f 725f 7361 6d70 6c65 7327  sterior_samples'
-00017fc0: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
-00017fd0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00017fe0: 7430 5f27 202b 0a20 2020 2020 2020 2020  t0_' +.         
+00016cf0: 2020 2020 2066 6c61 743d 5472 7565 290a       flat=True).
+00016d00: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00016d10: 6620 277a 6575 7327 2069 6e20 7365 6c66  f 'zeus' in self
+00016d20: 2e73 616d 706c 6572 3a0a 2020 2020 2020  .sampler:.      
+00016d30: 2020 2020 2020 2020 2020 2320 4964 656e            # Iden
+00016d40: 7469 6361 6c20 696d 706c 656d 656e 7461  tical implementa
+00016d50: 7469 6f6e 2074 6f20 656d 6365 652e 2e2e  tion to emcee...
+00016d60: 3f0a 2020 2020 2020 2020 2020 2020 2020  ?.              
+00016d70: 2020 2320 496e 6974 6961 7465 2073 7461    # Initiate sta
+00016d80: 7274 696e 6720 706f 696e 7420 666f 7220  rting point for 
+00016d90: 6561 6368 2077 616c 6b65 722e 2054 6f20  each walker. To 
+00016da0: 7468 6973 2065 6e64 2c20 6669 7273 7420  this end, first 
+00016db0: 6c6f 6164 2073 7461 7274 696e 6720 7661  load starting va
+00016dc0: 6c75 6573 2e0a 2020 2020 2020 2020 2020  lues..          
+00016dd0: 2020 2020 2020 696e 6974 6961 6c5f 706f        initial_po
+00016de0: 7369 7469 6f6e 203d 206e 702e 6172 7261  sition = np.arra
+00016df0: 7928 5b5d 290a 2020 2020 2020 2020 2020  y([]).          
+00016e00: 2020 2020 2020 666f 7220 706e 616d 6520        for pname 
+00016e10: 696e 2073 656c 662e 6d6f 6465 6c5f 7061  in self.model_pa
+00016e20: 7261 6d65 7465 7273 3a0a 2020 2020 2020  rameters:.      
+00016e30: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00016e40: 2073 656c 662e 6461 7461 2e70 7269 6f72   self.data.prior
+00016e50: 735b 706e 616d 655d 5b27 6469 7374 7269  s[pname]['distri
+00016e60: 6275 7469 6f6e 275d 2021 3d20 2766 6978  bution'] != 'fix
+00016e70: 6564 273a 0a20 2020 2020 2020 2020 2020  ed':.           
+00016e80: 2020 2020 2020 2020 2020 2020 2069 6e69               ini
+00016e90: 7469 616c 5f70 6f73 6974 696f 6e20 3d20  tial_position = 
+00016ea0: 6e70 2e61 7070 656e 6428 696e 6974 6961  np.append(initia
+00016eb0: 6c5f 706f 7369 7469 6f6e 2c20 7365 6c66  l_position, self
+00016ec0: 2e70 6f73 7465 7269 6f72 735b 706e 616d  .posteriors[pnam
+00016ed0: 655d 290a 0a20 2020 2020 2020 2020 2020  e])..           
+00016ee0: 2020 2020 2023 2050 6572 7475 7262 2069       # Perturb i
+00016ef0: 6e69 7469 616c 2070 6f73 6974 696f 6e20  nitial position 
+00016f00: 666f 7220 6561 6368 206f 6620 7468 6520  for each of the 
+00016f10: 7761 6c6b 6572 733a 0a20 2020 2020 2020  walkers:.       
+00016f20: 2020 2020 2020 2020 2070 6f73 203d 2069           pos = i
+00016f30: 6e69 7469 616c 5f70 6f73 6974 696f 6e20  nitial_position 
+00016f40: 2b20 7365 6c66 2e65 6d63 6565 5f66 6163  + self.emcee_fac
+00016f50: 746f 7220 2a20 6e70 2e72 616e 646f 6d2e  tor * np.random.
+00016f60: 7261 6e64 6e28 7365 6c66 2e6e 7761 6c6b  randn(self.nwalk
+00016f70: 6572 732c 206c 656e 2869 6e69 7469 616c  ers, len(initial
+00016f80: 5f70 6f73 6974 696f 6e29 290a 0a20 2020  _position))..   
+00016f90: 2020 2020 2020 2020 2020 2020 2023 2042               # B
+00016fa0: 6566 6f72 6520 7065 7266 6f72 6d69 6e67  efore performing
+00016fb0: 2074 6865 2073 616d 706c 696e 672c 2063   the sampling, c
+00016fc0: 6174 6368 2061 6e79 206b 7761 7267 7320  atch any kwargs 
+00016fd0: 7468 6174 2067 6f20 746f 2045 6e73 656d  that go to Ensem
+00016fe0: 626c 6553 616d 706c 6572 3b20 7265 7374  bleSampler; rest
+00016ff0: 206f 6620 6b77 6172 6773 2061 7265 2061   of kwargs are a
+00017000: 7373 756d 6564 2074 6f20 676f 0a20 2020  ssumed to go.   
+00017010: 2020 2020 2020 2020 2020 2020 2023 2074               # t
+00017020: 6f20 7275 6e5f 6d63 6d63 3a0a 2020 2020  o run_mcmc:.    
+00017030: 2020 2020 2020 2020 2020 2020 6172 6773              args
+00017040: 203d 207a 6575 732e 456e 7365 6d62 6c65   = zeus.Ensemble
+00017050: 5361 6d70 6c65 722e 5f5f 696e 6974 5f5f  Sampler.__init__
+00017060: 2e5f 5f63 6f64 655f 5f2e 636f 5f76 6172  .__code__.co_var
+00017070: 6e61 6d65 730a 2020 2020 2020 2020 2020  names.          
+00017080: 2020 2020 2020 7a65 7573 5f61 7267 7320        zeus_args 
+00017090: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
+000170a0: 2020 2020 2072 756e 6d63 6d63 5f61 7267       runmcmc_arg
+000170b0: 7320 3d20 7b7d 0a0a 2020 2020 2020 2020  s = {}..        
+000170c0: 2020 2020 2020 2020 2320 4d61 7463 6820          # Match 
+000170d0: 7468 656d 2077 6974 6820 6b77 6172 6773  them with kwargs
+000170e0: 2028 6b77 6172 6773 2074 616b 6520 7072   (kwargs take pr
+000170f0: 6566 6572 656e 6365 293a 0a20 2020 2020  eference):.     
+00017100: 2020 2020 2020 2020 2020 2066 6f72 2061             for a
+00017110: 7267 2069 6e20 6172 6773 3a0a 2020 2020  rg in args:.    
+00017120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017130: 6966 2061 7267 2069 6e20 6b77 6172 6773  if arg in kwargs
+00017140: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00017150: 2020 2020 2020 2020 2020 7a65 7573 5f61            zeus_a
+00017160: 7267 735b 6172 675d 203d 206b 7761 7267  rgs[arg] = kwarg
+00017170: 735b 6172 675d 0a20 2020 2020 2020 2020  s[arg].         
+00017180: 2020 2020 2020 2020 2020 2020 2020 206b                 k
+00017190: 7761 7267 732e 706f 7028 6172 6729 0a0a  wargs.pop(arg)..
+000171a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000171b0: 2320 4e6f 7720 7065 7266 6f72 6d20 7468  # Now perform th
+000171c0: 6520 7361 6d70 6c69 6e67 2e20 4966 206e  e sampling. If n
+000171d0: 7468 7265 6164 7320 6973 2064 6566 696e  threads is defin
+000171e0: 6564 2c20 7061 7261 6c6c 656c 697a 652e  ed, parallelize.
+000171f0: 2049 6620 6e6f 742c 2067 6f20 7468 6520   If not, go the 
+00017200: 7365 7269 616c 2077 6179 3a0a 2020 2020  serial way:.    
+00017210: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00017220: 656c 662e 6e74 6872 6561 6473 2069 7320  elf.nthreads is 
+00017230: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00017240: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+00017250: 7220 3d20 7a65 7573 2e45 6e73 656d 626c  r = zeus.Ensembl
+00017260: 6553 616d 706c 6572 2873 656c 662e 6e77  eSampler(self.nw
+00017270: 616c 6b65 7273 2c20 7365 6c66 2e64 6174  alkers, self.dat
+00017280: 612e 6e70 6172 616d 732c 2073 656c 662e  a.nparams, self.
+00017290: 6c6f 6770 726f 622c 202a 2a7a 6575 735f  logprob, **zeus_
+000172a0: 6172 6773 290a 2020 2020 2020 2020 2020  args).          
+000172b0: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+000172c0: 722e 7275 6e5f 6d63 6d63 2870 6f73 2c20  r.run_mcmc(pos, 
+000172d0: 7365 6c66 2e6e 7374 6570 7320 2b20 7365  self.nsteps + se
+000172e0: 6c66 2e6e 6275 726e 696e 2c20 2a2a 6b77  lf.nburnin, **kw
+000172f0: 6172 6773 290a 2020 2020 2020 2020 2020  args).          
+00017300: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00017310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017320: 7769 7468 2063 6f6e 7465 7874 6c69 622e  with contextlib.
+00017330: 636c 6f73 696e 6728 506f 6f6c 2870 726f  closing(Pool(pro
+00017340: 6365 7373 6573 3d73 656c 662e 6e74 6872  cesses=self.nthr
+00017350: 6561 6473 2d31 2929 2061 7320 6578 6563  eads-1)) as exec
+00017360: 7574 6f72 3a0a 2020 2020 2020 2020 2020  utor:.          
+00017370: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+00017380: 6d70 6c65 7220 3d20 7a65 7573 2e45 6e73  mpler = zeus.Ens
+00017390: 656d 626c 6553 616d 706c 6572 2873 656c  embleSampler(sel
+000173a0: 662e 6e77 616c 6b65 7273 2c20 7365 6c66  f.nwalkers, self
+000173b0: 2e64 6174 612e 6e70 6172 616d 732c 2073  .data.nparams, s
+000173c0: 656c 662e 6c6f 6770 726f 622c 2070 6f6f  elf.logprob, poo
+000173d0: 6c20 3d20 6578 6563 7574 6f72 2c20 2a2a  l = executor, **
+000173e0: 7a65 7573 5f61 7267 7329 0a20 2020 2020  zeus_args).     
+000173f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017400: 2020 2073 616d 706c 6572 2e72 756e 5f6d     sampler.run_m
+00017410: 636d 6328 706f 732c 2073 656c 662e 6e73  cmc(pos, self.ns
+00017420: 7465 7073 202b 2073 656c 662e 6e62 7572  teps + self.nbur
+00017430: 6e69 6e2c 202a 2a6b 7761 7267 7329 0a0a  nin, **kwargs)..
+00017440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017450: 2320 5374 6f72 6520 706f 7374 6572 696f  # Store posterio
+00017460: 7220 7361 6d70 6c65 732e 2046 6972 7374  r samples. First
+00017470: 2c20 7374 6f72 6520 7468 6520 7361 6d70  , store the samp
+00017480: 6c65 7320 666f 7220 6561 6368 2077 616c  les for each wal
+00017490: 6b65 723a 0a20 2020 2020 2020 2020 2020  ker:.           
+000174a0: 2020 2020 206f 7574 5b27 706f 7374 6572       out['poster
+000174b0: 696f 7273 5f70 6572 5f77 616c 6b65 7227  iors_per_walker'
+000174c0: 5d20 3d20 7361 6d70 6c65 722e 6765 745f  ] = sampler.get_
+000174d0: 6368 6169 6e28 290a 0a20 2020 2020 2020  chain()..       
+000174e0: 2020 2020 2020 2020 2023 2041 6e64 206e           # And n
+000174f0: 6f77 2073 746f 7265 2070 6f73 7465 7269  ow store posteri
+00017500: 6f72 7320 7769 7468 2061 6c6c 2077 616c  ors with all wal
+00017510: 6b65 7273 2066 6c61 7474 656e 6564 206f  kers flattened o
+00017520: 7574 3a0a 0a20 2020 2020 2020 2020 2020  ut:..           
+00017530: 2020 2020 2070 6f73 7465 7269 6f72 5f73       posterior_s
+00017540: 616d 706c 6573 203d 2073 616d 706c 6572  amples = sampler
+00017550: 2e67 6574 5f63 6861 696e 2864 6973 6361  .get_chain(disca
+00017560: 7264 203d 2073 656c 662e 6e62 7572 6e69  rd = self.nburni
+00017570: 6e2c 200a 2020 2020 2020 2020 2020 2020  n, .            
+00017580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000175a0: 2020 2020 2020 2020 2020 666c 6174 203d            flat =
+000175b0: 2054 7275 6529 0a0a 2020 2020 2020 2020   True)..        
+000175c0: 2020 2020 2320 5361 7665 2070 6f73 7465      # Save poste
+000175d0: 7269 6f72 2073 616d 706c 6573 2061 7320  rior samples as 
+000175e0: 6f75 7470 7574 7465 6420 6279 204d 756c  outputted by Mul
+000175f0: 7469 6e65 7374 2f44 796e 6573 7479 3a0a  tinest/Dynesty:.
+00017600: 2020 2020 2020 2020 2020 2020 6f75 745b              out[
+00017610: 2770 6f73 7465 7269 6f72 5f73 616d 706c  'posterior_sampl
+00017620: 6573 275d 203d 207b 7d0a 2020 2020 2020  es'] = {}.      
+00017630: 2020 2020 2020 6f75 745b 2770 6f73 7465        out['poste
+00017640: 7269 6f72 5f73 616d 706c 6573 275d 5b27  rior_samples']['
+00017650: 756e 6e61 6d65 6427 5d20 3d20 706f 7374  unnamed'] = post
+00017660: 6572 696f 725f 7361 6d70 6c65 730a 0a20  erior_samples.. 
+00017670: 2020 2020 2020 2020 2020 2023 2053 6176             # Sav
+00017680: 6520 6c6f 672d 6c69 6b65 6c69 686f 6f64  e log-likelihood
+00017690: 206f 6620 6561 6368 206f 6620 7468 6520   of each of the 
+000176a0: 7361 6d70 6c65 733a 0a20 2020 2020 2020  samples:.       
+000176b0: 2020 2020 206f 7574 5b27 706f 7374 6572       out['poster
+000176c0: 696f 725f 7361 6d70 6c65 7327 5d5b 276c  ior_samples']['l
+000176d0: 6f67 6c69 6b65 275d 203d 206e 702e 7a65  oglike'] = np.ze
+000176e0: 726f 7328 0a20 2020 2020 2020 2020 2020  ros(.           
+000176f0: 2020 2020 2070 6f73 7465 7269 6f72 5f73       posterior_s
+00017700: 616d 706c 6573 2e73 6861 7065 5b30 5d29  amples.shape[0])
+00017710: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00017720: 2069 2069 6e20 7261 6e67 6528 706f 7374   i in range(post
+00017730: 6572 696f 725f 7361 6d70 6c65 732e 7368  erior_samples.sh
+00017740: 6170 655b 305d 293a 0a20 2020 2020 2020  ape[0]):.       
+00017750: 2020 2020 2020 2020 206f 7574 5b27 706f           out['po
+00017760: 7374 6572 696f 725f 7361 6d70 6c65 7327  sterior_samples'
+00017770: 5d5b 276c 6f67 6c69 6b65 275d 5b69 5d20  ]['loglike'][i] 
+00017780: 3d20 7365 6c66 2e6c 6f67 6c69 6b65 280a  = self.loglike(.
+00017790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000177a0: 2020 2020 706f 7374 6572 696f 725f 7361      posterior_sa
+000177b0: 6d70 6c65 735b 692c 203a 5d29 0a0a 2020  mples[i, :])..  
+000177c0: 2020 2020 2020 2020 2020 7063 6f75 6e74            pcount
+000177d0: 6572 203d 2030 0a20 2020 2020 2020 2020  er = 0.         
+000177e0: 2020 2066 6f72 2070 6e61 6d65 2069 6e20     for pname in 
+000177f0: 7365 6c66 2e6d 6f64 656c 5f70 6172 616d  self.model_param
+00017800: 6574 6572 733a 0a20 2020 2020 2020 2020  eters:.         
+00017810: 2020 2020 2020 2069 6620 6461 7461 2e70         if data.p
+00017820: 7269 6f72 735b 706e 616d 655d 5b27 6469  riors[pname]['di
+00017830: 7374 7269 6275 7469 6f6e 275d 2021 3d20  stribution'] != 
+00017840: 2766 6978 6564 273a 0a20 2020 2020 2020  'fixed':.       
+00017850: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00017860: 662e 706f 7374 6572 696f 7273 5b70 6e61  f.posteriors[pna
+00017870: 6d65 5d20 3d20 6e70 2e6d 6564 6961 6e28  me] = np.median(
+00017880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017890: 2020 2020 2020 2020 2070 6f73 7465 7269           posteri
+000178a0: 6f72 5f73 616d 706c 6573 5b3a 2c20 7063  or_samples[:, pc
+000178b0: 6f75 6e74 6572 5d29 0a20 2020 2020 2020  ounter]).       
+000178c0: 2020 2020 2020 2020 2020 2020 206f 7574               out
+000178d0: 5b27 706f 7374 6572 696f 725f 7361 6d70  ['posterior_samp
+000178e0: 6c65 7327 5d5b 0a20 2020 2020 2020 2020  les'][.         
+000178f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00017900: 6e61 6d65 5d20 3d20 706f 7374 6572 696f  name] = posterio
+00017910: 725f 7361 6d70 6c65 735b 3a2c 2070 636f  r_samples[:, pco
+00017920: 756e 7465 725d 0a20 2020 2020 2020 2020  unter].         
+00017930: 2020 2020 2020 2020 2020 2070 636f 756e             pcoun
+00017940: 7465 7220 2b3d 2031 0a0a 2020 2020 2020  ter += 1..      
+00017950: 2020 2020 2020 2320 476f 2074 6872 6f75        # Go throu
+00017960: 6768 2074 6865 2070 6f73 7465 7269 6f72  gh the posterior
+00017970: 2073 616d 706c 6573 2074 6f20 7365 6520   samples to see 
+00017980: 6966 2064 7420 6f72 2054 2c20 7468 6520  if dt or T, the 
+00017990: 5454 5620 7061 7261 6d65 7465 7273 2c20  TTV parameters, 
+000179a0: 6172 6520 7072 6573 656e 742e 2049 6620  are present. If 
+000179b0: 7468 6579 2061 7265 2c20 6164 6420 746f  they are, add to
+000179c0: 2074 6865 2070 6f73 7465 7269 6f72 2064   the posterior d
+000179d0: 6963 7469 6f6e 6172 790a 2020 2020 2020  ictionary.      
+000179e0: 2020 2020 2020 2320 282e 706b 6c29 2061        # (.pkl) a
+000179f0: 6e64 2066 696c 6520 282e 6461 7429 2074  nd file (.dat) t
+00017a00: 6865 2063 6f72 7265 7370 6f6e 6469 6e67  he corresponding
+00017a10: 2074 696d 652d 6f66 2d74 7261 6e73 6974   time-of-transit
+00017a20: 2063 656e 7465 722c 2069 6620 7468 6520   center, if the 
+00017a30: 6474 2070 6172 616d 6574 7269 7a61 7469  dt parametrizati
+00017a40: 6f6e 2069 7320 6265 696e 6720 7573 6564  on is being used
+00017a50: 2c20 7768 6963 6820 6973 2074 6865 2061  , which is the a
+00017a60: 6374 7561 6c0a 2020 2020 2020 2020 2020  ctual.          
+00017a70: 2020 2320 6f62 7365 7276 6162 6c65 2066    # observable f
+00017a80: 6f6c 6b73 2064 6f69 6e67 2064 796e 616d  olks doing dynam
+00017a90: 6963 7320 7573 7561 6c6c 7920 7761 6e74  ics usually want
+00017aa0: 2e20 4966 2074 6865 2054 2070 6172 616d  . If the T param
+00017ab0: 6574 7269 7a61 7469 6f6e 2069 7320 6265  etrization is be
+00017ac0: 696e 6720 7573 6564 2c20 7772 6974 6520  ing used, write 
+00017ad0: 646f 776e 2074 6865 2070 6572 696f 6420  down the period 
+00017ae0: 616e 6420 7430 2069 6d70 6c69 6564 2062  and t0 implied b
+00017af0: 790a 2020 2020 2020 2020 2020 2020 2320  y.            # 
+00017b00: 7468 6f73 6520 5427 733a 0a20 2020 2020  those T's:.     
+00017b10: 2020 2020 2020 2066 6974 7465 645f 7061         fitted_pa
+00017b20: 7261 6d65 7465 7273 203d 206c 6973 7428  rameters = list(
+00017b30: 6f75 745b 2770 6f73 7465 7269 6f72 5f73  out['posterior_s
+00017b40: 616d 706c 6573 275d 2e6b 6579 7328 2929  amples'].keys())
+00017b50: 0a20 2020 2020 2020 2020 2020 2066 6972  .            fir
+00017b60: 7374 5469 6d65 2c20 5470 6172 616d 6574  stTime, Tparamet
+00017b70: 7269 7a61 7469 6f6e 203d 2054 7275 652c  rization = True,
+00017b80: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+00017b90: 2020 2066 6f72 2070 6f73 7465 7269 6f72     for posterior
+00017ba0: 5f70 6172 616d 6574 6572 2069 6e20 6669  _parameter in fi
+00017bb0: 7474 6564 5f70 6172 616d 6574 6572 733a  tted_parameters:
+00017bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017bd0: 2070 7665 6374 6f72 203d 2070 6f73 7465   pvector = poste
+00017be0: 7269 6f72 5f70 6172 616d 6574 6572 2e73  rior_parameter.s
+00017bf0: 706c 6974 2827 5f27 290a 2020 2020 2020  plit('_').      
+00017c00: 2020 2020 2020 2020 2020 6966 2070 7665            if pve
+00017c10: 6374 6f72 5b30 5d20 3d3d 2027 6474 273a  ctor[0] == 'dt':
+00017c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017c30: 2020 2020 2023 2045 7874 7261 6374 2070       # Extract p
+00017c40: 6c61 6e65 7420 6e75 6d62 6572 2028 706e  lanet number (pn
+00017c50: 756d 2c20 652e 672e 2c20 2770 3127 292c  um, e.g., 'p1'),
+00017c60: 2069 6e73 7472 756d 656e 7420 2869 6e73   instrument (ins
+00017c70: 2c20 652e 672e 2c20 2754 4553 5327 2920  , e.g., 'TESS') 
+00017c80: 616e 6420 7472 616e 7369 7420 6e75 6d62  and transit numb
+00017c90: 6572 2028 746e 756d 2c20 652e 672e 2c20  er (tnum, e.g., 
+00017ca0: 272d 3127 293a 0a20 2020 2020 2020 2020  '-1'):.         
+00017cb0: 2020 2020 2020 2020 2020 2070 6e75 6d2c             pnum,
+00017cc0: 2069 6e73 2c20 746e 756d 203d 2070 7665   ins, tnum = pve
+00017cd0: 6374 6f72 5b31 3a5d 0a20 2020 2020 2020  ctor[1:].       
+00017ce0: 2020 2020 2020 2020 2020 2020 2023 2045               # E
+00017cf0: 7874 7261 6374 2074 6865 2070 6572 696f  xtract the perio
+00017d00: 643b 2063 6865 636b 2069 6620 6974 2077  d; check if it w
+00017d10: 6173 2066 6974 7465 642e 2049 6620 6e6f  as fitted. If no
+00017d20: 742c 2061 7373 756d 6520 6974 2077 6173  t, assume it was
+00017d30: 2066 6978 6564 3a0a 2020 2020 2020 2020   fixed:.        
+00017d40: 2020 2020 2020 2020 2020 2020 6966 2027              if '
+00017d50: 505f 2720 2b20 706e 756d 2069 6e20 6669  P_' + pnum in fi
+00017d60: 7474 6564 5f70 6172 616d 6574 6572 733a  tted_parameters:
+00017d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017d80: 2020 2020 2020 2020 2050 203d 206f 7574           P = out
+00017d90: 5b27 706f 7374 6572 696f 725f 7361 6d70  ['posterior_samp
+00017da0: 6c65 7327 5d5b 2750 5f27 202b 2070 6e75  les']['P_' + pnu
+00017db0: 6d5d 0a20 2020 2020 2020 2020 2020 2020  m].             
+00017dc0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00017dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017de0: 2020 2020 2050 203d 2064 6174 612e 7072       P = data.pr
+00017df0: 696f 7273 5b27 505f 2720 2b20 706e 756d  iors['P_' + pnum
+00017e00: 5d5b 2768 7970 6572 7061 7261 6d65 7465  ]['hyperparamete
+00017e10: 7273 275d 0a20 2020 2020 2020 2020 2020  rs'].           
+00017e20: 2020 2020 2020 2020 2023 2053 616d 6520           # Same 
+00017e30: 666f 7220 7430 3a0a 2020 2020 2020 2020  for t0:.        
+00017e40: 2020 2020 2020 2020 2020 2020 6966 2027              if '
+00017e50: 7430 5f27 202b 2070 6e75 6d20 696e 2066  t0_' + pnum in f
+00017e60: 6974 7465 645f 7061 7261 6d65 7465 7273  itted_parameters
+00017e70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00017e80: 2020 2020 2020 2020 2020 7430 203d 206f            t0 = o
+00017e90: 7574 5b27 706f 7374 6572 696f 725f 7361  ut['posterior_sa
+00017ea0: 6d70 6c65 7327 5d5b 2774 305f 2720 2b20  mples']['t0_' + 
+00017eb0: 706e 756d 5d0a 2020 2020 2020 2020 2020  pnum].          
+00017ec0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00017ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017ee0: 2020 2020 2020 2020 7430 203d 2064 6174          t0 = dat
+00017ef0: 612e 7072 696f 7273 5b27 7430 5f27 202b  a.priors['t0_' +
+00017f00: 2070 6e75 6d5d 5b27 6879 7065 7270 6172   pnum]['hyperpar
+00017f10: 616d 6574 6572 7327 5d0a 2020 2020 2020  ameters'].      
+00017f20: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00017f30: 4861 7669 6e67 2065 7874 7261 6374 6564  Having extracted
+00017f40: 2050 2061 6e64 2074 302c 2067 656e 6572   P and t0, gener
+00017f50: 6174 6520 7468 6520 7469 6d65 2d6f 662d  ate the time-of-
+00017f60: 7472 616e 7369 7420 6365 6e74 6572 2066  transit center f
+00017f70: 6f72 2074 6865 2063 7572 7265 6e74 2074  or the current t
+00017f80: 7261 6e73 6974 3a0a 2020 2020 2020 2020  ransit:.        
+00017f90: 2020 2020 2020 2020 2020 2020 6f75 745b              out[
+00017fa0: 2770 6f73 7465 7269 6f72 5f73 616d 706c  'posterior_sampl
+00017fb0: 6573 275d 5b0a 2020 2020 2020 2020 2020  es'][.          
+00017fc0: 2020 2020 2020 2020 2020 2020 2020 2754                'T
+00017fd0: 5f27 202b 2070 6e75 6d20 2b20 275f 2720  _' + pnum + '_' 
+00017fe0: 2b20 696e 7320 2b20 275f 2720 2b0a 2020  + ins + '_' +.  
 00017ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018000: 2020 2070 6e75 6d5d 203d 206e 702e 7a65     pnum] = np.ze
-00018010: 726f 7328 4e73 616d 706c 6573 292c 206e  ros(Nsamples), n
-00018020: 702e 7a65 726f 7328 4e73 616d 706c 6573  p.zeros(Nsamples
-00018030: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00018040: 2020 2020 2020 4e20 3d20 6c65 6e28 616c        N = len(al
-00018050: 6c5f 6e73 290a 2020 2020 2020 2020 2020  l_ns).          
-00018060: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-00018070: 696e 2072 616e 6765 284e 7361 6d70 6c65  in range(Nsample
-00018080: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00018090: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
-000180a0: 5473 203d 206e 702e 7a65 726f 7328 4e29  Ts = np.zeros(N)
-000180b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000180c0: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
-000180d0: 6e20 7261 6e67 6528 6c65 6e28 616c 6c5f  n range(len(all_
-000180e0: 6e73 2929 3a0a 2020 2020 2020 2020 2020  ns)):.          
+00018000: 2020 2020 2020 746e 756d 5d20 3d20 7430        tnum] = t0
+00018010: 202b 206e 702e 646f 7562 6c65 2874 6e75   + np.double(tnu
+00018020: 6d29 202a 2050 202b 206f 7574 5b0a 2020  m) * P + out[.  
+00018030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018040: 2020 2020 2020 2020 2020 2770 6f73 7465            'poste
+00018050: 7269 6f72 5f73 616d 706c 6573 275d 5b70  rior_samples'][p
+00018060: 6f73 7465 7269 6f72 5f70 6172 616d 6574  osterior_paramet
+00018070: 6572 5d0a 2020 2020 2020 2020 2020 2020  er].            
+00018080: 2020 2020 6966 2070 7665 6374 6f72 5b30      if pvector[0
+00018090: 5d20 3d3d 2027 5427 3a0a 2020 2020 2020  ] == 'T':.      
+000180a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000180b0: 2066 6972 7374 5469 6d65 3a0a 2020 2020   firstTime:.    
+000180c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000180d0: 2020 2020 5470 6172 616d 6574 7269 7a61      Tparametriza
+000180e0: 7469 6f6e 203d 2054 7275 650a 2020 2020  tion = True.    
 000180f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018100: 2020 616c 6c5f 5473 5b6a 5d20 3d20 5464    all_Ts[j] = Td
-00018110: 6963 745b 706e 756d 5d5b 616c 6c5f 6e73  ict[pnum][all_ns
-00018120: 5b6a 5d5d 5b69 5d0a 2020 2020 2020 2020  [j]][i].        
-00018130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018140: 5859 2c20 592c 2058 2c20 5832 203d 206e  XY, Y, X, X2 = n
-00018150: 702e 7375 6d28 616c 6c5f 5473 202a 2061  p.sum(all_Ts * a
-00018160: 6c6c 5f6e 7329 202f 204e 2c20 6e70 2e73  ll_ns) / N, np.s
-00018170: 756d 280a 2020 2020 2020 2020 2020 2020  um(.            
-00018180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018190: 616c 6c5f 5473 2920 2f20 4e2c 206e 702e  all_Ts) / N, np.
-000181a0: 7375 6d28 616c 6c5f 6e73 2920 2f20 4e2c  sum(all_ns) / N,
-000181b0: 206e 702e 7375 6d28 616c 6c5f 6e73 2a2a   np.sum(all_ns**
-000181c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000181d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000181e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000181f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018200: 2020 2020 2032 2920 2f20 4e0a 2020 2020       2) / N.    
-00018210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018220: 2020 2020 2320 4765 7420 736c 6f70 653a      # Get slope:
-00018230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018240: 2020 2020 2020 2020 206f 7574 5b27 706f           out['po
-00018250: 7374 6572 696f 725f 7361 6d70 6c65 7327  sterior_samples'
-00018260: 5d5b 2750 5f27 202b 0a20 2020 2020 2020  ]['P_' +.       
-00018270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018290: 2020 2020 2020 2020 2020 706e 756d 5d5b            pnum][
-000182a0: 695d 203d 2028 5859 202d 0a20 2020 2020  i] = (XY -.     
-000182b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000182c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000182d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000182e0: 2020 2020 2020 2020 5820 2a20 5929 202f          X * Y) /
-000182f0: 2028 5832 202d 0a20 2020 2020 2020 2020   (X2 -.         
-00018300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018330: 2020 2020 2020 2020 2020 2020 2020 2858                (X
-00018340: 2a2a 3229 290a 2020 2020 2020 2020 2020  **2)).          
-00018350: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00018360: 496e 7465 7263 6570 743a 0a20 2020 2020  Intercept:.     
-00018370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018380: 2020 206f 7574 5b27 706f 7374 6572 696f     out['posterio
-00018390: 725f 7361 6d70 6c65 7327 5d5b 0a20 2020  r_samples'][.   
-000183a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000183b0: 2020 2020 2020 2020 2027 7430 5f27 202b           't0_' +
-000183c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000183d0: 2020 2020 2020 2020 2020 2020 2070 6e75               pnu
-000183e0: 6d5d 5b69 5d20 3d20 5920 2d20 6f75 745b  m][i] = Y - out[
-000183f0: 2770 6f73 7465 7269 6f72 5f73 616d 706c  'posterior_sampl
-00018400: 6573 275d 5b27 505f 2720 2b0a 2020 2020  es']['P_' +.    
-00018410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018450: 706e 756d 5d5b 695d 202a 2058 0a20 2020  pnum][i] * X.   
-00018460: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00018470: 2e64 6174 612e 745f 6c63 2069 7320 6e6f  .data.t_lc is no
-00018480: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00018490: 2020 2020 2020 2020 6966 2054 7275 6520          if True 
-000184a0: 696e 2073 656c 662e 6461 7461 2e6c 635f  in self.data.lc_
-000184b0: 6f70 7469 6f6e 735b 2765 6666 6963 6965  options['efficie
-000184c0: 6e74 5f62 7027 5d2e 7661 6c75 6573 2829  nt_bp'].values()
-000184d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000184e0: 2020 2020 2020 6f75 745b 2770 7527 5d20        out['pu'] 
-000184f0: 3d20 7365 6c66 2e70 750a 2020 2020 2020  = self.pu.      
-00018500: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
-00018510: 745b 2770 6c27 5d20 3d20 7365 6c66 2e70  t['pl'] = self.p
-00018520: 6c0a 2020 2020 2020 2020 2020 2020 6966  l.            if
-00018530: 2073 656c 662e 6461 7461 2e74 5f72 7620   self.data.t_rv 
-00018540: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00018550: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00018560: 7365 6c66 2e64 6174 612e 7276 5f6f 7074  self.data.rv_opt
-00018570: 696f 6e73 5b27 6669 7472 766c 696e 6527  ions['fitrvline'
-00018580: 5d20 6f72 2073 656c 662e 6461 7461 2e72  ] or self.data.r
-00018590: 765f 6f70 7469 6f6e 735b 0a20 2020 2020  v_options[.     
-000185a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000185b0: 2020 2027 6669 7472 7671 7561 6427 5d3a     'fitrvquad']:
-000185c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000185d0: 2020 2020 206f 7574 5b27 7461 275d 203d       out['ta'] =
-000185e0: 2073 656c 662e 7461 0a0a 2020 2020 2020   self.ta..      
-000185f0: 2020 2020 2020 2320 4669 6e61 6c6c 792c        # Finally,
-00018600: 2073 6176 6520 6a75 6c69 6574 206f 7574   save juliet out
-00018610: 7075 7420 746f 2070 6963 6b6c 6520 6669  put to pickle fi
-00018620: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-00018630: 7069 636b 6c65 2e64 756d 7028 0a20 2020  pickle.dump(.   
-00018640: 2020 2020 2020 2020 2020 2020 206f 7574               out
-00018650: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00018660: 2020 6f70 656e 2873 656c 662e 6f75 745f    open(self.out_
-00018670: 666f 6c64 6572 202b 2073 656c 662e 7361  folder + self.sa
-00018680: 6d70 6c65 725f 7072 6566 6978 202b 2027  mpler_prefix + '
-00018690: 706f 7374 6572 696f 7273 2e70 6b6c 272c  posteriors.pkl',
-000186a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000186b0: 2020 2020 2020 2777 6227 2929 0a20 2020        'wb')).   
-000186c0: 2020 2020 2020 2020 2022 2222 0a20 2020           """.   
-000186d0: 2020 2020 2020 2020 2069 6620 2764 796e           if 'dyn
-000186e0: 6573 7479 2720 696e 2073 656c 662e 7361  esty' in self.sa
-000186f0: 6d70 6c65 723a 0a20 2020 2020 2020 2020  mpler:.         
-00018700: 2020 2020 2020 2069 6620 2873 656c 662e         if (self.
-00018710: 7361 6d70 6c65 7220 3d3d 2027 6479 6e61  sampler == 'dyna
-00018720: 6d69 635f 6479 6e65 7374 7927 2920 616e  mic_dynesty') an
-00018730: 6420 2873 656c 662e 6f75 745f 666f 6c64  d (self.out_fold
-00018740: 6572 2069 7320 6e6f 7420 4e6f 6e65 293a  er is not None):
-00018750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018760: 2020 2020 2070 6963 6b6c 652e 6475 6d70       pickle.dump
-00018770: 286f 7574 2c6f 7065 6e28 7365 6c66 2e6f  (out,open(self.o
-00018780: 7574 5f66 6f6c 6465 722b 275f 6479 6e65  ut_folder+'_dyne
-00018790: 7374 795f 444e 535f 706f 7374 6572 696f  sty_DNS_posterio
-000187a0: 7273 2e70 6b6c 272c 2777 6227 2929 0a20  rs.pkl','wb')). 
-000187b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000187c0: 6c69 6620 2873 656c 662e 7361 6d70 6c65  lif (self.sample
-000187d0: 7220 3d3d 2027 6479 6e65 7374 7927 2920  r == 'dynesty') 
-000187e0: 616e 6420 2873 656c 662e 6f75 745f 666f  and (self.out_fo
-000187f0: 6c64 6572 2069 7320 6e6f 7420 4e6f 6e65  lder is not None
-00018800: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00018810: 2020 2020 2020 2070 6963 6b6c 652e 6475         pickle.du
-00018820: 6d70 286f 7574 2c6f 7065 6e28 7365 6c66  mp(out,open(self
-00018830: 2e6f 7574 5f66 6f6c 6465 722b 275f 6479  .out_folder+'_dy
-00018840: 6e65 7374 795f 4e53 5f70 6f73 7465 7269  nesty_NS_posteri
-00018850: 6f72 732e 706b 6c27 2c27 7762 2729 290a  ors.pkl','wb')).
-00018860: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00018870: 2027 6d75 6c74 696e 6573 7427 2069 6e20   'multinest' in 
-00018880: 7365 6c66 2e73 616d 706c 6572 3a0a 2020  self.sampler:.  
-00018890: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000188a0: 2028 7365 6c66 2e73 616d 706c 6572 203d   (self.sampler =
-000188b0: 3d20 276d 756c 7469 6e65 7374 2729 2061  = 'multinest') a
-000188c0: 6e64 2028 7365 6c66 2e6f 7574 5f66 6f6c  nd (self.out_fol
-000188d0: 6465 7220 6973 206e 6f74 204e 6f6e 6529  der is not None)
-000188e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000188f0: 2020 2020 2020 7069 636b 6c65 2e64 756d        pickle.dum
-00018900: 7028 6f75 742c 6f70 656e 2873 656c 662e  p(out,open(self.
-00018910: 6f75 745f 666f 6c64 6572 2b27 706f 7374  out_folder+'post
-00018920: 6572 696f 7273 2e70 6b6c 272c 2777 6227  eriors.pkl','wb'
-00018930: 2929 0a20 2020 2020 2020 2020 2020 2065  )).            e
-00018940: 6c69 6620 2775 6c74 7261 6e65 7374 2720  lif 'ultranest' 
-00018950: 696e 2073 656c 662e 7361 6d70 6c65 723a  in self.sampler:
-00018960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018970: 2069 6620 2873 656c 662e 7361 6d70 6c65   if (self.sample
-00018980: 7220 3d3d 2027 756c 7472 616e 6573 7427  r == 'ultranest'
-00018990: 2920 616e 6420 2873 656c 662e 6f75 745f  ) and (self.out_
-000189a0: 666f 6c64 6572 2069 7320 6e6f 7420 4e6f  folder is not No
-000189b0: 6e65 293a 0a20 2020 2020 2020 2020 2020  ne):.           
-000189c0: 2020 2020 2020 2020 2070 6963 6b6c 652e           pickle.
-000189d0: 6475 6d70 286f 7574 2c6f 7065 6e28 7365  dump(out,open(se
-000189e0: 6c66 2e6f 7574 5f66 6f6c 6465 722b 7365  lf.out_folder+se
-000189f0: 6c66 2e73 616d 706c 6572 5f70 7265 6669  lf.sampler_prefi
-00018a00: 782b 2770 6f73 7465 7269 6f72 732e 706b  x+'posteriors.pk
-00018a10: 6c27 2c27 7762 2729 290a 2020 2020 2020  l','wb')).      
-00018a20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00018a30: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00018a40: 2020 2020 2320 4966 2074 6865 2073 616d      # If the sam
-00018a50: 706c 6572 2077 6173 2061 6c72 6561 6479  pler was already
-00018a60: 2072 616e 2c20 7468 656e 2075 7365 7220   ran, then user 
-00018a70: 7265 616c 6c79 2077 616e 7473 2074 6f20  really wants to 
-00018a80: 6578 7472 6163 7420 6f75 7470 7574 7320  extract outputs 
-00018a90: 6672 6f6d 2070 7265 7669 6f75 7320 6669  from previous fi
-00018aa0: 743a 0a20 2020 2020 2020 2020 2020 2070  t:.            p
-00018ab0: 7269 6e74 2827 4465 7465 6374 6564 2027  rint('Detected '
-00018ac0: 202b 2073 656c 662e 7361 6d70 6c65 7220   + self.sampler 
-00018ad0: 2b0a 2020 2020 2020 2020 2020 2020 2020  +.              
-00018ae0: 2020 2020 2720 7361 6d70 6c65 7220 6f75      ' sampler ou
-00018af0: 7470 7574 2066 696c 6573 202d 2d2d 2065  tput files --- e
-00018b00: 7874 7261 6374 696e 6720 6672 6f6d 2027  xtracting from '
-00018b10: 202b 0a20 2020 2020 2020 2020 2020 2020   +.             
-00018b20: 2020 2020 2073 656c 662e 6f75 745f 666f       self.out_fo
-00018b30: 6c64 6572 202b 2073 656c 662e 7361 6d70  lder + self.samp
-00018b40: 6c65 725f 7072 6566 6978 202b 2027 706f  ler_prefix + 'po
-00018b50: 7374 6572 696f 7273 2e70 6b6c 2729 0a20  steriors.pkl'). 
-00018b60: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00018b70: 6c66 2e64 6174 612e 7069 636b 6c65 5f65  lf.data.pickle_e
-00018b80: 6e63 6f64 696e 6720 6973 204e 6f6e 653a  ncoding is None:
-00018b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018ba0: 206f 7574 203d 2070 6963 6b6c 652e 6c6f   out = pickle.lo
-00018bb0: 6164 280a 2020 2020 2020 2020 2020 2020  ad(.            
-00018bc0: 2020 2020 2020 2020 6f70 656e 280a 2020          open(.  
-00018bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018be0: 2020 2020 2020 7365 6c66 2e6f 7574 5f66        self.out_f
-00018bf0: 6f6c 6465 7220 2b20 7365 6c66 2e73 616d  older + self.sam
-00018c00: 706c 6572 5f70 7265 6669 7820 2b0a 2020  pler_prefix +.  
-00018c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018c20: 2020 2020 2020 2770 6f73 7465 7269 6f72        'posterior
-00018c30: 732e 706b 6c27 2c20 2772 6227 2929 0a20  s.pkl', 'rb')). 
-00018c40: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00018c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018c60: 206f 7574 203d 2070 6963 6b6c 652e 6c6f   out = pickle.lo
-00018c70: 6164 286f 7065 6e28 0a20 2020 2020 2020  ad(open(.       
-00018c80: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00018c90: 662e 6f75 745f 666f 6c64 6572 202b 2073  f.out_folder + s
-00018ca0: 656c 662e 7361 6d70 6c65 725f 7072 6566  elf.sampler_pref
-00018cb0: 6978 202b 2027 706f 7374 6572 696f 7273  ix + 'posteriors
-00018cc0: 2e70 6b6c 272c 0a20 2020 2020 2020 2020  .pkl',.         
-00018cd0: 2020 2020 2020 2020 2020 2027 7262 2729             'rb')
-00018ce0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00018cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d00: 2020 2020 656e 636f 6469 6e67 3d73 656c      encoding=sel
-00018d10: 662e 6461 7461 2e70 6963 6b6c 655f 656e  f.data.pickle_en
-00018d20: 636f 6469 6e67 290a 2020 2020 2020 2020  coding).        
-00018d30: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00018d40: 2020 2020 6966 2028 7365 6c66 2e75 7365      if (self.use
-00018d50: 5f64 796e 6573 7479 2920 616e 6420 2873  _dynesty) and (s
-00018d60: 656c 662e 6f75 745f 666f 6c64 6572 2069  elf.out_folder i
-00018d70: 7320 6e6f 7420 4e6f 6e65 293a 0a20 2020  s not None):.   
-00018d80: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00018d90: 7365 6c66 2e64 796e 616d 6963 3a0a 2020  self.dynamic:.  
-00018da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018db0: 2020 6966 206f 732e 7061 7468 2e65 7869    if os.path.exi
-00018dc0: 7374 7328 7365 6c66 2e6f 7574 5f66 6f6c  sts(self.out_fol
-00018dd0: 6465 7220 2b0a 2020 2020 2020 2020 2020  der +.          
-00018de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018df0: 2020 2020 2020 2020 2020 2020 275f 6479              '_dy
-00018e00: 6e65 7374 795f 444e 535f 706f 7374 6572  nesty_DNS_poster
-00018e10: 696f 7273 2e70 6b6c 2729 3a0a 2020 2020  iors.pkl'):.    
-00018e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e30: 2020 2020 6966 2073 656c 662e 6461 7461      if self.data
-00018e40: 2e76 6572 626f 7365 3a0a 2020 2020 2020  .verbose:.      
-00018e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e60: 2020 2020 2020 7072 696e 7428 0a20 2020        print(.   
-00018e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e80: 2020 2020 2020 2020 2020 2020 2027 4465               'De
-00018e90: 7465 6374 6564 2028 6479 6e65 7374 7929  tected (dynesty)
-00018ea0: 2044 796e 616d 6963 204e 5320 6f75 7470   Dynamic NS outp
-00018eb0: 7574 2066 696c 6573 202d 2d2d 2065 7874  ut files --- ext
-00018ec0: 7261 6374 696e 672e 2e2e 270a 2020 2020  racting...'.    
-00018ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ee0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00018ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018f00: 2020 6966 2073 656c 662e 6461 7461 2e70    if self.data.p
-00018f10: 6963 6b6c 655f 656e 636f 6469 6e67 2069  ickle_encoding i
-00018f20: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00018f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018f40: 2020 2020 6f75 7420 3d20 7069 636b 6c65      out = pickle
-00018f50: 2e6c 6f61 6428 0a20 2020 2020 2020 2020  .load(.         
-00018f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018f70: 2020 2020 2020 206f 7065 6e28 0a20 2020         open(.   
-00018f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018fa0: 2073 656c 662e 6f75 745f 666f 6c64 6572   self.out_folder
-00018fb0: 202b 0a20 2020 2020 2020 2020 2020 2020   +.             
-00018fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018fd0: 2020 2020 2020 2027 5f64 796e 6573 7479         '_dynesty
-00018fe0: 5f44 4e53 5f70 6f73 7465 7269 6f72 732e  _DNS_posteriors.
-00018ff0: 706b 6c27 2c20 2772 6227 2929 0a20 2020  pkl', 'rb')).   
-00019000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019010: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00019020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019030: 2020 2020 2020 206f 7574 203d 2070 6963         out = pic
-00019040: 6b6c 652e 6c6f 6164 280a 2020 2020 2020  kle.load(.      
+00018100: 2020 2020 5464 6963 7420 3d20 7b7d 0a20      Tdict = {}. 
+00018110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018120: 2020 2020 2020 2066 6972 7374 5469 6d65         firstTime
+00018130: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00018140: 2020 2020 2020 2020 2020 2020 2023 2045               # E
+00018150: 7874 7261 6374 2070 6c61 6e65 7420 6e75  xtract planet nu
+00018160: 6d62 6572 2028 706e 756d 2c20 652e 672e  mber (pnum, e.g.
+00018170: 2c20 2770 3127 292c 2069 6e73 7472 756d  , 'p1'), instrum
+00018180: 656e 7420 2869 6e73 2c20 652e 672e 2c20  ent (ins, e.g., 
+00018190: 2754 4553 5327 2920 616e 6420 7472 616e  'TESS') and tran
+000181a0: 7369 7420 6e75 6d62 6572 2028 746e 756d  sit number (tnum
+000181b0: 2c20 652e 672e 2c20 272d 3127 293a 0a20  , e.g., '-1'):. 
+000181c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000181d0: 2020 2070 6e75 6d2c 2069 6e73 2c20 746e     pnum, ins, tn
+000181e0: 756d 203d 2070 7665 6374 6f72 5b31 3a5d  um = pvector[1:]
+000181f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018200: 2020 2020 2069 6620 706e 756d 206e 6f74       if pnum not
+00018210: 2069 6e20 6c69 7374 2854 6469 6374 2e6b   in list(Tdict.k
+00018220: 6579 7328 2929 3a0a 2020 2020 2020 2020  eys()):.        
+00018230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018240: 5464 6963 745b 706e 756d 5d20 3d20 7b7d  Tdict[pnum] = {}
+00018250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018260: 2020 2020 2054 6469 6374 5b70 6e75 6d5d       Tdict[pnum]
+00018270: 5b69 6e74 280a 2020 2020 2020 2020 2020  [int(.          
+00018280: 2020 2020 2020 2020 2020 2020 2020 746e                tn
+00018290: 756d 295d 203d 206f 7574 5b27 706f 7374  um)] = out['post
+000182a0: 6572 696f 725f 7361 6d70 6c65 7327 5d5b  erior_samples'][
+000182b0: 706f 7374 6572 696f 725f 7061 7261 6d65  posterior_parame
+000182c0: 7465 725d 0a20 2020 2020 2020 2020 2020  ter].           
+000182d0: 2069 6620 5470 6172 616d 6574 7269 7a61   if Tparametriza
+000182e0: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
+000182f0: 2020 2020 2020 666f 7220 706e 756d 2069        for pnum i
+00018300: 6e20 6c69 7374 2854 6469 6374 2e6b 6579  n list(Tdict.key
+00018310: 7328 2929 3a0a 2020 2020 2020 2020 2020  s()):.          
+00018320: 2020 2020 2020 2020 2020 616c 6c5f 6e73            all_ns
+00018330: 203d 206e 702e 6172 7261 7928 6c69 7374   = np.array(list
+00018340: 2854 6469 6374 5b70 6e75 6d5d 2e6b 6579  (Tdict[pnum].key
+00018350: 7328 2929 290a 2020 2020 2020 2020 2020  s())).          
+00018360: 2020 2020 2020 2020 2020 4e73 616d 706c            Nsampl
+00018370: 6573 203d 206c 656e 2854 6469 6374 5b70  es = len(Tdict[p
+00018380: 6e75 6d5d 5b61 6c6c 5f6e 735b 305d 5d29  num][all_ns[0]])
+00018390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000183a0: 2020 2020 206f 7574 5b27 706f 7374 6572       out['poster
+000183b0: 696f 725f 7361 6d70 6c65 7327 5d5b 0a20  ior_samples'][. 
+000183c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000183d0: 2020 2020 2020 2027 505f 2720 2b20 706e         'P_' + pn
+000183e0: 756d 5d2c 206f 7574 5b27 706f 7374 6572  um], out['poster
+000183f0: 696f 725f 7361 6d70 6c65 7327 5d5b 0a20  ior_samples'][. 
+00018400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018410: 2020 2020 2020 2020 2020 2027 7430 5f27             't0_'
+00018420: 202b 0a20 2020 2020 2020 2020 2020 2020   +.             
+00018430: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00018440: 6e75 6d5d 203d 206e 702e 7a65 726f 7328  num] = np.zeros(
+00018450: 4e73 616d 706c 6573 292c 206e 702e 7a65  Nsamples), np.ze
+00018460: 726f 7328 4e73 616d 706c 6573 290a 2020  ros(Nsamples).  
+00018470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018480: 2020 4e20 3d20 6c65 6e28 616c 6c5f 6e73    N = len(all_ns
+00018490: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000184a0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+000184b0: 616e 6765 284e 7361 6d70 6c65 7329 3a0a  ange(Nsamples):.
+000184c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000184d0: 2020 2020 2020 2020 616c 6c5f 5473 203d          all_Ts =
+000184e0: 206e 702e 7a65 726f 7328 4e29 0a20 2020   np.zeros(N).   
+000184f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018500: 2020 2020 2066 6f72 206a 2069 6e20 7261       for j in ra
+00018510: 6e67 6528 6c65 6e28 616c 6c5f 6e73 2929  nge(len(all_ns))
+00018520: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00018530: 2020 2020 2020 2020 2020 2020 2020 616c                al
+00018540: 6c5f 5473 5b6a 5d20 3d20 5464 6963 745b  l_Ts[j] = Tdict[
+00018550: 706e 756d 5d5b 616c 6c5f 6e73 5b6a 5d5d  pnum][all_ns[j]]
+00018560: 5b69 5d0a 2020 2020 2020 2020 2020 2020  [i].            
+00018570: 2020 2020 2020 2020 2020 2020 5859 2c20              XY, 
+00018580: 592c 2058 2c20 5832 203d 206e 702e 7375  Y, X, X2 = np.su
+00018590: 6d28 616c 6c5f 5473 202a 2061 6c6c 5f6e  m(all_Ts * all_n
+000185a0: 7329 202f 204e 2c20 6e70 2e73 756d 280a  s) / N, np.sum(.
+000185b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000185c0: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
+000185d0: 5473 2920 2f20 4e2c 206e 702e 7375 6d28  Ts) / N, np.sum(
+000185e0: 616c 6c5f 6e73 2920 2f20 4e2c 206e 702e  all_ns) / N, np.
+000185f0: 7375 6d28 616c 6c5f 6e73 2a2a 0a20 2020  sum(all_ns**.   
+00018600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018640: 2032 2920 2f20 4e0a 2020 2020 2020 2020   2) / N.        
+00018650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018660: 2320 4765 7420 736c 6f70 653a 0a20 2020  # Get slope:.   
+00018670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018680: 2020 2020 206f 7574 5b27 706f 7374 6572       out['poster
+00018690: 696f 725f 7361 6d70 6c65 7327 5d5b 2750  ior_samples']['P
+000186a0: 5f27 202b 0a20 2020 2020 2020 2020 2020  _' +.           
+000186b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000186c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000186d0: 2020 2020 2020 706e 756d 5d5b 695d 203d        pnum][i] =
+000186e0: 2028 5859 202d 0a20 2020 2020 2020 2020   (XY -.         
+000186f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018720: 2020 2020 5820 2a20 5929 202f 2028 5832      X * Y) / (X2
+00018730: 202d 0a20 2020 2020 2020 2020 2020 2020   -.             
+00018740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018770: 2020 2020 2020 2020 2020 2858 2a2a 3229            (X**2)
+00018780: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00018790: 2020 2020 2020 2020 2020 2320 496e 7465            # Inte
+000187a0: 7263 6570 743a 0a20 2020 2020 2020 2020  rcept:.         
+000187b0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000187c0: 7574 5b27 706f 7374 6572 696f 725f 7361  ut['posterior_sa
+000187d0: 6d70 6c65 7327 5d5b 0a20 2020 2020 2020  mples'][.       
+000187e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000187f0: 2020 2020 2027 7430 5f27 202b 0a20 2020       't0_' +.   
+00018800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018810: 2020 2020 2020 2020 2070 6e75 6d5d 5b69           pnum][i
+00018820: 5d20 3d20 5920 2d20 6f75 745b 2770 6f73  ] = Y - out['pos
+00018830: 7465 7269 6f72 5f73 616d 706c 6573 275d  terior_samples']
+00018840: 5b27 505f 2720 2b0a 2020 2020 2020 2020  ['P_' +.        
+00018850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018880: 2020 2020 2020 2020 2020 2020 706e 756d              pnum
+00018890: 5d5b 695d 202a 2058 0a20 2020 2020 2020  ][i] * X.       
+000188a0: 2020 2020 2069 6620 7365 6c66 2e64 6174       if self.dat
+000188b0: 612e 745f 6c63 2069 7320 6e6f 7420 4e6f  a.t_lc is not No
+000188c0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+000188d0: 2020 2020 6966 2054 7275 6520 696e 2073      if True in s
+000188e0: 656c 662e 6461 7461 2e6c 635f 6f70 7469  elf.data.lc_opti
+000188f0: 6f6e 735b 2765 6666 6963 6965 6e74 5f62  ons['efficient_b
+00018900: 7027 5d2e 7661 6c75 6573 2829 3a0a 2020  p'].values():.  
+00018910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018920: 2020 6f75 745b 2770 7527 5d20 3d20 7365    out['pu'] = se
+00018930: 6c66 2e70 750a 2020 2020 2020 2020 2020  lf.pu.          
+00018940: 2020 2020 2020 2020 2020 6f75 745b 2770            out['p
+00018950: 6c27 5d20 3d20 7365 6c66 2e70 6c0a 2020  l'] = self.pl.  
+00018960: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00018970: 662e 6461 7461 2e74 5f72 7620 6973 206e  f.data.t_rv is n
+00018980: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00018990: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+000189a0: 2e64 6174 612e 7276 5f6f 7074 696f 6e73  .data.rv_options
+000189b0: 5b27 6669 7472 766c 696e 6527 5d20 6f72  ['fitrvline'] or
+000189c0: 2073 656c 662e 6461 7461 2e72 765f 6f70   self.data.rv_op
+000189d0: 7469 6f6e 735b 0a20 2020 2020 2020 2020  tions[.         
+000189e0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000189f0: 6669 7472 7671 7561 6427 5d3a 0a20 2020  fitrvquad']:.   
+00018a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018a10: 206f 7574 5b27 7461 275d 203d 2073 656c   out['ta'] = sel
+00018a20: 662e 7461 0a0a 2020 2020 2020 2020 2020  f.ta..          
+00018a30: 2020 2320 4669 6e61 6c6c 792c 2073 6176    # Finally, sav
+00018a40: 6520 6a75 6c69 6574 206f 7574 7075 7420  e juliet output 
+00018a50: 746f 2070 6963 6b6c 6520 6669 6c65 3a0a  to pickle file:.
+00018a60: 2020 2020 2020 2020 2020 2020 7069 636b              pick
+00018a70: 6c65 2e64 756d 7028 0a20 2020 2020 2020  le.dump(.       
+00018a80: 2020 2020 2020 2020 206f 7574 2c0a 2020           out,.  
+00018a90: 2020 2020 2020 2020 2020 2020 2020 6f70                op
+00018aa0: 656e 2873 656c 662e 6f75 745f 666f 6c64  en(self.out_fold
+00018ab0: 6572 202b 2073 656c 662e 7361 6d70 6c65  er + self.sample
+00018ac0: 725f 7072 6566 6978 202b 2027 706f 7374  r_prefix + 'post
+00018ad0: 6572 696f 7273 2e70 6b6c 272c 0a20 2020  eriors.pkl',.   
+00018ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018af0: 2020 2777 6227 2929 0a20 2020 2020 2020    'wb')).       
+00018b00: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00018b10: 2020 2020 2069 6620 2764 796e 6573 7479       if 'dynesty
+00018b20: 2720 696e 2073 656c 662e 7361 6d70 6c65  ' in self.sample
+00018b30: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+00018b40: 2020 2069 6620 2873 656c 662e 7361 6d70     if (self.samp
+00018b50: 6c65 7220 3d3d 2027 6479 6e61 6d69 635f  ler == 'dynamic_
+00018b60: 6479 6e65 7374 7927 2920 616e 6420 2873  dynesty') and (s
+00018b70: 656c 662e 6f75 745f 666f 6c64 6572 2069  elf.out_folder i
+00018b80: 7320 6e6f 7420 4e6f 6e65 293a 0a20 2020  s not None):.   
+00018b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018ba0: 2070 6963 6b6c 652e 6475 6d70 286f 7574   pickle.dump(out
+00018bb0: 2c6f 7065 6e28 7365 6c66 2e6f 7574 5f66  ,open(self.out_f
+00018bc0: 6f6c 6465 722b 275f 6479 6e65 7374 795f  older+'_dynesty_
+00018bd0: 444e 535f 706f 7374 6572 696f 7273 2e70  DNS_posteriors.p
+00018be0: 6b6c 272c 2777 6227 2929 0a20 2020 2020  kl','wb')).     
+00018bf0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00018c00: 2873 656c 662e 7361 6d70 6c65 7220 3d3d  (self.sampler ==
+00018c10: 2027 6479 6e65 7374 7927 2920 616e 6420   'dynesty') and 
+00018c20: 2873 656c 662e 6f75 745f 666f 6c64 6572  (self.out_folder
+00018c30: 2069 7320 6e6f 7420 4e6f 6e65 293a 0a20   is not None):. 
+00018c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018c50: 2020 2070 6963 6b6c 652e 6475 6d70 286f     pickle.dump(o
+00018c60: 7574 2c6f 7065 6e28 7365 6c66 2e6f 7574  ut,open(self.out
+00018c70: 5f66 6f6c 6465 722b 275f 6479 6e65 7374  _folder+'_dynest
+00018c80: 795f 4e53 5f70 6f73 7465 7269 6f72 732e  y_NS_posteriors.
+00018c90: 706b 6c27 2c27 7762 2729 290a 2020 2020  pkl','wb')).    
+00018ca0: 2020 2020 2020 2020 656c 6966 2027 6d75          elif 'mu
+00018cb0: 6c74 696e 6573 7427 2069 6e20 7365 6c66  ltinest' in self
+00018cc0: 2e73 616d 706c 6572 3a0a 2020 2020 2020  .sampler:.      
+00018cd0: 2020 2020 2020 2020 2020 6966 2028 7365            if (se
+00018ce0: 6c66 2e73 616d 706c 6572 203d 3d20 276d  lf.sampler == 'm
+00018cf0: 756c 7469 6e65 7374 2729 2061 6e64 2028  ultinest') and (
+00018d00: 7365 6c66 2e6f 7574 5f66 6f6c 6465 7220  self.out_folder 
+00018d10: 6973 206e 6f74 204e 6f6e 6529 3a0a 2020  is not None):.  
+00018d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018d30: 2020 7069 636b 6c65 2e64 756d 7028 6f75    pickle.dump(ou
+00018d40: 742c 6f70 656e 2873 656c 662e 6f75 745f  t,open(self.out_
+00018d50: 666f 6c64 6572 2b27 706f 7374 6572 696f  folder+'posterio
+00018d60: 7273 2e70 6b6c 272c 2777 6227 2929 0a20  rs.pkl','wb')). 
+00018d70: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00018d80: 2775 6c74 7261 6e65 7374 2720 696e 2073  'ultranest' in s
+00018d90: 656c 662e 7361 6d70 6c65 723a 0a20 2020  elf.sampler:.   
+00018da0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00018db0: 2873 656c 662e 7361 6d70 6c65 7220 3d3d  (self.sampler ==
+00018dc0: 2027 756c 7472 616e 6573 7427 2920 616e   'ultranest') an
+00018dd0: 6420 2873 656c 662e 6f75 745f 666f 6c64  d (self.out_fold
+00018de0: 6572 2069 7320 6e6f 7420 4e6f 6e65 293a  er is not None):
+00018df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018e00: 2020 2020 2070 6963 6b6c 652e 6475 6d70       pickle.dump
+00018e10: 286f 7574 2c6f 7065 6e28 7365 6c66 2e6f  (out,open(self.o
+00018e20: 7574 5f66 6f6c 6465 722b 7365 6c66 2e73  ut_folder+self.s
+00018e30: 616d 706c 6572 5f70 7265 6669 782b 2770  ampler_prefix+'p
+00018e40: 6f73 7465 7269 6f72 732e 706b 6c27 2c27  osteriors.pkl','
+00018e50: 7762 2729 290a 2020 2020 2020 2020 2020  wb')).          
+00018e60: 2020 2222 220a 2020 2020 2020 2020 656c    """.        el
+00018e70: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00018e80: 2320 4966 2074 6865 2073 616d 706c 6572  # If the sampler
+00018e90: 2077 6173 2061 6c72 6561 6479 2072 616e   was already ran
+00018ea0: 2c20 7468 656e 2075 7365 7220 7265 616c  , then user real
+00018eb0: 6c79 2077 616e 7473 2074 6f20 6578 7472  ly wants to extr
+00018ec0: 6163 7420 6f75 7470 7574 7320 6672 6f6d  act outputs from
+00018ed0: 2070 7265 7669 6f75 7320 6669 743a 0a20   previous fit:. 
+00018ee0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00018ef0: 2827 4465 7465 6374 6564 2027 202b 2073  ('Detected ' + s
+00018f00: 656c 662e 7361 6d70 6c65 7220 2b0a 2020  elf.sampler +.  
+00018f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f20: 2720 7361 6d70 6c65 7220 6f75 7470 7574  ' sampler output
+00018f30: 2066 696c 6573 202d 2d2d 2065 7874 7261   files --- extra
+00018f40: 6374 696e 6720 6672 6f6d 2027 202b 0a20  cting from ' +. 
+00018f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f60: 2073 656c 662e 6f75 745f 666f 6c64 6572   self.out_folder
+00018f70: 202b 2073 656c 662e 7361 6d70 6c65 725f   + self.sampler_
+00018f80: 7072 6566 6978 202b 2027 706f 7374 6572  prefix + 'poster
+00018f90: 696f 7273 2e70 6b6c 2729 0a20 2020 2020  iors.pkl').     
+00018fa0: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
+00018fb0: 6174 612e 7069 636b 6c65 5f65 6e63 6f64  ata.pickle_encod
+00018fc0: 696e 6720 6973 204e 6f6e 653a 0a20 2020  ing is None:.   
+00018fd0: 2020 2020 2020 2020 2020 2020 206f 7574               out
+00018fe0: 203d 2070 6963 6b6c 652e 6c6f 6164 280a   = pickle.load(.
+00018ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019000: 2020 2020 6f70 656e 280a 2020 2020 2020      open(.      
+00019010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019020: 2020 7365 6c66 2e6f 7574 5f66 6f6c 6465    self.out_folde
+00019030: 7220 2b20 7365 6c66 2e73 616d 706c 6572  r + self.sampler
+00019040: 5f70 7265 6669 7820 2b0a 2020 2020 2020  _prefix +.      
 00019050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019060: 2020 2020 2020 2020 2020 6f70 656e 280a            open(.
-00019070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019090: 2020 2020 7365 6c66 2e6f 7574 5f66 6f6c      self.out_fol
-000190a0: 6465 7220 2b0a 2020 2020 2020 2020 2020  der +.          
-000190b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000190c0: 2020 2020 2020 2020 2020 275f 6479 6e65            '_dyne
-000190d0: 7374 795f 444e 535f 706f 7374 6572 696f  sty_DNS_posterio
-000190e0: 7273 2e70 6b6c 272c 2027 7262 2729 2c0a  rs.pkl', 'rb'),.
-000190f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019110: 656e 636f 6469 6e67 3d73 656c 662e 6461  encoding=self.da
-00019120: 7461 2e70 6963 6b6c 655f 656e 636f 6469  ta.pickle_encodi
-00019130: 6e67 290a 2020 2020 2020 2020 2020 2020  ng).            
-00019140: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00019150: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00019160: 206f 732e 7061 7468 2e65 7869 7374 7328   os.path.exists(
-00019170: 7365 6c66 2e6f 7574 5f66 6f6c 6465 7220  self.out_folder 
-00019180: 2b0a 2020 2020 2020 2020 2020 2020 2020  +.              
-00019190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000191a0: 2020 2020 2020 2020 275f 6479 6e65 7374          '_dynest
-000191b0: 795f 4e53 5f70 6f73 7465 7269 6f72 732e  y_NS_posteriors.
-000191c0: 706b 6c27 293a 0a20 2020 2020 2020 2020  pkl'):.         
-000191d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000191e0: 6620 7365 6c66 2e64 6174 612e 7665 7262  f self.data.verb
-000191f0: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
-00019200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019210: 2070 7269 6e74 280a 2020 2020 2020 2020   print(.        
+00019060: 2020 2770 6f73 7465 7269 6f72 732e 706b    'posteriors.pk
+00019070: 6c27 2c20 2772 6227 2929 0a20 2020 2020  l', 'rb')).     
+00019080: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00019090: 2020 2020 2020 2020 2020 2020 206f 7574               out
+000190a0: 203d 2070 6963 6b6c 652e 6c6f 6164 286f   = pickle.load(o
+000190b0: 7065 6e28 0a20 2020 2020 2020 2020 2020  pen(.           
+000190c0: 2020 2020 2020 2020 2073 656c 662e 6f75           self.ou
+000190d0: 745f 666f 6c64 6572 202b 2073 656c 662e  t_folder + self.
+000190e0: 7361 6d70 6c65 725f 7072 6566 6978 202b  sampler_prefix +
+000190f0: 2027 706f 7374 6572 696f 7273 2e70 6b6c   'posteriors.pkl
+00019100: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00019110: 2020 2020 2020 2027 7262 2729 2c0a 2020         'rb'),.  
+00019120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019140: 656e 636f 6469 6e67 3d73 656c 662e 6461  encoding=self.da
+00019150: 7461 2e70 6963 6b6c 655f 656e 636f 6469  ta.pickle_encodi
+00019160: 6e67 290a 2020 2020 2020 2020 2020 2020  ng).            
+00019170: 2222 220a 2020 2020 2020 2020 2020 2020  """.            
+00019180: 6966 2028 7365 6c66 2e75 7365 5f64 796e  if (self.use_dyn
+00019190: 6573 7479 2920 616e 6420 2873 656c 662e  esty) and (self.
+000191a0: 6f75 745f 666f 6c64 6572 2069 7320 6e6f  out_folder is no
+000191b0: 7420 4e6f 6e65 293a 0a20 2020 2020 2020  t None):.       
+000191c0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+000191d0: 2e64 796e 616d 6963 3a0a 2020 2020 2020  .dynamic:.      
+000191e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000191f0: 206f 732e 7061 7468 2e65 7869 7374 7328   os.path.exists(
+00019200: 7365 6c66 2e6f 7574 5f66 6f6c 6465 7220  self.out_folder 
+00019210: 2b0a 2020 2020 2020 2020 2020 2020 2020  +.              
 00019220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019230: 2020 2020 2020 2020 2744 6574 6563 7465          'Detecte
-00019240: 6420 2864 796e 6573 7479 2920 4e53 206f  d (dynesty) NS o
-00019250: 7574 7075 7420 6669 6c65 7320 2d2d 2d20  utput files --- 
-00019260: 6578 7472 6163 7469 6e67 2e2e 2e27 0a20  extracting...'. 
-00019270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019280: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00019230: 2020 2020 2020 2020 275f 6479 6e65 7374          '_dynest
+00019240: 795f 444e 535f 706f 7374 6572 696f 7273  y_DNS_posteriors
+00019250: 2e70 6b6c 2729 3a0a 2020 2020 2020 2020  .pkl'):.        
+00019260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019270: 6966 2073 656c 662e 6461 7461 2e76 6572  if self.data.ver
+00019280: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
 00019290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000192a0: 2020 2020 2069 6620 7365 6c66 2e64 6174       if self.dat
-000192b0: 612e 7069 636b 6c65 5f65 6e63 6f64 696e  a.pickle_encodin
-000192c0: 6720 6973 204e 6f6e 653a 0a20 2020 2020  g is None:.     
-000192d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000192e0: 2020 2020 2020 206f 7574 203d 2070 6963         out = pic
-000192f0: 6b6c 652e 6c6f 6164 280a 2020 2020 2020  kle.load(.      
-00019300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019310: 2020 2020 2020 2020 2020 6f70 656e 280a            open(.
-00019320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019340: 2020 2020 7365 6c66 2e6f 7574 5f66 6f6c      self.out_fol
-00019350: 6465 7220 2b0a 2020 2020 2020 2020 2020  der +.          
-00019360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019370: 2020 2020 2020 2020 2020 275f 6479 6e65            '_dyne
-00019380: 7374 795f 4e53 5f70 6f73 7465 7269 6f72  sty_NS_posterior
-00019390: 732e 706b 6c27 2c20 2772 6227 2929 0a20  s.pkl', 'rb')). 
+000192a0: 2020 7072 696e 7428 0a20 2020 2020 2020    print(.       
+000192b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000192c0: 2020 2020 2020 2020 2027 4465 7465 6374           'Detect
+000192d0: 6564 2028 6479 6e65 7374 7929 2044 796e  ed (dynesty) Dyn
+000192e0: 616d 6963 204e 5320 6f75 7470 7574 2066  amic NS output f
+000192f0: 696c 6573 202d 2d2d 2065 7874 7261 6374  iles --- extract
+00019300: 696e 672e 2e2e 270a 2020 2020 2020 2020  ing...'.        
+00019310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019320: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00019330: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00019340: 2073 656c 662e 6461 7461 2e70 6963 6b6c   self.data.pickl
+00019350: 655f 656e 636f 6469 6e67 2069 7320 4e6f  e_encoding is No
+00019360: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00019370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019380: 6f75 7420 3d20 7069 636b 6c65 2e6c 6f61  out = pickle.loa
+00019390: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
 000193a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000193b0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000193b0: 2020 206f 7065 6e28 0a20 2020 2020 2020     open(.       
 000193c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000193d0: 2020 2020 2020 2020 206f 7574 203d 2070           out = p
-000193e0: 6963 6b6c 652e 6c6f 6164 280a 2020 2020  ickle.load(.    
+000193d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000193e0: 662e 6f75 745f 666f 6c64 6572 202b 0a20  f.out_folder +. 
 000193f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019400: 2020 2020 2020 2020 2020 2020 6f70 656e              open
-00019410: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00019420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019430: 2020 2020 2020 7365 6c66 2e6f 7574 5f66        self.out_f
-00019440: 6f6c 6465 7220 2b0a 2020 2020 2020 2020  older +.        
-00019450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019460: 2020 2020 2020 2020 2020 2020 275f 6479              '_dy
-00019470: 6e65 7374 795f 4e53 5f70 6f73 7465 7269  nesty_NS_posteri
-00019480: 6f72 732e 706b 6c27 2c20 2772 6227 292c  ors.pkl', 'rb'),
-00019490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000194a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000194b0: 2065 6e63 6f64 696e 673d 7365 6c66 2e64   encoding=self.d
-000194c0: 6174 612e 7069 636b 6c65 5f65 6e63 6f64  ata.pickle_encod
-000194d0: 696e 6729 0a20 2020 2020 2020 2020 2020  ing).           
-000194e0: 2065 6c69 6620 7365 6c66 2e6f 7574 5f66   elif self.out_f
-000194f0: 6f6c 6465 7220 6973 206e 6f74 204e 6f6e  older is not Non
-00019500: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00019510: 2020 2069 6620 7365 6c66 2e64 6174 612e     if self.data.
-00019520: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
-00019530: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00019540: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
-00019550: 2020 2020 2020 2020 2020 2020 2744 6574              'Det
-00019560: 6563 7465 6420 284d 756c 7469 4e65 7374  ected (MultiNest
-00019570: 2920 4e53 206f 7574 7075 7420 6669 6c65  ) NS output file
-00019580: 7320 2d2d 2d20 6578 7472 6163 7469 6e67  s --- extracting
-00019590: 2e2e 2e27 0a20 2020 2020 2020 2020 2020  ...'.           
-000195a0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-000195b0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-000195c0: 6c66 2e64 6174 612e 7069 636b 6c65 5f65  lf.data.pickle_e
-000195d0: 6e63 6f64 696e 6720 6973 204e 6f6e 653a  ncoding is None:
-000195e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000195f0: 2020 2020 206f 7574 203d 2070 6963 6b6c       out = pickl
-00019600: 652e 6c6f 6164 286f 7065 6e28 7365 6c66  e.load(open(self
-00019610: 2e6f 7574 5f66 6f6c 6465 722b 2770 6f73  .out_folder+'pos
-00019620: 7465 7269 6f72 732e 706b 6c27 2c27 7262  teriors.pkl','rb
-00019630: 2729 290a 2020 2020 2020 2020 2020 2020  ')).            
-00019640: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00019650: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
-00019660: 7420 3d20 7069 636b 6c65 2e6c 6f61 6428  t = pickle.load(
-00019670: 6f70 656e 2873 656c 662e 6f75 745f 666f  open(self.out_fo
-00019680: 6c64 6572 2b27 706f 7374 6572 696f 7273  lder+'posteriors
-00019690: 2e70 6b6c 272c 2772 6227 292c 2065 6e63  .pkl','rb'), enc
-000196a0: 6f64 696e 6720 3d20 7365 6c66 2e64 6174  oding = self.dat
-000196b0: 612e 7069 636b 6c65 5f65 6e63 6f64 696e  a.pickle_encodin
-000196c0: 6729 0a20 2020 2020 2020 2020 2020 2022  g).            "
-000196d0: 2222 0a20 2020 2020 2020 2020 2020 2069  "".            i
-000196e0: 6620 6c65 6e28 6f75 742e 6b65 7973 2829  f len(out.keys()
-000196f0: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
-00019700: 2020 2020 2020 2020 7072 696e 7428 0a20          print(. 
+00019400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019410: 2020 2027 5f64 796e 6573 7479 5f44 4e53     '_dynesty_DNS
+00019420: 5f70 6f73 7465 7269 6f72 732e 706b 6c27  _posteriors.pkl'
+00019430: 2c20 2772 6227 2929 0a20 2020 2020 2020  , 'rb')).       
+00019440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019450: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00019460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019470: 2020 206f 7574 203d 2070 6963 6b6c 652e     out = pickle.
+00019480: 6c6f 6164 280a 2020 2020 2020 2020 2020  load(.          
+00019490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000194a0: 2020 2020 2020 6f70 656e 280a 2020 2020        open(.    
+000194b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000194c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000194d0: 7365 6c66 2e6f 7574 5f66 6f6c 6465 7220  self.out_folder 
+000194e0: 2b0a 2020 2020 2020 2020 2020 2020 2020  +.              
+000194f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019500: 2020 2020 2020 275f 6479 6e65 7374 795f        '_dynesty_
+00019510: 444e 535f 706f 7374 6572 696f 7273 2e70  DNS_posteriors.p
+00019520: 6b6c 272c 2027 7262 2729 2c0a 2020 2020  kl', 'rb'),.    
+00019530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019540: 2020 2020 2020 2020 2020 2020 656e 636f              enco
+00019550: 6469 6e67 3d73 656c 662e 6461 7461 2e70  ding=self.data.p
+00019560: 6963 6b6c 655f 656e 636f 6469 6e67 290a  ickle_encoding).
+00019570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019580: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00019590: 2020 2020 2020 2020 2020 6966 206f 732e            if os.
+000195a0: 7061 7468 2e65 7869 7374 7328 7365 6c66  path.exists(self
+000195b0: 2e6f 7574 5f66 6f6c 6465 7220 2b0a 2020  .out_folder +.  
+000195c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000195d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000195e0: 2020 2020 275f 6479 6e65 7374 795f 4e53      '_dynesty_NS
+000195f0: 5f70 6f73 7465 7269 6f72 732e 706b 6c27  _posteriors.pkl'
+00019600: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00019610: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00019620: 6c66 2e64 6174 612e 7665 7262 6f73 653a  lf.data.verbose:
+00019630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019640: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+00019650: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
+00019660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019670: 2020 2020 2744 6574 6563 7465 6420 2864      'Detected (d
+00019680: 796e 6573 7479 2920 4e53 206f 7574 7075  ynesty) NS outpu
+00019690: 7420 6669 6c65 7320 2d2d 2d20 6578 7472  t files --- extr
+000196a0: 6163 7469 6e67 2e2e 2e27 0a20 2020 2020  acting...'.     
+000196b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000196c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000196d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000196e0: 2069 6620 7365 6c66 2e64 6174 612e 7069   if self.data.pi
+000196f0: 636b 6c65 5f65 6e63 6f64 696e 6720 6973  ckle_encoding is
+00019700: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
 00019710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019720: 2020 2027 5761 726e 696e 673a 206e 6f20     'Warning: no 
-00019730: 6f75 7470 7574 2067 656e 6572 6174 6564  output generated
-00019740: 206f 7220 6578 7472 6163 7465 642e 2043   or extracted. C
-00019750: 6865 636b 2074 6865 2066 6974 206f 7074  heck the fit opt
-00019760: 696f 6e73 2067 6976 656e 2074 6f20 6a75  ions given to ju
-00019770: 6c69 6574 2e66 6974 2829 2e27 0a20 2020  liet.fit().'.   
-00019780: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00019790: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000197a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000197b0: 2023 2046 6f72 2072 6574 726f 2d63 6f6d   # For retro-com
-000197c0: 7061 7469 6269 6c69 7479 2c20 6368 6563  patibility, chec
-000197d0: 6b20 666f 7220 7369 676d 615f 775f 7276  k for sigma_w_rv
-000197e0: 5f69 6e73 7472 756d 656e 7420 616e 6420  _instrument and 
-000197f0: 6164 6420 616e 2065 7874 7261 2076 6172  add an extra var
-00019800: 6961 626c 6520 6f6e 206f 7574 0a20 2020  iable on out.   
-00019810: 2020 2020 2020 2020 2020 2020 2023 2066               # f
-00019820: 6f72 2073 6967 6d61 5f77 5f69 6e73 7472  or sigma_w_instr
-00019830: 756d 656e 743a 0a20 2020 2020 2020 2020  ument:.         
-00019840: 2020 2020 2020 206f 7574 5f74 656d 7020         out_temp 
-00019850: 3d20 6469 6374 2829 0a20 2020 2020 2020  = dict().       
-00019860: 2020 2020 2020 2020 2066 6f72 2070 6e61           for pna
-00019870: 6d65 2069 6e20 6f75 745b 2770 6f73 7465  me in out['poste
-00019880: 7269 6f72 5f73 616d 706c 6573 275d 2e6b  rior_samples'].k
-00019890: 6579 7328 293a 0a20 2020 2020 2020 2020  eys():.         
-000198a0: 2020 2020 2020 2020 2020 2069 6620 2773             if 's
-000198b0: 6967 6d61 5f77 5f72 7627 203d 3d20 706e  igma_w_rv' == pn
-000198c0: 616d 655b 3a31 305d 3a0a 2020 2020 2020  ame[:10]:.      
+00019720: 2020 206f 7574 203d 2070 6963 6b6c 652e     out = pickle.
+00019730: 6c6f 6164 280a 2020 2020 2020 2020 2020  load(.          
+00019740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019750: 2020 2020 2020 6f70 656e 280a 2020 2020        open(.    
+00019760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019780: 7365 6c66 2e6f 7574 5f66 6f6c 6465 7220  self.out_folder 
+00019790: 2b0a 2020 2020 2020 2020 2020 2020 2020  +.              
+000197a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000197b0: 2020 2020 2020 275f 6479 6e65 7374 795f        '_dynesty_
+000197c0: 4e53 5f70 6f73 7465 7269 6f72 732e 706b  NS_posteriors.pk
+000197d0: 6c27 2c20 2772 6227 2929 0a20 2020 2020  l', 'rb')).     
+000197e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000197f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00019800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019810: 2020 2020 206f 7574 203d 2070 6963 6b6c       out = pickl
+00019820: 652e 6c6f 6164 280a 2020 2020 2020 2020  e.load(.        
+00019830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019840: 2020 2020 2020 2020 6f70 656e 280a 2020          open(.  
+00019850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019870: 2020 7365 6c66 2e6f 7574 5f66 6f6c 6465    self.out_folde
+00019880: 7220 2b0a 2020 2020 2020 2020 2020 2020  r +.            
+00019890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000198a0: 2020 2020 2020 2020 275f 6479 6e65 7374          '_dynest
+000198b0: 795f 4e53 5f70 6f73 7465 7269 6f72 732e  y_NS_posteriors.
+000198c0: 706b 6c27 2c20 2772 6227 292c 0a20 2020  pkl', 'rb'),.   
 000198d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000198e0: 2020 696e 7374 7275 6d65 6e74 203d 2070    instrument = p
-000198f0: 6e61 6d65 2e73 706c 6974 2827 5f27 295b  name.split('_')[
-00019900: 2d31 5d0a 2020 2020 2020 2020 2020 2020  -1].            
-00019910: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
-00019920: 7465 6d70 5b27 7369 676d 615f 775f 2720  temp['sigma_w_' 
-00019930: 2b0a 2020 2020 2020 2020 2020 2020 2020  +.              
-00019940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019950: 2020 2073 656c 662e 7369 676d 6177 5f69     self.sigmaw_i
-00019960: 6e61 6d65 5b69 6e73 7472 756d 656e 745d  name[instrument]
-00019970: 5d20 3d20 6f75 745b 2770 6f73 7465 7269  ] = out['posteri
-00019980: 6f72 5f73 616d 706c 6573 275d 5b70 6e61  or_samples'][pna
-00019990: 6d65 5d0a 2020 2020 2020 2020 2020 2020  me].            
-000199a0: 2020 2020 666f 7220 706e 616d 6520 696e      for pname in
-000199b0: 206f 7574 5f74 656d 702e 6b65 7973 2829   out_temp.keys()
-000199c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000199d0: 2020 2020 2020 6f75 745b 2770 6f73 7465        out['poste
-000199e0: 7269 6f72 5f73 616d 706c 6573 275d 5b70  rior_samples'][p
-000199f0: 6e61 6d65 5d20 3d20 6f75 745f 7465 6d70  name] = out_temp
-00019a00: 5b70 6e61 6d65 5d0a 2020 2020 2020 2020  [pname].        
-00019a10: 2020 2020 2020 2020 2320 4578 7472 6163          # Extrac
-00019a20: 7420 7061 7261 6d65 7465 7273 3a0a 2020  t parameters:.  
-00019a30: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00019a40: 7220 706e 616d 6520 696e 2073 656c 662e  r pname in self.
-00019a50: 706f 7374 6572 696f 7273 2e6b 6579 7328  posteriors.keys(
-00019a60: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00019a70: 2020 2020 2020 2069 6620 6461 7461 2e70         if data.p
-00019a80: 7269 6f72 735b 706e 616d 655d 5b27 6469  riors[pname]['di
-00019a90: 7374 7269 6275 7469 6f6e 275d 2021 3d20  stribution'] != 
-00019aa0: 2766 6978 6564 273a 0a20 2020 2020 2020  'fixed':.       
-00019ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019ac0: 2073 656c 662e 706f 7374 6572 696f 7273   self.posteriors
-00019ad0: 5b70 6e61 6d65 5d20 3d20 6e70 2e6d 6564  [pname] = np.med
-00019ae0: 6961 6e28 0a20 2020 2020 2020 2020 2020  ian(.           
-00019af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019b00: 206f 7574 5b27 706f 7374 6572 696f 725f   out['posterior_
-00019b10: 7361 6d70 6c65 7327 5d5b 706e 616d 655d  samples'][pname]
-00019b20: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00019b30: 2020 706f 7374 6572 696f 725f 7361 6d70    posterior_samp
-00019b40: 6c65 7320 3d20 6f75 745b 2770 6f73 7465  les = out['poste
-00019b50: 7269 6f72 5f73 616d 706c 6573 275d 5b27  rior_samples']['
-00019b60: 756e 6e61 6d65 6427 5d0a 2020 2020 2020  unnamed'].      
-00019b70: 2020 2020 2020 2020 2020 6966 2027 7075            if 'pu
-00019b80: 2720 696e 206f 7574 2e6b 6579 7328 293a  ' in out.keys():
-00019b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019ba0: 2020 2020 2073 656c 662e 7075 203d 206f       self.pu = o
-00019bb0: 7574 5b27 7075 275d 0a20 2020 2020 2020  ut['pu'].       
-00019bc0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00019bd0: 662e 706c 203d 206f 7574 5b27 706c 275d  f.pl = out['pl']
-00019be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019bf0: 2020 2020 2073 656c 662e 4172 203d 2028       self.Ar = (
-00019c00: 7365 6c66 2e70 7520 2d20 7365 6c66 2e70  self.pu - self.p
-00019c10: 6c29 202f 2028 322e 202b 2073 656c 662e  l) / (2. + self.
-00019c20: 706c 202b 2073 656c 662e 7075 290a 2020  pl + self.pu).  
-00019c30: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00019c40: 2027 7461 2720 696e 206f 7574 2e6b 6579   'ta' in out.key
-00019c50: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-00019c60: 2020 2020 2020 2020 2073 656c 662e 7461           self.ta
-00019c70: 203d 206f 7574 5b27 7461 275d 0a0a 2020   = out['ta']..  
-00019c80: 2020 2020 2020 2320 4569 7468 6572 2066        # Either f
-00019c90: 6974 2064 6f6e 6520 6f72 2065 7874 7261  it done or extra
-00019ca0: 6374 6564 2e20 4966 2064 6f65 736e 2774  cted. If doesn't
-00019cb0: 2065 7869 7374 2c20 6372 6561 7465 2074   exist, create t
-00019cc0: 6865 2070 6f73 7465 7269 6f72 732e 6461  he posteriors.da
-00019cd0: 7420 6669 6c65 3a0a 2020 2020 2020 2020  t file:.        
-00019ce0: 6966 2073 656c 662e 6f75 745f 666f 6c64  if self.out_fold
-00019cf0: 6572 2069 7320 6e6f 7420 4e6f 6e65 3a0a  er is not None:.
-00019d00: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00019d10: 6f74 206f 732e 7061 7468 2e65 7869 7374  ot os.path.exist
-00019d20: 7328 7365 6c66 2e6f 7574 5f66 6f6c 6465  s(self.out_folde
-00019d30: 7220 2b20 2770 6f73 7465 7269 6f72 732e  r + 'posteriors.
-00019d40: 6461 7427 293a 0a20 2020 2020 2020 2020  dat'):.         
-00019d50: 2020 2020 2020 206f 7574 7070 203d 206f         outpp = o
-00019d60: 7065 6e28 7365 6c66 2e6f 7574 5f66 6f6c  pen(self.out_fol
-00019d70: 6465 7220 2b20 2770 6f73 7465 7269 6f72  der + 'posterior
-00019d80: 732e 6461 7427 2c20 2777 2729 0a20 2020  s.dat', 'w').   
-00019d90: 2020 2020 2020 2020 2020 2020 2077 7269               wri
-00019da0: 7465 7070 286f 7574 7070 2c20 6f75 742c  tepp(outpp, out,
-00019db0: 2064 6174 612e 7072 696f 7273 290a 0a20   data.priors).. 
-00019dc0: 2020 2020 2020 2023 2053 6176 6520 616c         # Save al
-00019dd0: 6c20 7265 7375 6c74 7320 2870 6f73 7465  l results (poste
-00019de0: 7269 6f72 7329 2074 6f20 7468 6520 7365  riors) to the se
-00019df0: 6c66 2e72 6573 756c 7473 206f 626a 6563  lf.results objec
-00019e00: 743a 0a20 2020 2020 2020 2073 656c 662e  t:.        self.
-00019e10: 706f 7374 6572 696f 7273 203d 206f 7574  posteriors = out
-00019e20: 0a0a 2020 2020 2020 2020 2320 5361 7665  ..        # Save
-00019e30: 2070 6f73 7465 7269 6f72 7320 746f 206c   posteriors to l
-00019e40: 6320 616e 6420 7276 3a0a 2020 2020 2020  c and rv:.      
-00019e50: 2020 6966 2073 656c 662e 6461 7461 2e74    if self.data.t
-00019e60: 5f6c 6320 6973 206e 6f74 204e 6f6e 653a  _lc is not None:
-00019e70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00019e80: 662e 6c63 2e73 6574 5f70 6f73 7465 7269  f.lc.set_posteri
-00019e90: 6f72 5f73 616d 706c 6573 286f 7574 5b27  or_samples(out['
-00019ea0: 706f 7374 6572 696f 725f 7361 6d70 6c65  posterior_sample
-00019eb0: 7327 5d29 0a20 2020 2020 2020 2069 6620  s']).        if 
-00019ec0: 7365 6c66 2e64 6174 612e 745f 7276 2069  self.data.t_rv i
-00019ed0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00019ee0: 2020 2020 2020 2020 7365 6c66 2e72 762e          self.rv.
-00019ef0: 7365 745f 706f 7374 6572 696f 725f 7361  set_posterior_sa
-00019f00: 6d70 6c65 7328 6f75 745b 2770 6f73 7465  mples(out['poste
-00019f10: 7269 6f72 5f73 616d 706c 6573 275d 290a  rior_samples']).
-00019f20: 0a0a 636c 6173 7320 6d6f 6465 6c28 6f62  ..class model(ob
-00019f30: 6a65 6374 293a 0a20 2020 2022 2222 0a20  ject):.    """. 
-00019f40: 2020 2047 6976 656e 2061 206a 756c 6965     Given a julie
-00019f50: 7420 6461 7461 206f 626a 6563 742c 2074  t data object, t
-00019f60: 6869 7320 6b65 726e 656c 2067 656e 6572  his kernel gener
-00019f70: 6174 6573 2065 6974 6865 7220 6120 6c69  ates either a li
-00019f80: 6768 7463 7572 7665 206f 7220 6120 7261  ghtcurve or a ra
-00019f90: 6469 616c 2d76 656c 6f63 6974 7920 6f62  dial-velocity ob
-00019fa0: 6a65 6374 2e20 4578 616d 706c 6520 7573  ject. Example us
-00019fb0: 6167 653a 0a0a 2020 2020 2020 2020 2020  age:..          
-00019fc0: 2020 2020 203e 3e3e 206d 6f64 656c 203d       >>> model =
-00019fd0: 206a 756c 6965 742e 6d6f 6465 6c28 6461   juliet.model(da
-00019fe0: 7461 2c20 6d6f 6465 6c74 7970 6520 3d20  ta, modeltype = 
-00019ff0: 276c 6327 290a 0a20 2020 203a 7061 7261  'lc')..    :para
-0001a000: 6d20 6461 7461 3a20 286a 756c 6965 742e  m data: (juliet.
-0001a010: 6c6f 6164 206f 626a 6563 7429 0a20 2020  load object).   
-0001a020: 2020 2020 2041 6e20 6f62 6a65 6374 2063       An object c
-0001a030: 6f6e 7461 696e 696e 6720 616c 6c20 7468  ontaining all th
-0001a040: 6520 696e 666f 726d 6174 696f 6e20 6162  e information ab
-0001a050: 6f75 7420 7468 6520 6375 7272 656e 7420  out the current 
-0001a060: 6461 7461 7365 742e 0a0a 2020 2020 3a70  dataset...    :p
-0001a070: 6172 616d 206d 6f64 656c 7479 7065 3a20  aram modeltype: 
-0001a080: 286f 7074 696f 6e61 6c2c 2073 7472 696e  (optional, strin
-0001a090: 6729 0a20 2020 2020 2020 2053 7472 696e  g).        Strin
-0001a0a0: 6720 696e 6469 6361 7469 6e67 2077 6865  g indicating whe
-0001a0b0: 7468 6572 2074 6865 206d 6f64 656c 2074  ther the model t
-0001a0c0: 6f20 6765 6e65 7261 7465 2073 686f 756c  o generate shoul
-0001a0d0: 6420 6265 2061 206c 6967 6874 6375 7276  d be a lightcurv
-0001a0e0: 6520 2827 6c63 2729 206f 7220 6120 7261  e ('lc') or a ra
-0001a0f0: 6469 616c 2d76 656c 6f63 6974 7920 2827  dial-velocity ('
-0001a100: 7276 2729 206d 6f64 656c 2e0a 0a20 2020  rv') model...   
-0001a110: 203a 7061 7261 6d20 706c 3a20 286f 7074   :param pl: (opt
-0001a120: 696f 6e61 6c2c 2066 6c6f 6174 290a 2020  ional, float).  
-0001a130: 2020 2020 2020 4966 2074 6865 2060 6028        If the ``(
-0001a140: 7231 2c72 3229 6060 2070 6172 616d 6574  r1,r2)`` paramet
-0001a150: 7269 7a61 7469 6f6e 2066 6f72 2060 6028  rization for ``(
-0001a160: 622c 7029 6060 2069 7320 7573 6564 2c20  b,p)`` is used, 
-0001a170: 7468 6973 2064 6566 696e 6573 2074 6865  this defines the
-0001a180: 206c 6f77 6572 206c 696d 6974 206f 6620   lower limit of 
-0001a190: 7468 6520 706c 616e 6574 2d74 6f2d 7374  the planet-to-st
-0001a1a0: 6172 2072 6164 6975 7320 7261 7469 6f20  ar radius ratio 
-0001a1b0: 746f 2062 6520 7361 6d70 6c65 642e 0a20  to be sampled.. 
-0001a1c0: 2020 2020 2020 2044 6566 6175 6c74 2069         Default i
-0001a1d0: 7320 6060 3060 602e 0a0a 2020 2020 3a70  s ``0``...    :p
-0001a1e0: 6172 616d 2070 753a 2028 6f70 7469 6f6e  aram pu: (option
-0001a1f0: 616c 2c20 666c 6f61 7429 0a20 2020 2020  al, float).     
-0001a200: 2020 2053 616d 6520 6173 2060 6070 6c60     Same as ``pl`
-0001a210: 602c 2062 7574 2066 6f72 2074 6865 2075  `, but for the u
-0001a220: 7070 6572 206c 696d 6974 2e20 4465 6661  pper limit. Defa
-0001a230: 756c 7420 6973 2060 6031 6060 2e0a 0a20  ult is ``1``... 
-0001a240: 2020 203a 7061 7261 6d20 6563 636c 696d     :param ecclim
-0001a250: 3a20 286f 7074 696f 6e61 6c2c 2066 6c6f  : (optional, flo
-0001a260: 6174 290a 2020 2020 2020 2020 5468 6973  at).        This
-0001a270: 2070 6172 616d 6574 6572 2073 6574 7320   parameter sets 
-0001a280: 7468 6520 6d61 7869 6d75 6d20 6563 6365  the maximum ecce
-0001a290: 6e74 7269 6369 7479 2061 6c6c 6f77 6564  ntricity allowed
-0001a2a0: 2073 7563 6820 7468 6174 2061 206d 6f64   such that a mod
-0001a2b0: 656c 2069 7320 6163 7475 616c 6c79 2065  el is actually e
-0001a2c0: 7661 6c75 6174 6564 2e20 4465 6661 756c  valuated. Defaul
-0001a2d0: 7420 6973 2060 6031 6060 2e0a 0a20 2020  t is ``1``...   
-0001a2e0: 203a 7061 7261 6d20 6c69 6768 745f 7472   :param light_tr
-0001a2f0: 6176 656c 5f64 656c 6179 3a20 286f 7074  avel_delay: (opt
-0001a300: 696e 616c 2c20 626f 6f6c 290a 2020 2020  inal, bool).    
-0001a310: 2020 2020 426f 6f6c 6561 6e20 696e 6469      Boolean indi
-0001a320: 6361 7469 6e67 2069 6620 6c69 6768 7420  cating if light 
-0001a330: 7472 6176 656c 2074 696d 6520 6465 6c61  travel time dela
-0001a340: 7920 7761 6e74 7320 746f 2062 6520 696e  y wants to be in
-0001a350: 636c 7564 6564 206f 6e20 6563 6c69 7073  cluded on eclips
-0001a360: 6520 7469 6d65 2063 616c 6375 6c61 7469  e time calculati
-0001a370: 6f6e 732e 0a0a 2020 2020 3a70 6172 616d  ons...    :param
-0001a380: 2073 7465 6c6c 6172 5f72 6164 6975 733a   stellar_radius:
-0001a390: 2028 6f70 7469 6f6e 616c 2c20 666c 6f61   (optional, floa
-0001a3a0: 7429 0a20 2020 2020 2020 2053 7465 6c6c  t).        Stell
-0001a3b0: 6172 2072 6164 6975 7320 696e 2075 6e69  ar radius in uni
-0001a3c0: 7473 206f 6620 736f 6c61 722d 7261 6469  ts of solar-radi
-0001a3d0: 6920 746f 2075 7365 2066 6f72 2074 6865  i to use for the
-0001a3e0: 206c 6967 6874 2074 7261 7665 6c20 7469   light travel ti
-0001a3f0: 6d65 2063 6f72 7265 6374 696f 6e73 2e0a  me corrections..
-0001a400: 0a20 2020 203a 7061 7261 6d20 6c6f 675f  .    :param log_
-0001a410: 6c69 6b65 5f63 616c 633a 2028 6f70 7469  like_calc: (opti
-0001a420: 6f6e 616c 2c20 626f 6f6c 6561 6e29 0a20  onal, boolean). 
-0001a430: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
-0001a440: 6974 2069 7320 6173 7375 6d65 6420 7468  it is assumed th
-0001a450: 6520 6d6f 6465 6c20 6973 2067 656e 6572  e model is gener
-0001a460: 6174 6564 2074 6f20 6765 6e65 7261 7465  ated to generate
-0001a470: 206c 696b 656c 6968 6f6f 6473 2076 616c   likelihoods val
-0001a480: 7565 732c 2061 6e64 2074 6875 7320 7468  ues, and thus th
-0001a490: 6973 2073 6b69 7073 2074 6865 2073 6176  is skips the sav
-0001a4a0: 696e 672f 6361 6c63 756c 6174 696f 6e20  ing/calculation 
-0001a4b0: 6f66 2074 6865 2069 6e64 6976 6964 7561  of the individua
-0001a4c0: 6c0a 2020 2020 2020 2020 6d6f 6465 6c73  l.        models
-0001a4d0: 2070 6572 2070 6c61 6e65 7420 2869 2e65   per planet (i.e
-0001a4e0: 2e2c 2060 6073 656c 662e 6d6f 6465 6c5b  ., ``self.model[
-0001a4f0: 2770 3127 5d60 602c 2060 6073 656c 662e  'p1']``, ``self.
-0001a500: 6d6f 6465 6c5b 2770 3227 5d60 602c 2065  model['p2']``, e
-0001a510: 7463 2e20 7769 6c6c 206e 6f74 2065 7869  tc. will not exi
-0001a520: 7374 292e 2044 6566 6175 6c74 2069 7320  st). Default is 
-0001a530: 4661 6c73 652e 0a0a 2020 2020 2222 220a  False...    """.
-0001a540: 0a20 2020 2064 6566 2067 656e 6572 6174  .    def generat
-0001a550: 655f 7276 5f6d 6f64 656c 2873 656c 662c  e_rv_model(self,
-0001a560: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
-0001a570: 732c 2065 7661 6c75 6174 655f 676c 6f62  s, evaluate_glob
-0001a580: 616c 5f65 7272 6f72 733d 5472 7565 293a  al_errors=True):
-0001a590: 0a20 2020 2020 2020 2073 656c 662e 6d6f  .        self.mo
-0001a5a0: 6465 6c4f 4b20 3d20 5472 7565 0a20 2020  delOK = True.   
-0001a5b0: 2020 2020 2023 2042 6566 6f72 6520 616e       # Before an
-0001a5c0: 7974 6869 6e67 2063 6f6e 7469 6e75 6573  ything continues
-0001a5d0: 2c20 6368 6563 6b20 7468 6520 7065 7269  , check the peri
-0001a5e0: 6f64 7320 6172 6520 6368 726f 6e6f 6c6f  ods are chronolo
-0001a5f0: 6769 6361 6c6c 7920 6f72 6465 7265 6420  gically ordered 
-0001a600: 2874 6869 7320 6973 2074 6f20 6176 6f69  (this is to avoi
-0001a610: 6420 6d75 6c74 6970 6c65 206d 6f64 6573  d multiple modes
-0001a620: 2064 7565 2074 6f0a 2020 2020 2020 2020   due to.        
-0001a630: 2320 7065 7269 6f64 7320 226a 756d 7069  # periods "jumpi
-0001a640: 6e67 2220 6265 7477 6565 6e20 706c 616e  ng" between plan
-0001a650: 6574 206e 756d 6265 7269 6e67 293a 0a20  et numbering):. 
-0001a660: 2020 2020 2020 2066 6972 7374 5f74 696d         first_tim
-0001a670: 6520 3d20 5472 7565 0a20 2020 2020 2020  e = True.       
-0001a680: 2066 6f72 2069 2069 6e20 7365 6c66 2e6e   for i in self.n
-0001a690: 756d 6265 7269 6e67 3a0a 2020 2020 2020  umbering:.      
-0001a6a0: 2020 2020 2020 6966 2066 6972 7374 5f74        if first_t
-0001a6b0: 696d 653a 0a20 2020 2020 2020 2020 2020  ime:.           
-0001a6c0: 2020 2020 2063 5020 3d20 7061 7261 6d65       cP = parame
-0001a6d0: 7465 725f 7661 6c75 6573 5b27 505f 7027  ter_values['P_p'
-0001a6e0: 202b 2073 7472 2869 295d 0a20 2020 2020   + str(i)].     
-0001a6f0: 2020 2020 2020 2020 2020 2066 6972 7374             first
-0001a700: 5f74 696d 6520 3d20 4661 6c73 650a 2020  _time = False.  
-0001a710: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0001a720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a730: 6966 2063 5020 3c20 7061 7261 6d65 7465  if cP < paramete
-0001a740: 725f 7661 6c75 6573 5b27 505f 7027 202b  r_values['P_p' +
-0001a750: 2073 7472 2869 295d 3a0a 2020 2020 2020   str(i)]:.      
-0001a760: 2020 2020 2020 2020 2020 2020 2020 6350                cP
-0001a770: 203d 2070 6172 616d 6574 6572 5f76 616c   = parameter_val
-0001a780: 7565 735b 2750 5f70 2720 2b20 7374 7228  ues['P_p' + str(
-0001a790: 6929 5d0a 2020 2020 2020 2020 2020 2020  i)].            
-0001a7a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001a7b0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001a7c0: 6c66 2e6d 6f64 656c 4f4b 203d 2046 616c  lf.modelOK = Fal
-0001a7d0: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
-0001a7e0: 2020 2020 2020 2072 6574 7572 6e20 4661         return Fa
-0001a7f0: 6c73 650a 0a20 2020 2020 2020 2023 2046  lse..        # F
-0001a800: 6972 7374 2c20 6578 7472 6163 7420 6f72  irst, extract or
-0001a810: 6269 7461 6c20 7061 7261 6d65 7465 7273  bital parameters
-0001a820: 2061 6e64 2073 6176 6520 7468 656d 2c20   and save them, 
-0001a830: 7768 6963 6820 7769 6c6c 2062 6520 636f  which will be co
-0001a840: 6d6d 6f6e 2074 6f20 616c 6c20 696e 7374  mmon to all inst
-0001a850: 7275 6d65 6e74 733a 0a20 2020 2020 2020  ruments:.       
-0001a860: 2066 6f72 206e 2069 6e20 7261 6e67 6528   for n in range(
-0001a870: 7365 6c66 2e6e 706c 616e 6574 7329 3a0a  self.nplanets):.
-0001a880: 2020 2020 2020 2020 2020 2020 6920 3d20              i = 
-0001a890: 7365 6c66 2e6e 756d 6265 7269 6e67 5b6e  self.numbering[n
-0001a8a0: 5d0a 0a20 2020 2020 2020 2020 2020 2023  ]..            #
-0001a8b0: 2053 656d 692d 616d 706c 6974 7564 6573   Semi-amplitudes
-0001a8c0: 2c20 7430 2061 6e64 2050 3a0a 2020 2020  , t0 and P:.    
-0001a8d0: 2020 2020 2020 2020 4b2c 2074 302c 2050          K, t0, P
-0001a8e0: 203d 2070 6172 616d 6574 6572 5f76 616c   = parameter_val
-0001a8f0: 7565 735b 274b 5f70 2720 2b20 7374 7228  ues['K_p' + str(
-0001a900: 6929 5d2c 2070 6172 616d 6574 6572 5f76  i)], parameter_v
-0001a910: 616c 7565 735b 0a20 2020 2020 2020 2020  alues[.         
-0001a920: 2020 2020 2020 2027 7430 5f70 2720 2b20         't0_p' + 
-0001a930: 7374 7228 6929 5d2c 2070 6172 616d 6574  str(i)], paramet
-0001a940: 6572 5f76 616c 7565 735b 2750 5f70 2720  er_values['P_p' 
-0001a950: 2b20 7374 7228 6929 5d0a 0a20 2020 2020  + str(i)]..     
-0001a960: 2020 2020 2020 2023 2045 7874 7261 6374         # Extract
-0001a970: 2065 6363 656e 7472 6963 6974 7920 616e   eccentricity an
-0001a980: 6420 6f6d 6567 6120 6465 7065 6e64 696e  d omega dependin
-0001a990: 6720 6f6e 2074 6865 2075 7365 6420 7061  g on the used pa
-0001a9a0: 7261 6d65 7472 697a 6174 696f 6e20 666f  rametrization fo
-0001a9b0: 7220 6561 6368 2070 6c61 6e65 743a 0a20  r each planet:. 
-0001a9c0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0001a9d0: 6c66 2e64 6963 7469 6f6e 6172 795b 2765  lf.dictionary['e
-0001a9e0: 6363 5f70 6172 616d 6574 7269 7a61 7469  cc_parametrizati
-0001a9f0: 6f6e 275d 5b69 5d20 3d3d 2030 3a0a 2020  on'][i] == 0:.  
-0001aa00: 2020 2020 2020 2020 2020 2020 2020 6563                ec
-0001aa10: 632c 206f 6d65 6761 203d 2070 6172 616d  c, omega = param
-0001aa20: 6574 6572 5f76 616c 7565 735b 0a20 2020  eter_values[.   
-0001aa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aa40: 2027 6563 635f 7027 202b 0a20 2020 2020   'ecc_p' +.     
-0001aa50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001aa60: 7472 2869 295d 2c20 7061 7261 6d65 7465  tr(i)], paramete
-0001aa70: 725f 7661 6c75 6573 5b27 6f6d 6567 615f  r_values['omega_
-0001aa80: 7027 202b 2073 7472 2869 295d 202a 206e  p' + str(i)] * n
-0001aa90: 702e 7069 202f 2031 3830 2e0a 2020 2020  p.pi / 180..    
-0001aaa0: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-0001aab0: 662e 6469 6374 696f 6e61 7279 5b27 6563  f.dictionary['ec
-0001aac0: 635f 7061 7261 6d65 7472 697a 6174 696f  c_parametrizatio
-0001aad0: 6e27 5d5b 695d 203d 3d20 313a 0a20 2020  n'][i] == 1:.   
-0001aae0: 2020 2020 2020 2020 2020 2020 2065 6363               ecc
-0001aaf0: 203d 206e 702e 7371 7274 2870 6172 616d   = np.sqrt(param
-0001ab00: 6574 6572 5f76 616c 7565 735b 2765 636f  eter_values['eco
-0001ab10: 736f 6d65 6761 5f70 2720 2b20 7374 7228  somega_p' + str(
-0001ab20: 6929 5d2a 2a32 202b 0a20 2020 2020 2020  i)]**2 +.       
-0001ab30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ab40: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
-0001ab50: 5f76 616c 7565 735b 2765 7369 6e6f 6d65  _values['esinome
-0001ab60: 6761 5f70 2720 2b20 7374 7228 6929 5d2a  ga_p' + str(i)]*
-0001ab70: 2a32 290a 2020 2020 2020 2020 2020 2020  *2).            
-0001ab80: 2020 2020 6f6d 6567 6120 3d20 6e70 2e61      omega = np.a
-0001ab90: 7263 7461 6e32 2870 6172 616d 6574 6572  rctan2(parameter
-0001aba0: 5f76 616c 7565 735b 2765 7369 6e6f 6d65  _values['esinome
-0001abb0: 6761 5f70 2720 2b20 7374 7228 6929 5d2c  ga_p' + str(i)],
-0001abc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000198e0: 2020 2020 2020 2020 2020 2020 2065 6e63               enc
+000198f0: 6f64 696e 673d 7365 6c66 2e64 6174 612e  oding=self.data.
+00019900: 7069 636b 6c65 5f65 6e63 6f64 696e 6729  pickle_encoding)
+00019910: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00019920: 6620 7365 6c66 2e6f 7574 5f66 6f6c 6465  f self.out_folde
+00019930: 7220 6973 206e 6f74 204e 6f6e 653a 0a20  r is not None:. 
+00019940: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00019950: 6620 7365 6c66 2e64 6174 612e 7665 7262  f self.data.verb
+00019960: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
+00019970: 2020 2020 2020 2020 2070 7269 6e74 280a           print(.
+00019980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019990: 2020 2020 2020 2020 2744 6574 6563 7465          'Detecte
+000199a0: 6420 284d 756c 7469 4e65 7374 2920 4e53  d (MultiNest) NS
+000199b0: 206f 7574 7075 7420 6669 6c65 7320 2d2d   output files --
+000199c0: 2d20 6578 7472 6163 7469 6e67 2e2e 2e27  - extracting...'
+000199d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000199e0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+000199f0: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
+00019a00: 6174 612e 7069 636b 6c65 5f65 6e63 6f64  ata.pickle_encod
+00019a10: 696e 6720 6973 204e 6f6e 653a 0a20 2020  ing is None:.   
+00019a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019a30: 206f 7574 203d 2070 6963 6b6c 652e 6c6f   out = pickle.lo
+00019a40: 6164 286f 7065 6e28 7365 6c66 2e6f 7574  ad(open(self.out
+00019a50: 5f66 6f6c 6465 722b 2770 6f73 7465 7269  _folder+'posteri
+00019a60: 6f72 732e 706b 6c27 2c27 7262 2729 290a  ors.pkl','rb')).
+00019a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019a80: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00019a90: 2020 2020 2020 2020 2020 6f75 7420 3d20            out = 
+00019aa0: 7069 636b 6c65 2e6c 6f61 6428 6f70 656e  pickle.load(open
+00019ab0: 2873 656c 662e 6f75 745f 666f 6c64 6572  (self.out_folder
+00019ac0: 2b27 706f 7374 6572 696f 7273 2e70 6b6c  +'posteriors.pkl
+00019ad0: 272c 2772 6227 292c 2065 6e63 6f64 696e  ','rb'), encodin
+00019ae0: 6720 3d20 7365 6c66 2e64 6174 612e 7069  g = self.data.pi
+00019af0: 636b 6c65 5f65 6e63 6f64 696e 6729 0a20  ckle_encoding). 
+00019b00: 2020 2020 2020 2020 2020 2022 2222 0a20             """. 
+00019b10: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00019b20: 6e28 6f75 742e 6b65 7973 2829 2920 3d3d  n(out.keys()) ==
+00019b30: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00019b40: 2020 2020 7072 696e 7428 0a20 2020 2020      print(.     
+00019b50: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00019b60: 5761 726e 696e 673a 206e 6f20 6f75 7470  Warning: no outp
+00019b70: 7574 2067 656e 6572 6174 6564 206f 7220  ut generated or 
+00019b80: 6578 7472 6163 7465 642e 2043 6865 636b  extracted. Check
+00019b90: 2074 6865 2066 6974 206f 7074 696f 6e73   the fit options
+00019ba0: 2067 6976 656e 2074 6f20 6a75 6c69 6574   given to juliet
+00019bb0: 2e66 6974 2829 2e27 0a20 2020 2020 2020  .fit().'.       
+00019bc0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00019bd0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00019be0: 2020 2020 2020 2020 2020 2020 2023 2046               # F
+00019bf0: 6f72 2072 6574 726f 2d63 6f6d 7061 7469  or retro-compati
+00019c00: 6269 6c69 7479 2c20 6368 6563 6b20 666f  bility, check fo
+00019c10: 7220 7369 676d 615f 775f 7276 5f69 6e73  r sigma_w_rv_ins
+00019c20: 7472 756d 656e 7420 616e 6420 6164 6420  trument and add 
+00019c30: 616e 2065 7874 7261 2076 6172 6961 626c  an extra variabl
+00019c40: 6520 6f6e 206f 7574 0a20 2020 2020 2020  e on out.       
+00019c50: 2020 2020 2020 2020 2023 2066 6f72 2073           # for s
+00019c60: 6967 6d61 5f77 5f69 6e73 7472 756d 656e  igma_w_instrumen
+00019c70: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+00019c80: 2020 206f 7574 5f74 656d 7020 3d20 6469     out_temp = di
+00019c90: 6374 2829 0a20 2020 2020 2020 2020 2020  ct().           
+00019ca0: 2020 2020 2066 6f72 2070 6e61 6d65 2069       for pname i
+00019cb0: 6e20 6f75 745b 2770 6f73 7465 7269 6f72  n out['posterior
+00019cc0: 5f73 616d 706c 6573 275d 2e6b 6579 7328  _samples'].keys(
+00019cd0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00019ce0: 2020 2020 2020 2069 6620 2773 6967 6d61         if 'sigma
+00019cf0: 5f77 5f72 7627 203d 3d20 706e 616d 655b  _w_rv' == pname[
+00019d00: 3a31 305d 3a0a 2020 2020 2020 2020 2020  :10]:.          
+00019d10: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00019d20: 7374 7275 6d65 6e74 203d 2070 6e61 6d65  strument = pname
+00019d30: 2e73 706c 6974 2827 5f27 295b 2d31 5d0a  .split('_')[-1].
+00019d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019d50: 2020 2020 2020 2020 6f75 745f 7465 6d70          out_temp
+00019d60: 5b27 7369 676d 615f 775f 2720 2b0a 2020  ['sigma_w_' +.  
+00019d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019d80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00019d90: 656c 662e 7369 676d 6177 5f69 6e61 6d65  elf.sigmaw_iname
+00019da0: 5b69 6e73 7472 756d 656e 745d 5d20 3d20  [instrument]] = 
+00019db0: 6f75 745b 2770 6f73 7465 7269 6f72 5f73  out['posterior_s
+00019dc0: 616d 706c 6573 275d 5b70 6e61 6d65 5d0a  amples'][pname].
+00019dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019de0: 666f 7220 706e 616d 6520 696e 206f 7574  for pname in out
+00019df0: 5f74 656d 702e 6b65 7973 2829 3a0a 2020  _temp.keys():.  
+00019e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019e10: 2020 6f75 745b 2770 6f73 7465 7269 6f72    out['posterior
+00019e20: 5f73 616d 706c 6573 275d 5b70 6e61 6d65  _samples'][pname
+00019e30: 5d20 3d20 6f75 745f 7465 6d70 5b70 6e61  ] = out_temp[pna
+00019e40: 6d65 5d0a 2020 2020 2020 2020 2020 2020  me].            
+00019e50: 2020 2020 2320 4578 7472 6163 7420 7061      # Extract pa
+00019e60: 7261 6d65 7465 7273 3a0a 2020 2020 2020  rameters:.      
+00019e70: 2020 2020 2020 2020 2020 666f 7220 706e            for pn
+00019e80: 616d 6520 696e 2073 656c 662e 706f 7374  ame in self.post
+00019e90: 6572 696f 7273 2e6b 6579 7328 293a 0a20  eriors.keys():. 
+00019ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019eb0: 2020 2069 6620 6461 7461 2e70 7269 6f72     if data.prior
+00019ec0: 735b 706e 616d 655d 5b27 6469 7374 7269  s[pname]['distri
+00019ed0: 6275 7469 6f6e 275d 2021 3d20 2766 6978  bution'] != 'fix
+00019ee0: 6564 273a 0a20 2020 2020 2020 2020 2020  ed':.           
+00019ef0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00019f00: 662e 706f 7374 6572 696f 7273 5b70 6e61  f.posteriors[pna
+00019f10: 6d65 5d20 3d20 6e70 2e6d 6564 6961 6e28  me] = np.median(
+00019f20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019f30: 2020 2020 2020 2020 2020 2020 206f 7574               out
+00019f40: 5b27 706f 7374 6572 696f 725f 7361 6d70  ['posterior_samp
+00019f50: 6c65 7327 5d5b 706e 616d 655d 290a 2020  les'][pname]).  
+00019f60: 2020 2020 2020 2020 2020 2020 2020 706f                po
+00019f70: 7374 6572 696f 725f 7361 6d70 6c65 7320  sterior_samples 
+00019f80: 3d20 6f75 745b 2770 6f73 7465 7269 6f72  = out['posterior
+00019f90: 5f73 616d 706c 6573 275d 5b27 756e 6e61  _samples']['unna
+00019fa0: 6d65 6427 5d0a 2020 2020 2020 2020 2020  med'].          
+00019fb0: 2020 2020 2020 6966 2027 7075 2720 696e        if 'pu' in
+00019fc0: 206f 7574 2e6b 6579 7328 293a 0a20 2020   out.keys():.   
+00019fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019fe0: 2073 656c 662e 7075 203d 206f 7574 5b27   self.pu = out['
+00019ff0: 7075 275d 0a20 2020 2020 2020 2020 2020  pu'].           
+0001a000: 2020 2020 2020 2020 2073 656c 662e 706c           self.pl
+0001a010: 203d 206f 7574 5b27 706c 275d 0a20 2020   = out['pl'].   
+0001a020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a030: 2073 656c 662e 4172 203d 2028 7365 6c66   self.Ar = (self
+0001a040: 2e70 7520 2d20 7365 6c66 2e70 6c29 202f  .pu - self.pl) /
+0001a050: 2028 322e 202b 2073 656c 662e 706c 202b   (2. + self.pl +
+0001a060: 2073 656c 662e 7075 290a 2020 2020 2020   self.pu).      
+0001a070: 2020 2020 2020 2020 2020 6966 2027 7461            if 'ta
+0001a080: 2720 696e 206f 7574 2e6b 6579 7328 293a  ' in out.keys():
+0001a090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a0a0: 2020 2020 2073 656c 662e 7461 203d 206f       self.ta = o
+0001a0b0: 7574 5b27 7461 275d 0a0a 2020 2020 2020  ut['ta']..      
+0001a0c0: 2020 2320 4569 7468 6572 2066 6974 2064    # Either fit d
+0001a0d0: 6f6e 6520 6f72 2065 7874 7261 6374 6564  one or extracted
+0001a0e0: 2e20 4966 2064 6f65 736e 2774 2065 7869  . If doesn't exi
+0001a0f0: 7374 2c20 6372 6561 7465 2074 6865 2070  st, create the p
+0001a100: 6f73 7465 7269 6f72 732e 6461 7420 6669  osteriors.dat fi
+0001a110: 6c65 3a0a 2020 2020 2020 2020 6966 2073  le:.        if s
+0001a120: 656c 662e 6f75 745f 666f 6c64 6572 2069  elf.out_folder i
+0001a130: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0001a140: 2020 2020 2020 2020 6966 206e 6f74 206f          if not o
+0001a150: 732e 7061 7468 2e65 7869 7374 7328 7365  s.path.exists(se
+0001a160: 6c66 2e6f 7574 5f66 6f6c 6465 7220 2b20  lf.out_folder + 
+0001a170: 2770 6f73 7465 7269 6f72 732e 6461 7427  'posteriors.dat'
+0001a180: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0001a190: 2020 206f 7574 7070 203d 206f 7065 6e28     outpp = open(
+0001a1a0: 7365 6c66 2e6f 7574 5f66 6f6c 6465 7220  self.out_folder 
+0001a1b0: 2b20 2770 6f73 7465 7269 6f72 732e 6461  + 'posteriors.da
+0001a1c0: 7427 2c20 2777 2729 0a20 2020 2020 2020  t', 'w').       
+0001a1d0: 2020 2020 2020 2020 2077 7269 7465 7070           writepp
+0001a1e0: 286f 7574 7070 2c20 6f75 742c 2064 6174  (outpp, out, dat
+0001a1f0: 612e 7072 696f 7273 290a 0a20 2020 2020  a.priors)..     
+0001a200: 2020 2023 2053 6176 6520 616c 6c20 7265     # Save all re
+0001a210: 7375 6c74 7320 2870 6f73 7465 7269 6f72  sults (posterior
+0001a220: 7329 2074 6f20 7468 6520 7365 6c66 2e72  s) to the self.r
+0001a230: 6573 756c 7473 206f 626a 6563 743a 0a20  esults object:. 
+0001a240: 2020 2020 2020 2073 656c 662e 706f 7374         self.post
+0001a250: 6572 696f 7273 203d 206f 7574 0a0a 2020  eriors = out..  
+0001a260: 2020 2020 2020 2320 5361 7665 2070 6f73        # Save pos
+0001a270: 7465 7269 6f72 7320 746f 206c 6320 616e  teriors to lc an
+0001a280: 6420 7276 3a0a 2020 2020 2020 2020 6966  d rv:.        if
+0001a290: 2073 656c 662e 6461 7461 2e74 5f6c 6320   self.data.t_lc 
+0001a2a0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0001a2b0: 2020 2020 2020 2020 2073 656c 662e 6c63           self.lc
+0001a2c0: 2e73 6574 5f70 6f73 7465 7269 6f72 5f73  .set_posterior_s
+0001a2d0: 616d 706c 6573 286f 7574 5b27 706f 7374  amples(out['post
+0001a2e0: 6572 696f 725f 7361 6d70 6c65 7327 5d29  erior_samples'])
+0001a2f0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0001a300: 2e64 6174 612e 745f 7276 2069 7320 6e6f  .data.t_rv is no
+0001a310: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0001a320: 2020 2020 7365 6c66 2e72 762e 7365 745f      self.rv.set_
+0001a330: 706f 7374 6572 696f 725f 7361 6d70 6c65  posterior_sample
+0001a340: 7328 6f75 745b 2770 6f73 7465 7269 6f72  s(out['posterior
+0001a350: 5f73 616d 706c 6573 275d 290a 0a0a 636c  _samples'])...cl
+0001a360: 6173 7320 6d6f 6465 6c28 6f62 6a65 6374  ass model(object
+0001a370: 293a 0a20 2020 2022 2222 0a20 2020 2047  ):.    """.    G
+0001a380: 6976 656e 2061 206a 756c 6965 7420 6461  iven a juliet da
+0001a390: 7461 206f 626a 6563 742c 2074 6869 7320  ta object, this 
+0001a3a0: 6b65 726e 656c 2067 656e 6572 6174 6573  kernel generates
+0001a3b0: 2065 6974 6865 7220 6120 6c69 6768 7463   either a lightc
+0001a3c0: 7572 7665 206f 7220 6120 7261 6469 616c  urve or a radial
+0001a3d0: 2d76 656c 6f63 6974 7920 6f62 6a65 6374  -velocity object
+0001a3e0: 2e20 4578 616d 706c 6520 7573 6167 653a  . Example usage:
+0001a3f0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001a400: 203e 3e3e 206d 6f64 656c 203d 206a 756c   >>> model = jul
+0001a410: 6965 742e 6d6f 6465 6c28 6461 7461 2c20  iet.model(data, 
+0001a420: 6d6f 6465 6c74 7970 6520 3d20 276c 6327  modeltype = 'lc'
+0001a430: 290a 0a20 2020 203a 7061 7261 6d20 6461  )..    :param da
+0001a440: 7461 3a20 286a 756c 6965 742e 6c6f 6164  ta: (juliet.load
+0001a450: 206f 626a 6563 7429 0a20 2020 2020 2020   object).       
+0001a460: 2041 6e20 6f62 6a65 6374 2063 6f6e 7461   An object conta
+0001a470: 696e 696e 6720 616c 6c20 7468 6520 696e  ining all the in
+0001a480: 666f 726d 6174 696f 6e20 6162 6f75 7420  formation about 
+0001a490: 7468 6520 6375 7272 656e 7420 6461 7461  the current data
+0001a4a0: 7365 742e 0a0a 2020 2020 3a70 6172 616d  set...    :param
+0001a4b0: 206d 6f64 656c 7479 7065 3a20 286f 7074   modeltype: (opt
+0001a4c0: 696f 6e61 6c2c 2073 7472 696e 6729 0a20  ional, string). 
+0001a4d0: 2020 2020 2020 2053 7472 696e 6720 696e         String in
+0001a4e0: 6469 6361 7469 6e67 2077 6865 7468 6572  dicating whether
+0001a4f0: 2074 6865 206d 6f64 656c 2074 6f20 6765   the model to ge
+0001a500: 6e65 7261 7465 2073 686f 756c 6420 6265  nerate should be
+0001a510: 2061 206c 6967 6874 6375 7276 6520 2827   a lightcurve ('
+0001a520: 6c63 2729 206f 7220 6120 7261 6469 616c  lc') or a radial
+0001a530: 2d76 656c 6f63 6974 7920 2827 7276 2729  -velocity ('rv')
+0001a540: 206d 6f64 656c 2e0a 0a20 2020 203a 7061   model...    :pa
+0001a550: 7261 6d20 706c 3a20 286f 7074 696f 6e61  ram pl: (optiona
+0001a560: 6c2c 2066 6c6f 6174 290a 2020 2020 2020  l, float).      
+0001a570: 2020 4966 2074 6865 2060 6028 7231 2c72    If the ``(r1,r
+0001a580: 3229 6060 2070 6172 616d 6574 7269 7a61  2)`` parametriza
+0001a590: 7469 6f6e 2066 6f72 2060 6028 622c 7029  tion for ``(b,p)
+0001a5a0: 6060 2069 7320 7573 6564 2c20 7468 6973  `` is used, this
+0001a5b0: 2064 6566 696e 6573 2074 6865 206c 6f77   defines the low
+0001a5c0: 6572 206c 696d 6974 206f 6620 7468 6520  er limit of the 
+0001a5d0: 706c 616e 6574 2d74 6f2d 7374 6172 2072  planet-to-star r
+0001a5e0: 6164 6975 7320 7261 7469 6f20 746f 2062  adius ratio to b
+0001a5f0: 6520 7361 6d70 6c65 642e 0a20 2020 2020  e sampled..     
+0001a600: 2020 2044 6566 6175 6c74 2069 7320 6060     Default is ``
+0001a610: 3060 602e 0a0a 2020 2020 3a70 6172 616d  0``...    :param
+0001a620: 2070 753a 2028 6f70 7469 6f6e 616c 2c20   pu: (optional, 
+0001a630: 666c 6f61 7429 0a20 2020 2020 2020 2053  float).        S
+0001a640: 616d 6520 6173 2060 6070 6c60 602c 2062  ame as ``pl``, b
+0001a650: 7574 2066 6f72 2074 6865 2075 7070 6572  ut for the upper
+0001a660: 206c 696d 6974 2e20 4465 6661 756c 7420   limit. Default 
+0001a670: 6973 2060 6031 6060 2e0a 0a20 2020 203a  is ``1``...    :
+0001a680: 7061 7261 6d20 6563 636c 696d 3a20 286f  param ecclim: (o
+0001a690: 7074 696f 6e61 6c2c 2066 6c6f 6174 290a  ptional, float).
+0001a6a0: 2020 2020 2020 2020 5468 6973 2070 6172          This par
+0001a6b0: 616d 6574 6572 2073 6574 7320 7468 6520  ameter sets the 
+0001a6c0: 6d61 7869 6d75 6d20 6563 6365 6e74 7269  maximum eccentri
+0001a6d0: 6369 7479 2061 6c6c 6f77 6564 2073 7563  city allowed suc
+0001a6e0: 6820 7468 6174 2061 206d 6f64 656c 2069  h that a model i
+0001a6f0: 7320 6163 7475 616c 6c79 2065 7661 6c75  s actually evalu
+0001a700: 6174 6564 2e20 4465 6661 756c 7420 6973  ated. Default is
+0001a710: 2060 6031 6060 2e0a 0a20 2020 203a 7061   ``1``...    :pa
+0001a720: 7261 6d20 6c69 6768 745f 7472 6176 656c  ram light_travel
+0001a730: 5f64 656c 6179 3a20 286f 7074 696e 616c  _delay: (optinal
+0001a740: 2c20 626f 6f6c 290a 2020 2020 2020 2020  , bool).        
+0001a750: 426f 6f6c 6561 6e20 696e 6469 6361 7469  Boolean indicati
+0001a760: 6e67 2069 6620 6c69 6768 7420 7472 6176  ng if light trav
+0001a770: 656c 2074 696d 6520 6465 6c61 7920 7761  el time delay wa
+0001a780: 6e74 7320 746f 2062 6520 696e 636c 7564  nts to be includ
+0001a790: 6564 206f 6e20 6563 6c69 7073 6520 7469  ed on eclipse ti
+0001a7a0: 6d65 2063 616c 6375 6c61 7469 6f6e 732e  me calculations.
+0001a7b0: 0a0a 2020 2020 3a70 6172 616d 2073 7465  ..    :param ste
+0001a7c0: 6c6c 6172 5f72 6164 6975 733a 2028 6f70  llar_radius: (op
+0001a7d0: 7469 6f6e 616c 2c20 666c 6f61 7429 0a20  tional, float). 
+0001a7e0: 2020 2020 2020 2053 7465 6c6c 6172 2072         Stellar r
+0001a7f0: 6164 6975 7320 696e 2075 6e69 7473 206f  adius in units o
+0001a800: 6620 736f 6c61 722d 7261 6469 6920 746f  f solar-radii to
+0001a810: 2075 7365 2066 6f72 2074 6865 206c 6967   use for the lig
+0001a820: 6874 2074 7261 7665 6c20 7469 6d65 2063  ht travel time c
+0001a830: 6f72 7265 6374 696f 6e73 2e0a 0a20 2020  orrections...   
+0001a840: 203a 7061 7261 6d20 6c6f 675f 6c69 6b65   :param log_like
+0001a850: 5f63 616c 633a 2028 6f70 7469 6f6e 616c  _calc: (optional
+0001a860: 2c20 626f 6f6c 6561 6e29 0a20 2020 2020  , boolean).     
+0001a870: 2020 2049 6620 5472 7565 2c20 6974 2069     If True, it i
+0001a880: 7320 6173 7375 6d65 6420 7468 6520 6d6f  s assumed the mo
+0001a890: 6465 6c20 6973 2067 656e 6572 6174 6564  del is generated
+0001a8a0: 2074 6f20 6765 6e65 7261 7465 206c 696b   to generate lik
+0001a8b0: 656c 6968 6f6f 6473 2076 616c 7565 732c  elihoods values,
+0001a8c0: 2061 6e64 2074 6875 7320 7468 6973 2073   and thus this s
+0001a8d0: 6b69 7073 2074 6865 2073 6176 696e 672f  kips the saving/
+0001a8e0: 6361 6c63 756c 6174 696f 6e20 6f66 2074  calculation of t
+0001a8f0: 6865 2069 6e64 6976 6964 7561 6c0a 2020  he individual.  
+0001a900: 2020 2020 2020 6d6f 6465 6c73 2070 6572        models per
+0001a910: 2070 6c61 6e65 7420 2869 2e65 2e2c 2060   planet (i.e., `
+0001a920: 6073 656c 662e 6d6f 6465 6c5b 2770 3127  `self.model['p1'
+0001a930: 5d60 602c 2060 6073 656c 662e 6d6f 6465  ]``, ``self.mode
+0001a940: 6c5b 2770 3227 5d60 602c 2065 7463 2e20  l['p2']``, etc. 
+0001a950: 7769 6c6c 206e 6f74 2065 7869 7374 292e  will not exist).
+0001a960: 2044 6566 6175 6c74 2069 7320 4661 6c73   Default is Fals
+0001a970: 652e 0a0a 2020 2020 2222 220a 0a20 2020  e...    """..   
+0001a980: 2064 6566 2067 656e 6572 6174 655f 7276   def generate_rv
+0001a990: 5f6d 6f64 656c 2873 656c 662c 2070 6172  _model(self, par
+0001a9a0: 616d 6574 6572 5f76 616c 7565 732c 2065  ameter_values, e
+0001a9b0: 7661 6c75 6174 655f 676c 6f62 616c 5f65  valuate_global_e
+0001a9c0: 7272 6f72 733d 5472 7565 293a 0a20 2020  rrors=True):.   
+0001a9d0: 2020 2020 2073 656c 662e 6d6f 6465 6c4f       self.modelO
+0001a9e0: 4b20 3d20 5472 7565 0a20 2020 2020 2020  K = True.       
+0001a9f0: 2023 2042 6566 6f72 6520 616e 7974 6869   # Before anythi
+0001aa00: 6e67 2063 6f6e 7469 6e75 6573 2c20 6368  ng continues, ch
+0001aa10: 6563 6b20 7468 6520 7065 7269 6f64 7320  eck the periods 
+0001aa20: 6172 6520 6368 726f 6e6f 6c6f 6769 6361  are chronologica
+0001aa30: 6c6c 7920 6f72 6465 7265 6420 2874 6869  lly ordered (thi
+0001aa40: 7320 6973 2074 6f20 6176 6f69 6420 6d75  s is to avoid mu
+0001aa50: 6c74 6970 6c65 206d 6f64 6573 2064 7565  ltiple modes due
+0001aa60: 2074 6f0a 2020 2020 2020 2020 2320 7065   to.        # pe
+0001aa70: 7269 6f64 7320 226a 756d 7069 6e67 2220  riods "jumping" 
+0001aa80: 6265 7477 6565 6e20 706c 616e 6574 206e  between planet n
+0001aa90: 756d 6265 7269 6e67 293a 0a20 2020 2020  umbering):.     
+0001aaa0: 2020 2066 6972 7374 5f74 696d 6520 3d20     first_time = 
+0001aab0: 5472 7565 0a20 2020 2020 2020 2066 6f72  True.        for
+0001aac0: 2069 2069 6e20 7365 6c66 2e6e 756d 6265   i in self.numbe
+0001aad0: 7269 6e67 3a0a 2020 2020 2020 2020 2020  ring:.          
+0001aae0: 2020 6966 2066 6972 7374 5f74 696d 653a    if first_time:
+0001aaf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ab00: 2063 5020 3d20 7061 7261 6d65 7465 725f   cP = parameter_
+0001ab10: 7661 6c75 6573 5b27 505f 7027 202b 2073  values['P_p' + s
+0001ab20: 7472 2869 295d 0a20 2020 2020 2020 2020  tr(i)].         
+0001ab30: 2020 2020 2020 2066 6972 7374 5f74 696d         first_tim
+0001ab40: 6520 3d20 4661 6c73 650a 2020 2020 2020  e = False.      
+0001ab50: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001ab60: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+0001ab70: 5020 3c20 7061 7261 6d65 7465 725f 7661  P < parameter_va
+0001ab80: 6c75 6573 5b27 505f 7027 202b 2073 7472  lues['P_p' + str
+0001ab90: 2869 295d 3a0a 2020 2020 2020 2020 2020  (i)]:.          
+0001aba0: 2020 2020 2020 2020 2020 6350 203d 2070            cP = p
+0001abb0: 6172 616d 6574 6572 5f76 616c 7565 735b  arameter_values[
+0001abc0: 2750 5f70 2720 2b20 7374 7228 6929 5d0a  'P_p' + str(i)].
 0001abd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001abe0: 2020 2020 7061 7261 6d65 7465 725f 7661      parameter_va
-0001abf0: 6c75 6573 5b27 6563 6f73 6f6d 6567 615f  lues['ecosomega_
-0001ac00: 7027 202b 2073 7472 2869 295d 290a 2020  p' + str(i)]).  
-0001ac10: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0001ac20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ac30: 6563 6320 3d20 7061 7261 6d65 7465 725f  ecc = parameter_
-0001ac40: 7661 6c75 6573 5b27 7365 636f 736f 6d65  values['secosome
-0001ac50: 6761 5f70 2720 2b20 7374 7228 0a20 2020  ga_p' + str(.   
-0001ac60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ac70: 2069 295d 2a2a 3220 2b20 7061 7261 6d65   i)]**2 + parame
-0001ac80: 7465 725f 7661 6c75 6573 5b27 7365 7369  ter_values['sesi
-0001ac90: 6e6f 6d65 6761 5f70 2720 2b20 7374 7228  nomega_p' + str(
-0001aca0: 6929 5d2a 2a32 0a20 2020 2020 2020 2020  i)]**2.         
-0001acb0: 2020 2020 2020 206f 6d65 6761 203d 206e         omega = n
-0001acc0: 702e 6172 6374 616e 3228 7061 7261 6d65  p.arctan2(parame
-0001acd0: 7465 725f 7661 6c75 6573 5b27 7365 7369  ter_values['sesi
-0001ace0: 6e6f 6d65 6761 5f70 2720 2b20 7374 7228  nomega_p' + str(
-0001acf0: 6929 5d2c 0a20 2020 2020 2020 2020 2020  i)],.           
-0001ad00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ad10: 2020 2020 2020 2020 7061 7261 6d65 7465          paramete
-0001ad20: 725f 7661 6c75 6573 5b27 7365 636f 736f  r_values['secoso
-0001ad30: 6d65 6761 5f70 2720 2b20 7374 7228 6929  mega_p' + str(i)
-0001ad40: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
-0001ad50: 2320 4765 6e65 7261 7465 206c 6967 6874  # Generate light
-0001ad60: 6375 7276 6520 666f 7220 7468 6520 6375  curve for the cu
-0001ad70: 7272 656e 7420 706c 616e 6574 2069 6620  rrent planet if 
-0001ad80: 6563 6320 6973 204f 4b3a 0a20 2020 2020  ecc is OK:.     
-0001ad90: 2020 2020 2020 2069 6620 6563 6320 3e20         if ecc > 
-0001ada0: 7365 6c66 2e65 6363 6c69 6d3a 0a20 2020  self.ecclim:.   
-0001adb0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001adc0: 662e 6d6f 6465 6c4f 4b20 3d20 4661 6c73  f.modelOK = Fals
-0001add0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0001ade0: 2020 7265 7475 726e 2046 616c 7365 0a0a    return False..
-0001adf0: 2020 2020 2020 2020 2020 2020 2320 5361              # Sa
-0001ae00: 7665 2074 6865 6d20 746f 2072 6164 7665  ve them to radve
-0001ae10: 6c3a 0a20 2020 2020 2020 2020 2020 2073  l:.            s
-0001ae20: 656c 662e 6d6f 6465 6c5b 2772 6164 7665  elf.model['radve
-0001ae30: 6c27 5d5b 2770 6572 2720 2b20 7374 7228  l']['per' + str(
-0001ae40: 6e20 2b20 3129 5d20 3d20 7261 6476 656c  n + 1)] = radvel
-0001ae50: 2e50 6172 616d 6574 6572 2876 616c 7565  .Parameter(value
-0001ae60: 3d50 290a 2020 2020 2020 2020 2020 2020  =P).            
-0001ae70: 7365 6c66 2e6d 6f64 656c 5b27 7261 6476  self.model['radv
-0001ae80: 656c 275d 5b27 7463 2720 2b20 7374 7228  el']['tc' + str(
-0001ae90: 6e20 2b20 3129 5d20 3d20 7261 6476 656c  n + 1)] = radvel
-0001aea0: 2e50 6172 616d 6574 6572 2876 616c 7565  .Parameter(value
-0001aeb0: 3d74 3029 0a20 2020 2020 2020 2020 2020  =t0).           
-0001aec0: 2073 656c 662e 6d6f 6465 6c5b 2772 6164   self.model['rad
-0001aed0: 7665 6c27 5d5b 2777 2720 2b20 7374 7228  vel']['w' + str(
-0001aee0: 6e20 2b20 3129 5d20 3d20 7261 6476 656c  n + 1)] = radvel
-0001aef0: 2e50 6172 616d 6574 6572 280a 2020 2020  .Parameter(.    
-0001af00: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-0001af10: 653d 6f6d 6567 6129 2020 2320 6e6f 7465  e=omega)  # note
-0001af20: 2067 6976 656e 2069 6e20 7261 6469 616e   given in radian
-0001af30: 730a 2020 2020 2020 2020 2020 2020 7365  s.            se
-0001af40: 6c66 2e6d 6f64 656c 5b27 7261 6476 656c  lf.model['radvel
-0001af50: 275d 5b27 6527 202b 2073 7472 286e 202b  ']['e' + str(n +
-0001af60: 2031 295d 203d 2072 6164 7665 6c2e 5061   1)] = radvel.Pa
-0001af70: 7261 6d65 7465 7228 7661 6c75 653d 6563  rameter(value=ec
-0001af80: 6329 0a20 2020 2020 2020 2020 2020 2073  c).            s
-0001af90: 656c 662e 6d6f 6465 6c5b 2772 6164 7665  elf.model['radve
-0001afa0: 6c27 5d5b 276b 2720 2b20 7374 7228 6e20  l']['k' + str(n 
-0001afb0: 2b20 3129 5d20 3d20 7261 6476 656c 2e50  + 1)] = radvel.P
-0001afc0: 6172 616d 6574 6572 2876 616c 7565 3d4b  arameter(value=K
-0001afd0: 290a 0a20 2020 2020 2020 2023 2049 6620  )..        # If 
-0001afe0: 6c6f 675f 6c69 6b65 5f63 616c 6320 6973  log_like_calc is
-0001aff0: 2054 7275 6520 2862 7920 6465 6661 756c   True (by defaul
-0001b000: 7420 6475 7269 6e67 206a 756c 6965 742e  t during juliet.
-0001b010: 6669 7429 2c20 646f 6e27 7420 626f 7468  fit), don't both
-0001b020: 6572 2073 6176 696e 6720 7468 6520 5256  er saving the RV
-0001b030: 7320 6f66 2070 6c61 6e65 7420 705f 693a  s of planet p_i:
-0001b040: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0001b050: 2e6c 6f67 5f6c 696b 655f 6361 6c63 3a0a  .log_like_calc:.
-0001b060: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001b070: 2e6d 6f64 656c 5b27 4b65 706c 6572 6961  .model['Kepleria
-0001b080: 6e27 5d20 3d20 7261 6476 656c 2e6d 6f64  n'] = radvel.mod
-0001b090: 656c 2e52 564d 6f64 656c 280a 2020 2020  el.RVModel(.    
-0001b0a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001b0b0: 2e6d 6f64 656c 5b27 7261 6476 656c 275d  .model['radvel']
-0001b0c0: 292e 5f5f 6361 6c6c 5f5f 2873 656c 662e  ).__call__(self.
-0001b0d0: 7429 0a20 2020 2020 2020 2065 6c73 653a  t).        else:
-0001b0e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001b0f0: 662e 6d6f 6465 6c5b 274b 6570 6c65 7269  f.model['Kepleri
-0001b100: 616e 275d 203d 2072 6164 7665 6c2e 6d6f  an'] = radvel.mo
-0001b110: 6465 6c2e 5256 4d6f 6465 6c28 0a20 2020  del.RVModel(.   
-0001b120: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001b130: 662e 6d6f 6465 6c5b 2772 6164 7665 6c27  f.model['radvel'
-0001b140: 5d29 2e5f 5f63 616c 6c5f 5f28 7365 6c66  ]).__call__(self
-0001b150: 2e74 290a 2020 2020 2020 2020 2020 2020  .t).            
-0001b160: 666f 7220 6e20 696e 2072 616e 6765 2873  for n in range(s
-0001b170: 656c 662e 6e70 6c61 6e65 7473 293a 0a20  elf.nplanets):. 
-0001b180: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001b190: 203d 2073 656c 662e 6e75 6d62 6572 696e   = self.numberin
-0001b1a0: 675b 6e5d 0a20 2020 2020 2020 2020 2020  g[n].           
-0001b1b0: 2020 2020 2073 656c 662e 6d6f 6465 6c5b       self.model[
-0001b1c0: 2770 2720 2b20 7374 7228 6929 5d20 3d20  'p' + str(i)] = 
-0001b1d0: 7261 6476 656c 2e6d 6f64 656c 2e52 564d  radvel.model.RVM
-0001b1e0: 6f64 656c 280a 2020 2020 2020 2020 2020  odel(.          
-0001b1f0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0001b200: 6f64 656c 5b27 7261 6476 656c 275d 292e  odel['radvel']).
-0001b210: 5f5f 6361 6c6c 5f5f 2873 656c 662e 742c  __call__(self.t,
-0001b220: 2070 6c61 6e65 745f 6e75 6d3d 6e20 2b20   planet_num=n + 
-0001b230: 3129 0a0a 2020 2020 2020 2020 2320 4966  1)..        # If
-0001b240: 2074 7265 6e64 7320 6172 6520 6265 696e   trends are bein
-0001b250: 6720 6669 7474 6564 2c20 6164 6420 7468  g fitted, add th
-0001b260: 656d 2074 6f20 7468 6520 4b65 706c 6572  em to the Kepler
-0001b270: 6961 6e2b 5472 656e 6420 6d6f 6465 6c3a  ian+Trend model:
-0001b280: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0001b290: 2e64 6963 7469 6f6e 6172 795b 2766 6974  .dictionary['fit
-0001b2a0: 7276 6c69 6e65 275d 3a0a 0a20 2020 2020  rvline']:..     
-0001b2b0: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
-0001b2c0: 6c5b 274b 6570 6c65 7269 616e 2b54 7265  l['Keplerian+Tre
-0001b2d0: 6e64 275d 203d 2073 656c 662e 6d6f 6465  nd'] = self.mode
-0001b2e0: 6c5b 0a20 2020 2020 2020 2020 2020 2020  l[.             
-0001b2f0: 2020 2027 4b65 706c 6572 6961 6e27 5d20     'Keplerian'] 
-0001b300: 2b20 7061 7261 6d65 7465 725f 7661 6c75  + parameter_valu
-0001b310: 6573 5b27 7276 5f69 6e74 6572 6365 7074  es['rv_intercept
-0001b320: 275d 202b 2028 0a20 2020 2020 2020 2020  '] + (.         
-0001b330: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001b340: 7420 2d20 7365 6c66 2e74 6129 202a 2070  t - self.ta) * p
-0001b350: 6172 616d 6574 6572 5f76 616c 7565 735b  arameter_values[
-0001b360: 2772 765f 736c 6f70 6527 5d0a 0a20 2020  'rv_slope']..   
-0001b370: 2020 2020 2065 6c69 6620 7365 6c66 2e64       elif self.d
-0001b380: 6963 7469 6f6e 6172 795b 2766 6974 7276  ictionary['fitrv
-0001b390: 7175 6164 275d 3a0a 2020 2020 2020 2020  quad']:.        
-0001b3a0: 2020 2020 7365 6c66 2e6d 6f64 656c 5b27      self.model['
-0001b3b0: 4b65 706c 6572 6961 6e2b 5472 656e 6427  Keplerian+Trend'
-0001b3c0: 5d20 3d20 7365 6c66 2e6d 6f64 656c 5b27  ] = self.model['
-0001b3d0: 4b65 706c 6572 6961 6e27 5d20 2b20 7061  Keplerian'] + pa
-0001b3e0: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
-0001b3f0: 7276 5f69 6e74 6572 6365 7074 275d 202b  rv_intercept'] +
-0001b400: 2028 7365 6c66 2e74 202d 2073 656c 662e   (self.t - self.
-0001b410: 7461 292a 7061 7261 6d65 7465 725f 7661  ta)*parameter_va
-0001b420: 6c75 6573 5b27 7276 5f73 6c6f 7065 275d  lues['rv_slope']
-0001b430: 202b 205c 0a20 2020 2020 2020 2020 2020   + \.           
-0001b440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b470: 2020 2020 2020 2020 2020 2028 2873 656c             ((sel
-0001b480: 662e 7420 2d20 7365 6c66 2e74 6129 2a2a  f.t - self.ta)**
-0001b490: 3229 2a70 6172 616d 6574 6572 5f76 616c  2)*parameter_val
-0001b4a0: 7565 735b 2772 765f 7175 6164 275d 0a20  ues['rv_quad']. 
-0001b4b0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001b4c0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-0001b4d0: 6465 6c5b 274b 6570 6c65 7269 616e 2b54  del['Keplerian+T
-0001b4e0: 7265 6e64 275d 203d 2073 656c 662e 6d6f  rend'] = self.mo
-0001b4f0: 6465 6c5b 274b 6570 6c65 7269 616e 275d  del['Keplerian']
-0001b500: 0a0a 2020 2020 2020 2020 2320 506f 7075  ..        # Popu
-0001b510: 6c61 7465 2074 6865 2073 656c 662e 6d6f  late the self.mo
-0001b520: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
-0001b530: 2764 6574 6572 6d69 6e69 7374 6963 275d  'deterministic']
-0001b540: 2061 7272 6179 2e20 5468 6973 2068 6f73   array. This hos
-0001b550: 7473 2074 6865 2066 756c 6c20 2864 6574  ts the full (det
-0001b560: 6572 6d69 6e69 7374 6963 2920 6d6f 6465  erministic) mode
-0001b570: 6c20 666f 7220 6561 6368 2052 5620 696e  l for each RV in
-0001b580: 7374 7275 6d65 6e74 2e0a 2020 2020 2020  strument..      
-0001b590: 2020 666f 7220 696e 7374 7275 6d65 6e74    for instrument
-0001b5a0: 2069 6e20 7365 6c66 2e69 6e61 6d65 733a   in self.inames:
-0001b5b0: 0a20 2020 2020 2020 2020 200a 2020 2020  .          .    
-0001b5c0: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
-0001b5d0: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
-0001b5e0: 6465 7465 726d 696e 6973 7469 6327 5d20  deterministic'] 
-0001b5f0: 3d20 7365 6c66 2e6d 6f64 656c 5b0a 2020  = self.model[.  
-0001b600: 2020 2020 2020 2020 2020 2020 2020 274b                'K
-0001b610: 6570 6c65 7269 616e 2b54 7265 6e64 275d  eplerian+Trend']
-0001b620: 5b73 656c 662e 696e 7374 7275 6d65 6e74  [self.instrument
-0001b630: 5f69 6e64 6578 6573 5b0a 2020 2020 2020  _indexes[.      
-0001b640: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0001b650: 7374 7275 6d65 6e74 5d5d 202b 2070 6172  strument]] + par
-0001b660: 616d 6574 6572 5f76 616c 7565 735b 276d  ameter_values['m
-0001b670: 755f 2720 2b20 696e 7374 7275 6d65 6e74  u_' + instrument
-0001b680: 5d0a 2020 2020 2020 2020 2020 2020 0a20  ].            . 
-0001b690: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001b6a0: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
-0001b6b0: 5d5b 2764 6574 6572 6d69 6e69 7374 6963  ]['deterministic
-0001b6c0: 5f76 6172 6961 6e63 6573 275d 203d 2073  _variances'] = s
-0001b6d0: 656c 662e 6572 726f 7273 5b0a 2020 2020  elf.errors[.    
-0001b6e0: 2020 2020 2020 2020 2020 2020 696e 7374              inst
-0001b6f0: 7275 6d65 6e74 5d2a 2a32 202b 2070 6172  rument]**2 + par
-0001b700: 616d 6574 6572 5f76 616c 7565 735b 2773  ameter_values['s
-0001b710: 6967 6d61 5f77 5f27 202b 2069 6e73 7472  igma_w_' + instr
-0001b720: 756d 656e 745d 2a2a 320a 0a20 2020 2020  ument]**2..     
-0001b730: 2020 2020 2020 2069 6620 7365 6c66 2e6c         if self.l
-0001b740: 6d5f 626f 6f6c 6561 6e5b 696e 7374 7275  m_boolean[instru
-0001b750: 6d65 6e74 5d3a 0a20 2020 2020 2020 2020  ment]:.         
-0001b760: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
-0001b770: 6c5b 696e 7374 7275 6d65 6e74 5d5b 274c  l[instrument]['L
-0001b780: 4d27 5d20 3d20 6e70 2e7a 6572 6f73 280a  M'] = np.zeros(.
-0001b790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b7a0: 2020 2020 7365 6c66 2e6e 6461 7461 706f      self.ndatapo
-0001b7b0: 696e 7473 5f70 6572 5f69 6e73 7472 756d  ints_per_instrum
-0001b7c0: 656e 745b 696e 7374 7275 6d65 6e74 5d29  ent[instrument])
-0001b7d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b7e0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0001b7f0: 7365 6c66 2e6c 6d5f 6e5b 696e 7374 7275  self.lm_n[instru
-0001b800: 6d65 6e74 5d29 3a0a 2020 2020 2020 2020  ment]):.        
-0001b810: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001b820: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
-0001b830: 745d 5b27 4c4d 275d 202b 3d20 7061 7261  t]['LM'] += para
-0001b840: 6d65 7465 725f 7661 6c75 6573 5b0a 2020  meter_values[.  
-0001b850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b860: 2020 2020 2020 2774 6865 7461 2720 2b20        'theta' + 
-0001b870: 7374 7228 6929 202b 2027 5f27 202b 0a20  str(i) + '_' +. 
+0001abe0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001abf0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0001ac00: 6f64 656c 4f4b 203d 2046 616c 7365 0a20  odelOK = False. 
+0001ac10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ac20: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
+0001ac30: 0a20 2020 2020 2020 2023 2046 6972 7374  .        # First
+0001ac40: 2c20 6578 7472 6163 7420 6f72 6269 7461  , extract orbita
+0001ac50: 6c20 7061 7261 6d65 7465 7273 2061 6e64  l parameters and
+0001ac60: 2073 6176 6520 7468 656d 2c20 7768 6963   save them, whic
+0001ac70: 6820 7769 6c6c 2062 6520 636f 6d6d 6f6e  h will be common
+0001ac80: 2074 6f20 616c 6c20 696e 7374 7275 6d65   to all instrume
+0001ac90: 6e74 733a 0a20 2020 2020 2020 2066 6f72  nts:.        for
+0001aca0: 206e 2069 6e20 7261 6e67 6528 7365 6c66   n in range(self
+0001acb0: 2e6e 706c 616e 6574 7329 3a0a 2020 2020  .nplanets):.    
+0001acc0: 2020 2020 2020 2020 6920 3d20 7365 6c66          i = self
+0001acd0: 2e6e 756d 6265 7269 6e67 5b6e 5d0a 0a20  .numbering[n].. 
+0001ace0: 2020 2020 2020 2020 2020 2023 2053 656d             # Sem
+0001acf0: 692d 616d 706c 6974 7564 6573 2c20 7430  i-amplitudes, t0
+0001ad00: 2061 6e64 2050 3a0a 2020 2020 2020 2020   and P:.        
+0001ad10: 2020 2020 4b2c 2074 302c 2050 203d 2070      K, t0, P = p
+0001ad20: 6172 616d 6574 6572 5f76 616c 7565 735b  arameter_values[
+0001ad30: 274b 5f70 2720 2b20 7374 7228 6929 5d2c  'K_p' + str(i)],
+0001ad40: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
+0001ad50: 735b 0a20 2020 2020 2020 2020 2020 2020  s[.             
+0001ad60: 2020 2027 7430 5f70 2720 2b20 7374 7228     't0_p' + str(
+0001ad70: 6929 5d2c 2070 6172 616d 6574 6572 5f76  i)], parameter_v
+0001ad80: 616c 7565 735b 2750 5f70 2720 2b20 7374  alues['P_p' + st
+0001ad90: 7228 6929 5d0a 0a20 2020 2020 2020 2020  r(i)]..         
+0001ada0: 2020 2023 2045 7874 7261 6374 2065 6363     # Extract ecc
+0001adb0: 656e 7472 6963 6974 7920 616e 6420 6f6d  entricity and om
+0001adc0: 6567 6120 6465 7065 6e64 696e 6720 6f6e  ega depending on
+0001add0: 2074 6865 2075 7365 6420 7061 7261 6d65   the used parame
+0001ade0: 7472 697a 6174 696f 6e20 666f 7220 6561  trization for ea
+0001adf0: 6368 2070 6c61 6e65 743a 0a20 2020 2020  ch planet:.     
+0001ae00: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
+0001ae10: 6963 7469 6f6e 6172 795b 2765 6363 5f70  ictionary['ecc_p
+0001ae20: 6172 616d 6574 7269 7a61 7469 6f6e 275d  arametrization']
+0001ae30: 5b69 5d20 3d3d 2030 3a0a 2020 2020 2020  [i] == 0:.      
+0001ae40: 2020 2020 2020 2020 2020 6563 632c 206f            ecc, o
+0001ae50: 6d65 6761 203d 2070 6172 616d 6574 6572  mega = parameter
+0001ae60: 5f76 616c 7565 735b 0a20 2020 2020 2020  _values[.       
+0001ae70: 2020 2020 2020 2020 2020 2020 2027 6563               'ec
+0001ae80: 635f 7027 202b 0a20 2020 2020 2020 2020  c_p' +.         
+0001ae90: 2020 2020 2020 2020 2020 2073 7472 2869             str(i
+0001aea0: 295d 2c20 7061 7261 6d65 7465 725f 7661  )], parameter_va
+0001aeb0: 6c75 6573 5b27 6f6d 6567 615f 7027 202b  lues['omega_p' +
+0001aec0: 2073 7472 2869 295d 202a 206e 702e 7069   str(i)] * np.pi
+0001aed0: 202f 2031 3830 2e0a 2020 2020 2020 2020   / 180..        
+0001aee0: 2020 2020 656c 6966 2073 656c 662e 6469      elif self.di
+0001aef0: 6374 696f 6e61 7279 5b27 6563 635f 7061  ctionary['ecc_pa
+0001af00: 7261 6d65 7472 697a 6174 696f 6e27 5d5b  rametrization'][
+0001af10: 695d 203d 3d20 313a 0a20 2020 2020 2020  i] == 1:.       
+0001af20: 2020 2020 2020 2020 2065 6363 203d 206e           ecc = n
+0001af30: 702e 7371 7274 2870 6172 616d 6574 6572  p.sqrt(parameter
+0001af40: 5f76 616c 7565 735b 2765 636f 736f 6d65  _values['ecosome
+0001af50: 6761 5f70 2720 2b20 7374 7228 6929 5d2a  ga_p' + str(i)]*
+0001af60: 2a32 202b 0a20 2020 2020 2020 2020 2020  *2 +.           
+0001af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af80: 2020 2070 6172 616d 6574 6572 5f76 616c     parameter_val
+0001af90: 7565 735b 2765 7369 6e6f 6d65 6761 5f70  ues['esinomega_p
+0001afa0: 2720 2b20 7374 7228 6929 5d2a 2a32 290a  ' + str(i)]**2).
+0001afb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001afc0: 6f6d 6567 6120 3d20 6e70 2e61 7263 7461  omega = np.arcta
+0001afd0: 6e32 2870 6172 616d 6574 6572 5f76 616c  n2(parameter_val
+0001afe0: 7565 735b 2765 7369 6e6f 6d65 6761 5f70  ues['esinomega_p
+0001aff0: 2720 2b20 7374 7228 6929 5d2c 0a20 2020  ' + str(i)],.   
+0001b000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b020: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0001b030: 5b27 6563 6f73 6f6d 6567 615f 7027 202b  ['ecosomega_p' +
+0001b040: 2073 7472 2869 295d 290a 2020 2020 2020   str(i)]).      
+0001b050: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001b060: 2020 2020 2020 2020 2020 2020 6563 6320              ecc 
+0001b070: 3d20 7061 7261 6d65 7465 725f 7661 6c75  = parameter_valu
+0001b080: 6573 5b27 7365 636f 736f 6d65 6761 5f70  es['secosomega_p
+0001b090: 2720 2b20 7374 7228 0a20 2020 2020 2020  ' + str(.       
+0001b0a0: 2020 2020 2020 2020 2020 2020 2069 295d               i)]
+0001b0b0: 2a2a 3220 2b20 7061 7261 6d65 7465 725f  **2 + parameter_
+0001b0c0: 7661 6c75 6573 5b27 7365 7369 6e6f 6d65  values['sesinome
+0001b0d0: 6761 5f70 2720 2b20 7374 7228 6929 5d2a  ga_p' + str(i)]*
+0001b0e0: 2a32 0a20 2020 2020 2020 2020 2020 2020  *2.             
+0001b0f0: 2020 206f 6d65 6761 203d 206e 702e 6172     omega = np.ar
+0001b100: 6374 616e 3228 7061 7261 6d65 7465 725f  ctan2(parameter_
+0001b110: 7661 6c75 6573 5b27 7365 7369 6e6f 6d65  values['sesinome
+0001b120: 6761 5f70 2720 2b20 7374 7228 6929 5d2c  ga_p' + str(i)],
+0001b130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b150: 2020 2020 7061 7261 6d65 7465 725f 7661      parameter_va
+0001b160: 6c75 6573 5b27 7365 636f 736f 6d65 6761  lues['secosomega
+0001b170: 5f70 2720 2b20 7374 7228 6929 5d29 0a0a  _p' + str(i)])..
+0001b180: 2020 2020 2020 2020 2020 2020 2320 4765              # Ge
+0001b190: 6e65 7261 7465 206c 6967 6874 6375 7276  nerate lightcurv
+0001b1a0: 6520 666f 7220 7468 6520 6375 7272 656e  e for the curren
+0001b1b0: 7420 706c 616e 6574 2069 6620 6563 6320  t planet if ecc 
+0001b1c0: 6973 204f 4b3a 0a20 2020 2020 2020 2020  is OK:.         
+0001b1d0: 2020 2069 6620 6563 6320 3e20 7365 6c66     if ecc > self
+0001b1e0: 2e65 6363 6c69 6d3a 0a20 2020 2020 2020  .ecclim:.       
+0001b1f0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
+0001b200: 6465 6c4f 4b20 3d20 4661 6c73 650a 2020  delOK = False.  
+0001b210: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001b220: 7475 726e 2046 616c 7365 0a0a 2020 2020  turn False..    
+0001b230: 2020 2020 2020 2020 2320 5361 7665 2074          # Save t
+0001b240: 6865 6d20 746f 2072 6164 7665 6c3a 0a20  hem to radvel:. 
+0001b250: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001b260: 6d6f 6465 6c5b 2772 6164 7665 6c27 5d5b  model['radvel'][
+0001b270: 2770 6572 2720 2b20 7374 7228 6e20 2b20  'per' + str(n + 
+0001b280: 3129 5d20 3d20 7261 6476 656c 2e50 6172  1)] = radvel.Par
+0001b290: 616d 6574 6572 2876 616c 7565 3d50 290a  ameter(value=P).
+0001b2a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001b2b0: 2e6d 6f64 656c 5b27 7261 6476 656c 275d  .model['radvel']
+0001b2c0: 5b27 7463 2720 2b20 7374 7228 6e20 2b20  ['tc' + str(n + 
+0001b2d0: 3129 5d20 3d20 7261 6476 656c 2e50 6172  1)] = radvel.Par
+0001b2e0: 616d 6574 6572 2876 616c 7565 3d74 3029  ameter(value=t0)
+0001b2f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001b300: 662e 6d6f 6465 6c5b 2772 6164 7665 6c27  f.model['radvel'
+0001b310: 5d5b 2777 2720 2b20 7374 7228 6e20 2b20  ]['w' + str(n + 
+0001b320: 3129 5d20 3d20 7261 6476 656c 2e50 6172  1)] = radvel.Par
+0001b330: 616d 6574 6572 280a 2020 2020 2020 2020  ameter(.        
+0001b340: 2020 2020 2020 2020 7661 6c75 653d 6f6d          value=om
+0001b350: 6567 6129 2020 2320 6e6f 7465 2067 6976  ega)  # note giv
+0001b360: 656e 2069 6e20 7261 6469 616e 730a 2020  en in radians.  
+0001b370: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0001b380: 6f64 656c 5b27 7261 6476 656c 275d 5b27  odel['radvel']['
+0001b390: 6527 202b 2073 7472 286e 202b 2031 295d  e' + str(n + 1)]
+0001b3a0: 203d 2072 6164 7665 6c2e 5061 7261 6d65   = radvel.Parame
+0001b3b0: 7465 7228 7661 6c75 653d 6563 6329 0a20  ter(value=ecc). 
+0001b3c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001b3d0: 6d6f 6465 6c5b 2772 6164 7665 6c27 5d5b  model['radvel'][
+0001b3e0: 276b 2720 2b20 7374 7228 6e20 2b20 3129  'k' + str(n + 1)
+0001b3f0: 5d20 3d20 7261 6476 656c 2e50 6172 616d  ] = radvel.Param
+0001b400: 6574 6572 2876 616c 7565 3d4b 290a 0a20  eter(value=K).. 
+0001b410: 2020 2020 2020 2023 2049 6620 6c6f 675f         # If log_
+0001b420: 6c69 6b65 5f63 616c 6320 6973 2054 7275  like_calc is Tru
+0001b430: 6520 2862 7920 6465 6661 756c 7420 6475  e (by default du
+0001b440: 7269 6e67 206a 756c 6965 742e 6669 7429  ring juliet.fit)
+0001b450: 2c20 646f 6e27 7420 626f 7468 6572 2073  , don't bother s
+0001b460: 6176 696e 6720 7468 6520 5256 7320 6f66  aving the RVs of
+0001b470: 2070 6c61 6e65 7420 705f 693a 0a20 2020   planet p_i:.   
+0001b480: 2020 2020 2069 6620 7365 6c66 2e6c 6f67       if self.log
+0001b490: 5f6c 696b 655f 6361 6c63 3a0a 2020 2020  _like_calc:.    
+0001b4a0: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+0001b4b0: 656c 5b27 4b65 706c 6572 6961 6e27 5d20  el['Keplerian'] 
+0001b4c0: 3d20 7261 6476 656c 2e6d 6f64 656c 2e52  = radvel.model.R
+0001b4d0: 564d 6f64 656c 280a 2020 2020 2020 2020  VModel(.        
+0001b4e0: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+0001b4f0: 656c 5b27 7261 6476 656c 275d 292e 5f5f  el['radvel']).__
+0001b500: 6361 6c6c 5f5f 2873 656c 662e 7429 0a20  call__(self.t). 
+0001b510: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001b520: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
+0001b530: 6465 6c5b 274b 6570 6c65 7269 616e 275d  del['Keplerian']
+0001b540: 203d 2072 6164 7665 6c2e 6d6f 6465 6c2e   = radvel.model.
+0001b550: 5256 4d6f 6465 6c28 0a20 2020 2020 2020  RVModel(.       
+0001b560: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
+0001b570: 6465 6c5b 2772 6164 7665 6c27 5d29 2e5f  del['radvel'])._
+0001b580: 5f63 616c 6c5f 5f28 7365 6c66 2e74 290a  _call__(self.t).
+0001b590: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0001b5a0: 6e20 696e 2072 616e 6765 2873 656c 662e  n in range(self.
+0001b5b0: 6e70 6c61 6e65 7473 293a 0a20 2020 2020  nplanets):.     
+0001b5c0: 2020 2020 2020 2020 2020 2069 203d 2073             i = s
+0001b5d0: 656c 662e 6e75 6d62 6572 696e 675b 6e5d  elf.numbering[n]
+0001b5e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b5f0: 2073 656c 662e 6d6f 6465 6c5b 2770 2720   self.model['p' 
+0001b600: 2b20 7374 7228 6929 5d20 3d20 7261 6476  + str(i)] = radv
+0001b610: 656c 2e6d 6f64 656c 2e52 564d 6f64 656c  el.model.RVModel
+0001b620: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001b630: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
+0001b640: 5b27 7261 6476 656c 275d 292e 5f5f 6361  ['radvel']).__ca
+0001b650: 6c6c 5f5f 2873 656c 662e 742c 2070 6c61  ll__(self.t, pla
+0001b660: 6e65 745f 6e75 6d3d 6e20 2b20 3129 0a0a  net_num=n + 1)..
+0001b670: 2020 2020 2020 2020 2320 4966 2074 7265          # If tre
+0001b680: 6e64 7320 6172 6520 6265 696e 6720 6669  nds are being fi
+0001b690: 7474 6564 2c20 6164 6420 7468 656d 2074  tted, add them t
+0001b6a0: 6f20 7468 6520 4b65 706c 6572 6961 6e2b  o the Keplerian+
+0001b6b0: 5472 656e 6420 6d6f 6465 6c3a 0a20 2020  Trend model:.   
+0001b6c0: 2020 2020 2069 6620 7365 6c66 2e64 6963       if self.dic
+0001b6d0: 7469 6f6e 6172 795b 2766 6974 7276 6c69  tionary['fitrvli
+0001b6e0: 6e65 275d 3a0a 0a20 2020 2020 2020 2020  ne']:..         
+0001b6f0: 2020 2073 656c 662e 6d6f 6465 6c5b 274b     self.model['K
+0001b700: 6570 6c65 7269 616e 2b54 7265 6e64 275d  eplerian+Trend']
+0001b710: 203d 2073 656c 662e 6d6f 6465 6c5b 0a20   = self.model[. 
+0001b720: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0001b730: 4b65 706c 6572 6961 6e27 5d20 2b20 7061  Keplerian'] + pa
+0001b740: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
+0001b750: 7276 5f69 6e74 6572 6365 7074 275d 202b  rv_intercept'] +
+0001b760: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+0001b770: 2020 2020 2020 2073 656c 662e 7420 2d20         self.t - 
+0001b780: 7365 6c66 2e74 6129 202a 2070 6172 616d  self.ta) * param
+0001b790: 6574 6572 5f76 616c 7565 735b 2772 765f  eter_values['rv_
+0001b7a0: 736c 6f70 6527 5d0a 0a20 2020 2020 2020  slope']..       
+0001b7b0: 2065 6c69 6620 7365 6c66 2e64 6963 7469   elif self.dicti
+0001b7c0: 6f6e 6172 795b 2766 6974 7276 7175 6164  onary['fitrvquad
+0001b7d0: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
+0001b7e0: 7365 6c66 2e6d 6f64 656c 5b27 4b65 706c  self.model['Kepl
+0001b7f0: 6572 6961 6e2b 5472 656e 6427 5d20 3d20  erian+Trend'] = 
+0001b800: 7365 6c66 2e6d 6f64 656c 5b27 4b65 706c  self.model['Kepl
+0001b810: 6572 6961 6e27 5d20 2b20 7061 7261 6d65  erian'] + parame
+0001b820: 7465 725f 7661 6c75 6573 5b27 7276 5f69  ter_values['rv_i
+0001b830: 6e74 6572 6365 7074 275d 202b 2028 7365  ntercept'] + (se
+0001b840: 6c66 2e74 202d 2073 656c 662e 7461 292a  lf.t - self.ta)*
+0001b850: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0001b860: 5b27 7276 5f73 6c6f 7065 275d 202b 205c  ['rv_slope'] + \
+0001b870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0001b880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b890: 2020 2020 2020 2073 656c 662e 7468 6574         self.thet
-0001b8a0: 615f 696e 616d 655b 7374 7228 6929 2b69  a_iname[str(i)+i
-0001b8b0: 6e73 7472 756d 656e 745d 5d20 2a20 7365  nstrument]] * se
-0001b8c0: 6c66 2e6c 6d5f 6172 6775 6d65 6e74 735b  lf.lm_arguments[
-0001b8d0: 696e 7374 7275 6d65 6e74 5d5b 3a2c 2069  instrument][:, i
-0001b8e0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0001b8f0: 2020 7365 6c66 2e6d 6f64 656c 5b69 6e73    self.model[ins
-0001b900: 7472 756d 656e 745d 5b27 6465 7465 726d  trument]['determ
-0001b910: 696e 6973 7469 6327 5d20 2b3d 2073 656c  inistic'] += sel
-0001b920: 662e 6d6f 6465 6c5b 0a20 2020 2020 2020  f.model[.       
-0001b930: 2020 2020 2020 2020 2020 2020 2069 6e73               ins
-0001b940: 7472 756d 656e 745d 5b27 4c4d 275d 0a20  trument]['LM']. 
-0001b950: 2020 2020 2020 2020 2020 2023 2049 6620             # If 
-0001b960: 7468 6520 6d6f 6465 6c20 756e 6465 7220  the model under 
-0001b970: 636f 6e73 6964 6572 6174 696f 6e20 6973  consideration is
-0001b980: 2061 2067 6c6f 6261 6c20 6d6f 6465 6c2c   a global model,
-0001b990: 2070 6f70 756c 6174 6520 7468 6520 676c   populate the gl
-0001b9a0: 6f62 616c 206d 6f64 656c 2064 6963 7469  obal model dicti
-0001b9b0: 6f6e 6172 793a 0a20 2020 2020 2020 2020  onary:.         
-0001b9c0: 2020 2069 6620 7365 6c66 2e67 6c6f 6261     if self.globa
-0001b9d0: 6c5f 6d6f 6465 6c3a 0a20 2020 2020 2020  l_model:.       
-0001b9e0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-0001b9f0: 6465 6c5b 2767 6c6f 6261 6c27 5d5b 7365  del['global'][se
-0001ba00: 6c66 2e69 6e73 7472 756d 656e 745f 696e  lf.instrument_in
-0001ba10: 6465 7865 735b 0a20 2020 2020 2020 2020  dexes[.         
-0001ba20: 2020 2020 2020 2020 2020 2069 6e73 7472             instr
-0001ba30: 756d 656e 745d 5d20 3d20 7365 6c66 2e6d  ument]] = self.m
-0001ba40: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
-0001ba50: 5b27 6465 7465 726d 696e 6973 7469 6327  ['deterministic'
-0001ba60: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0001ba70: 2020 6966 2065 7661 6c75 6174 655f 676c    if evaluate_gl
-0001ba80: 6f62 616c 5f65 7272 6f72 733a 0a20 2020  obal_errors:.   
-0001ba90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001baa0: 2073 656c 662e 6d6f 6465 6c5b 2767 6c6f   self.model['glo
-0001bab0: 6261 6c5f 7661 7269 616e 6365 7327 5d5b  bal_variances'][
-0001bac0: 7365 6c66 2e69 6e73 7472 756d 656e 745f  self.instrument_
-0001bad0: 696e 6465 7865 735b 696e 7374 7275 6d65  indexes[instrume
-0001bae0: 6e74 5d5d 203d 2073 656c 662e 7965 7272  nt]] = self.yerr
-0001baf0: 5b73 656c 662e 696e 7374 7275 6d65 6e74  [self.instrument
-0001bb00: 5f69 6e64 6578 6573 5b69 6e73 7472 756d  _indexes[instrum
-0001bb10: 656e 745d 5d2a 2a32 202b 205c 0a20 2020  ent]]**2 + \.   
-0001bb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb70: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
-0001bb80: 5f76 616c 7565 735b 2773 6967 6d61 5f77  _values['sigma_w
-0001bb90: 5f27 2b69 6e73 7472 756d 656e 745d 2a2a  _'+instrument]**
-0001bba0: 320a 0a20 2020 2064 6566 2067 6574 5f47  2..    def get_G
-0001bbb0: 505f 706c 7573 5f64 6574 6572 6d69 6e69  P_plus_determini
-0001bbc0: 7374 6963 5f6d 6f64 656c 2873 656c 662c  stic_model(self,
-0001bbd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001bbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bbf0: 2020 2020 2020 2020 2070 6172 616d 6574           paramet
-0001bc00: 6572 5f76 616c 7565 732c 0a20 2020 2020  er_values,.     
-0001bc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bc30: 2020 2069 6e73 7472 756d 656e 743d 4e6f     instrument=No
-0001bc40: 6e65 293a 0a0a 2020 2020 2020 2020 6966  ne):..        if
-0001bc50: 2073 656c 662e 676c 6f62 616c 5f6d 6f64   self.global_mod
-0001bc60: 656c 3a0a 2020 2020 2020 2020 2020 2020  el:.            
-0001bc70: 6966 2073 656c 662e 6469 6374 696f 6e61  if self.dictiona
-0001bc80: 7279 5b27 676c 6f62 616c 5f6d 6f64 656c  ry['global_model
-0001bc90: 275d 5b27 4750 4465 7472 656e 6427 5d3a  ']['GPDetrend']:
-0001bca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001bcb0: 2023 7265 7369 6475 616c 7320 3d20 7365   #residuals = se
-0001bcc0: 6c66 2e72 6573 6964 7561 6c73 2023 7365  lf.residuals #se
-0001bcd0: 6c66 2e79 202d 2073 656c 662e 6d6f 6465  lf.y - self.mode
-0001bce0: 6c5b 2767 6c6f 6261 6c27 5d0a 2020 2020  l['global'].    
-0001bcf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001bd00: 2e64 6963 7469 6f6e 6172 795b 2767 6c6f  .dictionary['glo
-0001bd10: 6261 6c5f 6d6f 6465 6c27 5d5b 0a20 2020  bal_model'][.   
-0001bd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bd30: 2027 6e6f 6973 655f 6d6f 6465 6c27 5d2e   'noise_model'].
-0001bd40: 7365 745f 7061 7261 6d65 7465 725f 7665  set_parameter_ve
-0001bd50: 6374 6f72 2870 6172 616d 6574 6572 5f76  ctor(parameter_v
-0001bd60: 616c 7565 7329 0a20 2020 2020 2020 2020  alues).         
-0001bd70: 2020 2020 2020 2073 656c 662e 6469 6374         self.dict
-0001bd80: 696f 6e61 7279 5b27 676c 6f62 616c 5f6d  ionary['global_m
-0001bd90: 6f64 656c 275d 5b27 6e6f 6973 655f 6d6f  odel']['noise_mo
-0001bda0: 6465 6c27 5d2e 7965 7272 203d 206e 702e  del'].yerr = np.
-0001bdb0: 7371 7274 280a 2020 2020 2020 2020 2020  sqrt(.          
-0001bdc0: 2020 2020 2020 2020 2020 7365 6c66 2e76            self.v
-0001bdd0: 6172 6961 6e63 6573 290a 2020 2020 2020  ariances).      
-0001bde0: 2020 2020 2020 2020 2020 7365 6c66 2e64            self.d
-0001bdf0: 6963 7469 6f6e 6172 795b 2767 6c6f 6261  ictionary['globa
-0001be00: 6c5f 6d6f 6465 6c27 5d5b 276e 6f69 7365  l_model']['noise
-0001be10: 5f6d 6f64 656c 275d 2e63 6f6d 7075 7465  _model'].compute
-0001be20: 5f47 5028 0a20 2020 2020 2020 2020 2020  _GP(.           
-0001be30: 2020 2020 2020 2020 2058 3d73 656c 662e           X=self.
-0001be40: 6f72 6967 696e 616c 5f47 5072 6567 7265  original_GPregre
-0001be50: 7373 6f72 7329 0a20 2020 2020 2020 2020  ssors).         
-0001be60: 2020 2020 2020 2023 2052 6574 7572 6e20         # Return 
-0001be70: 6d65 616e 2073 6967 6e61 6c20 706c 7573  mean signal plus
-0001be80: 2047 5020 6d6f 6465 6c3a 0a20 2020 2020   GP model:.     
-0001be90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001bea0: 6d6f 6465 6c5b 2747 5027 5d20 3d20 7365  model['GP'] = se
-0001beb0: 6c66 2e64 6963 7469 6f6e 6172 795b 2767  lf.dictionary['g
-0001bec0: 6c6f 6261 6c5f 6d6f 6465 6c27 5d5b 276e  lobal_model']['n
-0001bed0: 6f69 7365 5f6d 6f64 656c 275d 2e47 502e  oise_model'].GP.
-0001bee0: 7072 6564 6963 7428 7365 6c66 2e72 6573  predict(self.res
-0001bef0: 6964 7561 6c73 2c20 7365 6c66 2e64 6963  iduals, self.dic
-0001bf00: 7469 6f6e 6172 795b 2767 6c6f 6261 6c5f  tionary['global_
-0001bf10: 6d6f 6465 6c27 5d5b 276e 6f69 7365 5f6d  model']['noise_m
-0001bf20: 6f64 656c 275d 2e58 2c20 5c0a 2020 2020  odel'].X, \.    
-0001bf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b8b0: 2020 2020 2020 2028 2873 656c 662e 7420         ((self.t 
+0001b8c0: 2d20 7365 6c66 2e74 6129 2a2a 3229 2a70  - self.ta)**2)*p
+0001b8d0: 6172 616d 6574 6572 5f76 616c 7565 735b  arameter_values[
+0001b8e0: 2772 765f 7175 6164 275d 0a20 2020 2020  'rv_quad'].     
+0001b8f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0001b900: 2020 2020 2073 656c 662e 6d6f 6465 6c5b       self.model[
+0001b910: 274b 6570 6c65 7269 616e 2b54 7265 6e64  'Keplerian+Trend
+0001b920: 275d 203d 2073 656c 662e 6d6f 6465 6c5b  '] = self.model[
+0001b930: 274b 6570 6c65 7269 616e 275d 0a0a 2020  'Keplerian']..  
+0001b940: 2020 2020 2020 2320 506f 7075 6c61 7465        # Populate
+0001b950: 2074 6865 2073 656c 662e 6d6f 6465 6c5b   the self.model[
+0001b960: 696e 7374 7275 6d65 6e74 5d5b 2764 6574  instrument]['det
+0001b970: 6572 6d69 6e69 7374 6963 275d 2061 7272  erministic'] arr
+0001b980: 6179 2e20 5468 6973 2068 6f73 7473 2074  ay. This hosts t
+0001b990: 6865 2066 756c 6c20 2864 6574 6572 6d69  he full (determi
+0001b9a0: 6e69 7374 6963 2920 6d6f 6465 6c20 666f  nistic) model fo
+0001b9b0: 7220 6561 6368 2052 5620 696e 7374 7275  r each RV instru
+0001b9c0: 6d65 6e74 2e0a 2020 2020 2020 2020 666f  ment..        fo
+0001b9d0: 7220 696e 7374 7275 6d65 6e74 2069 6e20  r instrument in 
+0001b9e0: 7365 6c66 2e69 6e61 6d65 733a 0a20 2020  self.inames:.   
+0001b9f0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+0001ba00: 2020 2020 7365 6c66 2e6d 6f64 656c 5b69      self.model[i
+0001ba10: 6e73 7472 756d 656e 745d 5b27 6465 7465  nstrument]['dete
+0001ba20: 726d 696e 6973 7469 6327 5d20 3d20 7365  rministic'] = se
+0001ba30: 6c66 2e6d 6f64 656c 5b0a 2020 2020 2020  lf.model[.      
+0001ba40: 2020 2020 2020 2020 2020 274b 6570 6c65            'Keple
+0001ba50: 7269 616e 2b54 7265 6e64 275d 5b73 656c  rian+Trend'][sel
+0001ba60: 662e 696e 7374 7275 6d65 6e74 5f69 6e64  f.instrument_ind
+0001ba70: 6578 6573 5b0a 2020 2020 2020 2020 2020  exes[.          
+0001ba80: 2020 2020 2020 2020 2020 696e 7374 7275            instru
+0001ba90: 6d65 6e74 5d5d 202b 2070 6172 616d 6574  ment]] + paramet
+0001baa0: 6572 5f76 616c 7565 735b 276d 755f 2720  er_values['mu_' 
+0001bab0: 2b20 696e 7374 7275 6d65 6e74 5d0a 2020  + instrument].  
+0001bac0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+0001bad0: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
+0001bae0: 6c5b 696e 7374 7275 6d65 6e74 5d5b 2764  l[instrument]['d
+0001baf0: 6574 6572 6d69 6e69 7374 6963 5f76 6172  eterministic_var
+0001bb00: 6961 6e63 6573 275d 203d 2073 656c 662e  iances'] = self.
+0001bb10: 6572 726f 7273 5b0a 2020 2020 2020 2020  errors[.        
+0001bb20: 2020 2020 2020 2020 696e 7374 7275 6d65          instrume
+0001bb30: 6e74 5d2a 2a32 202b 2070 6172 616d 6574  nt]**2 + paramet
+0001bb40: 6572 5f76 616c 7565 735b 2773 6967 6d61  er_values['sigma
+0001bb50: 5f77 5f27 202b 2069 6e73 7472 756d 656e  _w_' + instrumen
+0001bb60: 745d 2a2a 320a 0a20 2020 2020 2020 2020  t]**2..         
+0001bb70: 2020 2069 6620 7365 6c66 2e6c 6d5f 626f     if self.lm_bo
+0001bb80: 6f6c 6561 6e5b 696e 7374 7275 6d65 6e74  olean[instrument
+0001bb90: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+0001bba0: 2020 2073 656c 662e 6d6f 6465 6c5b 696e     self.model[in
+0001bbb0: 7374 7275 6d65 6e74 5d5b 274c 4d27 5d20  strument]['LM'] 
+0001bbc0: 3d20 6e70 2e7a 6572 6f73 280a 2020 2020  = np.zeros(.    
+0001bbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bbe0: 7365 6c66 2e6e 6461 7461 706f 696e 7473  self.ndatapoints
+0001bbf0: 5f70 6572 5f69 6e73 7472 756d 656e 745b  _per_instrument[
+0001bc00: 696e 7374 7275 6d65 6e74 5d29 0a20 2020  instrument]).   
+0001bc10: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0001bc20: 2069 2069 6e20 7261 6e67 6528 7365 6c66   i in range(self
+0001bc30: 2e6c 6d5f 6e5b 696e 7374 7275 6d65 6e74  .lm_n[instrument
+0001bc40: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+0001bc50: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+0001bc60: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
+0001bc70: 4c4d 275d 202b 3d20 7061 7261 6d65 7465  LM'] += paramete
+0001bc80: 725f 7661 6c75 6573 5b0a 2020 2020 2020  r_values[.      
+0001bc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bca0: 2020 2774 6865 7461 2720 2b20 7374 7228    'theta' + str(
+0001bcb0: 6929 202b 2027 5f27 202b 0a20 2020 2020  i) + '_' +.     
+0001bcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bcd0: 2020 2073 656c 662e 7468 6574 615f 696e     self.theta_in
+0001bce0: 616d 655b 7374 7228 6929 2b69 6e73 7472  ame[str(i)+instr
+0001bcf0: 756d 656e 745d 5d20 2a20 7365 6c66 2e6c  ument]] * self.l
+0001bd00: 6d5f 6172 6775 6d65 6e74 735b 696e 7374  m_arguments[inst
+0001bd10: 7275 6d65 6e74 5d5b 3a2c 2069 5d0a 2020  rument][:, i].  
+0001bd20: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001bd30: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
+0001bd40: 656e 745d 5b27 6465 7465 726d 696e 6973  ent]['determinis
+0001bd50: 7469 6327 5d20 2b3d 2073 656c 662e 6d6f  tic'] += self.mo
+0001bd60: 6465 6c5b 0a20 2020 2020 2020 2020 2020  del[.           
+0001bd70: 2020 2020 2020 2020 2069 6e73 7472 756d           instrum
+0001bd80: 656e 745d 5b27 4c4d 275d 0a20 2020 2020  ent]['LM'].     
+0001bd90: 2020 2020 2020 2023 2049 6620 7468 6520         # If the 
+0001bda0: 6d6f 6465 6c20 756e 6465 7220 636f 6e73  model under cons
+0001bdb0: 6964 6572 6174 696f 6e20 6973 2061 2067  ideration is a g
+0001bdc0: 6c6f 6261 6c20 6d6f 6465 6c2c 2070 6f70  lobal model, pop
+0001bdd0: 756c 6174 6520 7468 6520 676c 6f62 616c  ulate the global
+0001bde0: 206d 6f64 656c 2064 6963 7469 6f6e 6172   model dictionar
+0001bdf0: 793a 0a20 2020 2020 2020 2020 2020 2069  y:.            i
+0001be00: 6620 7365 6c66 2e67 6c6f 6261 6c5f 6d6f  f self.global_mo
+0001be10: 6465 6c3a 0a20 2020 2020 2020 2020 2020  del:.           
+0001be20: 2020 2020 2073 656c 662e 6d6f 6465 6c5b       self.model[
+0001be30: 2767 6c6f 6261 6c27 5d5b 7365 6c66 2e69  'global'][self.i
+0001be40: 6e73 7472 756d 656e 745f 696e 6465 7865  nstrument_indexe
+0001be50: 735b 0a20 2020 2020 2020 2020 2020 2020  s[.             
+0001be60: 2020 2020 2020 2069 6e73 7472 756d 656e         instrumen
+0001be70: 745d 5d20 3d20 7365 6c66 2e6d 6f64 656c  t]] = self.model
+0001be80: 5b69 6e73 7472 756d 656e 745d 5b27 6465  [instrument]['de
+0001be90: 7465 726d 696e 6973 7469 6327 5d0a 2020  terministic'].  
+0001bea0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001beb0: 2065 7661 6c75 6174 655f 676c 6f62 616c   evaluate_global
+0001bec0: 5f65 7272 6f72 733a 0a20 2020 2020 2020  _errors:.       
+0001bed0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001bee0: 662e 6d6f 6465 6c5b 2767 6c6f 6261 6c5f  f.model['global_
+0001bef0: 7661 7269 616e 6365 7327 5d5b 7365 6c66  variances'][self
+0001bf00: 2e69 6e73 7472 756d 656e 745f 696e 6465  .instrument_inde
+0001bf10: 7865 735b 696e 7374 7275 6d65 6e74 5d5d  xes[instrument]]
+0001bf20: 203d 2073 656c 662e 7965 7272 5b73 656c   = self.yerr[sel
+0001bf30: 662e 696e 7374 7275 6d65 6e74 5f69 6e64  f.instrument_ind
+0001bf40: 6578 6573 5b69 6e73 7472 756d 656e 745d  exes[instrument]
+0001bf50: 5d2a 2a32 202b 205c 0a20 2020 2020 2020  ]**2 + \.       
 0001bf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf80: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001bf90: 6574 7572 6e5f 7661 723d 4661 6c73 652c  eturn_var=False,
-0001bfa0: 2072 6574 7572 6e5f 636f 763d 4661 6c73   return_cov=Fals
-0001bfb0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-0001bfc0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-0001bfd0: 6f64 656c 5b27 676c 6f62 616c 275d 2c20  odel['global'], 
-0001bfe0: 7365 6c66 2e6d 6f64 656c 5b0a 2020 2020  self.model[.    
-0001bff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c000: 2747 5027 5d2c 2073 656c 662e 6d6f 6465  'GP'], self.mode
-0001c010: 6c5b 2767 6c6f 6261 6c27 5d20 2b20 7365  l['global'] + se
-0001c020: 6c66 2e6d 6f64 656c 5b27 4750 275d 0a20  lf.model['GP']. 
-0001c030: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0001c040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c050: 2072 6574 7572 6e20 7365 6c66 2e6d 6f64   return self.mod
-0001c060: 656c 5b27 676c 6f62 616c 275d 0a20 2020  el['global'].   
-0001c070: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001c080: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
-0001c090: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
-0001c0a0: 6d65 6e74 5d5b 2747 5044 6574 7265 6e64  ment]['GPDetrend
-0001c0b0: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
-0001c0c0: 2020 2020 2372 6573 6964 7561 6c73 203d      #residuals =
-0001c0d0: 2073 656c 662e 7265 7369 6475 616c 7323   self.residuals#
-0001c0e0: 7365 6c66 2e64 6174 615b 696e 7374 7275  self.data[instru
-0001c0f0: 6d65 6e74 5d20 2d20 7365 6c66 2e6d 6f64  ment] - self.mod
-0001c100: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
-0001c110: 6465 7465 726d 696e 6973 7469 6327 5d0a  deterministic'].
-0001c120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c130: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
-0001c140: 696e 7374 7275 6d65 6e74 5d5b 276e 6f69  instrument]['noi
-0001c150: 7365 5f6d 6f64 656c 275d 2e73 6574 5f70  se_model'].set_p
-0001c160: 6172 616d 6574 6572 5f76 6563 746f 7228  arameter_vector(
-0001c170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c180: 2020 2020 2070 6172 616d 6574 6572 5f76       parameter_v
-0001c190: 616c 7565 7329 0a20 2020 2020 2020 2020  alues).         
-0001c1a0: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
-0001c1b0: 6c5b 696e 7374 7275 6d65 6e74 5d5b 2747  l[instrument]['G
-0001c1c0: 5027 5d20 3d20 7365 6c66 2e64 6963 7469  P'] = self.dicti
-0001c1d0: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
-0001c1e0: 5d5b 276e 6f69 7365 5f6d 6f64 656c 275d  ]['noise_model']
-0001c1f0: 2e47 502e 7072 6564 6963 7428 7365 6c66  .GP.predict(self
-0001c200: 2e72 6573 6964 7561 6c73 2c73 656c 662e  .residuals,self.
-0001c210: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
-0001c220: 756d 656e 745d 5b27 6e6f 6973 655f 6d6f  ument]['noise_mo
-0001c230: 6465 6c27 5d2e 582c 205c 0a20 2020 2020  del'].X, \.     
-0001c240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c260: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001c270: 5f76 6172 3d46 616c 7365 2c20 7265 7475  _var=False, retu
-0001c280: 726e 5f63 6f76 3d46 616c 7365 290a 2020  rn_cov=False).  
-0001c290: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0001c2a0: 7475 726e 2073 656c 662e 6d6f 6465 6c5b  turn self.model[
-0001c2b0: 696e 7374 7275 6d65 6e74 5d5b 2764 6574  instrument]['det
-0001c2c0: 6572 6d69 6e69 7374 6963 275d 2c20 7365  erministic'], se
-0001c2d0: 6c66 2e6d 6f64 656c 5b0a 2020 2020 2020  lf.model[.      
-0001c2e0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0001c2f0: 7374 7275 6d65 6e74 5d5b 2747 5027 5d2c  strument]['GP'],
-0001c300: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-0001c310: 7275 6d65 6e74 5d5b 0a20 2020 2020 2020  rument][.       
-0001c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c330: 2027 6465 7465 726d 696e 6973 7469 6327   'deterministic'
-0001c340: 5d20 2b20 7365 6c66 2e6d 6f64 656c 5b69  ] + self.model[i
-0001c350: 6e73 7472 756d 656e 745d 5b27 4750 275d  nstrument]['GP']
-0001c360: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0001c370: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0001c380: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-0001c390: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
-0001c3a0: 5b27 6465 7465 726d 696e 6973 7469 6327  ['deterministic'
-0001c3b0: 5d0a 0a20 2020 2064 6566 2065 7661 6c75  ]..    def evalu
-0001c3c0: 6174 655f 6d6f 6465 6c28 7365 6c66 2c20  ate_model(self, 
-0001c3d0: 696e 7374 7275 6d65 6e74 203d 204e 6f6e  instrument = Non
-0001c3e0: 652c 2070 6172 616d 6574 6572 5f76 616c  e, parameter_val
-0001c3f0: 7565 7320 3d20 4e6f 6e65 2c0a 2020 2020  ues = None,.    
-0001c400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c410: 2020 2020 2020 616c 6c5f 7361 6d70 6c65        all_sample
-0001c420: 7320 3d20 4661 6c73 652c 206e 7361 6d70  s = False, nsamp
-0001c430: 6c65 7320 3d20 3130 3030 2c20 7265 7475  les = 1000, retu
-0001c440: 726e 5f73 616d 706c 6573 203d 2046 616c  rn_samples = Fal
-0001c450: 7365 2c20 7420 3d20 4e6f 6e65 2c20 4750  se, t = None, GP
-0001c460: 7265 6772 6573 736f 7273 203d 204e 6f6e  regressors = Non
-0001c470: 652c 204c 4d72 6567 7265 7373 6f72 7320  e, LMregressors 
-0001c480: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0001c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4a0: 2020 7265 7475 726e 5f65 7272 203d 2046    return_err = F
-0001c4b0: 616c 7365 2c20 616c 7068 6120 3d20 302e  alse, alpha = 0.
-0001c4c0: 3638 2c20 7265 7475 726e 5f63 6f6d 706f  68, return_compo
-0001c4d0: 6e65 6e74 7320 3d20 4661 6c73 652c 2065  nents = False, e
-0001c4e0: 7661 6c75 6174 655f 7472 616e 7369 7420  valuate_transit 
-0001c4f0: 3d20 4661 6c73 6529 3a0a 2020 2020 2020  = False):.      
-0001c500: 2020 2222 220a 2020 2020 2020 2020 5468    """.        Th
-0001c510: 6973 2066 756e 6374 696f 6e20 6576 616c  is function eval
-0001c520: 7561 7465 7320 7468 6520 6375 7272 656e  uates the curren
-0001c530: 7420 6c63 206f 7220 7276 206d 6f64 656c  t lc or rv model
-0001c540: 2067 6976 656e 2061 2073 6574 206f 6620   given a set of 
-0001c550: 706f 7374 6572 696f 7220 6469 7374 7269  posterior distri
-0001c560: 6275 7469 6f6e 2073 616d 706c 6573 2061  bution samples a
-0001c570: 6e64 2f6f 7220 7061 7261 6d65 7465 7220  nd/or parameter 
-0001c580: 7661 6c75 6573 2e20 4578 616d 706c 6520  values. Example 
-0001c590: 7573 6167 653a 0a0a 2020 2020 2020 2020  usage:..        
-0001c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c5b0: 2020 2020 203e 3e3e 2064 6174 6173 6574       >>> dataset
-0001c5c0: 203d 206a 756c 6965 742e 6c6f 6164 2870   = juliet.load(p
-0001c5d0: 7269 6f72 733d 7072 696f 7273 2c20 745f  riors=priors, t_
-0001c5e0: 6c63 203d 2074 696d 6573 2c20 795f 6c63  lc = times, y_lc
-0001c5f0: 203d 2066 6c75 7865 732c 2079 6572 725f   = fluxes, yerr_
-0001c600: 6c63 203d 2066 6c75 7865 735f 6572 726f  lc = fluxes_erro
-0001c610: 7229 0a20 2020 2020 2020 2020 2020 2020  r).             
-0001c620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c630: 3e3e 3e20 7265 7375 6c74 7320 3d20 6461  >>> results = da
-0001c640: 7461 7365 742e 6669 7428 290a 2020 2020  taset.fit().    
-0001c650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c660: 2020 2020 2020 2020 203e 3e3e 2074 7261           >>> tra
-0001c670: 6e73 6974 5f6d 6f64 656c 2c20 6572 726f  nsit_model, erro
-0001c680: 7236 385f 7570 2c20 6572 726f 7236 385f  r68_up, error68_
-0001c690: 646f 776e 203d 2072 6573 756c 7473 2e6c  down = results.l
-0001c6a0: 632e 6576 616c 7561 7465 2827 5445 5353  c.evaluate('TESS
-0001c6b0: 272c 2072 6574 7572 6e5f 6572 723d 5472  ', return_err=Tr
-0001c6c0: 7565 290a 0a20 2020 2020 2020 204f 723a  ue)..        Or:
-0001c6d0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001c6e0: 2020 2020 2020 2020 2020 2020 2020 203e                 >
-0001c6f0: 3e3e 2064 6174 6173 6574 203d 206a 756c  >> dataset = jul
-0001c700: 6965 742e 6c6f 6164 2870 7269 6f72 733d  iet.load(priors=
-0001c710: 7072 696f 7273 2c20 745f 7276 203d 2074  priors, t_rv = t
-0001c720: 696d 6573 2c20 795f 7276 203d 2066 6c75  imes, y_rv = flu
-0001c730: 7865 732c 2079 6572 725f 7276 203d 2066  xes, yerr_rv = f
-0001c740: 6c75 7865 735f 6572 726f 7229 0a20 2020  luxes_error).   
-0001c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c760: 2020 2020 2020 2020 2020 3e3e 3e20 7265            >>> re
-0001c770: 7375 6c74 7320 3d20 6461 7461 7365 742e  sults = dataset.
-0001c780: 6669 7428 290a 2020 2020 2020 2020 2020  fit().          
-0001c790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c7a0: 2020 203e 3e3e 2072 765f 6d6f 6465 6c2c     >>> rv_model,
-0001c7b0: 2065 7272 6f72 3638 5f75 702c 2065 7272   error68_up, err
-0001c7c0: 6f72 3638 5f64 6f77 6e20 3d20 7265 7375  or68_down = resu
-0001c7d0: 6c74 732e 7276 2e65 7661 6c75 6174 6528  lts.rv.evaluate(
-0001c7e0: 2746 4552 4f53 272c 2072 6574 7572 6e5f  'FEROS', return_
-0001c7f0: 6572 723d 5472 7565 290a 0a20 2020 2020  err=True)..     
-0001c800: 2020 203a 7061 7261 6d20 696e 7374 7275     :param instru
-0001c810: 6d65 6e74 3a20 286f 7074 696f 6e61 6c2c  ment: (optional,
-0001c820: 2073 7472 696e 6729 0a20 2020 2020 2020   string).       
-0001c830: 2049 6e73 7472 756d 656e 7420 7468 6520   Instrument the 
-0001c840: 7573 6572 2077 616e 7473 2074 6f20 6576  user wants to ev
-0001c850: 616c 7561 7465 2074 6865 206d 6f64 656c  aluate the model
-0001c860: 206f 6e2e 2049 7420 6973 2065 7870 6563   on. It is expec
-0001c870: 7465 6420 746f 2062 6520 6769 7665 6e20  ted to be given 
-0001c880: 666f 7220 6e6f 6e2d 676c 6f62 616c 206d  for non-global m
-0001c890: 6f64 656c 732c 206e 6f74 206e 6563 6573  odels, not neces
-0001c8a0: 7361 7279 2066 6f72 2067 6c6f 6261 6c20  sary for global 
-0001c8b0: 6d6f 6465 6c73 2e0a 0a20 2020 2020 2020  models...       
-0001c8c0: 203a 7061 7261 6d20 7061 7261 6d65 7465   :param paramete
-0001c8d0: 725f 7661 6c75 6573 3a20 286f 7074 696f  r_values: (optio
-0001c8e0: 6e61 6c2c 2064 6963 7429 0a20 2020 2020  nal, dict).     
-0001c8f0: 2020 2044 6963 7469 6f6e 6172 7920 636f     Dictionary co
-0001c900: 6e74 6169 6e69 6e67 2073 616d 706c 6573  ntaining samples
-0001c910: 206f 6620 7468 6520 706f 7374 6572 696f   of the posterio
-0001c920: 7220 6469 7374 7269 6275 7469 6f6e 206f  r distribution o
-0001c930: 722c 206d 6f72 6520 6765 6e65 7261 6c6c  r, more generall
-0001c940: 792c 2070 6172 616d 6574 6572 2076 616c  y, parameter val
-0001c950: 7565 7369 6e20 6974 2e20 4561 6368 206b  uesin it. Each k
-0001c960: 6579 2069 7320 6120 7061 7261 6d65 7465  ey is a paramete
-0001c970: 7220 6e61 6d65 2028 652e 672e 2027 705f  r name (e.g. 'p_
-0001c980: 7031 272c 0a20 2020 2020 2020 2027 7131  p1',.        'q1
-0001c990: 5f54 4553 5327 2c20 6574 632e 292c 2061  _TESS', etc.), a
-0001c9a0: 6e64 2069 6e73 6964 6520 6561 6368 206f  nd inside each o
-0001c9b0: 6620 7468 6f73 6520 6b65 7973 2061 6e20  f those keys an 
-0001c9c0: 6172 7261 7920 6f66 204e 2073 616d 706c  array of N sampl
-0001c9d0: 6573 2069 7320 6578 7065 6374 6564 2028  es is expected (
-0001c9e0: 692e 652e 2c20 7061 7261 6d65 7465 725f  i.e., parameter_
-0001c9f0: 7661 6c75 6573 5b27 705f 7031 275d 2069  values['p_p1'] i
-0001ca00: 7320 616e 2061 7272 6179 206f 6620 6c65  s an array of le
-0001ca10: 6e67 7468 204e 292e 2054 6865 0a20 2020  ngth N). The.   
-0001ca20: 2020 2020 2069 6e64 6578 6573 2068 6176       indexes hav
-0001ca30: 6520 746f 2062 6520 636f 6e73 6973 7465  e to be consiste
-0001ca40: 6e74 2062 6574 7765 656e 2064 6966 6665  nt between diffe
-0001ca50: 7265 6e74 2070 6172 616d 6574 6572 732e  rent parameters.
-0001ca60: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001ca70: 2061 6c6c 5f73 616d 706c 6573 3a20 286f   all_samples: (o
-0001ca80: 7074 696f 6e61 6c2c 2062 6f6f 6c65 616e  ptional, boolean
-0001ca90: 290a 2020 2020 2020 2020 4966 2054 7275  ).        If Tru
-0001caa0: 652c 2061 6c6c 2070 6f73 7465 7269 6f72  e, all posterior
-0001cab0: 2073 616d 706c 6573 2077 696c 6c20 6265   samples will be
-0001cac0: 2075 7365 6420 746f 2065 7661 6c75 6174   used to evaluat
-0001cad0: 6520 7468 6520 6d6f 6465 6c2e 2044 6566  e the model. Def
-0001cae0: 6175 6c74 2069 7320 4661 6c73 652e 0a0a  ault is False...
-0001caf0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-0001cb00: 7361 6d70 6c65 733a 2028 6f70 7469 6f6e  samples: (option
-0001cb10: 616c 2c20 696e 7429 0a20 2020 2020 2020  al, int).       
-0001cb20: 204e 756d 6265 7220 6f66 2070 6f73 7465   Number of poste
-0001cb30: 7269 6f72 2073 616d 706c 6573 2074 6f20  rior samples to 
-0001cb40: 6265 2075 7365 6420 746f 2065 7661 6c75  be used to evalu
-0001cb50: 6174 6520 7468 6520 6d6f 6465 6c2e 2044  ate the model. D
-0001cb60: 6566 6175 6c74 2069 7320 3130 3030 2028  efault is 1000 (
-0001cb70: 6e6f 7465 2065 6163 6820 6361 6c6c 2074  note each call t
-0001cb80: 6f20 7468 6973 2066 756e 6374 696f 6e20  o this function 
-0001cb90: 7769 6c6c 2073 616d 706c 6520 606e 7361  will sample `nsa
-0001cba0: 6d70 6c65 7360 2064 6966 6665 7265 6e74  mples` different
-0001cbb0: 2073 616d 706c 6573 0a20 2020 2020 2020   samples.       
-0001cbc0: 2066 726f 6d20 7468 6520 706f 7374 6572   from the poster
-0001cbd0: 696f 722c 2073 6f20 6e6f 2074 776f 2063  ior, so no two c
-0001cbe0: 616c 6c73 2061 7265 2065 7861 6374 6c79  alls are exactly
-0001cbf0: 2074 6865 2073 616d 6529 2e0a 0a20 2020   the same)...   
-0001cc00: 2020 2020 203a 7061 7261 6d20 7265 7475       :param retu
-0001cc10: 726e 5f73 616d 706c 6573 3a20 286f 7074  rn_samples: (opt
-0001cc20: 696f 6e61 6c2c 2062 6f6f 6c65 616e 290a  ional, boolean).
-0001cc30: 2020 2020 2020 2020 426f 6f6c 6561 6e20          Boolean 
-0001cc40: 696e 6469 6361 7469 6e67 2077 6865 7468  indicating wheth
-0001cc50: 6572 2074 6865 2075 7365 7220 7761 6e74  er the user want
-0001cc60: 7320 7468 6520 706f 7374 6572 696f 7220  s the posterior 
-0001cc70: 6d6f 6465 6c20 7361 6d70 6c65 7320 2869  model samples (i
-0001cc80: 2e65 2e2c 2074 6865 206d 6f64 656c 7320  .e., the models 
-0001cc90: 6576 616c 7561 7465 6420 696e 2065 6163  evaluated in eac
-0001cca0: 6820 6f66 2074 6865 2070 6f73 7465 7269  h of the posteri
-0001ccb0: 6f72 2073 616d 706c 6520 6472 6177 7329  or sample draws)
-0001ccc0: 2074 6f20 6265 2072 6574 7572 6e65 642e   to be returned.
-0001ccd0: 2044 6566 6175 6c74 0a20 2020 2020 2020   Default.       
-0001cce0: 2069 7320 4661 6c73 652e 0a0a 2020 2020   is False...    
-0001ccf0: 2020 2020 3a70 6172 616d 2074 3a20 286f      :param t: (o
-0001cd00: 7074 696f 6e61 6c2c 206e 756d 7079 2061  ptional, numpy a
-0001cd10: 7272 6179 290a 2020 2020 2020 2020 4172  rray).        Ar
-0001cd20: 7261 7920 7769 7468 2074 6865 2074 696d  ray with the tim
-0001cd30: 6573 2061 7420 7768 6963 6820 7468 6520  es at which the 
-0001cd40: 6d6f 6465 6c20 7761 6e74 7320 746f 2062  model wants to b
-0001cd50: 6520 6576 616c 7561 7465 642e 0a0a 2020  e evaluated...  
-0001cd60: 2020 2020 2020 3a70 6172 616d 2047 5052        :param GPR
-0001cd70: 6567 7265 7373 6f72 733a 2028 6f70 7469  egressors: (opti
-0001cd80: 6f6e 616c 2c20 6e75 6d70 7920 6172 7261  onal, numpy arra
-0001cd90: 7929 0a20 2020 2020 2020 2041 7272 6179  y).        Array
-0001cda0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-0001cdb0: 4750 2052 6567 7265 7373 6f72 7320 6f6e  GP Regressors on
-0001cdc0: 746f 2077 6869 6368 2074 6f20 6576 616c  to which to eval
-0001cdd0: 7561 7465 2074 6865 206d 6f64 656c 732e  uate the models.
-0001cde0: 2044 696d 656e 7369 6f6e 7320 6d75 7374   Dimensions must
-0001cdf0: 2062 6520 636f 6e73 6973 7465 6e74 2077   be consistent w
-0001ce00: 6974 6820 696e 7075 7420 6074 602e 2049  ith input `t`. I
-0001ce10: 6620 6d6f 6465 6c20 6973 2067 6c6f 6261  f model is globa
-0001ce20: 6c2c 2074 6869 7320 6e65 6564 7320 746f  l, this needs to
-0001ce30: 2062 6520 6120 6469 6374 696f 6e61 7279   be a dictionary
-0001ce40: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-0001ce50: 6d20 4c4d 5265 6772 6573 736f 7273 3a20  m LMRegressors: 
-0001ce60: 286f 7074 696f 6e61 6c2c 206e 756d 7079  (optional, numpy
-0001ce70: 2061 7272 6179 206f 7220 6469 6374 696f   array or dictio
-0001ce80: 6e61 7279 290a 2020 2020 2020 2020 4966  nary).        If
-0001ce90: 2074 6865 206d 6f64 656c 2069 7320 6e6f   the model is no
-0001cea0: 7420 676c 6f62 616c 2c20 7468 6973 2069  t global, this i
-0001ceb0: 7320 616e 2061 7272 6179 2063 6f6e 7461  s an array conta
-0001cec0: 696e 696e 6720 7468 6520 4c69 6e65 6172  ining the Linear
-0001ced0: 2052 6567 7265 7373 6f72 7320 6f6e 746f   Regressors onto
-0001cee0: 2077 6869 6368 2074 6f20 6576 616c 7561   which to evalua
-0001cef0: 7465 2074 6865 206d 6f64 656c 2066 6f72  te the model for
-0001cf00: 2074 6865 2069 6e70 7574 2069 6e73 7472   the input instr
-0001cf10: 756d 656e 742e 0a20 2020 2020 2020 2044  ument..        D
-0001cf20: 696d 656e 7369 6f6e 7320 6d75 7374 2062  imensions must b
-0001cf30: 6520 636f 6e73 6973 7465 6e74 2077 6974  e consistent wit
-0001cf40: 6820 696e 7075 7420 6074 602e 2049 6620  h input `t`. If 
-0001cf50: 6d6f 6465 6c20 6973 2067 6c6f 6261 6c2c  model is global,
-0001cf60: 2074 6869 7320 6e65 6564 7320 746f 2062   this needs to b
-0001cf70: 6520 6120 6469 6374 696f 6e61 7279 2e0a  e a dictionary..
-0001cf80: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001cf90: 7265 7475 726e 5f65 7272 3a20 286f 7074  return_err: (opt
-0001cfa0: 696f 6e61 6c2c 2062 6f6f 6c65 616e 290a  ional, boolean).
-0001cfb0: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
-0001cfc0: 2074 6869 7320 7265 7475 726e 7320 7468   this returns th
-0001cfd0: 6520 6372 6564 6962 696c 6974 7920 696e  e credibility in
-0001cfe0: 7465 7276 616c 206f 6e20 7468 6520 6576  terval on the ev
-0001cff0: 616c 7561 7465 6420 6d6f 6465 6c2e 2044  aluated model. D
-0001d000: 6566 6175 6c74 2063 7265 6469 6269 6c69  efault credibili
-0001d010: 7479 2069 6e74 6572 7661 6c20 6973 2036  ty interval is 6
-0001d020: 3825 2e0a 0a20 2020 2020 2020 203a 7061  8%...        :pa
-0001d030: 7261 6d20 616c 7068 613a 2028 6f70 7469  ram alpha: (opti
-0001d040: 6f6e 616c 2c20 646f 7562 6c65 290a 2020  onal, double).  
-0001d050: 2020 2020 2020 4372 6564 6962 696c 6974        Credibilit
-0001d060: 7920 696e 7465 7276 616c 2066 6f72 2072  y interval for r
-0001d070: 6574 7572 6e5f 6572 722e 2044 6566 6175  eturn_err. Defau
-0001d080: 6c74 2069 7320 302e 3638 2c20 692e 652e  lt is 0.68, i.e.
-0001d090: 2c20 7468 6520 3638 2520 6372 6564 6962  , the 68% credib
-0001d0a0: 696c 6974 7920 696e 7465 7276 616c 2e0a  ility interval..
-0001d0b0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001d0c0: 7265 7475 726e 5f63 6f6d 706f 6e65 6e74  return_component
-0001d0d0: 733a 2028 6f70 7469 6f6e 616c 2c20 626f  s: (optional, bo
-0001d0e0: 6f6c 6561 6e29 0a20 2020 2020 2020 2049  olean).        I
-0001d0f0: 6620 5472 7565 2c20 6561 6368 2063 6f6d  f True, each com
-0001d100: 706f 6e65 6e74 206f 6620 7468 6520 6d6f  ponent of the mo
-0001d110: 6465 6c20 6973 2072 6574 7572 6e65 6420  del is returned 
-0001d120: 2869 2e65 2e2c 2074 6865 2047 6175 7373  (i.e., the Gauss
-0001d130: 6961 6e20 5072 6f63 6573 7320 636f 6d70  ian Process comp
-0001d140: 6f6e 656e 742c 2074 6865 204c 696e 6561  onent, the Linea
-0001d150: 7220 4d6f 6465 6c20 636f 6d70 6f6e 656e  r Model componen
-0001d160: 742c 2065 7463 2e29 2e0a 0a20 2020 2020  t, etc.)...     
-0001d170: 2020 203a 7061 7261 6d20 6576 616c 7561     :param evalua
-0001d180: 7465 5f74 7261 6e73 6974 3a20 286f 7074  te_transit: (opt
-0001d190: 696f 6e61 6c2c 2062 6f6f 6c65 616e 290a  ional, boolean).
-0001d1a0: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
-0001d1b0: 2074 6865 2066 756e 6374 696f 6e20 6576   the function ev
-0001d1c0: 616c 7561 7465 7320 6f6e 6c79 2074 6865  aluates only the
-0001d1d0: 2074 7261 6e73 6974 206d 6f64 656c 2061   transit model a
-0001d1e0: 6e64 206e 6f74 2074 6865 2047 6175 7373  nd not the Gauss
-0001d1f0: 6961 6e20 5072 6f63 6573 7320 6f72 204c  ian Process or L
-0001d200: 696e 6561 7220 4d6f 6465 6c20 636f 6d70  inear Model comp
-0001d210: 6f6e 656e 7473 2e0a 0a20 2020 2020 2020  onents...       
-0001d220: 203a 7265 7475 726e 733a 2042 7920 6465   :returns: By de
-0001d230: 6661 756c 742c 2074 6865 2066 756e 6374  fault, the funct
-0001d240: 696f 6e20 7265 7475 726e 7320 7468 6520  ion returns the 
-0001d250: 6d65 6469 616e 206d 6f64 656c 2061 7320  median model as 
-0001d260: 6576 616c 7561 7465 6420 7769 7468 2074  evaluated with t
-0001d270: 6865 2070 6f73 7465 7269 6f72 2073 616d  he posterior sam
-0001d280: 706c 6573 2e20 4465 7065 6e64 696e 6720  ples. Depending 
-0001d290: 6f6e 2074 6865 206f 7074 696f 6e73 2063  on the options c
-0001d2a0: 686f 7365 6e20 6279 2074 6865 2075 7365  hosen by the use
-0001d2b0: 722c 2074 6869 7320 6361 6e20 7265 7475  r, this can retu
-0001d2c0: 726e 2075 7020 746f 2035 2065 6c65 6d65  rn up to 5 eleme
-0001d2d0: 6e74 7320 2869 6e20 7468 6174 206f 7264  nts (in that ord
-0001d2e0: 6572 293a 2060 6d6f 6465 6c5f 7361 6d70  er): `model_samp
-0001d2f0: 6c65 7360 2c20 606d 6564 6961 6e5f 6d6f  les`, `median_mo
-0001d300: 6465 6c60 2c20 6075 7070 6572 5f43 4960  del`, `upper_CI`
-0001d310: 2c20 606c 6f77 6572 5f43 4960 2061 6e64  , `lower_CI` and
-0001d320: 2060 636f 6d70 6f6e 656e 7473 602e 2054   `components`. T
-0001d330: 6865 2066 6972 7374 2069 7320 616e 2061  he first is an a
-0001d340: 7272 6179 2077 6974 6820 616c 6c20 7468  rray with all th
-0001d350: 6520 6d6f 6465 6c20 7361 6d70 6c65 7320  e model samples 
-0001d360: 6173 2065 7661 6c75 6174 6564 2066 726f  as evaluated fro
-0001d370: 6d20 7468 6520 706f 7374 6572 696f 722e  m the posterior.
-0001d380: 2054 6865 2073 6563 6f6e 6420 6973 2074   The second is t
-0001d390: 6865 206d 6564 6961 6e20 6d6f 6465 6c2e  he median model.
-0001d3a0: 2054 6865 2074 6869 7264 2061 6e64 2066   The third and f
-0001d3b0: 6f75 7274 6820 6172 6520 7468 6520 7570  ourth are the up
-0001d3c0: 7070 6572 2061 6e64 206c 6f77 6572 2043  pper and lower C
-0001d3d0: 7265 6469 6269 6c69 7479 2049 6e74 6572  redibility Inter
-0001d3e0: 7661 6c73 2c20 616e 6420 7468 6520 6c61  vals, and the la
-0001d3f0: 7474 6572 2069 7320 6120 6469 6374 696f  tter is a dictio
-0001d400: 6e61 7279 2077 6974 6820 7468 6520 6d6f  nary with the mo
-0001d410: 6465 6c20 636f 6d70 6f6e 656e 7473 2e0a  del components..
-0001d420: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001d430: 2020 2020 2069 6620 6576 616c 7561 7465       if evaluate
-0001d440: 5f74 7261 6e73 6974 3a0a 2020 2020 2020  _transit:.      
-0001d450: 2020 2020 2020 6966 2073 656c 662e 6d6f        if self.mo
-0001d460: 6465 6c74 7970 6520 213d 2027 6c63 273a  deltype != 'lc':
-0001d470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d480: 2072 6169 7365 2045 7863 6570 7469 6f6e   raise Exception
-0001d490: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001d4a0: 2020 2020 2020 2254 7279 696e 6720 746f        "Trying to
-0001d4b0: 2065 7661 6c75 6174 6520 6120 7472 616e   evaluate a tran
-0001d4c0: 7369 7420 2865 7661 6c75 6174 655f 7472  sit (evaluate_tr
-0001d4d0: 616e 7369 7420 3d20 5472 7565 2920 696e  ansit = True) in
-0001d4e0: 2061 206e 6f6e 2d6c 6967 6874 6375 7276   a non-lightcurv
-0001d4f0: 6520 6d6f 6465 6c20 6973 206e 6f74 2061  e model is not a
-0001d500: 6c6c 6f77 6564 2e22 0a20 2020 2020 2020  llowed.".       
-0001d510: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0001d520: 2020 2020 2020 2020 2320 5361 7665 204c          # Save L
-0001d530: 4d20 616e 6420 4750 2062 6f6f 6c65 616e  M and GP boolean
-0001d540: 732c 2074 7572 6e20 7468 656d 206f 6666  s, turn them off
-0001d550: 3a0a 2020 2020 2020 2020 2020 2020 7472  :.            tr
-0001d560: 7565 5f6c 6d5f 626f 6f6c 6561 6e20 3d20  ue_lm_boolean = 
-0001d570: 7365 6c66 2e6c 6d5f 626f 6f6c 6561 6e5b  self.lm_boolean[
-0001d580: 696e 7374 7275 6d65 6e74 5d0a 2020 2020  instrument].    
-0001d590: 2020 2020 2020 2020 7365 6c66 2e6c 6d5f          self.lm_
-0001d5a0: 626f 6f6c 6561 6e5b 696e 7374 7275 6d65  boolean[instrume
-0001d5b0: 6e74 5d20 3d20 4661 6c73 650a 2020 2020  nt] = False.    
-0001d5c0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001d5d0: 676c 6f62 616c 5f6d 6f64 656c 3a0a 2020  global_model:.  
-0001d5e0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-0001d5f0: 7565 5f67 705f 626f 6f6c 6561 6e20 3d20  ue_gp_boolean = 
-0001d600: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
-0001d610: 2767 6c6f 6261 6c5f 6d6f 6465 6c27 5d5b  'global_model'][
-0001d620: 2747 5044 6574 7265 6e64 275d 0a20 2020  'GPDetrend'].   
-0001d630: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001d640: 662e 6469 6374 696f 6e61 7279 5b27 676c  f.dictionary['gl
-0001d650: 6f62 616c 5f6d 6f64 656c 275d 5b27 4750  obal_model']['GP
-0001d660: 4465 7472 656e 6427 5d20 3d20 4661 6c73  Detrend'] = Fals
-0001d670: 650a 2020 2020 2020 2020 2020 2020 656c  e.            el
-0001d680: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0001d690: 2020 2020 7472 7565 5f67 705f 626f 6f6c      true_gp_bool
-0001d6a0: 6561 6e20 3d20 7365 6c66 2e64 6963 7469  ean = self.dicti
-0001d6b0: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
-0001d6c0: 5d5b 2747 5044 6574 7265 6e64 275d 0a20  ]['GPDetrend']. 
-0001d6d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001d6e0: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
-0001d6f0: 6e73 7472 756d 656e 745d 5b27 4750 4465  nstrument]['GPDe
-0001d700: 7472 656e 6427 5d20 3d20 4661 6c73 650a  trend'] = False.
-0001d710: 0a20 2020 2020 2020 2023 2049 6620 6e6f  .        # If no
-0001d720: 2069 6e73 7472 756d 656e 7420 6973 2067   instrument is g
-0001d730: 6976 656e 2c20 6173 7375 6d65 2075 7365  iven, assume use
-0001d740: 7220 7761 6e74 7320 6120 676c 6f62 616c  r wants a global
-0001d750: 206d 6f64 656c 2065 7661 6c75 6174 696f   model evaluatio
-0001d760: 6e3a 0a20 2020 2020 2020 2069 6620 696e  n:.        if in
-0001d770: 7374 7275 6d65 6e74 2069 7320 4e6f 6e65  strument is None
-0001d780: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0001d790: 206e 6f74 2073 656c 662e 676c 6f62 616c   not self.global
-0001d7a0: 5f6d 6f64 656c 3a0a 2020 2020 2020 2020  _model:.        
-0001d7b0: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
-0001d7c0: 6365 7074 696f 6e28 0a20 2020 2020 2020  ception(.       
-0001d7d0: 2020 2020 2020 2020 2020 2020 2022 496e               "In
-0001d7e0: 7075 7420 6572 726f 723a 2061 6e20 696e  put error: an in
-0001d7f0: 7374 7275 6d65 6e74 2068 6173 2074 6f20  strument has to 
-0001d800: 6265 2064 6566 696e 6564 2066 6f72 206e  be defined for n
-0001d810: 6f6e 2d67 6c6f 6261 6c20 6d6f 6465 6c73  on-global models
-0001d820: 2069 6e20 6f72 6465 7220 746f 2065 7661   in order to eva
-0001d830: 6c75 6174 6520 7468 6520 6d6f 6465 6c2e  luate the model.
-0001d840: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0001d850: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
-0001d860: 7365 6c66 2e6d 6f64 656c 7479 7065 203d  self.modeltype =
-0001d870: 3d20 276c 6327 3a0a 0a20 2020 2020 2020  = 'lc':..       
-0001d880: 2020 2020 206e 7265 7361 6d70 6c69 6e67       nresampling
-0001d890: 203d 2073 656c 662e 6469 6374 696f 6e61   = self.dictiona
-0001d8a0: 7279 5b69 6e73 7472 756d 656e 745d 2e67  ry[instrument].g
-0001d8b0: 6574 2827 6e72 6573 616d 706c 696e 6727  et('nresampling'
-0001d8c0: 290a 2020 2020 2020 2020 2020 2020 6574  ).            et
-0001d8d0: 7265 7361 6d70 6c69 6e67 203d 2073 656c  resampling = sel
-0001d8e0: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
-0001d8f0: 7472 756d 656e 745d 2e67 6574 2827 6578  trument].get('ex
-0001d900: 7074 696d 6572 6573 616d 706c 696e 6727  ptimeresampling'
-0001d910: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
-0001d920: 6620 6e6f 7420 7365 6c66 2e64 6963 7469  f not self.dicti
-0001d930: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
-0001d940: 5d5b 2754 7261 6e73 6974 4669 7443 6174  ]['TransitFitCat
-0001d950: 776f 6d61 6e27 5d3a 0a0a 2020 2020 2020  woman']:..      
-0001d960: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0001d970: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
-0001d980: 7472 756d 656e 745d 5b27 5472 616e 7369  trument]['Transi
-0001d990: 7446 6974 275d 3a0a 2020 2020 2020 2020  tFit']:.        
-0001d9a0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-0001d9b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001d9c0: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
-0001d9d0: 6e74 5d5b 2770 6172 616d 7327 5d2c 205b  nt]['params'], [
-0001d9e0: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
-0001d9f0: 756d 656e 745d 5b27 6d27 5d2c 5f5d 203d  ument]['m'],_] =
-0001da00: 2069 6e69 745f 6261 746d 616e 2873 656c   init_batman(sel
-0001da10: 662e 7469 6d65 735b 696e 7374 7275 6d65  f.times[instrume
-0001da20: 6e74 5d2c 2073 656c 662e 6469 6374 696f  nt], self.dictio
-0001da30: 6e61 7279 5b69 6e73 7472 756d 656e 745d  nary[instrument]
-0001da40: 5b27 6c64 6c61 7727 5d2c 0a20 2020 2020  ['ldlaw'],.     
-0001da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001daa0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001dab0: 7265 7361 6d70 6c69 6e67 3d6e 7265 7361  resampling=nresa
-0001dac0: 6d70 6c69 6e67 2c20 6574 7265 7361 6d70  mpling, etresamp
-0001dad0: 6c69 6e67 3d65 7472 6573 616d 706c 696e  ling=etresamplin
-0001dae0: 6729 0a20 2020 2020 2020 2020 2020 2020  g).             
-0001daf0: 2020 2065 6c69 6620 7365 6c66 2e64 6963     elif self.dic
-0001db00: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
-0001db10: 6e74 5d5b 2745 636c 6970 7365 4669 7427  nt]['EclipseFit'
-0001db20: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-0001db30: 2020 200a 2020 2020 2020 2020 2020 2020     .            
-0001db40: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
-0001db50: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
-0001db60: 7061 7261 6d73 275d 2c20 5b5f 2c73 656c  params'], [_,sel
-0001db70: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
-0001db80: 6e74 5d5b 276d 275d 5d20 3d20 696e 6974  nt]['m']] = init
-0001db90: 5f62 6174 6d61 6e28 7365 6c66 2e74 696d  _batman(self.tim
-0001dba0: 6573 5b69 6e73 7472 756d 656e 745d 2c20  es[instrument], 
-0001dbb0: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
-0001dbc0: 696e 7374 7275 6d65 6e74 5d5b 276c 646c  instrument]['ldl
-0001dbd0: 6177 275d 2c0a 2020 2020 2020 2020 2020  aw'],.          
-0001dbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc30: 2020 2020 2020 2020 2020 6e72 6573 616d            nresam
-0001dc40: 706c 696e 673d 6e72 6573 616d 706c 696e  pling=nresamplin
-0001dc50: 672c 2065 7472 6573 616d 706c 696e 673d  g, etresampling=
-0001dc60: 6574 7265 7361 6d70 6c69 6e67 290a 2020  etresampling).  
-0001dc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc80: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
-0001dc90: 2020 2065 6c69 6620 7365 6c66 2e64 6963     elif self.dic
-0001dca0: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
-0001dcb0: 6e74 5d5b 2754 7261 6e45 636c 4669 7427  nt]['TranEclFit'
-0001dcc0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-0001dcd0: 2020 200a 2020 2020 2020 2020 2020 2020     .            
-0001dce0: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
-0001dcf0: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
-0001dd00: 7061 7261 6d73 275d 2c20 7365 6c66 2e6d  params'], self.m
-0001dd10: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
-0001dd20: 5b27 6d27 5d20 3d20 696e 6974 5f62 6174  ['m'] = init_bat
-0001dd30: 6d61 6e28 7365 6c66 2e74 696d 6573 5b69  man(self.times[i
-0001dd40: 6e73 7472 756d 656e 745d 2c20 7365 6c66  nstrument], self
-0001dd50: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
-0001dd60: 7275 6d65 6e74 5d5b 276c 646c 6177 275d  rument]['ldlaw']
-0001dd70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001dd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ddb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ddc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ddd0: 2020 2020 2020 6e72 6573 616d 706c 696e        nresamplin
-0001dde0: 673d 6e72 6573 616d 706c 696e 672c 2065  g=nresampling, e
-0001ddf0: 7472 6573 616d 706c 696e 673d 6574 7265  tresampling=etre
-0001de00: 7361 6d70 6c69 6e67 290a 2020 2020 2020  sampling).      
-0001de10: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001de20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001de30: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
-0001de40: 745d 5b27 7061 7261 6d73 275d 2c20 7365  t]['params'], se
-0001de50: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
-0001de60: 656e 745d 5b27 6d27 5d20 3d20 696e 6974  ent]['m'] = init
-0001de70: 5f63 6174 776f 6d61 6e28 7365 6c66 2e74  _catwoman(self.t
-0001de80: 696d 6573 5b69 6e73 7472 756d 656e 745d  imes[instrument]
-0001de90: 2c20 7365 6c66 2e64 6963 7469 6f6e 6172  , self.dictionar
-0001dea0: 795b 696e 7374 7275 6d65 6e74 5d5b 276c  y[instrument]['l
-0001deb0: 646c 6177 275d 2c0a 2020 2020 2020 2020  dlaw'],.        
+0001bf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bfb0: 2020 2070 6172 616d 6574 6572 5f76 616c     parameter_val
+0001bfc0: 7565 735b 2773 6967 6d61 5f77 5f27 2b69  ues['sigma_w_'+i
+0001bfd0: 6e73 7472 756d 656e 745d 2a2a 320a 0a20  nstrument]**2.. 
+0001bfe0: 2020 2064 6566 2067 6574 5f47 505f 706c     def get_GP_pl
+0001bff0: 7573 5f64 6574 6572 6d69 6e69 7374 6963  us_deterministic
+0001c000: 5f6d 6f64 656c 2873 656c 662c 0a20 2020  _model(self,.   
+0001c010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c030: 2020 2020 2070 6172 616d 6574 6572 5f76       parameter_v
+0001c040: 616c 7565 732c 0a20 2020 2020 2020 2020  alues,.         
+0001c050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c060: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001c070: 6e73 7472 756d 656e 743d 4e6f 6e65 293a  nstrument=None):
+0001c080: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+0001c090: 662e 676c 6f62 616c 5f6d 6f64 656c 3a0a  f.global_model:.
+0001c0a0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001c0b0: 656c 662e 6469 6374 696f 6e61 7279 5b27  elf.dictionary['
+0001c0c0: 676c 6f62 616c 5f6d 6f64 656c 275d 5b27  global_model']['
+0001c0d0: 4750 4465 7472 656e 6427 5d3a 0a20 2020  GPDetrend']:.   
+0001c0e0: 2020 2020 2020 2020 2020 2020 2023 7265               #re
+0001c0f0: 7369 6475 616c 7320 3d20 7365 6c66 2e72  siduals = self.r
+0001c100: 6573 6964 7561 6c73 2023 7365 6c66 2e79  esiduals #self.y
+0001c110: 202d 2073 656c 662e 6d6f 6465 6c5b 2767   - self.model['g
+0001c120: 6c6f 6261 6c27 5d0a 2020 2020 2020 2020  lobal'].        
+0001c130: 2020 2020 2020 2020 7365 6c66 2e64 6963          self.dic
+0001c140: 7469 6f6e 6172 795b 2767 6c6f 6261 6c5f  tionary['global_
+0001c150: 6d6f 6465 6c27 5d5b 0a20 2020 2020 2020  model'][.       
+0001c160: 2020 2020 2020 2020 2020 2020 2027 6e6f               'no
+0001c170: 6973 655f 6d6f 6465 6c27 5d2e 7365 745f  ise_model'].set_
+0001c180: 7061 7261 6d65 7465 725f 7665 6374 6f72  parameter_vector
+0001c190: 2870 6172 616d 6574 6572 5f76 616c 7565  (parameter_value
+0001c1a0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+0001c1b0: 2020 2073 656c 662e 6469 6374 696f 6e61     self.dictiona
+0001c1c0: 7279 5b27 676c 6f62 616c 5f6d 6f64 656c  ry['global_model
+0001c1d0: 275d 5b27 6e6f 6973 655f 6d6f 6465 6c27  ']['noise_model'
+0001c1e0: 5d2e 7965 7272 203d 206e 702e 7371 7274  ].yerr = np.sqrt
+0001c1f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001c200: 2020 2020 2020 7365 6c66 2e76 6172 6961        self.varia
+0001c210: 6e63 6573 290a 2020 2020 2020 2020 2020  nces).          
+0001c220: 2020 2020 2020 7365 6c66 2e64 6963 7469        self.dicti
+0001c230: 6f6e 6172 795b 2767 6c6f 6261 6c5f 6d6f  onary['global_mo
+0001c240: 6465 6c27 5d5b 276e 6f69 7365 5f6d 6f64  del']['noise_mod
+0001c250: 656c 275d 2e63 6f6d 7075 7465 5f47 5028  el'].compute_GP(
+0001c260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c270: 2020 2020 2058 3d73 656c 662e 6f72 6967       X=self.orig
+0001c280: 696e 616c 5f47 5072 6567 7265 7373 6f72  inal_GPregressor
+0001c290: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+0001c2a0: 2020 2023 2052 6574 7572 6e20 6d65 616e     # Return mean
+0001c2b0: 2073 6967 6e61 6c20 706c 7573 2047 5020   signal plus GP 
+0001c2c0: 6d6f 6465 6c3a 0a20 2020 2020 2020 2020  model:.         
+0001c2d0: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
+0001c2e0: 6c5b 2747 5027 5d20 3d20 7365 6c66 2e64  l['GP'] = self.d
+0001c2f0: 6963 7469 6f6e 6172 795b 2767 6c6f 6261  ictionary['globa
+0001c300: 6c5f 6d6f 6465 6c27 5d5b 276e 6f69 7365  l_model']['noise
+0001c310: 5f6d 6f64 656c 275d 2e47 502e 7072 6564  _model'].GP.pred
+0001c320: 6963 7428 7365 6c66 2e72 6573 6964 7561  ict(self.residua
+0001c330: 6c73 2c20 7365 6c66 2e64 6963 7469 6f6e  ls, self.diction
+0001c340: 6172 795b 2767 6c6f 6261 6c5f 6d6f 6465  ary['global_mode
+0001c350: 6c27 5d5b 276e 6f69 7365 5f6d 6f64 656c  l']['noise_model
+0001c360: 275d 2e58 2c20 5c0a 2020 2020 2020 2020  '].X, \.        
+0001c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c3c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001c3d0: 6e5f 7661 723d 4661 6c73 652c 2072 6574  n_var=False, ret
+0001c3e0: 7572 6e5f 636f 763d 4661 6c73 6529 0a20  urn_cov=False). 
+0001c3f0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001c400: 6574 7572 6e20 7365 6c66 2e6d 6f64 656c  eturn self.model
+0001c410: 5b27 676c 6f62 616c 275d 2c20 7365 6c66  ['global'], self
+0001c420: 2e6d 6f64 656c 5b0a 2020 2020 2020 2020  .model[.        
+0001c430: 2020 2020 2020 2020 2020 2020 2747 5027              'GP'
+0001c440: 5d2c 2073 656c 662e 6d6f 6465 6c5b 2767  ], self.model['g
+0001c450: 6c6f 6261 6c27 5d20 2b20 7365 6c66 2e6d  lobal'] + self.m
+0001c460: 6f64 656c 5b27 4750 275d 0a20 2020 2020  odel['GP'].     
+0001c470: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001c480: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0001c490: 7572 6e20 7365 6c66 2e6d 6f64 656c 5b27  urn self.model['
+0001c4a0: 676c 6f62 616c 275d 0a20 2020 2020 2020  global'].       
+0001c4b0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001c4c0: 2020 2069 6620 7365 6c66 2e64 6963 7469     if self.dicti
+0001c4d0: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
+0001c4e0: 5d5b 2747 5044 6574 7265 6e64 275d 3a0a  ]['GPDetrend']:.
+0001c4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c500: 2372 6573 6964 7561 6c73 203d 2073 656c  #residuals = sel
+0001c510: 662e 7265 7369 6475 616c 7323 7365 6c66  f.residuals#self
+0001c520: 2e64 6174 615b 696e 7374 7275 6d65 6e74  .data[instrument
+0001c530: 5d20 2d20 7365 6c66 2e6d 6f64 656c 5b69  ] - self.model[i
+0001c540: 6e73 7472 756d 656e 745d 5b27 6465 7465  nstrument]['dete
+0001c550: 726d 696e 6973 7469 6327 5d0a 2020 2020  rministic'].    
+0001c560: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001c570: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
+0001c580: 7275 6d65 6e74 5d5b 276e 6f69 7365 5f6d  rument]['noise_m
+0001c590: 6f64 656c 275d 2e73 6574 5f70 6172 616d  odel'].set_param
+0001c5a0: 6574 6572 5f76 6563 746f 7228 0a20 2020  eter_vector(.   
+0001c5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c5c0: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
+0001c5d0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+0001c5e0: 2020 2073 656c 662e 6d6f 6465 6c5b 696e     self.model[in
+0001c5f0: 7374 7275 6d65 6e74 5d5b 2747 5027 5d20  strument]['GP'] 
+0001c600: 3d20 7365 6c66 2e64 6963 7469 6f6e 6172  = self.dictionar
+0001c610: 795b 696e 7374 7275 6d65 6e74 5d5b 276e  y[instrument]['n
+0001c620: 6f69 7365 5f6d 6f64 656c 275d 2e47 502e  oise_model'].GP.
+0001c630: 7072 6564 6963 7428 7365 6c66 2e72 6573  predict(self.res
+0001c640: 6964 7561 6c73 2c73 656c 662e 6469 6374  iduals,self.dict
+0001c650: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
+0001c660: 745d 5b27 6e6f 6973 655f 6d6f 6465 6c27  t]['noise_model'
+0001c670: 5d2e 582c 205c 0a20 2020 2020 2020 2020  ].X, \.         
+0001c680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c6a0: 2020 2020 2020 7265 7475 726e 5f76 6172        return_var
+0001c6b0: 3d46 616c 7365 2c20 7265 7475 726e 5f63  =False, return_c
+0001c6c0: 6f76 3d46 616c 7365 290a 2020 2020 2020  ov=False).      
+0001c6d0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001c6e0: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
+0001c6f0: 7275 6d65 6e74 5d5b 2764 6574 6572 6d69  rument]['determi
+0001c700: 6e69 7374 6963 275d 2c20 7365 6c66 2e6d  nistic'], self.m
+0001c710: 6f64 656c 5b0a 2020 2020 2020 2020 2020  odel[.          
+0001c720: 2020 2020 2020 2020 2020 696e 7374 7275            instru
+0001c730: 6d65 6e74 5d5b 2747 5027 5d2c 2073 656c  ment]['GP'], sel
+0001c740: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+0001c750: 6e74 5d5b 0a20 2020 2020 2020 2020 2020  nt][.           
+0001c760: 2020 2020 2020 2020 2020 2020 2027 6465               'de
+0001c770: 7465 726d 696e 6973 7469 6327 5d20 2b20  terministic'] + 
+0001c780: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+0001c790: 756d 656e 745d 5b27 4750 275d 0a20 2020  ument]['GP'].   
+0001c7a0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0001c7b0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001c7c0: 6574 7572 6e20 7365 6c66 2e6d 6f64 656c  eturn self.model
+0001c7d0: 5b69 6e73 7472 756d 656e 745d 5b27 6465  [instrument]['de
+0001c7e0: 7465 726d 696e 6973 7469 6327 5d0a 0a20  terministic'].. 
+0001c7f0: 2020 2064 6566 2065 7661 6c75 6174 655f     def evaluate_
+0001c800: 6d6f 6465 6c28 7365 6c66 2c20 696e 7374  model(self, inst
+0001c810: 7275 6d65 6e74 203d 204e 6f6e 652c 2070  rument = None, p
+0001c820: 6172 616d 6574 6572 5f76 616c 7565 7320  arameter_values 
+0001c830: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0001c840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c850: 2020 616c 6c5f 7361 6d70 6c65 7320 3d20    all_samples = 
+0001c860: 4661 6c73 652c 206e 7361 6d70 6c65 7320  False, nsamples 
+0001c870: 3d20 3130 3030 2c20 7265 7475 726e 5f73  = 1000, return_s
+0001c880: 616d 706c 6573 203d 2046 616c 7365 2c20  amples = False, 
+0001c890: 7420 3d20 4e6f 6e65 2c20 4750 7265 6772  t = None, GPregr
+0001c8a0: 6573 736f 7273 203d 204e 6f6e 652c 204c  essors = None, L
+0001c8b0: 4d72 6567 7265 7373 6f72 7320 3d20 4e6f  Mregressors = No
+0001c8c0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+0001c8d0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001c8e0: 7475 726e 5f65 7272 203d 2046 616c 7365  turn_err = False
+0001c8f0: 2c20 616c 7068 6120 3d20 302e 3638 2c20  , alpha = 0.68, 
+0001c900: 7265 7475 726e 5f63 6f6d 706f 6e65 6e74  return_component
+0001c910: 7320 3d20 4661 6c73 652c 2065 7661 6c75  s = False, evalu
+0001c920: 6174 655f 7472 616e 7369 7420 3d20 4661  ate_transit = Fa
+0001c930: 6c73 6529 3a0a 2020 2020 2020 2020 2222  lse):.        ""
+0001c940: 220a 2020 2020 2020 2020 5468 6973 2066  ".        This f
+0001c950: 756e 6374 696f 6e20 6576 616c 7561 7465  unction evaluate
+0001c960: 7320 7468 6520 6375 7272 656e 7420 6c63  s the current lc
+0001c970: 206f 7220 7276 206d 6f64 656c 2067 6976   or rv model giv
+0001c980: 656e 2061 2073 6574 206f 6620 706f 7374  en a set of post
+0001c990: 6572 696f 7220 6469 7374 7269 6275 7469  erior distributi
+0001c9a0: 6f6e 2073 616d 706c 6573 2061 6e64 2f6f  on samples and/o
+0001c9b0: 7220 7061 7261 6d65 7465 7220 7661 6c75  r parameter valu
+0001c9c0: 6573 2e20 4578 616d 706c 6520 7573 6167  es. Example usag
+0001c9d0: 653a 0a0a 2020 2020 2020 2020 2020 2020  e:..            
+0001c9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c9f0: 203e 3e3e 2064 6174 6173 6574 203d 206a   >>> dataset = j
+0001ca00: 756c 6965 742e 6c6f 6164 2870 7269 6f72  uliet.load(prior
+0001ca10: 733d 7072 696f 7273 2c20 745f 6c63 203d  s=priors, t_lc =
+0001ca20: 2074 696d 6573 2c20 795f 6c63 203d 2066   times, y_lc = f
+0001ca30: 6c75 7865 732c 2079 6572 725f 6c63 203d  luxes, yerr_lc =
+0001ca40: 2066 6c75 7865 735f 6572 726f 7229 0a20   fluxes_error). 
+0001ca50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ca60: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0001ca70: 7265 7375 6c74 7320 3d20 6461 7461 7365  results = datase
+0001ca80: 742e 6669 7428 290a 2020 2020 2020 2020  t.fit().        
+0001ca90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001caa0: 2020 2020 203e 3e3e 2074 7261 6e73 6974       >>> transit
+0001cab0: 5f6d 6f64 656c 2c20 6572 726f 7236 385f  _model, error68_
+0001cac0: 7570 2c20 6572 726f 7236 385f 646f 776e  up, error68_down
+0001cad0: 203d 2072 6573 756c 7473 2e6c 632e 6576   = results.lc.ev
+0001cae0: 616c 7561 7465 2827 5445 5353 272c 2072  aluate('TESS', r
+0001caf0: 6574 7572 6e5f 6572 723d 5472 7565 290a  eturn_err=True).
+0001cb00: 0a20 2020 2020 2020 204f 723a 0a0a 2020  .        Or:..  
+0001cb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb20: 2020 2020 2020 2020 2020 203e 3e3e 2064             >>> d
+0001cb30: 6174 6173 6574 203d 206a 756c 6965 742e  ataset = juliet.
+0001cb40: 6c6f 6164 2870 7269 6f72 733d 7072 696f  load(priors=prio
+0001cb50: 7273 2c20 745f 7276 203d 2074 696d 6573  rs, t_rv = times
+0001cb60: 2c20 795f 7276 203d 2066 6c75 7865 732c  , y_rv = fluxes,
+0001cb70: 2079 6572 725f 7276 203d 2066 6c75 7865   yerr_rv = fluxe
+0001cb80: 735f 6572 726f 7229 0a20 2020 2020 2020  s_error).       
+0001cb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cba0: 2020 2020 2020 3e3e 3e20 7265 7375 6c74        >>> result
+0001cbb0: 7320 3d20 6461 7461 7365 742e 6669 7428  s = dataset.fit(
+0001cbc0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001cbd0: 2020 2020 2020 2020 2020 2020 2020 203e                 >
+0001cbe0: 3e3e 2072 765f 6d6f 6465 6c2c 2065 7272  >> rv_model, err
+0001cbf0: 6f72 3638 5f75 702c 2065 7272 6f72 3638  or68_up, error68
+0001cc00: 5f64 6f77 6e20 3d20 7265 7375 6c74 732e  _down = results.
+0001cc10: 7276 2e65 7661 6c75 6174 6528 2746 4552  rv.evaluate('FER
+0001cc20: 4f53 272c 2072 6574 7572 6e5f 6572 723d  OS', return_err=
+0001cc30: 5472 7565 290a 0a20 2020 2020 2020 203a  True)..        :
+0001cc40: 7061 7261 6d20 696e 7374 7275 6d65 6e74  param instrument
+0001cc50: 3a20 286f 7074 696f 6e61 6c2c 2073 7472  : (optional, str
+0001cc60: 696e 6729 0a20 2020 2020 2020 2049 6e73  ing).        Ins
+0001cc70: 7472 756d 656e 7420 7468 6520 7573 6572  trument the user
+0001cc80: 2077 616e 7473 2074 6f20 6576 616c 7561   wants to evalua
+0001cc90: 7465 2074 6865 206d 6f64 656c 206f 6e2e  te the model on.
+0001cca0: 2049 7420 6973 2065 7870 6563 7465 6420   It is expected 
+0001ccb0: 746f 2062 6520 6769 7665 6e20 666f 7220  to be given for 
+0001ccc0: 6e6f 6e2d 676c 6f62 616c 206d 6f64 656c  non-global model
+0001ccd0: 732c 206e 6f74 206e 6563 6573 7361 7279  s, not necessary
+0001cce0: 2066 6f72 2067 6c6f 6261 6c20 6d6f 6465   for global mode
+0001ccf0: 6c73 2e0a 0a20 2020 2020 2020 203a 7061  ls...        :pa
+0001cd00: 7261 6d20 7061 7261 6d65 7465 725f 7661  ram parameter_va
+0001cd10: 6c75 6573 3a20 286f 7074 696f 6e61 6c2c  lues: (optional,
+0001cd20: 2064 6963 7429 0a20 2020 2020 2020 2044   dict).        D
+0001cd30: 6963 7469 6f6e 6172 7920 636f 6e74 6169  ictionary contai
+0001cd40: 6e69 6e67 2073 616d 706c 6573 206f 6620  ning samples of 
+0001cd50: 7468 6520 706f 7374 6572 696f 7220 6469  the posterior di
+0001cd60: 7374 7269 6275 7469 6f6e 206f 722c 206d  stribution or, m
+0001cd70: 6f72 6520 6765 6e65 7261 6c6c 792c 2070  ore generally, p
+0001cd80: 6172 616d 6574 6572 2076 616c 7565 7369  arameter valuesi
+0001cd90: 6e20 6974 2e20 4561 6368 206b 6579 2069  n it. Each key i
+0001cda0: 7320 6120 7061 7261 6d65 7465 7220 6e61  s a parameter na
+0001cdb0: 6d65 2028 652e 672e 2027 705f 7031 272c  me (e.g. 'p_p1',
+0001cdc0: 0a20 2020 2020 2020 2027 7131 5f54 4553  .        'q1_TES
+0001cdd0: 5327 2c20 6574 632e 292c 2061 6e64 2069  S', etc.), and i
+0001cde0: 6e73 6964 6520 6561 6368 206f 6620 7468  nside each of th
+0001cdf0: 6f73 6520 6b65 7973 2061 6e20 6172 7261  ose keys an arra
+0001ce00: 7920 6f66 204e 2073 616d 706c 6573 2069  y of N samples i
+0001ce10: 7320 6578 7065 6374 6564 2028 692e 652e  s expected (i.e.
+0001ce20: 2c20 7061 7261 6d65 7465 725f 7661 6c75  , parameter_valu
+0001ce30: 6573 5b27 705f 7031 275d 2069 7320 616e  es['p_p1'] is an
+0001ce40: 2061 7272 6179 206f 6620 6c65 6e67 7468   array of length
+0001ce50: 204e 292e 2054 6865 0a20 2020 2020 2020   N). The.       
+0001ce60: 2069 6e64 6578 6573 2068 6176 6520 746f   indexes have to
+0001ce70: 2062 6520 636f 6e73 6973 7465 6e74 2062   be consistent b
+0001ce80: 6574 7765 656e 2064 6966 6665 7265 6e74  etween different
+0001ce90: 2070 6172 616d 6574 6572 732e 0a0a 2020   parameters...  
+0001cea0: 2020 2020 2020 3a70 6172 616d 2061 6c6c        :param all
+0001ceb0: 5f73 616d 706c 6573 3a20 286f 7074 696f  _samples: (optio
+0001cec0: 6e61 6c2c 2062 6f6f 6c65 616e 290a 2020  nal, boolean).  
+0001ced0: 2020 2020 2020 4966 2054 7275 652c 2061        If True, a
+0001cee0: 6c6c 2070 6f73 7465 7269 6f72 2073 616d  ll posterior sam
+0001cef0: 706c 6573 2077 696c 6c20 6265 2075 7365  ples will be use
+0001cf00: 6420 746f 2065 7661 6c75 6174 6520 7468  d to evaluate th
+0001cf10: 6520 6d6f 6465 6c2e 2044 6566 6175 6c74  e model. Default
+0001cf20: 2069 7320 4661 6c73 652e 0a0a 2020 2020   is False...    
+0001cf30: 2020 2020 3a70 6172 616d 206e 7361 6d70      :param nsamp
+0001cf40: 6c65 733a 2028 6f70 7469 6f6e 616c 2c20  les: (optional, 
+0001cf50: 696e 7429 0a20 2020 2020 2020 204e 756d  int).        Num
+0001cf60: 6265 7220 6f66 2070 6f73 7465 7269 6f72  ber of posterior
+0001cf70: 2073 616d 706c 6573 2074 6f20 6265 2075   samples to be u
+0001cf80: 7365 6420 746f 2065 7661 6c75 6174 6520  sed to evaluate 
+0001cf90: 7468 6520 6d6f 6465 6c2e 2044 6566 6175  the model. Defau
+0001cfa0: 6c74 2069 7320 3130 3030 2028 6e6f 7465  lt is 1000 (note
+0001cfb0: 2065 6163 6820 6361 6c6c 2074 6f20 7468   each call to th
+0001cfc0: 6973 2066 756e 6374 696f 6e20 7769 6c6c  is function will
+0001cfd0: 2073 616d 706c 6520 606e 7361 6d70 6c65   sample `nsample
+0001cfe0: 7360 2064 6966 6665 7265 6e74 2073 616d  s` different sam
+0001cff0: 706c 6573 0a20 2020 2020 2020 2066 726f  ples.        fro
+0001d000: 6d20 7468 6520 706f 7374 6572 696f 722c  m the posterior,
+0001d010: 2073 6f20 6e6f 2074 776f 2063 616c 6c73   so no two calls
+0001d020: 2061 7265 2065 7861 6374 6c79 2074 6865   are exactly the
+0001d030: 2073 616d 6529 2e0a 0a20 2020 2020 2020   same)...       
+0001d040: 203a 7061 7261 6d20 7265 7475 726e 5f73   :param return_s
+0001d050: 616d 706c 6573 3a20 286f 7074 696f 6e61  amples: (optiona
+0001d060: 6c2c 2062 6f6f 6c65 616e 290a 2020 2020  l, boolean).    
+0001d070: 2020 2020 426f 6f6c 6561 6e20 696e 6469      Boolean indi
+0001d080: 6361 7469 6e67 2077 6865 7468 6572 2074  cating whether t
+0001d090: 6865 2075 7365 7220 7761 6e74 7320 7468  he user wants th
+0001d0a0: 6520 706f 7374 6572 696f 7220 6d6f 6465  e posterior mode
+0001d0b0: 6c20 7361 6d70 6c65 7320 2869 2e65 2e2c  l samples (i.e.,
+0001d0c0: 2074 6865 206d 6f64 656c 7320 6576 616c   the models eval
+0001d0d0: 7561 7465 6420 696e 2065 6163 6820 6f66  uated in each of
+0001d0e0: 2074 6865 2070 6f73 7465 7269 6f72 2073   the posterior s
+0001d0f0: 616d 706c 6520 6472 6177 7329 2074 6f20  ample draws) to 
+0001d100: 6265 2072 6574 7572 6e65 642e 2044 6566  be returned. Def
+0001d110: 6175 6c74 0a20 2020 2020 2020 2069 7320  ault.        is 
+0001d120: 4661 6c73 652e 0a0a 2020 2020 2020 2020  False...        
+0001d130: 3a70 6172 616d 2074 3a20 286f 7074 696f  :param t: (optio
+0001d140: 6e61 6c2c 206e 756d 7079 2061 7272 6179  nal, numpy array
+0001d150: 290a 2020 2020 2020 2020 4172 7261 7920  ).        Array 
+0001d160: 7769 7468 2074 6865 2074 696d 6573 2061  with the times a
+0001d170: 7420 7768 6963 6820 7468 6520 6d6f 6465  t which the mode
+0001d180: 6c20 7761 6e74 7320 746f 2062 6520 6576  l wants to be ev
+0001d190: 616c 7561 7465 642e 0a0a 2020 2020 2020  aluated...      
+0001d1a0: 2020 3a70 6172 616d 2047 5052 6567 7265    :param GPRegre
+0001d1b0: 7373 6f72 733a 2028 6f70 7469 6f6e 616c  ssors: (optional
+0001d1c0: 2c20 6e75 6d70 7920 6172 7261 7929 0a20  , numpy array). 
+0001d1d0: 2020 2020 2020 2041 7272 6179 2063 6f6e         Array con
+0001d1e0: 7461 696e 696e 6720 7468 6520 4750 2052  taining the GP R
+0001d1f0: 6567 7265 7373 6f72 7320 6f6e 746f 2077  egressors onto w
+0001d200: 6869 6368 2074 6f20 6576 616c 7561 7465  hich to evaluate
+0001d210: 2074 6865 206d 6f64 656c 732e 2044 696d   the models. Dim
+0001d220: 656e 7369 6f6e 7320 6d75 7374 2062 6520  ensions must be 
+0001d230: 636f 6e73 6973 7465 6e74 2077 6974 6820  consistent with 
+0001d240: 696e 7075 7420 6074 602e 2049 6620 6d6f  input `t`. If mo
+0001d250: 6465 6c20 6973 2067 6c6f 6261 6c2c 2074  del is global, t
+0001d260: 6869 7320 6e65 6564 7320 746f 2062 6520  his needs to be 
+0001d270: 6120 6469 6374 696f 6e61 7279 2e0a 0a20  a dictionary... 
+0001d280: 2020 2020 2020 203a 7061 7261 6d20 4c4d         :param LM
+0001d290: 5265 6772 6573 736f 7273 3a20 286f 7074  Regressors: (opt
+0001d2a0: 696f 6e61 6c2c 206e 756d 7079 2061 7272  ional, numpy arr
+0001d2b0: 6179 206f 7220 6469 6374 696f 6e61 7279  ay or dictionary
+0001d2c0: 290a 2020 2020 2020 2020 4966 2074 6865  ).        If the
+0001d2d0: 206d 6f64 656c 2069 7320 6e6f 7420 676c   model is not gl
+0001d2e0: 6f62 616c 2c20 7468 6973 2069 7320 616e  obal, this is an
+0001d2f0: 2061 7272 6179 2063 6f6e 7461 696e 696e   array containin
+0001d300: 6720 7468 6520 4c69 6e65 6172 2052 6567  g the Linear Reg
+0001d310: 7265 7373 6f72 7320 6f6e 746f 2077 6869  ressors onto whi
+0001d320: 6368 2074 6f20 6576 616c 7561 7465 2074  ch to evaluate t
+0001d330: 6865 206d 6f64 656c 2066 6f72 2074 6865  he model for the
+0001d340: 2069 6e70 7574 2069 6e73 7472 756d 656e   input instrumen
+0001d350: 742e 0a20 2020 2020 2020 2044 696d 656e  t..        Dimen
+0001d360: 7369 6f6e 7320 6d75 7374 2062 6520 636f  sions must be co
+0001d370: 6e73 6973 7465 6e74 2077 6974 6820 696e  nsistent with in
+0001d380: 7075 7420 6074 602e 2049 6620 6d6f 6465  put `t`. If mode
+0001d390: 6c20 6973 2067 6c6f 6261 6c2c 2074 6869  l is global, thi
+0001d3a0: 7320 6e65 6564 7320 746f 2062 6520 6120  s needs to be a 
+0001d3b0: 6469 6374 696f 6e61 7279 2e0a 0a20 2020  dictionary...   
+0001d3c0: 2020 2020 203a 7061 7261 6d20 7265 7475       :param retu
+0001d3d0: 726e 5f65 7272 3a20 286f 7074 696f 6e61  rn_err: (optiona
+0001d3e0: 6c2c 2062 6f6f 6c65 616e 290a 2020 2020  l, boolean).    
+0001d3f0: 2020 2020 4966 2054 7275 652c 2074 6869      If True, thi
+0001d400: 7320 7265 7475 726e 7320 7468 6520 6372  s returns the cr
+0001d410: 6564 6962 696c 6974 7920 696e 7465 7276  edibility interv
+0001d420: 616c 206f 6e20 7468 6520 6576 616c 7561  al on the evalua
+0001d430: 7465 6420 6d6f 6465 6c2e 2044 6566 6175  ted model. Defau
+0001d440: 6c74 2063 7265 6469 6269 6c69 7479 2069  lt credibility i
+0001d450: 6e74 6572 7661 6c20 6973 2036 3825 2e0a  nterval is 68%..
+0001d460: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001d470: 616c 7068 613a 2028 6f70 7469 6f6e 616c  alpha: (optional
+0001d480: 2c20 646f 7562 6c65 290a 2020 2020 2020  , double).      
+0001d490: 2020 4372 6564 6962 696c 6974 7920 696e    Credibility in
+0001d4a0: 7465 7276 616c 2066 6f72 2072 6574 7572  terval for retur
+0001d4b0: 6e5f 6572 722e 2044 6566 6175 6c74 2069  n_err. Default i
+0001d4c0: 7320 302e 3638 2c20 692e 652e 2c20 7468  s 0.68, i.e., th
+0001d4d0: 6520 3638 2520 6372 6564 6962 696c 6974  e 68% credibilit
+0001d4e0: 7920 696e 7465 7276 616c 2e0a 0a20 2020  y interval...   
+0001d4f0: 2020 2020 203a 7061 7261 6d20 7265 7475       :param retu
+0001d500: 726e 5f63 6f6d 706f 6e65 6e74 733a 2028  rn_components: (
+0001d510: 6f70 7469 6f6e 616c 2c20 626f 6f6c 6561  optional, boolea
+0001d520: 6e29 0a20 2020 2020 2020 2049 6620 5472  n).        If Tr
+0001d530: 7565 2c20 6561 6368 2063 6f6d 706f 6e65  ue, each compone
+0001d540: 6e74 206f 6620 7468 6520 6d6f 6465 6c20  nt of the model 
+0001d550: 6973 2072 6574 7572 6e65 6420 2869 2e65  is returned (i.e
+0001d560: 2e2c 2074 6865 2047 6175 7373 6961 6e20  ., the Gaussian 
+0001d570: 5072 6f63 6573 7320 636f 6d70 6f6e 656e  Process componen
+0001d580: 742c 2074 6865 204c 696e 6561 7220 4d6f  t, the Linear Mo
+0001d590: 6465 6c20 636f 6d70 6f6e 656e 742c 2065  del component, e
+0001d5a0: 7463 2e29 2e0a 0a20 2020 2020 2020 203a  tc.)...        :
+0001d5b0: 7061 7261 6d20 6576 616c 7561 7465 5f74  param evaluate_t
+0001d5c0: 7261 6e73 6974 3a20 286f 7074 696f 6e61  ransit: (optiona
+0001d5d0: 6c2c 2062 6f6f 6c65 616e 290a 2020 2020  l, boolean).    
+0001d5e0: 2020 2020 4966 2054 7275 652c 2074 6865      If True, the
+0001d5f0: 2066 756e 6374 696f 6e20 6576 616c 7561   function evalua
+0001d600: 7465 7320 6f6e 6c79 2074 6865 2074 7261  tes only the tra
+0001d610: 6e73 6974 206d 6f64 656c 2061 6e64 206e  nsit model and n
+0001d620: 6f74 2074 6865 2047 6175 7373 6961 6e20  ot the Gaussian 
+0001d630: 5072 6f63 6573 7320 6f72 204c 696e 6561  Process or Linea
+0001d640: 7220 4d6f 6465 6c20 636f 6d70 6f6e 656e  r Model componen
+0001d650: 7473 2e0a 0a20 2020 2020 2020 203a 7265  ts...        :re
+0001d660: 7475 726e 733a 2042 7920 6465 6661 756c  turns: By defaul
+0001d670: 742c 2074 6865 2066 756e 6374 696f 6e20  t, the function 
+0001d680: 7265 7475 726e 7320 7468 6520 6d65 6469  returns the medi
+0001d690: 616e 206d 6f64 656c 2061 7320 6576 616c  an model as eval
+0001d6a0: 7561 7465 6420 7769 7468 2074 6865 2070  uated with the p
+0001d6b0: 6f73 7465 7269 6f72 2073 616d 706c 6573  osterior samples
+0001d6c0: 2e20 4465 7065 6e64 696e 6720 6f6e 2074  . Depending on t
+0001d6d0: 6865 206f 7074 696f 6e73 2063 686f 7365  he options chose
+0001d6e0: 6e20 6279 2074 6865 2075 7365 722c 2074  n by the user, t
+0001d6f0: 6869 7320 6361 6e20 7265 7475 726e 2075  his can return u
+0001d700: 7020 746f 2035 2065 6c65 6d65 6e74 7320  p to 5 elements 
+0001d710: 2869 6e20 7468 6174 206f 7264 6572 293a  (in that order):
+0001d720: 2060 6d6f 6465 6c5f 7361 6d70 6c65 7360   `model_samples`
+0001d730: 2c20 606d 6564 6961 6e5f 6d6f 6465 6c60  , `median_model`
+0001d740: 2c20 6075 7070 6572 5f43 4960 2c20 606c  , `upper_CI`, `l
+0001d750: 6f77 6572 5f43 4960 2061 6e64 2060 636f  ower_CI` and `co
+0001d760: 6d70 6f6e 656e 7473 602e 2054 6865 2066  mponents`. The f
+0001d770: 6972 7374 2069 7320 616e 2061 7272 6179  irst is an array
+0001d780: 2077 6974 6820 616c 6c20 7468 6520 6d6f   with all the mo
+0001d790: 6465 6c20 7361 6d70 6c65 7320 6173 2065  del samples as e
+0001d7a0: 7661 6c75 6174 6564 2066 726f 6d20 7468  valuated from th
+0001d7b0: 6520 706f 7374 6572 696f 722e 2054 6865  e posterior. The
+0001d7c0: 2073 6563 6f6e 6420 6973 2074 6865 206d   second is the m
+0001d7d0: 6564 6961 6e20 6d6f 6465 6c2e 2054 6865  edian model. The
+0001d7e0: 2074 6869 7264 2061 6e64 2066 6f75 7274   third and fourt
+0001d7f0: 6820 6172 6520 7468 6520 7570 7070 6572  h are the uppper
+0001d800: 2061 6e64 206c 6f77 6572 2043 7265 6469   and lower Credi
+0001d810: 6269 6c69 7479 2049 6e74 6572 7661 6c73  bility Intervals
+0001d820: 2c20 616e 6420 7468 6520 6c61 7474 6572  , and the latter
+0001d830: 2069 7320 6120 6469 6374 696f 6e61 7279   is a dictionary
+0001d840: 2077 6974 6820 7468 6520 6d6f 6465 6c20   with the model 
+0001d850: 636f 6d70 6f6e 656e 7473 2e0a 0a20 2020  components...   
+0001d860: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001d870: 2069 6620 6576 616c 7561 7465 5f74 7261   if evaluate_tra
+0001d880: 6e73 6974 3a0a 2020 2020 2020 2020 2020  nsit:.          
+0001d890: 2020 6966 2073 656c 662e 6d6f 6465 6c74    if self.modelt
+0001d8a0: 7970 6520 213d 2027 6c63 273a 0a20 2020  ype != 'lc':.   
+0001d8b0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0001d8c0: 7365 2045 7863 6570 7469 6f6e 280a 2020  se Exception(.  
+0001d8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d8e0: 2020 2254 7279 696e 6720 746f 2065 7661    "Trying to eva
+0001d8f0: 6c75 6174 6520 6120 7472 616e 7369 7420  luate a transit 
+0001d900: 2865 7661 6c75 6174 655f 7472 616e 7369  (evaluate_transi
+0001d910: 7420 3d20 5472 7565 2920 696e 2061 206e  t = True) in a n
+0001d920: 6f6e 2d6c 6967 6874 6375 7276 6520 6d6f  on-lightcurve mo
+0001d930: 6465 6c20 6973 206e 6f74 2061 6c6c 6f77  del is not allow
+0001d940: 6564 2e22 0a20 2020 2020 2020 2020 2020  ed.".           
+0001d950: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0001d960: 2020 2020 2320 5361 7665 204c 4d20 616e      # Save LM an
+0001d970: 6420 4750 2062 6f6f 6c65 616e 732c 2074  d GP booleans, t
+0001d980: 7572 6e20 7468 656d 206f 6666 3a0a 2020  urn them off:.  
+0001d990: 2020 2020 2020 2020 2020 7472 7565 5f6c            true_l
+0001d9a0: 6d5f 626f 6f6c 6561 6e20 3d20 7365 6c66  m_boolean = self
+0001d9b0: 2e6c 6d5f 626f 6f6c 6561 6e5b 696e 7374  .lm_boolean[inst
+0001d9c0: 7275 6d65 6e74 5d0a 2020 2020 2020 2020  rument].        
+0001d9d0: 2020 2020 7365 6c66 2e6c 6d5f 626f 6f6c      self.lm_bool
+0001d9e0: 6561 6e5b 696e 7374 7275 6d65 6e74 5d20  ean[instrument] 
+0001d9f0: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+0001da00: 2020 2020 6966 2073 656c 662e 676c 6f62      if self.glob
+0001da10: 616c 5f6d 6f64 656c 3a0a 2020 2020 2020  al_model:.      
+0001da20: 2020 2020 2020 2020 2020 7472 7565 5f67            true_g
+0001da30: 705f 626f 6f6c 6561 6e20 3d20 7365 6c66  p_boolean = self
+0001da40: 2e64 6963 7469 6f6e 6172 795b 2767 6c6f  .dictionary['glo
+0001da50: 6261 6c5f 6d6f 6465 6c27 5d5b 2747 5044  bal_model']['GPD
+0001da60: 6574 7265 6e64 275d 0a20 2020 2020 2020  etrend'].       
+0001da70: 2020 2020 2020 2020 2073 656c 662e 6469           self.di
+0001da80: 6374 696f 6e61 7279 5b27 676c 6f62 616c  ctionary['global
+0001da90: 5f6d 6f64 656c 275d 5b27 4750 4465 7472  _model']['GPDetr
+0001daa0: 656e 6427 5d20 3d20 4661 6c73 650a 2020  end'] = False.  
+0001dab0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0001dac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dad0: 7472 7565 5f67 705f 626f 6f6c 6561 6e20  true_gp_boolean 
+0001dae0: 3d20 7365 6c66 2e64 6963 7469 6f6e 6172  = self.dictionar
+0001daf0: 795b 696e 7374 7275 6d65 6e74 5d5b 2747  y[instrument]['G
+0001db00: 5044 6574 7265 6e64 275d 0a20 2020 2020  PDetrend'].     
+0001db10: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001db20: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
+0001db30: 756d 656e 745d 5b27 4750 4465 7472 656e  ument]['GPDetren
+0001db40: 6427 5d20 3d20 4661 6c73 650a 0a20 2020  d'] = False..   
+0001db50: 2020 2020 2023 2049 6620 6e6f 2069 6e73       # If no ins
+0001db60: 7472 756d 656e 7420 6973 2067 6976 656e  trument is given
+0001db70: 2c20 6173 7375 6d65 2075 7365 7220 7761  , assume user wa
+0001db80: 6e74 7320 6120 676c 6f62 616c 206d 6f64  nts a global mod
+0001db90: 656c 2065 7661 6c75 6174 696f 6e3a 0a20  el evaluation:. 
+0001dba0: 2020 2020 2020 2069 6620 696e 7374 7275         if instru
+0001dbb0: 6d65 6e74 2069 7320 4e6f 6e65 3a0a 2020  ment is None:.  
+0001dbc0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0001dbd0: 2073 656c 662e 676c 6f62 616c 5f6d 6f64   self.global_mod
+0001dbe0: 656c 3a0a 2020 2020 2020 2020 2020 2020  el:.            
+0001dbf0: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
+0001dc00: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+0001dc10: 2020 2020 2020 2020 2022 496e 7075 7420           "Input 
+0001dc20: 6572 726f 723a 2061 6e20 696e 7374 7275  error: an instru
+0001dc30: 6d65 6e74 2068 6173 2074 6f20 6265 2064  ment has to be d
+0001dc40: 6566 696e 6564 2066 6f72 206e 6f6e 2d67  efined for non-g
+0001dc50: 6c6f 6261 6c20 6d6f 6465 6c73 2069 6e20  lobal models in 
+0001dc60: 6f72 6465 7220 746f 2065 7661 6c75 6174  order to evaluat
+0001dc70: 6520 7468 6520 6d6f 6465 6c2e 220a 2020  e the model.".  
+0001dc80: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0001dc90: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0001dca0: 2e6d 6f64 656c 7479 7065 203d 3d20 276c  .modeltype == 'l
+0001dcb0: 6327 3a0a 0a20 2020 2020 2020 2020 2020  c':..           
+0001dcc0: 206e 7265 7361 6d70 6c69 6e67 203d 2073   nresampling = s
+0001dcd0: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
+0001dce0: 6e73 7472 756d 656e 745d 2e67 6574 2827  nstrument].get('
+0001dcf0: 6e72 6573 616d 706c 696e 6727 290a 2020  nresampling').  
+0001dd00: 2020 2020 2020 2020 2020 6574 7265 7361            etresa
+0001dd10: 6d70 6c69 6e67 203d 2073 656c 662e 6469  mpling = self.di
+0001dd20: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
+0001dd30: 656e 745d 2e67 6574 2827 6578 7074 696d  ent].get('exptim
+0001dd40: 6572 6573 616d 706c 696e 6727 290a 0a20  eresampling').. 
+0001dd50: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0001dd60: 7420 7365 6c66 2e64 6963 7469 6f6e 6172  t self.dictionar
+0001dd70: 795b 696e 7374 7275 6d65 6e74 5d5b 2754  y[instrument]['T
+0001dd80: 7261 6e73 6974 4669 7443 6174 776f 6d61  ransitFitCatwoma
+0001dd90: 6e27 5d3a 0a0a 2020 2020 2020 2020 2020  n']:..          
+0001dda0: 2020 2020 2020 6966 2073 656c 662e 6469        if self.di
+0001ddb0: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
+0001ddc0: 656e 745d 5b27 5472 616e 7369 7446 6974  ent]['TransitFit
+0001ddd0: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
+0001dde0: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
+0001ddf0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
+0001de00: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
+0001de10: 2770 6172 616d 7327 5d2c 205b 7365 6c66  'params'], [self
+0001de20: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
+0001de30: 745d 5b27 6d27 5d2c 5f5d 203d 2069 6e69  t]['m'],_] = ini
+0001de40: 745f 6261 746d 616e 2873 656c 662e 7469  t_batman(self.ti
+0001de50: 6d65 735b 696e 7374 7275 6d65 6e74 5d2c  mes[instrument],
+0001de60: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
+0001de70: 5b69 6e73 7472 756d 656e 745d 5b27 6c64  [instrument]['ld
+0001de80: 6c61 7727 5d2c 0a20 2020 2020 2020 2020  law'],.         
+0001de90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001deb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001dec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001ded0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001def0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001df00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001df10: 2020 2020 2020 2020 6e72 6573 616d 706c          nresampl
-0001df20: 696e 673d 6e72 6573 616d 706c 696e 672c  ing=nresampling,
-0001df30: 2065 7472 6573 616d 706c 696e 673d 6574   etresampling=et
-0001df40: 7265 7361 6d70 6c69 6e67 290a 0a0a 2020  resampling)...  
-0001df50: 2020 2020 2020 2320 5361 7665 2074 6865        # Save the
-0001df60: 206f 7269 6769 6e61 6c20 696e 616d 6573   original inames
-0001df70: 2069 6e20 7468 6520 6361 7365 206f 6620   in the case of 
-0001df80: 6e6f 6e2d 676c 6f62 616c 206d 6f64 656c  non-global model
-0001df90: 732c 2061 6e64 2073 6574 2073 656c 662e  s, and set self.
-0001dfa0: 696e 616d 6573 2074 6f20 7468 6520 696e  inames to the in
-0001dfb0: 7075 7420 6d6f 6465 6c2e 2054 6869 7320  put model. This 
-0001dfc0: 6973 2062 6563 6175 7365 2069 6620 7468  is because if th
-0001dfd0: 6520 6d6f 6465 6c0a 2020 2020 2020 2020  e model.        
-0001dfe0: 2320 6973 206e 6f74 2067 6c6f 6261 6c2c  # is not global,
-0001dff0: 2069 6e20 6765 6e65 7261 6c20 7765 2064   in general we d
-0001e000: 6f6e 2774 2063 6172 6520 6162 6f75 7420  on't care about 
-0001e010: 6765 6e65 7261 7469 6e67 2074 6865 206d  generating the m
-0001e020: 6f64 656c 7320 666f 7220 7468 6520 6f74  odels for the ot
-0001e030: 6865 7220 696e 7374 7275 6d65 6e74 7320  her instruments 
-0001e040: 2861 6e64 2069 6e20 7468 6520 6c69 6768  (and in the ligh
-0001e050: 7463 7572 7665 2061 6e64 2052 5620 6576  tcurve and RV ev
-0001e060: 616c 7561 7469 6f6e 2070 6172 742c 0a20  aluation part,. 
-0001e070: 2020 2020 2020 2023 2073 656c 662e 696e         # self.in
-0001e080: 616d 6573 2069 7320 7573 6564 2074 6f20  ames is used to 
-0001e090: 6974 6572 6174 6520 7468 726f 7567 6820  iterate through 
-0001e0a0: 7468 6520 696e 7374 7275 6d65 6e74 7320  the instruments 
-0001e0b0: 6f6e 6520 7761 6e74 7320 746f 2065 7661  one wants to eva
-0001e0c0: 6c75 6174 6520 7468 6520 6d6f 6465 6c29  luate the model)
-0001e0d0: 3a0a 0a20 2020 2020 2020 2069 6620 6e6f  :..        if no
-0001e0e0: 7420 7365 6c66 2e67 6c6f 6261 6c5f 6d6f  t self.global_mo
-0001e0f0: 6465 6c3a 0a20 2020 2020 2020 2020 2020  del:.           
-0001e100: 206f 7269 6769 6e61 6c5f 696e 616d 6573   original_inames
-0001e110: 203d 206e 702e 636f 7079 2873 656c 662e   = np.copy(self.
-0001e120: 696e 616d 6573 290a 2020 2020 2020 2020  inames).        
-0001e130: 2020 2020 7365 6c66 2e69 6e61 6d65 7320      self.inames 
-0001e140: 3d20 5b69 6e73 7472 756d 656e 745d 0a20  = [instrument]. 
-0001e150: 2020 2020 2020 2020 2020 2069 6e73 7472             instr
-0001e160: 756d 656e 7473 203d 2073 656c 662e 6469  uments = self.di
-0001e170: 6374 696f 6e61 7279 2e6b 6579 7328 290a  ctionary.keys().
-0001e180: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001e190: 2020 2020 2020 2020 2020 696e 7374 7275            instru
-0001e1a0: 6d65 6e74 7320 3d20 7365 6c66 2e69 6e61  ments = self.ina
-0001e1b0: 6d65 730a 2020 2020 2020 2020 2320 4368  mes.        # Ch
-0001e1c0: 6563 6b20 6966 2075 7365 7220 6761 7665  eck if user gave
-0001e1d0: 2069 6e70 7574 2070 6172 616d 6574 6572   input parameter
-0001e1e0: 5f76 616c 7565 7320 6469 6374 696f 6e61  _values dictiona
-0001e1f0: 7279 2e20 4966 2074 6861 7427 7320 7468  ry. If that's th
-0001e200: 6520 6361 7365 2c20 6765 6e65 7261 7465  e case, generate
-0001e210: 2061 6761 696e 2074 6865 0a20 2020 2020   again the.     
-0001e220: 2020 2023 2066 756c 6c20 6c69 6768 7463     # full lightc
-0001e230: 7572 7665 2f72 7620 6d6f 6465 6c3a 0a20  urve/rv model:. 
-0001e240: 2020 2020 2020 2069 6620 7061 7261 6d65         if parame
-0001e250: 7465 725f 7661 6c75 6573 2069 7320 6e6f  ter_values is no
-0001e260: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0001e270: 2020 2020 2320 4966 2072 6574 7572 6e5f      # If return_
-0001e280: 636f 6d70 6f6e 656e 7473 2c20 6765 6e65  components, gene
-0001e290: 7261 7465 2074 6865 2063 6f6d 706f 6e65  rate the compone
-0001e2a0: 6e74 7320 6469 6374 696f 6e61 7279 3a0a  nts dictionary:.
-0001e2b0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-0001e2c0: 6574 7572 6e5f 636f 6d70 6f6e 656e 7473  eturn_components
-0001e2d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001e2e0: 2020 7365 6c66 2e6c 6f67 5f6c 696b 655f    self.log_like_
-0001e2f0: 6361 6c63 203d 2046 616c 7365 0a20 2020  calc = False.   
-0001e300: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-0001e310: 706f 6e65 6e74 7320 3d20 7b7d 0a20 2020  ponents = {}.   
-0001e320: 2020 2020 2020 2020 2023 204e 6f77 2c20           # Now, 
-0001e330: 636f 6e73 6964 6572 2074 776f 2070 6f73  consider two pos
-0001e340: 7369 626c 6520 6361 7365 732e 2049 6620  sible cases. If 
-0001e350: 7468 6520 7573 6572 2069 7320 6769 7669  the user is givi
-0001e360: 6e67 2061 2070 6172 616d 6574 6572 5f76  ng a parameter_v
-0001e370: 616c 7565 7320 7768 6572 6520 7468 6520  alues where the 
-0001e380: 6469 6374 696f 6e61 7279 2063 6f6e 7461  dictionary conta
-0001e390: 696e 7320 2a61 7272 6179 732a 206f 6620  ins *arrays* of 
-0001e3a0: 7661 6c75 6573 0a20 2020 2020 2020 2020  values.         
-0001e3b0: 2020 2023 2069 6e20 6974 2c20 7468 656e     # in it, then
-0001e3c0: 2069 7465 7261 7465 2074 6872 6f75 6768   iterate through
-0001e3d0: 2061 6c6c 2074 6865 2076 616c 7565 7320   all the values 
-0001e3e0: 696e 206f 7264 6572 2074 6f20 6361 6c63  in order to calc
-0001e3f0: 756c 6174 6520 7468 6520 6d65 6469 616e  ulate the median
-0001e400: 206d 6f64 656c 2e20 4966 2074 6865 2064   model. If the d
-0001e410: 6963 7469 6f6e 6172 7920 636f 6e74 6169  ictionary contai
-0001e420: 6e73 206f 6e6c 7920 696e 6469 7669 6475  ns only individu
-0001e430: 616c 0a20 2020 2020 2020 2020 2020 2023  al.            #
-0001e440: 2076 616c 7565 732c 2065 7661 6c75 6174   values, evaluat
-0001e450: 6520 7468 6520 6d6f 6465 6c20 6f6e 6c79  e the model only
-0001e460: 2061 7420 7468 6f73 6520 7661 6c75 6573   at those values
-0001e470: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
-0001e480: 7261 6d65 7465 7273 203d 206c 6973 7428  rameters = list(
-0001e490: 7365 6c66 2e70 7269 6f72 732e 6b65 7973  self.priors.keys
-0001e4a0: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
-0001e4b0: 696e 7075 745f 7061 7261 6d65 7465 7273  input_parameters
-0001e4c0: 203d 206c 6973 7428 7061 7261 6d65 7465   = list(paramete
-0001e4d0: 725f 7661 6c75 6573 2e6b 6579 7328 2929  r_values.keys())
-0001e4e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001e4f0: 7479 7065 2870 6172 616d 6574 6572 5f76  type(parameter_v
-0001e500: 616c 7565 735b 696e 7075 745f 7061 7261  alues[input_para
-0001e510: 6d65 7465 7273 5b30 5d5d 2920 6973 206e  meters[0]]) is n
-0001e520: 702e 6e64 6172 7261 793a 0a20 2020 2020  p.ndarray:.     
-0001e530: 2020 2020 2020 2020 2020 2023 2054 6f20             # To 
-0001e540: 6765 6e65 7261 7465 2061 206d 6564 6961  generate a media
-0001e550: 6e20 6d6f 6465 6c20 6669 7273 7420 6765  n model first ge
-0001e560: 6e65 7261 7465 2061 6e20 6f75 7470 7574  nerate an output
-0001e570: 5f6d 6f64 656c 5f73 616d 706c 6573 2061  _model_samples a
-0001e580: 7272 6179 2074 6861 7420 7769 6c6c 2073  rray that will s
-0001e590: 6176 6520 7468 6520 6d6f 6465 6c20 6174  ave the model at
-0001e5a0: 2065 6163 6820 6576 616c 7561 7469 6f6e   each evaluation
-0001e5b0: 2e20 5468 6973 2077 696c 6c0a 2020 2020  . This will.    
-0001e5c0: 2020 2020 2020 2020 2020 2020 2320 7361              # sa
-0001e5d0: 7665 206e 7361 6d70 6c65 7320 7361 6d70  ve nsamples samp
-0001e5e0: 6c65 7320 6f66 2074 6865 2070 6f73 7465  les of the poste
-0001e5f0: 7269 6f72 206d 6f64 656c 2e20 4966 2061  rior model. If a
-0001e600: 6c6c 5f73 616d 706c 6573 203d 2054 7275  ll_samples = Tru
-0001e610: 652c 2061 6c6c 2073 616d 706c 6573 2066  e, all samples f
-0001e620: 726f 6d20 7468 6520 706f 7374 6572 696f  rom the posterio
-0001e630: 7220 6172 6520 7573 6564 2066 6f72 2074  r are used for t
-0001e640: 6865 2065 7661 6c75 6174 6564 206d 6f64  he evaluated mod
-0001e650: 656c 0a20 2020 2020 2020 2020 2020 2020  el.             
-0001e660: 2020 2023 2028 7468 6973 2069 7320 736c     # (this is sl
-0001e670: 6f77 6572 2c20 6275 7420 7573 6572 206d  ower, but user m
-0001e680: 6967 6874 206e 6f74 2063 6172 6529 2e20  ight not care). 
-0001e690: 4669 7273 7420 6372 6561 7465 2069 6478  First create idx
-0001e6a0: 5f73 616d 706c 6573 2c20 7768 6963 6820  _samples, which 
-0001e6b0: 7769 6c6c 2073 6176 6520 7468 6520 696e  will save the in
-0001e6c0: 6465 7865 7320 6f66 2074 6865 2073 616d  dexes of the sam
-0001e6d0: 706c 6573 3a0a 2020 2020 2020 2020 2020  ples:.          
-0001e6e0: 2020 2020 2020 6e73 616d 706c 6564 203d        nsampled =
-0001e6f0: 206c 656e 2870 6172 616d 6574 6572 5f76   len(parameter_v
-0001e700: 616c 7565 735b 696e 7075 745f 7061 7261  alues[input_para
-0001e710: 6d65 7465 7273 5b30 5d5d 290a 2020 2020  meters[0]]).    
-0001e720: 2020 2020 2020 2020 2020 2020 6966 2061              if a
-0001e730: 6c6c 5f73 616d 706c 6573 3a0a 2020 2020  ll_samples:.    
-0001e740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e750: 6e73 616d 706c 6573 203d 206e 7361 6d70  nsamples = nsamp
-0001e760: 6c65 640a 2020 2020 2020 2020 2020 2020  led.            
-0001e770: 2020 2020 2020 2020 6964 785f 7361 6d70          idx_samp
-0001e780: 6c65 7320 3d20 6e70 2e61 7261 6e67 6528  les = np.arange(
-0001e790: 6e73 616d 706c 6573 290a 2020 2020 2020  nsamples).      
-0001e7a0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0001e7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e7c0: 2020 2020 6964 785f 7361 6d70 6c65 7320      idx_samples 
-0001e7d0: 3d20 6e70 2e72 616e 646f 6d2e 6368 6f69  = np.random.choi
-0001e7e0: 6365 286e 702e 6172 616e 6765 286e 7361  ce(np.arange(nsa
-0001e7f0: 6d70 6c65 6429 2c0a 2020 2020 2020 2020  mpled),.        
-0001e800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e820: 2020 2020 2020 2020 2020 206e 702e 6d69             np.mi
-0001e830: 6e28 5b6e 7361 6d70 6c65 732c 206e 7361  n([nsamples, nsa
-0001e840: 6d70 6c65 645d 292c 0a20 2020 2020 2020  mpled]),.       
-0001e850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e870: 2020 2020 2020 2020 2020 2020 7265 706c              repl
-0001e880: 6163 653d 4661 6c73 6529 0a20 2020 2020  ace=False).     
-0001e890: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001e8a0: 6478 5f73 616d 706c 6573 203d 2069 6478  dx_samples = idx
-0001e8b0: 5f73 616d 706c 6573 5b6e 702e 6172 6773  _samples[np.args
-0001e8c0: 6f72 7428 6964 785f 7361 6d70 6c65 7329  ort(idx_samples)
-0001e8d0: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
-0001e8e0: 2020 2023 2043 7265 6174 6520 7468 6520     # Create the 
-0001e8f0: 6f75 7470 7574 5f6d 6f64 656c 2061 7272  output_model arr
-0001e900: 6179 733a 2074 6865 7365 2077 696c 6c20  ays: these will 
-0001e910: 7361 7665 206f 6e20 6561 6368 2069 7465  save on each ite
-0001e920: 7261 7469 6f6e 2074 6865 2066 756c 6c20  ration the full 
-0001e930: 6d6f 6465 6c20 286c 632f 7276 202b 2047  model (lc/rv + G
-0001e940: 502c 206f 7574 7075 745f 6d6f 6465 6c5f  P, output_model_
-0001e950: 7361 6d70 6c65 7329 2c20 0a20 2020 2020  samples), .     
-0001e960: 2020 2020 2020 2020 2020 2023 2074 6865             # the
-0001e970: 2047 502d 6f6e 6c79 206d 6f64 656c 2028   GP-only model (
-0001e980: 4750 2c20 6f75 7470 7574 5f6d 6f64 656c  GP, output_model
-0001e990: 4750 5f73 616d 706c 6573 2920 616e 6420  GP_samples) and 
-0001e9a0: 7468 6520 6c63 2f72 762d 6f6e 6c79 206d  the lc/rv-only m
-0001e9b0: 6f64 656c 2028 6c63 2f72 762c 206f 7574  odel (lc/rv, out
-0001e9c0: 7075 745f 6d6f 6465 6c44 4554 5f73 616d  put_modelDET_sam
-0001e9d0: 706c 6573 2920 2d2d 2d20 7468 6520 6c61  ples) --- the la
-0001e9e0: 7474 6572 206f 6e65 7320 0a20 2020 2020  tter ones .     
-0001e9f0: 2020 2020 2020 2020 2020 2023 2077 696c             # wil
-0001ea00: 6c20 6d61 6b65 2073 656e 7365 206f 6e6c  l make sense onl
-0001ea10: 7920 6966 2074 6865 7265 2069 7320 6120  y if there is a 
-0001ea20: 4750 206d 6f64 656c 2e20 4966 206e 6f74  GP model. If not
-0001ea30: 2c20 6974 2077 696c 6c20 6265 2061 207a  , it will be a z
-0001ea40: 6572 6f2d 6172 7261 7920 7468 726f 7567  ero-array throug
-0001ea50: 686f 7574 2074 6865 2065 7661 6c75 6174  hout the evaluat
-0001ea60: 696f 6e20 7072 6f63 6573 733a 0a20 2020  ion process:.   
-0001ea70: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001ea80: 7420 6973 204e 6f6e 653a 0a20 2020 2020  t is None:.     
+0001dee0: 2020 2020 2020 2020 2020 206e 7265 7361             nresa
+0001def0: 6d70 6c69 6e67 3d6e 7265 7361 6d70 6c69  mpling=nresampli
+0001df00: 6e67 2c20 6574 7265 7361 6d70 6c69 6e67  ng, etresampling
+0001df10: 3d65 7472 6573 616d 706c 696e 6729 0a20  =etresampling). 
+0001df20: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001df30: 6c69 6620 7365 6c66 2e64 6963 7469 6f6e  lif self.diction
+0001df40: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
+0001df50: 2745 636c 6970 7365 4669 7427 5d3a 0a20  'EclipseFit']:. 
+0001df60: 2020 2020 2020 2020 2020 2020 2020 200a                 .
+0001df70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001df80: 2020 2020 7365 6c66 2e6d 6f64 656c 5b69      self.model[i
+0001df90: 6e73 7472 756d 656e 745d 5b27 7061 7261  nstrument]['para
+0001dfa0: 6d73 275d 2c20 5b5f 2c73 656c 662e 6d6f  ms'], [_,self.mo
+0001dfb0: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
+0001dfc0: 276d 275d 5d20 3d20 696e 6974 5f62 6174  'm']] = init_bat
+0001dfd0: 6d61 6e28 7365 6c66 2e74 696d 6573 5b69  man(self.times[i
+0001dfe0: 6e73 7472 756d 656e 745d 2c20 7365 6c66  nstrument], self
+0001dff0: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
+0001e000: 7275 6d65 6e74 5d5b 276c 646c 6177 275d  rument]['ldlaw']
+0001e010: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001e020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e070: 2020 2020 2020 6e72 6573 616d 706c 696e        nresamplin
+0001e080: 673d 6e72 6573 616d 706c 696e 672c 2065  g=nresampling, e
+0001e090: 7472 6573 616d 706c 696e 673d 6574 7265  tresampling=etre
+0001e0a0: 7361 6d70 6c69 6e67 290a 2020 2020 2020  sampling).      
+0001e0b0: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
+0001e0c0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001e0d0: 6c69 6620 7365 6c66 2e64 6963 7469 6f6e  lif self.diction
+0001e0e0: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
+0001e0f0: 2754 7261 6e45 636c 4669 7427 5d3a 0a20  'TranEclFit']:. 
+0001e100: 2020 2020 2020 2020 2020 2020 2020 200a                 .
+0001e110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e120: 2020 2020 7365 6c66 2e6d 6f64 656c 5b69      self.model[i
+0001e130: 6e73 7472 756d 656e 745d 5b27 7061 7261  nstrument]['para
+0001e140: 6d73 275d 2c20 7365 6c66 2e6d 6f64 656c  ms'], self.model
+0001e150: 5b69 6e73 7472 756d 656e 745d 5b27 6d27  [instrument]['m'
+0001e160: 5d20 3d20 696e 6974 5f62 6174 6d61 6e28  ] = init_batman(
+0001e170: 7365 6c66 2e74 696d 6573 5b69 6e73 7472  self.times[instr
+0001e180: 756d 656e 745d 2c20 7365 6c66 2e64 6963  ument], self.dic
+0001e190: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
+0001e1a0: 6e74 5d5b 276c 646c 6177 275d 2c0a 2020  nt]['ldlaw'],.  
+0001e1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e210: 2020 6e72 6573 616d 706c 696e 673d 6e72    nresampling=nr
+0001e220: 6573 616d 706c 696e 672c 2065 7472 6573  esampling, etres
+0001e230: 616d 706c 696e 673d 6574 7265 7361 6d70  ampling=etresamp
+0001e240: 6c69 6e67 290a 2020 2020 2020 2020 2020  ling).          
+0001e250: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001e260: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+0001e270: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
+0001e280: 7061 7261 6d73 275d 2c20 7365 6c66 2e6d  params'], self.m
+0001e290: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
+0001e2a0: 5b27 6d27 5d20 3d20 696e 6974 5f63 6174  ['m'] = init_cat
+0001e2b0: 776f 6d61 6e28 7365 6c66 2e74 696d 6573  woman(self.times
+0001e2c0: 5b69 6e73 7472 756d 656e 745d 2c20 7365  [instrument], se
+0001e2d0: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
+0001e2e0: 7374 7275 6d65 6e74 5d5b 276c 646c 6177  strument]['ldlaw
+0001e2f0: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
+0001e300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e350: 2020 2020 6e72 6573 616d 706c 696e 673d      nresampling=
+0001e360: 6e72 6573 616d 706c 696e 672c 2065 7472  nresampling, etr
+0001e370: 6573 616d 706c 696e 673d 6574 7265 7361  esampling=etresa
+0001e380: 6d70 6c69 6e67 290a 0a0a 2020 2020 2020  mpling)...      
+0001e390: 2020 2320 5361 7665 2074 6865 206f 7269    # Save the ori
+0001e3a0: 6769 6e61 6c20 696e 616d 6573 2069 6e20  ginal inames in 
+0001e3b0: 7468 6520 6361 7365 206f 6620 6e6f 6e2d  the case of non-
+0001e3c0: 676c 6f62 616c 206d 6f64 656c 732c 2061  global models, a
+0001e3d0: 6e64 2073 6574 2073 656c 662e 696e 616d  nd set self.inam
+0001e3e0: 6573 2074 6f20 7468 6520 696e 7075 7420  es to the input 
+0001e3f0: 6d6f 6465 6c2e 2054 6869 7320 6973 2062  model. This is b
+0001e400: 6563 6175 7365 2069 6620 7468 6520 6d6f  ecause if the mo
+0001e410: 6465 6c0a 2020 2020 2020 2020 2320 6973  del.        # is
+0001e420: 206e 6f74 2067 6c6f 6261 6c2c 2069 6e20   not global, in 
+0001e430: 6765 6e65 7261 6c20 7765 2064 6f6e 2774  general we don't
+0001e440: 2063 6172 6520 6162 6f75 7420 6765 6e65   care about gene
+0001e450: 7261 7469 6e67 2074 6865 206d 6f64 656c  rating the model
+0001e460: 7320 666f 7220 7468 6520 6f74 6865 7220  s for the other 
+0001e470: 696e 7374 7275 6d65 6e74 7320 2861 6e64  instruments (and
+0001e480: 2069 6e20 7468 6520 6c69 6768 7463 7572   in the lightcur
+0001e490: 7665 2061 6e64 2052 5620 6576 616c 7561  ve and RV evalua
+0001e4a0: 7469 6f6e 2070 6172 742c 0a20 2020 2020  tion part,.     
+0001e4b0: 2020 2023 2073 656c 662e 696e 616d 6573     # self.inames
+0001e4c0: 2069 7320 7573 6564 2074 6f20 6974 6572   is used to iter
+0001e4d0: 6174 6520 7468 726f 7567 6820 7468 6520  ate through the 
+0001e4e0: 696e 7374 7275 6d65 6e74 7320 6f6e 6520  instruments one 
+0001e4f0: 7761 6e74 7320 746f 2065 7661 6c75 6174  wants to evaluat
+0001e500: 6520 7468 6520 6d6f 6465 6c29 3a0a 0a20  e the model):.. 
+0001e510: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+0001e520: 6c66 2e67 6c6f 6261 6c5f 6d6f 6465 6c3a  lf.global_model:
+0001e530: 0a20 2020 2020 2020 2020 2020 206f 7269  .            ori
+0001e540: 6769 6e61 6c5f 696e 616d 6573 203d 206e  ginal_inames = n
+0001e550: 702e 636f 7079 2873 656c 662e 696e 616d  p.copy(self.inam
+0001e560: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
+0001e570: 7365 6c66 2e69 6e61 6d65 7320 3d20 5b69  self.inames = [i
+0001e580: 6e73 7472 756d 656e 745d 0a20 2020 2020  nstrument].     
+0001e590: 2020 2020 2020 2069 6e73 7472 756d 656e         instrumen
+0001e5a0: 7473 203d 2073 656c 662e 6469 6374 696f  ts = self.dictio
+0001e5b0: 6e61 7279 2e6b 6579 7328 290a 2020 2020  nary.keys().    
+0001e5c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001e5d0: 2020 2020 2020 696e 7374 7275 6d65 6e74        instrument
+0001e5e0: 7320 3d20 7365 6c66 2e69 6e61 6d65 730a  s = self.inames.
+0001e5f0: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
+0001e600: 6966 2075 7365 7220 6761 7665 2069 6e70  if user gave inp
+0001e610: 7574 2070 6172 616d 6574 6572 5f76 616c  ut parameter_val
+0001e620: 7565 7320 6469 6374 696f 6e61 7279 2e20  ues dictionary. 
+0001e630: 4966 2074 6861 7427 7320 7468 6520 6361  If that's the ca
+0001e640: 7365 2c20 6765 6e65 7261 7465 2061 6761  se, generate aga
+0001e650: 696e 2074 6865 0a20 2020 2020 2020 2023  in the.        #
+0001e660: 2066 756c 6c20 6c69 6768 7463 7572 7665   full lightcurve
+0001e670: 2f72 7620 6d6f 6465 6c3a 0a20 2020 2020  /rv model:.     
+0001e680: 2020 2069 6620 7061 7261 6d65 7465 725f     if parameter_
+0001e690: 7661 6c75 6573 2069 7320 6e6f 7420 4e6f  values is not No
+0001e6a0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0001e6b0: 2320 4966 2072 6574 7572 6e5f 636f 6d70  # If return_comp
+0001e6c0: 6f6e 656e 7473 2c20 6765 6e65 7261 7465  onents, generate
+0001e6d0: 2074 6865 2063 6f6d 706f 6e65 6e74 7320   the components 
+0001e6e0: 6469 6374 696f 6e61 7279 3a0a 2020 2020  dictionary:.    
+0001e6f0: 2020 2020 2020 2020 6966 2072 6574 7572          if retur
+0001e700: 6e5f 636f 6d70 6f6e 656e 7473 3a0a 2020  n_components:.  
+0001e710: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001e720: 6c66 2e6c 6f67 5f6c 696b 655f 6361 6c63  lf.log_like_calc
+0001e730: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+0001e740: 2020 2020 2020 2020 2063 6f6d 706f 6e65           compone
+0001e750: 6e74 7320 3d20 7b7d 0a20 2020 2020 2020  nts = {}.       
+0001e760: 2020 2020 2023 204e 6f77 2c20 636f 6e73       # Now, cons
+0001e770: 6964 6572 2074 776f 2070 6f73 7369 626c  ider two possibl
+0001e780: 6520 6361 7365 732e 2049 6620 7468 6520  e cases. If the 
+0001e790: 7573 6572 2069 7320 6769 7669 6e67 2061  user is giving a
+0001e7a0: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
+0001e7b0: 7320 7768 6572 6520 7468 6520 6469 6374  s where the dict
+0001e7c0: 696f 6e61 7279 2063 6f6e 7461 696e 7320  ionary contains 
+0001e7d0: 2a61 7272 6179 732a 206f 6620 7661 6c75  *arrays* of valu
+0001e7e0: 6573 0a20 2020 2020 2020 2020 2020 2023  es.            #
+0001e7f0: 2069 6e20 6974 2c20 7468 656e 2069 7465   in it, then ite
+0001e800: 7261 7465 2074 6872 6f75 6768 2061 6c6c  rate through all
+0001e810: 2074 6865 2076 616c 7565 7320 696e 206f   the values in o
+0001e820: 7264 6572 2074 6f20 6361 6c63 756c 6174  rder to calculat
+0001e830: 6520 7468 6520 6d65 6469 616e 206d 6f64  e the median mod
+0001e840: 656c 2e20 4966 2074 6865 2064 6963 7469  el. If the dicti
+0001e850: 6f6e 6172 7920 636f 6e74 6169 6e73 206f  onary contains o
+0001e860: 6e6c 7920 696e 6469 7669 6475 616c 0a20  nly individual. 
+0001e870: 2020 2020 2020 2020 2020 2023 2076 616c             # val
+0001e880: 7565 732c 2065 7661 6c75 6174 6520 7468  ues, evaluate th
+0001e890: 6520 6d6f 6465 6c20 6f6e 6c79 2061 7420  e model only at 
+0001e8a0: 7468 6f73 6520 7661 6c75 6573 3a0a 2020  those values:.  
+0001e8b0: 2020 2020 2020 2020 2020 7061 7261 6d65            parame
+0001e8c0: 7465 7273 203d 206c 6973 7428 7365 6c66  ters = list(self
+0001e8d0: 2e70 7269 6f72 732e 6b65 7973 2829 290a  .priors.keys()).
+0001e8e0: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+0001e8f0: 745f 7061 7261 6d65 7465 7273 203d 206c  t_parameters = l
+0001e900: 6973 7428 7061 7261 6d65 7465 725f 7661  ist(parameter_va
+0001e910: 6c75 6573 2e6b 6579 7328 2929 0a20 2020  lues.keys()).   
+0001e920: 2020 2020 2020 2020 2069 6620 7479 7065           if type
+0001e930: 2870 6172 616d 6574 6572 5f76 616c 7565  (parameter_value
+0001e940: 735b 696e 7075 745f 7061 7261 6d65 7465  s[input_paramete
+0001e950: 7273 5b30 5d5d 2920 6973 206e 702e 6e64  rs[0]]) is np.nd
+0001e960: 6172 7261 793a 0a20 2020 2020 2020 2020  array:.         
+0001e970: 2020 2020 2020 2023 2054 6f20 6765 6e65         # To gene
+0001e980: 7261 7465 2061 206d 6564 6961 6e20 6d6f  rate a median mo
+0001e990: 6465 6c20 6669 7273 7420 6765 6e65 7261  del first genera
+0001e9a0: 7465 2061 6e20 6f75 7470 7574 5f6d 6f64  te an output_mod
+0001e9b0: 656c 5f73 616d 706c 6573 2061 7272 6179  el_samples array
+0001e9c0: 2074 6861 7420 7769 6c6c 2073 6176 6520   that will save 
+0001e9d0: 7468 6520 6d6f 6465 6c20 6174 2065 6163  the model at eac
+0001e9e0: 6820 6576 616c 7561 7469 6f6e 2e20 5468  h evaluation. Th
+0001e9f0: 6973 2077 696c 6c0a 2020 2020 2020 2020  is will.        
+0001ea00: 2020 2020 2020 2020 2320 7361 7665 206e          # save n
+0001ea10: 7361 6d70 6c65 7320 7361 6d70 6c65 7320  samples samples 
+0001ea20: 6f66 2074 6865 2070 6f73 7465 7269 6f72  of the posterior
+0001ea30: 206d 6f64 656c 2e20 4966 2061 6c6c 5f73   model. If all_s
+0001ea40: 616d 706c 6573 203d 2054 7275 652c 2061  amples = True, a
+0001ea50: 6c6c 2073 616d 706c 6573 2066 726f 6d20  ll samples from 
+0001ea60: 7468 6520 706f 7374 6572 696f 7220 6172  the posterior ar
+0001ea70: 6520 7573 6564 2066 6f72 2074 6865 2065  e used for the e
+0001ea80: 7661 6c75 6174 6564 206d 6f64 656c 0a20  valuated model. 
 0001ea90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0001eaa0: 2049 6620 7573 6572 2064 6964 206e 6f74   If user did not
-0001eab0: 2067 6976 6520 696e 7075 7420 7469 6d65   give input time
-0001eac0: 732c 2074 6865 6e20 6f75 7470 7574 2073  s, then output s
-0001ead0: 616d 706c 6573 2066 6f6c 6c6f 7720 7468  amples follow th
-0001eae0: 6520 7469 6d65 7320 6f6e 2077 6869 6368  e times on which
-0001eaf0: 2074 6865 206d 6f64 656c 2077 6173 2066   the model was f
-0001eb00: 6974 7465 643a 0a20 2020 2020 2020 2020  itted:.         
-0001eb10: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0001eb20: 6c66 2e67 6c6f 6261 6c5f 6d6f 6465 6c3a  lf.global_model:
-0001eb30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001eb40: 2020 2020 2020 2020 206f 7574 7075 745f           output_
-0001eb50: 6d6f 6465 6c5f 7361 6d70 6c65 7320 3d20  model_samples = 
-0001eb60: 6e70 2e7a 6572 6f73 280a 2020 2020 2020  np.zeros(.      
-0001eb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eb80: 2020 2020 2020 5b6e 7361 6d70 6c65 732c        [nsamples,
-0001eb90: 2073 656c 662e 6e64 6174 6170 6f69 6e74   self.ndatapoint
-0001eba0: 735f 616c 6c5f 696e 7374 7275 6d65 6e74  s_all_instrument
-0001ebb0: 735d 290a 2020 2020 2020 2020 2020 2020  s]).            
-0001ebc0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001ebd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ebe0: 2020 2020 2020 6f75 7470 7574 5f6d 6f64        output_mod
-0001ebf0: 656c 5f73 616d 706c 6573 203d 206e 702e  el_samples = np.
-0001ec00: 7a65 726f 7328 5b0a 2020 2020 2020 2020  zeros([.        
-0001ec10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ec20: 2020 2020 6e73 616d 706c 6573 2c0a 2020      nsamples,.  
-0001ec30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ec40: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
-0001ec50: 6461 7461 706f 696e 7473 5f70 6572 5f69  datapoints_per_i
-0001ec60: 6e73 7472 756d 656e 745b 696e 7374 7275  nstrument[instru
-0001ec70: 6d65 6e74 5d0a 2020 2020 2020 2020 2020  ment].          
-0001ec80: 2020 2020 2020 2020 2020 2020 2020 5d29                ])
-0001ec90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001eca0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001ecb0: 2020 2020 2020 2020 2020 2023 2049 6620             # If 
-0001ecc0: 7573 6572 2067 6176 6520 696e 7075 7420  user gave input 
-0001ecd0: 7469 6d65 7320 2875 7375 616c 6c79 2065  times (usually e
-0001ece0: 7874 7261 706f 6c61 7469 6e67 2066 726f  xtrapolating fro
-0001ecf0: 6d20 7468 6520 7469 6d65 7320 7468 6520  m the times the 
-0001ed00: 6d6f 6465 6c20 7761 7320 6669 7474 6564  model was fitted
-0001ed10: 206f 6e29 2c20 7468 656e 0a20 2020 2020   on), then.     
-0001ed20: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0001ed30: 2073 6176 6520 7468 6520 6e75 6d62 6572   save the number
-0001ed40: 206f 6620 706f 696e 7473 2069 6e20 7468   of points in th
-0001ed50: 6973 2069 6e70 7574 2061 7272 6179 3a0a  is input array:.
-0001ed60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ed70: 2020 2020 6e74 203d 206c 656e 2874 290a      nt = len(t).
-0001ed80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ed90: 2020 2020 2320 416e 6420 6d6f 6469 6679      # And modify
-0001eda0: 2074 6865 206c 656e 6774 6820 6f66 2074   the length of t
-0001edb0: 6865 206f 7574 7075 7420 7361 6d70 6c65  he output sample
-0001edc0: 732c 2077 6869 6368 2077 696c 6c20 6e6f  s, which will no
-0001edd0: 7720 6265 2061 206d 6174 7269 7820 7769  w be a matrix wi
-0001ede0: 7468 2064 696d 656e 7369 6f6e 7320 286e  th dimensions (n
-0001edf0: 756d 6265 7220 6f66 2073 616d 706c 6573  umber of samples
-0001ee00: 2c20 696e 7075 7420 7469 6d65 7329 3a0a  , input times):.
-0001ee10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee20: 2020 2020 6f75 7470 7574 5f6d 6f64 656c      output_model
-0001ee30: 5f73 616d 706c 6573 203d 206e 702e 7a65  _samples = np.ze
-0001ee40: 726f 7328 5b6e 7361 6d70 6c65 732c 206e  ros([nsamples, n
-0001ee50: 745d 290a 2020 2020 2020 2020 2020 2020  t]).            
-0001ee60: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001ee70: 676c 6f62 616c 5f6d 6f64 656c 3a0a 2020  global_model:.  
-0001ee80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee90: 2020 2020 2020 2320 4966 206d 6f64 656c        # If model
-0001eea0: 2069 7320 676c 6f62 616c 2c20 6974 206d   is global, it m
-0001eeb0: 6561 6e73 2074 6865 7265 2069 7320 616e  eans there is an
-0001eec0: 2075 6e64 6572 6c79 696e 6720 676c 6f62   underlying glob
-0001eed0: 616c 206e 6f69 7365 206d 6f64 656c 2c20  al noise model, 
-0001eee0: 736f 2077 6520 6861 7665 2074 6f20 6576  so we have to ev
-0001eef0: 616c 7561 7465 2074 6865 206d 6f64 656c  aluate the model
-0001ef00: 2069 6e20 2a61 6c6c 2a20 7468 6520 696e   in *all* the in
-0001ef10: 7374 7275 6d65 6e74 730a 2020 2020 2020  struments.      
-0001ef20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ef30: 2020 2320 6265 6361 7573 6520 7468 6520    # because the 
-0001ef40: 4750 2063 6f6d 706f 6e65 6e74 2069 7320  GP component is 
-0001ef50: 6f6e 6c79 2065 7874 7261 6374 6162 6c65  only extractable
-0001ef60: 206f 6e63 6520 7765 2068 6176 6520 7468   once we have th
-0001ef70: 6520 6675 6c6c 2072 6573 6964 7561 6c73  e full residuals
-0001ef80: 2e20 4265 6361 7573 6520 6f66 2074 6869  . Because of thi
-0001ef90: 732c 2077 6520 6765 6e65 7261 7465 2064  s, we generate d
-0001efa0: 6963 7469 6f6e 6172 6965 7320 7468 6174  ictionaries that
-0001efb0: 2073 6176 650a 2020 2020 2020 2020 2020   save.          
-0001efc0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0001efd0: 7468 6520 6f72 6967 696e 616c 206e 756d  the original num
-0001efe0: 6265 7220 6f66 2064 6174 6170 6f69 6e74  ber of datapoint
-0001eff0: 7320 666f 7220 6561 6368 2069 6e73 7472  s for each instr
-0001f000: 756d 656e 7420 616e 6420 7468 6520 6f72  ument and the or
-0001f010: 6967 696e 616c 2074 696d 6573 206f 6620  iginal times of 
-0001f020: 6561 6368 2069 6e73 7472 756d 656e 742e  each instrument.
-0001f030: 2054 6869 7320 6973 2075 7365 6675 6c20   This is useful 
-0001f040: 6265 6361 7573 6520 6c61 7465 7220 7765  because later we
-0001f050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f060: 2020 2020 2020 2020 2023 2077 696c 6c20           # will 
-0001f070: 7377 6974 6368 2062 6163 6b20 616e 6420  switch back and 
-0001f080: 666f 7274 6820 6672 6f6d 2074 6865 206f  forth from the o
-0001f090: 7269 6769 6e61 6c20 7469 6d65 7320 2874  riginal times (t
-0001f0a0: 6f20 6576 616c 7561 7465 2074 6865 206d  o evaluate the m
-0001f0b0: 6f64 656c 2061 6e64 2067 6574 2074 6865  odel and get the
-0001f0c0: 2072 6573 6964 7561 6c73 2920 746f 2074   residuals) to t
-0001f0d0: 6865 2069 6e70 7574 2074 696d 6573 2028  he input times (
-0001f0e0: 746f 2067 656e 6572 6174 650a 2020 2020  to generate.    
-0001f0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f100: 2020 2020 2320 7072 6564 6963 7469 6f6e      # prediction
-0001f110: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-0001f120: 2020 2020 2020 2020 2020 2020 6e74 5f6f              nt_o
-0001f130: 7269 6769 6e61 6c2c 206f 7269 6769 6e61  riginal, origina
-0001f140: 6c5f 696e 7374 7275 6d65 6e74 5f74 696d  l_instrument_tim
-0001f150: 6573 203d 207b 7d2c 207b 7d0a 2020 2020  es = {}, {}.    
-0001f160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f170: 2020 2020 666f 7220 6769 6e73 7472 756d      for ginstrum
-0001f180: 656e 7420 696e 2069 6e73 7472 756d 656e  ent in instrumen
-0001f190: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
+0001eaa0: 2028 7468 6973 2069 7320 736c 6f77 6572   (this is slower
+0001eab0: 2c20 6275 7420 7573 6572 206d 6967 6874  , but user might
+0001eac0: 206e 6f74 2063 6172 6529 2e20 4669 7273   not care). Firs
+0001ead0: 7420 6372 6561 7465 2069 6478 5f73 616d  t create idx_sam
+0001eae0: 706c 6573 2c20 7768 6963 6820 7769 6c6c  ples, which will
+0001eaf0: 2073 6176 6520 7468 6520 696e 6465 7865   save the indexe
+0001eb00: 7320 6f66 2074 6865 2073 616d 706c 6573  s of the samples
+0001eb10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001eb20: 2020 6e73 616d 706c 6564 203d 206c 656e    nsampled = len
+0001eb30: 2870 6172 616d 6574 6572 5f76 616c 7565  (parameter_value
+0001eb40: 735b 696e 7075 745f 7061 7261 6d65 7465  s[input_paramete
+0001eb50: 7273 5b30 5d5d 290a 2020 2020 2020 2020  rs[0]]).        
+0001eb60: 2020 2020 2020 2020 6966 2061 6c6c 5f73          if all_s
+0001eb70: 616d 706c 6573 3a0a 2020 2020 2020 2020  amples:.        
+0001eb80: 2020 2020 2020 2020 2020 2020 6e73 616d              nsam
+0001eb90: 706c 6573 203d 206e 7361 6d70 6c65 640a  ples = nsampled.
+0001eba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ebb0: 2020 2020 6964 785f 7361 6d70 6c65 7320      idx_samples 
+0001ebc0: 3d20 6e70 2e61 7261 6e67 6528 6e73 616d  = np.arange(nsam
+0001ebd0: 706c 6573 290a 2020 2020 2020 2020 2020  ples).          
+0001ebe0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001ebf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ec00: 6964 785f 7361 6d70 6c65 7320 3d20 6e70  idx_samples = np
+0001ec10: 2e72 616e 646f 6d2e 6368 6f69 6365 286e  .random.choice(n
+0001ec20: 702e 6172 616e 6765 286e 7361 6d70 6c65  p.arange(nsample
+0001ec30: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
+0001ec40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ec50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ec60: 2020 2020 2020 206e 702e 6d69 6e28 5b6e         np.min([n
+0001ec70: 7361 6d70 6c65 732c 206e 7361 6d70 6c65  samples, nsample
+0001ec80: 645d 292c 0a20 2020 2020 2020 2020 2020  d]),.           
+0001ec90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ecb0: 2020 2020 2020 2020 7265 706c 6163 653d          replace=
+0001ecc0: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
+0001ecd0: 2020 2020 2020 2020 2020 2069 6478 5f73             idx_s
+0001ece0: 616d 706c 6573 203d 2069 6478 5f73 616d  amples = idx_sam
+0001ecf0: 706c 6573 5b6e 702e 6172 6773 6f72 7428  ples[np.argsort(
+0001ed00: 6964 785f 7361 6d70 6c65 7329 5d0a 0a20  idx_samples)].. 
+0001ed10: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0001ed20: 2043 7265 6174 6520 7468 6520 6f75 7470   Create the outp
+0001ed30: 7574 5f6d 6f64 656c 2061 7272 6179 733a  ut_model arrays:
+0001ed40: 2074 6865 7365 2077 696c 6c20 7361 7665   these will save
+0001ed50: 206f 6e20 6561 6368 2069 7465 7261 7469   on each iterati
+0001ed60: 6f6e 2074 6865 2066 756c 6c20 6d6f 6465  on the full mode
+0001ed70: 6c20 286c 632f 7276 202b 2047 502c 206f  l (lc/rv + GP, o
+0001ed80: 7574 7075 745f 6d6f 6465 6c5f 7361 6d70  utput_model_samp
+0001ed90: 6c65 7329 2c20 0a20 2020 2020 2020 2020  les), .         
+0001eda0: 2020 2020 2020 2023 2074 6865 2047 502d         # the GP-
+0001edb0: 6f6e 6c79 206d 6f64 656c 2028 4750 2c20  only model (GP, 
+0001edc0: 6f75 7470 7574 5f6d 6f64 656c 4750 5f73  output_modelGP_s
+0001edd0: 616d 706c 6573 2920 616e 6420 7468 6520  amples) and the 
+0001ede0: 6c63 2f72 762d 6f6e 6c79 206d 6f64 656c  lc/rv-only model
+0001edf0: 2028 6c63 2f72 762c 206f 7574 7075 745f   (lc/rv, output_
+0001ee00: 6d6f 6465 6c44 4554 5f73 616d 706c 6573  modelDET_samples
+0001ee10: 2920 2d2d 2d20 7468 6520 6c61 7474 6572  ) --- the latter
+0001ee20: 206f 6e65 7320 0a20 2020 2020 2020 2020   ones .         
+0001ee30: 2020 2020 2020 2023 2077 696c 6c20 6d61         # will ma
+0001ee40: 6b65 2073 656e 7365 206f 6e6c 7920 6966  ke sense only if
+0001ee50: 2074 6865 7265 2069 7320 6120 4750 206d   there is a GP m
+0001ee60: 6f64 656c 2e20 4966 206e 6f74 2c20 6974  odel. If not, it
+0001ee70: 2077 696c 6c20 6265 2061 207a 6572 6f2d   will be a zero-
+0001ee80: 6172 7261 7920 7468 726f 7567 686f 7574  array throughout
+0001ee90: 2074 6865 2065 7661 6c75 6174 696f 6e20   the evaluation 
+0001eea0: 7072 6f63 6573 733a 0a20 2020 2020 2020  process:.       
+0001eeb0: 2020 2020 2020 2020 2069 6620 7420 6973           if t is
+0001eec0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0001eed0: 2020 2020 2020 2020 2020 2023 2049 6620             # If 
+0001eee0: 7573 6572 2064 6964 206e 6f74 2067 6976  user did not giv
+0001eef0: 6520 696e 7075 7420 7469 6d65 732c 2074  e input times, t
+0001ef00: 6865 6e20 6f75 7470 7574 2073 616d 706c  hen output sampl
+0001ef10: 6573 2066 6f6c 6c6f 7720 7468 6520 7469  es follow the ti
+0001ef20: 6d65 7320 6f6e 2077 6869 6368 2074 6865  mes on which the
+0001ef30: 206d 6f64 656c 2077 6173 2066 6974 7465   model was fitte
+0001ef40: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+0001ef50: 2020 2020 2020 2069 6620 7365 6c66 2e67         if self.g
+0001ef60: 6c6f 6261 6c5f 6d6f 6465 6c3a 0a20 2020  lobal_model:.   
+0001ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef80: 2020 2020 206f 7574 7075 745f 6d6f 6465       output_mode
+0001ef90: 6c5f 7361 6d70 6c65 7320 3d20 6e70 2e7a  l_samples = np.z
+0001efa0: 6572 6f73 280a 2020 2020 2020 2020 2020  eros(.          
+0001efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001efc0: 2020 5b6e 7361 6d70 6c65 732c 2073 656c    [nsamples, sel
+0001efd0: 662e 6e64 6174 6170 6f69 6e74 735f 616c  f.ndatapoints_al
+0001efe0: 6c5f 696e 7374 7275 6d65 6e74 735d 290a  l_instruments]).
+0001eff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f000: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001f010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f020: 2020 6f75 7470 7574 5f6d 6f64 656c 5f73    output_model_s
+0001f030: 616d 706c 6573 203d 206e 702e 7a65 726f  amples = np.zero
+0001f040: 7328 5b0a 2020 2020 2020 2020 2020 2020  s([.            
+0001f050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f060: 6e73 616d 706c 6573 2c0a 2020 2020 2020  nsamples,.      
+0001f070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f080: 2020 2020 2020 7365 6c66 2e6e 6461 7461        self.ndata
+0001f090: 706f 696e 7473 5f70 6572 5f69 6e73 7472  points_per_instr
+0001f0a0: 756d 656e 745b 696e 7374 7275 6d65 6e74  ument[instrument
+0001f0b0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0001f0c0: 2020 2020 2020 2020 2020 5d29 0a20 2020            ]).   
+0001f0d0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0001f0e0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0001f0f0: 2020 2020 2020 2023 2049 6620 7573 6572         # If user
+0001f100: 2067 6176 6520 696e 7075 7420 7469 6d65   gave input time
+0001f110: 7320 2875 7375 616c 6c79 2065 7874 7261  s (usually extra
+0001f120: 706f 6c61 7469 6e67 2066 726f 6d20 7468  polating from th
+0001f130: 6520 7469 6d65 7320 7468 6520 6d6f 6465  e times the mode
+0001f140: 6c20 7761 7320 6669 7474 6564 206f 6e29  l was fitted on)
+0001f150: 2c20 7468 656e 0a20 2020 2020 2020 2020  , then.         
+0001f160: 2020 2020 2020 2020 2020 2023 2073 6176             # sav
+0001f170: 6520 7468 6520 6e75 6d62 6572 206f 6620  e the number of 
+0001f180: 706f 696e 7473 2069 6e20 7468 6973 2069  points in this i
+0001f190: 6e70 7574 2061 7272 6179 3a0a 2020 2020  nput array:.    
 0001f1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f1b0: 6e74 5f6f 7269 6769 6e61 6c5b 6769 6e73  nt_original[gins
-0001f1c0: 7472 756d 656e 745d 203d 206c 656e 280a  trument] = len(.
-0001f1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f1f0: 7365 6c66 2e74 696d 6573 5b67 696e 7374  self.times[ginst
-0001f200: 7275 6d65 6e74 5d29 0a20 2020 2020 2020  rument]).       
-0001f210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f220: 2020 2020 206f 7269 6769 6e61 6c5f 696e       original_in
-0001f230: 7374 7275 6d65 6e74 5f74 696d 6573 5b67  strument_times[g
-0001f240: 696e 7374 7275 6d65 6e74 5d20 3d20 6e70  instrument] = np
-0001f250: 2e63 6f70 7928 0a20 2020 2020 2020 2020  .copy(.         
-0001f260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f270: 2020 2020 2020 2073 656c 662e 7469 6d65         self.time
-0001f280: 735b 6769 6e73 7472 756d 656e 745d 290a  s[ginstrument]).
+0001f1b0: 6e74 203d 206c 656e 2874 290a 2020 2020  nt = len(t).    
+0001f1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f1d0: 2320 416e 6420 6d6f 6469 6679 2074 6865  # And modify the
+0001f1e0: 206c 656e 6774 6820 6f66 2074 6865 206f   length of the o
+0001f1f0: 7574 7075 7420 7361 6d70 6c65 732c 2077  utput samples, w
+0001f200: 6869 6368 2077 696c 6c20 6e6f 7720 6265  hich will now be
+0001f210: 2061 206d 6174 7269 7820 7769 7468 2064   a matrix with d
+0001f220: 696d 656e 7369 6f6e 7320 286e 756d 6265  imensions (numbe
+0001f230: 7220 6f66 2073 616d 706c 6573 2c20 696e  r of samples, in
+0001f240: 7075 7420 7469 6d65 7329 3a0a 2020 2020  put times):.    
+0001f250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f260: 6f75 7470 7574 5f6d 6f64 656c 5f73 616d  output_model_sam
+0001f270: 706c 6573 203d 206e 702e 7a65 726f 7328  ples = np.zeros(
+0001f280: 5b6e 7361 6d70 6c65 732c 206e 745d 290a  [nsamples, nt]).
 0001f290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f2a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001f2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f2c0: 2020 2320 4966 206d 6f64 656c 2069 7320    # If model is 
-0001f2d0: 6e6f 7420 676c 6f62 616c 2c20 7765 2064  not global, we d
-0001f2e0: 6f6e 2774 2063 6172 6520 6162 6f75 7420  on't care about 
-0001f2f0: 6765 6e65 7261 7469 6e67 2074 6865 206d  generating the m
-0001f300: 6f64 656c 2066 6f72 2061 6c6c 2074 6865  odel for all the
-0001f310: 2069 6e73 7472 756d 656e 7473 202d 2d2d   instruments ---
-0001f320: 2077 6520 646f 2069 7420 6f6e 6c79 2066   we do it only f
-0001f330: 6f72 2074 6865 2069 6e73 7472 756d 656e  or the instrumen
-0001f340: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-0001f350: 2020 2020 2020 2020 2020 2320 6f66 2069            # of i
-0001f360: 6e74 6572 6573 742e 2049 6e20 7468 6973  nterest. In this
-0001f370: 2063 6173 652c 2074 6865 206e 745f 6f72   case, the nt_or
-0001f380: 6967 696e 616c 2061 6e64 206f 7269 6769  iginal and origi
-0001f390: 6e61 6c5f 696e 7374 7275 6d65 6e74 5f74  nal_instrument_t
-0001f3a0: 696d 6573 2061 7265 206e 6f74 2064 6963  imes are not dic
-0001f3b0: 7469 6f6e 6172 6965 7320 6275 7420 2273  tionaries but "s
-0001f3c0: 696d 706c 6522 2061 7272 6179 7320 7361  imple" arrays sa
-0001f3d0: 7669 6e67 2074 6865 0a20 2020 2020 2020  ving the.       
-0001f3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f3f0: 2023 206e 756d 6265 7220 6f66 2064 6174   # number of dat
-0001f400: 6170 6f69 6e74 7320 666f 7220 7468 6174  apoints for that
-0001f410: 2069 6e73 7472 756d 656e 7420 616e 6420   instrument and 
-0001f420: 7468 6520 7469 6d65 7320 666f 7220 7468  the times for th
-0001f430: 6174 2069 6e73 7472 756d 656e 742e 0a20  at instrument.. 
-0001f440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f450: 2020 2020 2020 206e 745f 6f72 6967 696e         nt_origin
-0001f460: 616c 203d 206c 656e 2873 656c 662e 7469  al = len(self.ti
-0001f470: 6d65 735b 696e 7374 7275 6d65 6e74 5d29  mes[instrument])
-0001f480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f490: 2020 2020 2020 2020 206f 7269 6769 6e61           origina
-0001f4a0: 6c5f 696e 7374 7275 6d65 6e74 5f74 696d  l_instrument_tim
-0001f4b0: 6573 203d 206e 702e 636f 7079 280a 2020  es = np.copy(.  
-0001f4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f4d0: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
-0001f4e0: 696d 6573 5b69 6e73 7472 756d 656e 745d  imes[instrument]
-0001f4f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001f500: 2020 2020 2020 6966 2073 656c 662e 6d6f        if self.mo
-0001f510: 6465 6c74 7970 6520 3d3d 2027 6c63 273a  deltype == 'lc':
-0001f520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f530: 2020 2020 2020 2020 2023 2049 6620 7765           # If we
-0001f540: 2061 7265 2074 7279 696e 6720 746f 2065   are trying to e
-0001f550: 7661 6c75 6174 6520 6120 6c69 6768 7463  valuate a lightc
-0001f560: 7572 7665 206d 6f64 6520 7468 656e 2c20  urve mode then, 
-0001f570: 6167 6169 6e20 7768 6174 2077 6520 646f  again what we do
-0001f580: 2077 696c 6c20 6465 7065 6e64 2064 6570   will depend dep
-0001f590: 656e 6469 6e67 2069 6620 7468 6973 2069  ending if this i
-0001f5a0: 7320 6120 676c 6f62 616c 206d 6f64 656c  s a global model
-0001f5b0: 206f 7220 6e6f 742e 2049 6e20 626f 7468   or not. In both
-0001f5c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001f5d0: 2020 2020 2020 2020 2020 2320 7468 6520            # the 
-0001f5e0: 6964 6561 2069 7320 746f 2073 6176 6520  idea is to save 
-0001f5f0: 7468 6520 6c69 6768 7463 7572 7665 2067  the lightcurve g
-0001f600: 656e 6572 6174 696e 6720 6f62 6a65 6374  enerating object
-0001f610: 7320 626f 7468 2075 7369 6e67 2074 6865  s both using the
-0001f620: 2069 6e70 7574 2074 696d 6573 2061 6e64   input times and
-0001f630: 2074 6865 206f 7269 6769 6e61 6c20 7469   the original ti
-0001f640: 6d65 733a 0a20 2020 2020 2020 2020 2020  mes:.           
-0001f650: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001f660: 7365 6c66 2e67 6c6f 6261 6c5f 6d6f 6465  self.global_mode
-0001f670: 6c3a 0a20 2020 2020 2020 2020 2020 2020  l:.             
-0001f680: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0001f690: 2049 6620 676c 6f62 616c 206d 6f64 656c   If global model
-0001f6a0: 2c20 7468 656e 2069 7465 7261 7465 2074  , then iterate t
-0001f6b0: 6872 6f75 6768 2061 6c6c 2074 6865 2069  hrough all the i
-0001f6c0: 6e73 7472 756d 656e 7473 206f 6620 7468  nstruments of th
-0001f6d0: 6520 6669 742e 2049 6620 7468 6520 5472  e fit. If the Tr
-0001f6e0: 616e 7369 7446 6974 206f 7220 5472 616e  ansitFit or Tran
-0001f6f0: 7369 7446 6974 4361 7477 6f6d 616e 2069  sitFitCatwoman i
-0001f700: 7320 7472 7565 2c0a 2020 2020 2020 2020  s true,.        
-0001f710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f720: 2020 2020 2320 7468 656e 2067 656e 6572      # then gener
-0001f730: 6174 6520 7468 6520 6d6f 6465 6c2d 6765  ate the model-ge
-0001f740: 6e65 7261 7469 6e67 206f 626a 6563 7473  nerating objects
-0001f750: 2066 6f72 2074 686f 7365 2069 6e73 7472   for those instr
-0001f760: 756d 656e 7473 2075 7369 6e67 2062 6f74  uments using bot
-0001f770: 6820 7468 6520 696e 7075 7420 7469 6d65  h the input time
-0001f780: 7320 616e 6420 7468 6520 6d6f 6465 6c2d  s and the model-
-0001f790: 6669 7420 7469 6d65 732e 2053 6176 650a  fit times. Save.
-0001f7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f7b0: 2020 2020 2020 2020 2020 2020 2320 7468              # th
-0001f7c0: 6f73 6520 696e 2064 6963 7469 6f6e 6172  ose in dictionar
-0001f7d0: 6965 733a 0a20 2020 2020 2020 2020 2020  ies:.           
-0001f7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f7f0: 2066 6f72 2067 696e 7374 7275 6d65 6e74   for ginstrument
-0001f800: 2069 6e20 696e 7374 7275 6d65 6e74 733a   in instruments:
-0001f810: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001f820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f830: 2020 6966 2073 656c 662e 6469 6374 696f    if self.dictio
-0001f840: 6e61 7279 5b67 696e 7374 7275 6d65 6e74  nary[ginstrument
-0001f850: 5d5b 2754 7261 6e73 6974 4669 7427 5d20  ]['TransitFit'] 
-0001f860: 6f72 2073 656c 662e 6469 6374 696f 6e61  or self.dictiona
-0001f870: 7279 5b67 696e 7374 7275 6d65 6e74 5d5b  ry[ginstrument][
-0001f880: 2754 7261 6e73 6974 4669 7443 6174 776f  'TransitFitCatwo
-0001f890: 6d61 6e27 5d20 6f72 2073 656c 662e 6469  man'] or self.di
-0001f8a0: 6374 696f 6e61 7279 5b67 696e 7374 7275  ctionary[ginstru
-0001f8b0: 6d65 6e74 5d5b 2745 636c 6970 7365 4669  ment]['EclipseFi
-0001f8c0: 7427 5d20 6f72 2073 656c 662e 6469 6374  t'] or self.dict
-0001f8d0: 696f 6e61 7279 5b67 696e 7374 7275 6d65  ionary[ginstrume
-0001f8e0: 6e74 5d5b 2754 7261 6e45 636c 4669 7427  nt]['TranEclFit'
-0001f8f0: 5d3a 0a20 2020 200a 2020 2020 2020 2020  ]:.    .        
+0001f2a0: 2020 2020 6966 2073 656c 662e 676c 6f62      if self.glob
+0001f2b0: 616c 5f6d 6f64 656c 3a0a 2020 2020 2020  al_model:.      
+0001f2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f2d0: 2020 2320 4966 206d 6f64 656c 2069 7320    # If model is 
+0001f2e0: 676c 6f62 616c 2c20 6974 206d 6561 6e73  global, it means
+0001f2f0: 2074 6865 7265 2069 7320 616e 2075 6e64   there is an und
+0001f300: 6572 6c79 696e 6720 676c 6f62 616c 206e  erlying global n
+0001f310: 6f69 7365 206d 6f64 656c 2c20 736f 2077  oise model, so w
+0001f320: 6520 6861 7665 2074 6f20 6576 616c 7561  e have to evalua
+0001f330: 7465 2074 6865 206d 6f64 656c 2069 6e20  te the model in 
+0001f340: 2a61 6c6c 2a20 7468 6520 696e 7374 7275  *all* the instru
+0001f350: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
+0001f360: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0001f370: 6265 6361 7573 6520 7468 6520 4750 2063  because the GP c
+0001f380: 6f6d 706f 6e65 6e74 2069 7320 6f6e 6c79  omponent is only
+0001f390: 2065 7874 7261 6374 6162 6c65 206f 6e63   extractable onc
+0001f3a0: 6520 7765 2068 6176 6520 7468 6520 6675  e we have the fu
+0001f3b0: 6c6c 2072 6573 6964 7561 6c73 2e20 4265  ll residuals. Be
+0001f3c0: 6361 7573 6520 6f66 2074 6869 732c 2077  cause of this, w
+0001f3d0: 6520 6765 6e65 7261 7465 2064 6963 7469  e generate dicti
+0001f3e0: 6f6e 6172 6965 7320 7468 6174 2073 6176  onaries that sav
+0001f3f0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0001f400: 2020 2020 2020 2020 2020 2320 7468 6520            # the 
+0001f410: 6f72 6967 696e 616c 206e 756d 6265 7220  original number 
+0001f420: 6f66 2064 6174 6170 6f69 6e74 7320 666f  of datapoints fo
+0001f430: 7220 6561 6368 2069 6e73 7472 756d 656e  r each instrumen
+0001f440: 7420 616e 6420 7468 6520 6f72 6967 696e  t and the origin
+0001f450: 616c 2074 696d 6573 206f 6620 6561 6368  al times of each
+0001f460: 2069 6e73 7472 756d 656e 742e 2054 6869   instrument. Thi
+0001f470: 7320 6973 2075 7365 6675 6c20 6265 6361  s is useful beca
+0001f480: 7573 6520 6c61 7465 7220 7765 0a20 2020  use later we.   
+0001f490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f4a0: 2020 2020 2023 2077 696c 6c20 7377 6974       # will swit
+0001f4b0: 6368 2062 6163 6b20 616e 6420 666f 7274  ch back and fort
+0001f4c0: 6820 6672 6f6d 2074 6865 206f 7269 6769  h from the origi
+0001f4d0: 6e61 6c20 7469 6d65 7320 2874 6f20 6576  nal times (to ev
+0001f4e0: 616c 7561 7465 2074 6865 206d 6f64 656c  aluate the model
+0001f4f0: 2061 6e64 2067 6574 2074 6865 2072 6573   and get the res
+0001f500: 6964 7561 6c73 2920 746f 2074 6865 2069  iduals) to the i
+0001f510: 6e70 7574 2074 696d 6573 2028 746f 2067  nput times (to g
+0001f520: 656e 6572 6174 650a 2020 2020 2020 2020  enerate.        
+0001f530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f540: 2320 7072 6564 6963 7469 6f6e 7329 3a0a  # predictions):.
+0001f550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f560: 2020 2020 2020 2020 6e74 5f6f 7269 6769          nt_origi
+0001f570: 6e61 6c2c 206f 7269 6769 6e61 6c5f 696e  nal, original_in
+0001f580: 7374 7275 6d65 6e74 5f74 696d 6573 203d  strument_times =
+0001f590: 207b 7d2c 207b 7d0a 2020 2020 2020 2020   {}, {}.        
+0001f5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f5b0: 666f 7220 6769 6e73 7472 756d 656e 7420  for ginstrument 
+0001f5c0: 696e 2069 6e73 7472 756d 656e 7473 3a0a  in instruments:.
+0001f5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f5e0: 2020 2020 2020 2020 2020 2020 6e74 5f6f              nt_o
+0001f5f0: 7269 6769 6e61 6c5b 6769 6e73 7472 756d  riginal[ginstrum
+0001f600: 656e 745d 203d 206c 656e 280a 2020 2020  ent] = len(.    
+0001f610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f620: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001f630: 2e74 696d 6573 5b67 696e 7374 7275 6d65  .times[ginstrume
+0001f640: 6e74 5d29 0a20 2020 2020 2020 2020 2020  nt]).           
+0001f650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f660: 206f 7269 6769 6e61 6c5f 696e 7374 7275   original_instru
+0001f670: 6d65 6e74 5f74 696d 6573 5b67 696e 7374  ment_times[ginst
+0001f680: 7275 6d65 6e74 5d20 3d20 6e70 2e63 6f70  rument] = np.cop
+0001f690: 7928 0a20 2020 2020 2020 2020 2020 2020  y(.             
+0001f6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f6b0: 2020 2073 656c 662e 7469 6d65 735b 6769     self.times[gi
+0001f6c0: 6e73 7472 756d 656e 745d 290a 2020 2020  nstrument]).    
+0001f6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f6e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001f6f0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0001f700: 4966 206d 6f64 656c 2069 7320 6e6f 7420  If model is not 
+0001f710: 676c 6f62 616c 2c20 7765 2064 6f6e 2774  global, we don't
+0001f720: 2063 6172 6520 6162 6f75 7420 6765 6e65   care about gene
+0001f730: 7261 7469 6e67 2074 6865 206d 6f64 656c  rating the model
+0001f740: 2066 6f72 2061 6c6c 2074 6865 2069 6e73   for all the ins
+0001f750: 7472 756d 656e 7473 202d 2d2d 2077 6520  truments --- we 
+0001f760: 646f 2069 7420 6f6e 6c79 2066 6f72 2074  do it only for t
+0001f770: 6865 2069 6e73 7472 756d 656e 740a 2020  he instrument.  
+0001f780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f790: 2020 2020 2020 2320 6f66 2069 6e74 6572        # of inter
+0001f7a0: 6573 742e 2049 6e20 7468 6973 2063 6173  est. In this cas
+0001f7b0: 652c 2074 6865 206e 745f 6f72 6967 696e  e, the nt_origin
+0001f7c0: 616c 2061 6e64 206f 7269 6769 6e61 6c5f  al and original_
+0001f7d0: 696e 7374 7275 6d65 6e74 5f74 696d 6573  instrument_times
+0001f7e0: 2061 7265 206e 6f74 2064 6963 7469 6f6e   are not diction
+0001f7f0: 6172 6965 7320 6275 7420 2273 696d 706c  aries but "simpl
+0001f800: 6522 2061 7272 6179 7320 7361 7669 6e67  e" arrays saving
+0001f810: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+0001f820: 2020 2020 2020 2020 2020 2020 2023 206e               # n
+0001f830: 756d 6265 7220 6f66 2064 6174 6170 6f69  umber of datapoi
+0001f840: 6e74 7320 666f 7220 7468 6174 2069 6e73  nts for that ins
+0001f850: 7472 756d 656e 7420 616e 6420 7468 6520  trument and the 
+0001f860: 7469 6d65 7320 666f 7220 7468 6174 2069  times for that i
+0001f870: 6e73 7472 756d 656e 742e 0a20 2020 2020  nstrument..     
+0001f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f890: 2020 206e 745f 6f72 6967 696e 616c 203d     nt_original =
+0001f8a0: 206c 656e 2873 656c 662e 7469 6d65 735b   len(self.times[
+0001f8b0: 696e 7374 7275 6d65 6e74 5d29 0a20 2020  instrument]).   
+0001f8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f8d0: 2020 2020 206f 7269 6769 6e61 6c5f 696e       original_in
+0001f8e0: 7374 7275 6d65 6e74 5f74 696d 6573 203d  strument_times =
+0001f8f0: 206e 702e 636f 7079 280a 2020 2020 2020   np.copy(.      
 0001f900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f910: 2020 2020 2020 2020 2020 2020 6e72 6573              nres
-0001f920: 616d 706c 696e 6720 3d20 7365 6c66 2e64  ampling = self.d
-0001f930: 6963 7469 6f6e 6172 795b 6769 6e73 7472  ictionary[ginstr
-0001f940: 756d 656e 745d 2e67 6574 2827 6e72 6573  ument].get('nres
-0001f950: 616d 706c 696e 6727 290a 2020 2020 2020  ampling').      
+0001f910: 2020 2020 2020 7365 6c66 2e74 696d 6573        self.times
+0001f920: 5b69 6e73 7472 756d 656e 745d 290a 2020  [instrument]).  
+0001f930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f940: 2020 6966 2073 656c 662e 6d6f 6465 6c74    if self.modelt
+0001f950: 7970 6520 3d3d 2027 6c63 273a 0a20 2020  ype == 'lc':.   
 0001f960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f970: 2020 2020 2020 2020 2020 2020 2020 6574                et
-0001f980: 7265 7361 6d70 6c69 6e67 203d 2073 656c  resampling = sel
-0001f990: 662e 6469 6374 696f 6e61 7279 5b67 696e  f.dictionary[gin
-0001f9a0: 7374 7275 6d65 6e74 5d2e 6765 7428 2765  strument].get('e
-0001f9b0: 7870 7469 6d65 7265 7361 6d70 6c69 6e67  xptimeresampling
-0001f9c0: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
-0001f9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f9e0: 2020 2020 2020 2073 7570 6572 7361 6d70         supersamp
-0001f9f0: 6c65 5f70 6172 616d 732c 2073 7570 6572  le_params, super
-0001fa00: 7361 6d70 6c65 5f6d 203d 207b 7d2c 207b  sample_m = {}, {
-0001fa10: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-0001fa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fa30: 2020 2020 2020 7361 6d70 6c65 5f70 6172        sample_par
-0001fa40: 616d 732c 2073 616d 706c 655f 6d20 3d20  ams, sample_m = 
-0001fa50: 7b7d 2c20 7b7d 0a20 2020 2020 2020 2020  {}, {}.         
-0001fa60: 2020 200a 2020 2020 2020 2020 2020 2020     .            
-0001fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fa80: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-0001fa90: 656c 662e 6469 6374 696f 6e61 7279 5b67  elf.dictionary[g
-0001faa0: 696e 7374 7275 6d65 6e74 5d5b 2754 7261  instrument]['Tra
-0001fab0: 6e73 6974 4669 7443 6174 776f 6d61 6e27  nsitFitCatwoman'
-0001fac0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-0001fad0: 2020 200a 2020 2020 2020 2020 2020 2020     .            
-0001fae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001faf0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001fb00: 656c 662e 6469 6374 696f 6e61 7279 5b67  elf.dictionary[g
-0001fb10: 696e 7374 7275 6d65 6e74 5d5b 2754 7261  instrument]['Tra
-0001fb20: 6e73 6974 4669 7427 5d3a 0a20 2020 2020  nsitFit']:.     
-0001fb30: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-0001fb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f970: 2020 2020 2023 2049 6620 7765 2061 7265       # If we are
+0001f980: 2074 7279 696e 6720 746f 2065 7661 6c75   trying to evalu
+0001f990: 6174 6520 6120 6c69 6768 7463 7572 7665  ate a lightcurve
+0001f9a0: 206d 6f64 6520 7468 656e 2c20 6167 6169   mode then, agai
+0001f9b0: 6e20 7768 6174 2077 6520 646f 2077 696c  n what we do wil
+0001f9c0: 6c20 6465 7065 6e64 2064 6570 656e 6469  l depend dependi
+0001f9d0: 6e67 2069 6620 7468 6973 2069 7320 6120  ng if this is a 
+0001f9e0: 676c 6f62 616c 206d 6f64 656c 206f 7220  global model or 
+0001f9f0: 6e6f 742e 2049 6e20 626f 7468 2c0a 2020  not. In both,.  
+0001fa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fa10: 2020 2020 2020 2320 7468 6520 6964 6561        # the idea
+0001fa20: 2069 7320 746f 2073 6176 6520 7468 6520   is to save the 
+0001fa30: 6c69 6768 7463 7572 7665 2067 656e 6572  lightcurve gener
+0001fa40: 6174 696e 6720 6f62 6a65 6374 7320 626f  ating objects bo
+0001fa50: 7468 2075 7369 6e67 2074 6865 2069 6e70  th using the inp
+0001fa60: 7574 2074 696d 6573 2061 6e64 2074 6865  ut times and the
+0001fa70: 206f 7269 6769 6e61 6c20 7469 6d65 733a   original times:
+0001fa80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fa90: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+0001faa0: 2e67 6c6f 6261 6c5f 6d6f 6465 6c3a 0a20  .global_model:. 
+0001fab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fac0: 2020 2020 2020 2020 2020 2023 2049 6620             # If 
+0001fad0: 676c 6f62 616c 206d 6f64 656c 2c20 7468  global model, th
+0001fae0: 656e 2069 7465 7261 7465 2074 6872 6f75  en iterate throu
+0001faf0: 6768 2061 6c6c 2074 6865 2069 6e73 7472  gh all the instr
+0001fb00: 756d 656e 7473 206f 6620 7468 6520 6669  uments of the fi
+0001fb10: 742e 2049 6620 7468 6520 5472 616e 7369  t. If the Transi
+0001fb20: 7446 6974 206f 7220 5472 616e 7369 7446  tFit or TransitF
+0001fb30: 6974 4361 7477 6f6d 616e 2069 7320 7472  itCatwoman is tr
+0001fb40: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
 0001fb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fb60: 2020 2020 2020 2020 7375 7065 7273 616d          supersam
-0001fb70: 706c 655f 7061 7261 6d73 5b67 696e 7374  ple_params[ginst
-0001fb80: 7275 6d65 6e74 5d2c 5b73 7570 6572 7361  rument],[supersa
-0001fb90: 6d70 6c65 5f6d 5b67 696e 7374 7275 6d65  mple_m[ginstrume
-0001fba0: 6e74 5d2c 5f5d 203d 2069 6e69 745f 6261  nt],_] = init_ba
-0001fbb0: 746d 616e 2874 2c20 7365 6c66 2e64 6963  tman(t, self.dic
-0001fbc0: 7469 6f6e 6172 795b 6769 6e73 7472 756d  tionary[ginstrum
-0001fbd0: 656e 745d 5b27 6c64 6c61 7727 5d2c 0a20  ent]['ldlaw'],. 
+0001fb60: 2320 7468 656e 2067 656e 6572 6174 6520  # then generate 
+0001fb70: 7468 6520 6d6f 6465 6c2d 6765 6e65 7261  the model-genera
+0001fb80: 7469 6e67 206f 626a 6563 7473 2066 6f72  ting objects for
+0001fb90: 2074 686f 7365 2069 6e73 7472 756d 656e   those instrumen
+0001fba0: 7473 2075 7369 6e67 2062 6f74 6820 7468  ts using both th
+0001fbb0: 6520 696e 7075 7420 7469 6d65 7320 616e  e input times an
+0001fbc0: 6420 7468 6520 6d6f 6465 6c2d 6669 7420  d the model-fit 
+0001fbd0: 7469 6d65 732e 2053 6176 650a 2020 2020  times. Save.    
 0001fbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc50: 2020 2020 2020 2020 6e72 6573 616d 706c          nresampl
-0001fc60: 696e 673d 6e72 6573 616d 706c 696e 672c  ing=nresampling,
-0001fc70: 2065 7472 6573 616d 706c 696e 673d 6574   etresampling=et
-0001fc80: 7265 7361 6d70 6c69 6e67 290a 2020 2020  resampling).    
-0001fc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fcb0: 2020 2020 2020 2020 7361 6d70 6c65 5f70          sample_p
-0001fcc0: 6172 616d 735b 6769 6e73 7472 756d 656e  arams[ginstrumen
-0001fcd0: 745d 2c5b 7361 6d70 6c65 5f6d 5b67 696e  t],[sample_m[gin
-0001fce0: 7374 7275 6d65 6e74 5d2c 5f5d 203d 2069  strument],_] = i
-0001fcf0: 6e69 745f 6261 746d 616e 2873 656c 662e  nit_batman(self.
-0001fd00: 7469 6d65 735b 6769 6e73 7472 756d 656e  times[ginstrumen
-0001fd10: 745d 2c20 7365 6c66 2e64 6963 7469 6f6e  t], self.diction
-0001fd20: 6172 795b 6769 6e73 7472 756d 656e 745d  ary[ginstrument]
-0001fd30: 5b27 6c64 6c61 7727 5d2c 0a20 2020 2020  ['ldlaw'],.     
+0001fbf0: 2020 2020 2020 2020 2320 7468 6f73 6520          # those 
+0001fc00: 696e 2064 6963 7469 6f6e 6172 6965 733a  in dictionaries:
+0001fc10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fc20: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0001fc30: 2067 696e 7374 7275 6d65 6e74 2069 6e20   ginstrument in 
+0001fc40: 696e 7374 7275 6d65 6e74 733a 0a0a 2020  instruments:..  
+0001fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fc60: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001fc70: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
+0001fc80: 5b67 696e 7374 7275 6d65 6e74 5d5b 2754  [ginstrument]['T
+0001fc90: 7261 6e73 6974 4669 7427 5d20 6f72 2073  ransitFit'] or s
+0001fca0: 656c 662e 6469 6374 696f 6e61 7279 5b67  elf.dictionary[g
+0001fcb0: 696e 7374 7275 6d65 6e74 5d5b 2754 7261  instrument]['Tra
+0001fcc0: 6e73 6974 4669 7443 6174 776f 6d61 6e27  nsitFitCatwoman'
+0001fcd0: 5d20 6f72 2073 656c 662e 6469 6374 696f  ] or self.dictio
+0001fce0: 6e61 7279 5b67 696e 7374 7275 6d65 6e74  nary[ginstrument
+0001fcf0: 5d5b 2745 636c 6970 7365 4669 7427 5d20  ]['EclipseFit'] 
+0001fd00: 6f72 2073 656c 662e 6469 6374 696f 6e61  or self.dictiona
+0001fd10: 7279 5b67 696e 7374 7275 6d65 6e74 5d5b  ry[ginstrument][
+0001fd20: 2754 7261 6e45 636c 4669 7427 5d3a 0a20  'TranEclFit']:. 
+0001fd30: 2020 200a 2020 2020 2020 2020 2020 2020     .            
 0001fd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fda0: 2020 2020 2020 2020 2020 6e72 6573 616d            nresam
-0001fdb0: 706c 696e 673d 6e72 6573 616d 706c 696e  pling=nresamplin
-0001fdc0: 672c 2065 7472 6573 616d 706c 696e 673d  g, etresampling=
-0001fdd0: 6574 7265 7361 6d70 6c69 6e67 290a 2020  etresampling).  
-0001fde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fdf0: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
+0001fd50: 2020 2020 2020 2020 6e72 6573 616d 706c          nresampl
+0001fd60: 696e 6720 3d20 7365 6c66 2e64 6963 7469  ing = self.dicti
+0001fd70: 6f6e 6172 795b 6769 6e73 7472 756d 656e  onary[ginstrumen
+0001fd80: 745d 2e67 6574 2827 6e72 6573 616d 706c  t].get('nresampl
+0001fd90: 696e 6727 290a 2020 2020 2020 2020 2020  ing').          
+0001fda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fdb0: 2020 2020 2020 2020 2020 6574 7265 7361            etresa
+0001fdc0: 6d70 6c69 6e67 203d 2073 656c 662e 6469  mpling = self.di
+0001fdd0: 6374 696f 6e61 7279 5b67 696e 7374 7275  ctionary[ginstru
+0001fde0: 6d65 6e74 5d2e 6765 7428 2765 7870 7469  ment].get('expti
+0001fdf0: 6d65 7265 7361 6d70 6c69 6e67 2729 0a20  meresampling'). 
 0001fe00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fe10: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0001fe20: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
-0001fe30: 6769 6e73 7472 756d 656e 745d 5b27 4563  ginstrument]['Ec
-0001fe40: 6c69 7073 6546 6974 275d 3a0a 2020 2020  lipseFit']:.    
+0001fe10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fe20: 2020 2073 7570 6572 7361 6d70 6c65 5f70     supersample_p
+0001fe30: 6172 616d 732c 2073 7570 6572 7361 6d70  arams, supersamp
+0001fe40: 6c65 5f6d 203d 207b 7d2c 207b 7d0a 2020  le_m = {}, {}.  
 0001fe50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fe60: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
-0001fe70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fe80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fe90: 2073 7570 6572 7361 6d70 6c65 5f70 6172   supersample_par
-0001fea0: 616d 735b 6769 6e73 7472 756d 656e 745d  ams[ginstrument]
-0001feb0: 2c5b 5f2c 7375 7065 7273 616d 706c 655f  ,[_,supersample_
-0001fec0: 6d5b 6769 6e73 7472 756d 656e 745d 5d20  m[ginstrument]] 
-0001fed0: 3d20 696e 6974 5f62 6174 6d61 6e28 742c  = init_batman(t,
-0001fee0: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-0001fef0: 5b67 696e 7374 7275 6d65 6e74 5d5b 276c  [ginstrument]['l
-0001ff00: 646c 6177 275d 2c0a 2020 2020 2020 2020  dlaw'],.        
+0001fe60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fe70: 2020 7361 6d70 6c65 5f70 6172 616d 732c    sample_params,
+0001fe80: 2073 616d 706c 655f 6d20 3d20 7b7d 2c20   sample_m = {}, 
+0001fe90: 7b7d 0a20 2020 2020 2020 2020 2020 200a  {}.            .
+0001fea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001feb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fec0: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+0001fed0: 6469 6374 696f 6e61 7279 5b67 696e 7374  dictionary[ginst
+0001fee0: 7275 6d65 6e74 5d5b 2754 7261 6e73 6974  rument]['Transit
+0001fef0: 4669 7443 6174 776f 6d61 6e27 5d3a 0a20  FitCatwoman']:. 
+0001ff00: 2020 2020 2020 2020 2020 2020 2020 200a                 .
 0001ff10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001ff20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ff30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ff40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ff50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ff60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ff70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ff80: 206e 7265 7361 6d70 6c69 6e67 3d6e 7265   nresampling=nre
-0001ff90: 7361 6d70 6c69 6e67 2c20 6574 7265 7361  sampling, etresa
-0001ffa0: 6d70 6c69 6e67 3d65 7472 6573 616d 706c  mpling=etresampl
-0001ffb0: 696e 6729 0a20 2020 2020 2020 2020 2020  ing).           
-0001ffc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ffd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ffe0: 2073 616d 706c 655f 7061 7261 6d73 5b67   sample_params[g
-0001fff0: 696e 7374 7275 6d65 6e74 5d2c 5b5f 2c73  instrument],[_,s
-00020000: 616d 706c 655f 6d5b 6769 6e73 7472 756d  ample_m[ginstrum
-00020010: 656e 745d 5d20 3d20 696e 6974 5f62 6174  ent]] = init_bat
-00020020: 6d61 6e28 7365 6c66 2e74 696d 6573 5b67  man(self.times[g
-00020030: 696e 7374 7275 6d65 6e74 5d2c 2073 656c  instrument], sel
-00020040: 662e 6469 6374 696f 6e61 7279 5b67 696e  f.dictionary[gin
-00020050: 7374 7275 6d65 6e74 5d5b 276c 646c 6177  strument]['ldlaw
-00020060: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
+0001ff30: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0001ff40: 6469 6374 696f 6e61 7279 5b67 696e 7374  dictionary[ginst
+0001ff50: 7275 6d65 6e74 5d5b 2754 7261 6e73 6974  rument]['Transit
+0001ff60: 4669 7427 5d3a 0a20 2020 2020 2020 2020  Fit']:.         
+0001ff70: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+0001ff80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ff90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ffa0: 2020 2020 7375 7065 7273 616d 706c 655f      supersample_
+0001ffb0: 7061 7261 6d73 5b67 696e 7374 7275 6d65  params[ginstrume
+0001ffc0: 6e74 5d2c 5b73 7570 6572 7361 6d70 6c65  nt],[supersample
+0001ffd0: 5f6d 5b67 696e 7374 7275 6d65 6e74 5d2c  _m[ginstrument],
+0001ffe0: 5f5d 203d 2069 6e69 745f 6261 746d 616e  _] = init_batman
+0001fff0: 2874 2c20 7365 6c66 2e64 6963 7469 6f6e  (t, self.diction
+00020000: 6172 795b 6769 6e73 7472 756d 656e 745d  ary[ginstrument]
+00020010: 5b27 6c64 6c61 7727 5d2c 0a20 2020 2020  ['ldlaw'],.     
+00020020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020060: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00020070: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00020080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000200a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000200b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000200c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000200d0: 2020 206e 7265 7361 6d70 6c69 6e67 3d6e     nresampling=n
-000200e0: 7265 7361 6d70 6c69 6e67 2c20 6574 7265  resampling, etre
-000200f0: 7361 6d70 6c69 6e67 3d65 7472 6573 616d  sampling=etresam
-00020100: 706c 696e 6729 0a20 2020 2020 2020 2020  pling).         
-00020110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020120: 2020 200a 2020 2020 2020 2020 2020 2020     .            
-00020130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020140: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00020150: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-00020160: 5b67 696e 7374 7275 6d65 6e74 5d5b 2754  [ginstrument]['T
-00020170: 7261 6e45 636c 4669 7427 5d3a 0a20 2020  ranEclFit']:.   
+00020090: 2020 2020 6e72 6573 616d 706c 696e 673d      nresampling=
+000200a0: 6e72 6573 616d 706c 696e 672c 2065 7472  nresampling, etr
+000200b0: 6573 616d 706c 696e 673d 6574 7265 7361  esampling=etresa
+000200c0: 6d70 6c69 6e67 290a 2020 2020 2020 2020  mpling).        
+000200d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000200e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000200f0: 2020 2020 7361 6d70 6c65 5f70 6172 616d      sample_param
+00020100: 735b 6769 6e73 7472 756d 656e 745d 2c5b  s[ginstrument],[
+00020110: 7361 6d70 6c65 5f6d 5b67 696e 7374 7275  sample_m[ginstru
+00020120: 6d65 6e74 5d2c 5f5d 203d 2069 6e69 745f  ment],_] = init_
+00020130: 6261 746d 616e 2873 656c 662e 7469 6d65  batman(self.time
+00020140: 735b 6769 6e73 7472 756d 656e 745d 2c20  s[ginstrument], 
+00020150: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
+00020160: 6769 6e73 7472 756d 656e 745d 5b27 6c64  ginstrument]['ld
+00020170: 6c61 7727 5d2c 0a20 2020 2020 2020 2020  law'],.         
 00020180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020190: 2020 2020 2020 2020 2020 2020 200a 2020               .  
+00020190: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000201a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000201b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000201c0: 2020 2020 2020 2020 2020 7375 7065 7273            supers
-000201d0: 616d 706c 655f 7061 7261 6d73 5b67 696e  ample_params[gin
-000201e0: 7374 7275 6d65 6e74 5d2c 7375 7065 7273  strument],supers
-000201f0: 616d 706c 655f 6d5b 6769 6e73 7472 756d  ample_m[ginstrum
-00020200: 656e 745d 203d 2069 6e69 745f 6261 746d  ent] = init_batm
-00020210: 616e 2874 2c20 7365 6c66 2e64 6963 7469  an(t, self.dicti
-00020220: 6f6e 6172 795b 6769 6e73 7472 756d 656e  onary[ginstrumen
-00020230: 745d 5b27 6c64 6c61 7727 5d2c 0a20 2020  t]['ldlaw'],.   
+000201c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000201d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000201e0: 2020 2020 2020 6e72 6573 616d 706c 696e        nresamplin
+000201f0: 673d 6e72 6573 616d 706c 696e 672c 2065  g=nresampling, e
+00020200: 7472 6573 616d 706c 696e 673d 6574 7265  tresampling=etre
+00020210: 7361 6d70 6c69 6e67 290a 2020 2020 2020  sampling).      
+00020220: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
+00020230: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00020240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020250: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00020260: 2e64 6963 7469 6f6e 6172 795b 6769 6e73  .dictionary[gins
+00020270: 7472 756d 656e 745d 5b27 4563 6c69 7073  trument]['Eclips
+00020280: 6546 6974 275d 3a0a 2020 2020 2020 2020  eFit']:.        
 00020290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000202a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000202b0: 2020 6e72 6573 616d 706c 696e 673d 6e72    nresampling=nr
-000202c0: 6573 616d 706c 696e 672c 2065 7472 6573  esampling, etres
-000202d0: 616d 706c 696e 673d 6574 7265 7361 6d70  ampling=etresamp
-000202e0: 6c69 6e67 290a 2020 2020 2020 2020 2020  ling).          
-000202f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020310: 2020 7361 6d70 6c65 5f70 6172 616d 735b    sample_params[
-00020320: 6769 6e73 7472 756d 656e 745d 2c73 616d  ginstrument],sam
-00020330: 706c 655f 6d5b 6769 6e73 7472 756d 656e  ple_m[ginstrumen
-00020340: 745d 203d 2069 6e69 745f 6261 746d 616e  t] = init_batman
-00020350: 2873 656c 662e 7469 6d65 735b 6769 6e73  (self.times[gins
-00020360: 7472 756d 656e 745d 2c20 7365 6c66 2e64  trument], self.d
-00020370: 6963 7469 6f6e 6172 795b 6769 6e73 7472  ictionary[ginstr
-00020380: 756d 656e 745d 5b27 6c64 6c61 7727 5d2c  ument]['ldlaw'],
-00020390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000202a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000202b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000202c0: 2020 2020 2020 2020 2020 2020 2073 7570               sup
+000202d0: 6572 7361 6d70 6c65 5f70 6172 616d 735b  ersample_params[
+000202e0: 6769 6e73 7472 756d 656e 745d 2c5b 5f2c  ginstrument],[_,
+000202f0: 7375 7065 7273 616d 706c 655f 6d5b 6769  supersample_m[gi
+00020300: 6e73 7472 756d 656e 745d 5d20 3d20 696e  nstrument]] = in
+00020310: 6974 5f62 6174 6d61 6e28 742c 2073 656c  it_batman(t, sel
+00020320: 662e 6469 6374 696f 6e61 7279 5b67 696e  f.dictionary[gin
+00020330: 7374 7275 6d65 6e74 5d5b 276c 646c 6177  strument]['ldlaw
+00020340: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
+00020350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020390: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000203a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000203b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000203c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000203d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000203e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000203f0: 2020 2020 2020 2020 2020 2020 6e72 6573              nres
-00020400: 616d 706c 696e 673d 6e72 6573 616d 706c  ampling=nresampl
-00020410: 696e 672c 2065 7472 6573 616d 706c 696e  ing, etresamplin
-00020420: 673d 6574 7265 7361 6d70 6c69 6e67 2920  g=etresampling) 
-00020430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020440: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
-00020450: 2020 2020 2020 2020 2020 2020 200a 0a20               .. 
-00020460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020480: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00020490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000203b0: 2020 2020 2020 2020 2020 2020 206e 7265               nre
+000203c0: 7361 6d70 6c69 6e67 3d6e 7265 7361 6d70  sampling=nresamp
+000203d0: 6c69 6e67 2c20 6574 7265 7361 6d70 6c69  ling, etresampli
+000203e0: 6e67 3d65 7472 6573 616d 706c 696e 6729  ng=etresampling)
+000203f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020410: 2020 2020 2020 2020 2020 2020 2073 616d               sam
+00020420: 706c 655f 7061 7261 6d73 5b67 696e 7374  ple_params[ginst
+00020430: 7275 6d65 6e74 5d2c 5b5f 2c73 616d 706c  rument],[_,sampl
+00020440: 655f 6d5b 6769 6e73 7472 756d 656e 745d  e_m[ginstrument]
+00020450: 5d20 3d20 696e 6974 5f62 6174 6d61 6e28  ] = init_batman(
+00020460: 7365 6c66 2e74 696d 6573 5b67 696e 7374  self.times[ginst
+00020470: 7275 6d65 6e74 5d2c 2073 656c 662e 6469  rument], self.di
+00020480: 6374 696f 6e61 7279 5b67 696e 7374 7275  ctionary[ginstru
+00020490: 6d65 6e74 5d5b 276c 646c 6177 275d 2c0a  ment]['ldlaw'],.
 000204a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000204b0: 2073 7570 6572 7361 6d70 6c65 5f70 6172   supersample_par
-000204c0: 616d 735b 6769 6e73 7472 756d 656e 745d  ams[ginstrument]
-000204d0: 2c73 7570 6572 7361 6d70 6c65 5f6d 5b67  ,supersample_m[g
-000204e0: 696e 7374 7275 6d65 6e74 5d20 3d20 696e  instrument] = in
-000204f0: 6974 5f63 6174 776f 6d61 6e28 742c 2073  it_catwoman(t, s
-00020500: 656c 662e 6469 6374 696f 6e61 7279 5b67  elf.dictionary[g
-00020510: 696e 7374 7275 6d65 6e74 5d5b 276c 646c  instrument]['ldl
-00020520: 6177 275d 2c0a 2020 2020 2020 2020 2020  aw'],.          
-00020530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000204b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000204c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000204d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000204e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000204f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020500: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00020510: 7265 7361 6d70 6c69 6e67 3d6e 7265 7361  resampling=nresa
+00020520: 6d70 6c69 6e67 2c20 6574 7265 7361 6d70  mpling, etresamp
+00020530: 6c69 6e67 3d65 7472 6573 616d 706c 696e  ling=etresamplin
+00020540: 6729 0a20 2020 2020 2020 2020 2020 2020  g).             
+00020550: 2020 2020 2020 2020 2020 2020 2020 200a                 .
 00020560: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00020570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020590: 2020 2020 2020 2020 206e 7265 7361 6d70           nresamp
-000205a0: 6c69 6e67 3d6e 7265 7361 6d70 6c69 6e67  ling=nresampling
-000205b0: 2c20 6574 7265 7361 6d70 6c69 6e67 3d65  , etresampling=e
-000205c0: 7472 6573 616d 706c 696e 6729 0a20 2020  tresampling).   
-000205d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020580: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+00020590: 662e 6469 6374 696f 6e61 7279 5b67 696e  f.dictionary[gin
+000205a0: 7374 7275 6d65 6e74 5d5b 2754 7261 6e45  strument]['TranE
+000205b0: 636c 4669 7427 5d3a 0a20 2020 2020 2020  clFit']:.       
+000205c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000205d0: 2020 2020 2020 2020 200a 2020 2020 2020           .      
 000205e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000205f0: 2020 2020 2073 616d 706c 655f 7061 7261       sample_para
-00020600: 6d73 5b67 696e 7374 7275 6d65 6e74 5d2c  ms[ginstrument],
-00020610: 7361 6d70 6c65 5f6d 5b67 696e 7374 7275  sample_m[ginstru
-00020620: 6d65 6e74 5d20 3d20 696e 6974 5f63 6174  ment] = init_cat
-00020630: 776f 6d61 6e28 7365 6c66 2e74 696d 6573  woman(self.times
-00020640: 5b67 696e 7374 7275 6d65 6e74 5d2c 2073  [ginstrument], s
-00020650: 656c 662e 6469 6374 696f 6e61 7279 5b67  elf.dictionary[g
-00020660: 696e 7374 7275 6d65 6e74 5d5b 276c 646c  instrument]['ldl
-00020670: 6177 275d 2c0a 2020 2020 2020 2020 2020  aw'],.          
+000205f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020600: 2020 2020 2020 7375 7065 7273 616d 706c        supersampl
+00020610: 655f 7061 7261 6d73 5b67 696e 7374 7275  e_params[ginstru
+00020620: 6d65 6e74 5d2c 7375 7065 7273 616d 706c  ment],supersampl
+00020630: 655f 6d5b 6769 6e73 7472 756d 656e 745d  e_m[ginstrument]
+00020640: 203d 2069 6e69 745f 6261 746d 616e 2874   = init_batman(t
+00020650: 2c20 7365 6c66 2e64 6963 7469 6f6e 6172  , self.dictionar
+00020660: 795b 6769 6e73 7472 756d 656e 745d 5b27  y[ginstrument]['
+00020670: 6c64 6c61 7727 5d2c 0a20 2020 2020 2020  ldlaw'],.       
 00020680: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00020690: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000206a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000206b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000206c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000206d0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-000206e0: 7265 7361 6d70 6c69 6e67 3d6e 7265 7361  resampling=nresa
-000206f0: 6d70 6c69 6e67 2c20 6574 7265 7361 6d70  mpling, etresamp
-00020700: 6c69 6e67 3d65 7472 6573 616d 706c 696e  ling=etresamplin
-00020710: 6729 0a20 2020 2020 2020 2020 2020 2020  g).             
-00020720: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00020730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020740: 2020 2020 2020 2020 2020 2020 2023 2049               # I
-00020750: 6620 6d6f 6465 6c20 6973 206e 6f74 2067  f model is not g
-00020760: 6c6f 6261 6c2c 2074 6865 2076 6172 6961  lobal, the varia
-00020770: 626c 6573 2073 6176 6564 2061 7265 206e  bles saved are n
-00020780: 6f74 2064 6963 7469 6f6e 6172 6965 7320  ot dictionaries 
-00020790: 6275 7420 7369 6d70 6c79 2074 6865 206f  but simply the o
-000207a0: 626a 6563 7473 2c20 6173 2077 6520 6172  bjects, as we ar
-000207b0: 6520 6a75 7374 2067 6f69 6e67 2074 6f20  e just going to 
-000207c0: 6576 616c 7561 7465 2074 6865 0a20 2020  evaluate the.   
+000206d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000206e0: 2020 2020 2020 2020 2020 2020 2020 6e72                nr
+000206f0: 6573 616d 706c 696e 673d 6e72 6573 616d  esampling=nresam
+00020700: 706c 696e 672c 2065 7472 6573 616d 706c  pling, etresampl
+00020710: 696e 673d 6574 7265 7361 6d70 6c69 6e67  ing=etresampling
+00020720: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00020730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020740: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+00020750: 6d70 6c65 5f70 6172 616d 735b 6769 6e73  mple_params[gins
+00020760: 7472 756d 656e 745d 2c73 616d 706c 655f  trument],sample_
+00020770: 6d5b 6769 6e73 7472 756d 656e 745d 203d  m[ginstrument] =
+00020780: 2069 6e69 745f 6261 746d 616e 2873 656c   init_batman(sel
+00020790: 662e 7469 6d65 735b 6769 6e73 7472 756d  f.times[ginstrum
+000207a0: 656e 745d 2c20 7365 6c66 2e64 6963 7469  ent], self.dicti
+000207b0: 6f6e 6172 795b 6769 6e73 7472 756d 656e  onary[ginstrumen
+000207c0: 745d 5b27 6c64 6c61 7727 5d2c 0a20 2020  t]['ldlaw'],.   
 000207d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000207e0: 2020 2020 2020 2020 2023 206d 6f64 656c           # model
-000207f0: 2066 6f72 206f 6e65 2064 6174 6173 6574   for one dataset
-00020800: 2028 7468 6520 6f6e 6520 6f66 2074 6865   (the one of the
-00020810: 2069 6e70 7574 2069 6e73 7472 756d 656e   input instrumen
-00020820: 7429 3a0a 0a20 2020 2020 2020 2020 2020  t):..           
-00020830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020840: 2069 6620 7365 6c66 2e64 6963 7469 6f6e   if self.diction
-00020850: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
-00020860: 2754 7261 6e73 6974 4669 7427 5d20 6f72  'TransitFit'] or
-00020870: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-00020880: 5b69 6e73 7472 756d 656e 745d 5b27 5472  [instrument]['Tr
-00020890: 616e 7369 7446 6974 4361 7477 6f6d 616e  ansitFitCatwoman
-000208a0: 275d 206f 7220 7365 6c66 2e64 6963 7469  '] or self.dicti
-000208b0: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
-000208c0: 5d5b 2745 636c 6970 7365 4669 7427 5d20  ]['EclipseFit'] 
-000208d0: 6f72 2073 656c 662e 6469 6374 696f 6e61  or self.dictiona
-000208e0: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
-000208f0: 5472 616e 4563 6c46 6974 275d 3a0a 2020  TranEclFit']:.  
-00020900: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
-00020910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020920: 2020 206e 7265 7361 6d70 6c69 6e67 203d     nresampling =
-00020930: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-00020940: 5b69 6e73 7472 756d 656e 745d 2e67 6574  [instrument].get
-00020950: 2827 6e72 6573 616d 706c 696e 6727 290a  ('nresampling').
-00020960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000207e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000207f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020830: 2020 2020 2020 2020 6e72 6573 616d 706c          nresampl
+00020840: 696e 673d 6e72 6573 616d 706c 696e 672c  ing=nresampling,
+00020850: 2065 7472 6573 616d 706c 696e 673d 6574   etresampling=et
+00020860: 7265 7361 6d70 6c69 6e67 2920 2020 2020  resampling)     
+00020870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020890: 2020 2020 2020 2020 200a 0a20 2020 2020           ..     
+000208a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000208b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000208c0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000208d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000208e0: 2020 2020 2020 2020 2020 2020 2073 7570               sup
+000208f0: 6572 7361 6d70 6c65 5f70 6172 616d 735b  ersample_params[
+00020900: 6769 6e73 7472 756d 656e 745d 2c73 7570  ginstrument],sup
+00020910: 6572 7361 6d70 6c65 5f6d 5b67 696e 7374  ersample_m[ginst
+00020920: 7275 6d65 6e74 5d20 3d20 696e 6974 5f63  rument] = init_c
+00020930: 6174 776f 6d61 6e28 742c 2073 656c 662e  atwoman(t, self.
+00020940: 6469 6374 696f 6e61 7279 5b67 696e 7374  dictionary[ginst
+00020950: 7275 6d65 6e74 5d5b 276c 646c 6177 275d  rument]['ldlaw']
+00020960: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 00020970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020980: 6574 7265 7361 6d70 6c69 6e67 203d 2073  etresampling = s
-00020990: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
-000209a0: 6e73 7472 756d 656e 745d 2e67 6574 2827  nstrument].get('
-000209b0: 6578 7074 696d 6572 6573 616d 706c 696e  exptimeresamplin
-000209c0: 6727 290a 2020 2020 2020 2020 0a20 2020  g').        .   
-000209d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000209e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000209f0: 6e6f 7420 7365 6c66 2e64 6963 7469 6f6e  not self.diction
-00020a00: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
-00020a10: 2754 7261 6e73 6974 4669 7443 6174 776f  'TransitFitCatwo
-00020a20: 6d61 6e27 5d3a 0a20 2020 2020 2020 2020  man']:.         
-00020a30: 2020 200a 2020 2020 2020 2020 2020 2020     .            
-00020a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020a50: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00020a60: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
-00020a70: 756d 656e 745d 5b27 5472 616e 7369 7446  ument]['TransitF
-00020a80: 6974 275d 3a0a 0a20 2020 2020 2020 2020  it']:..         
-00020a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020aa0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00020ab0: 7570 6572 7361 6d70 6c65 5f70 6172 616d  upersample_param
-00020ac0: 732c 5b73 7570 6572 7361 6d70 6c65 5f6d  s,[supersample_m
-00020ad0: 2c5f 5d20 3d20 696e 6974 5f62 6174 6d61  ,_] = init_batma
-00020ae0: 6e28 742c 2073 656c 662e 6469 6374 696f  n(t, self.dictio
-00020af0: 6e61 7279 5b69 6e73 7472 756d 656e 745d  nary[instrument]
-00020b00: 5b27 6c64 6c61 7727 5d2c 0a20 2020 2020  ['ldlaw'],.     
-00020b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000209a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000209b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000209c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000209d0: 2020 2020 206e 7265 7361 6d70 6c69 6e67       nresampling
+000209e0: 3d6e 7265 7361 6d70 6c69 6e67 2c20 6574  =nresampling, et
+000209f0: 7265 7361 6d70 6c69 6e67 3d65 7472 6573  resampling=etres
+00020a00: 616d 706c 696e 6729 0a20 2020 2020 2020  ampling).       
+00020a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020a30: 2073 616d 706c 655f 7061 7261 6d73 5b67   sample_params[g
+00020a40: 696e 7374 7275 6d65 6e74 5d2c 7361 6d70  instrument],samp
+00020a50: 6c65 5f6d 5b67 696e 7374 7275 6d65 6e74  le_m[ginstrument
+00020a60: 5d20 3d20 696e 6974 5f63 6174 776f 6d61  ] = init_catwoma
+00020a70: 6e28 7365 6c66 2e74 696d 6573 5b67 696e  n(self.times[gin
+00020a80: 7374 7275 6d65 6e74 5d2c 2073 656c 662e  strument], self.
+00020a90: 6469 6374 696f 6e61 7279 5b67 696e 7374  dictionary[ginst
+00020aa0: 7275 6d65 6e74 5d5b 276c 646c 6177 275d  rument]['ldlaw']
+00020ab0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00020ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b10: 2020 2020 2020 2020 2020 206e 7265 7361             nresa
+00020b20: 6d70 6c69 6e67 3d6e 7265 7361 6d70 6c69  mpling=nresampli
+00020b30: 6e67 2c20 6574 7265 7361 6d70 6c69 6e67  ng, etresampling
+00020b40: 3d65 7472 6573 616d 706c 696e 6729 0a20  =etresampling). 
 00020b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020b60: 2020 2020 2020 6e72 6573 616d 706c 696e        nresamplin
-00020b70: 673d 6e72 6573 616d 706c 696e 672c 2065  g=nresampling, e
-00020b80: 7472 6573 616d 706c 696e 673d 6574 7265  tresampling=etre
-00020b90: 7361 6d70 6c69 6e67 290a 0a20 2020 2020  sampling)..     
-00020ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020bc0: 2020 2073 616d 706c 655f 7061 7261 6d73     sample_params
-00020bd0: 2c5b 7361 6d70 6c65 5f6d 2c5f 5d20 3d20  ,[sample_m,_] = 
-00020be0: 696e 6974 5f62 6174 6d61 6e28 7365 6c66  init_batman(self
-00020bf0: 2e74 696d 6573 5b69 6e73 7472 756d 656e  .times[instrumen
-00020c00: 745d 2c20 7365 6c66 2e64 6963 7469 6f6e  t], self.diction
-00020c10: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
-00020c20: 276c 646c 6177 275d 2c0a 2020 2020 2020  'ldlaw'],.      
-00020c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020c70: 2020 2020 2020 2020 2020 206e 7265 7361             nresa
-00020c80: 6d70 6c69 6e67 3d6e 7265 7361 6d70 6c69  mpling=nresampli
-00020c90: 6e67 2c20 6574 7265 7361 6d70 6c69 6e67  ng, etresampling
-00020ca0: 3d65 7472 6573 616d 706c 696e 6729 0a20  =etresampling). 
-00020cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020cc0: 2020 200a 2020 2020 2020 2020 2020 2020     .            
-00020cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020ce0: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-00020cf0: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
-00020d00: 7472 756d 656e 745d 5b27 4563 6c69 7073  trument]['Eclips
-00020d10: 6546 6974 275d 3a0a 0a20 2020 2020 2020  eFit']:..       
-00020d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020d40: 2020 7375 7065 7273 616d 706c 655f 7061    supersample_pa
-00020d50: 7261 6d73 2c5b 5f2c 7375 7065 7273 616d  rams,[_,supersam
-00020d60: 706c 655f 6d5d 203d 2069 6e69 745f 6261  ple_m] = init_ba
-00020d70: 746d 616e 2874 2c20 7365 6c66 2e64 6963  tman(t, self.dic
-00020d80: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
-00020d90: 6e74 5d5b 276c 646c 6177 275d 2c0a 2020  nt]['ldlaw'],.  
+00020b60: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00020b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b80: 2020 2020 2020 2020 2023 2049 6620 6d6f           # If mo
+00020b90: 6465 6c20 6973 206e 6f74 2067 6c6f 6261  del is not globa
+00020ba0: 6c2c 2074 6865 2076 6172 6961 626c 6573  l, the variables
+00020bb0: 2073 6176 6564 2061 7265 206e 6f74 2064   saved are not d
+00020bc0: 6963 7469 6f6e 6172 6965 7320 6275 7420  ictionaries but 
+00020bd0: 7369 6d70 6c79 2074 6865 206f 626a 6563  simply the objec
+00020be0: 7473 2c20 6173 2077 6520 6172 6520 6a75  ts, as we are ju
+00020bf0: 7374 2067 6f69 6e67 2074 6f20 6576 616c  st going to eval
+00020c00: 7561 7465 2074 6865 0a20 2020 2020 2020  uate the.       
+00020c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020c20: 2020 2020 2023 206d 6f64 656c 2066 6f72       # model for
+00020c30: 206f 6e65 2064 6174 6173 6574 2028 7468   one dataset (th
+00020c40: 6520 6f6e 6520 6f66 2074 6865 2069 6e70  e one of the inp
+00020c50: 7574 2069 6e73 7472 756d 656e 7429 3a0a  ut instrument):.
+00020c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020c70: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00020c80: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
+00020c90: 696e 7374 7275 6d65 6e74 5d5b 2754 7261  instrument]['Tra
+00020ca0: 6e73 6974 4669 7427 5d20 6f72 2073 656c  nsitFit'] or sel
+00020cb0: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
+00020cc0: 7472 756d 656e 745d 5b27 5472 616e 7369  trument]['Transi
+00020cd0: 7446 6974 4361 7477 6f6d 616e 275d 206f  tFitCatwoman'] o
+00020ce0: 7220 7365 6c66 2e64 6963 7469 6f6e 6172  r self.dictionar
+00020cf0: 795b 696e 7374 7275 6d65 6e74 5d5b 2745  y[instrument]['E
+00020d00: 636c 6970 7365 4669 7427 5d20 6f72 2073  clipseFit'] or s
+00020d10: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
+00020d20: 6e73 7472 756d 656e 745d 5b27 5472 616e  nstrument]['Tran
+00020d30: 4563 6c46 6974 275d 3a0a 2020 2020 0a20  EclFit']:.    . 
+00020d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020d50: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00020d60: 7265 7361 6d70 6c69 6e67 203d 2073 656c  resampling = sel
+00020d70: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
+00020d80: 7472 756d 656e 745d 2e67 6574 2827 6e72  trument].get('nr
+00020d90: 6573 616d 706c 696e 6727 290a 2020 2020  esampling').    
 00020da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020df0: 2020 2020 2020 2020 2020 6e72 6573 616d            nresam
-00020e00: 706c 696e 673d 6e72 6573 616d 706c 696e  pling=nresamplin
-00020e10: 672c 2065 7472 6573 616d 706c 696e 673d  g, etresampling=
-00020e20: 6574 7265 7361 6d70 6c69 6e67 290a 0a20  etresampling).. 
-00020e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020e50: 2020 2020 2020 2020 7361 6d70 6c65 5f70          sample_p
-00020e60: 6172 616d 732c 5b5f 2c73 616d 706c 655f  arams,[_,sample_
-00020e70: 6d5d 203d 2069 6e69 745f 6261 746d 616e  m] = init_batman
-00020e80: 2873 656c 662e 7469 6d65 735b 696e 7374  (self.times[inst
-00020e90: 7275 6d65 6e74 5d2c 2073 656c 662e 6469  rument], self.di
-00020ea0: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
-00020eb0: 656e 745d 5b27 6c64 6c61 7727 5d2c 0a20  ent]['ldlaw'],. 
-00020ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020db0: 2020 2020 2020 2020 2020 2020 6574 7265              etre
+00020dc0: 7361 6d70 6c69 6e67 203d 2073 656c 662e  sampling = self.
+00020dd0: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
+00020de0: 756d 656e 745d 2e67 6574 2827 6578 7074  ument].get('expt
+00020df0: 696d 6572 6573 616d 706c 696e 6727 290a  imeresampling').
+00020e00: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00020e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020e20: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+00020e30: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
+00020e40: 696e 7374 7275 6d65 6e74 5d5b 2754 7261  instrument]['Tra
+00020e50: 6e73 6974 4669 7443 6174 776f 6d61 6e27  nsitFitCatwoman'
+00020e60: 5d3a 0a20 2020 2020 2020 2020 2020 200a  ]:.            .
+00020e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020e90: 2020 2020 6966 2073 656c 662e 6469 6374      if self.dict
+00020ea0: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
+00020eb0: 745d 5b27 5472 616e 7369 7446 6974 275d  t]['TransitFit']
+00020ec0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
 00020ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020f10: 206e 7265 7361 6d70 6c69 6e67 3d6e 7265   nresampling=nre
-00020f20: 7361 6d70 6c69 6e67 2c20 6574 7265 7361  sampling, etresa
-00020f30: 6d70 6c69 6e67 3d65 7472 6573 616d 706c  mpling=etresampl
-00020f40: 696e 6729 0a20 2020 2020 2020 2020 2020  ing).           
+00020ee0: 2020 2020 2020 2020 2020 2073 7570 6572             super
+00020ef0: 7361 6d70 6c65 5f70 6172 616d 732c 5b73  sample_params,[s
+00020f00: 7570 6572 7361 6d70 6c65 5f6d 2c5f 5d20  upersample_m,_] 
+00020f10: 3d20 696e 6974 5f62 6174 6d61 6e28 742c  = init_batman(t,
+00020f20: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
+00020f30: 5b69 6e73 7472 756d 656e 745d 5b27 6c64  [instrument]['ld
+00020f40: 6c61 7727 5d2c 0a20 2020 2020 2020 2020  law'],.         
 00020f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020f60: 200a 2020 2020 2020 2020 2020 2020 2020   .              
+00020f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00020f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020f80: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-00020f90: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
-00020fa0: 756d 656e 745d 5b27 5472 616e 4563 6c46  ument]['TranEclF
-00020fb0: 6974 275d 3a0a 0a20 2020 2020 2020 2020  it']:..         
-00020fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020fd0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00020fe0: 7570 6572 7361 6d70 6c65 5f70 6172 616d  upersample_param
-00020ff0: 732c 7375 7065 7273 616d 706c 655f 6d20  s,supersample_m 
-00021000: 3d20 696e 6974 5f62 6174 6d61 6e28 742c  = init_batman(t,
-00021010: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-00021020: 5b69 6e73 7472 756d 656e 745d 5b27 6c64  [instrument]['ld
-00021030: 6c61 7727 5d2c 0a20 2020 2020 2020 2020  law'],.         
-00021040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020fa0: 2020 6e72 6573 616d 706c 696e 673d 6e72    nresampling=nr
+00020fb0: 6573 616d 706c 696e 672c 2065 7472 6573  esampling, etres
+00020fc0: 616d 706c 696e 673d 6574 7265 7361 6d70  ampling=etresamp
+00020fd0: 6c69 6e67 290a 0a20 2020 2020 2020 2020  ling)..         
+00020fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020ff0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00021000: 616d 706c 655f 7061 7261 6d73 2c5b 7361  ample_params,[sa
+00021010: 6d70 6c65 5f6d 2c5f 5d20 3d20 696e 6974  mple_m,_] = init
+00021020: 5f62 6174 6d61 6e28 7365 6c66 2e74 696d  _batman(self.tim
+00021030: 6573 5b69 6e73 7472 756d 656e 745d 2c20  es[instrument], 
+00021040: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
+00021050: 696e 7374 7275 6d65 6e74 5d5b 276c 646c  instrument]['ldl
+00021060: 6177 275d 2c0a 2020 2020 2020 2020 2020  aw'],.          
 00021070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021080: 2020 2020 2020 2020 2020 2020 2020 6e72                nr
-00021090: 6573 616d 706c 696e 673d 6e72 6573 616d  esampling=nresam
-000210a0: 706c 696e 672c 2065 7472 6573 616d 706c  pling, etresampl
-000210b0: 696e 673d 6574 7265 7361 6d70 6c69 6e67  ing=etresampling
-000210c0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-000210d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000210e0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
-000210f0: 655f 7061 7261 6d73 2c73 616d 706c 655f  e_params,sample_
-00021100: 6d20 3d20 696e 6974 5f62 6174 6d61 6e28  m = init_batman(
-00021110: 7365 6c66 2e74 696d 6573 5b69 6e73 7472  self.times[instr
-00021120: 756d 656e 745d 2c20 7365 6c66 2e64 6963  ument], self.dic
-00021130: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
-00021140: 6e74 5d5b 276c 646c 6177 275d 2c0a 2020  nt]['ldlaw'],.  
-00021150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000210a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000210b0: 2020 2020 2020 206e 7265 7361 6d70 6c69         nresampli
+000210c0: 6e67 3d6e 7265 7361 6d70 6c69 6e67 2c20  ng=nresampling, 
+000210d0: 6574 7265 7361 6d70 6c69 6e67 3d65 7472  etresampling=etr
+000210e0: 6573 616d 706c 696e 6729 0a20 2020 2020  esampling).     
+000210f0: 2020 2020 2020 2020 2020 2020 2020 200a                 .
+00021100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021120: 2020 2020 656c 6966 2073 656c 662e 6469      elif self.di
+00021130: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
+00021140: 656e 745d 5b27 4563 6c69 7073 6546 6974  ent]['EclipseFit
+00021150: 275d 3a0a 0a20 2020 2020 2020 2020 2020  ']:..           
 00021160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021190: 2020 2020 2020 2020 2020 206e 7265 7361             nresa
-000211a0: 6d70 6c69 6e67 3d6e 7265 7361 6d70 6c69  mpling=nresampli
-000211b0: 6e67 2c20 6574 7265 7361 6d70 6c69 6e67  ng, etresampling
-000211c0: 3d65 7472 6573 616d 706c 696e 6729 0a0a  =etresampling)..
-000211d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021170: 2020 2020 2020 2020 2020 2020 2020 7375                su
+00021180: 7065 7273 616d 706c 655f 7061 7261 6d73  persample_params
+00021190: 2c5b 5f2c 7375 7065 7273 616d 706c 655f  ,[_,supersample_
+000211a0: 6d5d 203d 2069 6e69 745f 6261 746d 616e  m] = init_batman
+000211b0: 2874 2c20 7365 6c66 2e64 6963 7469 6f6e  (t, self.diction
+000211c0: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
+000211d0: 276c 646c 6177 275d 2c0a 2020 2020 2020  'ldlaw'],.      
 000211e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000211f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000211f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021210: 2020 2020 2020 2020 2020 7375 7065 7273            supers
-00021220: 616d 706c 655f 7061 7261 6d73 2c73 7570  ample_params,sup
-00021230: 6572 7361 6d70 6c65 5f6d 203d 2069 6e69  ersample_m = ini
-00021240: 745f 6361 7477 6f6d 616e 2874 2c20 7365  t_catwoman(t, se
-00021250: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
-00021260: 7374 7275 6d65 6e74 5d5b 276c 646c 6177  strument]['ldlaw
-00021270: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
+00021210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021230: 2020 2020 2020 6e72 6573 616d 706c 696e        nresamplin
+00021240: 673d 6e72 6573 616d 706c 696e 672c 2065  g=nresampling, e
+00021250: 7472 6573 616d 706c 696e 673d 6574 7265  tresampling=etre
+00021260: 7361 6d70 6c69 6e67 290a 0a20 2020 2020  sampling)..     
+00021270: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000212a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000212b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000212c0: 2020 2020 2020 2020 206e 7265 7361 6d70           nresamp
-000212d0: 6c69 6e67 3d6e 7265 7361 6d70 6c69 6e67  ling=nresampling
-000212e0: 2c20 6574 7265 7361 6d70 6c69 6e67 3d65  , etresampling=e
-000212f0: 7472 6573 616d 706c 696e 6729 0a20 2020  tresampling).   
+00021290: 2020 2020 7361 6d70 6c65 5f70 6172 616d      sample_param
+000212a0: 732c 5b5f 2c73 616d 706c 655f 6d5d 203d  s,[_,sample_m] =
+000212b0: 2069 6e69 745f 6261 746d 616e 2873 656c   init_batman(sel
+000212c0: 662e 7469 6d65 735b 696e 7374 7275 6d65  f.times[instrume
+000212d0: 6e74 5d2c 2073 656c 662e 6469 6374 696f  nt], self.dictio
+000212e0: 6e61 7279 5b69 6e73 7472 756d 656e 745d  nary[instrument]
+000212f0: 5b27 6c64 6c61 7727 5d2c 0a20 2020 2020  ['ldlaw'],.     
 00021300: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021320: 2073 616d 706c 655f 7061 7261 6d73 2c73   sample_params,s
-00021330: 616d 706c 655f 6d20 3d20 696e 6974 5f63  ample_m = init_c
-00021340: 6174 776f 6d61 6e28 7365 6c66 2e74 696d  atwoman(self.tim
-00021350: 6573 5b69 6e73 7472 756d 656e 745d 2c20  es[instrument], 
-00021360: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
-00021370: 696e 7374 7275 6d65 6e74 5d5b 276c 646c  instrument]['ldl
-00021380: 6177 275d 2c0a 2020 2020 2020 2020 2020  aw'],.          
-00021390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021340: 2020 2020 2020 2020 2020 2020 206e 7265               nre
+00021350: 7361 6d70 6c69 6e67 3d6e 7265 7361 6d70  sampling=nresamp
+00021360: 6c69 6e67 2c20 6574 7265 7361 6d70 6c69  ling, etresampli
+00021370: 6e67 3d65 7472 6573 616d 706c 696e 6729  ng=etresampling)
+00021380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021390: 2020 2020 2020 2020 2020 2020 200a 2020               .  
 000213a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000213b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000213c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000213d0: 206e 7265 7361 6d70 6c69 6e67 3d6e 7265   nresampling=nre
-000213e0: 7361 6d70 6c69 6e67 2c20 6574 7265 7361  sampling, etresa
-000213f0: 6d70 6c69 6e67 3d65 7472 6573 616d 706c  mpling=etresampl
-00021400: 696e 6729 0a0a 2020 2020 2020 2020 2020  ing)..          
-00021410: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00021420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021430: 2020 2020 2020 2020 2320 4966 2077 6520          # If we 
-00021440: 6172 6520 7472 7969 6e67 2074 6f20 6576  are trying to ev
-00021450: 616c 7561 7465 2072 6164 6961 6c2d 7665  aluate radial-ve
-00021460: 6c6f 6369 7469 6573 2c20 7765 2064 6f6e  locities, we don
-00021470: 2774 206e 6565 6420 746f 2067 656e 6572  't need to gener
-00021480: 6174 6520 6f62 6a65 6374 7320 6265 6361  ate objects beca
-00021490: 7573 6520 7261 6476 656c 2072 6563 6569  use radvel recei
-000214a0: 7665 7320 7468 6520 7469 6d65 7320 6173  ves the times as
-000214b0: 2069 6e70 7574 730a 2020 2020 2020 2020   inputs.        
-000214c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000214d0: 2320 6f6e 2065 6163 6820 6361 6c6c 2e20  # on each call. 
-000214e0: 496e 2074 6869 7320 6361 7365 2074 6865  In this case the
-000214f0: 6e20 7765 2073 6176 6520 7468 6520 6f72  n we save the or
-00021500: 6967 696e 616c 2074 696d 6573 2028 7365  iginal times (se
-00021510: 6c66 2e74 2068 6173 202a 616c 6c2a 2074  lf.t has *all* t
-00021520: 6865 2074 696d 6573 206f 6620 616c 6c20  he times of all 
-00021530: 7468 6520 696e 7374 7275 6d65 6e74 7329  the instruments)
-00021540: 2061 6e64 2069 6e73 7472 756d 656e 740a   and instrument.
-00021550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021560: 2020 2020 2020 2020 2320 696e 6465 7865          # indexe
-00021570: 7320 2872 656d 656d 6265 7220 7365 6c66  s (remember self
-00021580: 2e74 5b73 656c 662e 696e 7374 7275 6d65  .t[self.instrume
-00021590: 6e74 5f69 6e64 6578 6573 5b79 6f75 7269  nt_indexes[youri
-000215a0: 6e73 7472 756d 656e 745d 5d20 7265 7475  nstrument]] retu
-000215b0: 726e 7320 7468 6520 7469 6d65 7320 6f66  rns the times of
-000215c0: 2079 6f75 7269 6e73 7472 756d 656e 7429   yourinstrument)
-000215d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000215e0: 2020 2020 2020 2020 2020 6f72 6967 696e            origin
-000215f0: 616c 5f74 203d 206e 702e 636f 7079 2873  al_t = np.copy(s
-00021600: 656c 662e 7429 0a20 2020 2020 2020 2020  elf.t).         
-00021610: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00021620: 6620 7365 6c66 2e67 6c6f 6261 6c5f 6d6f  f self.global_mo
-00021630: 6465 6c3a 0a20 2020 2020 2020 2020 2020  del:.           
+000213c0: 2020 656c 6966 2073 656c 662e 6469 6374    elif self.dict
+000213d0: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
+000213e0: 745d 5b27 5472 616e 4563 6c46 6974 275d  t]['TranEclFit']
+000213f0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
+00021400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021410: 2020 2020 2020 2020 2020 2073 7570 6572             super
+00021420: 7361 6d70 6c65 5f70 6172 616d 732c 7375  sample_params,su
+00021430: 7065 7273 616d 706c 655f 6d20 3d20 696e  persample_m = in
+00021440: 6974 5f62 6174 6d61 6e28 742c 2073 656c  it_batman(t, sel
+00021450: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
+00021460: 7472 756d 656e 745d 5b27 6c64 6c61 7727  trument]['ldlaw'
+00021470: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00021480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000214a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000214b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000214c0: 2020 2020 2020 2020 2020 6e72 6573 616d            nresam
+000214d0: 706c 696e 673d 6e72 6573 616d 706c 696e  pling=nresamplin
+000214e0: 672c 2065 7472 6573 616d 706c 696e 673d  g, etresampling=
+000214f0: 6574 7265 7361 6d70 6c69 6e67 290a 0a20  etresampling).. 
+00021500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021520: 2020 2020 2020 2073 616d 706c 655f 7061         sample_pa
+00021530: 7261 6d73 2c73 616d 706c 655f 6d20 3d20  rams,sample_m = 
+00021540: 696e 6974 5f62 6174 6d61 6e28 7365 6c66  init_batman(self
+00021550: 2e74 696d 6573 5b69 6e73 7472 756d 656e  .times[instrumen
+00021560: 745d 2c20 7365 6c66 2e64 6963 7469 6f6e  t], self.diction
+00021570: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
+00021580: 276c 646c 6177 275d 2c0a 2020 2020 2020  'ldlaw'],.      
+00021590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000215a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000215b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000215c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000215d0: 2020 2020 2020 206e 7265 7361 6d70 6c69         nresampli
+000215e0: 6e67 3d6e 7265 7361 6d70 6c69 6e67 2c20  ng=nresampling, 
+000215f0: 6574 7265 7361 6d70 6c69 6e67 3d65 7472  etresampling=etr
+00021600: 6573 616d 706c 696e 6729 0a0a 2020 2020  esampling)..    
+00021610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021620: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00021630: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
 00021640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021650: 2023 2049 6620 676c 6f62 616c 206d 6f64   # If global mod
-00021660: 656c 2c20 636f 7079 2061 6c6c 2074 6865  el, copy all the
-00021670: 2070 6f73 7369 626c 6520 696e 7374 7275   possible instru
-00021680: 6d65 6e74 2069 6e64 6578 6573 2074 6f20  ment indexes to 
-00021690: 7468 6520 6f72 6967 696e 616c 5f69 6e73  the original_ins
-000216a0: 7472 756d 656e 745f 696e 6465 7865 733a  trument_indexes:
-000216b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000216c0: 2020 2020 2020 2020 2020 2020 206f 7269               ori
-000216d0: 6769 6e61 6c5f 696e 7374 7275 6d65 6e74  ginal_instrument
-000216e0: 5f69 6e64 6578 6573 203d 2073 656c 662e  _indexes = self.
-000216f0: 696e 7374 7275 6d65 6e74 5f69 6e64 6578  instrument_index
-00021700: 6573 2e63 6f70 7928 0a20 2020 2020 2020  es.copy(.       
-00021710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021720: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00021730: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00021740: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00021750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021760: 2023 2049 6620 6e6f 7420 676c 6f62 616c   # If not global
-00021770: 2c20 6173 7375 6d65 2069 6e64 6578 6573  , assume indexes
-00021780: 2066 6f72 2073 656c 6563 7465 6420 696e   for selected in
-00021790: 7374 7275 6d65 6e74 2061 7265 2061 6c6c  strument are all
-000217a0: 2074 6865 2075 7365 722d 696e 7075 7474   the user-inputt
-000217b0: 6564 2074 2773 2e20 416c 736f 2c20 7361  ed t's. Also, sa
-000217c0: 7665 206f 6e6c 7920 7468 6520 696e 7374  ve only the inst
-000217d0: 7275 6d65 6e74 0a20 2020 2020 2020 2020  rument.         
+00021650: 2020 2020 2020 7375 7065 7273 616d 706c        supersampl
+00021660: 655f 7061 7261 6d73 2c73 7570 6572 7361  e_params,supersa
+00021670: 6d70 6c65 5f6d 203d 2069 6e69 745f 6361  mple_m = init_ca
+00021680: 7477 6f6d 616e 2874 2c20 7365 6c66 2e64  twoman(t, self.d
+00021690: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
+000216a0: 6d65 6e74 5d5b 276c 646c 6177 275d 2c0a  ment]['ldlaw'],.
+000216b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000216c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000216d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000216e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000216f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021700: 2020 2020 206e 7265 7361 6d70 6c69 6e67       nresampling
+00021710: 3d6e 7265 7361 6d70 6c69 6e67 2c20 6574  =nresampling, et
+00021720: 7265 7361 6d70 6c69 6e67 3d65 7472 6573  resampling=etres
+00021730: 616d 706c 696e 6729 0a20 2020 2020 2020  ampling).       
+00021740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021750: 2020 2020 2020 2020 2020 2020 2073 616d               sam
+00021760: 706c 655f 7061 7261 6d73 2c73 616d 706c  ple_params,sampl
+00021770: 655f 6d20 3d20 696e 6974 5f63 6174 776f  e_m = init_catwo
+00021780: 6d61 6e28 7365 6c66 2e74 696d 6573 5b69  man(self.times[i
+00021790: 6e73 7472 756d 656e 745d 2c20 7365 6c66  nstrument], self
+000217a0: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
+000217b0: 7275 6d65 6e74 5d5b 276c 646c 6177 275d  rument]['ldlaw']
+000217c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000217d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000217e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000217f0: 2020 2023 2069 6e64 6578 6573 2063 6f72     # indexes cor
-00021800: 7265 7370 6f6e 6469 6e67 2074 6f20 7468  responding to th
-00021810: 6520 696e 7374 7275 6d65 6e74 206f 6620  e instrument of 
-00021820: 696e 7465 7265 7374 2e20 5468 6520 6f74  interest. The ot
-00021830: 6865 7273 2064 6f6e 2774 206d 6174 7465  hers don't matte
-00021840: 7220 736f 2077 6520 646f 6e27 7420 7361  r so we don't sa
-00021850: 7665 2074 6865 6d3a 0a20 2020 2020 2020  ve them:.       
+000217f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021800: 2020 2020 2020 2020 2020 2020 206e 7265               nre
+00021810: 7361 6d70 6c69 6e67 3d6e 7265 7361 6d70  sampling=nresamp
+00021820: 6c69 6e67 2c20 6574 7265 7361 6d70 6c69  ling, etresampli
+00021830: 6e67 3d65 7472 6573 616d 706c 696e 6729  ng=etresampling)
+00021840: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00021850: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
 00021860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021870: 2020 2020 206f 7269 6769 6e61 6c5f 696e       original_in
-00021880: 7374 7275 6d65 6e74 5f69 6e64 6578 203d  strument_index =
-00021890: 2073 656c 662e 696e 7374 7275 6d65 6e74   self.instrument
-000218a0: 5f69 6e64 6578 6573 5b0a 2020 2020 2020  _indexes[.      
-000218b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000218c0: 2020 2020 2020 2020 2020 696e 7374 7275            instru
-000218d0: 6d65 6e74 5d0a 2020 2020 2020 2020 2020  ment].          
-000218e0: 2020 2020 2020 2020 2020 2020 2020 6475                du
-000218f0: 6d6d 795f 696e 6465 7865 7320 3d20 6e70  mmy_indexes = np
-00021900: 2e61 7261 6e67 6528 6c65 6e28 7429 290a  .arange(len(t)).
-00021910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021920: 2320 4669 6c6c 2074 6865 2063 6f6d 706f  # Fill the compo
-00021930: 6e65 6e74 7320 6469 6374 696f 6e61 7279  nents dictionary
-00021940: 2069 6e20 6361 7365 2072 6574 7572 6e5f   in case return_
-00021950: 636f 6d70 6f6e 656e 7473 2069 7320 7472  components is tr
-00021960: 7565 3b20 7573 6520 7468 6520 6f75 7470  ue; use the outp
-00021970: 7574 5f6d 6f64 656c 5f73 616d 706c 6573  ut_model_samples
-00021980: 2066 6f72 2074 6865 2073 697a 6520 6f66   for the size of
-00021990: 2065 6163 6820 636f 6d70 6f6e 656e 7420   each component 
-000219a0: 6172 7261 792e 0a20 2020 2020 2020 2020  array..         
-000219b0: 2020 2020 2020 2023 2049 6620 676c 6f62         # If glob
-000219c0: 616c 206d 6f64 656c 2c20 616e 6420 7468  al model, and th
-000219d0: 6520 6d6f 6465 6c20 6265 696e 6720 6576  e model being ev
-000219e0: 616c 7561 7465 6420 6973 2061 206c 6967  aluated is a lig
-000219f0: 6874 6375 7276 652c 2072 656d 656d 6265  htcurve, remembe
-00021a00: 7220 746f 2067 6976 6520 6261 636b 206f  r to give back o
-00021a10: 6e65 2070 6c61 6e65 7420 636f 6d70 6f6e  ne planet compon
-00021a20: 656e 7420 7065 7220 696e 7374 7275 6d65  ent per instrume
-00021a30: 6e74 2062 6563 6175 7365 0a20 2020 2020  nt because.     
-00021a40: 2020 2020 2020 2020 2020 2023 2065 6163             # eac
-00021a50: 6820 696e 7374 7275 6d65 6e74 206d 6967  h instrument mig
-00021a60: 6874 2068 6176 6520 6469 6666 6572 656e  ht have differen
-00021a70: 7420 6c69 6d62 2d64 6172 6b65 6e69 6e67  t limb-darkening
-00021a80: 206c 6177 732e 2054 6f20 7468 6973 2c20   laws. To this, 
-00021a90: 656e 642c 2069 6e20 7468 6174 2063 6173  end, in that cas
-00021aa0: 652c 2074 6865 2063 6f6d 706f 6e65 6e74  e, the component
-00021ab0: 735b 2770 272b 7374 7228 6929 5d20 6469  s['p'+str(i)] di
-00021ac0: 6374 696f 6e61 7279 2069 732c 2069 7473  ctionary is, its
-00021ad0: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-00021ae0: 2020 2020 2023 2061 2064 6963 7469 6f6e       # a diction
-00021af0: 6172 792e 2053 616d 6520 7468 696e 6720  ary. Same thing 
-00021b00: 666f 7220 7468 6520 636f 6d70 6f6e 656e  for the componen
-00021b10: 7473 5b27 7472 616e 7369 7427 5d20 6469  ts['transit'] di
-00021b20: 6374 696f 6e61 7279 3a0a 2020 2020 2020  ctionary:.      
-00021b30: 2020 2020 2020 2020 2020 6966 2072 6574            if ret
-00021b40: 7572 6e5f 636f 6d70 6f6e 656e 7473 3a0a  urn_components:.
+00021870: 2020 2020 2320 4966 2077 6520 6172 6520      # If we are 
+00021880: 7472 7969 6e67 2074 6f20 6576 616c 7561  trying to evalua
+00021890: 7465 2072 6164 6961 6c2d 7665 6c6f 6369  te radial-veloci
+000218a0: 7469 6573 2c20 7765 2064 6f6e 2774 206e  ties, we don't n
+000218b0: 6565 6420 746f 2067 656e 6572 6174 6520  eed to generate 
+000218c0: 6f62 6a65 6374 7320 6265 6361 7573 6520  objects because 
+000218d0: 7261 6476 656c 2072 6563 6569 7665 7320  radvel receives 
+000218e0: 7468 6520 7469 6d65 7320 6173 2069 6e70  the times as inp
+000218f0: 7574 730a 2020 2020 2020 2020 2020 2020  uts.            
+00021900: 2020 2020 2020 2020 2020 2020 2320 6f6e              # on
+00021910: 2065 6163 6820 6361 6c6c 2e20 496e 2074   each call. In t
+00021920: 6869 7320 6361 7365 2074 6865 6e20 7765  his case then we
+00021930: 2073 6176 6520 7468 6520 6f72 6967 696e   save the origin
+00021940: 616c 2074 696d 6573 2028 7365 6c66 2e74  al times (self.t
+00021950: 2068 6173 202a 616c 6c2a 2074 6865 2074   has *all* the t
+00021960: 696d 6573 206f 6620 616c 6c20 7468 6520  imes of all the 
+00021970: 696e 7374 7275 6d65 6e74 7329 2061 6e64  instruments) and
+00021980: 2069 6e73 7472 756d 656e 740a 2020 2020   instrument.    
+00021990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000219a0: 2020 2020 2320 696e 6465 7865 7320 2872      # indexes (r
+000219b0: 656d 656d 6265 7220 7365 6c66 2e74 5b73  emember self.t[s
+000219c0: 656c 662e 696e 7374 7275 6d65 6e74 5f69  elf.instrument_i
+000219d0: 6e64 6578 6573 5b79 6f75 7269 6e73 7472  ndexes[yourinstr
+000219e0: 756d 656e 745d 5d20 7265 7475 726e 7320  ument]] returns 
+000219f0: 7468 6520 7469 6d65 7320 6f66 2079 6f75  the times of you
+00021a00: 7269 6e73 7472 756d 656e 7429 3a0a 2020  rinstrument):.  
+00021a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021a20: 2020 2020 2020 6f72 6967 696e 616c 5f74        original_t
+00021a30: 203d 206e 702e 636f 7079 2873 656c 662e   = np.copy(self.
+00021a40: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
+00021a50: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00021a60: 6c66 2e67 6c6f 6261 6c5f 6d6f 6465 6c3a  lf.global_model:
+00021a70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021a80: 2020 2020 2020 2020 2020 2020 2023 2049               # I
+00021a90: 6620 676c 6f62 616c 206d 6f64 656c 2c20  f global model, 
+00021aa0: 636f 7079 2061 6c6c 2074 6865 2070 6f73  copy all the pos
+00021ab0: 7369 626c 6520 696e 7374 7275 6d65 6e74  sible instrument
+00021ac0: 2069 6e64 6578 6573 2074 6f20 7468 6520   indexes to the 
+00021ad0: 6f72 6967 696e 616c 5f69 6e73 7472 756d  original_instrum
+00021ae0: 656e 745f 696e 6465 7865 733a 0a20 2020  ent_indexes:.   
+00021af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b00: 2020 2020 2020 2020 206f 7269 6769 6e61           origina
+00021b10: 6c5f 696e 7374 7275 6d65 6e74 5f69 6e64  l_instrument_ind
+00021b20: 6578 6573 203d 2073 656c 662e 696e 7374  exes = self.inst
+00021b30: 7275 6d65 6e74 5f69 6e64 6578 6573 2e63  rument_indexes.c
+00021b40: 6f70 7928 0a20 2020 2020 2020 2020 2020  opy(.           
 00021b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b60: 2020 2020 666f 7220 6920 696e 2073 656c      for i in sel
-00021b70: 662e 6e75 6d62 6572 696e 673a 0a20 2020  f.numbering:.   
-00021b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b90: 2020 2020 2069 6620 7365 6c66 2e67 6c6f       if self.glo
-00021ba0: 6261 6c5f 6d6f 6465 6c20 616e 6420 7365  bal_model and se
-00021bb0: 6c66 2e6d 6f64 656c 7479 7065 203d 3d20  lf.modeltype == 
-00021bc0: 276c 6327 3a0a 2020 2020 2020 2020 2020  'lc':.          
-00021bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021be0: 2020 636f 6d70 6f6e 656e 7473 5b27 7027    components['p'
-00021bf0: 202b 2073 7472 2869 295d 203d 207b 7d0a   + str(i)] = {}.
-00021c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c10: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00021c20: 6769 6e73 7472 756d 656e 7420 696e 2069  ginstrument in i
-00021c30: 6e73 7472 756d 656e 7473 3a0a 2020 2020  nstruments:.    
-00021c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c50: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-00021c60: 6f6e 656e 7473 5b27 7027 202b 0a20 2020  onents['p' +.   
-00021c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c90: 2020 2020 2020 2020 7374 7228 6929 5d5b          str(i)][
-00021ca0: 6769 6e73 7472 756d 656e 745d 203d 206e  ginstrument] = n
-00021cb0: 702e 7a65 726f 7328 0a20 2020 2020 2020  p.zeros(.       
-00021cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ce0: 2020 2020 2020 2020 6f75 7470 7574 5f6d          output_m
-00021cf0: 6f64 656c 5f73 616d 706c 6573 2e73 6861  odel_samples.sha
-00021d00: 7065 290a 2020 2020 2020 2020 2020 2020  pe).            
-00021d10: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00021d20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00021d30: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00021d40: 6d70 6f6e 656e 7473 5b27 7027 202b 2073  mponents['p' + s
-00021d50: 7472 2869 295d 203d 206e 702e 7a65 726f  tr(i)] = np.zero
-00021d60: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-00021d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021d80: 2020 206f 7574 7075 745f 6d6f 6465 6c5f     output_model_
-00021d90: 7361 6d70 6c65 732e 7368 6170 6529 0a20  samples.shape). 
-00021da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021db0: 2020 2069 6620 7365 6c66 2e67 6c6f 6261     if self.globa
-00021dc0: 6c5f 6d6f 6465 6c3a 0a20 2020 2020 2020  l_model:.       
-00021dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021de0: 2063 6f6d 706f 6e65 6e74 735b 276c 6d27   components['lm'
-00021df0: 5d20 3d20 7b7d 0a20 2020 2020 2020 2020  ] = {}.         
-00021e00: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00021e10: 6f72 2067 696e 7374 7275 6d65 6e74 2069  or ginstrument i
-00021e20: 6e20 696e 7374 7275 6d65 6e74 733a 0a20  n instruments:. 
-00021e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021e40: 2020 2020 2020 2020 2020 2063 6f6d 706f             compo
-00021e50: 6e65 6e74 735b 276c 6d27 5d5b 6769 6e73  nents['lm'][gins
-00021e60: 7472 756d 656e 745d 203d 206e 702e 7a65  trument] = np.ze
-00021e70: 726f 7328 0a20 2020 2020 2020 2020 2020  ros(.           
-00021e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021e90: 2020 2020 206f 7574 7075 745f 6d6f 6465       output_mode
-00021ea0: 6c5f 7361 6d70 6c65 732e 7368 6170 6529  l_samples.shape)
-00021eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021ec0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00021ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ee0: 2020 2063 6f6d 706f 6e65 6e74 735b 276c     components['l
-00021ef0: 6d27 5d20 3d20 6e70 2e7a 6572 6f73 286f  m'] = np.zeros(o
-00021f00: 7574 7075 745f 6d6f 6465 6c5f 7361 6d70  utput_model_samp
-00021f10: 6c65 732e 7368 6170 6529 0a20 2020 2020  les.shape).     
-00021f20: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00021f30: 6620 7365 6c66 2e6d 6f64 656c 7479 7065  f self.modeltype
-00021f40: 203d 3d20 276c 6327 3a0a 2020 2020 2020   == 'lc':.      
-00021f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021f60: 2020 6966 2073 656c 662e 676c 6f62 616c    if self.global
-00021f70: 5f6d 6f64 656c 3a0a 2020 2020 2020 2020  _model:.        
-00021f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021f90: 2020 2020 636f 6d70 6f6e 656e 7473 5b27      components['
-00021fa0: 7472 616e 7369 7427 5d20 3d20 7b7d 0a20  transit'] = {}. 
-00021fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021fc0: 2020 2020 2020 2020 2020 2066 6f72 2067             for g
-00021fd0: 696e 7374 7275 6d65 6e74 2069 6e20 696e  instrument in in
-00021fe0: 7374 7275 6d65 6e74 733a 0a20 2020 2020  struments:.     
-00021ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022000: 2020 2020 2020 2020 2020 2063 6f6d 706f             compo
-00022010: 6e65 6e74 735b 2774 7261 6e73 6974 275d  nents['transit']
-00022020: 5b67 696e 7374 7275 6d65 6e74 5d20 3d20  [ginstrument] = 
-00022030: 6e70 2e7a 6572 6f73 280a 2020 2020 2020  np.zeros(.      
+00021b60: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+00021b70: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00021b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021b90: 2020 2020 2020 2020 2020 2020 2023 2049               # I
+00021ba0: 6620 6e6f 7420 676c 6f62 616c 2c20 6173  f not global, as
+00021bb0: 7375 6d65 2069 6e64 6578 6573 2066 6f72  sume indexes for
+00021bc0: 2073 656c 6563 7465 6420 696e 7374 7275   selected instru
+00021bd0: 6d65 6e74 2061 7265 2061 6c6c 2074 6865  ment are all the
+00021be0: 2075 7365 722d 696e 7075 7474 6564 2074   user-inputted t
+00021bf0: 2773 2e20 416c 736f 2c20 7361 7665 206f  's. Also, save o
+00021c00: 6e6c 7920 7468 6520 696e 7374 7275 6d65  nly the instrume
+00021c10: 6e74 0a20 2020 2020 2020 2020 2020 2020  nt.             
+00021c20: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00021c30: 2069 6e64 6578 6573 2063 6f72 7265 7370   indexes corresp
+00021c40: 6f6e 6469 6e67 2074 6f20 7468 6520 696e  onding to the in
+00021c50: 7374 7275 6d65 6e74 206f 6620 696e 7465  strument of inte
+00021c60: 7265 7374 2e20 5468 6520 6f74 6865 7273  rest. The others
+00021c70: 2064 6f6e 2774 206d 6174 7465 7220 736f   don't matter so
+00021c80: 2077 6520 646f 6e27 7420 7361 7665 2074   we don't save t
+00021c90: 6865 6d3a 0a20 2020 2020 2020 2020 2020  hem:.           
+00021ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021cb0: 206f 7269 6769 6e61 6c5f 696e 7374 7275   original_instru
+00021cc0: 6d65 6e74 5f69 6e64 6578 203d 2073 656c  ment_index = sel
+00021cd0: 662e 696e 7374 7275 6d65 6e74 5f69 6e64  f.instrument_ind
+00021ce0: 6578 6573 5b0a 2020 2020 2020 2020 2020  exes[.          
+00021cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021d00: 2020 2020 2020 696e 7374 7275 6d65 6e74        instrument
+00021d10: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00021d20: 2020 2020 2020 2020 2020 6475 6d6d 795f            dummy_
+00021d30: 696e 6465 7865 7320 3d20 6e70 2e61 7261  indexes = np.ara
+00021d40: 6e67 6528 6c65 6e28 7429 290a 2020 2020  nge(len(t)).    
+00021d50: 2020 2020 2020 2020 2020 2020 2320 4669              # Fi
+00021d60: 6c6c 2074 6865 2063 6f6d 706f 6e65 6e74  ll the component
+00021d70: 7320 6469 6374 696f 6e61 7279 2069 6e20  s dictionary in 
+00021d80: 6361 7365 2072 6574 7572 6e5f 636f 6d70  case return_comp
+00021d90: 6f6e 656e 7473 2069 7320 7472 7565 3b20  onents is true; 
+00021da0: 7573 6520 7468 6520 6f75 7470 7574 5f6d  use the output_m
+00021db0: 6f64 656c 5f73 616d 706c 6573 2066 6f72  odel_samples for
+00021dc0: 2074 6865 2073 697a 6520 6f66 2065 6163   the size of eac
+00021dd0: 6820 636f 6d70 6f6e 656e 7420 6172 7261  h component arra
+00021de0: 792e 0a20 2020 2020 2020 2020 2020 2020  y..             
+00021df0: 2020 2023 2049 6620 676c 6f62 616c 206d     # If global m
+00021e00: 6f64 656c 2c20 616e 6420 7468 6520 6d6f  odel, and the mo
+00021e10: 6465 6c20 6265 696e 6720 6576 616c 7561  del being evalua
+00021e20: 7465 6420 6973 2061 206c 6967 6874 6375  ted is a lightcu
+00021e30: 7276 652c 2072 656d 656d 6265 7220 746f  rve, remember to
+00021e40: 2067 6976 6520 6261 636b 206f 6e65 2070   give back one p
+00021e50: 6c61 6e65 7420 636f 6d70 6f6e 656e 7420  lanet component 
+00021e60: 7065 7220 696e 7374 7275 6d65 6e74 2062  per instrument b
+00021e70: 6563 6175 7365 0a20 2020 2020 2020 2020  ecause.         
+00021e80: 2020 2020 2020 2023 2065 6163 6820 696e         # each in
+00021e90: 7374 7275 6d65 6e74 206d 6967 6874 2068  strument might h
+00021ea0: 6176 6520 6469 6666 6572 656e 7420 6c69  ave different li
+00021eb0: 6d62 2d64 6172 6b65 6e69 6e67 206c 6177  mb-darkening law
+00021ec0: 732e 2054 6f20 7468 6973 2c20 656e 642c  s. To this, end,
+00021ed0: 2069 6e20 7468 6174 2063 6173 652c 2074   in that case, t
+00021ee0: 6865 2063 6f6d 706f 6e65 6e74 735b 2770  he components['p
+00021ef0: 272b 7374 7228 6929 5d20 6469 6374 696f  '+str(i)] dictio
+00021f00: 6e61 7279 2069 732c 2069 7473 656c 662c  nary is, itself,
+00021f10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021f20: 2023 2061 2064 6963 7469 6f6e 6172 792e   # a dictionary.
+00021f30: 2053 616d 6520 7468 696e 6720 666f 7220   Same thing for 
+00021f40: 7468 6520 636f 6d70 6f6e 656e 7473 5b27  the components['
+00021f50: 7472 616e 7369 7427 5d20 6469 6374 696f  transit'] dictio
+00021f60: 6e61 7279 3a0a 2020 2020 2020 2020 2020  nary:.          
+00021f70: 2020 2020 2020 6966 2072 6574 7572 6e5f        if return_
+00021f80: 636f 6d70 6f6e 656e 7473 3a0a 2020 2020  components:.    
+00021f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021fa0: 666f 7220 6920 696e 2073 656c 662e 6e75  for i in self.nu
+00021fb0: 6d62 6572 696e 673a 0a20 2020 2020 2020  mbering:.       
+00021fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021fd0: 2069 6620 7365 6c66 2e67 6c6f 6261 6c5f   if self.global_
+00021fe0: 6d6f 6465 6c20 616e 6420 7365 6c66 2e6d  model and self.m
+00021ff0: 6f64 656c 7479 7065 203d 3d20 276c 6327  odeltype == 'lc'
+00022000: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00022010: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00022020: 6d70 6f6e 656e 7473 5b27 7027 202b 2073  mponents['p' + s
+00022030: 7472 2869 295d 203d 207b 7d0a 2020 2020  tr(i)] = {}.    
 00022040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022050: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
-00022060: 7470 7574 5f6d 6f64 656c 5f73 616d 706c  tput_model_sampl
-00022070: 6573 2e73 6861 7065 290a 2020 2020 2020  es.shape).      
+00022050: 2020 2020 2020 2020 666f 7220 6769 6e73          for gins
+00022060: 7472 756d 656e 7420 696e 2069 6e73 7472  trument in instr
+00022070: 756d 656e 7473 3a0a 2020 2020 2020 2020  uments:.        
 00022080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022090: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000220a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000220b0: 2020 2020 636f 6d70 6f6e 656e 7473 5b27      components['
-000220c0: 7472 616e 7369 7427 5d20 3d20 6e70 2e7a  transit'] = np.z
-000220d0: 6572 6f73 280a 2020 2020 2020 2020 2020  eros(.          
-000220e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000220f0: 2020 2020 2020 6f75 7470 7574 5f6d 6f64        output_mod
-00022100: 656c 5f73 616d 706c 6573 2e73 6861 7065  el_samples.shape
-00022110: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00022120: 2020 2020 2020 656c 7365 3a0a 0a20 2020        else:..   
-00022130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022140: 2020 2020 2063 6f6d 706f 6e65 6e74 735b       components[
-00022150: 276b 6570 6c65 7269 616e 275d 203d 206e  'keplerian'] = n
-00022160: 702e 7a65 726f 7328 6f75 7470 7574 5f6d  p.zeros(output_m
-00022170: 6f64 656c 5f73 616d 706c 6573 2e73 6861  odel_samples.sha
-00022180: 7065 290a 2020 2020 2020 2020 2020 2020  pe).            
-00022190: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-000221a0: 6f6e 656e 7473 5b27 7472 656e 6427 5d20  onents['trend'] 
-000221b0: 3d20 6e70 2e7a 6572 6f73 286f 7574 7075  = np.zeros(outpu
-000221c0: 745f 6d6f 6465 6c5f 7361 6d70 6c65 732e  t_model_samples.
-000221d0: 7368 6170 6529 0a0a 2020 2020 2020 2020  shape)..        
-000221e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000221f0: 6966 2073 656c 662e 676c 6f62 616c 5f6d  if self.global_m
-00022200: 6f64 656c 3a0a 2020 2020 2020 2020 2020  odel:.          
-00022210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022220: 2020 636f 6d70 6f6e 656e 7473 5b27 6d75    components['mu
-00022230: 275d 203d 207b 7d0a 2020 2020 2020 2020  '] = {}.        
-00022240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022250: 2020 2020 666f 7220 6769 6e73 7472 756d      for ginstrum
-00022260: 656e 7420 696e 2069 6e73 7472 756d 656e  ent in instrumen
-00022270: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-00022280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022290: 2020 2020 636f 6d70 6f6e 656e 7473 5b27      components['
-000222a0: 6d75 275d 5b67 696e 7374 7275 6d65 6e74  mu'][ginstrument
-000222b0: 5d20 3d20 6e70 2e7a 6572 6f73 280a 2020  ] = np.zeros(.  
+00022090: 2020 2020 2020 2020 636f 6d70 6f6e 656e          componen
+000220a0: 7473 5b27 7027 202b 0a20 2020 2020 2020  ts['p' +.       
+000220b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000220c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000220d0: 2020 2020 7374 7228 6929 5d5b 6769 6e73      str(i)][gins
+000220e0: 7472 756d 656e 745d 203d 206e 702e 7a65  trument] = np.ze
+000220f0: 726f 7328 0a20 2020 2020 2020 2020 2020  ros(.           
+00022100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022120: 2020 2020 6f75 7470 7574 5f6d 6f64 656c      output_model
+00022130: 5f73 616d 706c 6573 2e73 6861 7065 290a  _samples.shape).
+00022140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022150: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00022160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022170: 2020 2020 2020 2020 2020 636f 6d70 6f6e            compon
+00022180: 656e 7473 5b27 7027 202b 2073 7472 2869  ents['p' + str(i
+00022190: 295d 203d 206e 702e 7a65 726f 7328 0a20  )] = np.zeros(. 
+000221a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000221b0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000221c0: 7574 7075 745f 6d6f 6465 6c5f 7361 6d70  utput_model_samp
+000221d0: 6c65 732e 7368 6170 6529 0a20 2020 2020  les.shape).     
+000221e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000221f0: 6620 7365 6c66 2e67 6c6f 6261 6c5f 6d6f  f self.global_mo
+00022200: 6465 6c3a 0a20 2020 2020 2020 2020 2020  del:.           
+00022210: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
+00022220: 706f 6e65 6e74 735b 276c 6d27 5d20 3d20  ponents['lm'] = 
+00022230: 7b7d 0a20 2020 2020 2020 2020 2020 2020  {}.             
+00022240: 2020 2020 2020 2020 2020 2066 6f72 2067             for g
+00022250: 696e 7374 7275 6d65 6e74 2069 6e20 696e  instrument in in
+00022260: 7374 7275 6d65 6e74 733a 0a20 2020 2020  struments:.     
+00022270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022280: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
+00022290: 735b 276c 6d27 5d5b 6769 6e73 7472 756d  s['lm'][ginstrum
+000222a0: 656e 745d 203d 206e 702e 7a65 726f 7328  ent] = np.zeros(
+000222b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000222c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000222d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000222e0: 2020 6f75 7470 7574 5f6d 6f64 656c 5f73    output_model_s
-000222f0: 616d 706c 6573 2e73 6861 7065 5b30 5d29  amples.shape[0])
-00022300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022310: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00022320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022330: 2020 2020 2020 2020 2020 2063 6f6d 706f             compo
-00022340: 6e65 6e74 735b 276d 7527 5d20 3d20 6e70  nents['mu'] = np
-00022350: 2e7a 6572 6f73 280a 2020 2020 2020 2020  .zeros(.        
-00022360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022370: 2020 2020 2020 2020 6f75 7470 7574 5f6d          output_m
-00022380: 6f64 656c 5f73 616d 706c 6573 2e73 6861  odel_samples.sha
-00022390: 7065 5b30 5d29 0a0a 2020 2020 2020 2020  pe[0])..        
-000223a0: 2020 2020 2020 2020 2320 4946 2047 5020          # IF GP 
-000223b0: 6465 7472 656e 642c 2074 6865 7265 2069  detrend, there i
-000223c0: 7320 616e 2075 6e64 6572 6c79 696e 6720  s an underlying 
-000223d0: 4750 2062 6569 6e67 2061 7070 6c69 6564  GP being applied
-000223e0: 2e20 4765 6e65 7261 7465 2061 7272 6179  . Generate array
-000223f0: 7320 7468 6174 2077 696c 6c20 7361 7665  s that will save
-00022400: 2074 6865 2047 5020 616e 6420 6465 7465   the GP and dete
-00022410: 726d 696e 6973 7469 6320 636f 6d70 6f6e  rministic compon
-00022420: 656e 743a 0a20 2020 2020 2020 2020 2020  ent:.           
-00022430: 2020 2020 2069 6620 7365 6c66 2e67 6c6f       if self.glo
-00022440: 6261 6c5f 6d6f 6465 6c3a 0a20 2020 2020  bal_model:.     
-00022450: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00022460: 6620 7365 6c66 2e64 6963 7469 6f6e 6172  f self.dictionar
-00022470: 795b 2767 6c6f 6261 6c5f 6d6f 6465 6c27  y['global_model'
-00022480: 5d5b 2747 5044 6574 7265 6e64 275d 3a0a  ]['GPDetrend']:.
-00022490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000224a0: 2020 2020 2020 2020 6f75 7470 7574 5f6d          output_m
-000224b0: 6f64 656c 4750 5f73 616d 706c 6573 203d  odelGP_samples =
-000224c0: 206e 702e 636f 7079 286f 7574 7075 745f   np.copy(output_
-000224d0: 6d6f 6465 6c5f 7361 6d70 6c65 7329 0a20  model_samples). 
+000222d0: 206f 7574 7075 745f 6d6f 6465 6c5f 7361   output_model_sa
+000222e0: 6d70 6c65 732e 7368 6170 6529 0a20 2020  mples.shape).   
+000222f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022300: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00022310: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00022320: 6f6d 706f 6e65 6e74 735b 276c 6d27 5d20  omponents['lm'] 
+00022330: 3d20 6e70 2e7a 6572 6f73 286f 7574 7075  = np.zeros(outpu
+00022340: 745f 6d6f 6465 6c5f 7361 6d70 6c65 732e  t_model_samples.
+00022350: 7368 6170 6529 0a20 2020 2020 2020 2020  shape).         
+00022360: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00022370: 6c66 2e6d 6f64 656c 7479 7065 203d 3d20  lf.modeltype == 
+00022380: 276c 6327 3a0a 2020 2020 2020 2020 2020  'lc':.          
+00022390: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000223a0: 2073 656c 662e 676c 6f62 616c 5f6d 6f64   self.global_mod
+000223b0: 656c 3a0a 2020 2020 2020 2020 2020 2020  el:.            
+000223c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000223d0: 636f 6d70 6f6e 656e 7473 5b27 7472 616e  components['tran
+000223e0: 7369 7427 5d20 3d20 7b7d 0a20 2020 2020  sit'] = {}.     
+000223f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022400: 2020 2020 2020 2066 6f72 2067 696e 7374         for ginst
+00022410: 7275 6d65 6e74 2069 6e20 696e 7374 7275  rument in instru
+00022420: 6d65 6e74 733a 0a20 2020 2020 2020 2020  ments:.         
+00022430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022440: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
+00022450: 735b 2774 7261 6e73 6974 275d 5b67 696e  s['transit'][gin
+00022460: 7374 7275 6d65 6e74 5d20 3d20 6e70 2e7a  strument] = np.z
+00022470: 6572 6f73 280a 2020 2020 2020 2020 2020  eros(.          
+00022480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022490: 2020 2020 2020 2020 2020 6f75 7470 7574            output
+000224a0: 5f6d 6f64 656c 5f73 616d 706c 6573 2e73  _model_samples.s
+000224b0: 6861 7065 290a 2020 2020 2020 2020 2020  hape).          
+000224c0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+000224d0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
 000224e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000224f0: 2020 2020 2020 206f 7574 7075 745f 6d6f         output_mo
-00022500: 6465 6c44 4554 5f73 616d 706c 6573 203d  delDET_samples =
-00022510: 206e 702e 636f 7079 286f 7574 7075 745f   np.copy(output_
-00022520: 6d6f 6465 6c5f 7361 6d70 6c65 7329 0a20  model_samples). 
-00022530: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00022540: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00022550: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00022560: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
-00022570: 7275 6d65 6e74 5d5b 2747 5044 6574 7265  rument]['GPDetre
-00022580: 6e64 275d 3a0a 2020 2020 2020 2020 2020  nd']:.          
-00022590: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
-000225a0: 7470 7574 5f6d 6f64 656c 4750 5f73 616d  tput_modelGP_sam
-000225b0: 706c 6573 203d 206e 702e 636f 7079 286f  ples = np.copy(o
-000225c0: 7574 7075 745f 6d6f 6465 6c5f 7361 6d70  utput_model_samp
-000225d0: 6c65 7329 0a20 2020 2020 2020 2020 2020  les).           
-000225e0: 2020 2020 2020 2020 2020 2020 206f 7574               out
-000225f0: 7075 745f 6d6f 6465 6c44 4554 5f73 616d  put_modelDET_sam
-00022600: 706c 6573 203d 206e 702e 636f 7079 286f  ples = np.copy(o
-00022610: 7574 7075 745f 6d6f 6465 6c5f 7361 6d70  utput_model_samp
-00022620: 6c65 7329 0a0a 2020 2020 2020 2020 2020  les)..          
-00022630: 2020 2020 2020 2320 4372 6561 7465 2064        # Create d
-00022640: 6963 7469 6f6e 6172 7920 7468 6174 2073  ictionary that s
-00022650: 6176 6573 2074 6865 2063 7572 7265 6e74  aves the current
-00022660: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
-00022670: 7320 746f 2065 7661 6c75 6174 653a 0a20  s to evaluate:. 
-00022680: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00022690: 7572 7265 6e74 5f70 6172 616d 6574 6572  urrent_parameter
-000226a0: 5f76 616c 7565 7320 3d20 6469 6374 2e66  _values = dict.f
-000226b0: 726f 6d6b 6579 7328 7061 7261 6d65 7465  romkeys(paramete
-000226c0: 7273 290a 0a20 2020 2020 2020 2020 2020  rs)..           
-000226d0: 2020 2020 2023 2048 6176 696e 6720 6465       # Having de
-000226e0: 6669 6e65 6420 6576 6572 7974 6869 6e67  fined everything
-000226f0: 2c20 7765 206e 6f77 2066 696e 616c 6c79  , we now finally
-00022700: 2073 7461 7274 2065 7661 6c75 6174 696f   start evaluatio
-00022710: 6e20 7468 6520 6d6f 6465 6c2e 2046 6972  n the model. Fir
-00022720: 7374 2067 6f20 7468 726f 7567 6820 616c  st go through al
-00022730: 6c20 7061 7261 6d65 7465 7273 2069 6e20  l parameters in 
-00022740: 7468 6520 7072 696f 723b 2066 6978 2074  the prior; fix t
-00022750: 6865 206f 6e65 730a 2020 2020 2020 2020  he ones.        
-00022760: 2020 2020 2020 2020 2320 7768 6963 6820          # which 
-00022770: 6172 6520 6669 7865 643a 0a20 2020 2020  are fixed:.     
-00022780: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-00022790: 6172 616d 6574 6572 2069 6e20 7061 7261  arameter in para
-000227a0: 6d65 7465 7273 3a0a 2020 2020 2020 2020  meters:.        
-000227b0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000227c0: 656c 662e 7072 696f 7273 5b70 6172 616d  elf.priors[param
-000227d0: 6574 6572 5d5b 2764 6973 7472 6962 7574  eter]['distribut
-000227e0: 696f 6e27 5d20 3d3d 2027 6669 7865 6427  ion'] == 'fixed'
-000227f0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-00022800: 2020 2020 2020 2020 2020 2063 7572 7265             curre
-00022810: 6e74 5f70 6172 616d 6574 6572 5f76 616c  nt_parameter_val
-00022820: 7565 735b 7061 7261 6d65 7465 725d 203d  ues[parameter] =
-00022830: 2073 656c 662e 7072 696f 7273 5b70 6172   self.priors[par
-00022840: 616d 6574 6572 5d5b 2768 7970 6572 7061  ameter]['hyperpa
-00022850: 7261 6d65 7465 7273 275d 0a0a 2020 2020  rameters']..    
-00022860: 2020 2020 2020 2020 2020 2020 2320 4966              # If
-00022870: 2065 7874 7261 706f 6c61 7469 6e67 2074   extrapolating t
-00022880: 6865 206d 6f64 656c 2c20 7361 7665 2074  he model, save t
-00022890: 6865 2063 7572 7265 6e74 2047 5072 6567  he current GPreg
-000228a0: 7265 7373 6f72 7320 616e 6420 6375 7272  ressors and curr
-000228b0: 656e 7420 6c69 6e65 6172 0a20 2020 2020  ent linear.     
-000228c0: 2020 2020 2020 2020 2020 2023 2072 6567             # reg
-000228d0: 7265 7373 6f72 732e 2053 6176 6520 7468  ressors. Save th
-000228e0: 6520 696e 7075 7420 4750 5265 6772 6573  e input GPRegres
-000228f0: 736f 7273 2074 6f20 7468 6520 7365 6c66  sors to the self
-00022900: 2e64 6963 7469 6f6e 6172 792e 204e 6f74  .dictionary. Not
-00022910: 6520 7468 6973 2069 7320 646f 6e65 2062  e this is done b
-00022920: 6563 6175 7365 0a20 2020 2020 2020 2020  ecause.         
-00022930: 2020 2020 2020 2023 2077 6520 776f 6e27         # we won'
-00022940: 7420 6265 2065 7661 6c75 6174 696e 6720  t be evaluating 
-00022950: 7468 6520 6c69 6b65 6c69 686f 6f64 206f  the likelihood o
-00022960: 6e20 6561 6368 2069 7465 7261 7469 6f6e  n each iteration
-00022970: 2c20 736f 2077 6520 646f 6e27 7420 6e65  , so we don't ne
-00022980: 6564 2074 6865 206f 7269 6769 6e61 6c20  ed the original 
-00022990: 4750 2052 6567 7265 7373 6f72 732c 0a20  GP Regressors,. 
-000229a0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000229b0: 2062 7574 206f 6e6c 7920 7468 6520 696e   but only the in
-000229c0: 7075 7420 6f6e 6573 2061 6420 7468 6520  put ones ad the 
-000229d0: 7265 7369 6475 616c 7320 6172 6520 6765  residuals are ge
-000229e0: 6e65 7261 7465 6420 6465 7465 726d 696e  nerated determin
-000229f0: 6973 7469 6361 6c6c 792e 2054 6865 7365  istically. These
-00022a00: 2072 6573 6964 7561 6c73 2061 7265 2070   residuals are p
-00022a10: 6173 7365 640a 2020 2020 2020 2020 2020  assed.          
-00022a20: 2020 2020 2020 2320 746f 2074 6865 2047        # to the G
-00022a30: 5020 6f62 6a65 7420 746f 2067 656e 6572  P objet to gener
-00022a40: 6174 6520 7361 6d70 6c65 7320 6672 6f6d  ate samples from
-00022a50: 2074 6865 2047 502e 2054 6869 7320 6c61   the GP. This la
-00022a60: 7474 6572 2069 7320 6e6f 7420 7472 7565  tter is not true
-00022a70: 2066 6f72 2074 6865 206c 696e 6561 7220   for the linear 
-00022a80: 6d6f 6465 6c2c 2062 6563 6175 7365 2069  model, because i
-00022a90: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-00022aa0: 2020 2320 6973 2061 2064 6574 6572 6d69    # is a determi
-00022ab0: 6e69 7369 7463 206d 6f64 656c 2061 6e20  nisitc model an 
-00022ac0: 6e65 6564 7320 746f 2062 6520 6576 616c  needs to be eval
-00022ad0: 7561 7465 6420 6f6e 2065 6163 6820 6974  uated on each it
-00022ae0: 6572 6174 696f 6e20 6f6e 2062 6f74 6820  eration on both 
-00022af0: 7468 6520 696e 7075 7420 7265 6772 6573  the input regres
-00022b00: 736f 7273 206f 6620 7468 650a 2020 2020  sors of the.    
-00022b10: 2020 2020 2020 2020 2020 2020 2320 6669              # fi
-00022b20: 7420 2874 6f20 6765 6e65 7261 7465 2074  t (to generate t
-00022b30: 6865 2072 6573 6964 7561 6c73 2920 616e  he residuals) an
-00022b40: 6420 6f6e 2074 6865 2069 6e70 7574 2072  d on the input r
-00022b50: 6567 7265 7373 6f72 7320 746f 2074 6869  egressors to thi
-00022b60: 7320 6675 6e63 7469 6f6e 2028 746f 2067  s function (to g
-00022b70: 656e 6572 6174 6520 7072 6564 6963 7469  enerate predicti
-00022b80: 6f6e 7329 3a0a 2020 2020 2020 2020 2020  ons):.          
-00022b90: 2020 2020 2020 6966 2074 2069 7320 6e6f        if t is no
-00022ba0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00022bb0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00022bc0: 656c 662e 676c 6f62 616c 5f6d 6f64 656c  elf.global_model
-00022bd0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00022be0: 2020 2020 2020 2020 2020 6f72 6967 696e            origin
-00022bf0: 616c 5f6c 6d5f 6172 6775 6d65 6e74 7320  al_lm_arguments 
-00022c00: 3d20 6e70 2e63 6f70 7928 7365 6c66 2e6c  = np.copy(self.l
-00022c10: 6d5f 6172 6775 6d65 6e74 7329 0a20 2020  m_arguments).   
-00022c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022c30: 2020 2020 2069 6620 7365 6c66 2e64 6963       if self.dic
-00022c40: 7469 6f6e 6172 795b 2767 6c6f 6261 6c5f  tionary['global_
-00022c50: 6d6f 6465 6c27 5d5b 2747 5044 6574 7265  model']['GPDetre
-00022c60: 6e64 275d 3a0a 2020 2020 2020 2020 2020  nd']:.          
-00022c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022c80: 2020 7365 6c66 2e6f 7269 6769 6e61 6c5f    self.original_
-00022c90: 4750 7265 6772 6573 736f 7273 203d 206e  GPregressors = n
-00022ca0: 702e 636f 7079 280a 2020 2020 2020 2020  p.copy(.        
-00022cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022cc0: 2020 2020 2020 2020 7365 6c66 2e64 6963          self.dic
-00022cd0: 7469 6f6e 6172 795b 2767 6c6f 6261 6c5f  tionary['global_
-00022ce0: 6d6f 6465 6c27 5d0a 2020 2020 2020 2020  model'].        
-00022cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022d00: 2020 2020 2020 2020 5b27 6e6f 6973 655f          ['noise_
-00022d10: 6d6f 6465 6c27 5d2e 5829 0a20 2020 2020  model'].X).     
-00022d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022d30: 2020 2020 2020 2073 656c 662e 6469 6374         self.dict
-00022d40: 696f 6e61 7279 5b27 676c 6f62 616c 5f6d  ionary['global_m
-00022d50: 6f64 656c 275d 5b0a 2020 2020 2020 2020  odel'][.        
-00022d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022d70: 2020 2020 2020 2020 276e 6f69 7365 5f6d          'noise_m
-00022d80: 6f64 656c 275d 2e58 203d 2047 5072 6567  odel'].X = GPreg
-00022d90: 7265 7373 6f72 730a 2020 2020 2020 2020  ressors.        
-00022da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022db0: 2020 2020 6966 2047 5072 6567 7265 7373      if GPregress
-00022dc0: 6f72 7320 6973 204e 6f6e 653a 0a20 2020  ors is None:.   
-00022dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022de0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00022df0: 7365 2045 7863 6570 7469 6f6e 280a 2020  se Exception(.  
-00022e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022e20: 2020 225c 7420 476f 6261 6c20 6d6f 6465    "\t Gobal mode
-00022e30: 6c20 6861 7320 6120 4750 2c20 616e 6420  l has a GP, and 
-00022e40: 7265 7175 6972 6573 2061 2047 5072 6567  requires a GPreg
-00022e50: 7265 7373 6f72 7320 746f 2062 6520 696e  ressors to be in
-00022e60: 7075 7474 6564 2074 6f20 6265 2065 7661  putted to be eva
-00022e70: 6c75 6174 6564 2e22 0a20 2020 2020 2020  luated.".       
-00022e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022e90: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00022ea0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00022eb0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00022ec0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00022ed0: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
-00022ee0: 696e 7374 7275 6d65 6e74 5d5b 2747 5044  instrument]['GPD
-00022ef0: 6574 7265 6e64 275d 3a0a 2020 2020 2020  etrend']:.      
-00022f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f10: 2020 2020 2020 7365 6c66 2e64 6963 7469        self.dicti
-00022f20: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
-00022f30: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
-00022f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f50: 2020 2027 6e6f 6973 655f 6d6f 6465 6c27     'noise_model'
-00022f60: 5d2e 5820 3d20 4750 7265 6772 6573 736f  ].X = GPregresso
-00022f70: 7273 0a20 2020 2020 2020 2020 2020 2020  rs.             
-00022f80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00022f90: 6620 4750 7265 6772 6573 736f 7273 2069  f GPregressors i
-00022fa0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00022fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022fc0: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
-00022fd0: 6365 7074 696f 6e28 0a20 2020 2020 2020  ception(.       
-00022fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022ff0: 2020 2020 2020 2020 2020 2020 2022 5c74               "\t
-00023000: 204d 6f64 656c 2066 6f72 2069 6e73 7472   Model for instr
-00023010: 756d 656e 7420 2220 2b20 696e 7374 7275  ument " + instru
-00023020: 6d65 6e74 202b 0a20 2020 2020 2020 2020  ment +.         
-00023030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023040: 2020 2020 2020 2020 2020 2022 2068 6173             " has
-00023050: 2061 2047 502c 2061 6e64 2072 6571 7569   a GP, and requi
-00023060: 7265 7320 6120 4750 7265 6772 6573 736f  res a GPregresso
-00023070: 7273 2074 6f20 6265 2069 6e70 7574 7465  rs to be inputte
-00023080: 6420 746f 2062 6520 6576 616c 7561 7465  d to be evaluate
-00023090: 642e 220a 2020 2020 2020 2020 2020 2020  d.".            
-000230a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000230b0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-000230c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000230d0: 2073 656c 662e 6c6d 5f62 6f6f 6c65 616e   self.lm_boolean
-000230e0: 5b69 6e73 7472 756d 656e 745d 3a0a 2020  [instrument]:.  
+000224f0: 636f 6d70 6f6e 656e 7473 5b27 7472 616e  components['tran
+00022500: 7369 7427 5d20 3d20 6e70 2e7a 6572 6f73  sit'] = np.zeros
+00022510: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00022520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022530: 2020 6f75 7470 7574 5f6d 6f64 656c 5f73    output_model_s
+00022540: 616d 706c 6573 2e73 6861 7065 290a 2020  amples.shape).  
+00022550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022560: 2020 656c 7365 3a0a 0a20 2020 2020 2020    else:..       
+00022570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022580: 2063 6f6d 706f 6e65 6e74 735b 276b 6570   components['kep
+00022590: 6c65 7269 616e 275d 203d 206e 702e 7a65  lerian'] = np.ze
+000225a0: 726f 7328 6f75 7470 7574 5f6d 6f64 656c  ros(output_model
+000225b0: 5f73 616d 706c 6573 2e73 6861 7065 290a  _samples.shape).
+000225c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000225d0: 2020 2020 2020 2020 636f 6d70 6f6e 656e          componen
+000225e0: 7473 5b27 7472 656e 6427 5d20 3d20 6e70  ts['trend'] = np
+000225f0: 2e7a 6572 6f73 286f 7574 7075 745f 6d6f  .zeros(output_mo
+00022600: 6465 6c5f 7361 6d70 6c65 732e 7368 6170  del_samples.shap
+00022610: 6529 0a0a 2020 2020 2020 2020 2020 2020  e)..            
+00022620: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00022630: 656c 662e 676c 6f62 616c 5f6d 6f64 656c  elf.global_model
+00022640: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00022650: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00022660: 6d70 6f6e 656e 7473 5b27 6d75 275d 203d  mponents['mu'] =
+00022670: 207b 7d0a 2020 2020 2020 2020 2020 2020   {}.            
+00022680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022690: 666f 7220 6769 6e73 7472 756d 656e 7420  for ginstrument 
+000226a0: 696e 2069 6e73 7472 756d 656e 7473 3a0a  in instruments:.
+000226b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000226c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000226d0: 636f 6d70 6f6e 656e 7473 5b27 6d75 275d  components['mu']
+000226e0: 5b67 696e 7374 7275 6d65 6e74 5d20 3d20  [ginstrument] = 
+000226f0: 6e70 2e7a 6572 6f73 280a 2020 2020 2020  np.zeros(.      
+00022700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022710: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
+00022720: 7470 7574 5f6d 6f64 656c 5f73 616d 706c  tput_model_sampl
+00022730: 6573 2e73 6861 7065 5b30 5d29 0a20 2020  es.shape[0]).   
+00022740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022750: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00022760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022770: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
+00022780: 735b 276d 7527 5d20 3d20 6e70 2e7a 6572  s['mu'] = np.zer
+00022790: 6f73 280a 2020 2020 2020 2020 2020 2020  os(.            
+000227a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000227b0: 2020 2020 6f75 7470 7574 5f6d 6f64 656c      output_model
+000227c0: 5f73 616d 706c 6573 2e73 6861 7065 5b30  _samples.shape[0
+000227d0: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
+000227e0: 2020 2020 2320 4946 2047 5020 6465 7472      # IF GP detr
+000227f0: 656e 642c 2074 6865 7265 2069 7320 616e  end, there is an
+00022800: 2075 6e64 6572 6c79 696e 6720 4750 2062   underlying GP b
+00022810: 6569 6e67 2061 7070 6c69 6564 2e20 4765  eing applied. Ge
+00022820: 6e65 7261 7465 2061 7272 6179 7320 7468  nerate arrays th
+00022830: 6174 2077 696c 6c20 7361 7665 2074 6865  at will save the
+00022840: 2047 5020 616e 6420 6465 7465 726d 696e   GP and determin
+00022850: 6973 7469 6320 636f 6d70 6f6e 656e 743a  istic component:
+00022860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022870: 2069 6620 7365 6c66 2e67 6c6f 6261 6c5f   if self.global_
+00022880: 6d6f 6465 6c3a 0a20 2020 2020 2020 2020  model:.         
+00022890: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+000228a0: 6c66 2e64 6963 7469 6f6e 6172 795b 2767  lf.dictionary['g
+000228b0: 6c6f 6261 6c5f 6d6f 6465 6c27 5d5b 2747  lobal_model']['G
+000228c0: 5044 6574 7265 6e64 275d 3a0a 2020 2020  PDetrend']:.    
+000228d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000228e0: 2020 2020 6f75 7470 7574 5f6d 6f64 656c      output_model
+000228f0: 4750 5f73 616d 706c 6573 203d 206e 702e  GP_samples = np.
+00022900: 636f 7079 286f 7574 7075 745f 6d6f 6465  copy(output_mode
+00022910: 6c5f 7361 6d70 6c65 7329 0a20 2020 2020  l_samples).     
+00022920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022930: 2020 206f 7574 7075 745f 6d6f 6465 6c44     output_modelD
+00022940: 4554 5f73 616d 706c 6573 203d 206e 702e  ET_samples = np.
+00022950: 636f 7079 286f 7574 7075 745f 6d6f 6465  copy(output_mode
+00022960: 6c5f 7361 6d70 6c65 7329 0a20 2020 2020  l_samples).     
+00022970: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00022980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022990: 2020 2020 2069 6620 7365 6c66 2e64 6963       if self.dic
+000229a0: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
+000229b0: 6e74 5d5b 2747 5044 6574 7265 6e64 275d  nt]['GPDetrend']
+000229c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000229d0: 2020 2020 2020 2020 2020 6f75 7470 7574            output
+000229e0: 5f6d 6f64 656c 4750 5f73 616d 706c 6573  _modelGP_samples
+000229f0: 203d 206e 702e 636f 7079 286f 7574 7075   = np.copy(outpu
+00022a00: 745f 6d6f 6465 6c5f 7361 6d70 6c65 7329  t_model_samples)
+00022a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022a20: 2020 2020 2020 2020 206f 7574 7075 745f           output_
+00022a30: 6d6f 6465 6c44 4554 5f73 616d 706c 6573  modelDET_samples
+00022a40: 203d 206e 702e 636f 7079 286f 7574 7075   = np.copy(outpu
+00022a50: 745f 6d6f 6465 6c5f 7361 6d70 6c65 7329  t_model_samples)
+00022a60: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00022a70: 2020 2320 4372 6561 7465 2064 6963 7469    # Create dicti
+00022a80: 6f6e 6172 7920 7468 6174 2073 6176 6573  onary that saves
+00022a90: 2074 6865 2063 7572 7265 6e74 2070 6172   the current par
+00022aa0: 616d 6574 6572 5f76 616c 7565 7320 746f  ameter_values to
+00022ab0: 2065 7661 6c75 6174 653a 0a20 2020 2020   evaluate:.     
+00022ac0: 2020 2020 2020 2020 2020 2063 7572 7265             curre
+00022ad0: 6e74 5f70 6172 616d 6574 6572 5f76 616c  nt_parameter_val
+00022ae0: 7565 7320 3d20 6469 6374 2e66 726f 6d6b  ues = dict.fromk
+00022af0: 6579 7328 7061 7261 6d65 7465 7273 290a  eys(parameters).
+00022b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022b10: 2023 2048 6176 696e 6720 6465 6669 6e65   # Having define
+00022b20: 6420 6576 6572 7974 6869 6e67 2c20 7765  d everything, we
+00022b30: 206e 6f77 2066 696e 616c 6c79 2073 7461   now finally sta
+00022b40: 7274 2065 7661 6c75 6174 696f 6e20 7468  rt evaluation th
+00022b50: 6520 6d6f 6465 6c2e 2046 6972 7374 2067  e model. First g
+00022b60: 6f20 7468 726f 7567 6820 616c 6c20 7061  o through all pa
+00022b70: 7261 6d65 7465 7273 2069 6e20 7468 6520  rameters in the 
+00022b80: 7072 696f 723b 2066 6978 2074 6865 206f  prior; fix the o
+00022b90: 6e65 730a 2020 2020 2020 2020 2020 2020  nes.            
+00022ba0: 2020 2020 2320 7768 6963 6820 6172 6520      # which are 
+00022bb0: 6669 7865 643a 0a20 2020 2020 2020 2020  fixed:.         
+00022bc0: 2020 2020 2020 2066 6f72 2070 6172 616d         for param
+00022bd0: 6574 6572 2069 6e20 7061 7261 6d65 7465  eter in paramete
+00022be0: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
+00022bf0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00022c00: 7072 696f 7273 5b70 6172 616d 6574 6572  priors[parameter
+00022c10: 5d5b 2764 6973 7472 6962 7574 696f 6e27  ]['distribution'
+00022c20: 5d20 3d3d 2027 6669 7865 6427 3a0a 0a20  ] == 'fixed':.. 
+00022c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022c40: 2020 2020 2020 2063 7572 7265 6e74 5f70         current_p
+00022c50: 6172 616d 6574 6572 5f76 616c 7565 735b  arameter_values[
+00022c60: 7061 7261 6d65 7465 725d 203d 2073 656c  parameter] = sel
+00022c70: 662e 7072 696f 7273 5b70 6172 616d 6574  f.priors[paramet
+00022c80: 6572 5d5b 2768 7970 6572 7061 7261 6d65  er]['hyperparame
+00022c90: 7465 7273 275d 0a0a 2020 2020 2020 2020  ters']..        
+00022ca0: 2020 2020 2020 2020 2320 4966 2065 7874          # If ext
+00022cb0: 7261 706f 6c61 7469 6e67 2074 6865 206d  rapolating the m
+00022cc0: 6f64 656c 2c20 7361 7665 2074 6865 2063  odel, save the c
+00022cd0: 7572 7265 6e74 2047 5072 6567 7265 7373  urrent GPregress
+00022ce0: 6f72 7320 616e 6420 6375 7272 656e 7420  ors and current 
+00022cf0: 6c69 6e65 6172 0a20 2020 2020 2020 2020  linear.         
+00022d00: 2020 2020 2020 2023 2072 6567 7265 7373         # regress
+00022d10: 6f72 732e 2053 6176 6520 7468 6520 696e  ors. Save the in
+00022d20: 7075 7420 4750 5265 6772 6573 736f 7273  put GPRegressors
+00022d30: 2074 6f20 7468 6520 7365 6c66 2e64 6963   to the self.dic
+00022d40: 7469 6f6e 6172 792e 204e 6f74 6520 7468  tionary. Note th
+00022d50: 6973 2069 7320 646f 6e65 2062 6563 6175  is is done becau
+00022d60: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
+00022d70: 2020 2023 2077 6520 776f 6e27 7420 6265     # we won't be
+00022d80: 2065 7661 6c75 6174 696e 6720 7468 6520   evaluating the 
+00022d90: 6c69 6b65 6c69 686f 6f64 206f 6e20 6561  likelihood on ea
+00022da0: 6368 2069 7465 7261 7469 6f6e 2c20 736f  ch iteration, so
+00022db0: 2077 6520 646f 6e27 7420 6e65 6564 2074   we don't need t
+00022dc0: 6865 206f 7269 6769 6e61 6c20 4750 2052  he original GP R
+00022dd0: 6567 7265 7373 6f72 732c 0a20 2020 2020  egressors,.     
+00022de0: 2020 2020 2020 2020 2020 2023 2062 7574             # but
+00022df0: 206f 6e6c 7920 7468 6520 696e 7075 7420   only the input 
+00022e00: 6f6e 6573 2061 6420 7468 6520 7265 7369  ones ad the resi
+00022e10: 6475 616c 7320 6172 6520 6765 6e65 7261  duals are genera
+00022e20: 7465 6420 6465 7465 726d 696e 6973 7469  ted deterministi
+00022e30: 6361 6c6c 792e 2054 6865 7365 2072 6573  cally. These res
+00022e40: 6964 7561 6c73 2061 7265 2070 6173 7365  iduals are passe
+00022e50: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+00022e60: 2020 2320 746f 2074 6865 2047 5020 6f62    # to the GP ob
+00022e70: 6a65 7420 746f 2067 656e 6572 6174 6520  jet to generate 
+00022e80: 7361 6d70 6c65 7320 6672 6f6d 2074 6865  samples from the
+00022e90: 2047 502e 2054 6869 7320 6c61 7474 6572   GP. This latter
+00022ea0: 2069 7320 6e6f 7420 7472 7565 2066 6f72   is not true for
+00022eb0: 2074 6865 206c 696e 6561 7220 6d6f 6465   the linear mode
+00022ec0: 6c2c 2062 6563 6175 7365 2069 740a 2020  l, because it.  
+00022ed0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00022ee0: 6973 2061 2064 6574 6572 6d69 6e69 7369  is a determinisi
+00022ef0: 7463 206d 6f64 656c 2061 6e20 6e65 6564  tc model an need
+00022f00: 7320 746f 2062 6520 6576 616c 7561 7465  s to be evaluate
+00022f10: 6420 6f6e 2065 6163 6820 6974 6572 6174  d on each iterat
+00022f20: 696f 6e20 6f6e 2062 6f74 6820 7468 6520  ion on both the 
+00022f30: 696e 7075 7420 7265 6772 6573 736f 7273  input regressors
+00022f40: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
+00022f50: 2020 2020 2020 2020 2320 6669 7420 2874          # fit (t
+00022f60: 6f20 6765 6e65 7261 7465 2074 6865 2072  o generate the r
+00022f70: 6573 6964 7561 6c73 2920 616e 6420 6f6e  esiduals) and on
+00022f80: 2074 6865 2069 6e70 7574 2072 6567 7265   the input regre
+00022f90: 7373 6f72 7320 746f 2074 6869 7320 6675  ssors to this fu
+00022fa0: 6e63 7469 6f6e 2028 746f 2067 656e 6572  nction (to gener
+00022fb0: 6174 6520 7072 6564 6963 7469 6f6e 7329  ate predictions)
+00022fc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00022fd0: 2020 6966 2074 2069 7320 6e6f 7420 4e6f    if t is not No
+00022fe0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00022ff0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00023000: 676c 6f62 616c 5f6d 6f64 656c 3a0a 2020  global_model:.  
+00023010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023020: 2020 2020 2020 6f72 6967 696e 616c 5f6c        original_l
+00023030: 6d5f 6172 6775 6d65 6e74 7320 3d20 6e70  m_arguments = np
+00023040: 2e63 6f70 7928 7365 6c66 2e6c 6d5f 6172  .copy(self.lm_ar
+00023050: 6775 6d65 6e74 7329 0a20 2020 2020 2020  guments).       
+00023060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023070: 2069 6620 7365 6c66 2e64 6963 7469 6f6e   if self.diction
+00023080: 6172 795b 2767 6c6f 6261 6c5f 6d6f 6465  ary['global_mode
+00023090: 6c27 5d5b 2747 5044 6574 7265 6e64 275d  l']['GPDetrend']
+000230a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000230b0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000230c0: 6c66 2e6f 7269 6769 6e61 6c5f 4750 7265  lf.original_GPre
+000230d0: 6772 6573 736f 7273 203d 206e 702e 636f  gressors = np.co
+000230e0: 7079 280a 2020 2020 2020 2020 2020 2020  py(.            
 000230f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023100: 2020 2020 2020 2020 2020 6f72 6967 696e            origin
-00023110: 616c 5f6c 6d5f 6172 6775 6d65 6e74 7320  al_lm_arguments 
-00023120: 3d20 6e70 2e63 6f70 7928 0a20 2020 2020  = np.copy(.     
+00023100: 2020 2020 7365 6c66 2e64 6963 7469 6f6e      self.diction
+00023110: 6172 795b 2767 6c6f 6261 6c5f 6d6f 6465  ary['global_mode
+00023120: 6c27 5d0a 2020 2020 2020 2020 2020 2020  l'].            
 00023130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023140: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00023150: 6c6d 5f61 7267 756d 656e 7473 5b69 6e73  lm_arguments[ins
-00023160: 7472 756d 656e 745d 290a 0a20 2020 2020  trument])..     
-00023170: 2020 2020 2020 2020 2020 2023 204e 6f77             # Now
-00023180: 2069 7465 7261 7465 2074 6872 6f75 6768   iterate through
-00023190: 2061 6c6c 2073 616d 706c 6573 3a0a 2020   all samples:.  
-000231a0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-000231b0: 756e 7465 7220 3d20 300a 2020 2020 2020  unter = 0.      
-000231c0: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-000231d0: 696e 2069 6478 5f73 616d 706c 6573 3a0a  in idx_samples:.
+00023140: 2020 2020 5b27 6e6f 6973 655f 6d6f 6465      ['noise_mode
+00023150: 6c27 5d2e 5829 0a20 2020 2020 2020 2020  l'].X).         
+00023160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023170: 2020 2073 656c 662e 6469 6374 696f 6e61     self.dictiona
+00023180: 7279 5b27 676c 6f62 616c 5f6d 6f64 656c  ry['global_model
+00023190: 275d 5b0a 2020 2020 2020 2020 2020 2020  '][.            
+000231a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000231b0: 2020 2020 276e 6f69 7365 5f6d 6f64 656c      'noise_model
+000231c0: 275d 2e58 203d 2047 5072 6567 7265 7373  '].X = GPregress
+000231d0: 6f72 730a 2020 2020 2020 2020 2020 2020  ors.            
 000231e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000231f0: 2020 2020 2320 4765 7420 7061 7261 6d65      # Get parame
-00023200: 7465 7273 2066 6f72 2074 6865 2069 2d74  ters for the i-t
-00023210: 6820 7361 6d70 6c65 3a0a 2020 2020 2020  h sample:.      
-00023220: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00023230: 7220 7061 7261 6d65 7465 7220 696e 2069  r parameter in i
-00023240: 6e70 7574 5f70 6172 616d 6574 6572 733a  nput_parameters:
-00023250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023260: 2020 2020 2020 2020 2023 2050 6f70 756c           # Popul
-00023270: 6174 6520 7468 6520 6375 7272 656e 7420  ate the current 
-00023280: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
-00023290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000232a0: 2020 2020 2020 2020 2063 7572 7265 6e74           current
-000232b0: 5f70 6172 616d 6574 6572 5f76 616c 7565  _parameter_value
-000232c0: 735b 7061 7261 6d65 7465 725d 203d 2070  s[parameter] = p
-000232d0: 6172 616d 6574 6572 5f76 616c 7565 735b  arameter_values[
-000232e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000232f0: 2020 2020 2020 2020 2020 2020 2070 6172               par
-00023300: 616d 6574 6572 5d5b 695d 0a0a 2020 2020  ameter][i]..    
-00023310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023320: 2320 4576 616c 7561 7465 2072 762f 6c69  # Evaluate rv/li
-00023330: 6768 7463 7572 7665 2061 7420 7468 6520  ghtcurve at the 
-00023340: 6375 7272 656e 7420 7061 7261 6d65 7465  current paramete
-00023350: 7220 7661 6c75 6573 2c20 6361 6c63 756c  r values, calcul
-00023360: 6174 6520 7265 7369 6475 616c 732c 2073  ate residuals, s
-00023370: 6176 6520 7468 656d 3a0a 2020 2020 2020  ave them:.      
-00023380: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00023390: 2073 656c 662e 6d6f 6465 6c74 7970 6520   self.modeltype 
-000233a0: 3d3d 2027 6c63 273a 0a20 2020 2020 2020  == 'lc':.       
+000231f0: 6966 2047 5072 6567 7265 7373 6f72 7320  if GPregressors 
+00023200: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00023210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023220: 2020 2020 2020 2020 2072 6169 7365 2045           raise E
+00023230: 7863 6570 7469 6f6e 280a 2020 2020 2020  xception(.      
+00023240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023250: 2020 2020 2020 2020 2020 2020 2020 225c                "\
+00023260: 7420 476f 6261 6c20 6d6f 6465 6c20 6861  t Gobal model ha
+00023270: 7320 6120 4750 2c20 616e 6420 7265 7175  s a GP, and requ
+00023280: 6972 6573 2061 2047 5072 6567 7265 7373  ires a GPregress
+00023290: 6f72 7320 746f 2062 6520 696e 7075 7474  ors to be inputt
+000232a0: 6564 2074 6f20 6265 2065 7661 6c75 6174  ed to be evaluat
+000232b0: 6564 2e22 0a20 2020 2020 2020 2020 2020  ed.".           
+000232c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000232d0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+000232e0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000232f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023300: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00023310: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
+00023320: 7275 6d65 6e74 5d5b 2747 5044 6574 7265  rument]['GPDetre
+00023330: 6e64 275d 3a0a 2020 2020 2020 2020 2020  nd']:.          
+00023340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023350: 2020 7365 6c66 2e64 6963 7469 6f6e 6172    self.dictionar
+00023360: 795b 696e 7374 7275 6d65 6e74 5d5b 0a20  y[instrument][. 
+00023370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023380: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00023390: 6e6f 6973 655f 6d6f 6465 6c27 5d2e 5820  noise_model'].X 
+000233a0: 3d20 4750 7265 6772 6573 736f 7273 0a20  = GPregressors. 
 000233b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000233c0: 2073 656c 662e 6765 6e65 7261 7465 5f6c   self.generate_l
-000233d0: 635f 6d6f 6465 6c28 6375 7272 656e 745f  c_model(current_
-000233e0: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
-000233f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00023400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023420: 2065 7661 6c75 6174 655f 6c63 3d54 7275   evaluate_lc=Tru
-00023430: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-00023440: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00023450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023460: 2020 2020 2073 656c 662e 6765 6e65 7261       self.genera
-00023470: 7465 5f72 765f 6d6f 6465 6c28 6375 7272  te_rv_model(curr
-00023480: 656e 745f 7061 7261 6d65 7465 725f 7661  ent_parameter_va
-00023490: 6c75 6573 2c0a 2020 2020 2020 2020 2020  lues,.          
-000234a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000234b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000234c0: 2020 2020 2065 7661 6c75 6174 655f 676c       evaluate_gl
-000234d0: 6f62 616c 5f65 7272 6f72 733d 5472 7565  obal_errors=True
-000234e0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-000234f0: 2020 2020 2020 2023 2053 6176 6520 7265         # Save re
-00023500: 7369 6475 616c 7320 2861 6e64 2067 6c6f  siduals (and glo
-00023510: 6261 6c20 6572 726f 7273 2c20 696e 2074  bal errors, in t
-00023520: 6865 2063 6173 6520 6f66 2067 6c6f 6261  he case of globa
-00023530: 6c20 6d6f 6465 6c73 293a 0a20 2020 2020  l models):.     
-00023540: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00023550: 6620 7365 6c66 2e67 6c6f 6261 6c5f 6d6f  f self.global_mo
-00023560: 6465 6c3a 0a20 2020 2020 2020 2020 2020  del:.           
-00023570: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00023580: 662e 7265 7369 6475 616c 7320 3d20 7365  f.residuals = se
-00023590: 6c66 2e79 202d 2073 656c 662e 6d6f 6465  lf.y - self.mode
-000235a0: 6c5b 2767 6c6f 6261 6c27 5d0a 2020 2020  l['global'].    
-000235b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000235c0: 2020 2020 7365 6c66 2e76 6172 6961 6e63      self.varianc
-000235d0: 6573 203d 2073 656c 662e 6d6f 6465 6c5b  es = self.model[
-000235e0: 2767 6c6f 6261 6c5f 7661 7269 616e 6365  'global_variance
-000235f0: 7327 5d0a 2020 2020 2020 2020 2020 2020  s'].            
-00023600: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00023610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023620: 2020 2020 2020 7365 6c66 2e72 6573 6964        self.resid
-00023630: 7561 6c73 203d 2073 656c 662e 6461 7461  uals = self.data
-00023640: 5b69 6e73 7472 756d 656e 745d 202d 2073  [instrument] - s
-00023650: 656c 662e 6d6f 6465 6c5b 0a20 2020 2020  elf.model[.     
-00023660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023670: 2020 2020 2020 2069 6e73 7472 756d 656e         instrumen
-00023680: 745d 5b27 6465 7465 726d 696e 6973 7469  t]['deterministi
-00023690: 6327 5d0a 0a20 2020 2020 2020 2020 2020  c']..           
-000236a0: 2020 2020 2020 2020 2023 2049 6620 6578           # If ex
-000236b0: 7472 6170 6f6c 6174 696e 6720 2874 2069  trapolating (t i
-000236c0: 7320 6e6f 7420 4e6f 6e65 292c 2065 7661  s not None), eva
-000236d0: 6c75 6174 6520 7468 6520 6578 7472 6170  luate the extrap
-000236e0: 6f6c 6174 6564 206d 6f64 656c 2077 6974  olated model wit
-000236f0: 6820 6120 6c69 6768 7463 7572 7665 2f72  h a lightcurve/r
-00023700: 7620 6d6f 6465 6c0a 2020 2020 2020 2020  v model.        
-00023710: 2020 2020 2020 2020 2020 2020 2320 636f              # co
-00023720: 6e73 6964 6572 696e 6720 7468 6520 696e  nsidering the in
-00023730: 7075 7420 7469 6d65 7320 616e 6420 6e6f  put times and no
-00023740: 7420 7468 6520 6375 7272 656e 7420 6461  t the current da
-00023750: 7461 7365 7420 7469 6d65 733a 0a20 2020  taset times:.   
-00023760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023770: 2069 6620 7420 6973 206e 6f74 204e 6f6e   if t is not Non
-00023780: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00023790: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-000237a0: 6c66 2e6d 6f64 656c 7479 7065 203d 3d20  lf.modeltype == 
-000237b0: 276c 6327 3a0a 2020 2020 2020 2020 2020  'lc':.          
-000237c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000237d0: 2020 6966 2073 656c 662e 676c 6f62 616c    if self.global
-000237e0: 5f6d 6f64 656c 3a0a 2020 2020 2020 2020  _model:.        
-000237f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023800: 2020 2020 2020 2020 2320 4966 2067 6c6f          # If glo
-00023810: 6261 6c20 6d6f 6465 6c2c 2073 6574 2061  bal model, set a
-00023820: 6c6c 2073 7570 6572 2d73 616d 706c 6520  ll super-sample 
-00023830: 6f62 6a65 6374 7320 746f 2065 7661 6c75  objects to evalu
-00023840: 6174 6520 6174 2074 6865 2069 6e70 7574  ate at the input
-00023850: 2074 696d 6573 3a0a 2020 2020 2020 2020   times:.        
-00023860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023870: 2020 2020 2020 2020 666f 7220 6769 6e73          for gins
-00023880: 7472 756d 656e 7420 696e 2069 6e73 7472  trument in instr
-00023890: 756d 656e 7473 3a0a 0a20 2020 2020 2020  uments:..       
-000238a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000238b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000238c0: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
-000238d0: 6769 6e73 7472 756d 656e 745d 5b27 5472  ginstrument]['Tr
-000238e0: 616e 7369 7446 6974 275d 206f 7220 7365  ansitFit'] or se
-000238f0: 6c66 2e64 6963 7469 6f6e 6172 795b 6769  lf.dictionary[gi
-00023900: 6e73 7472 756d 656e 745d 5b27 5472 616e  nstrument]['Tran
-00023910: 7369 7446 6974 4361 7477 6f6d 616e 275d  sitFitCatwoman']
-00023920: 206f 7220 7365 6c66 2e64 6963 7469 6f6e   or self.diction
-00023930: 6172 795b 6769 6e73 7472 756d 656e 745d  ary[ginstrument]
-00023940: 5b27 4563 6c69 7073 6546 6974 275d 206f  ['EclipseFit'] o
-00023950: 7220 7365 6c66 2e64 6963 7469 6f6e 6172  r self.dictionar
-00023960: 795b 6769 6e73 7472 756d 656e 745d 5b27  y[ginstrument]['
-00023970: 5472 616e 4563 6c46 6974 275d 3a0a 2020  TranEclFit']:.  
-00023980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000239a0: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-000239b0: 5b67 696e 7374 7275 6d65 6e74 5d5b 2770  [ginstrument]['p
-000239c0: 6172 616d 7327 5d2c 2073 656c 662e 6d6f  arams'], self.mo
-000239d0: 6465 6c5b 6769 6e73 7472 756d 656e 745d  del[ginstrument]
-000239e0: 5b27 6d27 5d20 3d20 7375 7065 7273 616d  ['m'] = supersam
-000239f0: 706c 655f 7061 7261 6d73 5b67 696e 7374  ple_params[ginst
-00023a00: 7275 6d65 6e74 5d2c 7375 7065 7273 616d  rument],supersam
-00023a10: 706c 655f 6d5b 6769 6e73 7472 756d 656e  ple_m[ginstrumen
-00023a20: 745d 0a0a 2020 2020 2020 2020 2020 2020  t]..            
+000233c0: 2020 2020 2020 2020 2020 2069 6620 4750             if GP
+000233d0: 7265 6772 6573 736f 7273 2069 7320 4e6f  regressors is No
+000233e0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+000233f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023400: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
+00023410: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+00023420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023430: 2020 2020 2020 2020 2022 5c74 204d 6f64           "\t Mod
+00023440: 656c 2066 6f72 2069 6e73 7472 756d 656e  el for instrumen
+00023450: 7420 2220 2b20 696e 7374 7275 6d65 6e74  t " + instrument
+00023460: 202b 0a20 2020 2020 2020 2020 2020 2020   +.             
+00023470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023480: 2020 2020 2020 2022 2068 6173 2061 2047         " has a G
+00023490: 502c 2061 6e64 2072 6571 7569 7265 7320  P, and requires 
+000234a0: 6120 4750 7265 6772 6573 736f 7273 2074  a GPregressors t
+000234b0: 6f20 6265 2069 6e70 7574 7465 6420 746f  o be inputted to
+000234c0: 2062 6520 6576 616c 7561 7465 642e 220a   be evaluated.".
+000234d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000234e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000234f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00023500: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00023510: 662e 6c6d 5f62 6f6f 6c65 616e 5b69 6e73  f.lm_boolean[ins
+00023520: 7472 756d 656e 745d 3a0a 2020 2020 2020  trument]:.      
+00023530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023540: 2020 2020 2020 6f72 6967 696e 616c 5f6c        original_l
+00023550: 6d5f 6172 6775 6d65 6e74 7320 3d20 6e70  m_arguments = np
+00023560: 2e63 6f70 7928 0a20 2020 2020 2020 2020  .copy(.         
+00023570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023580: 2020 2020 2020 2073 656c 662e 6c6d 5f61         self.lm_a
+00023590: 7267 756d 656e 7473 5b69 6e73 7472 756d  rguments[instrum
+000235a0: 656e 745d 290a 0a20 2020 2020 2020 2020  ent])..         
+000235b0: 2020 2020 2020 2023 204e 6f77 2069 7465         # Now ite
+000235c0: 7261 7465 2074 6872 6f75 6768 2061 6c6c  rate through all
+000235d0: 2073 616d 706c 6573 3a0a 2020 2020 2020   samples:.      
+000235e0: 2020 2020 2020 2020 2020 636f 756e 7465            counte
+000235f0: 7220 3d20 300a 2020 2020 2020 2020 2020  r = 0.          
+00023600: 2020 2020 2020 666f 7220 6920 696e 2069        for i in i
+00023610: 6478 5f73 616d 706c 6573 3a0a 2020 2020  dx_samples:.    
+00023620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023630: 2320 4765 7420 7061 7261 6d65 7465 7273  # Get parameters
+00023640: 2066 6f72 2074 6865 2069 2d74 6820 7361   for the i-th sa
+00023650: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
+00023660: 2020 2020 2020 2020 2020 666f 7220 7061            for pa
+00023670: 7261 6d65 7465 7220 696e 2069 6e70 7574  rameter in input
+00023680: 5f70 6172 616d 6574 6572 733a 0a20 2020  _parameters:.   
+00023690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000236a0: 2020 2020 2023 2050 6f70 756c 6174 6520       # Populate 
+000236b0: 7468 6520 6375 7272 656e 7420 7061 7261  the current para
+000236c0: 6d65 7465 725f 7661 6c75 6573 0a20 2020  meter_values.   
+000236d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000236e0: 2020 2020 2063 7572 7265 6e74 5f70 6172       current_par
+000236f0: 616d 6574 6572 5f76 616c 7565 735b 7061  ameter_values[pa
+00023700: 7261 6d65 7465 725d 203d 2070 6172 616d  rameter] = param
+00023710: 6574 6572 5f76 616c 7565 735b 0a20 2020  eter_values[.   
+00023720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023730: 2020 2020 2020 2020 2070 6172 616d 6574           paramet
+00023740: 6572 5d5b 695d 0a0a 2020 2020 2020 2020  er][i]..        
+00023750: 2020 2020 2020 2020 2020 2020 2320 4576              # Ev
+00023760: 616c 7561 7465 2072 762f 6c69 6768 7463  aluate rv/lightc
+00023770: 7572 7665 2061 7420 7468 6520 6375 7272  urve at the curr
+00023780: 656e 7420 7061 7261 6d65 7465 7220 7661  ent parameter va
+00023790: 6c75 6573 2c20 6361 6c63 756c 6174 6520  lues, calculate 
+000237a0: 7265 7369 6475 616c 732c 2073 6176 6520  residuals, save 
+000237b0: 7468 656d 3a0a 2020 2020 2020 2020 2020  them:.          
+000237c0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+000237d0: 662e 6d6f 6465 6c74 7970 6520 3d3d 2027  f.modeltype == '
+000237e0: 6c63 273a 0a20 2020 2020 2020 2020 2020  lc':.           
+000237f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00023800: 662e 6765 6e65 7261 7465 5f6c 635f 6d6f  f.generate_lc_mo
+00023810: 6465 6c28 6375 7272 656e 745f 7061 7261  del(current_para
+00023820: 6d65 7465 725f 7661 6c75 6573 2c0a 2020  meter_values,.  
+00023830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023850: 2020 2020 2020 2020 2020 2020 2065 7661               eva
+00023860: 6c75 6174 655f 6c63 3d54 7275 6529 0a20  luate_lc=True). 
+00023870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023880: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00023890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000238a0: 2073 656c 662e 6765 6e65 7261 7465 5f72   self.generate_r
+000238b0: 765f 6d6f 6465 6c28 6375 7272 656e 745f  v_model(current_
+000238c0: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+000238d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000238e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000238f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023900: 2065 7661 6c75 6174 655f 676c 6f62 616c   evaluate_global
+00023910: 5f65 7272 6f72 733d 5472 7565 290a 0a20  _errors=True).. 
+00023920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023930: 2020 2023 2053 6176 6520 7265 7369 6475     # Save residu
+00023940: 616c 7320 2861 6e64 2067 6c6f 6261 6c20  als (and global 
+00023950: 6572 726f 7273 2c20 696e 2074 6865 2063  errors, in the c
+00023960: 6173 6520 6f66 2067 6c6f 6261 6c20 6d6f  ase of global mo
+00023970: 6465 6c73 293a 0a20 2020 2020 2020 2020  dels):.         
+00023980: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00023990: 6c66 2e67 6c6f 6261 6c5f 6d6f 6465 6c3a  lf.global_model:
+000239a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000239b0: 2020 2020 2020 2020 2073 656c 662e 7265           self.re
+000239c0: 7369 6475 616c 7320 3d20 7365 6c66 2e79  siduals = self.y
+000239d0: 202d 2073 656c 662e 6d6f 6465 6c5b 2767   - self.model['g
+000239e0: 6c6f 6261 6c27 5d0a 2020 2020 2020 2020  lobal'].        
+000239f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023a00: 7365 6c66 2e76 6172 6961 6e63 6573 203d  self.variances =
+00023a10: 2073 656c 662e 6d6f 6465 6c5b 2767 6c6f   self.model['glo
+00023a20: 6261 6c5f 7661 7269 616e 6365 7327 5d0a  bal_variances'].
 00023a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023a40: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00023a50: 6c6d 5f62 6f6f 6c65 616e 5b67 696e 7374  lm_boolean[ginst
-00023a60: 7275 6d65 6e74 5d3a 0a20 2020 2020 2020  rument]:.       
-00023a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023a90: 2073 656c 662e 6c6d 5f61 7267 756d 656e   self.lm_argumen
-00023aa0: 7473 5b0a 2020 2020 2020 2020 2020 2020  ts[.            
-00023ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023ad0: 6769 6e73 7472 756d 656e 745d 203d 204c  ginstrument] = L
-00023ae0: 4d72 6567 7265 7373 6f72 735b 0a20 2020  Mregressors[.   
-00023af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023b10: 2020 2020 2020 2020 2020 2020 2067 696e               gin
-00023b20: 7374 7275 6d65 6e74 5d0a 2020 2020 2020  strument].      
-00023b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023b40: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00023b50: 6c66 2e6d 6f64 656c 5b67 696e 7374 7275  lf.model[ginstru
-00023b60: 6d65 6e74 5d5b 276f 6e65 7327 5d20 3d20  ment]['ones'] = 
-00023b70: 6e70 2e6f 6e65 7328 0a20 2020 2020 2020  np.ones(.       
-00023b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023ba0: 206e 7429 0a20 2020 2020 2020 2020 2020   nt).           
-00023bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023bc0: 2020 2020 2020 2020 2073 656c 662e 6e64           self.nd
-00023bd0: 6174 6170 6f69 6e74 735f 7065 725f 696e  atapoints_per_in
-00023be0: 7374 7275 6d65 6e74 5b0a 2020 2020 2020  strument[.      
-00023bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023c10: 2020 6769 6e73 7472 756d 656e 745d 203d    ginstrument] =
-00023c20: 206e 740a 2020 2020 2020 2020 2020 2020   nt.            
+00023a40: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00023a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023a60: 2020 7365 6c66 2e72 6573 6964 7561 6c73    self.residuals
+00023a70: 203d 2073 656c 662e 6461 7461 5b69 6e73   = self.data[ins
+00023a80: 7472 756d 656e 745d 202d 2073 656c 662e  trument] - self.
+00023a90: 6d6f 6465 6c5b 0a20 2020 2020 2020 2020  model[.         
+00023aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023ab0: 2020 2069 6e73 7472 756d 656e 745d 5b27     instrument]['
+00023ac0: 6465 7465 726d 696e 6973 7469 6327 5d0a  deterministic'].
+00023ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023ae0: 2020 2020 2023 2049 6620 6578 7472 6170       # If extrap
+00023af0: 6f6c 6174 696e 6720 2874 2069 7320 6e6f  olating (t is no
+00023b00: 7420 4e6f 6e65 292c 2065 7661 6c75 6174  t None), evaluat
+00023b10: 6520 7468 6520 6578 7472 6170 6f6c 6174  e the extrapolat
+00023b20: 6564 206d 6f64 656c 2077 6974 6820 6120  ed model with a 
+00023b30: 6c69 6768 7463 7572 7665 2f72 7620 6d6f  lightcurve/rv mo
+00023b40: 6465 6c0a 2020 2020 2020 2020 2020 2020  del.            
+00023b50: 2020 2020 2020 2020 2320 636f 6e73 6964          # consid
+00023b60: 6572 696e 6720 7468 6520 696e 7075 7420  ering the input 
+00023b70: 7469 6d65 7320 616e 6420 6e6f 7420 7468  times and not th
+00023b80: 6520 6375 7272 656e 7420 6461 7461 7365  e current datase
+00023b90: 7420 7469 6d65 733a 0a20 2020 2020 2020  t times:.       
+00023ba0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00023bb0: 7420 6973 206e 6f74 204e 6f6e 653a 0a20  t is not None:. 
+00023bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023bd0: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
+00023be0: 6f64 656c 7479 7065 203d 3d20 276c 6327  odeltype == 'lc'
+00023bf0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00023c00: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00023c10: 2073 656c 662e 676c 6f62 616c 5f6d 6f64   self.global_mod
+00023c20: 656c 3a0a 2020 2020 2020 2020 2020 2020  el:.            
 00023c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023c40: 2020 2020 2020 2020 7365 6c66 2e69 6e73          self.ins
-00023c50: 7472 756d 656e 745f 696e 6465 7865 735b  trument_indexes[
-00023c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023c80: 2020 2020 2020 2020 2067 696e 7374 7275           ginstru
-00023c90: 6d65 6e74 5d20 3d20 6475 6d6d 795f 696e  ment] = dummy_in
-00023ca0: 6465 7865 730a 2020 2020 2020 2020 2020  dexes.          
-00023cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023cc0: 2020 2020 2020 6f72 6967 696e 616c 5f69        original_i
-00023cd0: 6e61 6d65 7320 3d20 6e70 2e63 6f70 7928  names = np.copy(
-00023ce0: 7365 6c66 2e69 6e61 6d65 7329 0a20 2020  self.inames).   
-00023cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023d00: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00023d10: 662e 696e 616d 6573 203d 205b 696e 7374  f.inames = [inst
-00023d20: 7275 6d65 6e74 5d0a 2020 2020 2020 2020  rument].        
-00023d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023d40: 2020 2020 2020 2020 7365 6c66 2e67 656e          self.gen
-00023d50: 6572 6174 655f 6c63 5f6d 6f64 656c 280a  erate_lc_model(.
-00023d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023d80: 2020 2020 6375 7272 656e 745f 7061 7261      current_para
-00023d90: 6d65 7465 725f 7661 6c75 6573 2c0a 2020  meter_values,.  
-00023da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023dc0: 2020 6576 616c 7561 7465 5f67 6c6f 6261    evaluate_globa
-00023dd0: 6c5f 6572 726f 7273 3d46 616c 7365 2c0a  l_errors=False,.
-00023de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023e00: 2020 2020 6576 616c 7561 7465 5f6c 633d      evaluate_lc=
-00023e10: 5472 7565 290a 2020 2020 2020 2020 2020  True).          
-00023e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023e30: 2020 2020 2020 7365 6c66 2e69 6e61 6d65        self.iname
-00023e40: 7320 3d20 6f72 6967 696e 616c 5f69 6e61  s = original_ina
-00023e50: 6d65 730a 2020 2020 2020 2020 2020 2020  mes.            
+00023c40: 2020 2020 2320 4966 2067 6c6f 6261 6c20      # If global 
+00023c50: 6d6f 6465 6c2c 2073 6574 2061 6c6c 2073  model, set all s
+00023c60: 7570 6572 2d73 616d 706c 6520 6f62 6a65  uper-sample obje
+00023c70: 6374 7320 746f 2065 7661 6c75 6174 6520  cts to evaluate 
+00023c80: 6174 2074 6865 2069 6e70 7574 2074 696d  at the input tim
+00023c90: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00023ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023cb0: 2020 2020 666f 7220 6769 6e73 7472 756d      for ginstrum
+00023cc0: 656e 7420 696e 2069 6e73 7472 756d 656e  ent in instrumen
+00023cd0: 7473 3a0a 0a20 2020 2020 2020 2020 2020  ts:..           
+00023ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023cf0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00023d00: 2e64 6963 7469 6f6e 6172 795b 6769 6e73  .dictionary[gins
+00023d10: 7472 756d 656e 745d 5b27 5472 616e 7369  trument]['Transi
+00023d20: 7446 6974 275d 206f 7220 7365 6c66 2e64  tFit'] or self.d
+00023d30: 6963 7469 6f6e 6172 795b 6769 6e73 7472  ictionary[ginstr
+00023d40: 756d 656e 745d 5b27 5472 616e 7369 7446  ument]['TransitF
+00023d50: 6974 4361 7477 6f6d 616e 275d 206f 7220  itCatwoman'] or 
+00023d60: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
+00023d70: 6769 6e73 7472 756d 656e 745d 5b27 4563  ginstrument]['Ec
+00023d80: 6c69 7073 6546 6974 275d 206f 7220 7365  lipseFit'] or se
+00023d90: 6c66 2e64 6963 7469 6f6e 6172 795b 6769  lf.dictionary[gi
+00023da0: 6e73 7472 756d 656e 745d 5b27 5472 616e  nstrument]['Tran
+00023db0: 4563 6c46 6974 275d 3a0a 2020 2020 2020  EclFit']:.      
+00023dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023de0: 2020 7365 6c66 2e6d 6f64 656c 5b67 696e    self.model[gin
+00023df0: 7374 7275 6d65 6e74 5d5b 2770 6172 616d  strument]['param
+00023e00: 7327 5d2c 2073 656c 662e 6d6f 6465 6c5b  s'], self.model[
+00023e10: 6769 6e73 7472 756d 656e 745d 5b27 6d27  ginstrument]['m'
+00023e20: 5d20 3d20 7375 7065 7273 616d 706c 655f  ] = supersample_
+00023e30: 7061 7261 6d73 5b67 696e 7374 7275 6d65  params[ginstrume
+00023e40: 6e74 5d2c 7375 7065 7273 616d 706c 655f  nt],supersample_
+00023e50: 6d5b 6769 6e73 7472 756d 656e 745d 0a0a  m[ginstrument]..
 00023e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023e70: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00023e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023e90: 2020 2020 2020 2320 4966 206e 6f74 2c20        # If not, 
-00023ea0: 7365 7420 7468 656d 206f 6e6c 7920 666f  set them only fo
-00023eb0: 7220 7468 6520 696e 7374 7275 6d65 6e74  r the instrument
-00023ec0: 206f 6620 696e 7465 7265 7374 3a0a 0a20   of interest:.. 
-00023ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023ee0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00023ef0: 6620 7365 6c66 2e64 6963 7469 6f6e 6172  f self.dictionar
-00023f00: 795b 696e 7374 7275 6d65 6e74 5d5b 2754  y[instrument]['T
-00023f10: 7261 6e73 6974 4669 7427 5d20 6f72 2073  ransitFit'] or s
-00023f20: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
-00023f30: 6e73 7472 756d 656e 745d 5b27 5472 616e  nstrument]['Tran
-00023f40: 7369 7446 6974 4361 7477 6f6d 616e 275d  sitFitCatwoman']
-00023f50: 206f 7220 7365 6c66 2e64 6963 7469 6f6e   or self.diction
-00023f60: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
-00023f70: 2745 636c 6970 7365 4669 7427 5d20 6f72  'EclipseFit'] or
-00023f80: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-00023f90: 5b69 6e73 7472 756d 656e 745d 5b27 5472  [instrument]['Tr
-00023fa0: 616e 4563 6c46 6974 275d 3a0a 2020 2020  anEclFit']:.    
-00023fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023e80: 2020 2020 6966 2073 656c 662e 6c6d 5f62      if self.lm_b
+00023e90: 6f6f 6c65 616e 5b67 696e 7374 7275 6d65  oolean[ginstrume
+00023ea0: 6e74 5d3a 0a20 2020 2020 2020 2020 2020  nt]:.           
+00023eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023ec0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00023ed0: 662e 6c6d 5f61 7267 756d 656e 7473 5b0a  f.lm_arguments[.
+00023ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023f00: 2020 2020 2020 2020 2020 2020 6769 6e73              gins
+00023f10: 7472 756d 656e 745d 203d 204c 4d72 6567  trument] = LMreg
+00023f20: 7265 7373 6f72 735b 0a20 2020 2020 2020  ressors[.       
+00023f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023f50: 2020 2020 2020 2020 2067 696e 7374 7275           ginstru
+00023f60: 6d65 6e74 5d0a 2020 2020 2020 2020 2020  ment].          
+00023f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023f80: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00023f90: 6f64 656c 5b67 696e 7374 7275 6d65 6e74  odel[ginstrument
+00023fa0: 5d5b 276f 6e65 7327 5d20 3d20 6e70 2e6f  ]['ones'] = np.o
+00023fb0: 6e65 7328 0a20 2020 2020 2020 2020 2020  nes(.           
 00023fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023fd0: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
-00023fe0: 756d 656e 745d 5b27 7061 7261 6d73 275d  ument]['params']
-00023ff0: 2c20 7365 6c66 2e6d 6f64 656c 5b69 6e73  , self.model[ins
-00024000: 7472 756d 656e 745d 5b27 6d27 5d20 3d20  trument]['m'] = 
-00024010: 7375 7065 7273 616d 706c 655f 7061 7261  supersample_para
-00024020: 6d73 2c73 7570 6572 7361 6d70 6c65 5f6d  ms,supersample_m
-00024030: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00024040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024050: 2020 6966 2073 656c 662e 6c6d 5f62 6f6f    if self.lm_boo
-00024060: 6c65 616e 5b69 6e73 7472 756d 656e 745d  lean[instrument]
-00024070: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00024080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024090: 2020 2020 2020 7365 6c66 2e6c 6d5f 6172        self.lm_ar
-000240a0: 6775 6d65 6e74 735b 696e 7374 7275 6d65  guments[instrume
-000240b0: 6e74 5d20 3d20 4c4d 7265 6772 6573 736f  nt] = LMregresso
-000240c0: 7273 0a20 2020 2020 2020 2020 2020 2020  rs.             
-000240d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000240e0: 2020 2073 656c 662e 6d6f 6465 6c5b 696e     self.model[in
-000240f0: 7374 7275 6d65 6e74 5d5b 276f 6e65 7327  strument]['ones'
-00024100: 5d20 3d20 6e70 2e6f 6e65 7328 6e74 290a  ] = np.ones(nt).
-00024110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024130: 7365 6c66 2e6e 6461 7461 706f 696e 7473  self.ndatapoints
-00024140: 5f70 6572 5f69 6e73 7472 756d 656e 745b  _per_instrument[
-00024150: 696e 7374 7275 6d65 6e74 5d20 3d20 6e74  instrument] = nt
-00024160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023fd0: 2020 2020 2020 2020 2020 2020 206e 7429               nt)
+00023fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024000: 2020 2020 2073 656c 662e 6e64 6174 6170       self.ndatap
+00024010: 6f69 6e74 735f 7065 725f 696e 7374 7275  oints_per_instru
+00024020: 6d65 6e74 5b0a 2020 2020 2020 2020 2020  ment[.          
+00024030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024040: 2020 2020 2020 2020 2020 2020 2020 6769                gi
+00024050: 6e73 7472 756d 656e 745d 203d 206e 740a  nstrument] = nt.
+00024060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024080: 2020 2020 7365 6c66 2e69 6e73 7472 756d      self.instrum
+00024090: 656e 745f 696e 6465 7865 735b 0a20 2020  ent_indexes[.   
+000240a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000240b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000240c0: 2020 2020 2067 696e 7374 7275 6d65 6e74       ginstrument
+000240d0: 5d20 3d20 6475 6d6d 795f 696e 6465 7865  ] = dummy_indexe
+000240e0: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+000240f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024100: 2020 6f72 6967 696e 616c 5f69 6e61 6d65    original_iname
+00024110: 7320 3d20 6e70 2e63 6f70 7928 7365 6c66  s = np.copy(self
+00024120: 2e69 6e61 6d65 7329 0a20 2020 2020 2020  .inames).       
+00024130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024140: 2020 2020 2020 2020 2073 656c 662e 696e           self.in
+00024150: 616d 6573 203d 205b 696e 7374 7275 6d65  ames = [instrume
+00024160: 6e74 5d0a 2020 2020 2020 2020 2020 2020  nt].            
 00024170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024180: 2023 2047 656e 6572 6174 6520 6c69 6768   # Generate ligh
-00024190: 7463 7572 7665 206d 6f64 656c 3a0a 0a20  tcurve model:.. 
+00024180: 2020 2020 7365 6c66 2e67 656e 6572 6174      self.generat
+00024190: 655f 6c63 5f6d 6f64 656c 280a 2020 2020  e_lc_model(.    
 000241a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000241b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000241c0: 656c 662e 6765 6e65 7261 7465 5f6c 635f  elf.generate_lc_
-000241d0: 6d6f 6465 6c28 0a20 2020 2020 2020 2020  model(.         
+000241b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000241c0: 6375 7272 656e 745f 7061 7261 6d65 7465  current_paramete
+000241d0: 725f 7661 6c75 6573 2c0a 2020 2020 2020  r_values,.      
 000241e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000241f0: 2020 2020 2020 2020 2020 2063 7572 7265             curre
-00024200: 6e74 5f70 6172 616d 6574 6572 5f76 616c  nt_parameter_val
-00024210: 7565 732c 0a20 2020 2020 2020 2020 2020  ues,.           
+000241f0: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+00024200: 616c 7561 7465 5f67 6c6f 6261 6c5f 6572  aluate_global_er
+00024210: 726f 7273 3d46 616c 7365 2c0a 2020 2020  rors=False,.    
 00024220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024230: 2020 2020 2020 2020 2065 7661 6c75 6174           evaluat
-00024240: 655f 676c 6f62 616c 5f65 7272 6f72 733d  e_global_errors=
-00024250: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+00024230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024240: 6576 616c 7561 7465 5f6c 633d 5472 7565  evaluate_lc=True
+00024250: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
 00024260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024270: 2020 2020 2020 2020 2020 2065 7661 6c75             evalu
-00024280: 6174 655f 6c63 3d54 7275 6529 0a0a 2020  ate_lc=True)..  
+00024270: 2020 7365 6c66 2e69 6e61 6d65 7320 3d20    self.inames = 
+00024280: 6f72 6967 696e 616c 5f69 6e61 6d65 730a  original_inames.
 00024290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000242a0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000242b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000242c0: 2020 2020 2020 2020 2320 4173 2077 6974          # As wit
-000242d0: 6820 7468 6520 6c63 2063 6173 652c 2052  h the lc case, R
-000242e0: 5620 6d6f 6465 6c20 7365 742d 7570 2064  V model set-up d
-000242f0: 6570 656e 6473 206f 6e20 7768 6574 6865  epends on whethe
-00024300: 7220 7468 6520 6d6f 6465 6c20 6973 2067  r the model is g
-00024310: 6c6f 6261 6c20 6f72 206e 6f74 3a0a 2020  lobal or not:.  
-00024320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024330: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
-00024340: 203d 2074 0a20 2020 2020 2020 2020 2020   = t.           
-00024350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024360: 2069 6620 7365 6c66 2e67 6c6f 6261 6c5f   if self.global_
-00024370: 6d6f 6465 6c3a 0a20 2020 2020 2020 2020  model:.         
-00024380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024390: 2020 2020 2020 2023 2049 6620 676c 6f62         # If glob
-000243a0: 616c 2c20 696e 2074 6865 206d 6f64 656c  al, in the model
-000243b0: 2065 7661 6c75 6174 696f 6e20 7061 7274   evaluation part
-000243c0: 2028 6765 6e65 7261 7465 5f72 765f 6d6f   (generate_rv_mo
-000243d0: 6465 6c20 6675 6e63 7469 6f6e 292c 2074  del function), t
-000243e0: 6865 206d 6f64 656c 2066 6f72 2065 6163  he model for eac
-000243f0: 6820 696e 7374 7275 6d65 6e74 2069 7320  h instrument is 
-00024400: 6576 616c 7561 7465 6420 6174 0a20 2020  evaluated at.   
-00024410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024420: 2020 2020 2020 2020 2020 2020 2023 2063               # c
-00024430: 6572 7461 696e 2069 6e64 6578 6573 2073  ertain indexes s
-00024440: 656c 662e 696e 7374 7275 6d65 6e74 5f69  elf.instrument_i
-00024450: 6e64 6578 6573 5b69 6e73 7472 756d 656e  ndexes[instrumen
-00024460: 745d 2e20 5765 2068 6572 6520 6465 6369  t]. We here deci
-00024470: 6465 2074 6861 7420 6f6e 2065 6163 6820  de that on each 
-00024480: 696e 7374 7275 6d65 6e74 2077 6520 7769  instrument we wi
-00024490: 6c6c 2065 7661 6c75 6174 6520 7468 6520  ll evaluate the 
-000244a0: 6d6f 6465 6c0a 2020 2020 2020 2020 2020  model.          
+000242a0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000242b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000242c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000242d0: 2020 2320 4966 206e 6f74 2c20 7365 7420    # If not, set 
+000242e0: 7468 656d 206f 6e6c 7920 666f 7220 7468  them only for th
+000242f0: 6520 696e 7374 7275 6d65 6e74 206f 6620  e instrument of 
+00024300: 696e 7465 7265 7374 3a0a 0a20 2020 2020  interest:..     
+00024310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024320: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00024330: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
+00024340: 7374 7275 6d65 6e74 5d5b 2754 7261 6e73  strument]['Trans
+00024350: 6974 4669 7427 5d20 6f72 2073 656c 662e  itFit'] or self.
+00024360: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
+00024370: 756d 656e 745d 5b27 5472 616e 7369 7446  ument]['TransitF
+00024380: 6974 4361 7477 6f6d 616e 275d 206f 7220  itCatwoman'] or 
+00024390: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
+000243a0: 696e 7374 7275 6d65 6e74 5d5b 2745 636c  instrument]['Ecl
+000243b0: 6970 7365 4669 7427 5d20 6f72 2073 656c  ipseFit'] or sel
+000243c0: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
+000243d0: 7472 756d 656e 745d 5b27 5472 616e 4563  trument]['TranEc
+000243e0: 6c46 6974 275d 3a0a 2020 2020 2020 2020  lFit']:.        
+000243f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024400: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00024410: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
+00024420: 745d 5b27 7061 7261 6d73 275d 2c20 7365  t]['params'], se
+00024430: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
+00024440: 656e 745d 5b27 6d27 5d20 3d20 7375 7065  ent]['m'] = supe
+00024450: 7273 616d 706c 655f 7061 7261 6d73 2c73  rsample_params,s
+00024460: 7570 6572 7361 6d70 6c65 5f6d 0a0a 2020  upersample_m..  
+00024470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024480: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00024490: 2073 656c 662e 6c6d 5f62 6f6f 6c65 616e   self.lm_boolean
+000244a0: 5b69 6e73 7472 756d 656e 745d 3a0a 2020  [instrument]:.  
 000244b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000244c0: 2020 2020 2020 2320 6174 2061 6c6c 2074        # at all t
-000244d0: 6865 2069 6e70 7574 2074 696d 6573 2074  he input times t
-000244e0: 2028 7468 6973 2069 7320 7768 6174 2074   (this is what t
-000244f0: 6865 2064 756d 6d79 5f69 6e64 6578 2076  he dummy_index v
-00024500: 6172 6961 626c 6520 646f 6573 292c 2073  ariable does), s
-00024510: 6f20 7765 2066 696c 6c20 7570 2074 6869  o we fill up thi
-00024520: 7320 6469 6374 696f 6e61 7279 2077 6974  s dictionary wit
-00024530: 6820 7468 6174 2e0a 2020 2020 2020 2020  h that..        
-00024540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024550: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
-00024560: 656c 5b27 676c 6f62 616c 275d 203d 206e  el['global'] = n
-00024570: 702e 6f6e 6573 286c 656e 2874 2929 0a20  p.ones(len(t)). 
-00024580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024590: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000245a0: 6f72 2067 696e 7374 7275 6d65 6e74 2069  or ginstrument i
-000245b0: 6e20 696e 7374 7275 6d65 6e74 733a 0a20  n instruments:. 
-000245c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000245d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000245e0: 2020 2069 6620 7365 6c66 2e6c 6d5f 626f     if self.lm_bo
-000245f0: 6f6c 6561 6e5b 6769 6e73 7472 756d 656e  olean[ginstrumen
-00024600: 745d 3a0a 2020 2020 2020 2020 2020 2020  t]:.            
-00024610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024620: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00024630: 2e6c 6d5f 6172 6775 6d65 6e74 735b 0a20  .lm_arguments[. 
-00024640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024660: 2020 2020 2020 2020 2020 2067 696e 7374             ginst
-00024670: 7275 6d65 6e74 5d20 3d20 4c4d 7265 6772  rument] = LMregr
-00024680: 6573 736f 7273 5b0a 2020 2020 2020 2020  essors[.        
-00024690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000244c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000244d0: 2020 7365 6c66 2e6c 6d5f 6172 6775 6d65    self.lm_argume
+000244e0: 6e74 735b 696e 7374 7275 6d65 6e74 5d20  nts[instrument] 
+000244f0: 3d20 4c4d 7265 6772 6573 736f 7273 0a20  = LMregressors. 
+00024500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024510: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00024520: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
+00024530: 6d65 6e74 5d5b 276f 6e65 7327 5d20 3d20  ment]['ones'] = 
+00024540: 6e70 2e6f 6e65 7328 6e74 290a 2020 2020  np.ones(nt).    
+00024550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024560: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00024570: 2e6e 6461 7461 706f 696e 7473 5f70 6572  .ndatapoints_per
+00024580: 5f69 6e73 7472 756d 656e 745b 696e 7374  _instrument[inst
+00024590: 7275 6d65 6e74 5d20 3d20 6e74 0a20 2020  rument] = nt.   
+000245a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000245b0: 2020 2020 2020 2020 2020 2020 2023 2047               # G
+000245c0: 656e 6572 6174 6520 6c69 6768 7463 7572  enerate lightcur
+000245d0: 7665 206d 6f64 656c 3a0a 0a20 2020 2020  ve model:..     
+000245e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000245f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00024600: 6765 6e65 7261 7465 5f6c 635f 6d6f 6465  generate_lc_mode
+00024610: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+00024620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024630: 2020 2020 2020 2063 7572 7265 6e74 5f70         current_p
+00024640: 6172 616d 6574 6572 5f76 616c 7565 732c  arameter_values,
+00024650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024670: 2020 2020 2065 7661 6c75 6174 655f 676c       evaluate_gl
+00024680: 6f62 616c 5f65 7272 6f72 733d 4661 6c73  obal_errors=Fals
+00024690: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
 000246a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000246b0: 2020 2020 2020 2020 6769 6e73 7472 756d          ginstrum
-000246c0: 656e 745d 0a20 2020 2020 2020 2020 2020  ent].           
+000246b0: 2020 2020 2020 2065 7661 6c75 6174 655f         evaluate_
+000246c0: 6c63 3d54 7275 6529 0a0a 2020 2020 2020  lc=True)..      
 000246d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000246e0: 2020 2020 2020 2020 2073 656c 662e 7469           self.ti
-000246f0: 6d65 735b 6769 6e73 7472 756d 656e 745d  mes[ginstrument]
-00024700: 203d 2074 0a20 2020 2020 2020 2020 2020   = t.           
-00024710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024720: 2020 2020 2020 2020 2073 656c 662e 696e           self.in
-00024730: 7374 7275 6d65 6e74 5f69 6e64 6578 6573  strument_indexes
-00024740: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00024750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024760: 2020 2020 2020 2020 2020 6769 6e73 7472            ginstr
-00024770: 756d 656e 745d 203d 2064 756d 6d79 5f69  ument] = dummy_i
-00024780: 6e64 6578 6573 0a20 2020 2020 2020 2020  ndexes.         
-00024790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000247a0: 2020 2020 2020 2023 2047 656e 6572 6174         # Generat
-000247b0: 6520 5256 206d 6f64 656c 206f 6e6c 7920  e RV model only 
-000247c0: 666f 7220 7468 6520 696e 7374 7275 6d65  for the instrume
-000247d0: 6e74 2075 6e64 6572 2063 6f6e 7369 6465  nt under conside
-000247e0: 7261 7469 6f6e 3a0a 2020 2020 2020 2020  ration:.        
-000247f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024800: 2020 2020 2020 2020 6f72 6967 696e 616c          original
-00024810: 5f69 6e61 6d65 7320 3d20 6e70 2e63 6f70  _inames = np.cop
-00024820: 7928 7365 6c66 2e69 6e61 6d65 7329 0a20  y(self.inames). 
-00024830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024840: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00024850: 656c 662e 696e 616d 6573 203d 205b 696e  elf.inames = [in
-00024860: 7374 7275 6d65 6e74 5d0a 2020 2020 2020  strument].      
-00024870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024880: 2020 2020 2020 2020 2020 7365 6c66 2e67            self.g
-00024890: 656e 6572 6174 655f 7276 5f6d 6f64 656c  enerate_rv_model
-000248a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000248b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000248c0: 2020 2020 2020 6375 7272 656e 745f 7061        current_pa
-000248d0: 7261 6d65 7465 725f 7661 6c75 6573 2c0a  rameter_values,.
-000248e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000246e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000246f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024700: 2020 2020 2320 4173 2077 6974 6820 7468      # As with th
+00024710: 6520 6c63 2063 6173 652c 2052 5620 6d6f  e lc case, RV mo
+00024720: 6465 6c20 7365 742d 7570 2064 6570 656e  del set-up depen
+00024730: 6473 206f 6e20 7768 6574 6865 7220 7468  ds on whether th
+00024740: 6520 6d6f 6465 6c20 6973 2067 6c6f 6261  e model is globa
+00024750: 6c20 6f72 206e 6f74 3a0a 2020 2020 2020  l or not:.      
+00024760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024770: 2020 2020 2020 7365 6c66 2e74 203d 2074        self.t = t
+00024780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024790: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000247a0: 7365 6c66 2e67 6c6f 6261 6c5f 6d6f 6465  self.global_mode
+000247b0: 6c3a 0a20 2020 2020 2020 2020 2020 2020  l:.             
+000247c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000247d0: 2020 2023 2049 6620 676c 6f62 616c 2c20     # If global, 
+000247e0: 696e 2074 6865 206d 6f64 656c 2065 7661  in the model eva
+000247f0: 6c75 6174 696f 6e20 7061 7274 2028 6765  luation part (ge
+00024800: 6e65 7261 7465 5f72 765f 6d6f 6465 6c20  nerate_rv_model 
+00024810: 6675 6e63 7469 6f6e 292c 2074 6865 206d  function), the m
+00024820: 6f64 656c 2066 6f72 2065 6163 6820 696e  odel for each in
+00024830: 7374 7275 6d65 6e74 2069 7320 6576 616c  strument is eval
+00024840: 7561 7465 6420 6174 0a20 2020 2020 2020  uated at.       
+00024850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024860: 2020 2020 2020 2020 2023 2063 6572 7461           # certa
+00024870: 696e 2069 6e64 6578 6573 2073 656c 662e  in indexes self.
+00024880: 696e 7374 7275 6d65 6e74 5f69 6e64 6578  instrument_index
+00024890: 6573 5b69 6e73 7472 756d 656e 745d 2e20  es[instrument]. 
+000248a0: 5765 2068 6572 6520 6465 6369 6465 2074  We here decide t
+000248b0: 6861 7420 6f6e 2065 6163 6820 696e 7374  hat on each inst
+000248c0: 7275 6d65 6e74 2077 6520 7769 6c6c 2065  rument we will e
+000248d0: 7661 6c75 6174 6520 7468 6520 6d6f 6465  valuate the mode
+000248e0: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
 000248f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024900: 2020 2020 6576 616c 7561 7465 5f67 6c6f      evaluate_glo
-00024910: 6261 6c5f 6572 726f 7273 3d46 616c 7365  bal_errors=False
-00024920: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00024930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024940: 2020 7365 6c66 2e69 6e61 6d65 7320 3d20    self.inames = 
-00024950: 6f72 6967 696e 616c 5f69 6e61 6d65 730a  original_inames.
-00024960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024970: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00024980: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00024990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000249a0: 2020 7365 6c66 2e74 696d 6573 5b69 6e73    self.times[ins
-000249b0: 7472 756d 656e 745d 203d 2074 0a20 2020  trument] = t.   
+00024900: 2020 2320 6174 2061 6c6c 2074 6865 2069    # at all the i
+00024910: 6e70 7574 2074 696d 6573 2074 2028 7468  nput times t (th
+00024920: 6973 2069 7320 7768 6174 2074 6865 2064  is is what the d
+00024930: 756d 6d79 5f69 6e64 6578 2076 6172 6961  ummy_index varia
+00024940: 626c 6520 646f 6573 292c 2073 6f20 7765  ble does), so we
+00024950: 2066 696c 6c20 7570 2074 6869 7320 6469   fill up this di
+00024960: 6374 696f 6e61 7279 2077 6974 6820 7468  ctionary with th
+00024970: 6174 2e0a 2020 2020 2020 2020 2020 2020  at..            
+00024980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024990: 2020 2020 7365 6c66 2e6d 6f64 656c 5b27      self.model['
+000249a0: 676c 6f62 616c 275d 203d 206e 702e 6f6e  global'] = np.on
+000249b0: 6573 286c 656e 2874 2929 0a20 2020 2020  es(len(t)).     
 000249c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000249d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000249e0: 662e 696e 7374 7275 6d65 6e74 5f69 6e64  f.instrument_ind
-000249f0: 6578 6573 5b0a 2020 2020 2020 2020 2020  exes[.          
+000249d0: 2020 2020 2020 2020 2020 2066 6f72 2067             for g
+000249e0: 696e 7374 7275 6d65 6e74 2069 6e20 696e  instrument in in
+000249f0: 7374 7275 6d65 6e74 733a 0a20 2020 2020  struments:.     
 00024a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024a10: 2020 2020 2020 2020 2020 696e 7374 7275            instru
-00024a20: 6d65 6e74 5d20 3d20 6475 6d6d 795f 696e  ment] = dummy_in
-00024a30: 6465 7865 730a 2020 2020 2020 2020 2020  dexes.          
+00024a10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00024a20: 6620 7365 6c66 2e6c 6d5f 626f 6f6c 6561  f self.lm_boolea
+00024a30: 6e5b 6769 6e73 7472 756d 656e 745d 3a0a  n[ginstrument]:.
 00024a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024a50: 2020 2020 2020 6966 2073 656c 662e 6c6d        if self.lm
-00024a60: 5f62 6f6f 6c65 616e 5b69 6e73 7472 756d  _boolean[instrum
-00024a70: 656e 745d 3a0a 2020 2020 2020 2020 2020  ent]:.          
+00024a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024a60: 2020 2020 2020 2020 7365 6c66 2e6c 6d5f          self.lm_
+00024a70: 6172 6775 6d65 6e74 735b 0a20 2020 2020  arguments[.     
 00024a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024a90: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-00024aa0: 6d5f 6172 6775 6d65 6e74 735b 696e 7374  m_arguments[inst
-00024ab0: 7275 6d65 6e74 5d20 3d20 4c4d 7265 6772  rument] = LMregr
-00024ac0: 6573 736f 7273 0a20 2020 2020 2020 2020  essors.         
+00024a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024aa0: 2020 2020 2020 2067 696e 7374 7275 6d65         ginstrume
+00024ab0: 6e74 5d20 3d20 4c4d 7265 6772 6573 736f  nt] = LMregresso
+00024ac0: 7273 5b0a 2020 2020 2020 2020 2020 2020  rs[.            
 00024ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024ae0: 2020 2020 2020 2023 2047 656e 6572 6174         # Generat
-00024af0: 6520 5256 206d 6f64 656c 3a0a 2020 2020  e RV model:.    
-00024b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024b10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00024b20: 2e67 656e 6572 6174 655f 7276 5f6d 6f64  .generate_rv_mod
-00024b30: 656c 280a 2020 2020 2020 2020 2020 2020  el(.            
-00024b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024b50: 2020 2020 2020 2020 6375 7272 656e 745f          current_
-00024b60: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
-00024b70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00024ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024af0: 2020 2020 6769 6e73 7472 756d 656e 745d      ginstrument]
+00024b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024b20: 2020 2020 2073 656c 662e 7469 6d65 735b       self.times[
+00024b30: 6769 6e73 7472 756d 656e 745d 203d 2074  ginstrument] = t
+00024b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024b60: 2020 2020 2073 656c 662e 696e 7374 7275       self.instru
+00024b70: 6d65 6e74 5f69 6e64 6578 6573 5b0a 2020  ment_indexes[.  
 00024b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024b90: 2020 2020 2020 6576 616c 7561 7465 5f67        evaluate_g
-00024ba0: 6c6f 6261 6c5f 6572 726f 7273 3d46 616c  lobal_errors=Fal
-00024bb0: 7365 290a 0a20 2020 2020 2020 2020 2020  se)..           
-00024bc0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00024bd0: 2e67 6c6f 6261 6c5f 6d6f 6465 6c3a 0a20  .global_model:. 
-00024be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024bf0: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
-00024c00: 6963 7469 6f6e 6172 795b 2767 6c6f 6261  ictionary['globa
-00024c10: 6c5f 6d6f 6465 6c27 5d5b 2747 5044 6574  l_model']['GPDet
-00024c20: 7265 6e64 275d 3a0a 2020 2020 2020 2020  rend']:.        
+00024b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ba0: 2020 2020 2020 6769 6e73 7472 756d 656e        ginstrumen
+00024bb0: 745d 203d 2064 756d 6d79 5f69 6e64 6578  t] = dummy_index
+00024bc0: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
+00024bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024be0: 2020 2023 2047 656e 6572 6174 6520 5256     # Generate RV
+00024bf0: 206d 6f64 656c 206f 6e6c 7920 666f 7220   model only for 
+00024c00: 7468 6520 696e 7374 7275 6d65 6e74 2075  the instrument u
+00024c10: 6e64 6572 2063 6f6e 7369 6465 7261 7469  nder considerati
+00024c20: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
 00024c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024c40: 2020 2020 6f75 7470 7574 5f6d 6f64 656c      output_model
-00024c50: 4445 545f 7361 6d70 6c65 735b 636f 756e  DET_samples[coun
-00024c60: 7465 722c 3a5d 2c20 6f75 7470 7574 5f6d  ter,:], output_m
-00024c70: 6f64 656c 4750 5f73 616d 706c 6573 5b63  odelGP_samples[c
-00024c80: 6f75 6e74 6572 2c3a 5d2c 206f 7574 7075  ounter,:], outpu
-00024c90: 745f 6d6f 6465 6c5f 7361 6d70 6c65 735b  t_model_samples[
-00024ca0: 636f 756e 7465 722c 3a5d 203d 205c 0a20  counter,:] = \. 
+00024c40: 2020 2020 6f72 6967 696e 616c 5f69 6e61      original_ina
+00024c50: 6d65 7320 3d20 6e70 2e63 6f70 7928 7365  mes = np.copy(se
+00024c60: 6c66 2e69 6e61 6d65 7329 0a20 2020 2020  lf.inames).     
+00024c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024c80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00024c90: 696e 616d 6573 203d 205b 696e 7374 7275  inames = [instru
+00024ca0: 6d65 6e74 5d0a 2020 2020 2020 2020 2020  ment].          
 00024cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024cc0: 2020 2020 2020 7365 6c66 2e67 656e 6572        self.gener
+00024cd0: 6174 655f 7276 5f6d 6f64 656c 280a 2020  ate_rv_model(.  
 00024ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024cf0: 2020 2020 7365 6c66 2e67 6574 5f47 505f      self.get_GP_
-00024d00: 706c 7573 5f64 6574 6572 6d69 6e69 7374  plus_determinist
-00024d10: 6963 5f6d 6f64 656c 2863 7572 7265 6e74  ic_model(current
-00024d20: 5f70 6172 616d 6574 6572 5f76 616c 7565  _parameter_value
-00024d30: 732c 205c 0a20 2020 2020 2020 2020 2020  s, \.           
-00024d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024d00: 2020 6375 7272 656e 745f 7061 7261 6d65    current_parame
+00024d10: 7465 725f 7661 6c75 6573 2c0a 2020 2020  ter_values,.    
+00024d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024d40: 6576 616c 7561 7465 5f67 6c6f 6261 6c5f  evaluate_global_
+00024d50: 6572 726f 7273 3d46 616c 7365 290a 2020  errors=False).  
 00024d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024da0: 2020 696e 7374 7275 6d65 6e74 203d 2069    instrument = i
-00024db0: 6e73 7472 756d 656e 7429 0a20 2020 2020  nstrument).     
+00024d70: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00024d80: 6c66 2e69 6e61 6d65 7320 3d20 6f72 6967  lf.inames = orig
+00024d90: 696e 616c 5f69 6e61 6d65 730a 2020 2020  inal_inames.    
+00024da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024db0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
 00024dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024dd0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00024de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024df0: 2020 2020 206f 7574 7075 745f 6d6f 6465       output_mode
-00024e00: 6c5f 7361 6d70 6c65 735b 636f 756e 7465  l_samples[counte
-00024e10: 722c 3a5d 203d 2073 656c 662e 6765 745f  r,:] = self.get_
-00024e20: 4750 5f70 6c75 735f 6465 7465 726d 696e  GP_plus_determin
-00024e30: 6973 7469 635f 6d6f 6465 6c28 6375 7272  istic_model(curr
-00024e40: 656e 745f 7061 7261 6d65 7465 725f 7661  ent_parameter_va
-00024e50: 6c75 6573 2c20 5c0a 2020 2020 2020 2020  lues, \.        
-00024e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024dd0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00024de0: 6c66 2e74 696d 6573 5b69 6e73 7472 756d  lf.times[instrum
+00024df0: 656e 745d 203d 2074 0a20 2020 2020 2020  ent] = t.       
+00024e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024e10: 2020 2020 2020 2020 2073 656c 662e 696e           self.in
+00024e20: 7374 7275 6d65 6e74 5f69 6e64 6578 6573  strument_indexes
+00024e30: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00024e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024e50: 2020 2020 2020 696e 7374 7275 6d65 6e74        instrument
+00024e60: 5d20 3d20 6475 6d6d 795f 696e 6465 7865  ] = dummy_indexe
+00024e70: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
 00024e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024eb0: 2020 2020 2020 2020 2020 696e 7374 7275            instru
-00024ec0: 6d65 6e74 203d 2069 6e73 7472 756d 656e  ment = instrumen
-00024ed0: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
-00024ee0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00024ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024f00: 2020 2020 2069 6620 7365 6c66 2e64 6963       if self.dic
-00024f10: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
-00024f20: 6e74 5d5b 2747 5044 6574 7265 6e64 275d  nt]['GPDetrend']
-00024f30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00024f40: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
-00024f50: 7470 7574 5f6d 6f64 656c 4445 545f 7361  tput_modelDET_sa
-00024f60: 6d70 6c65 735b 636f 756e 7465 722c 3a5d  mples[counter,:]
-00024f70: 2c20 6f75 7470 7574 5f6d 6f64 656c 4750  , output_modelGP
-00024f80: 5f73 616d 706c 6573 5b63 6f75 6e74 6572  _samples[counter
-00024f90: 2c3a 5d2c 206f 7574 7075 745f 6d6f 6465  ,:], output_mode
-00024fa0: 6c5f 7361 6d70 6c65 735b 636f 756e 7465  l_samples[counte
-00024fb0: 722c 3a5d 203d 205c 0a20 2020 2020 2020  r,:] = \.       
+00024e90: 2020 6966 2073 656c 662e 6c6d 5f62 6f6f    if self.lm_boo
+00024ea0: 6c65 616e 5b69 6e73 7472 756d 656e 745d  lean[instrument]
+00024eb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00024ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ed0: 2020 2020 2020 7365 6c66 2e6c 6d5f 6172        self.lm_ar
+00024ee0: 6775 6d65 6e74 735b 696e 7374 7275 6d65  guments[instrume
+00024ef0: 6e74 5d20 3d20 4c4d 7265 6772 6573 736f  nt] = LMregresso
+00024f00: 7273 0a20 2020 2020 2020 2020 2020 2020  rs.             
+00024f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024f20: 2020 2023 2047 656e 6572 6174 6520 5256     # Generate RV
+00024f30: 206d 6f64 656c 3a0a 2020 2020 2020 2020   model:.        
+00024f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024f50: 2020 2020 2020 2020 7365 6c66 2e67 656e          self.gen
+00024f60: 6572 6174 655f 7276 5f6d 6f64 656c 280a  erate_rv_model(.
+00024f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024f90: 2020 2020 6375 7272 656e 745f 7061 7261      current_para
+00024fa0: 6d65 7465 725f 7661 6c75 6573 2c0a 2020  meter_values,.  
+00024fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00024fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024ff0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00025000: 6c66 2e67 6574 5f47 505f 706c 7573 5f64  lf.get_GP_plus_d
-00025010: 6574 6572 6d69 6e69 7374 6963 5f6d 6f64  eterministic_mod
-00025020: 656c 2863 7572 7265 6e74 5f70 6172 616d  el(current_param
-00025030: 6574 6572 5f76 616c 7565 732c 205c 0a20  eter_values, \. 
-00025040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024fd0: 2020 6576 616c 7561 7465 5f67 6c6f 6261    evaluate_globa
+00024fe0: 6c5f 6572 726f 7273 3d46 616c 7365 290a  l_errors=False).
+00024ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025000: 2020 2020 2069 6620 7365 6c66 2e67 6c6f       if self.glo
+00025010: 6261 6c5f 6d6f 6465 6c3a 0a20 2020 2020  bal_model:.     
+00025020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025030: 2020 2069 6620 7365 6c66 2e64 6963 7469     if self.dicti
+00025040: 6f6e 6172 795b 2767 6c6f 6261 6c5f 6d6f  onary['global_mo
+00025050: 6465 6c27 5d5b 2747 5044 6574 7265 6e64  del']['GPDetrend
+00025060: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
 00025070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000250a0: 2020 2020 2020 2020 2020 2020 696e 7374              inst
-000250b0: 7275 6d65 6e74 203d 2069 6e73 7472 756d  rument = instrum
-000250c0: 656e 7429 0a20 2020 2020 2020 2020 2020  ent).           
-000250d0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-000250e0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000250f0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00025100: 7574 7075 745f 6d6f 6465 6c5f 7361 6d70  utput_model_samp
-00025110: 6c65 735b 636f 756e 7465 722c 3a5d 203d  les[counter,:] =
-00025120: 2073 656c 662e 6765 745f 4750 5f70 6c75   self.get_GP_plu
-00025130: 735f 6465 7465 726d 696e 6973 7469 635f  s_deterministic_
-00025140: 6d6f 6465 6c28 6375 7272 656e 745f 7061  model(current_pa
-00025150: 7261 6d65 7465 725f 7661 6c75 6573 2c20  rameter_values, 
-00025160: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-00025170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025080: 6f75 7470 7574 5f6d 6f64 656c 4445 545f  output_modelDET_
+00025090: 7361 6d70 6c65 735b 636f 756e 7465 722c  samples[counter,
+000250a0: 3a5d 2c20 6f75 7470 7574 5f6d 6f64 656c  :], output_model
+000250b0: 4750 5f73 616d 706c 6573 5b63 6f75 6e74  GP_samples[count
+000250c0: 6572 2c3a 5d2c 206f 7574 7075 745f 6d6f  er,:], output_mo
+000250d0: 6465 6c5f 7361 6d70 6c65 735b 636f 756e  del_samples[coun
+000250e0: 7465 722c 3a5d 203d 205c 0a20 2020 2020  ter,:] = \.     
+000250f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025130: 7365 6c66 2e67 6574 5f47 505f 706c 7573  self.get_GP_plus
+00025140: 5f64 6574 6572 6d69 6e69 7374 6963 5f6d  _deterministic_m
+00025150: 6f64 656c 2863 7572 7265 6e74 5f70 6172  odel(current_par
+00025160: 616d 6574 6572 5f76 616c 7565 732c 205c  ameter_values, \
+00025170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00025180: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00025190: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000251a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000251b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000251c0: 2020 2020 696e 7374 7275 6d65 6e74 203d      instrument =
-000251d0: 2069 6e73 7472 756d 656e 7429 0a0a 2020   instrument)..  
-000251e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000251f0: 2020 2320 4e6f 772c 2069 6620 7573 6572    # Now, if user
-00025200: 2077 616e 7473 2063 6f6d 706f 6e65 6e74   wants component
-00025210: 2062 6163 6b2c 2061 6761 696e 2061 6c6c   back, again all
-00025220: 2064 6570 656e 6473 2069 6620 676c 6f62   depends if glob
-00025230: 616c 206d 6f64 656c 2069 7320 6f6e 206f  al model is on o
-00025240: 7220 6e6f 7420 6275 7420 6f6e 6c79 2066  r not but only f
-00025250: 6f72 2074 6865 206c 6967 6874 6375 7276  or the lightcurv
-00025260: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
-00025270: 2020 2020 2020 2023 2028 7768 6963 6820         # (which 
-00025280: 6465 7065 6e64 206f 6e20 6c69 6d62 2d64  depend on limb-d
-00025290: 6172 6b65 6e69 6e67 292e 2046 6f72 2074  arkening). For t
-000252a0: 6865 2052 5673 2069 7420 646f 6573 6e27  he RVs it doesn'
-000252b0: 7420 6d61 7474 6572 2065 7863 6570 7420  t matter except 
-000252c0: 666f 7220 276d 7527 2028 7468 6520 7379  for 'mu' (the sy
-000252d0: 7374 656d 6963 2076 656c 6f63 6974 7929  stemic velocity)
-000252e0: 2c20 7768 6963 680a 2020 2020 2020 2020  , which.        
-000252f0: 2020 2020 2020 2020 2020 2020 2320 666f              # fo
-00025300: 7220 676c 6f62 616c 206d 6f64 656c 7320  r global models 
-00025310: 6973 2061 6374 7561 6c6c 7920 6120 6469  is actually a di
-00025320: 6374 696f 6e61 7279 3a0a 2020 2020 2020  ctionary:.      
-00025330: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00025340: 2072 6574 7572 6e5f 636f 6d70 6f6e 656e   return_componen
-00025350: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-00025360: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00025370: 656c 662e 6d6f 6465 6c74 7970 6520 3d3d  elf.modeltype ==
-00025380: 2027 6c63 273a 0a20 2020 2020 2020 2020   'lc':.         
-00025390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000253a0: 2020 2069 6620 7365 6c66 2e67 6c6f 6261     if self.globa
-000253b0: 6c5f 6d6f 6465 6c3a 0a20 2020 2020 2020  l_model:.       
-000253c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000253d0: 2020 2020 2020 2020 2023 2049 6620 6974           # If it
-000253e0: 2069 732c 2074 6865 6e20 7468 6520 636f   is, then the co
-000253f0: 6d70 6f6e 656e 7473 5b27 7027 2b73 7472  mponents['p'+str
-00025400: 2869 295d 2064 6963 7469 6f6e 6172 7920  (i)] dictionary 
-00025410: 7769 6c6c 2068 6176 6520 746f 2062 6520  will have to be 
-00025420: 6120 6469 6374 696f 6e61 7279 206f 6e20  a dictionary on 
-00025430: 6974 7365 6c66 2c0a 2020 2020 2020 2020  itself,.        
-00025440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025450: 2020 2020 2020 2020 2320 7375 6368 2074          # such t
-00025460: 6861 7420 7765 2072 6574 7572 6e20 7468  hat we return th
-00025470: 6520 676c 6f62 616c 2074 7261 6e73 6974  e global transit
-00025480: 206d 6f64 656c 2066 6f72 2065 6163 6820   model for each 
-00025490: 6f66 2074 6865 2069 6e73 7472 756d 656e  of the instrumen
-000254a0: 7473 2e20 5361 6d65 2074 6869 6e67 2066  ts. Same thing f
-000254b0: 6f72 2074 6865 0a20 2020 2020 2020 2020  or the.         
+000251c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000251d0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+000251e0: 7374 7275 6d65 6e74 203d 2069 6e73 7472  strument = instr
+000251f0: 756d 656e 7429 0a20 2020 2020 2020 2020  ument).         
+00025200: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00025210: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00025220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025230: 206f 7574 7075 745f 6d6f 6465 6c5f 7361   output_model_sa
+00025240: 6d70 6c65 735b 636f 756e 7465 722c 3a5d  mples[counter,:]
+00025250: 203d 2073 656c 662e 6765 745f 4750 5f70   = self.get_GP_p
+00025260: 6c75 735f 6465 7465 726d 696e 6973 7469  lus_deterministi
+00025270: 635f 6d6f 6465 6c28 6375 7272 656e 745f  c_model(current_
+00025280: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+00025290: 2c20 5c0a 2020 2020 2020 2020 2020 2020  , \.            
+000252a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000252b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000252c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000252d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000252e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000252f0: 2020 2020 2020 696e 7374 7275 6d65 6e74        instrument
+00025300: 203d 2069 6e73 7472 756d 656e 7429 0a20   = instrument). 
+00025310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025320: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00025330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025340: 2069 6620 7365 6c66 2e64 6963 7469 6f6e   if self.diction
+00025350: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
+00025360: 2747 5044 6574 7265 6e64 275d 3a0a 2020  'GPDetrend']:.  
+00025370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025380: 2020 2020 2020 2020 2020 6f75 7470 7574            output
+00025390: 5f6d 6f64 656c 4445 545f 7361 6d70 6c65  _modelDET_sample
+000253a0: 735b 636f 756e 7465 722c 3a5d 2c20 6f75  s[counter,:], ou
+000253b0: 7470 7574 5f6d 6f64 656c 4750 5f73 616d  tput_modelGP_sam
+000253c0: 706c 6573 5b63 6f75 6e74 6572 2c3a 5d2c  ples[counter,:],
+000253d0: 206f 7574 7075 745f 6d6f 6465 6c5f 7361   output_model_sa
+000253e0: 6d70 6c65 735b 636f 756e 7465 722c 3a5d  mples[counter,:]
+000253f0: 203d 205c 0a20 2020 2020 2020 2020 2020   = \.           
+00025400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025430: 2020 2020 2020 2020 2020 7365 6c66 2e67            self.g
+00025440: 6574 5f47 505f 706c 7573 5f64 6574 6572  et_GP_plus_deter
+00025450: 6d69 6e69 7374 6963 5f6d 6f64 656c 2863  ministic_model(c
+00025460: 7572 7265 6e74 5f70 6172 616d 6574 6572  urrent_parameter
+00025470: 5f76 616c 7565 732c 205c 0a20 2020 2020  _values, \.     
+00025480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000254a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000254b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000254c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000254d0: 2020 2020 2020 2023 2063 6f6d 706f 6e65         # compone
-000254e0: 6e74 735b 2774 7261 6e73 6974 275d 2064  nts['transit'] d
-000254f0: 6963 7469 6f6e 6172 792e 0a20 2020 2020  ictionary..     
-00025500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025510: 2020 2020 2020 2020 2020 2066 6f72 2067             for g
-00025520: 696e 7374 7275 6d65 6e74 2069 6e20 696e  instrument in in
-00025530: 7374 7275 6d65 6e74 733a 0a20 2020 2020  struments:.     
-00025540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025550: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00025560: 7261 6e73 6974 203d 2030 2e0a 2020 2020  ransit = 0..    
-00025570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025590: 666f 7220 6920 696e 2073 656c 662e 6e75  for i in self.nu
-000255a0: 6d62 6572 696e 673a 0a20 2020 2020 2020  mbering:.       
+000254d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000254e0: 2020 2020 2020 2020 696e 7374 7275 6d65          instrume
+000254f0: 6e74 203d 2069 6e73 7472 756d 656e 7429  nt = instrument)
+00025500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025510: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00025520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025530: 2020 2020 2020 2020 2020 206f 7574 7075             outpu
+00025540: 745f 6d6f 6465 6c5f 7361 6d70 6c65 735b  t_model_samples[
+00025550: 636f 756e 7465 722c 3a5d 203d 2073 656c  counter,:] = sel
+00025560: 662e 6765 745f 4750 5f70 6c75 735f 6465  f.get_GP_plus_de
+00025570: 7465 726d 696e 6973 7469 635f 6d6f 6465  terministic_mode
+00025580: 6c28 6375 7272 656e 745f 7061 7261 6d65  l(current_parame
+00025590: 7465 725f 7661 6c75 6573 2c20 5c0a 2020  ter_values, \.  
+000255a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000255b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000255c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000255d0: 2063 6f6d 706f 6e65 6e74 735b 2770 2720   components['p' 
-000255e0: 2b20 7374 7228 6929 5d5b 6769 6e73 7472  + str(i)][ginstr
-000255f0: 756d 656e 745d 5b0a 2020 2020 2020 2020  ument][.        
-00025600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025620: 2020 2020 636f 756e 7465 722c 203a 5d20      counter, :] 
-00025630: 3d20 7365 6c66 2e6d 6f64 656c 5b0a 2020  = self.model[.  
-00025640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025660: 2020 2020 2020 2020 2020 2020 2020 6769                gi
-00025670: 6e73 7472 756d 656e 745d 5b27 7027 202b  nstrument]['p' +
-00025680: 2073 7472 2869 295d 0a20 2020 2020 2020   str(i)].       
-00025690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000255d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000255e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000255f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025600: 696e 7374 7275 6d65 6e74 203d 2069 6e73  instrument = ins
+00025610: 7472 756d 656e 7429 0a0a 2020 2020 2020  trument)..      
+00025620: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00025630: 4e6f 772c 2069 6620 7573 6572 2077 616e  Now, if user wan
+00025640: 7473 2063 6f6d 706f 6e65 6e74 2062 6163  ts component bac
+00025650: 6b2c 2061 6761 696e 2061 6c6c 2064 6570  k, again all dep
+00025660: 656e 6473 2069 6620 676c 6f62 616c 206d  ends if global m
+00025670: 6f64 656c 2069 7320 6f6e 206f 7220 6e6f  odel is on or no
+00025680: 7420 6275 7420 6f6e 6c79 2066 6f72 2074  t but only for t
+00025690: 6865 206c 6967 6874 6375 7276 6573 0a20  he lightcurves. 
 000256a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000256b0: 2074 7261 6e73 6974 202b 3d20 2863 6f6d   transit += (com
-000256c0: 706f 6e65 6e74 735b 2770 2720 2b20 7374  ponents['p' + st
-000256d0: 7228 6929 5d0a 2020 2020 2020 2020 2020  r(i)].          
-000256e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000256f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025700: 2020 2020 2020 2020 2020 5b67 696e 7374            [ginst
-00025710: 7275 6d65 6e74 5d5b 636f 756e 7465 722c  rument][counter,
-00025720: 203a 5d20 2d0a 2020 2020 2020 2020 2020   :] -.          
-00025730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025750: 2020 2020 2020 2020 2020 312e 290a 2020            1.).  
-00025760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025780: 2020 636f 6d70 6f6e 656e 7473 5b27 7472    components['tr
-00025790: 616e 7369 7427 5d5b 6769 6e73 7472 756d  ansit'][ginstrum
-000257a0: 656e 745d 5b0a 2020 2020 2020 2020 2020  ent][.          
-000257b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000257c0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-000257d0: 756e 7465 722c 203a 5d20 3d20 312e 202b  unter, :] = 1. +
-000257e0: 2074 7261 6e73 6974 0a20 2020 2020 2020   transit.       
-000257f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025800: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00025810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025820: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
-00025830: 6974 203d 2030 2e0a 2020 2020 2020 2020  it = 0..        
-00025840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025850: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00025860: 2073 656c 662e 6e75 6d62 6572 696e 673a   self.numbering:
-00025870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000256b0: 2020 2023 2028 7768 6963 6820 6465 7065     # (which depe
+000256c0: 6e64 206f 6e20 6c69 6d62 2d64 6172 6b65  nd on limb-darke
+000256d0: 6e69 6e67 292e 2046 6f72 2074 6865 2052  ning). For the R
+000256e0: 5673 2069 7420 646f 6573 6e27 7420 6d61  Vs it doesn't ma
+000256f0: 7474 6572 2065 7863 6570 7420 666f 7220  tter except for 
+00025700: 276d 7527 2028 7468 6520 7379 7374 656d  'mu' (the system
+00025710: 6963 2076 656c 6f63 6974 7929 2c20 7768  ic velocity), wh
+00025720: 6963 680a 2020 2020 2020 2020 2020 2020  ich.            
+00025730: 2020 2020 2020 2020 2320 666f 7220 676c          # for gl
+00025740: 6f62 616c 206d 6f64 656c 7320 6973 2061  obal models is a
+00025750: 6374 7561 6c6c 7920 6120 6469 6374 696f  ctually a dictio
+00025760: 6e61 7279 3a0a 2020 2020 2020 2020 2020  nary:.          
+00025770: 2020 2020 2020 2020 2020 6966 2072 6574            if ret
+00025780: 7572 6e5f 636f 6d70 6f6e 656e 7473 3a0a  urn_components:.
+00025790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000257a0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000257b0: 6d6f 6465 6c74 7970 6520 3d3d 2027 6c63  modeltype == 'lc
+000257c0: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
+000257d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000257e0: 6620 7365 6c66 2e67 6c6f 6261 6c5f 6d6f  f self.global_mo
+000257f0: 6465 6c3a 0a20 2020 2020 2020 2020 2020  del:.           
+00025800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025810: 2020 2020 2023 2049 6620 6974 2069 732c       # If it is,
+00025820: 2074 6865 6e20 7468 6520 636f 6d70 6f6e   then the compon
+00025830: 656e 7473 5b27 7027 2b73 7472 2869 295d  ents['p'+str(i)]
+00025840: 2064 6963 7469 6f6e 6172 7920 7769 6c6c   dictionary will
+00025850: 2068 6176 6520 746f 2062 6520 6120 6469   have to be a di
+00025860: 6374 696f 6e61 7279 206f 6e20 6974 7365  ctionary on itse
+00025870: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
 00025880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025890: 2020 2020 2063 6f6d 706f 6e65 6e74 735b       components[
-000258a0: 2770 2720 2b20 7374 7228 6929 5d5b 0a20  'p' + str(i)][. 
-000258b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000258c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000258d0: 2020 2020 2020 2063 6f75 6e74 6572 2c20         counter, 
-000258e0: 3a5d 203d 2073 656c 662e 6d6f 6465 6c5b  :] = self.model[
-000258f0: 696e 7374 7275 6d65 6e74 5d5b 0a20 2020  instrument][.   
+00025890: 2020 2020 2320 7375 6368 2074 6861 7420      # such that 
+000258a0: 7765 2072 6574 7572 6e20 7468 6520 676c  we return the gl
+000258b0: 6f62 616c 2074 7261 6e73 6974 206d 6f64  obal transit mod
+000258c0: 656c 2066 6f72 2065 6163 6820 6f66 2074  el for each of t
+000258d0: 6865 2069 6e73 7472 756d 656e 7473 2e20  he instruments. 
+000258e0: 5361 6d65 2074 6869 6e67 2066 6f72 2074  Same thing for t
+000258f0: 6865 0a20 2020 2020 2020 2020 2020 2020  he.             
 00025900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025920: 2020 2020 2020 2020 2027 7027 202b 2073           'p' + s
-00025930: 7472 2869 295d 0a20 2020 2020 2020 2020  tr(i)].         
+00025910: 2020 2023 2063 6f6d 706f 6e65 6e74 735b     # components[
+00025920: 2774 7261 6e73 6974 275d 2064 6963 7469  'transit'] dicti
+00025930: 6f6e 6172 792e 0a20 2020 2020 2020 2020  onary..         
 00025940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025950: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
-00025960: 6974 202b 3d20 280a 2020 2020 2020 2020  it += (.        
-00025970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025950: 2020 2020 2020 2066 6f72 2067 696e 7374         for ginst
+00025960: 7275 6d65 6e74 2069 6e20 696e 7374 7275  rument in instru
+00025970: 6d65 6e74 733a 0a20 2020 2020 2020 2020  ments:.         
 00025980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025990: 636f 6d70 6f6e 656e 7473 5b27 7027 202b  components['p' +
-000259a0: 2073 7472 2869 295d 5b63 6f75 6e74 6572   str(i)][counter
-000259b0: 2c20 3a5d 202d 0a20 2020 2020 2020 2020  , :] -.         
-000259c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000259d0: 2020 2020 2020 2020 2020 2020 2020 2031                 1
-000259e0: 2e29 0a20 2020 2020 2020 2020 2020 2020  .).             
+00025990: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
+000259a0: 6974 203d 2030 2e0a 2020 2020 2020 2020  it = 0..        
+000259b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000259c0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000259d0: 6920 696e 2073 656c 662e 6e75 6d62 6572  i in self.number
+000259e0: 696e 673a 0a20 2020 2020 2020 2020 2020  ing:.           
 000259f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025a00: 2020 2063 6f6d 706f 6e65 6e74 735b 2774     components['t
-00025a10: 7261 6e73 6974 275d 5b63 6f75 6e74 6572  ransit'][counter
-00025a20: 2c20 3a5d 203d 2031 2e20 2b20 7472 616e  , :] = 1. + tran
-00025a30: 7369 740a 2020 2020 2020 2020 2020 2020  sit.            
-00025a40: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00025a50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00025a60: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-00025a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025a80: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-00025a90: 6e20 7365 6c66 2e6e 756d 6265 7269 6e67  n self.numbering
-00025aa0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-00025ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025ac0: 2020 2063 6f6d 706f 6e65 6e74 735b 2770     components['p
-00025ad0: 272b 7374 7228 6929 5d5b 636f 756e 7465  '+str(i)][counte
-00025ae0: 722c 3a5d 203d 2073 656c 662e 6d6f 6465  r,:] = self.mode
-00025af0: 6c5b 2770 272b 7374 7228 6929 5d0a 2020  l['p'+str(i)].  
-00025b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025b10: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
+00025a00: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
+00025a10: 706f 6e65 6e74 735b 2770 2720 2b20 7374  ponents['p' + st
+00025a20: 7228 6929 5d5b 6769 6e73 7472 756d 656e  r(i)][ginstrumen
+00025a30: 745d 5b0a 2020 2020 2020 2020 2020 2020  t][.            
+00025a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025a60: 636f 756e 7465 722c 203a 5d20 3d20 7365  counter, :] = se
+00025a70: 6c66 2e6d 6f64 656c 5b0a 2020 2020 2020  lf.model[.      
+00025a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025aa0: 2020 2020 2020 2020 2020 6769 6e73 7472            ginstr
+00025ab0: 756d 656e 745d 5b27 7027 202b 2073 7472  ument]['p' + str
+00025ac0: 2869 295d 0a20 2020 2020 2020 2020 2020  (i)].           
+00025ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025ae0: 2020 2020 2020 2020 2020 2020 2074 7261               tra
+00025af0: 6e73 6974 202b 3d20 2863 6f6d 706f 6e65  nsit += (compone
+00025b00: 6e74 735b 2770 2720 2b20 7374 7228 6929  nts['p' + str(i)
+00025b10: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
 00025b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025b30: 2020 2020 2020 2020 2020 2063 6f6d 706f             compo
-00025b40: 6e65 6e74 735b 2774 7265 6e64 275d 5b63  nents['trend'][c
-00025b50: 6f75 6e74 6572 2c3a 5d20 3d20 7365 6c66  ounter,:] = self
-00025b60: 2e6d 6f64 656c 5b27 4b65 706c 6572 6961  .model['Kepleria
-00025b70: 6e2b 5472 656e 6427 5d20 2d20 7365 6c66  n+Trend'] - self
-00025b80: 2e6d 6f64 656c 5b27 4b65 706c 6572 6961  .model['Kepleria
-00025b90: 6e27 5d0a 2020 2020 2020 2020 2020 2020  n'].            
+00025b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025b40: 2020 2020 2020 5b67 696e 7374 7275 6d65        [ginstrume
+00025b50: 6e74 5d5b 636f 756e 7465 722c 203a 5d20  nt][counter, :] 
+00025b60: 2d0a 2020 2020 2020 2020 2020 2020 2020  -.              
+00025b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025b90: 2020 2020 2020 312e 290a 2020 2020 2020        1.).      
 00025ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025bb0: 636f 6d70 6f6e 656e 7473 5b27 6b65 706c  components['kepl
-00025bc0: 6572 6961 6e27 5d5b 636f 756e 7465 722c  erian'][counter,
-00025bd0: 3a5d 203d 2073 656c 662e 6d6f 6465 6c5b  :] = self.model[
-00025be0: 274b 6570 6c65 7269 616e 275d 0a0a 2020  'Keplerian']..  
+00025bb0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00025bc0: 6d70 6f6e 656e 7473 5b27 7472 616e 7369  mponents['transi
+00025bd0: 7427 5d5b 6769 6e73 7472 756d 656e 745d  t'][ginstrument]
+00025be0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
 00025bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025c00: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00025c10: 662e 676c 6f62 616c 5f6d 6f64 656c 3a0a  f.global_model:.
-00025c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025c00: 2020 2020 2020 2020 2020 636f 756e 7465            counte
+00025c10: 722c 203a 5d20 3d20 312e 202b 2074 7261  r, :] = 1. + tra
+00025c20: 6e73 6974 0a20 2020 2020 2020 2020 2020  nsit.           
 00025c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025c40: 666f 7220 6769 6e73 7472 756d 656e 7420  for ginstrument 
-00025c50: 696e 2069 6e73 7472 756d 656e 7473 3a0a  in instruments:.
-00025c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025c80: 2020 2020 636f 6d70 6f6e 656e 7473 5b27      components['
-00025c90: 6d75 275d 5b67 696e 7374 7275 6d65 6e74  mu'][ginstrument
-00025ca0: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
+00025c40: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00025c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025c60: 2020 2020 2020 2074 7261 6e73 6974 203d         transit =
+00025c70: 2030 2e0a 2020 2020 2020 2020 2020 2020   0..            
+00025c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025c90: 2020 2020 666f 7220 6920 696e 2073 656c      for i in sel
+00025ca0: 662e 6e75 6d62 6572 696e 673a 0a20 2020  f.numbering:.   
 00025cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025cc0: 2020 2020 2020 2020 2020 2063 6f75 6e74             count
-00025cd0: 6572 5d20 3d20 6375 7272 656e 745f 7061  er] = current_pa
-00025ce0: 7261 6d65 7465 725f 7661 6c75 6573 5b0a  rameter_values[.
+00025cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025cd0: 2063 6f6d 706f 6e65 6e74 735b 2770 2720   components['p' 
+00025ce0: 2b20 7374 7228 6929 5d5b 0a20 2020 2020  + str(i)][.     
 00025cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00025d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025d10: 2020 2020 2020 2020 2020 2020 276d 755f              'mu_
-00025d20: 2720 2b20 6769 6e73 7472 756d 656e 745d  ' + ginstrument]
-00025d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025d40: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00025d50: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00025d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025d70: 2020 2063 6f6d 706f 6e65 6e74 735b 276d     components['m
-00025d80: 7527 5d5b 0a20 2020 2020 2020 2020 2020  u'][.           
-00025d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025da0: 2020 2020 2020 2020 2063 6f75 6e74 6572           counter
-00025db0: 5d20 3d20 6375 7272 656e 745f 7061 7261  ] = current_para
-00025dc0: 6d65 7465 725f 7661 6c75 6573 5b0a 2020  meter_values[.  
-00025dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025df0: 2020 2020 2020 276d 755f 2720 2b20 696e        'mu_' + in
-00025e00: 7374 7275 6d65 6e74 5d0a 2020 2020 2020  strument].      
-00025e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025e20: 2020 6966 2073 656c 662e 676c 6f62 616c    if self.global
-00025e30: 5f6d 6f64 656c 3a0a 2020 2020 2020 2020  _model:.        
-00025e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025e50: 2020 2020 666f 7220 6769 6e73 7472 756d      for ginstrum
-00025e60: 656e 7420 696e 2069 6e73 7472 756d 656e  ent in instrumen
-00025e70: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-00025e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025e90: 2020 2020 6966 2073 656c 662e 6c6d 5f62      if self.lm_b
-00025ea0: 6f6f 6c65 616e 5b67 696e 7374 7275 6d65  oolean[ginstrume
-00025eb0: 6e74 5d3a 0a20 2020 2020 2020 2020 2020  nt]:.           
-00025ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025ed0: 2020 2020 2020 2020 2063 6f6d 706f 6e65           compone
-00025ee0: 6e74 735b 276c 6d27 5d5b 6769 6e73 7472  nts['lm'][ginstr
-00025ef0: 756d 656e 745d 5b0a 2020 2020 2020 2020  ument][.        
-00025f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025f20: 636f 756e 7465 722c 203a 5d20 3d20 7365  counter, :] = se
-00025f30: 6c66 2e6d 6f64 656c 5b67 696e 7374 7275  lf.model[ginstru
-00025f40: 6d65 6e74 5d5b 0a20 2020 2020 2020 2020  ment][.         
-00025f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025d10: 2020 2063 6f75 6e74 6572 2c20 3a5d 203d     counter, :] =
+00025d20: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
+00025d30: 7275 6d65 6e74 5d5b 0a20 2020 2020 2020  rument][.       
+00025d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025d60: 2020 2020 2027 7027 202b 2073 7472 2869       'p' + str(i
+00025d70: 295d 0a20 2020 2020 2020 2020 2020 2020  )].             
+00025d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025d90: 2020 2020 2020 2074 7261 6e73 6974 202b         transit +
+00025da0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00025db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025dc0: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+00025dd0: 6f6e 656e 7473 5b27 7027 202b 2073 7472  onents['p' + str
+00025de0: 2869 295d 5b63 6f75 6e74 6572 2c20 3a5d  (i)][counter, :]
+00025df0: 202d 0a20 2020 2020 2020 2020 2020 2020   -.             
+00025e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025e10: 2020 2020 2020 2020 2020 2031 2e29 0a20             1.). 
+00025e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025e30: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00025e40: 6f6d 706f 6e65 6e74 735b 2774 7261 6e73  omponents['trans
+00025e50: 6974 275d 5b63 6f75 6e74 6572 2c20 3a5d  it'][counter, :]
+00025e60: 203d 2031 2e20 2b20 7472 616e 7369 740a   = 1. + transit.
+00025e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025e80: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00025e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025ea0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00025eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025ec0: 2020 2020 2066 6f72 2069 2069 6e20 7365       for i in se
+00025ed0: 6c66 2e6e 756d 6265 7269 6e67 3a0a 0a20  lf.numbering:.. 
+00025ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025ef0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00025f00: 6f6d 706f 6e65 6e74 735b 2770 272b 7374  omponents['p'+st
+00025f10: 7228 6929 5d5b 636f 756e 7465 722c 3a5d  r(i)][counter,:]
+00025f20: 203d 2073 656c 662e 6d6f 6465 6c5b 2770   = self.model['p
+00025f30: 272b 7374 7228 6929 5d0a 2020 2020 2020  '+str(i)].      
+00025f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025f50: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
 00025f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025f70: 2020 2027 4c4d 275d 0a20 2020 2020 2020     'LM'].       
-00025f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025f90: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00025fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025fb0: 2020 2069 6620 7365 6c66 2e6c 6d5f 626f     if self.lm_bo
-00025fc0: 6f6c 6561 6e5b 696e 7374 7275 6d65 6e74  olean[instrument
-00025fd0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-00025fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025ff0: 2020 2063 6f6d 706f 6e65 6e74 735b 276c     components['l
-00026000: 6d27 5d5b 0a20 2020 2020 2020 2020 2020  m'][.           
-00026010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026020: 2020 2020 2020 2020 2063 6f75 6e74 6572           counter
-00026030: 2c20 3a5d 203d 2073 656c 662e 6d6f 6465  , :] = self.mode
-00026040: 6c5b 696e 7374 7275 6d65 6e74 5d5b 274c  l[instrument]['L
-00026050: 4d27 5d0a 0a20 2020 2020 2020 2020 2020  M']..           
-00026060: 2020 2020 2020 2020 2023 2052 6f6c 6c62           # Rollb
-00026070: 6163 6b20 696e 2063 6173 6520 7420 6973  ack in case t is
-00026080: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00026090: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000260a0: 6620 7420 6973 206e 6f74 204e 6f6e 653a  f t is not None:
-000260b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000260c0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-000260d0: 2e67 6c6f 6261 6c5f 6d6f 6465 6c3a 0a20  .global_model:. 
+00025f70: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
+00025f80: 735b 2774 7265 6e64 275d 5b63 6f75 6e74  s['trend'][count
+00025f90: 6572 2c3a 5d20 3d20 7365 6c66 2e6d 6f64  er,:] = self.mod
+00025fa0: 656c 5b27 4b65 706c 6572 6961 6e2b 5472  el['Keplerian+Tr
+00025fb0: 656e 6427 5d20 2d20 7365 6c66 2e6d 6f64  end'] - self.mod
+00025fc0: 656c 5b27 4b65 706c 6572 6961 6e27 5d0a  el['Keplerian'].
+00025fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025fe0: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+00025ff0: 6f6e 656e 7473 5b27 6b65 706c 6572 6961  onents['kepleria
+00026000: 6e27 5d5b 636f 756e 7465 722c 3a5d 203d  n'][counter,:] =
+00026010: 2073 656c 662e 6d6f 6465 6c5b 274b 6570   self.model['Kep
+00026020: 6c65 7269 616e 275d 0a0a 2020 2020 2020  lerian']..      
+00026030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026040: 2020 2020 2020 6966 2073 656c 662e 676c        if self.gl
+00026050: 6f62 616c 5f6d 6f64 656c 3a0a 2020 2020  obal_model:.    
+00026060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026070: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00026080: 6769 6e73 7472 756d 656e 7420 696e 2069  ginstrument in i
+00026090: 6e73 7472 756d 656e 7473 3a0a 2020 2020  nstruments:.    
+000260a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000260b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000260c0: 636f 6d70 6f6e 656e 7473 5b27 6d75 275d  components['mu']
+000260d0: 5b67 696e 7374 7275 6d65 6e74 5d5b 0a20  [ginstrument][. 
 000260e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000260f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00026100: 696e 7374 7275 6d65 6e74 5f69 6e64 6578  instrument_index
-00026110: 6573 203d 206f 7269 6769 6e61 6c5f 696e  es = original_in
-00026120: 7374 7275 6d65 6e74 5f69 6e64 6578 6573  strument_indexes
-00026130: 2e63 6f70 7928 0a20 2020 2020 2020 2020  .copy(.         
+000260f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026100: 2020 2020 2020 2063 6f75 6e74 6572 5d20         counter] 
+00026110: 3d20 6375 7272 656e 745f 7061 7261 6d65  = current_parame
+00026120: 7465 725f 7661 6c75 6573 5b0a 2020 2020  ter_values[.    
+00026130: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00026140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026150: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00026160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026170: 2066 6f72 2067 696e 7374 7275 6d65 6e74   for ginstrument
-00026180: 2069 6e20 696e 7374 7275 6d65 6e74 733a   in instruments:
-00026190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000261a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000261b0: 2073 656c 662e 7469 6d65 735b 0a20 2020   self.times[.   
-000261c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026150: 2020 2020 2020 2020 276d 755f 2720 2b20          'mu_' + 
+00026160: 6769 6e73 7472 756d 656e 745d 0a20 2020  ginstrument].   
+00026170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026180: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00026190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000261a0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000261b0: 6f6d 706f 6e65 6e74 735b 276d 7527 5d5b  omponents['mu'][
+000261c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000261d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000261e0: 2067 696e 7374 7275 6d65 6e74 5d20 3d20   ginstrument] = 
-000261f0: 6f72 6967 696e 616c 5f69 6e73 7472 756d  original_instrum
-00026200: 656e 745f 7469 6d65 735b 0a20 2020 2020  ent_times[.     
+000261e0: 2020 2020 2063 6f75 6e74 6572 5d20 3d20       counter] = 
+000261f0: 6375 7272 656e 745f 7061 7261 6d65 7465  current_paramete
+00026200: 725f 7661 6c75 6573 5b0a 2020 2020 2020  r_values[.      
 00026210: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00026220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026230: 2020 2067 696e 7374 7275 6d65 6e74 5d0a     ginstrument].
-00026240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026260: 6966 2073 656c 662e 6d6f 6465 6c74 7970  if self.modeltyp
-00026270: 6520 3d3d 2027 6c63 273a 0a0a 2020 2020  e == 'lc':..    
+00026230: 2020 276d 755f 2720 2b20 696e 7374 7275    'mu_' + instru
+00026240: 6d65 6e74 5d0a 2020 2020 2020 2020 2020  ment].          
+00026250: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00026260: 2073 656c 662e 676c 6f62 616c 5f6d 6f64   self.global_mod
+00026270: 656c 3a0a 2020 2020 2020 2020 2020 2020  el:.            
 00026280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000262a0: 6966 2073 656c 662e 6469 6374 696f 6e61  if self.dictiona
-000262b0: 7279 5b67 696e 7374 7275 6d65 6e74 5d5b  ry[ginstrument][
-000262c0: 2754 7261 6e73 6974 4669 7427 5d20 6f72  'TransitFit'] or
-000262d0: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-000262e0: 5b67 696e 7374 7275 6d65 6e74 5d5b 2754  [ginstrument]['T
-000262f0: 7261 6e73 6974 4669 7443 6174 776f 6d61  ransitFitCatwoma
-00026300: 6e27 5d20 6f72 2073 656c 662e 6469 6374  n'] or self.dict
-00026310: 696f 6e61 7279 5b67 696e 7374 7275 6d65  ionary[ginstrume
-00026320: 6e74 5d5b 2745 636c 6970 7365 4669 7427  nt]['EclipseFit'
-00026330: 5d20 6f72 2073 656c 662e 6469 6374 696f  ] or self.dictio
-00026340: 6e61 7279 5b67 696e 7374 7275 6d65 6e74  nary[ginstrument
-00026350: 5d5b 2754 7261 6e45 636c 4669 7427 5d3a  ]['TranEclFit']:
-00026360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026380: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-00026390: 6465 6c5b 6769 6e73 7472 756d 656e 745d  del[ginstrument]
-000263a0: 5b27 7061 7261 6d73 275d 2c20 7365 6c66  ['params'], self
-000263b0: 2e6d 6f64 656c 5b67 696e 7374 7275 6d65  .model[ginstrume
-000263c0: 6e74 5d5b 276d 275d 203d 2073 616d 706c  nt]['m'] = sampl
-000263d0: 655f 7061 7261 6d73 5b67 696e 7374 7275  e_params[ginstru
-000263e0: 6d65 6e74 5d2c 7361 6d70 6c65 5f6d 5b67  ment],sample_m[g
-000263f0: 696e 7374 7275 6d65 6e74 5d0a 0a20 2020  instrument]..   
-00026400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026290: 666f 7220 6769 6e73 7472 756d 656e 7420  for ginstrument 
+000262a0: 696e 2069 6e73 7472 756d 656e 7473 3a0a  in instruments:.
+000262b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000262c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000262d0: 6966 2073 656c 662e 6c6d 5f62 6f6f 6c65  if self.lm_boole
+000262e0: 616e 5b67 696e 7374 7275 6d65 6e74 5d3a  an[ginstrument]:
+000262f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026310: 2020 2020 2063 6f6d 706f 6e65 6e74 735b       components[
+00026320: 276c 6d27 5d5b 6769 6e73 7472 756d 656e  'lm'][ginstrumen
+00026330: 745d 5b0a 2020 2020 2020 2020 2020 2020  t][.            
+00026340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026350: 2020 2020 2020 2020 2020 2020 636f 756e              coun
+00026360: 7465 722c 203a 5d20 3d20 7365 6c66 2e6d  ter, :] = self.m
+00026370: 6f64 656c 5b67 696e 7374 7275 6d65 6e74  odel[ginstrument
+00026380: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
+00026390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000263a0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000263b0: 4c4d 275d 0a20 2020 2020 2020 2020 2020  LM'].           
+000263c0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+000263d0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000263e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000263f0: 6620 7365 6c66 2e6c 6d5f 626f 6f6c 6561  f self.lm_boolea
+00026400: 6e5b 696e 7374 7275 6d65 6e74 5d3a 0a20  n[instrument]:. 
 00026410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026420: 2069 6620 7365 6c66 2e6c 6d5f 626f 6f6c   if self.lm_bool
-00026430: 6561 6e5b 6769 6e73 7472 756d 656e 745d  ean[ginstrument]
-00026440: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00026420: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00026430: 6f6d 706f 6e65 6e74 735b 276c 6d27 5d5b  omponents['lm'][
+00026440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00026450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026460: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-00026470: 6d5f 6172 6775 6d65 6e74 735b 0a20 2020  m_arguments[.   
-00026480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000264a0: 2020 2020 2020 2020 2067 696e 7374 7275           ginstru
-000264b0: 6d65 6e74 5d20 3d20 6f72 6967 696e 616c  ment] = original
-000264c0: 5f6c 6d5f 6172 6775 6d65 6e74 735b 0a20  _lm_arguments[. 
-000264d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000264e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000264f0: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-00026500: 696e 7374 7275 6d65 6e74 5d0a 2020 2020  instrument].    
-00026510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026460: 2020 2020 2063 6f75 6e74 6572 2c20 3a5d       counter, :]
+00026470: 203d 2073 656c 662e 6d6f 6465 6c5b 696e   = self.model[in
+00026480: 7374 7275 6d65 6e74 5d5b 274c 4d27 5d0a  strument]['LM'].
+00026490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000264a0: 2020 2020 2023 2052 6f6c 6c62 6163 6b20       # Rollback 
+000264b0: 696e 2063 6173 6520 7420 6973 206e 6f74  in case t is not
+000264c0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000264d0: 2020 2020 2020 2020 2020 2069 6620 7420             if t 
+000264e0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+000264f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026500: 2020 2020 2069 6620 7365 6c66 2e67 6c6f       if self.glo
+00026510: 6261 6c5f 6d6f 6465 6c3a 0a20 2020 2020  bal_model:.     
 00026520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026530: 7365 6c66 2e6d 6f64 656c 5b67 696e 7374  self.model[ginst
-00026540: 7275 6d65 6e74 5d5b 276f 6e65 7327 5d20  rument]['ones'] 
-00026550: 3d20 6e70 2e6f 6e65 7328 0a20 2020 2020  = np.ones(.     
-00026560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026580: 2020 206e 745f 6f72 6967 696e 616c 5b67     nt_original[g
-00026590: 696e 7374 7275 6d65 6e74 5d29 0a20 2020  instrument]).   
-000265a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000265b0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-000265c0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00026530: 2020 2020 2020 2073 656c 662e 696e 7374         self.inst
+00026540: 7275 6d65 6e74 5f69 6e64 6578 6573 203d  rument_indexes =
+00026550: 206f 7269 6769 6e61 6c5f 696e 7374 7275   original_instru
+00026560: 6d65 6e74 5f69 6e64 6578 6573 2e63 6f70  ment_indexes.cop
+00026570: 7928 0a20 2020 2020 2020 2020 2020 2020  y(.             
+00026580: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00026590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000265a0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+000265b0: 2067 696e 7374 7275 6d65 6e74 2069 6e20   ginstrument in 
+000265c0: 696e 7374 7275 6d65 6e74 733a 0a20 2020  instruments:.   
 000265d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000265e0: 2020 2020 2020 2073 656c 662e 7420 3d20         self.t = 
-000265f0: 6f72 6967 696e 616c 5f74 0a20 2020 2020  original_t.     
+000265e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000265f0: 662e 7469 6d65 735b 0a20 2020 2020 2020  f.times[.       
 00026600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026610: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00026620: 656c 662e 6d6f 6465 6c5b 2767 6c6f 6261  elf.model['globa
-00026630: 6c27 5d20 3d20 6e70 2e6f 6e65 7328 0a20  l'] = np.ones(. 
-00026640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026610: 2020 2020 2020 2020 2020 2020 2067 696e               gin
+00026620: 7374 7275 6d65 6e74 5d20 3d20 6f72 6967  strument] = orig
+00026630: 696e 616c 5f69 6e73 7472 756d 656e 745f  inal_instrument_
+00026640: 7469 6d65 735b 0a20 2020 2020 2020 2020  times[.         
 00026650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026660: 2020 2020 2020 206c 656e 286f 7269 6769         len(origi
-00026670: 6e61 6c5f 7429 290a 2020 2020 2020 2020  nal_t)).        
+00026660: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+00026670: 696e 7374 7275 6d65 6e74 5d0a 2020 2020  instrument].    
 00026680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026690: 2020 2020 2020 2020 7365 6c66 2e6e 6461          self.nda
-000266a0: 7461 706f 696e 7473 5f70 6572 5f69 6e73  tapoints_per_ins
-000266b0: 7472 756d 656e 745b 0a20 2020 2020 2020  trument[.       
+00026690: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000266a0: 656c 662e 6d6f 6465 6c74 7970 6520 3d3d  elf.modeltype ==
+000266b0: 2027 6c63 273a 0a0a 2020 2020 2020 2020   'lc':..        
 000266c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000266d0: 2020 2020 2020 2020 2020 2020 2067 696e               gin
-000266e0: 7374 7275 6d65 6e74 5d20 3d20 6e74 5f6f  strument] = nt_o
-000266f0: 7269 6769 6e61 6c5b 6769 6e73 7472 756d  riginal[ginstrum
-00026700: 656e 745d 0a20 2020 2020 2020 2020 2020  ent].           
-00026710: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00026720: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00026730: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00026740: 656c 662e 7469 6d65 735b 696e 7374 7275  elf.times[instru
-00026750: 6d65 6e74 5d20 3d20 6f72 6967 696e 616c  ment] = original
-00026760: 5f69 6e73 7472 756d 656e 745f 7469 6d65  _instrument_time
-00026770: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00026780: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00026790: 2073 656c 662e 6d6f 6465 6c74 7970 6520   self.modeltype 
-000267a0: 3d3d 2027 6c63 273a 0a0a 2020 2020 2020  == 'lc':..      
+000266d0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000266e0: 656c 662e 6469 6374 696f 6e61 7279 5b67  elf.dictionary[g
+000266f0: 696e 7374 7275 6d65 6e74 5d5b 2754 7261  instrument]['Tra
+00026700: 6e73 6974 4669 7427 5d20 6f72 2073 656c  nsitFit'] or sel
+00026710: 662e 6469 6374 696f 6e61 7279 5b67 696e  f.dictionary[gin
+00026720: 7374 7275 6d65 6e74 5d5b 2754 7261 6e73  strument]['Trans
+00026730: 6974 4669 7443 6174 776f 6d61 6e27 5d20  itFitCatwoman'] 
+00026740: 6f72 2073 656c 662e 6469 6374 696f 6e61  or self.dictiona
+00026750: 7279 5b67 696e 7374 7275 6d65 6e74 5d5b  ry[ginstrument][
+00026760: 2745 636c 6970 7365 4669 7427 5d20 6f72  'EclipseFit'] or
+00026770: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
+00026780: 5b67 696e 7374 7275 6d65 6e74 5d5b 2754  [ginstrument]['T
+00026790: 7261 6e45 636c 4669 7427 5d3a 0a20 2020  ranEclFit']:.   
+000267a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000267b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000267c0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-000267d0: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
-000267e0: 7472 756d 656e 745d 5b27 5472 616e 7369  trument]['Transi
-000267f0: 7446 6974 275d 206f 7220 7365 6c66 2e64  tFit'] or self.d
-00026800: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
-00026810: 6d65 6e74 5d5b 2745 636c 6970 7365 4669  ment]['EclipseFi
-00026820: 7427 5d20 6f72 2073 656c 662e 6469 6374  t'] or self.dict
-00026830: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
-00026840: 745d 5b27 5472 616e 4563 6c46 6974 275d  t]['TranEclFit']
-00026850: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00026860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026870: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-00026880: 5b69 6e73 7472 756d 656e 745d 5b27 7061  [instrument]['pa
-00026890: 7261 6d73 275d 2c20 7365 6c66 2e6d 6f64  rams'], self.mod
-000268a0: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
-000268b0: 6d27 5d20 3d20 7361 6d70 6c65 5f70 6172  m'] = sample_par
-000268c0: 616d 732c 7361 6d70 6c65 5f6d 0a0a 2020  ams,sample_m..  
+000267c0: 2020 2020 2073 656c 662e 6d6f 6465 6c5b       self.model[
+000267d0: 6769 6e73 7472 756d 656e 745d 5b27 7061  ginstrument]['pa
+000267e0: 7261 6d73 275d 2c20 7365 6c66 2e6d 6f64  rams'], self.mod
+000267f0: 656c 5b67 696e 7374 7275 6d65 6e74 5d5b  el[ginstrument][
+00026800: 276d 275d 203d 2073 616d 706c 655f 7061  'm'] = sample_pa
+00026810: 7261 6d73 5b67 696e 7374 7275 6d65 6e74  rams[ginstrument
+00026820: 5d2c 7361 6d70 6c65 5f6d 5b67 696e 7374  ],sample_m[ginst
+00026830: 7275 6d65 6e74 5d0a 0a20 2020 2020 2020  rument]..       
+00026840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026850: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00026860: 7365 6c66 2e6c 6d5f 626f 6f6c 6561 6e5b  self.lm_boolean[
+00026870: 6769 6e73 7472 756d 656e 745d 3a0a 2020  ginstrument]:.  
+00026880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000268a0: 2020 2020 2020 7365 6c66 2e6c 6d5f 6172        self.lm_ar
+000268b0: 6775 6d65 6e74 735b 0a20 2020 2020 2020  guments[.       
+000268c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000268d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000268e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000268f0: 2073 656c 662e 6c6d 5f62 6f6f 6c65 616e   self.lm_boolean
-00026900: 5b69 6e73 7472 756d 656e 745d 3a0a 2020  [instrument]:.  
+000268e0: 2020 2020 2067 696e 7374 7275 6d65 6e74       ginstrument
+000268f0: 5d20 3d20 6f72 6967 696e 616c 5f6c 6d5f  ] = original_lm_
+00026900: 6172 6775 6d65 6e74 735b 0a20 2020 2020  arguments[.     
 00026910: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00026920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026930: 2020 7365 6c66 2e6c 6d5f 6172 6775 6d65    self.lm_argume
-00026940: 6e74 735b 0a20 2020 2020 2020 2020 2020  nts[.           
+00026930: 2020 2020 2020 2020 2020 2067 696e 7374             ginst
+00026940: 7275 6d65 6e74 5d0a 2020 2020 2020 2020  rument].        
 00026950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026960: 2020 2020 2020 2020 2020 2020 2069 6e73               ins
-00026970: 7472 756d 656e 745d 203d 206f 7269 6769  trument] = origi
-00026980: 6e61 6c5f 6c6d 5f61 7267 756d 656e 7473  nal_lm_arguments
-00026990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026960: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00026970: 2e6d 6f64 656c 5b67 696e 7374 7275 6d65  .model[ginstrume
+00026980: 6e74 5d5b 276f 6e65 7327 5d20 3d20 6e70  nt]['ones'] = np
+00026990: 2e6f 6e65 7328 0a20 2020 2020 2020 2020  .ones(.         
 000269a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000269b0: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-000269c0: 7275 6d65 6e74 5d5b 276f 6e65 7327 5d20  rument]['ones'] 
-000269d0: 3d20 6e70 2e6f 6e65 7328 0a20 2020 2020  = np.ones(.     
+000269b0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+000269c0: 745f 6f72 6967 696e 616c 5b67 696e 7374  t_original[ginst
+000269d0: 7275 6d65 6e74 5d29 0a20 2020 2020 2020  rument]).       
 000269e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000269f0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00026a00: 745f 6f72 6967 696e 616c 290a 2020 2020  t_original).    
+000269f0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00026a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00026a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026a20: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00026a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026a40: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00026a50: 6c66 2e74 203d 206f 7269 6769 6e61 6c5f  lf.t = original_
-00026a60: 740a 0a20 2020 2020 2020 2020 2020 2020  t..             
-00026a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026a80: 2020 2073 656c 662e 696e 7374 7275 6d65     self.instrume
-00026a90: 6e74 5f69 6e64 6578 6573 5b69 6e73 7472  nt_indexes[instr
-00026aa0: 756d 656e 745d 203d 206f 7269 6769 6e61  ument] = origina
-00026ab0: 6c5f 696e 7374 7275 6d65 6e74 5f69 6e64  l_instrument_ind
-00026ac0: 6578 0a20 2020 2020 2020 2020 2020 2020  ex.             
-00026ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026ae0: 2020 200a 2020 2020 2020 2020 2020 2020     .            
-00026af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026b00: 7365 6c66 2e6e 6461 7461 706f 696e 7473  self.ndatapoints
-00026b10: 5f70 6572 5f69 6e73 7472 756d 656e 745b  _per_instrument[
-00026b20: 696e 7374 7275 6d65 6e74 5d20 3d20 6e74  instrument] = nt
-00026b30: 5f6f 7269 6769 6e61 6c0a 0a20 2020 2020  _original..     
-00026b40: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00026b50: 6f75 6e74 6572 202b 3d20 310a 2020 2020  ounter += 1.    
-00026b60: 2020 2020 2020 2020 2020 2020 2320 4966              # If
-00026b70: 2072 6574 7572 6e5f 6572 726f 7220 6973   return_error is
-00026b80: 206f 6e2c 2072 6574 7572 6e20 7570 7065   on, return uppe
-00026b90: 7220 616e 6420 6c6f 7765 7220 7369 676d  r and lower sigm
-00026ba0: 6120 2861 6c70 6861 2078 2031 3030 2520  a (alpha x 100% 
-00026bb0: 4349 2920 6f66 2074 6865 206d 6f64 656c  CI) of the model
-00026bc0: 2873 293a 0a20 2020 2020 2020 2020 2020  (s):.           
-00026bd0: 2020 2020 2069 6620 7265 7475 726e 5f65       if return_e
-00026be0: 7272 3a0a 2020 2020 2020 2020 2020 2020  rr:.            
-00026bf0: 2020 2020 2020 2020 6d5f 6f75 7470 7574          m_output
-00026c00: 5f6d 6f64 656c 2c20 755f 6f75 7470 7574  _model, u_output
-00026c10: 5f6d 6f64 656c 2c20 6c5f 6f75 7470 7574  _model, l_output
-00026c20: 5f6d 6f64 656c 203d 206e 702e 7a65 726f  _model = np.zero
-00026c30: 7328 6f75 7470 7574 5f6d 6f64 656c 5f73  s(output_model_s
-00026c40: 616d 706c 6573 2e73 6861 7065 5b31 5d29  amples.shape[1])
-00026c50: 2c5c 0a20 2020 2020 2020 2020 2020 2020  ,\.             
-00026c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026c90: 2020 2020 2020 2020 6e70 2e7a 6572 6f73          np.zeros
-00026ca0: 286f 7574 7075 745f 6d6f 6465 6c5f 7361  (output_model_sa
-00026cb0: 6d70 6c65 732e 7368 6170 655b 315d 292c  mples.shape[1]),
-00026cc0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-00026cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026d00: 2020 2020 2020 206e 702e 7a65 726f 7328         np.zeros(
-00026d10: 6f75 7470 7574 5f6d 6f64 656c 5f73 616d  output_model_sam
-00026d20: 706c 6573 2e73 6861 7065 5b31 5d29 0a20  ples.shape[1]). 
-00026d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026d40: 2020 2069 6620 7365 6c66 2e67 6c6f 6261     if self.globa
-00026d50: 6c5f 6d6f 6465 6c3a 0a20 2020 2020 2020  l_model:.       
-00026d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026d70: 2069 6620 7365 6c66 2e64 6963 7469 6f6e   if self.diction
-00026d80: 6172 795b 2767 6c6f 6261 6c5f 6d6f 6465  ary['global_mode
-00026d90: 6c27 5d5b 2747 5044 6574 7265 6e64 275d  l']['GPDetrend']
-00026da0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00026db0: 2020 2020 2020 2020 2020 2020 2020 6d44                mD
-00026dc0: 4554 5f6f 7574 7075 745f 6d6f 6465 6c2c  ET_output_model,
-00026dd0: 2075 4445 545f 6f75 7470 7574 5f6d 6f64   uDET_output_mod
-00026de0: 656c 2c20 6c44 4554 5f6f 7574 7075 745f  el, lDET_output_
-00026df0: 6d6f 6465 6c20 3d20 6e70 2e63 6f70 7928  model = np.copy(
-00026e00: 6d5f 6f75 7470 7574 5f6d 6f64 656c 292c  m_output_model),
-00026e10: 206e 702e 636f 7079 2875 5f6f 7574 7075   np.copy(u_outpu
-00026e20: 745f 6d6f 6465 6c29 2c20 5c0a 2020 2020  t_model), \.    
-00026e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026a20: 2020 2073 656c 662e 7420 3d20 6f72 6967     self.t = orig
+00026a30: 696e 616c 5f74 0a20 2020 2020 2020 2020  inal_t.         
+00026a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026a50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00026a60: 6d6f 6465 6c5b 2767 6c6f 6261 6c27 5d20  model['global'] 
+00026a70: 3d20 6e70 2e6f 6e65 7328 0a20 2020 2020  = np.ones(.     
+00026a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026aa0: 2020 206c 656e 286f 7269 6769 6e61 6c5f     len(original_
+00026ab0: 7429 290a 2020 2020 2020 2020 2020 2020  t)).            
+00026ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026ad0: 2020 2020 7365 6c66 2e6e 6461 7461 706f      self.ndatapo
+00026ae0: 696e 7473 5f70 6572 5f69 6e73 7472 756d  ints_per_instrum
+00026af0: 656e 745b 0a20 2020 2020 2020 2020 2020  ent[.           
+00026b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026b10: 2020 2020 2020 2020 2067 696e 7374 7275           ginstru
+00026b20: 6d65 6e74 5d20 3d20 6e74 5f6f 7269 6769  ment] = nt_origi
+00026b30: 6e61 6c5b 6769 6e73 7472 756d 656e 745d  nal[ginstrument]
+00026b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026b50: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00026b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026b70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00026b80: 7469 6d65 735b 696e 7374 7275 6d65 6e74  times[instrument
+00026b90: 5d20 3d20 6f72 6967 696e 616c 5f69 6e73  ] = original_ins
+00026ba0: 7472 756d 656e 745f 7469 6d65 730a 2020  trument_times.  
+00026bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026bc0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00026bd0: 662e 6d6f 6465 6c74 7970 6520 3d3d 2027  f.modeltype == '
+00026be0: 6c63 273a 0a0a 2020 2020 2020 2020 2020  lc':..          
+00026bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026c00: 2020 2020 2020 6966 2073 656c 662e 6469        if self.di
+00026c10: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
+00026c20: 656e 745d 5b27 5472 616e 7369 7446 6974  ent]['TransitFit
+00026c30: 275d 206f 7220 7365 6c66 2e64 6963 7469  '] or self.dicti
+00026c40: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
+00026c50: 5d5b 2745 636c 6970 7365 4669 7427 5d20  ]['EclipseFit'] 
+00026c60: 6f72 2073 656c 662e 6469 6374 696f 6e61  or self.dictiona
+00026c70: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
+00026c80: 5472 616e 4563 6c46 6974 275d 3a0a 2020  TranEclFit']:.  
+00026c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026cb0: 2020 7365 6c66 2e6d 6f64 656c 5b69 6e73    self.model[ins
+00026cc0: 7472 756d 656e 745d 5b27 7061 7261 6d73  trument]['params
+00026cd0: 275d 2c20 7365 6c66 2e6d 6f64 656c 5b69  '], self.model[i
+00026ce0: 6e73 7472 756d 656e 745d 5b27 6d27 5d20  nstrument]['m'] 
+00026cf0: 3d20 7361 6d70 6c65 5f70 6172 616d 732c  = sample_params,
+00026d00: 7361 6d70 6c65 5f6d 0a0a 2020 2020 2020  sample_m..      
+00026d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026d20: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00026d30: 662e 6c6d 5f62 6f6f 6c65 616e 5b69 6e73  f.lm_boolean[ins
+00026d40: 7472 756d 656e 745d 3a0a 2020 2020 2020  trument]:.      
+00026d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026d60: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00026d70: 6c66 2e6c 6d5f 6172 6775 6d65 6e74 735b  lf.lm_arguments[
+00026d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026da0: 2020 2020 2020 2020 2069 6e73 7472 756d           instrum
+00026db0: 656e 745d 203d 206f 7269 6769 6e61 6c5f  ent] = original_
+00026dc0: 6c6d 5f61 7267 756d 656e 7473 0a20 2020  lm_arguments.   
+00026dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026de0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00026df0: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+00026e00: 6e74 5d5b 276f 6e65 7327 5d20 3d20 6e70  nt]['ones'] = np
+00026e10: 2e6f 6e65 7328 0a20 2020 2020 2020 2020  .ones(.         
+00026e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026e30: 2020 2020 2020 2020 2020 206e 745f 6f72             nt_or
+00026e40: 6967 696e 616c 290a 2020 2020 2020 2020  iginal).        
 00026e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026e70: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00026e80: 702e 636f 7079 286c 5f6f 7574 7075 745f  p.copy(l_output_
-00026e90: 6d6f 6465 6c29 0a0a 2020 2020 2020 2020  model)..        
+00026e60: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00026e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026e80: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
+00026e90: 203d 206f 7269 6769 6e61 6c5f 740a 0a20   = original_t.. 
 00026ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026eb0: 2020 2020 6d47 505f 6f75 7470 7574 5f6d      mGP_output_m
-00026ec0: 6f64 656c 2c20 7547 505f 6f75 7470 7574  odel, uGP_output
-00026ed0: 5f6d 6f64 656c 2c20 6c47 505f 6f75 7470  _model, lGP_outp
-00026ee0: 7574 5f6d 6f64 656c 203d 206e 702e 636f  ut_model = np.co
-00026ef0: 7079 286d 5f6f 7574 7075 745f 6d6f 6465  py(m_output_mode
-00026f00: 6c29 2c20 6e70 2e63 6f70 7928 755f 6f75  l), np.copy(u_ou
-00026f10: 7470 7574 5f6d 6f64 656c 292c 205c 0a20  tput_model), \. 
+00026eb0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00026ec0: 656c 662e 696e 7374 7275 6d65 6e74 5f69  elf.instrument_i
+00026ed0: 6e64 6578 6573 5b69 6e73 7472 756d 656e  ndexes[instrumen
+00026ee0: 745d 203d 206f 7269 6769 6e61 6c5f 696e  t] = original_in
+00026ef0: 7374 7275 6d65 6e74 5f69 6e64 6578 0a20  strument_index. 
+00026f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026f10: 2020 2020 2020 2020 2020 2020 2020 200a                 .
 00026f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026f70: 2020 6e70 2e63 6f70 7928 6c5f 6f75 7470    np.copy(l_outp
-00026f80: 7574 5f6d 6f64 656c 290a 2020 2020 2020  ut_model).      
-00026f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026fa0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00026fb0: 286f 7574 7075 745f 6d6f 6465 6c5f 7361  (output_model_sa
-00026fc0: 6d70 6c65 732e 7368 6170 655b 315d 293a  mples.shape[1]):
-00026fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026fe0: 2020 2020 2020 2020 2020 2020 206d 5f6f               m_o
-00026ff0: 7574 7075 745f 6d6f 6465 6c5b 695d 2c20  utput_model[i], 
-00027000: 755f 6f75 7470 7574 5f6d 6f64 656c 5b0a  u_output_model[.
-00027010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026f30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00026f40: 2e6e 6461 7461 706f 696e 7473 5f70 6572  .ndatapoints_per
+00026f50: 5f69 6e73 7472 756d 656e 745b 696e 7374  _instrument[inst
+00026f60: 7275 6d65 6e74 5d20 3d20 6e74 5f6f 7269  rument] = nt_ori
+00026f70: 6769 6e61 6c0a 0a20 2020 2020 2020 2020  ginal..         
+00026f80: 2020 2020 2020 2020 2020 2063 6f75 6e74             count
+00026f90: 6572 202b 3d20 310a 2020 2020 2020 2020  er += 1.        
+00026fa0: 2020 2020 2020 2020 2320 4966 2072 6574          # If ret
+00026fb0: 7572 6e5f 6572 726f 7220 6973 206f 6e2c  urn_error is on,
+00026fc0: 2072 6574 7572 6e20 7570 7065 7220 616e   return upper an
+00026fd0: 6420 6c6f 7765 7220 7369 676d 6120 2861  d lower sigma (a
+00026fe0: 6c70 6861 2078 2031 3030 2520 4349 2920  lpha x 100% CI) 
+00026ff0: 6f66 2074 6865 206d 6f64 656c 2873 293a  of the model(s):
+00027000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027010: 2069 6620 7265 7475 726e 5f65 7272 3a0a   if return_err:.
 00027020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027030: 695d 2c20 6c5f 6f75 7470 7574 5f6d 6f64  i], l_output_mod
-00027040: 656c 5b69 5d20 3d20 6765 745f 7175 616e  el[i] = get_quan
-00027050: 7469 6c65 7328 0a20 2020 2020 2020 2020  tiles(.         
-00027060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027070: 2020 2020 2020 2020 2020 206f 7574 7075             outpu
-00027080: 745f 6d6f 6465 6c5f 7361 6d70 6c65 735b  t_model_samples[
-00027090: 3a2c 2069 5d2c 2061 6c70 6861 3d61 6c70  :, i], alpha=alp
-000270a0: 6861 290a 2020 2020 2020 2020 2020 2020  ha).            
+00027030: 2020 2020 6d5f 6f75 7470 7574 5f6d 6f64      m_output_mod
+00027040: 656c 2c20 755f 6f75 7470 7574 5f6d 6f64  el, u_output_mod
+00027050: 656c 2c20 6c5f 6f75 7470 7574 5f6d 6f64  el, l_output_mod
+00027060: 656c 203d 206e 702e 7a65 726f 7328 6f75  el = np.zeros(ou
+00027070: 7470 7574 5f6d 6f64 656c 5f73 616d 706c  tput_model_sampl
+00027080: 6573 2e73 6861 7065 5b31 5d29 2c5c 0a20  es.shape[1]),\. 
+00027090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000270a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000270b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000270c0: 6966 2073 656c 662e 6469 6374 696f 6e61  if self.dictiona
-000270d0: 7279 5b27 676c 6f62 616c 5f6d 6f64 656c  ry['global_model
-000270e0: 275d 5b27 4750 4465 7472 656e 6427 5d3a  ']['GPDetrend']:
-000270f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000270c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000270d0: 2020 2020 6e70 2e7a 6572 6f73 286f 7574      np.zeros(out
+000270e0: 7075 745f 6d6f 6465 6c5f 7361 6d70 6c65  put_model_sample
+000270f0: 732e 7368 6170 655b 315d 292c 5c0a 2020  s.shape[1]),\.  
 00027100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027110: 206d 4445 545f 6f75 7470 7574 5f6d 6f64   mDET_output_mod
-00027120: 656c 5b69 5d2c 2075 4445 545f 6f75 7470  el[i], uDET_outp
-00027130: 7574 5f6d 6f64 656c 5b0a 2020 2020 2020  ut_model[.      
-00027140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027150: 2020 2020 2020 2020 2020 2020 2020 695d                i]
-00027160: 2c20 6c44 4554 5f6f 7574 7075 745f 6d6f  , lDET_output_mo
-00027170: 6465 6c5b 695d 203d 2067 6574 5f71 7561  del[i] = get_qua
-00027180: 6e74 696c 6573 280a 2020 2020 2020 2020  ntiles(.        
-00027190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000271a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000271b0: 6f75 7470 7574 5f6d 6f64 656c 4445 545f  output_modelDET_
-000271c0: 7361 6d70 6c65 735b 3a2c 2069 5d2c 0a20  samples[:, i],. 
-000271d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027140: 2020 206e 702e 7a65 726f 7328 6f75 7470     np.zeros(outp
+00027150: 7574 5f6d 6f64 656c 5f73 616d 706c 6573  ut_model_samples
+00027160: 2e73 6861 7065 5b31 5d29 0a20 2020 2020  .shape[1]).     
+00027170: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00027180: 6620 7365 6c66 2e67 6c6f 6261 6c5f 6d6f  f self.global_mo
+00027190: 6465 6c3a 0a20 2020 2020 2020 2020 2020  del:.           
+000271a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000271b0: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
+000271c0: 2767 6c6f 6261 6c5f 6d6f 6465 6c27 5d5b  'global_model'][
+000271d0: 2747 5044 6574 7265 6e64 275d 3a0a 2020  'GPDetrend']:.  
 000271e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000271f0: 2020 2020 2020 2061 6c70 6861 3d61 6c70         alpha=alp
-00027200: 6861 290a 2020 2020 2020 2020 2020 2020  ha).            
-00027210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027220: 2020 2020 6d47 505f 6f75 7470 7574 5f6d      mGP_output_m
-00027230: 6f64 656c 5b69 5d2c 2075 4750 5f6f 7574  odel[i], uGP_out
-00027240: 7075 745f 6d6f 6465 6c5b 0a20 2020 2020  put_model[.     
-00027250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027260: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00027270: 5d2c 206c 4750 5f6f 7574 7075 745f 6d6f  ], lGP_output_mo
-00027280: 6465 6c5b 695d 203d 2067 6574 5f71 7561  del[i] = get_qua
-00027290: 6e74 696c 6573 280a 2020 2020 2020 2020  ntiles(.        
+000271f0: 2020 2020 2020 2020 2020 6d44 4554 5f6f            mDET_o
+00027200: 7574 7075 745f 6d6f 6465 6c2c 2075 4445  utput_model, uDE
+00027210: 545f 6f75 7470 7574 5f6d 6f64 656c 2c20  T_output_model, 
+00027220: 6c44 4554 5f6f 7574 7075 745f 6d6f 6465  lDET_output_mode
+00027230: 6c20 3d20 6e70 2e63 6f70 7928 6d5f 6f75  l = np.copy(m_ou
+00027240: 7470 7574 5f6d 6f64 656c 292c 206e 702e  tput_model), np.
+00027250: 636f 7079 2875 5f6f 7574 7075 745f 6d6f  copy(u_output_mo
+00027260: 6465 6c29 2c20 5c0a 2020 2020 2020 2020  del), \.        
+00027270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027290: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000272a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000272b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000272c0: 6f75 7470 7574 5f6d 6f64 656c 4750 5f73  output_modelGP_s
-000272d0: 616d 706c 6573 5b3a 2c20 695d 2c0a 2020  amples[:, i],.  
+000272b0: 2020 2020 2020 2020 2020 206e 702e 636f             np.co
+000272c0: 7079 286c 5f6f 7574 7075 745f 6d6f 6465  py(l_output_mode
+000272d0: 6c29 0a0a 2020 2020 2020 2020 2020 2020  l)..            
 000272e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000272f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027300: 2020 2020 2020 616c 7068 613d 616c 7068        alpha=alph
-00027310: 6129 0a20 2020 2020 2020 2020 2020 2020  a).             
-00027320: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00027330: 6c66 2e64 6963 7469 6f6e 6172 795b 2767  lf.dictionary['g
-00027340: 6c6f 6261 6c5f 6d6f 6465 6c27 5d5b 2747  lobal_model']['G
-00027350: 5044 6574 7265 6e64 275d 3a0a 2020 2020  PDetrend']:.    
+000272f0: 6d47 505f 6f75 7470 7574 5f6d 6f64 656c  mGP_output_model
+00027300: 2c20 7547 505f 6f75 7470 7574 5f6d 6f64  , uGP_output_mod
+00027310: 656c 2c20 6c47 505f 6f75 7470 7574 5f6d  el, lGP_output_m
+00027320: 6f64 656c 203d 206e 702e 636f 7079 286d  odel = np.copy(m
+00027330: 5f6f 7574 7075 745f 6d6f 6465 6c29 2c20  _output_model), 
+00027340: 6e70 2e63 6f70 7928 755f 6f75 7470 7574  np.copy(u_output
+00027350: 5f6d 6f64 656c 292c 205c 0a20 2020 2020  _model), \.     
 00027360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027370: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
-00027380: 656c 5b27 6465 7465 726d 696e 6973 7469  el['deterministi
-00027390: 6327 5d2c 2073 656c 662e 6d6f 6465 6c5b  c'], self.model[
-000273a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000273b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000273c0: 2027 4750 275d 203d 206d 4445 545f 6f75   'GP'] = mDET_ou
-000273d0: 7470 7574 5f6d 6f64 656c 2c20 6d47 505f  tput_model, mGP_
-000273e0: 6f75 7470 7574 5f6d 6f64 656c 0a20 2020  output_model.   
-000273f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027400: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-00027410: 6465 6c5b 2764 6574 6572 6d69 6e69 7374  del['determinist
-00027420: 6963 5f75 6572 726f 7227 5d2c 2073 656c  ic_uerror'], sel
-00027430: 662e 6d6f 6465 6c5b 0a20 2020 2020 2020  f.model[.       
-00027440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027450: 2020 2020 2020 2020 2027 4750 5f75 6572           'GP_uer
-00027460: 726f 7227 5d20 3d20 7544 4554 5f6f 7574  ror'] = uDET_out
-00027470: 7075 745f 6d6f 6465 6c2c 2075 4750 5f6f  put_model, uGP_o
-00027480: 7574 7075 745f 6d6f 6465 6c0a 2020 2020  utput_model.    
-00027490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000274a0: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
-000274b0: 656c 5b27 6465 7465 726d 696e 6973 7469  el['deterministi
-000274c0: 635f 6c65 7272 6f72 275d 2c20 7365 6c66  c_lerror'], self
-000274d0: 2e6d 6f64 656c 5b0a 2020 2020 2020 2020  .model[.        
+00027370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000273a0: 2020 2020 2020 2020 2020 2020 2020 6e70                np
+000273b0: 2e63 6f70 7928 6c5f 6f75 7470 7574 5f6d  .copy(l_output_m
+000273c0: 6f64 656c 290a 2020 2020 2020 2020 2020  odel).          
+000273d0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+000273e0: 7220 6920 696e 2072 616e 6765 286f 7574  r i in range(out
+000273f0: 7075 745f 6d6f 6465 6c5f 7361 6d70 6c65  put_model_sample
+00027400: 732e 7368 6170 655b 315d 293a 0a20 2020  s.shape[1]):.   
+00027410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027420: 2020 2020 2020 2020 206d 5f6f 7574 7075           m_outpu
+00027430: 745f 6d6f 6465 6c5b 695d 2c20 755f 6f75  t_model[i], u_ou
+00027440: 7470 7574 5f6d 6f64 656c 5b0a 2020 2020  tput_model[.    
+00027450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027460: 2020 2020 2020 2020 2020 2020 695d 2c20              i], 
+00027470: 6c5f 6f75 7470 7574 5f6d 6f64 656c 5b69  l_output_model[i
+00027480: 5d20 3d20 6765 745f 7175 616e 7469 6c65  ] = get_quantile
+00027490: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+000274a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000274b0: 2020 2020 2020 206f 7574 7075 745f 6d6f         output_mo
+000274c0: 6465 6c5f 7361 6d70 6c65 735b 3a2c 2069  del_samples[:, i
+000274d0: 5d2c 2061 6c70 6861 3d61 6c70 6861 290a  ], alpha=alpha).
 000274e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000274f0: 2020 2020 2020 2020 2747 505f 6c65 7272          'GP_lerr
-00027500: 6f72 275d 203d 206c 4445 545f 6f75 7470  or'] = lDET_outp
-00027510: 7574 5f6d 6f64 656c 2c20 6c47 505f 6f75  ut_model, lGP_ou
-00027520: 7470 7574 5f6d 6f64 656c 0a20 2020 2020  tput_model.     
-00027530: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00027540: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00027550: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00027560: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
-00027570: 696e 7374 7275 6d65 6e74 5d5b 2747 5044  instrument]['GPD
-00027580: 6574 7265 6e64 275d 3a0a 2020 2020 2020  etrend']:.      
-00027590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000275a0: 2020 2020 2020 6d44 4554 5f6f 7574 7075        mDET_outpu
-000275b0: 745f 6d6f 6465 6c2c 2075 4445 545f 6f75  t_model, uDET_ou
-000275c0: 7470 7574 5f6d 6f64 656c 2c20 6c44 4554  tput_model, lDET
-000275d0: 5f6f 7574 7075 745f 6d6f 6465 6c20 3d20  _output_model = 
-000275e0: 6e70 2e63 6f70 7928 6d5f 6f75 7470 7574  np.copy(m_output
-000275f0: 5f6d 6f64 656c 292c 206e 702e 636f 7079  _model), np.copy
-00027600: 2875 5f6f 7574 7075 745f 6d6f 6465 6c29  (u_output_model)
-00027610: 2c20 5c0a 2020 2020 2020 2020 2020 2020  , \.            
+000274f0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00027500: 656c 662e 6469 6374 696f 6e61 7279 5b27  elf.dictionary['
+00027510: 676c 6f62 616c 5f6d 6f64 656c 275d 5b27  global_model']['
+00027520: 4750 4465 7472 656e 6427 5d3a 0a20 2020  GPDetrend']:.   
+00027530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027540: 2020 2020 2020 2020 2020 2020 206d 4445               mDE
+00027550: 545f 6f75 7470 7574 5f6d 6f64 656c 5b69  T_output_model[i
+00027560: 5d2c 2075 4445 545f 6f75 7470 7574 5f6d  ], uDET_output_m
+00027570: 6f64 656c 5b0a 2020 2020 2020 2020 2020  odel[.          
+00027580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027590: 2020 2020 2020 2020 2020 695d 2c20 6c44            i], lD
+000275a0: 4554 5f6f 7574 7075 745f 6d6f 6465 6c5b  ET_output_model[
+000275b0: 695d 203d 2067 6574 5f71 7561 6e74 696c  i] = get_quantil
+000275c0: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
+000275d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000275e0: 2020 2020 2020 2020 2020 2020 6f75 7470              outp
+000275f0: 7574 5f6d 6f64 656c 4445 545f 7361 6d70  ut_modelDET_samp
+00027600: 6c65 735b 3a2c 2069 5d2c 0a20 2020 2020  les[:, i],.     
+00027610: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00027620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027630: 2020 2061 6c70 6861 3d61 6c70 6861 290a     alpha=alpha).
 00027640: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00027650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027660: 2020 2020 2020 206e 702e 636f 7079 286c         np.copy(l
-00027670: 5f6f 7574 7075 745f 6d6f 6465 6c29 0a0a  _output_model)..
-00027680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027690: 2020 2020 2020 2020 2020 2020 6d47 505f              mGP_
-000276a0: 6f75 7470 7574 5f6d 6f64 656c 2c20 7547  output_model, uG
-000276b0: 505f 6f75 7470 7574 5f6d 6f64 656c 2c20  P_output_model, 
-000276c0: 6c47 505f 6f75 7470 7574 5f6d 6f64 656c  lGP_output_model
-000276d0: 203d 206e 702e 636f 7079 286d 5f6f 7574   = np.copy(m_out
-000276e0: 7075 745f 6d6f 6465 6c29 2c20 6e70 2e63  put_model), np.c
-000276f0: 6f70 7928 755f 6f75 7470 7574 5f6d 6f64  opy(u_output_mod
-00027700: 656c 292c 205c 0a20 2020 2020 2020 2020  el), \.         
-00027710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027660: 6d47 505f 6f75 7470 7574 5f6d 6f64 656c  mGP_output_model
+00027670: 5b69 5d2c 2075 4750 5f6f 7574 7075 745f  [i], uGP_output_
+00027680: 6d6f 6465 6c5b 0a20 2020 2020 2020 2020  model[.         
+00027690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000276a0: 2020 2020 2020 2020 2020 2069 5d2c 206c             i], l
+000276b0: 4750 5f6f 7574 7075 745f 6d6f 6465 6c5b  GP_output_model[
+000276c0: 695d 203d 2067 6574 5f71 7561 6e74 696c  i] = get_quantil
+000276d0: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
+000276e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000276f0: 2020 2020 2020 2020 2020 2020 6f75 7470              outp
+00027700: 7574 5f6d 6f64 656c 4750 5f73 616d 706c  ut_modelGP_sampl
+00027710: 6573 5b3a 2c20 695d 2c0a 2020 2020 2020  es[:, i],.      
 00027720: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00027730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027750: 2020 2020 2020 2020 2020 6e70 2e63 6f70            np.cop
-00027760: 7928 6c5f 6f75 7470 7574 5f6d 6f64 656c  y(l_output_model
-00027770: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00027780: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-00027790: 696e 2072 616e 6765 286f 7574 7075 745f  in range(output_
-000277a0: 6d6f 6465 6c5f 7361 6d70 6c65 732e 7368  model_samples.sh
-000277b0: 6170 655b 315d 293a 0a20 2020 2020 2020  ape[1]):.       
-000277c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000277d0: 2020 200a 2020 2020 2020 2020 2020 2020     .            
+00027740: 2020 616c 7068 613d 616c 7068 6129 0a20    alpha=alpha). 
+00027750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027760: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
+00027770: 6963 7469 6f6e 6172 795b 2767 6c6f 6261  ictionary['globa
+00027780: 6c5f 6d6f 6465 6c27 5d5b 2747 5044 6574  l_model']['GPDet
+00027790: 7265 6e64 275d 3a0a 2020 2020 2020 2020  rend']:.        
+000277a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000277b0: 2020 2020 7365 6c66 2e6d 6f64 656c 5b27      self.model['
+000277c0: 6465 7465 726d 696e 6973 7469 6327 5d2c  deterministic'],
+000277d0: 2073 656c 662e 6d6f 6465 6c5b 0a20 2020   self.model[.   
 000277e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000277f0: 6d5f 6f75 7470 7574 5f6d 6f64 656c 5b69  m_output_model[i
-00027800: 5d2c 2075 5f6f 7574 7075 745f 6d6f 6465  ], u_output_mode
-00027810: 6c5b 0a20 2020 2020 2020 2020 2020 2020  l[.             
-00027820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027830: 2020 2069 5d2c 206c 5f6f 7574 7075 745f     i], l_output_
-00027840: 6d6f 6465 6c5b 695d 203d 2067 6574 5f71  model[i] = get_q
-00027850: 7561 6e74 696c 6573 280a 2020 2020 2020  uantiles(.      
-00027860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027870: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
-00027880: 7470 7574 5f6d 6f64 656c 5f73 616d 706c  tput_model_sampl
-00027890: 6573 5b3a 2c20 695d 2c20 616c 7068 613d  es[:, i], alpha=
-000278a0: 616c 7068 6129 0a20 2020 2020 2020 2020  alpha).         
-000278b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000278c0: 2020 200a 2020 2020 2020 2020 2020 2020     .            
+000277f0: 2020 2020 2020 2020 2020 2020 2027 4750               'GP
+00027800: 275d 203d 206d 4445 545f 6f75 7470 7574  '] = mDET_output
+00027810: 5f6d 6f64 656c 2c20 6d47 505f 6f75 7470  _model, mGP_outp
+00027820: 7574 5f6d 6f64 656c 0a20 2020 2020 2020  ut_model.       
+00027830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027840: 2020 2020 2073 656c 662e 6d6f 6465 6c5b       self.model[
+00027850: 2764 6574 6572 6d69 6e69 7374 6963 5f75  'deterministic_u
+00027860: 6572 726f 7227 5d2c 2073 656c 662e 6d6f  error'], self.mo
+00027870: 6465 6c5b 0a20 2020 2020 2020 2020 2020  del[.           
+00027880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027890: 2020 2020 2027 4750 5f75 6572 726f 7227       'GP_uerror'
+000278a0: 5d20 3d20 7544 4554 5f6f 7574 7075 745f  ] = uDET_output_
+000278b0: 6d6f 6465 6c2c 2075 4750 5f6f 7574 7075  model, uGP_outpu
+000278c0: 745f 6d6f 6465 6c0a 2020 2020 2020 2020  t_model.        
 000278d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000278e0: 6966 2073 656c 662e 6469 6374 696f 6e61  if self.dictiona
-000278f0: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
-00027900: 4750 4465 7472 656e 6427 5d3a 0a0a 2020  GPDetrend']:..  
-00027910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027920: 2020 2020 2020 2020 2020 2020 2020 6d44                mD
-00027930: 4554 5f6f 7574 7075 745f 6d6f 6465 6c5b  ET_output_model[
-00027940: 695d 2c20 7544 4554 5f6f 7574 7075 745f  i], uDET_output_
-00027950: 6d6f 6465 6c5b 695d 2c20 6c44 4554 5f6f  model[i], lDET_o
-00027960: 7574 7075 745f 6d6f 6465 6c5b 695d 203d  utput_model[i] =
-00027970: 2067 6574 5f71 7561 6e74 696c 6573 286f   get_quantiles(o
-00027980: 7574 7075 745f 6d6f 6465 6c44 4554 5f73  utput_modelDET_s
-00027990: 616d 706c 6573 5b3a 2c69 5d2c 2061 6c70  amples[:,i], alp
-000279a0: 6861 203d 2061 6c70 6861 290a 2020 2020  ha = alpha).    
-000279b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000279c0: 2020 2020 2020 2020 2020 2020 6d47 505f              mGP_
-000279d0: 6f75 7470 7574 5f6d 6f64 656c 5b69 5d2c  output_model[i],
-000279e0: 2075 4750 5f6f 7574 7075 745f 6d6f 6465   uGP_output_mode
-000279f0: 6c5b 695d 2c20 6c47 505f 6f75 7470 7574  l[i], lGP_output
-00027a00: 5f6d 6f64 656c 5b69 5d20 3d20 6765 745f  _model[i] = get_
-00027a10: 7175 616e 7469 6c65 7328 6f75 7470 7574  quantiles(output
-00027a20: 5f6d 6f64 656c 4750 5f73 616d 706c 6573  _modelGP_samples
-00027a30: 5b3a 2c69 5d2c 2061 6c70 6861 203d 2061  [:,i], alpha = a
-00027a40: 6c70 6861 290a 2020 2020 2020 2020 2020  lpha).          
+000278e0: 2020 2020 7365 6c66 2e6d 6f64 656c 5b27      self.model['
+000278f0: 6465 7465 726d 696e 6973 7469 635f 6c65  deterministic_le
+00027900: 7272 6f72 275d 2c20 7365 6c66 2e6d 6f64  rror'], self.mod
+00027910: 656c 5b0a 2020 2020 2020 2020 2020 2020  el[.            
+00027920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027930: 2020 2020 2747 505f 6c65 7272 6f72 275d      'GP_lerror']
+00027940: 203d 206c 4445 545f 6f75 7470 7574 5f6d   = lDET_output_m
+00027950: 6f64 656c 2c20 6c47 505f 6f75 7470 7574  odel, lGP_output
+00027960: 5f6d 6f64 656c 0a20 2020 2020 2020 2020  _model.         
+00027970: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00027980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027990: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+000279a0: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
+000279b0: 7275 6d65 6e74 5d5b 2747 5044 6574 7265  rument]['GPDetre
+000279c0: 6e64 275d 3a0a 2020 2020 2020 2020 2020  nd']:.          
+000279d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000279e0: 2020 6d44 4554 5f6f 7574 7075 745f 6d6f    mDET_output_mo
+000279f0: 6465 6c2c 2075 4445 545f 6f75 7470 7574  del, uDET_output
+00027a00: 5f6d 6f64 656c 2c20 6c44 4554 5f6f 7574  _model, lDET_out
+00027a10: 7075 745f 6d6f 6465 6c20 3d20 6e70 2e63  put_model = np.c
+00027a20: 6f70 7928 6d5f 6f75 7470 7574 5f6d 6f64  opy(m_output_mod
+00027a30: 656c 292c 206e 702e 636f 7079 2875 5f6f  el), np.copy(u_o
+00027a40: 7574 7075 745f 6d6f 6465 6c29 2c20 5c0a  utput_model), \.
 00027a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027a60: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
-00027a70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00027a80: 6620 7365 6c66 2e64 6963 7469 6f6e 6172  f self.dictionar
-00027a90: 795b 696e 7374 7275 6d65 6e74 5d5b 2747  y[instrument]['G
-00027aa0: 5044 6574 7265 6e64 275d 3a0a 2020 2020  PDetrend']:.    
-00027ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ac0: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
-00027ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ae0: 2020 2073 656c 662e 6d6f 6465 6c5b 696e     self.model[in
-00027af0: 7374 7275 6d65 6e74 5d5b 2764 6574 6572  strument]['deter
-00027b00: 6d69 6e69 7374 6963 275d 2c20 7365 6c66  ministic'], self
-00027b10: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
-00027b20: 745d 5b27 4750 275d 203d 206d 4445 545f  t]['GP'] = mDET_
-00027b30: 6f75 7470 7574 5f6d 6f64 656c 2c20 6d47  output_model, mG
-00027b40: 505f 6f75 7470 7574 5f6d 6f64 656c 0a20  P_output_model. 
+00027a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027aa0: 2020 206e 702e 636f 7079 286c 5f6f 7574     np.copy(l_out
+00027ab0: 7075 745f 6d6f 6465 6c29 0a0a 2020 2020  put_model)..    
+00027ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027ad0: 2020 2020 2020 2020 6d47 505f 6f75 7470          mGP_outp
+00027ae0: 7574 5f6d 6f64 656c 2c20 7547 505f 6f75  ut_model, uGP_ou
+00027af0: 7470 7574 5f6d 6f64 656c 2c20 6c47 505f  tput_model, lGP_
+00027b00: 6f75 7470 7574 5f6d 6f64 656c 203d 206e  output_model = n
+00027b10: 702e 636f 7079 286d 5f6f 7574 7075 745f  p.copy(m_output_
+00027b20: 6d6f 6465 6c29 2c20 6e70 2e63 6f70 7928  model), np.copy(
+00027b30: 755f 6f75 7470 7574 5f6d 6f64 656c 292c  u_output_model),
+00027b40: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
 00027b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027b60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00027b70: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
-00027b80: 5d5b 2764 6574 6572 6d69 6e69 7374 6963  ]['deterministic
-00027b90: 5f75 6572 726f 7227 5d2c 2073 656c 662e  _uerror'], self.
-00027ba0: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
-00027bb0: 5d5b 2747 505f 7565 7272 6f72 275d 203d  ]['GP_uerror'] =
-00027bc0: 2075 4445 545f 6f75 7470 7574 5f6d 6f64   uDET_output_mod
-00027bd0: 656c 2c20 7547 505f 6f75 7470 7574 5f6d  el, uGP_output_m
-00027be0: 6f64 656c 0a20 2020 2020 2020 2020 2020  odel.           
-00027bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027c00: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-00027c10: 7275 6d65 6e74 5d5b 2764 6574 6572 6d69  rument]['determi
-00027c20: 6e69 7374 6963 5f6c 6572 726f 7227 5d2c  nistic_lerror'],
-00027c30: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-00027c40: 7275 6d65 6e74 5d5b 2747 505f 6c65 7272  rument]['GP_lerr
-00027c50: 6f72 275d 203d 206c 4445 545f 6f75 7470  or'] = lDET_outp
-00027c60: 7574 5f6d 6f64 656c 2c20 6c47 505f 6f75  ut_model, lGP_ou
-00027c70: 7470 7574 5f6d 6f64 656c 0a0a 2020 2020  tput_model..    
-00027c80: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00027c90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00027ca0: 2020 2020 2020 6f75 7470 7574 5f6d 6f64        output_mod
-00027cb0: 656c 203d 206e 702e 6e61 6e6d 6564 6961  el = np.nanmedia
-00027cc0: 6e28 6f75 7470 7574 5f6d 6f64 656c 5f73  n(output_model_s
-00027cd0: 616d 706c 6573 2c20 6178 6973 3d30 290a  amples, axis=0).
-00027ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027cf0: 2020 2020 6966 2073 656c 662e 676c 6f62      if self.glob
-00027d00: 616c 5f6d 6f64 656c 3a0a 2020 2020 2020  al_model:.      
-00027d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027d20: 2020 6966 2073 656c 662e 6469 6374 696f    if self.dictio
-00027d30: 6e61 7279 5b27 676c 6f62 616c 5f6d 6f64  nary['global_mod
-00027d40: 656c 275d 5b27 4750 4465 7472 656e 6427  el']['GPDetrend'
-00027d50: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-00027d60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00027d70: 656c 662e 6d6f 6465 6c5b 2764 6574 6572  elf.model['deter
-00027d80: 6d69 6e69 7374 6963 275d 2c20 7365 6c66  ministic'], self
-00027d90: 2e6d 6f64 656c 5b27 4750 275d 203d 206e  .model['GP'] = n
-00027da0: 702e 6e61 6e6d 6564 6961 6e28 6f75 7470  p.nanmedian(outp
-00027db0: 7574 5f6d 6f64 656c 4445 545f 7361 6d70  ut_modelDET_samp
-00027dc0: 6c65 732c 6178 6973 3d30 292c 205c 0a20  les,axis=0), \. 
-00027dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027b90: 2020 2020 2020 6e70 2e63 6f70 7928 6c5f        np.copy(l_
+00027ba0: 6f75 7470 7574 5f6d 6f64 656c 290a 2020  output_model).  
+00027bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027bc0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00027bd0: 616e 6765 286f 7574 7075 745f 6d6f 6465  ange(output_mode
+00027be0: 6c5f 7361 6d70 6c65 732e 7368 6170 655b  l_samples.shape[
+00027bf0: 315d 293a 0a20 2020 2020 2020 2020 2020  1]):.           
+00027c00: 2020 2020 2020 2020 2020 2020 2020 200a                 .
+00027c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027c20: 2020 2020 2020 2020 2020 2020 6d5f 6f75              m_ou
+00027c30: 7470 7574 5f6d 6f64 656c 5b69 5d2c 2075  tput_model[i], u
+00027c40: 5f6f 7574 7075 745f 6d6f 6465 6c5b 0a20  _output_model[. 
+00027c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027c60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00027c70: 5d2c 206c 5f6f 7574 7075 745f 6d6f 6465  ], l_output_mode
+00027c80: 6c5b 695d 203d 2067 6574 5f71 7561 6e74  l[i] = get_quant
+00027c90: 696c 6573 280a 2020 2020 2020 2020 2020  iles(.          
+00027ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027cb0: 2020 2020 2020 2020 2020 6f75 7470 7574            output
+00027cc0: 5f6d 6f64 656c 5f73 616d 706c 6573 5b3a  _model_samples[:
+00027cd0: 2c20 695d 2c20 616c 7068 613d 616c 7068  , i], alpha=alph
+00027ce0: 6129 0a20 2020 2020 2020 2020 2020 2020  a).             
+00027cf0: 2020 2020 2020 2020 2020 2020 2020 200a                 .
+00027d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d10: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00027d20: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
+00027d30: 6e73 7472 756d 656e 745d 5b27 4750 4465  nstrument]['GPDe
+00027d40: 7472 656e 6427 5d3a 0a0a 2020 2020 2020  trend']:..      
+00027d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d60: 2020 2020 2020 2020 2020 6d44 4554 5f6f            mDET_o
+00027d70: 7574 7075 745f 6d6f 6465 6c5b 695d 2c20  utput_model[i], 
+00027d80: 7544 4554 5f6f 7574 7075 745f 6d6f 6465  uDET_output_mode
+00027d90: 6c5b 695d 2c20 6c44 4554 5f6f 7574 7075  l[i], lDET_outpu
+00027da0: 745f 6d6f 6465 6c5b 695d 203d 2067 6574  t_model[i] = get
+00027db0: 5f71 7561 6e74 696c 6573 286f 7574 7075  _quantiles(outpu
+00027dc0: 745f 6d6f 6465 6c44 4554 5f73 616d 706c  t_modelDET_sampl
+00027dd0: 6573 5b3a 2c69 5d2c 2061 6c70 6861 203d  es[:,i], alpha =
+00027de0: 2061 6c70 6861 290a 2020 2020 2020 2020   alpha).        
 00027df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027e10: 2020 2020 2020 2020 2020 206e 702e 6e61             np.na
-00027e20: 6e6d 6564 6961 6e28 6f75 7470 7574 5f6d  nmedian(output_m
-00027e30: 6f64 656c 4750 5f73 616d 706c 6573 2c61  odelGP_samples,a
-00027e40: 7869 733d 3029 0a20 2020 2020 2020 2020  xis=0).         
-00027e50: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00027e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027e70: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00027e80: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
-00027e90: 7275 6d65 6e74 5d5b 2747 5044 6574 7265  rument]['GPDetre
-00027ea0: 6e64 275d 3a0a 2020 2020 2020 2020 2020  nd']:.          
-00027eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ec0: 2020 7365 6c66 2e6d 6f64 656c 5b69 6e73    self.model[ins
-00027ed0: 7472 756d 656e 745d 5b27 6465 7465 726d  trument]['determ
-00027ee0: 696e 6973 7469 6327 5d2c 2073 656c 662e  inistic'], self.
-00027ef0: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
-00027f00: 5d5b 2747 5027 5d20 3d20 6e70 2e6e 616e  ]['GP'] = np.nan
-00027f10: 6d65 6469 616e 286f 7574 7075 745f 6d6f  median(output_mo
-00027f20: 6465 6c44 4554 5f73 616d 706c 6573 2c61  delDET_samples,a
-00027f30: 7869 733d 3029 2c20 5c0a 2020 2020 2020  xis=0), \.      
-00027f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027f90: 2020 2020 6e70 2e6e 616e 6d65 6469 616e      np.nanmedian
-00027fa0: 286f 7574 7075 745f 6d6f 6465 6c47 505f  (output_modelGP_
-00027fb0: 7361 6d70 6c65 732c 6178 6973 3d30 290a  samples,axis=0).
-00027fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027fd0: 2023 2049 6620 7265 7475 726e 5f63 6f6d   # If return_com
-00027fe0: 706f 6e65 6e74 7320 6973 2074 7275 652c  ponents is true,
-00027ff0: 2067 656e 6572 6174 6520 7468 6520 6d65   generate the me
-00028000: 6469 616e 206d 6f64 656c 7320 666f 7220  dian models for 
-00028010: 6561 6368 2070 6172 7420 6f66 2074 6865  each part of the
-00028020: 2066 756c 6c20 6d6f 6465 6c3a 0a20 2020   full model:.   
-00028030: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00028040: 7265 7475 726e 5f63 6f6d 706f 6e65 6e74  return_component
-00028050: 733a 0a0a 2020 2020 2020 2020 2020 2020  s:..            
-00028060: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00028070: 6d6f 6465 6c74 7970 6520 3d3d 2027 6c63  modeltype == 'lc
-00028080: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-00028090: 2020 2020 2020 2020 200a 2020 2020 2020           .      
-000280a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000280b0: 2020 6966 2073 656c 662e 676c 6f62 616c    if self.global
-000280c0: 5f6d 6f64 656c 3a0a 2020 2020 2020 2020  _model:.        
+00027e00: 2020 2020 2020 2020 6d47 505f 6f75 7470          mGP_outp
+00027e10: 7574 5f6d 6f64 656c 5b69 5d2c 2075 4750  ut_model[i], uGP
+00027e20: 5f6f 7574 7075 745f 6d6f 6465 6c5b 695d  _output_model[i]
+00027e30: 2c20 6c47 505f 6f75 7470 7574 5f6d 6f64  , lGP_output_mod
+00027e40: 656c 5b69 5d20 3d20 6765 745f 7175 616e  el[i] = get_quan
+00027e50: 7469 6c65 7328 6f75 7470 7574 5f6d 6f64  tiles(output_mod
+00027e60: 656c 4750 5f73 616d 706c 6573 5b3a 2c69  elGP_samples[:,i
+00027e70: 5d2c 2061 6c70 6861 203d 2061 6c70 6861  ], alpha = alpha
+00027e80: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00027e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027ea0: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
+00027eb0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00027ec0: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
+00027ed0: 7374 7275 6d65 6e74 5d5b 2747 5044 6574  strument]['GPDet
+00027ee0: 7265 6e64 275d 3a0a 2020 2020 2020 2020  rend']:.        
+00027ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027f00: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
+00027f10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00027f20: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
+00027f30: 6d65 6e74 5d5b 2764 6574 6572 6d69 6e69  ment]['determini
+00027f40: 7374 6963 275d 2c20 7365 6c66 2e6d 6f64  stic'], self.mod
+00027f50: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
+00027f60: 4750 275d 203d 206d 4445 545f 6f75 7470  GP'] = mDET_outp
+00027f70: 7574 5f6d 6f64 656c 2c20 6d47 505f 6f75  ut_model, mGP_ou
+00027f80: 7470 7574 5f6d 6f64 656c 0a20 2020 2020  tput_model.     
+00027f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027fa0: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
+00027fb0: 6c5b 696e 7374 7275 6d65 6e74 5d5b 2764  l[instrument]['d
+00027fc0: 6574 6572 6d69 6e69 7374 6963 5f75 6572  eterministic_uer
+00027fd0: 726f 7227 5d2c 2073 656c 662e 6d6f 6465  ror'], self.mode
+00027fe0: 6c5b 696e 7374 7275 6d65 6e74 5d5b 2747  l[instrument]['G
+00027ff0: 505f 7565 7272 6f72 275d 203d 2075 4445  P_uerror'] = uDE
+00028000: 545f 6f75 7470 7574 5f6d 6f64 656c 2c20  T_output_model, 
+00028010: 7547 505f 6f75 7470 7574 5f6d 6f64 656c  uGP_output_model
+00028020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028030: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00028040: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+00028050: 6e74 5d5b 2764 6574 6572 6d69 6e69 7374  nt]['determinist
+00028060: 6963 5f6c 6572 726f 7227 5d2c 2073 656c  ic_lerror'], sel
+00028070: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+00028080: 6e74 5d5b 2747 505f 6c65 7272 6f72 275d  nt]['GP_lerror']
+00028090: 203d 206c 4445 545f 6f75 7470 7574 5f6d   = lDET_output_m
+000280a0: 6f64 656c 2c20 6c47 505f 6f75 7470 7574  odel, lGP_output
+000280b0: 5f6d 6f64 656c 0a0a 2020 2020 2020 2020  _model..        
+000280c0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
 000280d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000280e0: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
-000280f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00028100: 6f72 206b 2069 6e20 636f 6d70 6f6e 656e  or k in componen
-00028110: 7473 2e6b 6579 7328 293a 0a20 2020 2020  ts.keys():.     
+000280e0: 2020 6f75 7470 7574 5f6d 6f64 656c 203d    output_model =
+000280f0: 206e 702e 6e61 6e6d 6564 6961 6e28 6f75   np.nanmedian(ou
+00028100: 7470 7574 5f6d 6f64 656c 5f73 616d 706c  tput_model_sampl
+00028110: 6573 2c20 6178 6973 3d30 290a 2020 2020  es, axis=0).    
 00028120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028130: 2020 2020 2020 2020 2020 2066 6f72 2067             for g
-00028140: 696e 7374 7275 6d65 6e74 2069 6e20 696e  instrument in in
-00028150: 7374 7275 6d65 6e74 733a 0a20 2020 2020  struments:.     
-00028160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028170: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00028180: 6f6d 706f 6e65 6e74 735b 6b5d 5b67 696e  omponents[k][gin
-00028190: 7374 7275 6d65 6e74 5d20 3d20 6e70 2e6d  strument] = np.m
-000281a0: 6564 6961 6e28 636f 6d70 6f6e 656e 7473  edian(components
-000281b0: 5b6b 5d5b 6769 6e73 7472 756d 656e 745d  [k][ginstrument]
-000281c0: 2c61 7869 733d 3029 0a20 2020 2020 2020  ,axis=0).       
-000281d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000281e0: 2020 2020 2020 2020 2020 2020 200a 2020               .  
-000281f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028200: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00028130: 6966 2073 656c 662e 676c 6f62 616c 5f6d  if self.global_m
+00028140: 6f64 656c 3a0a 2020 2020 2020 2020 2020  odel:.          
+00028150: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00028160: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
+00028170: 5b27 676c 6f62 616c 5f6d 6f64 656c 275d  ['global_model']
+00028180: 5b27 4750 4465 7472 656e 6427 5d3a 0a20  ['GPDetrend']:. 
+00028190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000281a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000281b0: 6d6f 6465 6c5b 2764 6574 6572 6d69 6e69  model['determini
+000281c0: 7374 6963 275d 2c20 7365 6c66 2e6d 6f64  stic'], self.mod
+000281d0: 656c 5b27 4750 275d 203d 206e 702e 6e61  el['GP'] = np.na
+000281e0: 6e6d 6564 6961 6e28 6f75 7470 7574 5f6d  nmedian(output_m
+000281f0: 6f64 656c 4445 545f 7361 6d70 6c65 732c  odelDET_samples,
+00028200: 6178 6973 3d30 292c 205c 0a20 2020 2020  axis=0), \.     
 00028210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028220: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
+00028220: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00028230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028240: 2020 2066 6f72 206b 2069 6e20 636f 6d70     for k in comp
-00028250: 6f6e 656e 7473 2e6b 6579 7328 293a 0a20  onents.keys():. 
-00028260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028270: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00028280: 6f6d 706f 6e65 6e74 735b 6b5d 203d 206e  omponents[k] = n
-00028290: 702e 6d65 6469 616e 2863 6f6d 706f 6e65  p.median(compone
-000282a0: 6e74 735b 6b5d 2c61 7869 733d 3029 0a20  nts[k],axis=0). 
-000282b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000282c0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000282d0: 2020 2020 2020 2020 2020 2020 2020 200a                 .
-000282e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000282f0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00028300: 2073 656c 662e 6e75 6d62 6572 696e 673a   self.numbering:
-00028310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028320: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-00028330: 706f 6e65 6e74 735b 2770 272b 7374 7228  ponents['p'+str(
-00028340: 6929 5d20 3d20 6e70 2e6d 6564 6961 6e28  i)] = np.median(
-00028350: 636f 6d70 6f6e 656e 7473 5b27 7027 2b73  components['p'+s
-00028360: 7472 2869 295d 2c20 6178 6973 203d 2030  tr(i)], axis = 0
-00028370: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00028380: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
+00028240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028250: 2020 2020 2020 206e 702e 6e61 6e6d 6564         np.nanmed
+00028260: 6961 6e28 6f75 7470 7574 5f6d 6f64 656c  ian(output_model
+00028270: 4750 5f73 616d 706c 6573 2c61 7869 733d  GP_samples,axis=
+00028280: 3029 0a20 2020 2020 2020 2020 2020 2020  0).             
+00028290: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000282a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000282b0: 2020 2020 2069 6620 7365 6c66 2e64 6963       if self.dic
+000282c0: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
+000282d0: 6e74 5d5b 2747 5044 6574 7265 6e64 275d  nt]['GPDetrend']
+000282e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000282f0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00028300: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
+00028310: 656e 745d 5b27 6465 7465 726d 696e 6973  ent]['determinis
+00028320: 7469 6327 5d2c 2073 656c 662e 6d6f 6465  tic'], self.mode
+00028330: 6c5b 696e 7374 7275 6d65 6e74 5d5b 2747  l[instrument]['G
+00028340: 5027 5d20 3d20 6e70 2e6e 616e 6d65 6469  P'] = np.nanmedi
+00028350: 616e 286f 7574 7075 745f 6d6f 6465 6c44  an(output_modelD
+00028360: 4554 5f73 616d 706c 6573 2c61 7869 733d  ET_samples,axis=
+00028370: 3029 2c20 5c0a 2020 2020 2020 2020 2020  0), \.          
+00028380: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00028390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000283a0: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
-000283b0: 735b 2774 7265 6e64 275d 203d 206e 702e  s['trend'] = np.
-000283c0: 6d65 6469 616e 2863 6f6d 706f 6e65 6e74  median(component
-000283d0: 735b 2774 7265 6e64 275d 2c20 6178 6973  s['trend'], axis
-000283e0: 203d 2030 290a 2020 2020 2020 2020 2020   = 0).          
-000283f0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00028400: 6d70 6f6e 656e 7473 5b27 6b65 706c 6572  mponents['kepler
-00028410: 6961 6e27 5d20 3d20 6e70 2e6d 6564 6961  ian'] = np.media
-00028420: 6e28 636f 6d70 6f6e 656e 7473 5b27 6b65  n(components['ke
-00028430: 706c 6572 6961 6e27 5d2c 2061 7869 7320  plerian'], axis 
-00028440: 3d20 3029 0a0a 2020 2020 2020 2020 2020  = 0)..          
-00028450: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00028460: 2073 656c 662e 676c 6f62 616c 5f6d 6f64   self.global_mod
-00028470: 656c 3a0a 2020 2020 2020 2020 2020 2020  el:.            
-00028480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028490: 666f 7220 6769 6e73 7472 756d 656e 7420  for ginstrument 
-000284a0: 696e 2069 6e73 7472 756d 656e 7473 3a0a  in instruments:.
-000284b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000283a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000283b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000283c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000283d0: 6e70 2e6e 616e 6d65 6469 616e 286f 7574  np.nanmedian(out
+000283e0: 7075 745f 6d6f 6465 6c47 505f 7361 6d70  put_modelGP_samp
+000283f0: 6c65 732c 6178 6973 3d30 290a 0a20 2020  les,axis=0)..   
+00028400: 2020 2020 2020 2020 2020 2020 2023 2049               # I
+00028410: 6620 7265 7475 726e 5f63 6f6d 706f 6e65  f return_compone
+00028420: 6e74 7320 6973 2074 7275 652c 2067 656e  nts is true, gen
+00028430: 6572 6174 6520 7468 6520 6d65 6469 616e  erate the median
+00028440: 206d 6f64 656c 7320 666f 7220 6561 6368   models for each
+00028450: 2070 6172 7420 6f66 2074 6865 2066 756c   part of the ful
+00028460: 6c20 6d6f 6465 6c3a 0a20 2020 2020 2020  l model:.       
+00028470: 2020 2020 2020 2020 2069 6620 7265 7475           if retu
+00028480: 726e 5f63 6f6d 706f 6e65 6e74 733a 0a0a  rn_components:..
+00028490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000284a0: 2020 2020 6966 2073 656c 662e 6d6f 6465      if self.mode
+000284b0: 6c74 7970 6520 3d3d 2027 6c63 273a 0a20  ltype == 'lc':. 
 000284c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000284d0: 636f 6d70 6f6e 656e 7473 5b27 6d75 275d  components['mu']
-000284e0: 5b67 696e 7374 7275 6d65 6e74 5d20 3d20  [ginstrument] = 
-000284f0: 6e70 2e6d 6564 6961 6e28 636f 6d70 6f6e  np.median(compon
-00028500: 656e 7473 5b27 6d75 275d 5b67 696e 7374  ents['mu'][ginst
-00028510: 7275 6d65 6e74 5d29 0a0a 2020 2020 2020  rument])..      
+000284d0: 2020 2020 200a 2020 2020 2020 2020 2020       .          
+000284e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000284f0: 2073 656c 662e 676c 6f62 616c 5f6d 6f64   self.global_mod
+00028500: 656c 3a0a 2020 2020 2020 2020 2020 2020  el:.            
+00028510: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
 00028520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028530: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00028540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028550: 2020 2020 636f 6d70 6f6e 656e 7473 5b27      components['
-00028560: 6d75 275d 203d 206e 702e 6d65 6469 616e  mu'] = np.median
-00028570: 2863 6f6d 706f 6e65 6e74 735b 276d 7527  (components['mu'
-00028580: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00028590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028530: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
+00028540: 2069 6e20 636f 6d70 6f6e 656e 7473 2e6b   in components.k
+00028550: 6579 7328 293a 0a20 2020 2020 2020 2020  eys():.         
+00028560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028570: 2020 2020 2020 2066 6f72 2067 696e 7374         for ginst
+00028580: 7275 6d65 6e74 2069 6e20 696e 7374 7275  rument in instru
+00028590: 6d65 6e74 733a 0a20 2020 2020 2020 2020  ments:.         
 000285a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000285b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000285c0: 6178 6973 3d30 290a 2020 2020 2020 2020  axis=0).        
-000285d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000285e0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-000285f0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00028600: 2e6d 6f64 656c 7479 7065 203d 3d20 276c  .modeltype == 'l
-00028610: 6327 3a0a 2020 2020 2020 2020 2020 2020  c':.            
-00028620: 2020 2020 2020 2020 7365 6c66 2e67 656e          self.gen
-00028630: 6572 6174 655f 6c63 5f6d 6f64 656c 2870  erate_lc_model(p
-00028640: 6172 616d 6574 6572 5f76 616c 7565 732c  arameter_values,
-00028650: 2065 7661 6c75 6174 655f 6c63 3d54 7275   evaluate_lc=Tru
-00028660: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-00028670: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00028680: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00028690: 662e 6765 6e65 7261 7465 5f72 765f 6d6f  f.generate_rv_mo
-000286a0: 6465 6c28 7061 7261 6d65 7465 725f 7661  del(parameter_va
-000286b0: 6c75 6573 290a 0a20 2020 2020 2020 2020  lues)..         
-000286c0: 2020 2020 2020 2069 6620 7365 6c66 2e67         if self.g
-000286d0: 6c6f 6261 6c5f 6d6f 6465 6c3a 0a20 2020  lobal_model:.   
-000286e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000286f0: 2073 656c 662e 7265 7369 6475 616c 7320   self.residuals 
-00028700: 3d20 7365 6c66 2e79 202d 2073 656c 662e  = self.y - self.
-00028710: 6d6f 6465 6c5b 2767 6c6f 6261 6c27 5d0a  model['global'].
+000285b0: 2020 2020 2020 2020 2020 2063 6f6d 706f             compo
+000285c0: 6e65 6e74 735b 6b5d 5b67 696e 7374 7275  nents[k][ginstru
+000285d0: 6d65 6e74 5d20 3d20 6e70 2e6d 6564 6961  ment] = np.media
+000285e0: 6e28 636f 6d70 6f6e 656e 7473 5b6b 5d5b  n(components[k][
+000285f0: 6769 6e73 7472 756d 656e 745d 2c61 7869  ginstrument],axi
+00028600: 733d 3029 0a20 2020 2020 2020 2020 2020  s=0).           
+00028610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028620: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+00028630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028640: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00028650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028660: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
+00028670: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00028680: 6f72 206b 2069 6e20 636f 6d70 6f6e 656e  or k in componen
+00028690: 7473 2e6b 6579 7328 293a 0a20 2020 2020  ts.keys():.     
+000286a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000286b0: 2020 2020 2020 2020 2020 2063 6f6d 706f             compo
+000286c0: 6e65 6e74 735b 6b5d 203d 206e 702e 6d65  nents[k] = np.me
+000286d0: 6469 616e 2863 6f6d 706f 6e65 6e74 735b  dian(components[
+000286e0: 6b5d 2c61 7869 733d 3029 0a20 2020 2020  k],axis=0).     
+000286f0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00028700: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00028710: 2020 2020 2020 2020 2020 200a 2020 2020             .    
 00028720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028730: 2020 2020 7365 6c66 2e76 6172 6961 6e63      self.varianc
-00028740: 6573 203d 2073 656c 662e 6d6f 6465 6c5b  es = self.model[
-00028750: 2767 6c6f 6261 6c5f 7661 7269 616e 6365  'global_variance
-00028760: 7327 5d0a 2020 2020 2020 2020 2020 2020  s'].            
-00028770: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00028780: 6469 6374 696f 6e61 7279 5b27 676c 6f62  dictionary['glob
-00028790: 616c 5f6d 6f64 656c 275d 5b27 4750 4465  al_model']['GPDe
-000287a0: 7472 656e 6427 5d3a 0a20 2020 2020 2020  trend']:.       
+00028730: 2020 2020 666f 7220 6920 696e 2073 656c      for i in sel
+00028740: 662e 6e75 6d62 6572 696e 673a 0a20 2020  f.numbering:.   
+00028750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028760: 2020 2020 2020 2020 2063 6f6d 706f 6e65           compone
+00028770: 6e74 735b 2770 272b 7374 7228 6929 5d20  nts['p'+str(i)] 
+00028780: 3d20 6e70 2e6d 6564 6961 6e28 636f 6d70  = np.median(comp
+00028790: 6f6e 656e 7473 5b27 7027 2b73 7472 2869  onents['p'+str(i
+000287a0: 295d 2c20 6178 6973 203d 2030 290a 2020  )], axis = 0).  
 000287b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000287c0: 2073 656c 662e 6d6f 6465 6c5b 2764 6574   self.model['det
-000287d0: 6572 6d69 6e69 7374 6963 275d 2c20 7365  erministic'], se
-000287e0: 6c66 2e6d 6f64 656c 5b0a 2020 2020 2020  lf.model[.      
-000287f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028800: 2020 2020 2020 2747 5027 5d2c 206f 7574        'GP'], out
-00028810: 7075 745f 6d6f 6465 6c20 3d20 7365 6c66  put_model = self
-00028820: 2e67 6574 5f47 505f 706c 7573 5f64 6574  .get_GP_plus_det
-00028830: 6572 6d69 6e69 7374 6963 5f6d 6f64 656c  erministic_model
-00028840: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00028850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028860: 2020 7061 7261 6d65 7465 725f 7661 6c75    parameter_valu
-00028870: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
-00028880: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00028890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000288a0: 2020 2020 2020 6f75 7470 7574 5f6d 6f64        output_mod
-000288b0: 656c 203d 2073 656c 662e 6765 745f 4750  el = self.get_GP
-000288c0: 5f70 6c75 735f 6465 7465 726d 696e 6973  _plus_determinis
-000288d0: 7469 635f 6d6f 6465 6c28 0a20 2020 2020  tic_model(.     
-000288e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000288f0: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
-00028900: 5f76 616c 7565 7329 0a20 2020 2020 2020  _values).       
-00028910: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00028920: 7265 7475 726e 5f63 6f6d 706f 6e65 6e74  return_component
-00028930: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00028940: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00028950: 6c66 2e6d 6f64 656c 7479 7065 203d 3d20  lf.modeltype == 
-00028960: 276c 6327 3a0a 2020 2020 2020 2020 2020  'lc':.          
-00028970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028980: 2020 666f 7220 6769 6e73 7472 756d 656e    for ginstrumen
-00028990: 7420 696e 2069 6e73 7472 756d 656e 7473  t in instruments
-000289a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000289b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000289c0: 2020 7472 616e 7369 7420 3d20 302e 0a20    transit = 0.. 
+000287c0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+000287d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000287e0: 2020 2063 6f6d 706f 6e65 6e74 735b 2774     components['t
+000287f0: 7265 6e64 275d 203d 206e 702e 6d65 6469  rend'] = np.medi
+00028800: 616e 2863 6f6d 706f 6e65 6e74 735b 2774  an(components['t
+00028810: 7265 6e64 275d 2c20 6178 6973 203d 2030  rend'], axis = 0
+00028820: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00028830: 2020 2020 2020 2020 2020 636f 6d70 6f6e            compon
+00028840: 656e 7473 5b27 6b65 706c 6572 6961 6e27  ents['keplerian'
+00028850: 5d20 3d20 6e70 2e6d 6564 6961 6e28 636f  ] = np.median(co
+00028860: 6d70 6f6e 656e 7473 5b27 6b65 706c 6572  mponents['kepler
+00028870: 6961 6e27 5d2c 2061 7869 7320 3d20 3029  ian'], axis = 0)
+00028880: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00028890: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+000288a0: 662e 676c 6f62 616c 5f6d 6f64 656c 3a0a  f.global_model:.
+000288b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000288c0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000288d0: 6769 6e73 7472 756d 656e 7420 696e 2069  ginstrument in i
+000288e0: 6e73 7472 756d 656e 7473 3a0a 2020 2020  nstruments:.    
+000288f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028900: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+00028910: 6f6e 656e 7473 5b27 6d75 275d 5b67 696e  onents['mu'][gin
+00028920: 7374 7275 6d65 6e74 5d20 3d20 6e70 2e6d  strument] = np.m
+00028930: 6564 6961 6e28 636f 6d70 6f6e 656e 7473  edian(components
+00028940: 5b27 6d75 275d 5b67 696e 7374 7275 6d65  ['mu'][ginstrume
+00028950: 6e74 5d29 0a0a 2020 2020 2020 2020 2020  nt])..          
+00028960: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00028970: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00028980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028990: 636f 6d70 6f6e 656e 7473 5b27 6d75 275d  components['mu']
+000289a0: 203d 206e 702e 6d65 6469 616e 2863 6f6d   = np.median(com
+000289b0: 706f 6e65 6e74 735b 276d 7527 5d2c 0a20  ponents['mu'],. 
+000289c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000289d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000289e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000289f0: 6f72 2069 2069 6e20 7365 6c66 2e6e 756d  or i in self.num
-00028a00: 6265 7269 6e67 3a0a 2020 2020 2020 2020  bering:.        
-00028a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028a20: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-00028a30: 6f6e 656e 7473 5b27 7027 202b 2073 7472  onents['p' + str
-00028a40: 2869 295d 5b0a 2020 2020 2020 2020 2020  (i)][.          
+000289e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000289f0: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+00028a00: 3d30 290a 2020 2020 2020 2020 2020 2020  =0).            
+00028a10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00028a20: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
+00028a30: 2020 2020 2069 6620 7365 6c66 2e6d 6f64       if self.mod
+00028a40: 656c 7479 7065 203d 3d20 276c 6327 3a0a  eltype == 'lc':.
 00028a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028a60: 2020 2020 2020 2020 2020 2020 2020 6769                gi
-00028a70: 6e73 7472 756d 656e 745d 203d 2073 656c  nstrument] = sel
-00028a80: 662e 6d6f 6465 6c5b 6769 6e73 7472 756d  f.model[ginstrum
-00028a90: 656e 745d 5b0a 2020 2020 2020 2020 2020  ent][.          
-00028aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028ac0: 2020 2770 2720 2b20 7374 7228 6929 5d0a    'p' + str(i)].
-00028ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028af0: 2020 2020 7472 616e 7369 7420 2b3d 2028      transit += (
-00028b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028b20: 2020 2020 2020 2020 2063 6f6d 706f 6e65           compone
-00028b30: 6e74 735b 2770 2720 2b20 7374 7228 6929  nts['p' + str(i)
-00028b40: 5d5b 6769 6e73 7472 756d 656e 745d 202d  ][ginstrument] -
-00028b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028a60: 2020 2020 7365 6c66 2e67 656e 6572 6174      self.generat
+00028a70: 655f 6c63 5f6d 6f64 656c 2870 6172 616d  e_lc_model(param
+00028a80: 6574 6572 5f76 616c 7565 732c 2065 7661  eter_values, eva
+00028a90: 6c75 6174 655f 6c63 3d54 7275 6529 0a20  luate_lc=True). 
+00028aa0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00028ab0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00028ac0: 2020 2020 2020 2020 2073 656c 662e 6765           self.ge
+00028ad0: 6e65 7261 7465 5f72 765f 6d6f 6465 6c28  nerate_rv_model(
+00028ae0: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+00028af0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00028b00: 2020 2069 6620 7365 6c66 2e67 6c6f 6261     if self.globa
+00028b10: 6c5f 6d6f 6465 6c3a 0a20 2020 2020 2020  l_model:.       
+00028b20: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00028b30: 662e 7265 7369 6475 616c 7320 3d20 7365  f.residuals = se
+00028b40: 6c66 2e79 202d 2073 656c 662e 6d6f 6465  lf.y - self.mode
+00028b50: 6c5b 2767 6c6f 6261 6c27 5d0a 2020 2020  l['global'].    
 00028b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028b70: 2020 2020 2020 2020 2031 2e29 0a20 2020           1.).   
-00028b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028b90: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-00028ba0: 706f 6e65 6e74 735b 2774 7261 6e73 6974  ponents['transit
-00028bb0: 275d 5b0a 2020 2020 2020 2020 2020 2020  '][.            
-00028bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028bd0: 2020 2020 2020 2020 6769 6e73 7472 756d          ginstrum
-00028be0: 656e 745d 203d 2031 2e20 2b20 7472 616e  ent] = 1. + tran
-00028bf0: 7369 740a 2020 2020 2020 2020 2020 2020  sit.            
-00028c00: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00028c10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00028c20: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00028c30: 7220 6920 696e 2073 656c 662e 6e75 6d62  r i in self.numb
-00028c40: 6572 696e 673a 0a20 2020 2020 2020 2020  ering:.         
-00028c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028c60: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
-00028c70: 735b 2770 2720 2b20 7374 7228 6929 5d20  s['p' + str(i)] 
-00028c80: 3d20 7365 6c66 2e6d 6f64 656c 5b27 7027  = self.model['p'
-00028c90: 202b 0a20 2020 2020 2020 2020 2020 2020   +.             
-00028ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028b70: 7365 6c66 2e76 6172 6961 6e63 6573 203d  self.variances =
+00028b80: 2073 656c 662e 6d6f 6465 6c5b 2767 6c6f   self.model['glo
+00028b90: 6261 6c5f 7661 7269 616e 6365 7327 5d0a  bal_variances'].
+00028ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028bb0: 2020 2020 6966 2073 656c 662e 6469 6374      if self.dict
+00028bc0: 696f 6e61 7279 5b27 676c 6f62 616c 5f6d  ionary['global_m
+00028bd0: 6f64 656c 275d 5b27 4750 4465 7472 656e  odel']['GPDetren
+00028be0: 6427 5d3a 0a20 2020 2020 2020 2020 2020  d']:.           
+00028bf0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00028c00: 662e 6d6f 6465 6c5b 2764 6574 6572 6d69  f.model['determi
+00028c10: 6e69 7374 6963 275d 2c20 7365 6c66 2e6d  nistic'], self.m
+00028c20: 6f64 656c 5b0a 2020 2020 2020 2020 2020  odel[.          
+00028c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028c40: 2020 2747 5027 5d2c 206f 7574 7075 745f    'GP'], output_
+00028c50: 6d6f 6465 6c20 3d20 7365 6c66 2e67 6574  model = self.get
+00028c60: 5f47 505f 706c 7573 5f64 6574 6572 6d69  _GP_plus_determi
+00028c70: 6e69 7374 6963 5f6d 6f64 656c 280a 2020  nistic_model(.  
+00028c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028c90: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00028ca0: 7261 6d65 7465 725f 7661 6c75 6573 290a  rameter_values).
 00028cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028cd0: 2020 2020 2020 2020 2073 7472 2869 295d           str(i)]
-00028ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028cf0: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-00028d00: 706f 6e65 6e74 735b 2774 7265 6e64 275d  ponents['trend']
-00028d10: 203d 2073 656c 662e 6d6f 6465 6c5b 0a20   = self.model[. 
+00028cc0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00028cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ce0: 2020 6f75 7470 7574 5f6d 6f64 656c 203d    output_model =
+00028cf0: 2073 656c 662e 6765 745f 4750 5f70 6c75   self.get_GP_plu
+00028d00: 735f 6465 7465 726d 696e 6973 7469 635f  s_deterministic_
+00028d10: 6d6f 6465 6c28 0a20 2020 2020 2020 2020  model(.         
 00028d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028d30: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00028d40: 4b65 706c 6572 6961 6e2b 5472 656e 6427  Keplerian+Trend'
-00028d50: 5d20 2d20 7365 6c66 2e6d 6f64 656c 5b27  ] - self.model['
-00028d60: 4b65 706c 6572 6961 6e27 5d0a 2020 2020  Keplerian'].    
+00028d30: 2020 2070 6172 616d 6574 6572 5f76 616c     parameter_val
+00028d40: 7565 7329 0a20 2020 2020 2020 2020 2020  ues).           
+00028d50: 2020 2020 2020 2020 2069 6620 7265 7475           if retu
+00028d60: 726e 5f63 6f6d 706f 6e65 6e74 733a 0a20  rn_components:. 
 00028d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028d80: 2020 2020 2020 2020 636f 6d70 6f6e 656e          componen
-00028d90: 7473 5b27 6b65 706c 6572 6961 6e27 5d20  ts['keplerian'] 
-00028da0: 3d20 7365 6c66 2e6d 6f64 656c 5b27 4b65  = self.model['Ke
-00028db0: 706c 6572 6961 6e27 5d0a 2020 2020 2020  plerian'].      
-00028dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028dd0: 2020 2020 2020 666f 7220 6769 6e73 7472        for ginstr
-00028de0: 756d 656e 7420 696e 2069 6e73 7472 756d  ument in instrum
-00028df0: 656e 7473 3a0a 2020 2020 2020 2020 2020  ents:.          
-00028e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028e10: 2020 2020 2020 636f 6d70 6f6e 656e 7473        components
-00028e20: 5b27 6d75 275d 5b0a 2020 2020 2020 2020  ['mu'][.        
-00028e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028e40: 2020 2020 2020 2020 2020 2020 6769 6e73              gins
-00028e50: 7472 756d 656e 745d 203d 2070 6172 616d  trument] = param
-00028e60: 6574 6572 5f76 616c 7565 735b 276d 755f  eter_values['mu_
-00028e70: 2720 2b0a 2020 2020 2020 2020 2020 2020  ' +.            
-00028e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028d80: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
+00028d90: 6f64 656c 7479 7065 203d 3d20 276c 6327  odeltype == 'lc'
+00028da0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00028db0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00028dc0: 7220 6769 6e73 7472 756d 656e 7420 696e  r ginstrument in
+00028dd0: 2069 6e73 7472 756d 656e 7473 3a0a 2020   instruments:.  
+00028de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028df0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00028e00: 616e 7369 7420 3d20 302e 0a20 2020 2020  ansit = 0..     
+00028e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028e20: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00028e30: 2069 6e20 7365 6c66 2e6e 756d 6265 7269   in self.numberi
+00028e40: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
+00028e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028e60: 2020 2020 2020 2020 636f 6d70 6f6e 656e          componen
+00028e70: 7473 5b27 7027 202b 2073 7472 2869 295d  ts['p' + str(i)]
+00028e80: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
 00028e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028eb0: 2020 2020 2020 2020 696e 7374 7275 6d65          instrume
-00028ec0: 6e74 5d0a 2020 2020 2020 2020 2020 2020  nt].            
-00028ed0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00028ee0: 6769 6e73 7472 756d 656e 7420 696e 2069  ginstrument in i
-00028ef0: 6e73 7472 756d 656e 7473 3a0a 2020 2020  nstruments:.    
-00028f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028f10: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00028f20: 6c6d 5f62 6f6f 6c65 616e 5b67 696e 7374  lm_boolean[ginst
-00028f30: 7275 6d65 6e74 5d3a 0a20 2020 2020 2020  rument]:.       
+00028ea0: 2020 2020 2020 2020 2020 6769 6e73 7472            ginstr
+00028eb0: 756d 656e 745d 203d 2073 656c 662e 6d6f  ument] = self.mo
+00028ec0: 6465 6c5b 6769 6e73 7472 756d 656e 745d  del[ginstrument]
+00028ed0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00028ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ef0: 2020 2020 2020 2020 2020 2020 2020 2770                'p
+00028f00: 2720 2b20 7374 7228 6929 5d0a 2020 2020  ' + str(i)].    
+00028f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028f30: 7472 616e 7369 7420 2b3d 2028 0a20 2020  transit += (.   
 00028f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028f50: 2020 2020 2020 2020 2063 6f6d 706f 6e65           compone
-00028f60: 6e74 735b 276c 6d27 5d5b 6769 6e73 7472  nts['lm'][ginstr
-00028f70: 756d 656e 745d 203d 2073 656c 662e 6d6f  ument] = self.mo
-00028f80: 6465 6c5b 0a20 2020 2020 2020 2020 2020  del[.           
+00028f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028f60: 2020 2020 2063 6f6d 706f 6e65 6e74 735b       components[
+00028f70: 2770 2720 2b20 7374 7228 6929 5d5b 6769  'p' + str(i)][gi
+00028f80: 6e73 7472 756d 656e 745d 202d 0a20 2020  nstrument] -.   
 00028f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028fa0: 2020 2020 2020 2020 2067 696e 7374 7275           ginstru
-00028fb0: 6d65 6e74 5d5b 274c 4d27 5d0a 2020 2020  ment]['LM'].    
-00028fc0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00028fd0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00028fe0: 2020 2020 2020 7365 6c66 2e72 6573 6964        self.resid
-00028ff0: 7561 6c73 203d 2073 656c 662e 6461 7461  uals = self.data
-00029000: 5b69 6e73 7472 756d 656e 745d 202d 2073  [instrument] - s
-00029010: 656c 662e 6d6f 6465 6c5b 0a20 2020 2020  elf.model[.     
-00029020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029030: 2020 2069 6e73 7472 756d 656e 745d 5b27     instrument]['
-00029040: 6465 7465 726d 696e 6973 7469 6327 5d0a  deterministic'].
+00028fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028fb0: 2020 2020 2031 2e29 0a20 2020 2020 2020       1.).       
+00028fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028fd0: 2020 2020 2020 2020 2063 6f6d 706f 6e65           compone
+00028fe0: 6e74 735b 2774 7261 6e73 6974 275d 5b0a  nts['transit'][.
+00028ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029010: 2020 2020 6769 6e73 7472 756d 656e 745d      ginstrument]
+00029020: 203d 2031 2e20 2b20 7472 616e 7369 740a   = 1. + transit.
+00029030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029040: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
 00029050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029060: 2020 2020 6966 2073 656c 662e 6469 6374      if self.dict
-00029070: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
-00029080: 745d 5b27 4750 4465 7472 656e 6427 5d3a  t]['GPDetrend']:
-00029090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000290a0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-000290b0: 6465 6c5b 2764 6574 6572 6d69 6e69 7374  del['determinist
-000290c0: 6963 275d 2c20 7365 6c66 2e6d 6f64 656c  ic'], self.model
-000290d0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-000290e0: 2020 2020 2020 2020 2020 2020 2020 2747                'G
-000290f0: 5027 5d2c 206f 7574 7075 745f 6d6f 6465  P'], output_mode
-00029100: 6c20 3d20 7365 6c66 2e67 6574 5f47 505f  l = self.get_GP_
-00029110: 706c 7573 5f64 6574 6572 6d69 6e69 7374  plus_determinist
-00029120: 6963 5f6d 6f64 656c 280a 2020 2020 2020  ic_model(.      
-00029130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029140: 2020 2020 2020 2020 2020 7061 7261 6d65            parame
-00029150: 7465 725f 7661 6c75 6573 2c20 696e 7374  ter_values, inst
-00029160: 7275 6d65 6e74 3d69 6e73 7472 756d 656e  rument=instrumen
-00029170: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
-00029180: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00029190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000291a0: 2020 2020 206f 7574 7075 745f 6d6f 6465       output_mode
-000291b0: 6c20 3d20 7365 6c66 2e67 6574 5f47 505f  l = self.get_GP_
-000291c0: 706c 7573 5f64 6574 6572 6d69 6e69 7374  plus_determinist
-000291d0: 6963 5f6d 6f64 656c 280a 2020 2020 2020  ic_model(.      
-000291e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000291f0: 2020 2020 2020 7061 7261 6d65 7465 725f        parameter_
-00029200: 7661 6c75 6573 2c20 696e 7374 7275 6d65  values, instrume
-00029210: 6e74 3d69 6e73 7472 756d 656e 7429 0a20  nt=instrument). 
-00029220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029230: 2020 2069 6620 7265 7475 726e 5f63 6f6d     if return_com
-00029240: 706f 6e65 6e74 733a 0a20 2020 2020 2020  ponents:.       
-00029250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029260: 2069 6620 7365 6c66 2e6d 6f64 656c 7479   if self.modelty
-00029270: 7065 203d 3d20 276c 6327 3a0a 0a20 2020  pe == 'lc':..   
-00029280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029290: 2020 2020 2020 2020 2074 7261 6e73 6974           transit
-000292a0: 203d 2030 2e0a 2020 2020 2020 2020 2020   = 0..          
+00029060: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
+00029070: 696e 2073 656c 662e 6e75 6d62 6572 696e  in self.numberin
+00029080: 673a 0a20 2020 2020 2020 2020 2020 2020  g:.             
+00029090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000290a0: 2020 2063 6f6d 706f 6e65 6e74 735b 2770     components['p
+000290b0: 2720 2b20 7374 7228 6929 5d20 3d20 7365  ' + str(i)] = se
+000290c0: 6c66 2e6d 6f64 656c 5b27 7027 202b 0a20  lf.model['p' +. 
+000290d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000290e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000290f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029110: 2020 2020 2073 7472 2869 295d 0a20 2020       str(i)].   
+00029120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029130: 2020 2020 2020 2020 2063 6f6d 706f 6e65           compone
+00029140: 6e74 735b 2774 7265 6e64 275d 203d 2073  nts['trend'] = s
+00029150: 656c 662e 6d6f 6465 6c5b 0a20 2020 2020  elf.model[.     
+00029160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029170: 2020 2020 2020 2020 2020 2027 4b65 706c             'Kepl
+00029180: 6572 6961 6e2b 5472 656e 6427 5d20 2d20  erian+Trend'] - 
+00029190: 7365 6c66 2e6d 6f64 656c 5b27 4b65 706c  self.model['Kepl
+000291a0: 6572 6961 6e27 5d0a 2020 2020 2020 2020  erian'].        
+000291b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000291c0: 2020 2020 636f 6d70 6f6e 656e 7473 5b27      components['
+000291d0: 6b65 706c 6572 6961 6e27 5d20 3d20 7365  keplerian'] = se
+000291e0: 6c66 2e6d 6f64 656c 5b27 4b65 706c 6572  lf.model['Kepler
+000291f0: 6961 6e27 5d0a 2020 2020 2020 2020 2020  ian'].          
+00029200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029210: 2020 666f 7220 6769 6e73 7472 756d 656e    for ginstrumen
+00029220: 7420 696e 2069 6e73 7472 756d 656e 7473  t in instruments
+00029230: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00029240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029250: 2020 636f 6d70 6f6e 656e 7473 5b27 6d75    components['mu
+00029260: 275d 5b0a 2020 2020 2020 2020 2020 2020  '][.            
+00029270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029280: 2020 2020 2020 2020 6769 6e73 7472 756d          ginstrum
+00029290: 656e 745d 203d 2070 6172 616d 6574 6572  ent] = parameter
+000292a0: 5f76 616c 7565 735b 276d 755f 2720 2b0a  _values['mu_' +.
 000292b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000292c0: 2020 666f 7220 6920 696e 2073 656c 662e    for i in self.
-000292d0: 6e75 6d62 6572 696e 673a 0a20 2020 2020  numbering:.     
+000292c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000292d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000292e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000292f0: 2020 2020 2020 2020 2020 2063 6f6d 706f             compo
-00029300: 6e65 6e74 735b 2770 2720 2b0a 2020 2020  nents['p' +.    
-00029310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029330: 2020 2020 2020 2073 7472 2869 295d 203d         str(i)] =
-00029340: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-00029350: 7275 6d65 6e74 5d5b 0a20 2020 2020 2020  rument][.       
-00029360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029380: 2020 2020 2020 2020 2770 2720 2b20 7374          'p' + st
-00029390: 7228 6929 5d0a 2020 2020 2020 2020 2020  r(i)].          
-000293a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000293b0: 2020 2020 2020 7472 616e 7369 7420 2b3d        transit +=
-000293c0: 2028 636f 6d70 6f6e 656e 7473 5b27 7027   (components['p'
-000293d0: 202b 2073 7472 2869 295d 202d 2031 2e29   + str(i)] - 1.)
-000293e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000293f0: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-00029400: 706f 6e65 6e74 735b 2774 7261 6e73 6974  ponents['transit
-00029410: 275d 203d 2031 2e20 2b20 7472 616e 7369  '] = 1. + transi
-00029420: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-00029430: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00029440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029450: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00029460: 6920 696e 2073 656c 662e 6e75 6d62 6572  i in self.number
-00029470: 696e 673a 0a20 2020 2020 2020 2020 2020  ing:.           
-00029480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029490: 2020 2020 2063 6f6d 706f 6e65 6e74 735b       components[
-000294a0: 2770 2720 2b20 7374 7228 6929 5d20 3d20  'p' + str(i)] = 
-000294b0: 7365 6c66 2e6d 6f64 656c 5b27 7027 202b  self.model['p' +
-000294c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000292f0: 2020 2020 696e 7374 7275 6d65 6e74 5d0a      instrument].
+00029300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029310: 2020 2020 2020 2020 666f 7220 6769 6e73          for gins
+00029320: 7472 756d 656e 7420 696e 2069 6e73 7472  trument in instr
+00029330: 756d 656e 7473 3a0a 2020 2020 2020 2020  uments:.        
+00029340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029350: 2020 2020 6966 2073 656c 662e 6c6d 5f62      if self.lm_b
+00029360: 6f6f 6c65 616e 5b67 696e 7374 7275 6d65  oolean[ginstrume
+00029370: 6e74 5d3a 0a20 2020 2020 2020 2020 2020  nt]:.           
+00029380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029390: 2020 2020 2063 6f6d 706f 6e65 6e74 735b       components[
+000293a0: 276c 6d27 5d5b 6769 6e73 7472 756d 656e  'lm'][ginstrumen
+000293b0: 745d 203d 2073 656c 662e 6d6f 6465 6c5b  t] = self.model[
+000293c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000293d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000293e0: 2020 2020 2067 696e 7374 7275 6d65 6e74       ginstrument
+000293f0: 5d5b 274c 4d27 5d0a 2020 2020 2020 2020  ]['LM'].        
+00029400: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00029410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029420: 2020 7365 6c66 2e72 6573 6964 7561 6c73    self.residuals
+00029430: 203d 2073 656c 662e 6461 7461 5b69 6e73   = self.data[ins
+00029440: 7472 756d 656e 745d 202d 2073 656c 662e  trument] - self.
+00029450: 6d6f 6465 6c5b 0a20 2020 2020 2020 2020  model[.         
+00029460: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00029470: 6e73 7472 756d 656e 745d 5b27 6465 7465  nstrument]['dete
+00029480: 726d 696e 6973 7469 6327 5d0a 2020 2020  rministic'].    
+00029490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000294a0: 6966 2073 656c 662e 6469 6374 696f 6e61  if self.dictiona
+000294b0: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
+000294c0: 4750 4465 7472 656e 6427 5d3a 0a20 2020  GPDetrend']:.   
 000294d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000294e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000294f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029500: 2020 2020 2020 2073 7472 2869 295d 0a20         str(i)]. 
+000294e0: 2020 2020 2073 656c 662e 6d6f 6465 6c5b       self.model[
+000294f0: 2764 6574 6572 6d69 6e69 7374 6963 275d  'deterministic']
+00029500: 2c20 7365 6c66 2e6d 6f64 656c 5b0a 2020  , self.model[.  
 00029510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029520: 2020 2020 2020 2020 2020 2063 6f6d 706f             compo
-00029530: 6e65 6e74 735b 2774 7265 6e64 275d 203d  nents['trend'] =
-00029540: 2073 656c 662e 6d6f 6465 6c5b 0a20 2020   self.model[.   
-00029550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029560: 2020 2020 2020 2020 2020 2020 2027 4b65               'Ke
-00029570: 706c 6572 6961 6e2b 5472 656e 6427 5d20  plerian+Trend'] 
-00029580: 2d20 7365 6c66 2e6d 6f64 656c 5b27 4b65  - self.model['Ke
-00029590: 706c 6572 6961 6e27 5d0a 2020 2020 2020  plerian'].      
-000295a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000295b0: 2020 2020 2020 636f 6d70 6f6e 656e 7473        components
-000295c0: 5b27 6b65 706c 6572 6961 6e27 5d20 3d20  ['keplerian'] = 
-000295d0: 7365 6c66 2e6d 6f64 656c 5b27 4b65 706c  self.model['Kepl
-000295e0: 6572 6961 6e27 5d0a 2020 2020 2020 2020  erian'].        
-000295f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029600: 2020 2020 636f 6d70 6f6e 656e 7473 5b27      components['
-00029610: 6d75 275d 203d 2070 6172 616d 6574 6572  mu'] = parameter
-00029620: 5f76 616c 7565 735b 276d 755f 2720 2b0a  _values['mu_' +.
-00029630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029670: 696e 7374 7275 6d65 6e74 5d0a 2020 2020  instrument].    
-00029680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029690: 2020 2020 6966 2073 656c 662e 6c6d 5f62      if self.lm_b
-000296a0: 6f6f 6c65 616e 5b69 6e73 7472 756d 656e  oolean[instrumen
-000296b0: 745d 3a0a 2020 2020 2020 2020 2020 2020  t]:.            
+00029520: 2020 2020 2020 2020 2020 2747 5027 5d2c            'GP'],
+00029530: 206f 7574 7075 745f 6d6f 6465 6c20 3d20   output_model = 
+00029540: 7365 6c66 2e67 6574 5f47 505f 706c 7573  self.get_GP_plus
+00029550: 5f64 6574 6572 6d69 6e69 7374 6963 5f6d  _deterministic_m
+00029560: 6f64 656c 280a 2020 2020 2020 2020 2020  odel(.          
+00029570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029580: 2020 2020 2020 7061 7261 6d65 7465 725f        parameter_
+00029590: 7661 6c75 6573 2c20 696e 7374 7275 6d65  values, instrume
+000295a0: 6e74 3d69 6e73 7472 756d 656e 7429 0a20  nt=instrument). 
+000295b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000295c0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000295d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000295e0: 206f 7574 7075 745f 6d6f 6465 6c20 3d20   output_model = 
+000295f0: 7365 6c66 2e67 6574 5f47 505f 706c 7573  self.get_GP_plus
+00029600: 5f64 6574 6572 6d69 6e69 7374 6963 5f6d  _deterministic_m
+00029610: 6f64 656c 280a 2020 2020 2020 2020 2020  odel(.          
+00029620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029630: 2020 7061 7261 6d65 7465 725f 7661 6c75    parameter_valu
+00029640: 6573 2c20 696e 7374 7275 6d65 6e74 3d69  es, instrument=i
+00029650: 6e73 7472 756d 656e 7429 0a20 2020 2020  nstrument).     
+00029660: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00029670: 6620 7265 7475 726e 5f63 6f6d 706f 6e65  f return_compone
+00029680: 6e74 733a 0a20 2020 2020 2020 2020 2020  nts:.           
+00029690: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000296a0: 7365 6c66 2e6d 6f64 656c 7479 7065 203d  self.modeltype =
+000296b0: 3d20 276c 6327 3a0a 0a20 2020 2020 2020  = 'lc':..       
 000296c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000296d0: 636f 6d70 6f6e 656e 7473 5b27 6c6d 275d  components['lm']
-000296e0: 203d 2073 656c 662e 6d6f 6465 6c5b 696e   = self.model[in
-000296f0: 7374 7275 6d65 6e74 5d5b 274c 4d27 5d0a  strument]['LM'].
-00029700: 2020 2020 2020 2020 656c 7365 3a0a 0a20          else:.. 
-00029710: 2020 2020 2020 2020 2020 2078 203d 2073             x = s
-00029720: 656c 662e 6576 616c 7561 7465 5f6d 6f64  elf.evaluate_mod
-00029730: 656c 2869 6e73 7472 756d 656e 7420 3d20  el(instrument = 
-00029740: 696e 7374 7275 6d65 6e74 2c20 7061 7261  instrument, para
-00029750: 6d65 7465 725f 7661 6c75 6573 203d 2073  meter_values = s
-00029760: 656c 662e 706f 7374 6572 696f 7273 2c20  elf.posteriors, 
-00029770: 616c 6c5f 7361 6d70 6c65 7320 3d20 616c  all_samples = al
-00029780: 6c5f 7361 6d70 6c65 732c 0a20 2020 2020  l_samples,.     
-00029790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000296d0: 2020 2020 2074 7261 6e73 6974 203d 2030       transit = 0
+000296e0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000296f0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00029700: 7220 6920 696e 2073 656c 662e 6e75 6d62  r i in self.numb
+00029710: 6572 696e 673a 0a20 2020 2020 2020 2020  ering:.         
+00029720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029730: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
+00029740: 735b 2770 2720 2b0a 2020 2020 2020 2020  s['p' +.        
+00029750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029770: 2020 2073 7472 2869 295d 203d 2073 656c     str(i)] = sel
+00029780: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+00029790: 6e74 5d5b 0a20 2020 2020 2020 2020 2020  nt][.           
 000297a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000297b0: 2020 2020 2020 2020 206e 7361 6d70 6c65           nsample
-000297c0: 7320 3d20 6e73 616d 706c 6573 2c20 7265  s = nsamples, re
-000297d0: 7475 726e 5f73 616d 706c 6573 203d 2072  turn_samples = r
-000297e0: 6574 7572 6e5f 7361 6d70 6c65 732c 2074  eturn_samples, t
-000297f0: 203d 2074 2c20 4750 7265 6772 6573 736f   = t, GPregresso
-00029800: 7273 203d 2047 5072 6567 7265 7373 6f72  rs = GPregressor
-00029810: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+000297b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000297c0: 2020 2020 2770 2720 2b20 7374 7228 6929      'p' + str(i)
+000297d0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000297e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000297f0: 2020 7472 616e 7369 7420 2b3d 2028 636f    transit += (co
+00029800: 6d70 6f6e 656e 7473 5b27 7027 202b 2073  mponents['p' + s
+00029810: 7472 2869 295d 202d 2031 2e29 0a20 2020  tr(i)] - 1.).   
 00029820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029840: 204c 4d72 6567 7265 7373 6f72 7320 3d20   LMregressors = 
-00029850: 4c4d 7265 6772 6573 736f 7273 2c20 7265  LMregressors, re
-00029860: 7475 726e 5f65 7272 203d 2072 6574 7572  turn_err = retur
-00029870: 6e5f 6572 722c 2072 6574 7572 6e5f 636f  n_err, return_co
-00029880: 6d70 6f6e 656e 7473 203d 2072 6574 7572  mponents = retur
-00029890: 6e5f 636f 6d70 6f6e 656e 7473 2c20 616c  n_components, al
-000298a0: 7068 6120 3d20 616c 7068 612c 0a20 2020  pha = alpha,.   
-000298b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029830: 2020 2020 2020 2020 2063 6f6d 706f 6e65           compone
+00029840: 6e74 735b 2774 7261 6e73 6974 275d 203d  nts['transit'] =
+00029850: 2031 2e20 2b20 7472 616e 7369 740a 2020   1. + transit.  
+00029860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029870: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00029880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029890: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+000298a0: 2073 656c 662e 6e75 6d62 6572 696e 673a   self.numbering:
+000298b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000298c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000298d0: 2020 2020 2020 2020 2020 2065 7661 6c75             evalu
-000298e0: 6174 655f 7472 616e 7369 7420 3d20 6576  ate_transit = ev
-000298f0: 616c 7561 7465 5f74 7261 6e73 6974 290a  aluate_transit).
-00029900: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-00029910: 2020 2020 2020 2020 2069 6620 7265 7475           if retu
-00029920: 726e 5f73 616d 706c 6573 3a0a 2020 2020  rn_samples:.    
-00029930: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-00029940: 6574 7572 6e5f 6572 723a 0a20 2020 2020  eturn_err:.     
-00029950: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00029960: 6620 7265 7475 726e 5f63 6f6d 706f 6e65  f return_compone
-00029970: 6e74 733a 0a20 2020 2020 2020 2020 2020  nts:.           
-00029980: 2020 2020 2020 2020 2020 2020 206f 7574               out
-00029990: 7075 745f 6d6f 6465 6c5f 7361 6d70 6c65  put_model_sample
-000299a0: 732c 206d 5f6f 7574 7075 745f 6d6f 6465  s, m_output_mode
-000299b0: 6c2c 2075 5f6f 7574 7075 745f 6d6f 6465  l, u_output_mode
-000299c0: 6c2c 206c 5f6f 7574 7075 745f 6d6f 6465  l, l_output_mode
-000299d0: 6c2c 2063 6f6d 706f 6e65 6e74 7320 3d20  l, components = 
-000299e0: 780a 2020 2020 2020 2020 2020 2020 2020  x.              
-000299f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00029a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029a10: 2020 2020 6f75 7470 7574 5f6d 6f64 656c      output_model
-00029a20: 5f73 616d 706c 6573 2c20 6d5f 6f75 7470  _samples, m_outp
-00029a30: 7574 5f6d 6f64 656c 2c20 755f 6f75 7470  ut_model, u_outp
-00029a40: 7574 5f6d 6f64 656c 2c20 6c5f 6f75 7470  ut_model, l_outp
-00029a50: 7574 5f6d 6f64 656c 203d 2078 0a20 2020  ut_model = x.   
-00029a60: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00029a70: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00029a80: 2020 2020 2020 2069 6620 7265 7475 726e         if return
-00029a90: 5f63 6f6d 706f 6e65 6e74 733a 0a20 2020  _components:.   
-00029aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ab0: 2020 2020 206f 7574 7075 745f 6d6f 6465       output_mode
-00029ac0: 6c5f 7361 6d70 6c65 732c 206f 7574 7075  l_samples, outpu
-00029ad0: 745f 6d6f 6465 6c2c 2063 6f6d 706f 6e65  t_model, compone
-00029ae0: 6e74 7320 3d20 780a 2020 2020 2020 2020  nts = x.        
-00029af0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00029b00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00029b10: 2020 2020 2020 2020 2020 6f75 7470 7574            output
-00029b20: 5f6d 6f64 656c 5f73 616d 706c 6573 2c20  _model_samples, 
-00029b30: 6f75 7470 7574 5f6d 6f64 656c 203d 2078  output_model = x
-00029b40: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00029b50: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00029b60: 2020 2069 6620 7265 7475 726e 5f65 7272     if return_err
-00029b70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00029b80: 2020 2020 2020 6966 2072 6574 7572 6e5f        if return_
-00029b90: 636f 6d70 6f6e 656e 7473 3a0a 2020 2020  components:.    
-00029ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029bb0: 2020 2020 6d5f 6f75 7470 7574 5f6d 6f64      m_output_mod
-00029bc0: 656c 2c20 755f 6f75 7470 7574 5f6d 6f64  el, u_output_mod
-00029bd0: 656c 2c20 6c5f 6f75 7470 7574 5f6d 6f64  el, l_output_mod
-00029be0: 656c 2c20 636f 6d70 6f6e 656e 7473 203d  el, components =
-00029bf0: 2078 0a20 2020 2020 2020 2020 2020 2020   x.             
-00029c00: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00029c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c20: 2020 2020 206d 5f6f 7574 7075 745f 6d6f       m_output_mo
-00029c30: 6465 6c2c 2075 5f6f 7574 7075 745f 6d6f  del, u_output_mo
-00029c40: 6465 6c2c 206c 5f6f 7574 7075 745f 6d6f  del, l_output_mo
-00029c50: 6465 6c20 3d20 780a 2020 2020 2020 2020  del = x.        
-00029c60: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00029c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c80: 2020 6966 2072 6574 7572 6e5f 636f 6d70    if return_comp
-00029c90: 6f6e 656e 7473 3a0a 2020 2020 2020 2020  onents:.        
-00029ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029cb0: 6f75 7470 7574 5f6d 6f64 656c 2c20 636f  output_model, co
-00029cc0: 6d70 6f6e 656e 7473 203d 2078 0a20 2020  mponents = x.   
-00029cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ce0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00029cf0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00029d00: 7574 7075 745f 6d6f 6465 6c20 3d20 780a  utput_model = x.
-00029d10: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00029d20: 7365 6c66 2e67 6c6f 6261 6c5f 6d6f 6465  self.global_mode
-00029d30: 6c3a 0a20 2020 2020 2020 2020 2020 2023  l:.            #
-00029d40: 2052 6574 7572 6e20 6f72 6967 696e 616c   Return original
-00029d50: 2069 6e61 6d65 7320 6261 636b 2069 6e20   inames back in 
-00029d60: 6361 7365 206f 6620 6e6f 6e2d 676c 6f62  case of non-glob
-00029d70: 616c 206d 6f64 656c 733a 0a20 2020 2020  al models:.     
-00029d80: 2020 2020 2020 2073 656c 662e 696e 616d         self.inam
-00029d90: 6573 203d 206f 7269 6769 6e61 6c5f 696e  es = original_in
-00029da0: 616d 6573 0a0a 2020 2020 2020 2020 6966  ames..        if
-00029db0: 2065 7661 6c75 6174 655f 7472 616e 7369   evaluate_transi
-00029dc0: 743a 0a20 2020 2020 2020 2020 2020 2023  t:.            #
-00029dd0: 2054 7572 6e20 4c4d 2061 6e64 2047 5073   Turn LM and GPs
-00029de0: 2062 6163 6b20 6f6e 3a0a 2020 2020 2020   back on:.      
-00029df0: 2020 2020 2020 7365 6c66 2e6c 6d5f 626f        self.lm_bo
-00029e00: 6f6c 6561 6e5b 696e 7374 7275 6d65 6e74  olean[instrument
-00029e10: 5d20 3d20 7472 7565 5f6c 6d5f 626f 6f6c  ] = true_lm_bool
-00029e20: 6561 6e0a 2020 2020 2020 2020 2020 2020  ean.            
-00029e30: 6966 2073 656c 662e 676c 6f62 616c 5f6d  if self.global_m
-00029e40: 6f64 656c 3a0a 2020 2020 2020 2020 2020  odel:.          
-00029e50: 2020 2020 2020 7365 6c66 2e64 6963 7469        self.dicti
-00029e60: 6f6e 6172 795b 2767 6c6f 6261 6c5f 6d6f  onary['global_mo
-00029e70: 6465 6c27 5d5b 2747 5044 6574 7265 6e64  del']['GPDetrend
-00029e80: 275d 203d 2074 7275 655f 6770 5f62 6f6f  '] = true_gp_boo
-00029e90: 6c65 616e 0a20 2020 2020 2020 2020 2020  lean.           
-00029ea0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00029eb0: 2020 2020 2020 2073 656c 662e 6469 6374         self.dict
-00029ec0: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
-00029ed0: 745d 5b27 4750 4465 7472 656e 6427 5d20  t]['GPDetrend'] 
-00029ee0: 3d20 7472 7565 5f67 705f 626f 6f6c 6561  = true_gp_boolea
-00029ef0: 6e0a 0a20 2020 2020 2020 2069 6620 7265  n..        if re
-00029f00: 7475 726e 5f73 616d 706c 6573 3a0a 2020  turn_samples:.  
-00029f10: 2020 2020 2020 2020 2020 6966 2072 6574            if ret
-00029f20: 7572 6e5f 6572 723a 0a20 2020 2020 2020  urn_err:.       
-00029f30: 2020 2020 2020 2020 2069 6620 7265 7475           if retu
-00029f40: 726e 5f63 6f6d 706f 6e65 6e74 733a 0a20  rn_components:. 
-00029f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029f60: 2020 2072 6574 7572 6e20 6f75 7470 7574     return output
-00029f70: 5f6d 6f64 656c 5f73 616d 706c 6573 2c20  _model_samples, 
-00029f80: 6d5f 6f75 7470 7574 5f6d 6f64 656c 2c20  m_output_model, 
-00029f90: 755f 6f75 7470 7574 5f6d 6f64 656c 2c20  u_output_model, 
-00029fa0: 6c5f 6f75 7470 7574 5f6d 6f64 656c 2c20  l_output_model, 
-00029fb0: 636f 6d70 6f6e 656e 7473 0a20 2020 2020  components.     
-00029fc0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00029fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029fe0: 2020 2020 2072 6574 7572 6e20 6f75 7470       return outp
-00029ff0: 7574 5f6d 6f64 656c 5f73 616d 706c 6573  ut_model_samples
-0002a000: 2c20 6d5f 6f75 7470 7574 5f6d 6f64 656c  , m_output_model
-0002a010: 2c20 755f 6f75 7470 7574 5f6d 6f64 656c  , u_output_model
-0002a020: 2c20 6c5f 6f75 7470 7574 5f6d 6f64 656c  , l_output_model
-0002a030: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0002a040: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0002a050: 2020 2069 6620 7265 7475 726e 5f63 6f6d     if return_com
-0002a060: 706f 6e65 6e74 733a 0a20 2020 2020 2020  ponents:.       
-0002a070: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0002a080: 7572 6e20 6f75 7470 7574 5f6d 6f64 656c  urn output_model
-0002a090: 5f73 616d 706c 6573 2c20 6f75 7470 7574  _samples, output
-0002a0a0: 5f6d 6f64 656c 2c20 636f 6d70 6f6e 656e  _model, componen
-0002a0b0: 7473 0a20 2020 2020 2020 2020 2020 2020  ts.             
-0002a0c0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0002a0d0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0002a0e0: 7572 6e20 6f75 7470 7574 5f6d 6f64 656c  urn output_model
-0002a0f0: 5f73 616d 706c 6573 2c20 6f75 7470 7574  _samples, output
-0002a100: 5f6d 6f64 656c 0a20 2020 2020 2020 2065  _model.        e
-0002a110: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0002a120: 2069 6620 7265 7475 726e 5f65 7272 3a0a   if return_err:.
-0002a130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a140: 6966 2072 6574 7572 6e5f 636f 6d70 6f6e  if return_compon
-0002a150: 656e 7473 3a0a 2020 2020 2020 2020 2020  ents:.          
-0002a160: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0002a170: 206d 5f6f 7574 7075 745f 6d6f 6465 6c2c   m_output_model,
-0002a180: 2075 5f6f 7574 7075 745f 6d6f 6465 6c2c   u_output_model,
-0002a190: 206c 5f6f 7574 7075 745f 6d6f 6465 6c2c   l_output_model,
-0002a1a0: 2063 6f6d 706f 6e65 6e74 730a 2020 2020   components.    
-0002a1b0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0002a1c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002a1d0: 2020 2020 2020 7265 7475 726e 206d 5f6f        return m_o
-0002a1e0: 7574 7075 745f 6d6f 6465 6c2c 2075 5f6f  utput_model, u_o
-0002a1f0: 7574 7075 745f 6d6f 6465 6c2c 206c 5f6f  utput_model, l_o
-0002a200: 7574 7075 745f 6d6f 6465 6c0a 2020 2020  utput_model.    
-0002a210: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002a220: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0002a230: 2072 6574 7572 6e5f 636f 6d70 6f6e 656e   return_componen
-0002a240: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-0002a250: 2020 2020 2020 2020 7265 7475 726e 206f          return o
-0002a260: 7574 7075 745f 6d6f 6465 6c2c 2063 6f6d  utput_model, com
-0002a270: 706f 6e65 6e74 730a 2020 2020 2020 2020  ponents.        
-0002a280: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002a290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a2a0: 2020 7265 7475 726e 206f 7574 7075 745f    return output_
-0002a2b0: 6d6f 6465 6c0a 0a20 2020 2064 6566 2067  model..    def g
-0002a2c0: 656e 6572 6174 655f 6c63 5f6d 6f64 656c  enerate_lc_model
-0002a2d0: 2873 656c 662c 0a20 2020 2020 2020 2020  (self,.         
-0002a2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a2f0: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
-0002a300: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0002a310: 2020 2020 2020 2020 2020 2020 2065 7661               eva
-0002a320: 6c75 6174 655f 676c 6f62 616c 5f65 7272  luate_global_err
-0002a330: 6f72 733d 5472 7565 2c0a 2020 2020 2020  ors=True,.      
-0002a340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a350: 2020 2020 6576 616c 7561 7465 5f6c 633d      evaluate_lc=
-0002a360: 4661 6c73 6529 3a0a 0a20 2020 2020 2020  False):..       
-0002a370: 2073 656c 662e 6d6f 6465 6c4f 4b20 3d20   self.modelOK = 
-0002a380: 5472 7565 0a0a 2020 2020 2020 2020 2320  True..        # 
-0002a390: 4966 2054 5456 2070 6172 616d 6574 7269  If TTV parametri
-0002a3a0: 7a61 7469 6f6e 2069 7320 2754 2720 666f  zation is 'T' fo
-0002a3b0: 7220 706c 616e 6574 2069 2c20 7374 6f72  r planet i, stor
-0002a3c0: 6520 7472 616e 7369 7420 7469 6d65 732e  e transit times.
-0002a3d0: 2043 6865 636b 206f 6e6c 7920 6966 2074   Check only if t
-0002a3e0: 6865 206e 6f54 666c 6167 2069 7320 4661  he noTflag is Fa
-0002a3f0: 6c73 6520 2877 6869 6368 2069 6d70 6c69  lse (which impli
-0002a400: 6573 0a20 2020 2020 2020 2023 2061 7420  es.        # at 
-0002a410: 6c65 6173 7420 6f6e 6520 706c 616e 6574  least one planet
-0002a420: 2075 7365 7320 7468 6520 542d 7061 7261   uses the T-para
-0002a430: 6d65 7472 697a 6174 696f 6e29 3a0a 2020  metrization):.  
-0002a440: 2020 2020 2020 6966 2073 656c 662e 5466        if self.Tf
-0002a450: 6c61 673a 0a0a 2020 2020 2020 2020 2020  lag:..          
-0002a460: 2020 706c 616e 6574 5f74 302c 2070 6c61    planet_t0, pla
-0002a470: 6e65 745f 5020 3d20 7b7d 2c20 7b7d 0a20  net_P = {}, {}. 
-0002a480: 2020 2020 2020 2020 2020 2061 6c6c 5f54             all_T
-0002a490: 732c 2061 6c6c 5f6e 7320 3d20 7b7d 2c20  s, all_ns = {}, 
-0002a4a0: 7b7d 0a0a 2020 2020 2020 2020 2020 2020  {}..            
-0002a4b0: 666f 7220 6920 696e 2073 656c 662e 6e75  for i in self.nu
-0002a4c0: 6d62 6572 696e 673a 0a0a 2020 2020 2020  mbering:..      
-0002a4d0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0002a4e0: 662e 5470 6172 616d 6574 7269 7a61 7469  f.Tparametrizati
-0002a4f0: 6f6e 5b69 5d3a 0a0a 2020 2020 2020 2020  on[i]:..        
-0002a500: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
-0002a510: 5473 5b69 5d2c 2061 6c6c 5f6e 735b 695d  Ts[i], all_ns[i]
-0002a520: 203d 206e 702e 6172 7261 7928 5b5d 292c   = np.array([]),
-0002a530: 206e 702e 6172 7261 7928 5b5d 290a 0a20   np.array([]).. 
-0002a540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a550: 2020 2066 6f72 2069 6e73 7472 756d 656e     for instrumen
-0002a560: 7420 696e 2073 656c 662e 696e 616d 6573  t in self.inames
-0002a570: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002a580: 2020 2020 2020 2020 2020 2066 6f72 2074             for t
-0002a590: 7261 6e73 6974 5f6e 756d 6265 7220 696e  ransit_number in
-0002a5a0: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-0002a5b0: 5b69 6e73 7472 756d 656e 745d 5b0a 2020  [instrument][.  
-0002a5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a5d0: 2020 2020 2020 2020 2020 2020 2020 2754                'T
-0002a5e0: 5456 7327 5d5b 696e 7428 6929 5d5b 2774  TVs'][int(i)]['t
-0002a5f0: 7261 6e73 6974 5f6e 756d 6265 7227 5d3a  ransit_number']:
-0002a600: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002a610: 2020 2020 2020 2020 2020 2020 2020 616c                al
-0002a620: 6c5f 5473 5b69 5d20 3d20 6e70 2e61 7070  l_Ts[i] = np.app
-0002a630: 656e 6428 0a20 2020 2020 2020 2020 2020  end(.           
-0002a640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a650: 2020 2020 2061 6c6c 5f54 735b 695d 2c0a       all_Ts[i],.
-0002a660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a680: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
-0002a690: 5b27 545f 7027 202b 2073 7472 2869 2920  ['T_p' + str(i) 
-0002a6a0: 2b20 275f 2720 2b0a 2020 2020 2020 2020  + '_' +.        
-0002a6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a6d0: 2020 2020 2020 2020 2069 6e73 7472 756d           instrum
-0002a6e0: 656e 7420 2b20 275f 2720 2b0a 2020 2020  ent + '_' +.    
-0002a6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a710: 2020 2020 2020 2020 2020 2020 2073 7472               str
-0002a720: 2874 7261 6e73 6974 5f6e 756d 6265 7229  (transit_number)
-0002a730: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
+000298d0: 2063 6f6d 706f 6e65 6e74 735b 2770 2720   components['p' 
+000298e0: 2b20 7374 7228 6929 5d20 3d20 7365 6c66  + str(i)] = self
+000298f0: 2e6d 6f64 656c 5b27 7027 202b 0a20 2020  .model['p' +.   
+00029900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029940: 2020 2073 7472 2869 295d 0a20 2020 2020     str(i)].     
+00029950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029960: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
+00029970: 735b 2774 7265 6e64 275d 203d 2073 656c  s['trend'] = sel
+00029980: 662e 6d6f 6465 6c5b 0a20 2020 2020 2020  f.model[.       
+00029990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000299a0: 2020 2020 2020 2020 2027 4b65 706c 6572           'Kepler
+000299b0: 6961 6e2b 5472 656e 6427 5d20 2d20 7365  ian+Trend'] - se
+000299c0: 6c66 2e6d 6f64 656c 5b27 4b65 706c 6572  lf.model['Kepler
+000299d0: 6961 6e27 5d0a 2020 2020 2020 2020 2020  ian'].          
+000299e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000299f0: 2020 636f 6d70 6f6e 656e 7473 5b27 6b65    components['ke
+00029a00: 706c 6572 6961 6e27 5d20 3d20 7365 6c66  plerian'] = self
+00029a10: 2e6d 6f64 656c 5b27 4b65 706c 6572 6961  .model['Kepleria
+00029a20: 6e27 5d0a 2020 2020 2020 2020 2020 2020  n'].            
+00029a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029a40: 636f 6d70 6f6e 656e 7473 5b27 6d75 275d  components['mu']
+00029a50: 203d 2070 6172 616d 6574 6572 5f76 616c   = parameter_val
+00029a60: 7565 735b 276d 755f 2720 2b0a 2020 2020  ues['mu_' +.    
+00029a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029aa0: 2020 2020 2020 2020 2020 2020 696e 7374              inst
+00029ab0: 7275 6d65 6e74 5d0a 2020 2020 2020 2020  rument].        
+00029ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029ad0: 6966 2073 656c 662e 6c6d 5f62 6f6f 6c65  if self.lm_boole
+00029ae0: 616e 5b69 6e73 7472 756d 656e 745d 3a0a  an[instrument]:.
+00029af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029b00: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+00029b10: 6f6e 656e 7473 5b27 6c6d 275d 203d 2073  onents['lm'] = s
+00029b20: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
+00029b30: 6d65 6e74 5d5b 274c 4d27 5d0a 2020 2020  ment]['LM'].    
+00029b40: 2020 2020 656c 7365 3a0a 0a20 2020 2020      else:..     
+00029b50: 2020 2020 2020 2078 203d 2073 656c 662e         x = self.
+00029b60: 6576 616c 7561 7465 5f6d 6f64 656c 2869  evaluate_model(i
+00029b70: 6e73 7472 756d 656e 7420 3d20 696e 7374  nstrument = inst
+00029b80: 7275 6d65 6e74 2c20 7061 7261 6d65 7465  rument, paramete
+00029b90: 725f 7661 6c75 6573 203d 2073 656c 662e  r_values = self.
+00029ba0: 706f 7374 6572 696f 7273 2c20 616c 6c5f  posteriors, all_
+00029bb0: 7361 6d70 6c65 7320 3d20 616c 6c5f 7361  samples = all_sa
+00029bc0: 6d70 6c65 732c 0a20 2020 2020 2020 2020  mples,.         
+00029bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029bf0: 2020 2020 206e 7361 6d70 6c65 7320 3d20       nsamples = 
+00029c00: 6e73 616d 706c 6573 2c20 7265 7475 726e  nsamples, return
+00029c10: 5f73 616d 706c 6573 203d 2072 6574 7572  _samples = retur
+00029c20: 6e5f 7361 6d70 6c65 732c 2074 203d 2074  n_samples, t = t
+00029c30: 2c20 4750 7265 6772 6573 736f 7273 203d  , GPregressors =
+00029c40: 2047 5072 6567 7265 7373 6f72 732c 0a20   GPregressors,. 
+00029c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029c70: 2020 2020 2020 2020 2020 2020 204c 4d72               LMr
+00029c80: 6567 7265 7373 6f72 7320 3d20 4c4d 7265  egressors = LMre
+00029c90: 6772 6573 736f 7273 2c20 7265 7475 726e  gressors, return
+00029ca0: 5f65 7272 203d 2072 6574 7572 6e5f 6572  _err = return_er
+00029cb0: 722c 2072 6574 7572 6e5f 636f 6d70 6f6e  r, return_compon
+00029cc0: 656e 7473 203d 2072 6574 7572 6e5f 636f  ents = return_co
+00029cd0: 6d70 6f6e 656e 7473 2c20 616c 7068 6120  mponents, alpha 
+00029ce0: 3d20 616c 7068 612c 0a20 2020 2020 2020  = alpha,.       
+00029cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029d10: 2020 2020 2020 2065 7661 6c75 6174 655f         evaluate_
+00029d20: 7472 616e 7369 7420 3d20 6576 616c 7561  transit = evalua
+00029d30: 7465 5f74 7261 6e73 6974 290a 2020 2020  te_transit).    
+00029d40: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00029d50: 2020 2020 2069 6620 7265 7475 726e 5f73       if return_s
+00029d60: 616d 706c 6573 3a0a 2020 2020 2020 2020  amples:.        
+00029d70: 2020 2020 2020 2020 6966 2072 6574 7572          if retur
+00029d80: 6e5f 6572 723a 0a20 2020 2020 2020 2020  n_err:.         
+00029d90: 2020 2020 2020 2020 2020 2069 6620 7265             if re
+00029da0: 7475 726e 5f63 6f6d 706f 6e65 6e74 733a  turn_components:
+00029db0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029dc0: 2020 2020 2020 2020 206f 7574 7075 745f           output_
+00029dd0: 6d6f 6465 6c5f 7361 6d70 6c65 732c 206d  model_samples, m
+00029de0: 5f6f 7574 7075 745f 6d6f 6465 6c2c 2075  _output_model, u
+00029df0: 5f6f 7574 7075 745f 6d6f 6465 6c2c 206c  _output_model, l
+00029e00: 5f6f 7574 7075 745f 6d6f 6465 6c2c 2063  _output_model, c
+00029e10: 6f6d 706f 6e65 6e74 7320 3d20 780a 2020  omponents = x.  
+00029e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029e30: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00029e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029e50: 6f75 7470 7574 5f6d 6f64 656c 5f73 616d  output_model_sam
+00029e60: 706c 6573 2c20 6d5f 6f75 7470 7574 5f6d  ples, m_output_m
+00029e70: 6f64 656c 2c20 755f 6f75 7470 7574 5f6d  odel, u_output_m
+00029e80: 6f64 656c 2c20 6c5f 6f75 7470 7574 5f6d  odel, l_output_m
+00029e90: 6f64 656c 203d 2078 0a20 2020 2020 2020  odel = x.       
+00029ea0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00029eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029ec0: 2020 2069 6620 7265 7475 726e 5f63 6f6d     if return_com
+00029ed0: 706f 6e65 6e74 733a 0a20 2020 2020 2020  ponents:.       
+00029ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029ef0: 206f 7574 7075 745f 6d6f 6465 6c5f 7361   output_model_sa
+00029f00: 6d70 6c65 732c 206f 7574 7075 745f 6d6f  mples, output_mo
+00029f10: 6465 6c2c 2063 6f6d 706f 6e65 6e74 7320  del, components 
+00029f20: 3d20 780a 2020 2020 2020 2020 2020 2020  = x.            
+00029f30: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00029f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029f50: 2020 2020 2020 6f75 7470 7574 5f6d 6f64        output_mod
+00029f60: 656c 5f73 616d 706c 6573 2c20 6f75 7470  el_samples, outp
+00029f70: 7574 5f6d 6f64 656c 203d 2078 0a20 2020  ut_model = x.   
+00029f80: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00029f90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00029fa0: 6620 7265 7475 726e 5f65 7272 3a0a 2020  f return_err:.  
+00029fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029fc0: 2020 6966 2072 6574 7572 6e5f 636f 6d70    if return_comp
+00029fd0: 6f6e 656e 7473 3a0a 2020 2020 2020 2020  onents:.        
+00029fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029ff0: 6d5f 6f75 7470 7574 5f6d 6f64 656c 2c20  m_output_model, 
+0002a000: 755f 6f75 7470 7574 5f6d 6f64 656c 2c20  u_output_model, 
+0002a010: 6c5f 6f75 7470 7574 5f6d 6f64 656c 2c20  l_output_model, 
+0002a020: 636f 6d70 6f6e 656e 7473 203d 2078 0a20  components = x. 
+0002a030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a040: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002a050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a060: 206d 5f6f 7574 7075 745f 6d6f 6465 6c2c   m_output_model,
+0002a070: 2075 5f6f 7574 7075 745f 6d6f 6465 6c2c   u_output_model,
+0002a080: 206c 5f6f 7574 7075 745f 6d6f 6465 6c20   l_output_model 
+0002a090: 3d20 780a 2020 2020 2020 2020 2020 2020  = x.            
+0002a0a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002a0b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0002a0c0: 2072 6574 7572 6e5f 636f 6d70 6f6e 656e   return_componen
+0002a0d0: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
+0002a0e0: 2020 2020 2020 2020 2020 2020 6f75 7470              outp
+0002a0f0: 7574 5f6d 6f64 656c 2c20 636f 6d70 6f6e  ut_model, compon
+0002a100: 656e 7473 203d 2078 0a20 2020 2020 2020  ents = x.       
+0002a110: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0002a120: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0002a130: 2020 2020 2020 2020 2020 206f 7574 7075             outpu
+0002a140: 745f 6d6f 6465 6c20 3d20 780a 0a20 2020  t_model = x..   
+0002a150: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+0002a160: 2e67 6c6f 6261 6c5f 6d6f 6465 6c3a 0a20  .global_model:. 
+0002a170: 2020 2020 2020 2020 2020 2023 2052 6574             # Ret
+0002a180: 7572 6e20 6f72 6967 696e 616c 2069 6e61  urn original ina
+0002a190: 6d65 7320 6261 636b 2069 6e20 6361 7365  mes back in case
+0002a1a0: 206f 6620 6e6f 6e2d 676c 6f62 616c 206d   of non-global m
+0002a1b0: 6f64 656c 733a 0a20 2020 2020 2020 2020  odels:.         
+0002a1c0: 2020 2073 656c 662e 696e 616d 6573 203d     self.inames =
+0002a1d0: 206f 7269 6769 6e61 6c5f 696e 616d 6573   original_inames
+0002a1e0: 0a0a 2020 2020 2020 2020 6966 2065 7661  ..        if eva
+0002a1f0: 6c75 6174 655f 7472 616e 7369 743a 0a20  luate_transit:. 
+0002a200: 2020 2020 2020 2020 2020 2023 2054 7572             # Tur
+0002a210: 6e20 4c4d 2061 6e64 2047 5073 2062 6163  n LM and GPs bac
+0002a220: 6b20 6f6e 3a0a 2020 2020 2020 2020 2020  k on:.          
+0002a230: 2020 7365 6c66 2e6c 6d5f 626f 6f6c 6561    self.lm_boolea
+0002a240: 6e5b 696e 7374 7275 6d65 6e74 5d20 3d20  n[instrument] = 
+0002a250: 7472 7565 5f6c 6d5f 626f 6f6c 6561 6e0a  true_lm_boolean.
+0002a260: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0002a270: 656c 662e 676c 6f62 616c 5f6d 6f64 656c  elf.global_model
+0002a280: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002a290: 2020 7365 6c66 2e64 6963 7469 6f6e 6172    self.dictionar
+0002a2a0: 795b 2767 6c6f 6261 6c5f 6d6f 6465 6c27  y['global_model'
+0002a2b0: 5d5b 2747 5044 6574 7265 6e64 275d 203d  ]['GPDetrend'] =
+0002a2c0: 2074 7275 655f 6770 5f62 6f6f 6c65 616e   true_gp_boolean
+0002a2d0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0002a2e0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0002a2f0: 2020 2073 656c 662e 6469 6374 696f 6e61     self.dictiona
+0002a300: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
+0002a310: 4750 4465 7472 656e 6427 5d20 3d20 7472  GPDetrend'] = tr
+0002a320: 7565 5f67 705f 626f 6f6c 6561 6e0a 0a20  ue_gp_boolean.. 
+0002a330: 2020 2020 2020 2069 6620 7265 7475 726e         if return
+0002a340: 5f73 616d 706c 6573 3a0a 2020 2020 2020  _samples:.      
+0002a350: 2020 2020 2020 6966 2072 6574 7572 6e5f        if return_
+0002a360: 6572 723a 0a20 2020 2020 2020 2020 2020  err:.           
+0002a370: 2020 2020 2069 6620 7265 7475 726e 5f63       if return_c
+0002a380: 6f6d 706f 6e65 6e74 733a 0a20 2020 2020  omponents:.     
+0002a390: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0002a3a0: 6574 7572 6e20 6f75 7470 7574 5f6d 6f64  eturn output_mod
+0002a3b0: 656c 5f73 616d 706c 6573 2c20 6d5f 6f75  el_samples, m_ou
+0002a3c0: 7470 7574 5f6d 6f64 656c 2c20 755f 6f75  tput_model, u_ou
+0002a3d0: 7470 7574 5f6d 6f64 656c 2c20 6c5f 6f75  tput_model, l_ou
+0002a3e0: 7470 7574 5f6d 6f64 656c 2c20 636f 6d70  tput_model, comp
+0002a3f0: 6f6e 656e 7473 0a20 2020 2020 2020 2020  onents.         
+0002a400: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0002a410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a420: 2072 6574 7572 6e20 6f75 7470 7574 5f6d   return output_m
+0002a430: 6f64 656c 5f73 616d 706c 6573 2c20 6d5f  odel_samples, m_
+0002a440: 6f75 7470 7574 5f6d 6f64 656c 2c20 755f  output_model, u_
+0002a450: 6f75 7470 7574 5f6d 6f64 656c 2c20 6c5f  output_model, l_
+0002a460: 6f75 7470 7574 5f6d 6f64 656c 0a20 2020  output_model.   
+0002a470: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0002a480: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002a490: 6620 7265 7475 726e 5f63 6f6d 706f 6e65  f return_compone
+0002a4a0: 6e74 733a 0a20 2020 2020 2020 2020 2020  nts:.           
+0002a4b0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0002a4c0: 6f75 7470 7574 5f6d 6f64 656c 5f73 616d  output_model_sam
+0002a4d0: 706c 6573 2c20 6f75 7470 7574 5f6d 6f64  ples, output_mod
+0002a4e0: 656c 2c20 636f 6d70 6f6e 656e 7473 0a20  el, components. 
+0002a4f0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002a500: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0002a510: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0002a520: 6f75 7470 7574 5f6d 6f64 656c 5f73 616d  output_model_sam
+0002a530: 706c 6573 2c20 6f75 7470 7574 5f6d 6f64  ples, output_mod
+0002a540: 656c 0a20 2020 2020 2020 2065 6c73 653a  el.        else:
+0002a550: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0002a560: 7265 7475 726e 5f65 7272 3a0a 2020 2020  return_err:.    
+0002a570: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+0002a580: 6574 7572 6e5f 636f 6d70 6f6e 656e 7473  eturn_components
+0002a590: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002a5a0: 2020 2020 2020 7265 7475 726e 206d 5f6f        return m_o
+0002a5b0: 7574 7075 745f 6d6f 6465 6c2c 2075 5f6f  utput_model, u_o
+0002a5c0: 7574 7075 745f 6d6f 6465 6c2c 206c 5f6f  utput_model, l_o
+0002a5d0: 7574 7075 745f 6d6f 6465 6c2c 2063 6f6d  utput_model, com
+0002a5e0: 706f 6e65 6e74 730a 2020 2020 2020 2020  ponents.        
+0002a5f0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0002a600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a610: 2020 7265 7475 726e 206d 5f6f 7574 7075    return m_outpu
+0002a620: 745f 6d6f 6465 6c2c 2075 5f6f 7574 7075  t_model, u_outpu
+0002a630: 745f 6d6f 6465 6c2c 206c 5f6f 7574 7075  t_model, l_outpu
+0002a640: 745f 6d6f 6465 6c0a 2020 2020 2020 2020  t_model.        
+0002a650: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002a660: 2020 2020 2020 2020 2020 6966 2072 6574            if ret
+0002a670: 7572 6e5f 636f 6d70 6f6e 656e 7473 3a0a  urn_components:.
+0002a680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a690: 2020 2020 7265 7475 726e 206f 7574 7075      return outpu
+0002a6a0: 745f 6d6f 6465 6c2c 2063 6f6d 706f 6e65  t_model, compone
+0002a6b0: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
+0002a6c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002a6d0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0002a6e0: 7475 726e 206f 7574 7075 745f 6d6f 6465  turn output_mode
+0002a6f0: 6c0a 0a20 2020 2064 6566 2067 656e 6572  l..    def gener
+0002a700: 6174 655f 6c63 5f6d 6f64 656c 2873 656c  ate_lc_model(sel
+0002a710: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
+0002a720: 2020 2020 2020 2020 2020 2020 2070 6172               par
+0002a730: 616d 6574 6572 5f76 616c 7565 732c 0a20  ameter_values,. 
 0002a740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a750: 616c 6c5f 6e73 5b69 5d20 3d20 6e70 2e61  all_ns[i] = np.a
-0002a760: 7070 656e 6428 616c 6c5f 6e73 5b69 5d2c  ppend(all_ns[i],
-0002a770: 2074 7261 6e73 6974 5f6e 756d 6265 7229   transit_number)
-0002a780: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002a790: 2020 2020 2020 2320 4966 2065 7661 6c75        # If evalu
-0002a7a0: 6174 655f 6c63 2066 6c61 6720 6973 206f  ate_lc flag is o
-0002a7b0: 6e2c 2074 6869 7320 6d65 616e 7320 7573  n, this means us
-0002a7c0: 6572 2069 7320 6576 616c 7561 7469 6e67  er is evaluating
-0002a7d0: 206c 6967 6874 6375 7276 652e 2048 6572   lightcurve. Her
-0002a7e0: 6520 7765 2064 6f20 736f 6d65 2074 7269  e we do some tri
-0002a7f0: 636b 7320 6173 2074 6f20 6f6e 6c79 2065  cks as to only e
-0002a800: 7661 6c75 6174 650a 2020 2020 2020 2020  valuate.        
-0002a810: 2020 2020 2020 2020 2020 2020 2320 6d6f              # mo
-0002a820: 6465 6c73 2069 6e20 7468 6520 7573 6572  dels in the user
-0002a830: 2d64 6566 696e 6564 2069 6e73 7472 756d  -defined instrum
-0002a840: 656e 7420 2874 6f20 7370 6565 6420 7570  ent (to speed up
-0002a850: 2065 7661 6c75 6174 696f 6e29 2c20 736f   evaluation), so
-0002a860: 2069 6e20 7468 6174 2063 6173 6520 7765   in that case we
-0002a870: 2075 7365 2074 6865 2070 6f73 7465 7269   use the posteri
-0002a880: 6f72 2074 3020 616e 6420 500a 2020 2020  or t0 and P.    
-0002a890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a8a0: 2320 6163 7475 616c 6c79 2074 616b 656e  # actually taken
-0002a8b0: 2066 726f 6d20 7468 6520 542d 7361 6d70   from the T-samp
-0002a8c0: 6c65 733a 0a20 2020 2020 2020 2020 2020  les:.           
-0002a8d0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-0002a8e0: 6576 616c 7561 7465 5f6c 633a 0a0a 2020  evaluate_lc:..  
-0002a8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a900: 2020 2020 2020 5859 2c20 592c 2058 2c20        XY, Y, X, 
-0002a910: 5832 203d 206e 702e 7375 6d28 0a20 2020  X2 = np.sum(.   
-0002a920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a930: 2020 2020 2020 2020 2061 6c6c 5f54 735b           all_Ts[
-0002a940: 695d 202a 2061 6c6c 5f6e 735b 695d 2920  i] * all_ns[i]) 
-0002a950: 2f20 7365 6c66 2e4e 5f54 5456 735b 695d  / self.N_TTVs[i]
-0002a960: 2c20 6e70 2e73 756d 280a 2020 2020 2020  , np.sum(.      
-0002a970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a980: 2020 2020 2020 2020 2020 616c 6c5f 5473            all_Ts
-0002a990: 5b69 5d29 202f 2073 656c 662e 4e5f 5454  [i]) / self.N_TT
-0002a9a0: 5673 5b69 5d2c 206e 702e 7375 6d28 0a20  Vs[i], np.sum(. 
+0002a750: 2020 2020 2020 2020 2065 7661 6c75 6174           evaluat
+0002a760: 655f 676c 6f62 616c 5f65 7272 6f72 733d  e_global_errors=
+0002a770: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+0002a780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a790: 6576 616c 7561 7465 5f6c 633d 4661 6c73  evaluate_lc=Fals
+0002a7a0: 6529 3a0a 0a20 2020 2020 2020 2073 656c  e):..        sel
+0002a7b0: 662e 6d6f 6465 6c4f 4b20 3d20 5472 7565  f.modelOK = True
+0002a7c0: 0a0a 2020 2020 2020 2020 2320 4966 2054  ..        # If T
+0002a7d0: 5456 2070 6172 616d 6574 7269 7a61 7469  TV parametrizati
+0002a7e0: 6f6e 2069 7320 2754 2720 666f 7220 706c  on is 'T' for pl
+0002a7f0: 616e 6574 2069 2c20 7374 6f72 6520 7472  anet i, store tr
+0002a800: 616e 7369 7420 7469 6d65 732e 2043 6865  ansit times. Che
+0002a810: 636b 206f 6e6c 7920 6966 2074 6865 206e  ck only if the n
+0002a820: 6f54 666c 6167 2069 7320 4661 6c73 6520  oTflag is False 
+0002a830: 2877 6869 6368 2069 6d70 6c69 6573 0a20  (which implies. 
+0002a840: 2020 2020 2020 2023 2061 7420 6c65 6173         # at leas
+0002a850: 7420 6f6e 6520 706c 616e 6574 2075 7365  t one planet use
+0002a860: 7320 7468 6520 542d 7061 7261 6d65 7472  s the T-parametr
+0002a870: 697a 6174 696f 6e29 3a0a 2020 2020 2020  ization):.      
+0002a880: 2020 6966 2073 656c 662e 5466 6c61 673a    if self.Tflag:
+0002a890: 0a0a 2020 2020 2020 2020 2020 2020 706c  ..            pl
+0002a8a0: 616e 6574 5f74 302c 2070 6c61 6e65 745f  anet_t0, planet_
+0002a8b0: 5020 3d20 7b7d 2c20 7b7d 0a20 2020 2020  P = {}, {}.     
+0002a8c0: 2020 2020 2020 2061 6c6c 5f54 732c 2061         all_Ts, a
+0002a8d0: 6c6c 5f6e 7320 3d20 7b7d 2c20 7b7d 0a0a  ll_ns = {}, {}..
+0002a8e0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0002a8f0: 6920 696e 2073 656c 662e 6e75 6d62 6572  i in self.number
+0002a900: 696e 673a 0a0a 2020 2020 2020 2020 2020  ing:..          
+0002a910: 2020 2020 2020 6966 2073 656c 662e 5470        if self.Tp
+0002a920: 6172 616d 6574 7269 7a61 7469 6f6e 5b69  arametrization[i
+0002a930: 5d3a 0a0a 2020 2020 2020 2020 2020 2020  ]:..            
+0002a940: 2020 2020 2020 2020 616c 6c5f 5473 5b69          all_Ts[i
+0002a950: 5d2c 2061 6c6c 5f6e 735b 695d 203d 206e  ], all_ns[i] = n
+0002a960: 702e 6172 7261 7928 5b5d 292c 206e 702e  p.array([]), np.
+0002a970: 6172 7261 7928 5b5d 290a 0a20 2020 2020  array([])..     
+0002a980: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002a990: 6f72 2069 6e73 7472 756d 656e 7420 696e  or instrument in
+0002a9a0: 2073 656c 662e 696e 616d 6573 3a0a 0a20   self.inames:.. 
 0002a9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a9d0: 2020 2061 6c6c 5f6e 735b 695d 2920 2f20     all_ns[i]) / 
-0002a9e0: 7365 6c66 2e4e 5f54 5456 735b 695d 2c20  self.N_TTVs[i], 
-0002a9f0: 6e70 2e73 756d 280a 2020 2020 2020 2020  np.sum(.        
+0002a9c0: 2020 2020 2020 2066 6f72 2074 7261 6e73         for trans
+0002a9d0: 6974 5f6e 756d 6265 7220 696e 2073 656c  it_number in sel
+0002a9e0: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
+0002a9f0: 7472 756d 656e 745d 5b0a 2020 2020 2020  trument][.      
 0002aa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aa20: 616c 6c5f 6e73 5b69 5d2a 2a32 2920 2f20  all_ns[i]**2) / 
-0002aa30: 7365 6c66 2e4e 5f54 5456 735b 695d 0a0a  self.N_TTVs[i]..
+0002aa10: 2020 2020 2020 2020 2020 2754 5456 7327            'TTVs'
+0002aa20: 5d5b 696e 7428 6929 5d5b 2774 7261 6e73  ][int(i)]['trans
+0002aa30: 6974 5f6e 756d 6265 7227 5d3a 0a0a 2020  it_number']:..  
 0002aa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aa50: 2020 2020 2020 2020 2320 4765 7420 736c          # Get sl
-0002aa60: 6f70 653a 0a20 2020 2020 2020 2020 2020  ope:.           
-0002aa70: 2020 2020 2020 2020 2020 2020 2070 6c61               pla
-0002aa80: 6e65 745f 505b 695d 203d 2028 5859 202d  net_P[i] = (XY -
-0002aa90: 2058 202a 2059 2920 2f20 2858 3220 2d20   X * Y) / (X2 - 
-0002aaa0: 2858 2a2a 3229 290a 0a20 2020 2020 2020  (X**2))..       
-0002aab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aac0: 2023 2049 6e74 6572 6365 7074 3a0a 2020   # Intercept:.  
-0002aad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aae0: 2020 2020 2020 706c 616e 6574 5f74 305b        planet_t0[
-0002aaf0: 695d 203d 2059 202d 2070 6c61 6e65 745f  i] = Y - planet_
-0002ab00: 505b 695d 202a 2058 0a0a 2020 2020 2020  P[i] * X..      
-0002ab10: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0002ab20: 7365 3a0a 0a20 2020 2020 2020 2020 2020  se:..           
-0002ab30: 2020 2020 2020 2020 2020 2020 2070 6c61               pla
-0002ab40: 6e65 745f 7430 5b69 5d2c 2070 6c61 6e65  net_t0[i], plane
-0002ab50: 745f 505b 695d 203d 2070 6172 616d 6574  t_P[i] = paramet
-0002ab60: 6572 5f76 616c 7565 735b 2774 305f 7027  er_values['t0_p'
-0002ab70: 2b73 7472 2869 295d 2c20 7061 7261 6d65  +str(i)], parame
-0002ab80: 7465 725f 7661 6c75 6573 5b27 505f 7027  ter_values['P_p'
-0002ab90: 2b73 7472 2869 295d 0a0a 2020 2020 2020  +str(i)]..      
-0002aba0: 2020 2320 5374 6172 7420 6c6f 6f70 2074    # Start loop t
-0002abb0: 6f20 706f 7075 6c61 7465 2074 6865 2073  o populate the s
-0002abc0: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
-0002abd0: 6d65 6e74 5d5b 2764 6574 6572 6d69 6e69  ment]['determini
-0002abe0: 7374 6963 5f6d 6f64 656c 275d 2061 7272  stic_model'] arr
-0002abf0: 6179 2c20 7768 6963 6820 7769 6c6c 2068  ay, which will h
-0002ac00: 6f73 7420 7468 6520 636f 6d70 6c65 7465  ost the complete
-0002ac10: 206c 6967 6874 6375 7276 6520 666f 7220   lightcurve for 
-0002ac20: 6120 6769 7665 6e0a 2020 2020 2020 2020  a given.        
-0002ac30: 2320 696e 7374 7275 6d65 6e74 2028 696e  # instrument (in
-0002ac40: 636c 7564 696e 6720 666c 7578 2066 726f  cluding flux fro
-0002ac50: 6d20 616c 6c20 7468 6520 706c 616e 6574  m all the planet
-0002ac60: 7329 2e20 446f 2074 6865 2066 6f72 206c  s). Do the for l
-0002ac70: 6f6f 7020 7065 7220 696e 7374 7275 6d65  oop per instrume
-0002ac80: 6e74 2066 6f72 2074 6865 2070 6172 616d  nt for the param
-0002ac90: 6574 6572 2065 7874 7261 6374 696f 6e2c  eter extraction,
-0002aca0: 2073 6f20 696e 2074 6865 0a20 2020 2020   so in the.     
-0002acb0: 2020 2023 2066 7574 7572 6520 7765 2063     # future we c
-0002acc0: 616e 2064 6f2c 2065 2e67 2e2c 2077 6176  an do, e.g., wav
-0002acd0: 656c 656e 6774 682d 6465 7065 6e64 616e  elength-dependan
-0002ace0: 7420 7270 2f72 732e 0a20 2020 2020 2020  t rp/rs..       
-0002acf0: 2066 6f72 2069 6e73 7472 756d 656e 7420   for instrument 
-0002ad00: 696e 2073 656c 662e 696e 616d 6573 3a0a  in self.inames:.
-0002ad10: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
-0002ad20: 6574 2066 756c 6c20 6172 7261 7920 746f  et full array to
-0002ad30: 206f 6e65 7320 6279 2063 6f70 7969 6e67   ones by copying
-0002ad40: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0002ad50: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
-0002ad60: 656e 745d 5b27 4d27 5d20 3d20 6e70 2e63  ent]['M'] = np.c
-0002ad70: 6f70 7928 0a20 2020 2020 2020 2020 2020  opy(.           
-0002ad80: 2020 2020 2073 656c 662e 6d6f 6465 6c5b       self.model[
-0002ad90: 696e 7374 7275 6d65 6e74 5d5b 276f 6e65  instrument]['one
-0002ada0: 7327 5d29 0a0a 2020 2020 2020 2020 2020  s'])..          
-0002adb0: 2020 2320 4966 2074 7261 6e73 6974 2066    # If transit f
-0002adc0: 6974 2069 7320 6f6e 2c20 7468 656e 206d  it is on, then m
-0002add0: 6f64 656c 2074 6865 2074 7261 6e73 6974  odel the transit
-0002ade0: 206c 6967 6874 6375 7276 653a 0a20 2020   lightcurve:.   
-0002adf0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0002ae00: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
-0002ae10: 7275 6d65 6e74 5d5b 2754 7261 6e73 6974  rument]['Transit
-0002ae20: 4669 7427 5d20 6f72 2073 656c 662e 6469  Fit'] or self.di
-0002ae30: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
-0002ae40: 656e 745d 5b27 4563 6c69 7073 6546 6974  ent]['EclipseFit
-0002ae50: 275d 206f 7220 7365 6c66 2e64 6963 7469  '] or self.dicti
-0002ae60: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
-0002ae70: 5d5b 2754 7261 6e45 636c 4669 7427 5d3a  ]['TranEclFit']:
-0002ae80: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002ae90: 2020 2320 4578 7472 6163 7420 616e 6420    # Extract and 
-0002aea0: 7365 7420 7468 6520 6c69 6d62 2d64 6172  set the limb-dar
-0002aeb0: 6b65 6e69 6e67 2063 6f65 6666 6963 6965  kening coefficie
-0002aec0: 6e74 7320 666f 7220 7468 6520 696e 7374  nts for the inst
-0002aed0: 7275 6d65 6e74 3a0a 2020 2020 2020 2020  rument:.        
-0002aee0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0002aef0: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
-0002af00: 756d 656e 745d 5b27 6c64 6c61 7727 5d20  ument]['ldlaw'] 
-0002af10: 213d 2027 6c69 6e65 6172 2720 616e 6420  != 'linear' and 
-0002af20: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
-0002af30: 696e 7374 7275 6d65 6e74 5d5b 276c 646c  instrument]['ldl
-0002af40: 6177 275d 2021 3d20 276e 6f6e 6527 3a0a  aw'] != 'none':.
-0002af50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002af60: 2020 2020 2063 6f65 6666 312c 2063 6f65       coeff1, coe
-0002af70: 6666 3220 3d20 7265 7665 7273 655f 6c64  ff2 = reverse_ld
-0002af80: 5f63 6f65 6666 7328 7365 6c66 2e64 6963  _coeffs(self.dic
-0002af90: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
-0002afa0: 6e74 5d5b 276c 646c 6177 275d 2c20 7061  nt]['ldlaw'], pa
-0002afb0: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
-0002afc0: 7131 5f27 2b73 656c 662e 6c64 5f69 6e61  q1_'+self.ld_ina
-0002afd0: 6d65 5b69 6e73 7472 756d 656e 745d 5d2c  me[instrument]],
-0002afe0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0002aff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b010: 2020 2020 2020 2020 2070 6172 616d 6574           paramet
-0002b020: 6572 5f76 616c 7565 735b 2771 325f 272b  er_values['q2_'+
-0002b030: 7365 6c66 2e6c 645f 696e 616d 655b 696e  self.ld_iname[in
-0002b040: 7374 7275 6d65 6e74 5d5d 290a 0a20 2020  strument]])..   
-0002b050: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-0002b060: 6620 7365 6c66 2e64 6963 7469 6f6e 6172  f self.dictionar
-0002b070: 795b 696e 7374 7275 6d65 6e74 5d5b 276c  y[instrument]['l
-0002b080: 646c 6177 275d 203d 3d20 276e 6f6e 6527  dlaw'] == 'none'
-0002b090: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002b0a0: 2020 2020 2020 2063 6f65 6666 312c 2063         coeff1, c
-0002b0b0: 6f65 6666 3220 3d20 302e 312c 2030 2e33  oeff2 = 0.1, 0.3
-0002b0c0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002b0d0: 2020 656c 7365 3a0a 0a20 2020 2020 2020    else:..       
-0002b0e0: 2020 2020 2020 2020 2020 2020 2063 6f65               coe
-0002b0f0: 6666 3120 3d20 7061 7261 6d65 7465 725f  ff1 = parameter_
-0002b100: 7661 6c75 6573 5b27 7131 5f27 202b 2073  values['q1_' + s
-0002b110: 656c 662e 6c64 5f69 6e61 6d65 5b69 6e73  elf.ld_iname[ins
-0002b120: 7472 756d 656e 745d 5d0a 0a20 2020 2020  trument]]..     
-0002b130: 2020 2020 2020 2020 2020 2023 2046 6972             # Fir
-0002b140: 7374 2028 3129 2063 6865 636b 2069 6620  st (1) check if 
-0002b150: 5454 5620 6d6f 6465 2069 7320 6163 7469  TTV mode is acti
-0002b160: 7661 7465 642e 2049 6620 6974 2069 7320  vated. If it is 
-0002b170: 6e6f 742c 2073 696d 706c 7920 7361 7665  not, simply save
-0002b180: 2074 6865 2073 616d 706c 6564 2070 6c61   the sampled pla
-0002b190: 6e65 7420 7065 7269 6f64 7320 616e 6420  net periods and 
-0002b1a0: 7469 6d65 2d6f 6620 7472 616e 7369 7420  time-of transit 
-0002b1b0: 6365 6e74 6572 7320 666f 7220 6368 6563  centers for chec
-0002b1c0: 6b0a 2020 2020 2020 2020 2020 2020 2020  k.              
-0002b1d0: 2020 2320 696e 2074 6865 206e 6578 7420    # in the next 
-0002b1e0: 726f 756e 6420 6f66 2069 7465 7261 7469  round of iterati
-0002b1f0: 6f6e 2028 7365 6520 6265 6c6f 7729 2e20  on (see below). 
-0002b200: 4966 2069 7420 6973 2c20 6465 7065 6e64  If it is, depend
-0002b210: 696e 6720 6f6e 2074 6865 2070 6172 616d  ing on the param
-0002b220: 6574 7269 7a61 7469 6f6e 2c20 6569 7468  etrization, eith
-0002b230: 6572 2073 6869 6674 2074 6865 2074 696d  er shift the tim
-0002b240: 652d 696e 6465 7865 7320 6163 636f 7264  e-indexes accord
-0002b250: 696e 676c 7920 2873 6565 2062 656c 6f77  ingly (see below
-0002b260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b270: 2023 2063 6f6d 6d65 6e74 7320 666f 7220   # comments for 
-0002b280: 6465 7461 696c 7329 2e0a 2020 2020 2020  details)..      
-0002b290: 2020 2020 2020 2020 2020 6350 2c20 6374            cP, ct
-0002b2a0: 3020 3d20 7b7d 2c20 7b7d 0a0a 2020 2020  0 = {}, {}..    
-0002b2b0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0002b2c0: 6920 696e 2073 656c 662e 6e75 6d62 6572  i in self.number
-0002b2d0: 696e 673a 0a0a 2020 2020 2020 2020 2020  ing:..          
-0002b2e0: 2020 2020 2020 2020 2020 2320 4368 6563            # Chec
-0002b2f0: 6b20 6966 2077 6520 7769 6c6c 2062 6520  k if we will be 
-0002b300: 6669 7474 696e 6720 666f 7220 5454 5673  fitting for TTVs
-0002b310: 2e20 4966 206e 6f74 2c20 616c 6c20 676f  . If not, all go
-0002b320: 6573 2061 7320 7573 7561 6c2e 2049 6620  es as usual. If 
-0002b330: 7765 2061 7265 2c20 6368 6563 6b20 7768  we are, check wh
-0002b340: 6963 6820 7061 7261 6d65 7472 697a 6174  ich parametrizat
-0002b350: 696f 6e20 2864 7420 6f72 2054 293a 0a20  ion (dt or T):. 
-0002b360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b370: 2020 2069 6620 6e6f 7420 7365 6c66 2e64     if not self.d
-0002b380: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
-0002b390: 6d65 6e74 5d5b 2754 5456 7327 5d5b 695d  ment]['TTVs'][i]
-0002b3a0: 5b27 7374 6174 7573 275d 3a0a 0a20 2020  ['status']:..   
-0002b3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b3c0: 2020 2020 2074 302c 2050 203d 2070 6172       t0, P = par
-0002b3d0: 616d 6574 6572 5f76 616c 7565 735b 0a20  ameter_values[. 
-0002b3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b3f0: 2020 2020 2020 2020 2020 2027 7430 5f70             't0_p
-0002b400: 2720 2b20 7374 7228 6929 5d2c 2070 6172  ' + str(i)], par
-0002b410: 616d 6574 6572 5f76 616c 7565 735b 2750  ameter_values['P
-0002b420: 5f70 2720 2b20 7374 7228 6929 5d0a 0a20  _p' + str(i)].. 
+0002aa50: 2020 2020 2020 2020 2020 616c 6c5f 5473            all_Ts
+0002aa60: 5b69 5d20 3d20 6e70 2e61 7070 656e 6428  [i] = np.append(
+0002aa70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002aa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aa90: 2061 6c6c 5f54 735b 695d 2c0a 2020 2020   all_Ts[i],.    
+0002aaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aab0: 2020 2020 2020 2020 2020 2020 7061 7261              para
+0002aac0: 6d65 7465 725f 7661 6c75 6573 5b27 545f  meter_values['T_
+0002aad0: 7027 202b 2073 7472 2869 2920 2b20 275f  p' + str(i) + '_
+0002aae0: 2720 2b0a 2020 2020 2020 2020 2020 2020  ' +.            
+0002aaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ab00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ab10: 2020 2020 2069 6e73 7472 756d 656e 7420       instrument 
+0002ab20: 2b20 275f 2720 2b0a 2020 2020 2020 2020  + '_' +.        
+0002ab30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ab40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ab50: 2020 2020 2020 2020 2073 7472 2874 7261           str(tra
+0002ab60: 6e73 6974 5f6e 756d 6265 7229 5d29 0a0a  nsit_number)])..
+0002ab70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ab80: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
+0002ab90: 6e73 5b69 5d20 3d20 6e70 2e61 7070 656e  ns[i] = np.appen
+0002aba0: 6428 616c 6c5f 6e73 5b69 5d2c 2074 7261  d(all_ns[i], tra
+0002abb0: 6e73 6974 5f6e 756d 6265 7229 0a0a 2020  nsit_number)..  
+0002abc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002abd0: 2020 2320 4966 2065 7661 6c75 6174 655f    # If evaluate_
+0002abe0: 6c63 2066 6c61 6720 6973 206f 6e2c 2074  lc flag is on, t
+0002abf0: 6869 7320 6d65 616e 7320 7573 6572 2069  his means user i
+0002ac00: 7320 6576 616c 7561 7469 6e67 206c 6967  s evaluating lig
+0002ac10: 6874 6375 7276 652e 2048 6572 6520 7765  htcurve. Here we
+0002ac20: 2064 6f20 736f 6d65 2074 7269 636b 7320   do some tricks 
+0002ac30: 6173 2074 6f20 6f6e 6c79 2065 7661 6c75  as to only evalu
+0002ac40: 6174 650a 2020 2020 2020 2020 2020 2020  ate.            
+0002ac50: 2020 2020 2020 2020 2320 6d6f 6465 6c73          # models
+0002ac60: 2069 6e20 7468 6520 7573 6572 2d64 6566   in the user-def
+0002ac70: 696e 6564 2069 6e73 7472 756d 656e 7420  ined instrument 
+0002ac80: 2874 6f20 7370 6565 6420 7570 2065 7661  (to speed up eva
+0002ac90: 6c75 6174 696f 6e29 2c20 736f 2069 6e20  luation), so in 
+0002aca0: 7468 6174 2063 6173 6520 7765 2075 7365  that case we use
+0002acb0: 2074 6865 2070 6f73 7465 7269 6f72 2074   the posterior t
+0002acc0: 3020 616e 6420 500a 2020 2020 2020 2020  0 and P.        
+0002acd0: 2020 2020 2020 2020 2020 2020 2320 6163              # ac
+0002ace0: 7475 616c 6c79 2074 616b 656e 2066 726f  tually taken fro
+0002acf0: 6d20 7468 6520 542d 7361 6d70 6c65 733a  m the T-samples:
+0002ad00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ad10: 2020 2020 2069 6620 6e6f 7420 6576 616c       if not eval
+0002ad20: 7561 7465 5f6c 633a 0a0a 2020 2020 2020  uate_lc:..      
+0002ad30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ad40: 2020 5859 2c20 592c 2058 2c20 5832 203d    XY, Y, X, X2 =
+0002ad50: 206e 702e 7375 6d28 0a20 2020 2020 2020   np.sum(.       
+0002ad60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ad70: 2020 2020 2061 6c6c 5f54 735b 695d 202a       all_Ts[i] *
+0002ad80: 2061 6c6c 5f6e 735b 695d 2920 2f20 7365   all_ns[i]) / se
+0002ad90: 6c66 2e4e 5f54 5456 735b 695d 2c20 6e70  lf.N_TTVs[i], np
+0002ada0: 2e73 756d 280a 2020 2020 2020 2020 2020  .sum(.          
+0002adb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002adc0: 2020 2020 2020 616c 6c5f 5473 5b69 5d29        all_Ts[i])
+0002add0: 202f 2073 656c 662e 4e5f 5454 5673 5b69   / self.N_TTVs[i
+0002ade0: 5d2c 206e 702e 7375 6d28 0a20 2020 2020  ], np.sum(.     
+0002adf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ae00: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0002ae10: 6c6c 5f6e 735b 695d 2920 2f20 7365 6c66  ll_ns[i]) / self
+0002ae20: 2e4e 5f54 5456 735b 695d 2c20 6e70 2e73  .N_TTVs[i], np.s
+0002ae30: 756d 280a 2020 2020 2020 2020 2020 2020  um(.            
+0002ae40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ae50: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
+0002ae60: 6e73 5b69 5d2a 2a32 2920 2f20 7365 6c66  ns[i]**2) / self
+0002ae70: 2e4e 5f54 5456 735b 695d 0a0a 2020 2020  .N_TTVs[i]..    
+0002ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ae90: 2020 2020 2320 4765 7420 736c 6f70 653a      # Get slope:
+0002aea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002aeb0: 2020 2020 2020 2020 2070 6c61 6e65 745f           planet_
+0002aec0: 505b 695d 203d 2028 5859 202d 2058 202a  P[i] = (XY - X *
+0002aed0: 2059 2920 2f20 2858 3220 2d20 2858 2a2a   Y) / (X2 - (X**
+0002aee0: 3229 290a 0a20 2020 2020 2020 2020 2020  2))..           
+0002aef0: 2020 2020 2020 2020 2020 2020 2023 2049               # I
+0002af00: 6e74 6572 6365 7074 3a0a 2020 2020 2020  ntercept:.      
+0002af10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af20: 2020 706c 616e 6574 5f74 305b 695d 203d    planet_t0[i] =
+0002af30: 2059 202d 2070 6c61 6e65 745f 505b 695d   Y - planet_P[i]
+0002af40: 202a 2058 0a0a 2020 2020 2020 2020 2020   * X..          
+0002af50: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0002af60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002af70: 2020 2020 2020 2020 2070 6c61 6e65 745f           planet_
+0002af80: 7430 5b69 5d2c 2070 6c61 6e65 745f 505b  t0[i], planet_P[
+0002af90: 695d 203d 2070 6172 616d 6574 6572 5f76  i] = parameter_v
+0002afa0: 616c 7565 735b 2774 305f 7027 2b73 7472  alues['t0_p'+str
+0002afb0: 2869 295d 2c20 7061 7261 6d65 7465 725f  (i)], parameter_
+0002afc0: 7661 6c75 6573 5b27 505f 7027 2b73 7472  values['P_p'+str
+0002afd0: 2869 295d 0a0a 2020 2020 2020 2020 2320  (i)]..        # 
+0002afe0: 5374 6172 7420 6c6f 6f70 2074 6f20 706f  Start loop to po
+0002aff0: 7075 6c61 7465 2074 6865 2073 656c 662e  pulate the self.
+0002b000: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
+0002b010: 5d5b 2764 6574 6572 6d69 6e69 7374 6963  ]['deterministic
+0002b020: 5f6d 6f64 656c 275d 2061 7272 6179 2c20  _model'] array, 
+0002b030: 7768 6963 6820 7769 6c6c 2068 6f73 7420  which will host 
+0002b040: 7468 6520 636f 6d70 6c65 7465 206c 6967  the complete lig
+0002b050: 6874 6375 7276 6520 666f 7220 6120 6769  htcurve for a gi
+0002b060: 7665 6e0a 2020 2020 2020 2020 2320 696e  ven.        # in
+0002b070: 7374 7275 6d65 6e74 2028 696e 636c 7564  strument (includ
+0002b080: 696e 6720 666c 7578 2066 726f 6d20 616c  ing flux from al
+0002b090: 6c20 7468 6520 706c 616e 6574 7329 2e20  l the planets). 
+0002b0a0: 446f 2074 6865 2066 6f72 206c 6f6f 7020  Do the for loop 
+0002b0b0: 7065 7220 696e 7374 7275 6d65 6e74 2066  per instrument f
+0002b0c0: 6f72 2074 6865 2070 6172 616d 6574 6572  or the parameter
+0002b0d0: 2065 7874 7261 6374 696f 6e2c 2073 6f20   extraction, so 
+0002b0e0: 696e 2074 6865 0a20 2020 2020 2020 2023  in the.        #
+0002b0f0: 2066 7574 7572 6520 7765 2063 616e 2064   future we can d
+0002b100: 6f2c 2065 2e67 2e2c 2077 6176 656c 656e  o, e.g., wavelen
+0002b110: 6774 682d 6465 7065 6e64 616e 7420 7270  gth-dependant rp
+0002b120: 2f72 732e 0a20 2020 2020 2020 2066 6f72  /rs..        for
+0002b130: 2069 6e73 7472 756d 656e 7420 696e 2073   instrument in s
+0002b140: 656c 662e 696e 616d 6573 3a0a 0a20 2020  elf.inames:..   
+0002b150: 2020 2020 2020 2020 2023 2053 6574 2066           # Set f
+0002b160: 756c 6c20 6172 7261 7920 746f 206f 6e65  ull array to one
+0002b170: 7320 6279 2063 6f70 7969 6e67 3a0a 2020  s by copying:.  
+0002b180: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0002b190: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
+0002b1a0: 5b27 4d27 5d20 3d20 6e70 2e63 6f70 7928  ['M'] = np.copy(
+0002b1b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b1c0: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
+0002b1d0: 7275 6d65 6e74 5d5b 276f 6e65 7327 5d29  rument]['ones'])
+0002b1e0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0002b1f0: 4966 2074 7261 6e73 6974 2066 6974 2069  If transit fit i
+0002b200: 7320 6f6e 2c20 7468 656e 206d 6f64 656c  s on, then model
+0002b210: 2074 6865 2074 7261 6e73 6974 206c 6967   the transit lig
+0002b220: 6874 6375 7276 653a 0a20 2020 2020 2020  htcurve:.       
+0002b230: 2020 2020 2069 6620 7365 6c66 2e64 6963       if self.dic
+0002b240: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
+0002b250: 6e74 5d5b 2754 7261 6e73 6974 4669 7427  nt]['TransitFit'
+0002b260: 5d20 6f72 2073 656c 662e 6469 6374 696f  ] or self.dictio
+0002b270: 6e61 7279 5b69 6e73 7472 756d 656e 745d  nary[instrument]
+0002b280: 5b27 4563 6c69 7073 6546 6974 275d 206f  ['EclipseFit'] o
+0002b290: 7220 7365 6c66 2e64 6963 7469 6f6e 6172  r self.dictionar
+0002b2a0: 795b 696e 7374 7275 6d65 6e74 5d5b 2754  y[instrument]['T
+0002b2b0: 7261 6e45 636c 4669 7427 5d3a 0a0a 2020  ranEclFit']:..  
+0002b2c0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0002b2d0: 4578 7472 6163 7420 616e 6420 7365 7420  Extract and set 
+0002b2e0: 7468 6520 6c69 6d62 2d64 6172 6b65 6e69  the limb-darkeni
+0002b2f0: 6e67 2063 6f65 6666 6963 6965 6e74 7320  ng coefficients 
+0002b300: 666f 7220 7468 6520 696e 7374 7275 6d65  for the instrume
+0002b310: 6e74 3a0a 2020 2020 2020 2020 2020 2020  nt:.            
+0002b320: 2020 2020 6966 2073 656c 662e 6469 6374      if self.dict
+0002b330: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
+0002b340: 745d 5b27 6c64 6c61 7727 5d20 213d 2027  t]['ldlaw'] != '
+0002b350: 6c69 6e65 6172 2720 616e 6420 7365 6c66  linear' and self
+0002b360: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
+0002b370: 7275 6d65 6e74 5d5b 276c 646c 6177 275d  rument]['ldlaw']
+0002b380: 2021 3d20 276e 6f6e 6527 3a0a 0a20 2020   != 'none':..   
+0002b390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b3a0: 2063 6f65 6666 312c 2063 6f65 6666 3220   coeff1, coeff2 
+0002b3b0: 3d20 7265 7665 7273 655f 6c64 5f63 6f65  = reverse_ld_coe
+0002b3c0: 6666 7328 7365 6c66 2e64 6963 7469 6f6e  ffs(self.diction
+0002b3d0: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
+0002b3e0: 276c 646c 6177 275d 2c20 7061 7261 6d65  'ldlaw'], parame
+0002b3f0: 7465 725f 7661 6c75 6573 5b27 7131 5f27  ter_values['q1_'
+0002b400: 2b73 656c 662e 6c64 5f69 6e61 6d65 5b69  +self.ld_iname[i
+0002b410: 6e73 7472 756d 656e 745d 5d2c 5c0a 2020  nstrument]],\.  
+0002b420: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002b430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b440: 2020 2020 2020 2063 505b 695d 2c20 6374         cP[i], ct
-0002b450: 305b 695d 203d 2050 2c20 7430 0a0a 2020  0[i] = P, t0..  
-0002b460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b470: 2020 656c 7365 3a0a 0a20 2020 2020 2020    else:..       
-0002b480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b490: 2023 2049 6620 5454 5673 2069 7320 6f6e   # If TTVs is on
-0002b4a0: 2066 6f72 2070 6c61 6e65 7420 692c 2063   for planet i, c
-0002b4b0: 6f6d 7075 7465 2074 6865 2065 7870 6563  ompute the expec
-0002b4c0: 7465 6420 7469 6d65 206f 6620 7472 616e  ted time of tran
-0002b4d0: 7369 742c 2061 6e64 2073 6869 6674 2069  sit, and shift i
-0002b4e0: 742e 2046 6f72 2074 6869 732c 2075 7365  t. For this, use
-0002b4f0: 2069 6e66 6f72 6d61 7469 6f6e 2065 6e63   information enc
-0002b500: 6f64 6564 2069 6e20 7468 6520 7072 696f  oded in the prio
-0002b510: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-0002b520: 2020 2020 2020 2020 2020 2320 6e61 6d65            # name
-0002b530: 3b20 6966 2c20 652e 672e 2c20 6474 5f70  ; if, e.g., dt_p
-0002b540: 315f 5445 5353 315f 2d32 2c20 7468 656e  1_TESS1_-2, then
-0002b550: 206e 203d 202d 3220 616e 6420 7468 6520   n = -2 and the 
-0002b560: 7469 6d65 206f 6620 7472 616e 7369 7420  time of transit 
-0002b570: 2877 6974 6820 5454 5629 203d 2074 3020  (with TTV) = t0 
-0002b580: 2b20 6e2a 5020 2b20 6474 5f70 315f 5445  + n*P + dt_p1_TE
-0002b590: 5353 315f 2d32 2069 6e20 7468 6520 6361  SS1_-2 in the ca
-0002b5a0: 7365 206f 6620 7468 6520 6474 0a20 2020  se of the dt.   
-0002b5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b5c0: 2020 2020 2023 2070 6172 616d 6574 7269       # parametri
-0002b5d0: 7a61 7469 6f6e 2e20 496e 2074 6865 2063  zation. In the c
-0002b5e0: 6173 6520 6f66 2074 6865 2054 2d70 6172  ase of the T-par
-0002b5f0: 616d 6574 7269 7a61 7469 6f6e 2c20 7468  ametrization, th
-0002b600: 6520 7469 6d65 206f 6620 7472 616e 7369  e time of transi
-0002b610: 7420 7769 7468 2054 5456 2077 6f75 6c64  t with TTV would
-0002b620: 2062 6520 545f 7031 5f54 4553 5331 5f2d   be T_p1_TESS1_-
-0002b630: 322c 2061 6e64 2074 6865 2070 6572 696f  2, and the perio
-0002b640: 6420 616e 6420 7430 0a20 2020 2020 2020  d and t0.       
-0002b650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b660: 2023 2077 696c 6c20 6265 2064 6572 6976   # will be deriv
-0002b670: 6564 2066 726f 6d20 7468 6572 6520 6672  ed from there fr
-0002b680: 6f6d 2074 6865 206c 6561 7374 2d73 7175  om the least-squ
-0002b690: 6172 6573 2073 6c6f 7065 2061 6e64 2069  ares slope and i
-0002b6a0: 6e74 6572 6365 7074 2c20 7265 7370 6563  ntercept, respec
-0002b6b0: 7469 7665 6c79 2c20 746f 2074 6865 2054  tively, to the T
-0002b6c0: 2773 2e20 436f 6d70 7574 6520 7472 616e  's. Compute tran
-0002b6d0: 7369 740a 2020 2020 2020 2020 2020 2020  sit.            
-0002b6e0: 2020 2020 2020 2020 2020 2020 2320 6d6f              # mo
-0002b6f0: 6465 6c20 6173 7375 6d69 6e67 2074 6861  del assuming tha
-0002b700: 7420 7469 6d65 2d6f 662d 7472 616e 7369  t time-of-transi
-0002b710: 743b 2072 6570 6561 7420 666f 7220 616c  t; repeat for al
-0002b720: 6c20 7468 6520 7472 616e 7369 7473 2e20  l the transits. 
-0002b730: 4765 6e65 7261 6c6c 7920 7573 6572 7320  Generally users 
-0002b740: 7769 6c6c 206e 6f74 2064 6f20 5454 5620  will not do TTV 
-0002b750: 616e 616c 7973 6573 2c20 736f 2073 6574  analyses, so set
-0002b760: 2074 6869 7320 6c61 7474 6572 0a20 2020   this latter.   
-0002b770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b780: 2020 2020 2023 2063 6173 6520 746f 2062       # case to b
-0002b790: 6520 7468 6520 6d6f 7374 2063 6f6d 6d6f  e the most commo
-0002b7a0: 6e20 6f6e 6520 6279 2064 6566 6175 6c74  n one by default
-0002b7b0: 2069 6e20 7468 6520 6966 2d73 7461 7465   in the if-state
-0002b7c0: 6d65 6e74 3a0a 2020 2020 2020 2020 2020  ment:.          
-0002b7d0: 2020 2020 2020 2020 2020 2020 2020 6475                du
-0002b7e0: 6d6d 795f 7469 6d65 203d 206e 702e 636f  mmy_time = np.co
-0002b7f0: 7079 2873 656c 662e 7469 6d65 735b 696e  py(self.times[in
-0002b800: 7374 7275 6d65 6e74 5d29 0a0a 2020 2020  strument])..    
-0002b810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b820: 2020 2020 6966 2073 656c 662e 6469 6374      if self.dict
-0002b830: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
-0002b840: 745d 5b27 5454 5673 275d 5b69 5d5b 0a20  t]['TTVs'][i][. 
-0002b850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b860: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0002b870: 7061 7261 6d65 7472 697a 6174 696f 6e27  parametrization'
-0002b880: 5d20 3d3d 2027 6474 273a 0a0a 2020 2020  ] == 'dt':..    
-0002b890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b8a0: 2020 2020 2020 2020 7430 2c20 5020 3d20          t0, P = 
-0002b8b0: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
-0002b8c0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0002b8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b8e0: 2020 2774 305f 7027 202b 2073 7472 2869    't0_p' + str(i
-0002b8f0: 295d 2c20 7061 7261 6d65 7465 725f 7661  )], parameter_va
-0002b900: 6c75 6573 5b27 505f 7027 202b 0a20 2020  lues['P_p' +.   
-0002b910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b950: 7374 7228 6929 5d0a 0a20 2020 2020 2020  str(i)]..       
-0002b960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b970: 2020 2020 2063 505b 695d 2c20 6374 305b       cP[i], ct0[
-0002b980: 695d 203d 2050 2c20 7430 0a0a 2020 2020  i] = P, t0..    
-0002b990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b9a0: 2020 2020 2020 2020 666f 7220 7472 616e          for tran
-0002b9b0: 7369 745f 6e75 6d62 6572 2069 6e20 7365  sit_number in se
-0002b9c0: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
-0002b9d0: 7374 7275 6d65 6e74 5d5b 0a20 2020 2020  strument][.     
-0002b9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b9f0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0002ba00: 5454 5673 275d 5b69 6e74 2869 295d 5b27  TTVs'][int(i)]['
-0002ba10: 7472 616e 7369 745f 6e75 6d62 6572 275d  transit_number']
-0002ba20: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002ba30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ba40: 2020 2074 7261 6e73 6974 5f74 696d 6520     transit_time 
-0002ba50: 3d20 7430 202b 2074 7261 6e73 6974 5f6e  = t0 + transit_n
-0002ba60: 756d 6265 7220 2a20 5020 2b20 7061 7261  umber * P + para
-0002ba70: 6d65 7465 725f 7661 6c75 6573 5b0a 2020  meter_values[.  
-0002ba80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ba90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002baa0: 2020 2764 745f 7027 202b 2073 7472 2869    'dt_p' + str(i
-0002bab0: 2920 2b20 275f 2720 2b20 696e 7374 7275  ) + '_' + instru
-0002bac0: 6d65 6e74 202b 2027 5f27 202b 0a20 2020  ment + '_' +.   
-0002bad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002baf0: 2073 7472 2874 7261 6e73 6974 5f6e 756d   str(transit_num
-0002bb00: 6265 7229 5d0a 0a20 2020 2020 2020 2020  ber)]..         
+0002b440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b450: 2020 2020 2070 6172 616d 6574 6572 5f76       parameter_v
+0002b460: 616c 7565 735b 2771 325f 272b 7365 6c66  alues['q2_'+self
+0002b470: 2e6c 645f 696e 616d 655b 696e 7374 7275  .ld_iname[instru
+0002b480: 6d65 6e74 5d5d 290a 0a20 2020 2020 2020  ment]])..       
+0002b490: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
+0002b4a0: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
+0002b4b0: 7374 7275 6d65 6e74 5d5b 276c 646c 6177  strument]['ldlaw
+0002b4c0: 275d 203d 3d20 276e 6f6e 6527 3a0a 0a20  '] == 'none':.. 
+0002b4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b4e0: 2020 2063 6f65 6666 312c 2063 6f65 6666     coeff1, coeff
+0002b4f0: 3220 3d20 302e 312c 2030 2e33 0a0a 2020  2 = 0.1, 0.3..  
+0002b500: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0002b510: 7365 3a0a 0a20 2020 2020 2020 2020 2020  se:..           
+0002b520: 2020 2020 2020 2020 2063 6f65 6666 3120           coeff1 
+0002b530: 3d20 7061 7261 6d65 7465 725f 7661 6c75  = parameter_valu
+0002b540: 6573 5b27 7131 5f27 202b 2073 656c 662e  es['q1_' + self.
+0002b550: 6c64 5f69 6e61 6d65 5b69 6e73 7472 756d  ld_iname[instrum
+0002b560: 656e 745d 5d0a 0a20 2020 2020 2020 2020  ent]]..         
+0002b570: 2020 2020 2020 2023 2046 6972 7374 2028         # First (
+0002b580: 3129 2063 6865 636b 2069 6620 5454 5620  1) check if TTV 
+0002b590: 6d6f 6465 2069 7320 6163 7469 7661 7465  mode is activate
+0002b5a0: 642e 2049 6620 6974 2069 7320 6e6f 742c  d. If it is not,
+0002b5b0: 2073 696d 706c 7920 7361 7665 2074 6865   simply save the
+0002b5c0: 2073 616d 706c 6564 2070 6c61 6e65 7420   sampled planet 
+0002b5d0: 7065 7269 6f64 7320 616e 6420 7469 6d65  periods and time
+0002b5e0: 2d6f 6620 7472 616e 7369 7420 6365 6e74  -of transit cent
+0002b5f0: 6572 7320 666f 7220 6368 6563 6b0a 2020  ers for check.  
+0002b600: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0002b610: 696e 2074 6865 206e 6578 7420 726f 756e  in the next roun
+0002b620: 6420 6f66 2069 7465 7261 7469 6f6e 2028  d of iteration (
+0002b630: 7365 6520 6265 6c6f 7729 2e20 4966 2069  see below). If i
+0002b640: 7420 6973 2c20 6465 7065 6e64 696e 6720  t is, depending 
+0002b650: 6f6e 2074 6865 2070 6172 616d 6574 7269  on the parametri
+0002b660: 7a61 7469 6f6e 2c20 6569 7468 6572 2073  zation, either s
+0002b670: 6869 6674 2074 6865 2074 696d 652d 696e  hift the time-in
+0002b680: 6465 7865 7320 6163 636f 7264 696e 676c  dexes accordingl
+0002b690: 7920 2873 6565 2062 656c 6f77 0a20 2020  y (see below.   
+0002b6a0: 2020 2020 2020 2020 2020 2020 2023 2063               # c
+0002b6b0: 6f6d 6d65 6e74 7320 666f 7220 6465 7461  omments for deta
+0002b6c0: 696c 7329 2e0a 2020 2020 2020 2020 2020  ils)..          
+0002b6d0: 2020 2020 2020 6350 2c20 6374 3020 3d20        cP, ct0 = 
+0002b6e0: 7b7d 2c20 7b7d 0a0a 2020 2020 2020 2020  {}, {}..        
+0002b6f0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+0002b700: 2073 656c 662e 6e75 6d62 6572 696e 673a   self.numbering:
+0002b710: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002b720: 2020 2020 2020 2320 4368 6563 6b20 6966        # Check if
+0002b730: 2077 6520 7769 6c6c 2062 6520 6669 7474   we will be fitt
+0002b740: 696e 6720 666f 7220 5454 5673 2e20 4966  ing for TTVs. If
+0002b750: 206e 6f74 2c20 616c 6c20 676f 6573 2061   not, all goes a
+0002b760: 7320 7573 7561 6c2e 2049 6620 7765 2061  s usual. If we a
+0002b770: 7265 2c20 6368 6563 6b20 7768 6963 6820  re, check which 
+0002b780: 7061 7261 6d65 7472 697a 6174 696f 6e20  parametrization 
+0002b790: 2864 7420 6f72 2054 293a 0a20 2020 2020  (dt or T):.     
+0002b7a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002b7b0: 6620 6e6f 7420 7365 6c66 2e64 6963 7469  f not self.dicti
+0002b7c0: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
+0002b7d0: 5d5b 2754 5456 7327 5d5b 695d 5b27 7374  ]['TTVs'][i]['st
+0002b7e0: 6174 7573 275d 3a0a 0a20 2020 2020 2020  atus']:..       
+0002b7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b800: 2074 302c 2050 203d 2070 6172 616d 6574   t0, P = paramet
+0002b810: 6572 5f76 616c 7565 735b 0a20 2020 2020  er_values[.     
+0002b820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b830: 2020 2020 2020 2027 7430 5f70 2720 2b20         't0_p' + 
+0002b840: 7374 7228 6929 5d2c 2070 6172 616d 6574  str(i)], paramet
+0002b850: 6572 5f76 616c 7565 735b 2750 5f70 2720  er_values['P_p' 
+0002b860: 2b20 7374 7228 6929 5d0a 0a20 2020 2020  + str(i)]..     
+0002b870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b880: 2020 2063 505b 695d 2c20 6374 305b 695d     cP[i], ct0[i]
+0002b890: 203d 2050 2c20 7430 0a0a 2020 2020 2020   = P, t0..      
+0002b8a0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0002b8b0: 7365 3a0a 0a20 2020 2020 2020 2020 2020  se:..           
+0002b8c0: 2020 2020 2020 2020 2020 2020 2023 2049               # I
+0002b8d0: 6620 5454 5673 2069 7320 6f6e 2066 6f72  f TTVs is on for
+0002b8e0: 2070 6c61 6e65 7420 692c 2063 6f6d 7075   planet i, compu
+0002b8f0: 7465 2074 6865 2065 7870 6563 7465 6420  te the expected 
+0002b900: 7469 6d65 206f 6620 7472 616e 7369 742c  time of transit,
+0002b910: 2061 6e64 2073 6869 6674 2069 742e 2046   and shift it. F
+0002b920: 6f72 2074 6869 732c 2075 7365 2069 6e66  or this, use inf
+0002b930: 6f72 6d61 7469 6f6e 2065 6e63 6f64 6564  ormation encoded
+0002b940: 2069 6e20 7468 6520 7072 696f 720a 2020   in the prior.  
+0002b950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b960: 2020 2020 2020 2320 6e61 6d65 3b20 6966        # name; if
+0002b970: 2c20 652e 672e 2c20 6474 5f70 315f 5445  , e.g., dt_p1_TE
+0002b980: 5353 315f 2d32 2c20 7468 656e 206e 203d  SS1_-2, then n =
+0002b990: 202d 3220 616e 6420 7468 6520 7469 6d65   -2 and the time
+0002b9a0: 206f 6620 7472 616e 7369 7420 2877 6974   of transit (wit
+0002b9b0: 6820 5454 5629 203d 2074 3020 2b20 6e2a  h TTV) = t0 + n*
+0002b9c0: 5020 2b20 6474 5f70 315f 5445 5353 315f  P + dt_p1_TESS1_
+0002b9d0: 2d32 2069 6e20 7468 6520 6361 7365 206f  -2 in the case o
+0002b9e0: 6620 7468 6520 6474 0a20 2020 2020 2020  f the dt.       
+0002b9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ba00: 2023 2070 6172 616d 6574 7269 7a61 7469   # parametrizati
+0002ba10: 6f6e 2e20 496e 2074 6865 2063 6173 6520  on. In the case 
+0002ba20: 6f66 2074 6865 2054 2d70 6172 616d 6574  of the T-paramet
+0002ba30: 7269 7a61 7469 6f6e 2c20 7468 6520 7469  rization, the ti
+0002ba40: 6d65 206f 6620 7472 616e 7369 7420 7769  me of transit wi
+0002ba50: 7468 2054 5456 2077 6f75 6c64 2062 6520  th TTV would be 
+0002ba60: 545f 7031 5f54 4553 5331 5f2d 322c 2061  T_p1_TESS1_-2, a
+0002ba70: 6e64 2074 6865 2070 6572 696f 6420 616e  nd the period an
+0002ba80: 6420 7430 0a20 2020 2020 2020 2020 2020  d t0.           
+0002ba90: 2020 2020 2020 2020 2020 2020 2023 2077               # w
+0002baa0: 696c 6c20 6265 2064 6572 6976 6564 2066  ill be derived f
+0002bab0: 726f 6d20 7468 6572 6520 6672 6f6d 2074  rom there from t
+0002bac0: 6865 206c 6561 7374 2d73 7175 6172 6573  he least-squares
+0002bad0: 2073 6c6f 7065 2061 6e64 2069 6e74 6572   slope and inter
+0002bae0: 6365 7074 2c20 7265 7370 6563 7469 7665  cept, respective
+0002baf0: 6c79 2c20 746f 2074 6865 2054 2773 2e20  ly, to the T's. 
+0002bb00: 436f 6d70 7574 6520 7472 616e 7369 740a  Compute transit.
 0002bb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb20: 2020 2020 2020 2023 2054 6869 7320 696d         # This im
-0002bb30: 706c 6963 6974 6c79 2073 6574 7320 6d61  plicitly sets ma
-0002bb40: 7869 6d75 6d20 7472 616e 7369 7420 6475  ximum transit du
-0002bb50: 7261 7469 6f6e 2074 6f20 502f 3220 6461  ration to P/2 da
-0002bb60: 7973 3a0a 2020 2020 2020 2020 2020 2020  ys:.            
-0002bb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb80: 2020 2020 6964 7820 3d20 6e70 2e77 6865      idx = np.whe
-0002bb90: 7265 280a 2020 2020 2020 2020 2020 2020  re(.            
-0002bba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bbb0: 2020 2020 2020 2020 6e70 2e61 6273 2873          np.abs(s
-0002bbc0: 656c 662e 7469 6d65 735b 696e 7374 7275  elf.times[instru
-0002bbd0: 6d65 6e74 5d20 2d0a 2020 2020 2020 2020  ment] -.        
-0002bbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bc00: 2020 2074 7261 6e73 6974 5f74 696d 6529     transit_time)
-0002bc10: 203c 2050 202f 2034 2e29 5b30 5d0a 0a20   < P / 4.)[0].. 
-0002bc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bc30: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0002bc40: 756d 6d79 5f74 696d 655b 6964 785d 203d  ummy_time[idx] =
-0002bc50: 2073 656c 662e 7469 6d65 735b 696e 7374   self.times[inst
-0002bc60: 7275 6d65 6e74 5d5b 0a20 2020 2020 2020  rument][.       
-0002bc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bc80: 2020 2020 2020 2020 2020 2020 2069 6478               idx
-0002bc90: 5d20 2d20 7061 7261 6d65 7465 725f 7661  ] - parameter_va
-0002bca0: 6c75 6573 5b27 6474 5f70 2720 2b20 7374  lues['dt_p' + st
-0002bcb0: 7228 6929 202b 0a20 2020 2020 2020 2020  r(i) +.         
-0002bcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bb20: 2020 2020 2020 2020 2320 6d6f 6465 6c20          # model 
+0002bb30: 6173 7375 6d69 6e67 2074 6861 7420 7469  assuming that ti
+0002bb40: 6d65 2d6f 662d 7472 616e 7369 743b 2072  me-of-transit; r
+0002bb50: 6570 6561 7420 666f 7220 616c 6c20 7468  epeat for all th
+0002bb60: 6520 7472 616e 7369 7473 2e20 4765 6e65  e transits. Gene
+0002bb70: 7261 6c6c 7920 7573 6572 7320 7769 6c6c  rally users will
+0002bb80: 206e 6f74 2064 6f20 5454 5620 616e 616c   not do TTV anal
+0002bb90: 7973 6573 2c20 736f 2073 6574 2074 6869  yses, so set thi
+0002bba0: 7320 6c61 7474 6572 0a20 2020 2020 2020  s latter.       
+0002bbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bbc0: 2023 2063 6173 6520 746f 2062 6520 7468   # case to be th
+0002bbd0: 6520 6d6f 7374 2063 6f6d 6d6f 6e20 6f6e  e most common on
+0002bbe0: 6520 6279 2064 6566 6175 6c74 2069 6e20  e by default in 
+0002bbf0: 7468 6520 6966 2d73 7461 7465 6d65 6e74  the if-statement
+0002bc00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002bc10: 2020 2020 2020 2020 2020 6475 6d6d 795f            dummy_
+0002bc20: 7469 6d65 203d 206e 702e 636f 7079 2873  time = np.copy(s
+0002bc30: 656c 662e 7469 6d65 735b 696e 7374 7275  elf.times[instru
+0002bc40: 6d65 6e74 5d29 0a0a 2020 2020 2020 2020  ment])..        
+0002bc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bc60: 6966 2073 656c 662e 6469 6374 696f 6e61  if self.dictiona
+0002bc70: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
+0002bc80: 5454 5673 275d 5b69 5d5b 0a20 2020 2020  TTVs'][i][.     
+0002bc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bca0: 2020 2020 2020 2020 2020 2027 7061 7261             'para
+0002bcb0: 6d65 7472 697a 6174 696f 6e27 5d20 3d3d  metrization'] ==
+0002bcc0: 2027 6474 273a 0a0a 2020 2020 2020 2020   'dt':..        
 0002bcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bcf0: 2020 2027 5f27 202b 2069 6e73 7472 756d     '_' + instrum
-0002bd00: 656e 7420 2b0a 2020 2020 2020 2020 2020  ent +.          
-0002bd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bd40: 2020 275f 2720 2b0a 2020 2020 2020 2020    '_' +.        
+0002bce0: 2020 2020 7430 2c20 5020 3d20 7061 7261      t0, P = para
+0002bcf0: 6d65 7465 725f 7661 6c75 6573 5b0a 2020  meter_values[.  
+0002bd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bd10: 2020 2020 2020 2020 2020 2020 2020 2774                't
+0002bd20: 305f 7027 202b 2073 7472 2869 295d 2c20  0_p' + str(i)], 
+0002bd30: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0002bd40: 5b27 505f 7027 202b 0a20 2020 2020 2020  ['P_p' +.       
 0002bd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002bd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002bd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bd80: 2020 2020 7374 7228 7472 616e 7369 745f      str(transit_
-0002bd90: 6e75 6d62 6572 295d 0a0a 2020 2020 2020  number)]..      
+0002bd80: 2020 2020 2020 2020 2020 2020 7374 7228              str(
+0002bd90: 6929 5d0a 0a20 2020 2020 2020 2020 2020  i)]..           
 0002bda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bdb0: 2020 656c 7365 3a0a 0a20 2020 2020 2020    else:..       
-0002bdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bdd0: 2020 2020 2074 302c 2050 203d 2070 6c61       t0, P = pla
-0002bde0: 6e65 745f 7430 5b69 5d2c 2070 6c61 6e65  net_t0[i], plane
-0002bdf0: 745f 505b 695d 0a0a 2020 2020 2020 2020  t_P[i]..        
-0002be00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002be10: 2020 2020 666f 7220 7472 616e 7369 745f      for transit_
-0002be20: 6e75 6d62 6572 2069 6e20 7365 6c66 2e64  number in self.d
-0002be30: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
-0002be40: 6d65 6e74 5d5b 0a20 2020 2020 2020 2020  ment][.         
-0002be50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002be60: 2020 2020 2020 2020 2020 2027 5454 5673             'TTVs
-0002be70: 275d 5b69 6e74 2869 295d 5b27 7472 616e  '][int(i)]['tran
-0002be80: 7369 745f 6e75 6d62 6572 275d 3a0a 0a20  sit_number']:.. 
-0002be90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bea0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0002beb0: 7420 3d20 7061 7261 6d65 7465 725f 7661  t = parameter_va
-0002bec0: 6c75 6573 5b0a 2020 2020 2020 2020 2020  lues[.          
-0002bed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bee0: 2020 2020 2020 2020 2020 2754 5f70 2720            'T_p' 
-0002bef0: 2b20 7374 7228 6929 202b 2027 5f27 202b  + str(i) + '_' +
-0002bf00: 2069 6e73 7472 756d 656e 7420 2b20 275f   instrument + '_
-0002bf10: 2720 2b0a 2020 2020 2020 2020 2020 2020  ' +.            
-0002bf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bf30: 2020 2020 2020 2020 7374 7228 7472 616e          str(tran
-0002bf40: 7369 745f 6e75 6d62 6572 295d 202d 2028  sit_number)] - (
-0002bf50: 7430 202b 0a20 2020 2020 2020 2020 2020  t0 +.           
-0002bf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bf90: 2074 7261 6e73 6974 5f6e 756d 6265 7220   transit_number 
-0002bfa0: 2a20 5029 0a0a 2020 2020 2020 2020 2020  * P)..          
+0002bdb0: 2063 505b 695d 2c20 6374 305b 695d 203d   cP[i], ct0[i] =
+0002bdc0: 2050 2c20 7430 0a0a 2020 2020 2020 2020   P, t0..        
+0002bdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bde0: 2020 2020 666f 7220 7472 616e 7369 745f      for transit_
+0002bdf0: 6e75 6d62 6572 2069 6e20 7365 6c66 2e64  number in self.d
+0002be00: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
+0002be10: 6d65 6e74 5d5b 0a20 2020 2020 2020 2020  ment][.         
+0002be20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002be30: 2020 2020 2020 2020 2020 2027 5454 5673             'TTVs
+0002be40: 275d 5b69 6e74 2869 295d 5b27 7472 616e  '][int(i)]['tran
+0002be50: 7369 745f 6e75 6d62 6572 275d 3a0a 0a20  sit_number']:.. 
+0002be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002be70: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0002be80: 7261 6e73 6974 5f74 696d 6520 3d20 7430  ransit_time = t0
+0002be90: 202b 2074 7261 6e73 6974 5f6e 756d 6265   + transit_numbe
+0002bea0: 7220 2a20 5020 2b20 7061 7261 6d65 7465  r * P + paramete
+0002beb0: 725f 7661 6c75 6573 5b0a 2020 2020 2020  r_values[.      
+0002bec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bed0: 2020 2020 2020 2020 2020 2020 2020 2764                'd
+0002bee0: 745f 7027 202b 2073 7472 2869 2920 2b20  t_p' + str(i) + 
+0002bef0: 275f 2720 2b20 696e 7374 7275 6d65 6e74  '_' + instrument
+0002bf00: 202b 2027 5f27 202b 0a20 2020 2020 2020   + '_' +.       
+0002bf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bf20: 2020 2020 2020 2020 2020 2020 2073 7472               str
+0002bf30: 2874 7261 6e73 6974 5f6e 756d 6265 7229  (transit_number)
+0002bf40: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0002bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bf60: 2020 2023 2054 6869 7320 696d 706c 6963     # This implic
+0002bf70: 6974 6c79 2073 6574 7320 6d61 7869 6d75  itly sets maximu
+0002bf80: 6d20 7472 616e 7369 7420 6475 7261 7469  m transit durati
+0002bf90: 6f6e 2074 6f20 502f 3220 6461 7973 3a0a  on to P/2 days:.
+0002bfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002bfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bfc0: 2020 2020 2020 2320 5468 6973 2069 6d70        # This imp
-0002bfd0: 6c69 6369 746c 7920 7365 7473 206d 6178  licitly sets max
-0002bfe0: 696d 756d 2074 7261 6e73 6974 2064 7572  imum transit dur
-0002bff0: 6174 696f 6e20 746f 2050 2f32 2064 6179  ation to P/2 day
-0002c000: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-0002c010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c020: 2020 2069 6478 203d 206e 702e 7768 6572     idx = np.wher
-0002c030: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-0002c040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c050: 2020 2020 2020 206e 702e 6162 7328 7365         np.abs(se
-0002c060: 6c66 2e74 696d 6573 5b69 6e73 7472 756d  lf.times[instrum
-0002c070: 656e 745d 202d 0a20 2020 2020 2020 2020  ent] -.         
-0002c080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c0a0: 2020 7061 7261 6d65 7465 725f 7661 6c75    parameter_valu
-0002c0b0: 6573 5b0a 2020 2020 2020 2020 2020 2020  es[.            
-0002c0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c0e0: 2020 2027 545f 7027 202b 2073 7472 2869     'T_p' + str(i
-0002c0f0: 2920 2b20 275f 2720 2b0a 2020 2020 2020  ) + '_' +.      
+0002bfc0: 6964 7820 3d20 6e70 2e77 6865 7265 280a  idx = np.where(.
+0002bfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bff0: 2020 2020 6e70 2e61 6273 2873 656c 662e      np.abs(self.
+0002c000: 7469 6d65 735b 696e 7374 7275 6d65 6e74  times[instrument
+0002c010: 5d20 2d0a 2020 2020 2020 2020 2020 2020  ] -.            
+0002c020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c030: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0002c040: 7261 6e73 6974 5f74 696d 6529 203c 2050  ransit_time) < P
+0002c050: 202f 2034 2e29 5b30 5d0a 0a20 2020 2020   / 4.)[0]..     
+0002c060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c070: 2020 2020 2020 2020 2020 2064 756d 6d79             dummy
+0002c080: 5f74 696d 655b 6964 785d 203d 2073 656c  _time[idx] = sel
+0002c090: 662e 7469 6d65 735b 696e 7374 7275 6d65  f.times[instrume
+0002c0a0: 6e74 5d5b 0a20 2020 2020 2020 2020 2020  nt][.           
+0002c0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c0c0: 2020 2020 2020 2020 2069 6478 5d20 2d20           idx] - 
+0002c0d0: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0002c0e0: 5b27 6474 5f70 2720 2b20 7374 7228 6929  ['dt_p' + str(i)
+0002c0f0: 202b 0a20 2020 2020 2020 2020 2020 2020   +.             
 0002c100: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002c110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c120: 2020 2020 2020 2020 2069 6e73 7472 756d           instrum
-0002c130: 656e 7420 2b20 275f 2720 2b0a 2020 2020  ent + '_' +.    
-0002c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c120: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0002c130: 5f27 202b 2069 6e73 7472 756d 656e 7420  _' + instrument 
+0002c140: 2b0a 2020 2020 2020 2020 2020 2020 2020  +.              
 0002c150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c160: 2020 2020 2020 2020 2020 2073 7472 2874             str(t
-0002c170: 7261 6e73 6974 5f6e 756d 6265 7229 5d29  ransit_number)])
-0002c180: 203c 2050 202f 0a20 2020 2020 2020 2020   < P /.         
+0002c160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c170: 2020 2020 2020 2020 2020 2020 2020 275f                '_
+0002c180: 2720 2b0a 2020 2020 2020 2020 2020 2020  ' +.            
 0002c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c1a0: 2020 2020 2020 2020 2020 2034 2e29 5b30             4.)[0
-0002c1b0: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
-0002c1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c1d0: 2020 2064 756d 6d79 5f74 696d 655b 0a20     dummy_time[. 
-0002c1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c200: 2020 2069 6478 5d20 3d20 7365 6c66 2e74     idx] = self.t
-0002c210: 696d 6573 5b69 6e73 7472 756d 656e 745d  imes[instrument]
-0002c220: 5b69 6478 5d20 2d20 6474 0a0a 2020 2020  [idx] - dt..    
-0002c230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c240: 2020 2020 2020 2020 6350 5b69 5d2c 2063          cP[i], c
-0002c250: 7430 5b69 5d20 3d20 502c 2074 300a 0a20  t0[i] = P, t0.. 
-0002c260: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0002c270: 2057 6865 7468 6572 2074 6865 7265 2061   Whether there a
-0002c280: 7265 2054 5456 7320 6f72 206e 6f74 2c20  re TTVs or not, 
-0002c290: 616e 6420 6265 666f 7265 2061 6e79 7468  and before anyth
-0002c2a0: 696e 6720 636f 6e74 696e 7565 732c 2063  ing continues, c
-0002c2b0: 6865 636b 2074 6865 2070 6572 696f 6473  heck the periods
-0002c2c0: 2061 7265 2063 6872 6f6e 6f6c 6f67 6963   are chronologic
-0002c2d0: 616c 6c79 206f 7264 6572 6564 2028 7468  ally ordered (th
-0002c2e0: 6973 2069 7320 746f 2061 766f 6964 206d  is is to avoid m
-0002c2f0: 756c 7469 706c 6520 6d6f 6465 730a 2020  ultiple modes.  
-0002c300: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0002c310: 6475 6520 746f 2070 6572 696f 6473 2022  due to periods "
-0002c320: 6a75 6d70 696e 6722 2062 6574 7765 656e  jumping" between
-0002c330: 2070 6c61 6e65 7420 6e75 6d62 6572 696e   planet numberin
-0002c340: 6729 3a0a 2020 2020 2020 2020 2020 2020  g):.            
-0002c350: 2020 2020 6669 7273 745f 7469 6d65 203d      first_time =
-0002c360: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-0002c370: 2020 2020 2020 666f 7220 6920 696e 2073        for i in s
-0002c380: 656c 662e 6e75 6d62 6572 696e 673a 0a0a  elf.numbering:..
-0002c390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c3a0: 2020 2020 6966 2066 6972 7374 5f74 696d      if first_tim
-0002c3b0: 653a 0a0a 2020 2020 2020 2020 2020 2020  e:..            
-0002c3c0: 2020 2020 2020 2020 2020 2020 6363 5020              ccP 
-0002c3d0: 3d20 6350 5b69 5d20 2023 7061 7261 6d65  = cP[i]  #parame
-0002c3e0: 7465 725f 7661 6c75 6573 5b27 505f 7027  ter_values['P_p'
-0002c3f0: 2b73 7472 2869 295d 0a20 2020 2020 2020  +str(i)].       
-0002c400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c410: 2066 6972 7374 5f74 696d 6520 3d20 4661   first_time = Fa
-0002c420: 6c73 650a 0a20 2020 2020 2020 2020 2020  lse..           
-0002c430: 2020 2020 2020 2020 2065 6c73 653a 0a0a           else:..
+0002c1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c1c0: 7374 7228 7472 616e 7369 745f 6e75 6d62  str(transit_numb
+0002c1d0: 6572 295d 0a0a 2020 2020 2020 2020 2020  er)]..          
+0002c1e0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0002c1f0: 7365 3a0a 0a20 2020 2020 2020 2020 2020  se:..           
+0002c200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c210: 2074 302c 2050 203d 2070 6c61 6e65 745f   t0, P = planet_
+0002c220: 7430 5b69 5d2c 2070 6c61 6e65 745f 505b  t0[i], planet_P[
+0002c230: 695d 0a0a 2020 2020 2020 2020 2020 2020  i]..            
+0002c240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c250: 666f 7220 7472 616e 7369 745f 6e75 6d62  for transit_numb
+0002c260: 6572 2069 6e20 7365 6c66 2e64 6963 7469  er in self.dicti
+0002c270: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
+0002c280: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
+0002c290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c2a0: 2020 2020 2020 2027 5454 5673 275d 5b69         'TTVs'][i
+0002c2b0: 6e74 2869 295d 5b27 7472 616e 7369 745f  nt(i)]['transit_
+0002c2c0: 6e75 6d62 6572 275d 3a0a 0a20 2020 2020  number']:..     
+0002c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c2e0: 2020 2020 2020 2020 2020 2064 7420 3d20             dt = 
+0002c2f0: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0002c300: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+0002c310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c320: 2020 2020 2020 2754 5f70 2720 2b20 7374        'T_p' + st
+0002c330: 7228 6929 202b 2027 5f27 202b 2069 6e73  r(i) + '_' + ins
+0002c340: 7472 756d 656e 7420 2b20 275f 2720 2b0a  trument + '_' +.
+0002c350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c370: 2020 2020 7374 7228 7472 616e 7369 745f      str(transit_
+0002c380: 6e75 6d62 6572 295d 202d 2028 7430 202b  number)] - (t0 +
+0002c390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c3c0: 2020 2020 2020 2020 2020 2020 2074 7261               tra
+0002c3d0: 6e73 6974 5f6e 756d 6265 7220 2a20 5029  nsit_number * P)
+0002c3e0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c400: 2020 2320 5468 6973 2069 6d70 6c69 6369    # This implici
+0002c410: 746c 7920 7365 7473 206d 6178 696d 756d  tly sets maximum
+0002c420: 2074 7261 6e73 6974 2064 7572 6174 696f   transit duratio
+0002c430: 6e20 746f 2050 2f32 2064 6179 733a 0a20  n to P/2 days:. 
 0002c440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c450: 2020 2020 2020 2020 6966 2063 6350 203c          if ccP <
-0002c460: 2063 505b 695d 3a20 2023 7061 7261 6d65   cP[i]:  #parame
-0002c470: 7465 725f 7661 6c75 6573 5b27 505f 7027  ter_values['P_p'
-0002c480: 2b73 7472 2869 295d 3a0a 0a20 2020 2020  +str(i)]:..     
-0002c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c4a0: 2020 2020 2020 2063 6350 203d 2063 505b         ccP = cP[
-0002c4b0: 695d 2020 2370 6172 616d 6574 6572 5f76  i]  #parameter_v
-0002c4c0: 616c 7565 735b 2750 5f70 272b 7374 7228  alues['P_p'+str(
-0002c4d0: 6929 5d0a 0a20 2020 2020 2020 2020 2020  i)]..           
-0002c4e0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0002c4f0: 653a 0a0a 2020 2020 2020 2020 2020 2020  e:..            
+0002c450: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002c460: 6478 203d 206e 702e 7768 6572 6528 0a20  dx = np.where(. 
+0002c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c490: 2020 206e 702e 6162 7328 7365 6c66 2e74     np.abs(self.t
+0002c4a0: 696d 6573 5b69 6e73 7472 756d 656e 745d  imes[instrument]
+0002c4b0: 202d 0a20 2020 2020 2020 2020 2020 2020   -.             
+0002c4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c4d0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0002c4e0: 7261 6d65 7465 725f 7661 6c75 6573 5b0a  rameter_values[.
+0002c4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002c500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c510: 7365 6c66 2e6d 6f64 656c 4f4b 203d 2046  self.modelOK = F
-0002c520: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-0002c530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c540: 2072 6574 7572 6e20 4661 6c73 650a 0a20   return False.. 
-0002c550: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0002c560: 204f 6e63 6520 616c 6c20 6973 204f 4b20   Once all is OK 
-0002c570: 7769 7468 2074 6865 2070 6572 696f 6473  with the periods
-0002c580: 2061 6e64 2074 696d 652d 6f66 2d74 7261   and time-of-tra
-0002c590: 6e73 6974 2063 656e 7465 7273 2c20 6c6f  nsit centers, lo
-0002c5a0: 6f70 2074 6872 6f75 6768 2061 6c6c 2074  op through all t
-0002c5b0: 6865 2070 6c61 6e65 7473 2c20 6765 7474  he planets, gett
-0002c5c0: 696e 6720 7468 6520 6c69 6768 7463 7572  ing the lightcur
-0002c5d0: 7665 206d 6f64 656c 2066 6f72 2065 6163  ve model for eac
-0002c5e0: 683a 0a20 2020 2020 2020 2020 2020 2020  h:.             
-0002c5f0: 2020 2066 6f72 2069 2069 6e20 7365 6c66     for i in self
-0002c600: 2e6e 756d 6265 7269 6e67 3a0a 0a20 2020  .numbering:..   
-0002c610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c620: 2050 2c20 7430 203d 2063 505b 695d 2c20   P, t0 = cP[i], 
-0002c630: 6374 305b 695d 0a0a 2020 2020 2020 2020  ct0[i]..        
-0002c640: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-0002c650: 466f 7220 696e 7374 7275 6d65 6e74 2064  For instrument d
-0002c660: 6570 656e 6465 6e74 2065 636c 6970 7365  ependent eclipse
-0002c670: 2064 6570 7468 3a0a 2020 2020 2020 2020   depth:.        
-0002c680: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-0002c690: 5765 206f 6e6c 7920 7761 6e74 2074 6f20  We only want to 
-0002c6a0: 6d61 6b65 2065 636c 6970 7365 2064 6570  make eclipse dep
-0002c6b0: 7468 2069 6e73 7472 756d 656e 7420 6465  th instrument de
-0002c6c0: 7065 6e64 6564 2c20 6e6f 7420 7468 6520  pended, not the 
-0002c6d0: 7469 6d65 2063 6f72 7265 6374 696f 6e20  time correction 
-0002c6e0: 6661 6374 6f72 0a20 2020 2020 2020 2020  factor.         
-0002c6f0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0002c700: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
-0002c710: 7374 7275 6d65 6e74 5d5b 2745 636c 6970  strument]['Eclip
-0002c720: 7365 4669 7427 5d20 6f72 2073 656c 662e  seFit'] or self.
-0002c730: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
-0002c740: 756d 656e 745d 5b27 5472 616e 4563 6c46  ument]['TranEclF
-0002c750: 6974 275d 3a0a 0a20 2020 2020 2020 2020  it']:..         
-0002c760: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0002c770: 7020 3d20 7061 7261 6d65 7465 725f 7661  p = parameter_va
-0002c780: 6c75 6573 5b27 6670 5f70 2720 2b20 7374  lues['fp_p' + st
-0002c790: 7228 6929 202b 2073 656c 662e 6670 5f69  r(i) + self.fp_i
-0002c7a0: 6e61 6d65 5b27 7027 202b 2073 7472 2869  name['p' + str(i
-0002c7b0: 295d 5b69 6e73 7472 756d 656e 745d 5d0a  )][instrument]].
-0002c7c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002c7d0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0002c7e0: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
-0002c7f0: 7275 6d65 6e74 5d5b 2750 6861 7365 4375  rument]['PhaseCu
-0002c800: 7276 6546 6974 275d 3a0a 0a20 2020 2020  rveFit']:..     
-0002c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c820: 2020 2020 2020 2070 6861 7365 5f6f 6666         phase_off
-0002c830: 7365 7420 3d20 7061 7261 6d65 7465 725f  set = parameter_
-0002c840: 7661 6c75 6573 5b27 7068 6173 656f 6666  values['phaseoff
-0002c850: 7365 745f 7027 202b 2073 7472 2869 2920  set_p' + str(i) 
-0002c860: 2b20 7365 6c66 2e70 6861 7365 6f66 6673  + self.phaseoffs
-0002c870: 6574 5f69 6e61 6d65 5b27 7027 202b 2073  et_iname['p' + s
-0002c880: 7472 2869 295d 5b69 6e73 7472 756d 656e  tr(i)][instrumen
-0002c890: 745d 5d0a 0a20 2020 2020 2020 2020 2020  t]]..           
-0002c8a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0002c8b0: 6e6f 7420 7365 6c66 2e6c 6967 6874 5f74  not self.light_t
-0002c8c0: 7261 7665 6c5f 6465 6c61 793a 0a0a 2020  ravel_delay:..  
+0002c510: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0002c520: 545f 7027 202b 2073 7472 2869 2920 2b20  T_p' + str(i) + 
+0002c530: 275f 2720 2b0a 2020 2020 2020 2020 2020  '_' +.          
+0002c540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c560: 2020 2020 2069 6e73 7472 756d 656e 7420       instrument 
+0002c570: 2b20 275f 2720 2b0a 2020 2020 2020 2020  + '_' +.        
+0002c580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c5a0: 2020 2020 2020 2073 7472 2874 7261 6e73         str(trans
+0002c5b0: 6974 5f6e 756d 6265 7229 5d29 203c 2050  it_number)]) < P
+0002c5c0: 202f 0a20 2020 2020 2020 2020 2020 2020   /.             
+0002c5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c5e0: 2020 2020 2020 2034 2e29 5b30 5d0a 0a20         4.)[0].. 
+0002c5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c600: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0002c610: 756d 6d79 5f74 696d 655b 0a20 2020 2020  ummy_time[.     
+0002c620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c630: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002c640: 6478 5d20 3d20 7365 6c66 2e74 696d 6573  dx] = self.times
+0002c650: 5b69 6e73 7472 756d 656e 745d 5b69 6478  [instrument][idx
+0002c660: 5d20 2d20 6474 0a0a 2020 2020 2020 2020  ] - dt..        
+0002c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c680: 2020 2020 6350 5b69 5d2c 2063 7430 5b69      cP[i], ct0[i
+0002c690: 5d20 3d20 502c 2074 300a 0a20 2020 2020  ] = P, t0..     
+0002c6a0: 2020 2020 2020 2020 2020 2023 2057 6865             # Whe
+0002c6b0: 7468 6572 2074 6865 7265 2061 7265 2054  ther there are T
+0002c6c0: 5456 7320 6f72 206e 6f74 2c20 616e 6420  TVs or not, and 
+0002c6d0: 6265 666f 7265 2061 6e79 7468 696e 6720  before anything 
+0002c6e0: 636f 6e74 696e 7565 732c 2063 6865 636b  continues, check
+0002c6f0: 2074 6865 2070 6572 696f 6473 2061 7265   the periods are
+0002c700: 2063 6872 6f6e 6f6c 6f67 6963 616c 6c79   chronologically
+0002c710: 206f 7264 6572 6564 2028 7468 6973 2069   ordered (this i
+0002c720: 7320 746f 2061 766f 6964 206d 756c 7469  s to avoid multi
+0002c730: 706c 6520 6d6f 6465 730a 2020 2020 2020  ple modes.      
+0002c740: 2020 2020 2020 2020 2020 2320 6475 6520            # due 
+0002c750: 746f 2070 6572 696f 6473 2022 6a75 6d70  to periods "jump
+0002c760: 696e 6722 2062 6574 7765 656e 2070 6c61  ing" between pla
+0002c770: 6e65 7420 6e75 6d62 6572 696e 6729 3a0a  net numbering):.
+0002c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c790: 6669 7273 745f 7469 6d65 203d 2054 7275  first_time = Tru
+0002c7a0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0002c7b0: 2020 666f 7220 6920 696e 2073 656c 662e    for i in self.
+0002c7c0: 6e75 6d62 6572 696e 673a 0a0a 2020 2020  numbering:..    
+0002c7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c7e0: 6966 2066 6972 7374 5f74 696d 653a 0a0a  if first_time:..
+0002c7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c800: 2020 2020 2020 2020 6363 5020 3d20 6350          ccP = cP
+0002c810: 5b69 5d20 2023 7061 7261 6d65 7465 725f  [i]  #parameter_
+0002c820: 7661 6c75 6573 5b27 505f 7027 2b73 7472  values['P_p'+str
+0002c830: 2869 295d 0a20 2020 2020 2020 2020 2020  (i)].           
+0002c840: 2020 2020 2020 2020 2020 2020 2066 6972               fir
+0002c850: 7374 5f74 696d 6520 3d20 4661 6c73 650a  st_time = False.
+0002c860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c870: 2020 2020 2065 6c73 653a 0a0a 2020 2020       else:..    
+0002c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c890: 2020 2020 6966 2063 6350 203c 2063 505b      if ccP < cP[
+0002c8a0: 695d 3a20 2023 7061 7261 6d65 7465 725f  i]:  #parameter_
+0002c8b0: 7661 6c75 6573 5b27 505f 7027 2b73 7472  values['P_p'+str
+0002c8c0: 2869 295d 3a0a 0a20 2020 2020 2020 2020  (i)]:..         
 0002c8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c8e0: 2020 2020 2020 2020 2020 745f 7365 636f            t_seco
-0002c8f0: 6e64 6172 7920 3d20 7061 7261 6d65 7465  ndary = paramete
-0002c900: 725f 7661 6c75 6573 5b27 745f 7365 636f  r_values['t_seco
-0002c910: 6e64 6172 795f 7027 202b 2073 7472 2869  ndary_p' + str(i
-0002c920: 295d 0a0a 2020 2020 2020 2020 2020 2020  )]..            
-0002c930: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0002c940: 6469 6374 696f 6e61 7279 5b27 6566 6669  dictionary['effi
-0002c950: 6369 656e 745f 6270 275d 5b69 5d3a 0a20  cient_bp'][i]:. 
-0002c960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c970: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-0002c980: 6c66 2e64 6963 7469 6f6e 6172 795b 2766  lf.dictionary['f
-0002c990: 6974 7268 6f27 5d3a 0a20 2020 2020 2020  itrho']:.       
-0002c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c9b0: 2020 2020 2061 2c72 312c 7232 2020 203d       a,r1,r2   =
-0002c9c0: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
-0002c9d0: 735b 2761 5f70 272b 7374 7228 6929 5d2c  s['a_p'+str(i)],
-0002c9e0: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
-0002c9f0: 735b 2772 315f 7027 2b73 7472 2869 295d  s['r1_p'+str(i)]
-0002ca00: 2c5c 0a20 2020 2020 2020 2020 2020 2020  ,\.             
-0002ca10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ca20: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0002ca30: 6574 6572 5f76 616c 7565 735b 2772 325f  eter_values['r2_
-0002ca40: 7027 2b73 7472 2869 295d 0a20 2020 2020  p'+str(i)].     
-0002ca50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ca60: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0002ca70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ca80: 2020 2020 2072 686f 2c72 312c 7232 203d       rho,r1,r2 =
-0002ca90: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
-0002caa0: 735b 2772 686f 275d 2c20 7061 7261 6d65  s['rho'], parame
-0002cab0: 7465 725f 7661 6c75 6573 5b27 7231 5f70  ter_values['r1_p
-0002cac0: 272b 7374 7228 6929 5d2c 5c0a 2020 2020  '+str(i)],\.    
-0002cad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002caf0: 2020 2020 7061 7261 6d65 7465 725f 7661      parameter_va
-0002cb00: 6c75 6573 5b27 7232 5f70 272b 7374 7228  lues['r2_p'+str(
-0002cb10: 6929 5d0a 2020 2020 2020 2020 2020 2020  i)].            
-0002cb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cb30: 6120 3d20 2828 7268 6f20 2a20 4720 2a20  a = ((rho * G * 
-0002cb40: 2828 5020 2a20 3234 2e20 2a20 3336 3030  ((P * 24. * 3600
-0002cb50: 2e29 2a2a 3229 2920 2f0a 2020 2020 2020  .)**2)) /.      
-0002cb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cb70: 2020 2020 2020 2020 2020 2028 332e 202a             (3. *
-0002cb80: 206e 702e 7069 2929 2a2a 2831 2e20 2f20   np.pi))**(1. / 
-0002cb90: 332e 290a 2020 2020 2020 2020 2020 2020  3.).            
-0002cba0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-0002cbb0: 3120 3e20 7365 6c66 2e41 723a 0a20 2020  1 > self.Ar:.   
-0002cbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cbd0: 2020 2020 2020 2020 2062 2c70 203d 2028           b,p = (
-0002cbe0: 312b 7365 6c66 2e70 6c29 2a28 312e 202b  1+self.pl)*(1. +
-0002cbf0: 2028 7231 2d31 2e29 2f28 312e 2d73 656c   (r1-1.)/(1.-sel
-0002cc00: 662e 4172 2929 2c5c 0a20 2020 2020 2020  f.Ar)),\.       
-0002cc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cc20: 2020 2020 2020 2020 2020 2028 312d 7232             (1-r2
-0002cc30: 292a 7365 6c66 2e70 6c20 2b20 7232 2a73  )*self.pl + r2*s
-0002cc40: 656c 662e 7075 0a20 2020 2020 2020 2020  elf.pu.         
-0002cc50: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0002cc60: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0002cc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cc80: 2062 2c70 203d 2028 312e 202b 2073 656c   b,p = (1. + sel
-0002cc90: 662e 706c 2920 2b20 6e70 2e73 7172 7428  f.pl) + np.sqrt(
-0002cca0: 7231 2f73 656c 662e 4172 292a 7232 2a28  r1/self.Ar)*r2*(
-0002ccb0: 7365 6c66 2e70 752d 7365 6c66 2e70 6c29  self.pu-self.pl)
-0002ccc0: 2c5c 0a20 2020 2020 2020 2020 2020 2020  ,\.             
-0002ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cce0: 2020 2020 2073 656c 662e 7075 202b 2028       self.pu + (
-0002ccf0: 7365 6c66 2e70 6c2d 7365 6c66 2e70 7529  self.pl-self.pu)
-0002cd00: 2a6e 702e 7371 7274 2872 312f 7365 6c66  *np.sqrt(r1/self
-0002cd10: 2e41 7229 2a28 312e 2d72 3229 0a20 2020  .Ar)*(1.-r2).   
-0002cd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cd30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0002cd40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002cd50: 6620 6e6f 7420 7365 6c66 2e64 6963 7469  f not self.dicti
-0002cd60: 6f6e 6172 795b 2766 6974 7268 6f27 5d3a  onary['fitrho']:
-0002cd70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002cd80: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0002cd90: 6e6f 7420 7365 6c66 2e64 6963 7469 6f6e  not self.diction
-0002cda0: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
-0002cdb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002cdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cdd0: 2020 2020 2027 5472 616e 7369 7446 6974       'TransitFit
-0002cde0: 4361 7477 6f6d 616e 275d 3a0a 2020 2020  Catwoman']:.    
-0002cdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ce00: 2020 2020 2020 2020 2020 2020 612c 622c              a,b,
-0002ce10: 7020 3d20 7061 7261 6d65 7465 725f 7661  p = parameter_va
-0002ce20: 6c75 6573 5b27 615f 7027 2b73 7472 2869  lues['a_p'+str(i
-0002ce30: 295d 2c20 7061 7261 6d65 7465 725f 7661  )], parameter_va
-0002ce40: 6c75 6573 5b27 625f 7027 2b73 7472 2869  lues['b_p'+str(i
-0002ce50: 295d 2c5c 0a20 2020 2020 2020 2020 2020  )],\.           
-0002ce60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ce70: 2020 2020 2020 2020 2020 2020 2070 6172               par
-0002ce80: 616d 6574 6572 5f76 616c 7565 735b 2770  ameter_values['p
-0002ce90: 5f70 272b 7374 7228 6929 202b 2073 656c  _p'+str(i) + sel
-0002cea0: 662e 705f 696e 616d 655b 2770 2720 2b20  f.p_iname['p' + 
-0002ceb0: 7374 7228 6929 5d5b 696e 7374 7275 6d65  str(i)][instrume
-0002cec0: 6e74 5d5d 0a20 2020 2020 2020 2020 2020  nt]].           
-0002ced0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cee0: 2065 6c73 653a 0a0a 2020 2020 2020 2020   else:..        
-0002cef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cf00: 2020 2020 2020 2020 612c 622c 7031 2c70          a,b,p1,p
-0002cf10: 322c 7068 6920 3d20 7061 7261 6d65 7465  2,phi = paramete
-0002cf20: 725f 7661 6c75 6573 5b27 615f 7027 2b73  r_values['a_p'+s
-0002cf30: 7472 2869 295d 2c20 7061 7261 6d65 7465  tr(i)], paramete
-0002cf40: 725f 7661 6c75 6573 5b27 625f 7027 2b73  r_values['b_p'+s
-0002cf50: 7472 2869 295d 2c5c 0a20 2020 2020 2020  tr(i)],\.       
-0002cf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cf80: 2020 2020 2020 7061 7261 6d65 7465 725f        parameter_
-0002cf90: 7661 6c75 6573 5b27 7031 5f70 272b 7374  values['p1_p'+st
-0002cfa0: 7228 6929 202b 2073 656c 662e 7031 5f69  r(i) + self.p1_i
-0002cfb0: 6e61 6d65 5b27 7027 202b 2073 7472 2869  name['p' + str(i
-0002cfc0: 295d 5b69 6e73 7472 756d 656e 745d 5d2c  )][instrument]],
-0002cfd0: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
-0002cfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d000: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
-0002d010: 5b27 7032 5f70 272b 7374 7228 6929 202b  ['p2_p'+str(i) +
-0002d020: 2073 656c 662e 7031 5f69 6e61 6d65 5b27   self.p1_iname['
-0002d030: 7027 202b 2073 7472 2869 295d 5b69 6e73  p' + str(i)][ins
-0002d040: 7472 756d 656e 745d 5d2c 205c 0a20 2020  trument]], \.   
+0002c8e0: 2020 2063 6350 203d 2063 505b 695d 2020     ccP = cP[i]  
+0002c8f0: 2370 6172 616d 6574 6572 5f76 616c 7565  #parameter_value
+0002c900: 735b 2750 5f70 272b 7374 7228 6929 5d0a  s['P_p'+str(i)].
+0002c910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c920: 2020 2020 2020 2020 2065 6c73 653a 0a0a           else:..
+0002c930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c940: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002c950: 2e6d 6f64 656c 4f4b 203d 2046 616c 7365  .modelOK = False
+0002c960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c970: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0002c980: 7572 6e20 4661 6c73 650a 0a20 2020 2020  urn False..     
+0002c990: 2020 2020 2020 2020 2020 2023 204f 6e63             # Onc
+0002c9a0: 6520 616c 6c20 6973 204f 4b20 7769 7468  e all is OK with
+0002c9b0: 2074 6865 2070 6572 696f 6473 2061 6e64   the periods and
+0002c9c0: 2074 696d 652d 6f66 2d74 7261 6e73 6974   time-of-transit
+0002c9d0: 2063 656e 7465 7273 2c20 6c6f 6f70 2074   centers, loop t
+0002c9e0: 6872 6f75 6768 2061 6c6c 2074 6865 2070  hrough all the p
+0002c9f0: 6c61 6e65 7473 2c20 6765 7474 696e 6720  lanets, getting 
+0002ca00: 7468 6520 6c69 6768 7463 7572 7665 206d  the lightcurve m
+0002ca10: 6f64 656c 2066 6f72 2065 6163 683a 0a20  odel for each:. 
+0002ca20: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002ca30: 6f72 2069 2069 6e20 7365 6c66 2e6e 756d  or i in self.num
+0002ca40: 6265 7269 6e67 3a0a 0a20 2020 2020 2020  bering:..       
+0002ca50: 2020 2020 2020 2020 2020 2020 2050 2c20               P, 
+0002ca60: 7430 203d 2063 505b 695d 2c20 6374 305b  t0 = cP[i], ct0[
+0002ca70: 695d 0a0a 2020 2020 2020 2020 2020 2020  i]..            
+0002ca80: 2020 2020 2020 2020 2323 2320 466f 7220          ### For 
+0002ca90: 696e 7374 7275 6d65 6e74 2064 6570 656e  instrument depen
+0002caa0: 6465 6e74 2065 636c 6970 7365 2064 6570  dent eclipse dep
+0002cab0: 7468 3a0a 2020 2020 2020 2020 2020 2020  th:.            
+0002cac0: 2020 2020 2020 2020 2323 2320 5765 206f          ### We o
+0002cad0: 6e6c 7920 7761 6e74 2074 6f20 6d61 6b65  nly want to make
+0002cae0: 2065 636c 6970 7365 2064 6570 7468 2069   eclipse depth i
+0002caf0: 6e73 7472 756d 656e 7420 6465 7065 6e64  nstrument depend
+0002cb00: 6564 2c20 6e6f 7420 7468 6520 7469 6d65  ed, not the time
+0002cb10: 2063 6f72 7265 6374 696f 6e20 6661 6374   correction fact
+0002cb20: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
+0002cb30: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
+0002cb40: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
+0002cb50: 6d65 6e74 5d5b 2745 636c 6970 7365 4669  ment]['EclipseFi
+0002cb60: 7427 5d20 6f72 2073 656c 662e 6469 6374  t'] or self.dict
+0002cb70: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
+0002cb80: 745d 5b27 5472 616e 4563 6c46 6974 275d  t]['TranEclFit']
+0002cb90: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
+0002cba0: 2020 2020 2020 2020 2020 2066 7020 3d20             fp = 
+0002cbb0: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0002cbc0: 5b27 6670 5f70 2720 2b20 7374 7228 6929  ['fp_p' + str(i)
+0002cbd0: 202b 2073 656c 662e 6670 5f69 6e61 6d65   + self.fp_iname
+0002cbe0: 5b27 7027 202b 2073 7472 2869 295d 5b69  ['p' + str(i)][i
+0002cbf0: 6e73 7472 756d 656e 745d 5d0a 0a20 2020  nstrument]]..   
+0002cc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cc10: 2020 2020 2069 6620 7365 6c66 2e64 6963       if self.dic
+0002cc20: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
+0002cc30: 6e74 5d5b 2750 6861 7365 4375 7276 6546  nt]['PhaseCurveF
+0002cc40: 6974 275d 3a0a 0a20 2020 2020 2020 2020  it']:..         
+0002cc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cc60: 2020 2070 6861 7365 5f6f 6666 7365 7420     phase_offset 
+0002cc70: 3d20 7061 7261 6d65 7465 725f 7661 6c75  = parameter_valu
+0002cc80: 6573 5b27 7068 6173 656f 6666 7365 745f  es['phaseoffset_
+0002cc90: 7027 202b 2073 7472 2869 2920 2b20 7365  p' + str(i) + se
+0002cca0: 6c66 2e70 6861 7365 6f66 6673 6574 5f69  lf.phaseoffset_i
+0002ccb0: 6e61 6d65 5b27 7027 202b 2073 7472 2869  name['p' + str(i
+0002ccc0: 295d 5b69 6e73 7472 756d 656e 745d 5d0a  )][instrument]].
+0002ccd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002cce0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0002ccf0: 7365 6c66 2e6c 6967 6874 5f74 7261 7665  self.light_trave
+0002cd00: 6c5f 6465 6c61 793a 0a0a 2020 2020 2020  l_delay:..      
+0002cd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cd20: 2020 2020 2020 745f 7365 636f 6e64 6172        t_secondar
+0002cd30: 7920 3d20 7061 7261 6d65 7465 725f 7661  y = parameter_va
+0002cd40: 6c75 6573 5b27 745f 7365 636f 6e64 6172  lues['t_secondar
+0002cd50: 795f 7027 202b 2073 7472 2869 295d 0a0a  y_p' + str(i)]..
+0002cd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cd70: 2020 2020 6966 2073 656c 662e 6469 6374      if self.dict
+0002cd80: 696f 6e61 7279 5b27 6566 6669 6369 656e  ionary['efficien
+0002cd90: 745f 6270 275d 5b69 5d3a 0a20 2020 2020  t_bp'][i]:.     
+0002cda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cdb0: 2020 2069 6620 6e6f 7420 7365 6c66 2e64     if not self.d
+0002cdc0: 6963 7469 6f6e 6172 795b 2766 6974 7268  ictionary['fitrh
+0002cdd0: 6f27 5d3a 0a20 2020 2020 2020 2020 2020  o']:.           
+0002cde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cdf0: 2061 2c72 312c 7232 2020 203d 2070 6172   a,r1,r2   = par
+0002ce00: 616d 6574 6572 5f76 616c 7565 735b 2761  ameter_values['a
+0002ce10: 5f70 272b 7374 7228 6929 5d2c 2070 6172  _p'+str(i)], par
+0002ce20: 616d 6574 6572 5f76 616c 7565 735b 2772  ameter_values['r
+0002ce30: 315f 7027 2b73 7472 2869 295d 2c5c 0a20  1_p'+str(i)],\. 
+0002ce40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ce60: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
+0002ce70: 5f76 616c 7565 735b 2772 325f 7027 2b73  _values['r2_p'+s
+0002ce80: 7472 2869 295d 0a20 2020 2020 2020 2020  tr(i)].         
+0002ce90: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002cea0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0002ceb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cec0: 2072 686f 2c72 312c 7232 203d 2070 6172   rho,r1,r2 = par
+0002ced0: 616d 6574 6572 5f76 616c 7565 735b 2772  ameter_values['r
+0002cee0: 686f 275d 2c20 7061 7261 6d65 7465 725f  ho'], parameter_
+0002cef0: 7661 6c75 6573 5b27 7231 5f70 272b 7374  values['r1_p'+st
+0002cf00: 7228 6929 5d2c 5c0a 2020 2020 2020 2020  r(i)],\.        
+0002cf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cf30: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0002cf40: 5b27 7232 5f70 272b 7374 7228 6929 5d0a  ['r2_p'+str(i)].
+0002cf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cf60: 2020 2020 2020 2020 2020 2020 6120 3d20              a = 
+0002cf70: 2828 7268 6f20 2a20 4720 2a20 2828 5020  ((rho * G * ((P 
+0002cf80: 2a20 3234 2e20 2a20 3336 3030 2e29 2a2a  * 24. * 3600.)**
+0002cf90: 3229 2920 2f0a 2020 2020 2020 2020 2020  2)) /.          
+0002cfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cfb0: 2020 2020 2020 2028 332e 202a 206e 702e         (3. * np.
+0002cfc0: 7069 2929 2a2a 2831 2e20 2f20 332e 290a  pi))**(1. / 3.).
+0002cfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cfe0: 2020 2020 2020 2020 6966 2072 3120 3e20          if r1 > 
+0002cff0: 7365 6c66 2e41 723a 0a20 2020 2020 2020  self.Ar:.       
+0002d000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d010: 2020 2020 2062 2c70 203d 2028 312b 7365       b,p = (1+se
+0002d020: 6c66 2e70 6c29 2a28 312e 202b 2028 7231  lf.pl)*(1. + (r1
+0002d030: 2d31 2e29 2f28 312e 2d73 656c 662e 4172  -1.)/(1.-self.Ar
+0002d040: 2929 2c5c 0a20 2020 2020 2020 2020 2020  )),\.           
 0002d050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d070: 2020 2020 2020 2020 2020 7061 7261 6d65            parame
-0002d080: 7465 725f 7661 6c75 6573 5b27 7068 695f  ter_values['phi_
-0002d090: 7027 2b73 7472 2869 295d 0a0a 2020 2020  p'+str(i)]..    
-0002d0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d0b0: 2020 2020 2020 2020 2020 2020 7020 3d20              p = 
-0002d0c0: 6e70 2e6d 696e 285b 7031 2c20 7032 5d29  np.min([p1, p2])
-0002d0d0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002d0e0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0002d0f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d100: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0002d110: 6e6f 7420 7365 6c66 2e64 6963 7469 6f6e  not self.diction
-0002d120: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
-0002d130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d150: 2020 2020 2027 5472 616e 7369 7446 6974       'TransitFit
-0002d160: 4361 7477 6f6d 616e 275d 3a0a 0a20 2020  Catwoman']:..   
-0002d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d180: 2020 2020 2020 2020 2020 2020 2072 686f               rho
-0002d190: 2c62 2c70 203d 2070 6172 616d 6574 6572  ,b,p = parameter
-0002d1a0: 5f76 616c 7565 735b 2772 686f 275d 2c20  _values['rho'], 
-0002d1b0: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
-0002d1c0: 5b27 625f 7027 2b73 7472 2869 295d 2c5c  ['b_p'+str(i)],\
-0002d1d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d1f0: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0002d200: 6574 6572 5f76 616c 7565 735b 2770 5f70  eter_values['p_p
-0002d210: 272b 7374 7228 6929 202b 2073 656c 662e  '+str(i) + self.
-0002d220: 705f 696e 616d 655b 2770 2720 2b20 7374  p_iname['p' + st
-0002d230: 7228 6929 5d5b 696e 7374 7275 6d65 6e74  r(i)][instrument
-0002d240: 5d5d 0a0a 2020 2020 2020 2020 2020 2020  ]]..            
-0002d250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d260: 656c 7365 3a0a 0a20 2020 2020 2020 2020  else:..         
-0002d270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d280: 2020 2020 2020 2072 686f 2c62 2c70 312c         rho,b,p1,
-0002d290: 7032 2c70 6869 203d 2070 6172 616d 6574  p2,phi = paramet
-0002d2a0: 6572 5f76 616c 7565 735b 2772 686f 275d  er_values['rho']
-0002d2b0: 2c20 7061 7261 6d65 7465 725f 7661 6c75  , parameter_valu
-0002d2c0: 6573 5b27 625f 7027 2b73 7472 2869 295d  es['b_p'+str(i)]
-0002d2d0: 2c5c 0a20 2020 2020 2020 2020 2020 2020  ,\.             
-0002d2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d300: 2020 7061 7261 6d65 7465 725f 7661 6c75    parameter_valu
-0002d310: 6573 5b27 7031 5f70 272b 7374 7228 6929  es['p1_p'+str(i)
-0002d320: 202b 2073 656c 662e 7031 5f69 6e61 6d65   + self.p1_iname
-0002d330: 5b27 7027 202b 2073 7472 2869 295d 5b69  ['p' + str(i)][i
-0002d340: 6e73 7472 756d 656e 745d 5d2c 205c 0a20  nstrument]], \. 
-0002d350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d370: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-0002d380: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
-0002d390: 7032 5f70 272b 7374 7228 6929 202b 2073  p2_p'+str(i) + s
-0002d3a0: 656c 662e 7031 5f69 6e61 6d65 5b27 7027  elf.p1_iname['p'
-0002d3b0: 202b 2073 7472 2869 295d 5b69 6e73 7472   + str(i)][instr
-0002d3c0: 756d 656e 745d 5d2c 5c0a 2020 2020 2020  ument]],\.      
-0002d3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d3f0: 2020 2020 2020 2020 2070 6172 616d 6574           paramet
-0002d400: 6572 5f76 616c 7565 735b 2770 6869 5f70  er_values['phi_p
-0002d410: 272b 7374 7228 6929 5d0a 0a20 2020 2020  '+str(i)]..     
+0002d060: 2020 2020 2020 2028 312d 7232 292a 7365         (1-r2)*se
+0002d070: 6c66 2e70 6c20 2b20 7232 2a73 656c 662e  lf.pl + r2*self.
+0002d080: 7075 0a20 2020 2020 2020 2020 2020 2020  pu.             
+0002d090: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0002d0a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d0b0: 2020 2020 2020 2020 2020 2020 2062 2c70               b,p
+0002d0c0: 203d 2028 312e 202b 2073 656c 662e 706c   = (1. + self.pl
+0002d0d0: 2920 2b20 6e70 2e73 7172 7428 7231 2f73  ) + np.sqrt(r1/s
+0002d0e0: 656c 662e 4172 292a 7232 2a28 7365 6c66  elf.Ar)*r2*(self
+0002d0f0: 2e70 752d 7365 6c66 2e70 6c29 2c5c 0a20  .pu-self.pl),\. 
+0002d100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d120: 2073 656c 662e 7075 202b 2028 7365 6c66   self.pu + (self
+0002d130: 2e70 6c2d 7365 6c66 2e70 7529 2a6e 702e  .pl-self.pu)*np.
+0002d140: 7371 7274 2872 312f 7365 6c66 2e41 7229  sqrt(r1/self.Ar)
+0002d150: 2a28 312e 2d72 3229 0a20 2020 2020 2020  *(1.-r2).       
+0002d160: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0002d170: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0002d180: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0002d190: 7420 7365 6c66 2e64 6963 7469 6f6e 6172  t self.dictionar
+0002d1a0: 795b 2766 6974 7268 6f27 5d3a 0a20 2020  y['fitrho']:.   
+0002d1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d1c0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0002d1d0: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
+0002d1e0: 696e 7374 7275 6d65 6e74 5d5b 0a20 2020  instrument][.   
+0002d1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d210: 2027 5472 616e 7369 7446 6974 4361 7477   'TransitFitCatw
+0002d220: 6f6d 616e 275d 3a0a 2020 2020 2020 2020  oman']:.        
+0002d230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d240: 2020 2020 2020 2020 612c 622c 7020 3d20          a,b,p = 
+0002d250: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0002d260: 5b27 615f 7027 2b73 7472 2869 295d 2c20  ['a_p'+str(i)], 
+0002d270: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0002d280: 5b27 625f 7027 2b73 7472 2869 295d 2c5c  ['b_p'+str(i)],\
+0002d290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d2b0: 2020 2020 2020 2020 2070 6172 616d 6574           paramet
+0002d2c0: 6572 5f76 616c 7565 735b 2770 5f70 272b  er_values['p_p'+
+0002d2d0: 7374 7228 6929 202b 2073 656c 662e 705f  str(i) + self.p_
+0002d2e0: 696e 616d 655b 2770 2720 2b20 7374 7228  iname['p' + str(
+0002d2f0: 6929 5d5b 696e 7374 7275 6d65 6e74 5d5d  i)][instrument]]
+0002d300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d310: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0002d320: 653a 0a0a 2020 2020 2020 2020 2020 2020  e:..            
+0002d330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d340: 2020 2020 612c 622c 7031 2c70 322c 7068      a,b,p1,p2,ph
+0002d350: 6920 3d20 7061 7261 6d65 7465 725f 7661  i = parameter_va
+0002d360: 6c75 6573 5b27 615f 7027 2b73 7472 2869  lues['a_p'+str(i
+0002d370: 295d 2c20 7061 7261 6d65 7465 725f 7661  )], parameter_va
+0002d380: 6c75 6573 5b27 625f 7027 2b73 7472 2869  lues['b_p'+str(i
+0002d390: 295d 2c5c 0a20 2020 2020 2020 2020 2020  )],\.           
+0002d3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d3c0: 2020 7061 7261 6d65 7465 725f 7661 6c75    parameter_valu
+0002d3d0: 6573 5b27 7031 5f70 272b 7374 7228 6929  es['p1_p'+str(i)
+0002d3e0: 202b 2073 656c 662e 7031 5f69 6e61 6d65   + self.p1_iname
+0002d3f0: 5b27 7027 202b 2073 7472 2869 295d 5b69  ['p' + str(i)][i
+0002d400: 6e73 7472 756d 656e 745d 5d2c 205c 0a20  nstrument]], \. 
+0002d410: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002d420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d430: 2020 2020 2020 2020 2020 2070 203d 206e             p = n
-0002d440: 702e 6d69 6e28 5b70 312c 2070 325d 290a  p.min([p1, p2]).
-0002d450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d460: 2020 2020 2020 2020 2020 2020 2061 203d               a =
-0002d470: 2028 2872 686f 202a 2047 202a 2028 2850   ((rho * G * ((P
-0002d480: 202a 2032 342e 202a 2033 3630 302e 292a   * 24. * 3600.)*
-0002d490: 2a32 2929 202f 0a20 2020 2020 2020 2020  *2)) /.         
+0002d430: 2020 2020 2020 2020 2020 2020 7061 7261              para
+0002d440: 6d65 7465 725f 7661 6c75 6573 5b27 7032  meter_values['p2
+0002d450: 5f70 272b 7374 7228 6929 202b 2073 656c  _p'+str(i) + sel
+0002d460: 662e 7031 5f69 6e61 6d65 5b27 7027 202b  f.p1_iname['p' +
+0002d470: 2073 7472 2869 295d 5b69 6e73 7472 756d   str(i)][instrum
+0002d480: 656e 745d 5d2c 205c 0a20 2020 2020 2020  ent]], \.       
+0002d490: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d4b0: 2020 2020 2020 2020 2833 2e20 2a20 6e70          (3. * np
-0002d4c0: 2e70 6929 292a 2a28 312e 202f 2033 2e29  .pi))**(1. / 3.)
-0002d4d0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002d4e0: 2020 2020 2020 2320 4e6f 7720 6578 7472        # Now extr
-0002d4f0: 6163 7420 6563 6365 6e74 7269 6369 7479  act eccentricity
-0002d500: 2061 6e64 206f 6d65 6761 2064 6570 656e   and omega depen
-0002d510: 6469 6e67 206f 6e20 7468 6520 7573 6564  ding on the used
-0002d520: 2070 6172 616d 6574 7269 7a61 7469 6f6e   parametrization
-0002d530: 2066 6f72 2065 6163 6820 706c 616e 6574   for each planet
-0002d540: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002d550: 2020 2020 2020 6966 2073 656c 662e 6469        if self.di
-0002d560: 6374 696f 6e61 7279 5b27 6563 635f 7061  ctionary['ecc_pa
-0002d570: 7261 6d65 7472 697a 6174 696f 6e27 5d5b  rametrization'][
-0002d580: 695d 203d 3d20 303a 0a20 2020 2020 2020  i] == 0:.       
-0002d590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d5a0: 2065 6363 2c20 6f6d 6567 6120 3d20 7061   ecc, omega = pa
-0002d5b0: 7261 6d65 7465 725f 7661 6c75 6573 5b0a  rameter_values[.
-0002d5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d5d0: 2020 2020 2020 2020 2020 2020 2765 6363              'ecc
-0002d5e0: 5f70 2720 2b20 7374 7228 6929 5d2c 2070  _p' + str(i)], p
-0002d5f0: 6172 616d 6574 6572 5f76 616c 7565 735b  arameter_values[
-0002d600: 276f 6d65 6761 5f70 2720 2b0a 2020 2020  'omega_p' +.    
+0002d4b0: 2020 2020 2020 7061 7261 6d65 7465 725f        parameter_
+0002d4c0: 7661 6c75 6573 5b27 7068 695f 7027 2b73  values['phi_p'+s
+0002d4d0: 7472 2869 295d 0a0a 2020 2020 2020 2020  tr(i)]..        
+0002d4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d4f0: 2020 2020 2020 2020 7020 3d20 6e70 2e6d          p = np.m
+0002d500: 696e 285b 7031 2c20 7032 5d29 0a0a 2020  in([p1, p2])..  
+0002d510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d520: 2020 2020 2020 656c 7365 3a0a 0a20 2020        else:..   
+0002d530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d540: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0002d550: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
+0002d560: 696e 7374 7275 6d65 6e74 5d5b 0a20 2020  instrument][.   
+0002d570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d590: 2027 5472 616e 7369 7446 6974 4361 7477   'TransitFitCatw
+0002d5a0: 6f6d 616e 275d 3a0a 0a20 2020 2020 2020  oman']:..       
+0002d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d5c0: 2020 2020 2020 2020 2072 686f 2c62 2c70           rho,b,p
+0002d5d0: 203d 2070 6172 616d 6574 6572 5f76 616c   = parameter_val
+0002d5e0: 7565 735b 2772 686f 275d 2c20 7061 7261  ues['rho'], para
+0002d5f0: 6d65 7465 725f 7661 6c75 6573 5b27 625f  meter_values['b_
+0002d600: 7027 2b73 7472 2869 295d 2c5c 0a20 2020  p'+str(i)],\.   
 0002d610: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002d620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d640: 2020 2020 2020 2020 2020 2020 7374 7228              str(
-0002d650: 6929 5d0a 2020 2020 2020 2020 2020 2020  i)].            
-0002d660: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-0002d670: 662e 6469 6374 696f 6e61 7279 5b27 6563  f.dictionary['ec
-0002d680: 635f 7061 7261 6d65 7472 697a 6174 696f  c_parametrizatio
-0002d690: 6e27 5d5b 695d 203d 3d20 313a 0a20 2020  n'][i] == 1:.   
-0002d6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d6b0: 2020 2020 2065 6363 203d 206e 702e 7371       ecc = np.sq
-0002d6c0: 7274 280a 2020 2020 2020 2020 2020 2020  rt(.            
-0002d6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d6e0: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
-0002d6f0: 5b27 6563 6f73 6f6d 6567 615f 7027 202b  ['ecosomega_p' +
-0002d700: 2073 7472 2869 295d 2a2a 3220 2b0a 2020   str(i)]**2 +.  
+0002d630: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
+0002d640: 5f76 616c 7565 735b 2770 5f70 272b 7374  _values['p_p'+st
+0002d650: 7228 6929 202b 2073 656c 662e 705f 696e  r(i) + self.p_in
+0002d660: 616d 655b 2770 2720 2b20 7374 7228 6929  ame['p' + str(i)
+0002d670: 5d5b 696e 7374 7275 6d65 6e74 5d5d 0a0a  ][instrument]]..
+0002d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d690: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0002d6a0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
+0002d6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d6c0: 2020 2072 686f 2c62 2c70 312c 7032 2c70     rho,b,p1,p2,p
+0002d6d0: 6869 203d 2070 6172 616d 6574 6572 5f76  hi = parameter_v
+0002d6e0: 616c 7565 735b 2772 686f 275d 2c20 7061  alues['rho'], pa
+0002d6f0: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
+0002d700: 625f 7027 2b73 7472 2869 295d 2c5c 0a20  b_p'+str(i)],\. 
 0002d710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d720: 2020 2020 2020 2020 2020 7061 7261 6d65            parame
-0002d730: 7465 725f 7661 6c75 6573 5b27 6573 696e  ter_values['esin
-0002d740: 6f6d 6567 615f 7027 202b 2073 7472 2869  omega_p' + str(i
-0002d750: 295d 2a2a 3229 0a20 2020 2020 2020 2020  )]**2).         
-0002d760: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0002d770: 6d65 6761 203d 206e 702e 6172 6374 616e  mega = np.arctan
-0002d780: 3228 0a20 2020 2020 2020 2020 2020 2020  2(.             
-0002d790: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002d7a0: 6172 616d 6574 6572 5f76 616c 7565 735b  arameter_values[
-0002d7b0: 2765 7369 6e6f 6d65 6761 5f70 2720 2b20  'esinomega_p' + 
-0002d7c0: 7374 7228 6929 5d2c 0a20 2020 2020 2020  str(i)],.       
-0002d7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d7e0: 2020 2020 2070 6172 616d 6574 6572 5f76       parameter_v
-0002d7f0: 616c 7565 735b 2765 636f 736f 6d65 6761  alues['ecosomega
-0002d800: 5f70 2720 2b0a 2020 2020 2020 2020 2020  _p' +.          
+0002d720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d730: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0002d740: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
+0002d750: 7031 5f70 272b 7374 7228 6929 202b 2073  p1_p'+str(i) + s
+0002d760: 656c 662e 7031 5f69 6e61 6d65 5b27 7027  elf.p1_iname['p'
+0002d770: 202b 2073 7472 2869 295d 5b69 6e73 7472   + str(i)][instr
+0002d780: 756d 656e 745d 5d2c 205c 0a20 2020 2020  ument]], \.     
+0002d790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d7b0: 2020 2020 2020 2020 2020 7061 7261 6d65            parame
+0002d7c0: 7465 725f 7661 6c75 6573 5b27 7032 5f70  ter_values['p2_p
+0002d7d0: 272b 7374 7228 6929 202b 2073 656c 662e  '+str(i) + self.
+0002d7e0: 7031 5f69 6e61 6d65 5b27 7027 202b 2073  p1_iname['p' + s
+0002d7f0: 7472 2869 295d 5b69 6e73 7472 756d 656e  tr(i)][instrumen
+0002d800: 745d 5d2c 5c0a 2020 2020 2020 2020 2020  t]],\.          
 0002d810: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002d820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d830: 2020 2073 7472 2869 295d 2920 2a20 3138     str(i)]) * 18
-0002d840: 302e 202f 206e 702e 7069 0a20 2020 2020  0. / np.pi.     
-0002d850: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0002d860: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0002d870: 2020 2020 2020 2020 2020 2020 2065 6363               ecc
-0002d880: 203d 2070 6172 616d 6574 6572 5f76 616c   = parameter_val
-0002d890: 7565 735b 2773 6563 6f73 6f6d 6567 615f  ues['secosomega_
-0002d8a0: 7027 202b 0a20 2020 2020 2020 2020 2020  p' +.           
-0002d8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d8d0: 2020 2020 7374 7228 6929 5d2a 2a32 202b      str(i)]**2 +
-0002d8e0: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
-0002d8f0: 735b 0a20 2020 2020 2020 2020 2020 2020  s[.             
-0002d900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d830: 2020 2020 2070 6172 616d 6574 6572 5f76       parameter_v
+0002d840: 616c 7565 735b 2770 6869 5f70 272b 7374  alues['phi_p'+st
+0002d850: 7228 6929 5d0a 0a20 2020 2020 2020 2020  r(i)]..         
+0002d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d870: 2020 2020 2020 2070 203d 206e 702e 6d69         p = np.mi
+0002d880: 6e28 5b70 312c 2070 325d 290a 0a20 2020  n([p1, p2])..   
+0002d890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d8a0: 2020 2020 2020 2020 2061 203d 2028 2872           a = ((r
+0002d8b0: 686f 202a 2047 202a 2028 2850 202a 2032  ho * G * ((P * 2
+0002d8c0: 342e 202a 2033 3630 302e 292a 2a32 2929  4. * 3600.)**2))
+0002d8d0: 202f 0a20 2020 2020 2020 2020 2020 2020   /.             
+0002d8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d8f0: 2020 2020 2833 2e20 2a20 6e70 2e70 6929      (3. * np.pi)
+0002d900: 292a 2a28 312e 202f 2033 2e29 0a0a 2020  )**(1. / 3.)..  
 0002d910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d920: 2020 2020 2020 2773 6573 696e 6f6d 6567        'sesinomeg
-0002d930: 615f 7027 202b 2073 7472 2869 295d 2a2a  a_p' + str(i)]**
-0002d940: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
-0002d950: 2020 2020 2020 2020 2020 6f6d 6567 6120            omega 
-0002d960: 3d20 6e70 2e61 7263 7461 6e32 280a 2020  = np.arctan2(.  
-0002d970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d980: 2020 2020 2020 2020 2020 7061 7261 6d65            parame
-0002d990: 7465 725f 7661 6c75 6573 5b27 7365 7369  ter_values['sesi
-0002d9a0: 6e6f 6d65 6761 5f70 2720 2b20 7374 7228  nomega_p' + str(
-0002d9b0: 6929 5d2c 0a20 2020 2020 2020 2020 2020  i)],.           
-0002d9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d9d0: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
-0002d9e0: 735b 2773 6563 6f73 6f6d 6567 615f 7027  s['secosomega_p'
-0002d9f0: 202b 0a20 2020 2020 2020 2020 2020 2020   +.             
+0002d920: 2020 2320 4e6f 7720 6578 7472 6163 7420    # Now extract 
+0002d930: 6563 6365 6e74 7269 6369 7479 2061 6e64  eccentricity and
+0002d940: 206f 6d65 6761 2064 6570 656e 6469 6e67   omega depending
+0002d950: 206f 6e20 7468 6520 7573 6564 2070 6172   on the used par
+0002d960: 616d 6574 7269 7a61 7469 6f6e 2066 6f72  ametrization for
+0002d970: 2065 6163 6820 706c 616e 6574 3a0a 2020   each planet:.  
+0002d980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d990: 2020 6966 2073 656c 662e 6469 6374 696f    if self.dictio
+0002d9a0: 6e61 7279 5b27 6563 635f 7061 7261 6d65  nary['ecc_parame
+0002d9b0: 7472 697a 6174 696f 6e27 5d5b 695d 203d  trization'][i] =
+0002d9c0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+0002d9d0: 2020 2020 2020 2020 2020 2020 2065 6363               ecc
+0002d9e0: 2c20 6f6d 6567 6120 3d20 7061 7261 6d65  , omega = parame
+0002d9f0: 7465 725f 7661 6c75 6573 5b0a 2020 2020  ter_values[.    
 0002da00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002da10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002da20: 7374 7228 6929 5d29 202a 2031 3830 2e20  str(i)]) * 180. 
-0002da30: 2f20 6e70 2e70 690a 0a20 2020 2020 2020  / np.pi..       
-0002da40: 2020 2020 2020 2020 2020 2020 2023 2047               # G
-0002da50: 656e 6572 6174 6520 6c69 6768 7463 7572  enerate lightcur
-0002da60: 7665 2066 6f72 2074 6865 2063 7572 7265  ve for the curre
-0002da70: 6e74 2070 6c61 6e65 7420 6966 2065 6363  nt planet if ecc
-0002da80: 2069 7320 4f4b 3a0a 2020 2020 2020 2020   is OK:.        
-0002da90: 2020 2020 2020 2020 2020 2020 6966 2065              if e
-0002daa0: 6363 203e 2073 656c 662e 6563 636c 696d  cc > self.ecclim
-0002dab0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002dac0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002dad0: 6d6f 6465 6c4f 4b20 3d20 4661 6c73 650a  modelOK = False.
+0002da10: 2020 2020 2020 2020 2765 6363 5f70 2720          'ecc_p' 
+0002da20: 2b20 7374 7228 6929 5d2c 2070 6172 616d  + str(i)], param
+0002da30: 6574 6572 5f76 616c 7565 735b 276f 6d65  eter_values['ome
+0002da40: 6761 5f70 2720 2b0a 2020 2020 2020 2020  ga_p' +.        
+0002da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002da60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002da70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002da80: 2020 2020 2020 2020 7374 7228 6929 5d0a          str(i)].
+0002da90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002daa0: 2020 2020 656c 6966 2073 656c 662e 6469      elif self.di
+0002dab0: 6374 696f 6e61 7279 5b27 6563 635f 7061  ctionary['ecc_pa
+0002dac0: 7261 6d65 7472 697a 6174 696f 6e27 5d5b  rametrization'][
+0002dad0: 695d 203d 3d20 313a 0a20 2020 2020 2020  i] == 1:.       
 0002dae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002daf0: 2020 2020 2020 2020 7265 7475 726e 2046          return F
-0002db00: 616c 7365 0a0a 2020 2020 2020 2020 2020  alse..          
-0002db10: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0002db20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002db30: 2020 2020 2020 2020 2065 6363 5f66 6163           ecc_fac
-0002db40: 746f 7220 3d20 2831 2e20 2b20 6563 6320  tor = (1. + ecc 
-0002db50: 2a20 6e70 2e73 696e 286f 6d65 6761 202a  * np.sin(omega *
-0002db60: 206e 702e 7069 202f 2031 3830 2e29 0a20   np.pi / 180.). 
-0002db70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002db80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002db90: 2020 2020 2920 2f20 2831 2e20 2d20 6563      ) / (1. - ec
-0002dba0: 632a 2a32 290a 2020 2020 2020 2020 2020  c**2).          
-0002dbb0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0002dbc0: 635f 696e 765f 6661 6374 6f72 203d 2028  c_inv_factor = (
-0002dbd0: 6220 2f20 6129 202a 2065 6363 5f66 6163  b / a) * ecc_fac
-0002dbe0: 746f 720a 0a20 2020 2020 2020 2020 2020  tor..           
-0002dbf0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0002dc00: 6e6f 7420 2862 203e 2031 2e20 2b20 7020  not (b > 1. + p 
-0002dc10: 6f72 2069 6e63 5f69 6e76 5f66 6163 746f  or inc_inv_facto
-0002dc20: 7220 3e3d 2031 2e29 3a0a 0a20 2020 2020  r >= 1.):..     
-0002dc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dc40: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
-0002dc50: 6c5b 696e 7374 7275 6d65 6e74 5d5b 2770  l[instrument]['p
-0002dc60: 6172 616d 7327 5d2e 7430 203d 2074 300a  arams'].t0 = t0.
-0002dc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dc80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002dc90: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
-0002dca0: 745d 5b27 7061 7261 6d73 275d 2e70 6572  t]['params'].per
-0002dcb0: 203d 2050 0a20 2020 2020 2020 2020 2020   = P.           
-0002dcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dcd0: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-0002dce0: 7275 6d65 6e74 5d5b 2770 6172 616d 7327  rument]['params'
-0002dcf0: 5d2e 6120 3d20 610a 0a20 2020 2020 2020  ].a = a..       
+0002daf0: 2065 6363 203d 206e 702e 7371 7274 280a   ecc = np.sqrt(.
+0002db00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002db10: 2020 2020 2020 2020 2020 2020 7061 7261              para
+0002db20: 6d65 7465 725f 7661 6c75 6573 5b27 6563  meter_values['ec
+0002db30: 6f73 6f6d 6567 615f 7027 202b 2073 7472  osomega_p' + str
+0002db40: 2869 295d 2a2a 3220 2b0a 2020 2020 2020  (i)]**2 +.      
+0002db50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002db60: 2020 2020 2020 7061 7261 6d65 7465 725f        parameter_
+0002db70: 7661 6c75 6573 5b27 6573 696e 6f6d 6567  values['esinomeg
+0002db80: 615f 7027 202b 2073 7472 2869 295d 2a2a  a_p' + str(i)]**
+0002db90: 3229 0a20 2020 2020 2020 2020 2020 2020  2).             
+0002dba0: 2020 2020 2020 2020 2020 206f 6d65 6761             omega
+0002dbb0: 203d 206e 702e 6172 6374 616e 3228 0a20   = np.arctan2(. 
+0002dbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dbd0: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0002dbe0: 6574 6572 5f76 616c 7565 735b 2765 7369  eter_values['esi
+0002dbf0: 6e6f 6d65 6761 5f70 2720 2b20 7374 7228  nomega_p' + str(
+0002dc00: 6929 5d2c 0a20 2020 2020 2020 2020 2020  i)],.           
+0002dc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dc20: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
+0002dc30: 735b 2765 636f 736f 6d65 6761 5f70 2720  s['ecosomega_p' 
+0002dc40: 2b0a 2020 2020 2020 2020 2020 2020 2020  +.              
+0002dc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dc60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0002dc70: 7472 2869 295d 2920 2a20 3138 302e 202f  tr(i)]) * 180. /
+0002dc80: 206e 702e 7069 0a20 2020 2020 2020 2020   np.pi.         
+0002dc90: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0002dca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002dcb0: 2020 2020 2020 2020 2065 6363 203d 2070           ecc = p
+0002dcc0: 6172 616d 6574 6572 5f76 616c 7565 735b  arameter_values[
+0002dcd0: 2773 6563 6f73 6f6d 6567 615f 7027 202b  'secosomega_p' +
+0002dce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002dd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dd10: 2020 2020 2073 656c 662e 6d6f 6465 6c5b       self.model[
-0002dd20: 696e 7374 7275 6d65 6e74 5d5b 2770 6172  instrument]['par
-0002dd30: 616d 7327 5d2e 696e 6320 3d20 6e70 2e61  ams'].inc = np.a
-0002dd40: 7263 636f 7328 696e 635f 696e 765f 6661  rccos(inc_inv_fa
-0002dd50: 6374 6f72 292a 3138 302e 2f6e 702e 7069  ctor)*180./np.pi
-0002dd60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002dd70: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0002dd80: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
-0002dd90: 6e74 5d5b 2770 6172 616d 7327 5d2e 6563  nt]['params'].ec
-0002dda0: 6320 3d20 6563 630a 2020 2020 2020 2020  c = ecc.        
+0002dd10: 7374 7228 6929 5d2a 2a32 202b 2070 6172  str(i)]**2 + par
+0002dd20: 616d 6574 6572 5f76 616c 7565 735b 0a20  ameter_values[. 
+0002dd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dd60: 2020 2773 6573 696e 6f6d 6567 615f 7027    'sesinomega_p'
+0002dd70: 202b 2073 7472 2869 295d 2a2a 320a 2020   + str(i)]**2.  
+0002dd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dd90: 2020 2020 2020 6f6d 6567 6120 3d20 6e70        omega = np
+0002dda0: 2e61 7263 7461 6e32 280a 2020 2020 2020  .arctan2(.      
 0002ddb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ddc0: 2020 2020 7365 6c66 2e6d 6f64 656c 5b69      self.model[i
-0002ddd0: 6e73 7472 756d 656e 745d 5b27 7061 7261  nstrument]['para
-0002dde0: 6d73 275d 2e77 203d 206f 6d65 6761 0a0a  ms'].w = omega..
-0002ddf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002de00: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0002de10: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
-0002de20: 6e73 7472 756d 656e 745d 5b27 4563 6c69  nstrument]['Ecli
-0002de30: 7073 6546 6974 275d 206f 7220 7365 6c66  pseFit'] or self
-0002de40: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
-0002de50: 7275 6d65 6e74 5d5b 2754 7261 6e45 636c  rument]['TranEcl
-0002de60: 4669 7427 5d3a 0a0a 2020 2020 2020 2020  Fit']:..        
-0002de70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002de80: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
-0002de90: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
-0002dea0: 7061 7261 6d73 275d 2e66 7020 3d20 6670  params'].fp = fp
-0002deb0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002dec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ded0: 2020 6966 206e 6f74 2073 656c 662e 6c69    if not self.li
-0002dee0: 6768 745f 7472 6176 656c 5f64 656c 6179  ght_travel_delay
-0002def0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002df00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002df10: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
-0002df20: 6c5b 696e 7374 7275 6d65 6e74 5d5b 2770  l[instrument]['p
-0002df30: 6172 616d 7327 5d2e 745f 7365 636f 6e64  arams'].t_second
-0002df40: 6172 7920 3d20 745f 7365 636f 6e64 6172  ary = t_secondar
-0002df50: 790a 0a20 2020 2020 2020 2020 2020 2020  y..             
+0002ddc0: 2020 2020 2020 7061 7261 6d65 7465 725f        parameter_
+0002ddd0: 7661 6c75 6573 5b27 7365 7369 6e6f 6d65  values['sesinome
+0002dde0: 6761 5f70 2720 2b20 7374 7228 6929 5d2c  ga_p' + str(i)],
+0002ddf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002de00: 2020 2020 2020 2020 2020 2020 2070 6172               par
+0002de10: 616d 6574 6572 5f76 616c 7565 735b 2773  ameter_values['s
+0002de20: 6563 6f73 6f6d 6567 615f 7027 202b 0a20  ecosomega_p' +. 
+0002de30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002de40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002de50: 2020 2020 2020 2020 2020 2020 7374 7228              str(
+0002de60: 6929 5d29 202a 2031 3830 2e20 2f20 6e70  i)]) * 180. / np
+0002de70: 2e70 690a 0a20 2020 2020 2020 2020 2020  .pi..           
+0002de80: 2020 2020 2020 2020 2023 2047 656e 6572           # Gener
+0002de90: 6174 6520 6c69 6768 7463 7572 7665 2066  ate lightcurve f
+0002dea0: 6f72 2074 6865 2063 7572 7265 6e74 2070  or the current p
+0002deb0: 6c61 6e65 7420 6966 2065 6363 2069 7320  lanet if ecc is 
+0002dec0: 4f4b 3a0a 2020 2020 2020 2020 2020 2020  OK:.            
+0002ded0: 2020 2020 2020 2020 6966 2065 6363 203e          if ecc >
+0002dee0: 2073 656c 662e 6563 636c 696d 3a0a 0a20   self.ecclim:.. 
+0002def0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002df00: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
+0002df10: 6c4f 4b20 3d20 4661 6c73 650a 2020 2020  lOK = False.    
+0002df20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002df30: 2020 2020 7265 7475 726e 2046 616c 7365      return False
+0002df40: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002df50: 2020 2020 2020 656c 7365 3a0a 0a20 2020        else:..   
 0002df60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002df70: 2020 2065 6c73 653a 0a0a 2020 2020 2020     else:..      
-0002df80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002df90: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0002dfa0: 4966 206c 6967 6874 2d74 7261 7665 6c20  If light-travel 
-0002dfb0: 7469 6d65 2069 7320 6163 7469 7661 7465  time is activate
-0002dfc0: 642c 2073 656c 662d 636f 6e73 6973 7465  d, self-consiste
-0002dfd0: 6e74 6c79 2063 616c 6375 6c61 7465 2074  ntly calculate t
-0002dfe0: 696d 6520 6f66 2073 6563 6f6e 6461 7279  ime of secondary
-0002dff0: 2065 636c 6970 7365 3a0a 2020 2020 2020   eclipse:.      
-0002e000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e010: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0002e020: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
-0002e030: 656e 745d 5b27 7061 7261 6d73 275d 2e52  ent]['params'].R
-0002e040: 7320 3d20 7365 6c66 2e73 7465 6c6c 6172  s = self.stellar
-0002e050: 5f72 6164 6975 730a 0a20 2020 2020 2020  _radius..       
-0002e060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e070: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0002e080: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
-0002e090: 696e 7374 7275 6d65 6e74 5d5b 2745 636c  instrument]['Ecl
-0002e0a0: 6970 7365 4669 7427 5d3a 0a0a 2020 2020  ipseFit']:..    
+0002df70: 2020 2020 2065 6363 5f66 6163 746f 7220       ecc_factor 
+0002df80: 3d20 2831 2e20 2b20 6563 6320 2a20 6e70  = (1. + ecc * np
+0002df90: 2e73 696e 286f 6d65 6761 202a 206e 702e  .sin(omega * np.
+0002dfa0: 7069 202f 2031 3830 2e29 0a20 2020 2020  pi / 180.).     
+0002dfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dfd0: 2920 2f20 2831 2e20 2d20 6563 632a 2a32  ) / (1. - ecc**2
+0002dfe0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002dff0: 2020 2020 2020 2020 2020 696e 635f 696e            inc_in
+0002e000: 765f 6661 6374 6f72 203d 2028 6220 2f20  v_factor = (b / 
+0002e010: 6129 202a 2065 6363 5f66 6163 746f 720a  a) * ecc_factor.
+0002e020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e030: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0002e040: 2862 203e 2031 2e20 2b20 7020 6f72 2069  (b > 1. + p or i
+0002e050: 6e63 5f69 6e76 5f66 6163 746f 7220 3e3d  nc_inv_factor >=
+0002e060: 2031 2e29 3a0a 0a20 2020 2020 2020 2020   1.):..         
+0002e070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e080: 2020 2073 656c 662e 6d6f 6465 6c5b 696e     self.model[in
+0002e090: 7374 7275 6d65 6e74 5d5b 2770 6172 616d  strument]['param
+0002e0a0: 7327 5d2e 7430 203d 2074 300a 2020 2020  s'].t0 = t0.    
 0002e0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e0d0: 2020 2020 7365 6c66 2e6d 6f64 656c 5b69      self.model[i
-0002e0e0: 6e73 7472 756d 656e 745d 5b27 7061 7261  nstrument]['para
-0002e0f0: 6d73 275d 2e74 5f73 6563 6f6e 6461 7279  ms'].t_secondary
-0002e100: 203d 2073 656c 662e 6d6f 6465 6c5b 696e   = self.model[in
-0002e110: 7374 7275 6d65 6e74 5d5b 276d 275d 2e67  strument]['m'].g
-0002e120: 6574 5f74 5f73 6563 6f6e 6461 7279 2873  et_t_secondary(s
-0002e130: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
-0002e140: 6d65 6e74 5d5b 2770 6172 616d 7327 5d29  ment]['params'])
-0002e150: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002e160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e170: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0002e180: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
-0002e190: 756d 656e 745d 5b27 5472 616e 4563 6c46  ument]['TranEclF
-0002e1a0: 6974 275d 3a0a 0a20 2020 2020 2020 2020  it']:..         
-0002e1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e1c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0002e1d0: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
-0002e1e0: 6d65 6e74 5d5b 2770 6172 616d 7327 5d2e  ment]['params'].
-0002e1f0: 745f 7365 636f 6e64 6172 7920 3d20 7365  t_secondary = se
-0002e200: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
-0002e210: 656e 745d 5b27 6d27 5d5b 315d 2e67 6574  ent]['m'][1].get
-0002e220: 5f74 5f73 6563 6f6e 6461 7279 2873 656c  _t_secondary(sel
-0002e230: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
-0002e240: 6e74 5d5b 2770 6172 616d 7327 5d29 0a0a  nt]['params'])..
-0002e250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e270: 2020 2020 2320 4765 7420 7469 6d65 2d64      # Get time-d
-0002e280: 656c 6179 6564 2074 696d 6573 3a0a 2020  elayed times:.  
-0002e290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e2b0: 2020 636f 7272 6563 7465 645f 7420 3d20    corrected_t = 
-0002e2c0: 636f 7272 6563 745f 6c69 6768 745f 7472  correct_light_tr
-0002e2d0: 6176 656c 5f74 696d 6528 7365 6c66 2e74  avel_time(self.t
-0002e2e0: 696d 6573 5b69 6e73 7472 756d 656e 745d  imes[instrument]
-0002e2f0: 2c20 7365 6c66 2e6d 6f64 656c 5b69 6e73  , self.model[ins
-0002e300: 7472 756d 656e 745d 5b27 7061 7261 6d73  trument]['params
-0002e310: 275d 290a 0a20 2020 2020 2020 2020 2020  '])..           
-0002e320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e330: 2020 2020 2020 2020 2023 2044 796e 616d           # Dynam
-0002e340: 6963 616c 6c79 206d 6f64 6966 7920 7468  ically modify th
-0002e350: 6520 6261 746d 616e 206d 6f64 656c 2066  e batman model f
-0002e360: 6f72 2074 6865 2065 636c 6970 7365 2070  or the eclipse p
-0002e370: 6172 743a 0a20 2020 2020 2020 2020 2020  art:.           
-0002e380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e390: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0002e3a0: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
-0002e3b0: 7275 6d65 6e74 5d5b 2745 636c 6970 7365  rument]['Eclipse
-0002e3c0: 4669 7427 5d3a 0a0a 2020 2020 2020 2020  Fit']:..        
-0002e3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e3f0: 6966 2073 656c 662e 6469 6374 696f 6e61  if self.dictiona
-0002e400: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
-0002e410: 7265 7361 6d70 6c69 6e67 275d 3a0a 0a20  resampling']:.. 
-0002e420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e440: 2020 2020 2020 2020 2020 205f 2c20 5b5f             _, [_
-0002e450: 2c20 7365 6c66 2e6d 6f64 656c 5b69 6e73  , self.model[ins
-0002e460: 7472 756d 656e 745d 5b27 6d27 5d5d 203d  trument]['m']] =
-0002e470: 2069 6e69 745f 6261 746d 616e 2863 6f72   init_batman(cor
-0002e480: 7265 6374 6564 5f74 2c20 7365 6c66 2e64  rected_t, self.d
-0002e490: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
-0002e4a0: 6d65 6e74 5d5b 276c 646c 6177 275d 2c20  ment]['ldlaw'], 
-0002e4b0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0002e4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e0c0: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+0002e0d0: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
+0002e0e0: 7061 7261 6d73 275d 2e70 6572 203d 2050  params'].per = P
+0002e0f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e100: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0002e110: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+0002e120: 6e74 5d5b 2770 6172 616d 7327 5d2e 6120  nt]['params'].a 
+0002e130: 3d20 610a 0a20 2020 2020 2020 2020 2020  = a..           
+0002e140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e150: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
+0002e160: 7275 6d65 6e74 5d5b 2770 6172 616d 7327  rument]['params'
+0002e170: 5d2e 696e 6320 3d20 6e70 2e61 7263 636f  ].inc = np.arcco
+0002e180: 7328 696e 635f 696e 765f 6661 6374 6f72  s(inc_inv_factor
+0002e190: 292a 3138 302e 2f6e 702e 7069 0a20 2020  )*180./np.pi.   
+0002e1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e1b0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
+0002e1c0: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
+0002e1d0: 2770 6172 616d 7327 5d2e 6563 6320 3d20  'params'].ecc = 
+0002e1e0: 6563 630a 2020 2020 2020 2020 2020 2020  ecc.            
+0002e1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e200: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+0002e210: 756d 656e 745d 5b27 7061 7261 6d73 275d  ument]['params']
+0002e220: 2e77 203d 206f 6d65 6761 0a0a 2020 2020  .w = omega..    
+0002e230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e240: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0002e250: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
+0002e260: 756d 656e 745d 5b27 4563 6c69 7073 6546  ument]['EclipseF
+0002e270: 6974 275d 206f 7220 7365 6c66 2e64 6963  it'] or self.dic
+0002e280: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
+0002e290: 6e74 5d5b 2754 7261 6e45 636c 4669 7427  nt]['TranEclFit'
+0002e2a0: 5d3a 0a0a 2020 2020 2020 2020 2020 2020  ]:..            
+0002e2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e2c0: 2020 2020 7365 6c66 2e6d 6f64 656c 5b69      self.model[i
+0002e2d0: 6e73 7472 756d 656e 745d 5b27 7061 7261  nstrument]['para
+0002e2e0: 6d73 275d 2e66 7020 3d20 6670 0a0a 2020  ms'].fp = fp..  
+0002e2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e300: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0002e310: 206e 6f74 2073 656c 662e 6c69 6768 745f   not self.light_
+0002e320: 7472 6176 656c 5f64 656c 6179 3a0a 0a20  travel_delay:.. 
+0002e330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e350: 2020 2073 656c 662e 6d6f 6465 6c5b 696e     self.model[in
+0002e360: 7374 7275 6d65 6e74 5d5b 2770 6172 616d  strument]['param
+0002e370: 7327 5d2e 745f 7365 636f 6e64 6172 7920  s'].t_secondary 
+0002e380: 3d20 745f 7365 636f 6e64 6172 790a 0a20  = t_secondary.. 
+0002e390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e3a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002e3b0: 6c73 653a 0a0a 2020 2020 2020 2020 2020  lse:..          
+0002e3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e3d0: 2020 2020 2020 2020 2020 2320 4966 206c            # If l
+0002e3e0: 6967 6874 2d74 7261 7665 6c20 7469 6d65  ight-travel time
+0002e3f0: 2069 7320 6163 7469 7661 7465 642c 2073   is activated, s
+0002e400: 656c 662d 636f 6e73 6973 7465 6e74 6c79  elf-consistently
+0002e410: 2063 616c 6375 6c61 7465 2074 696d 6520   calculate time 
+0002e420: 6f66 2073 6563 6f6e 6461 7279 2065 636c  of secondary ecl
+0002e430: 6970 7365 3a0a 2020 2020 2020 2020 2020  ipse:.          
+0002e440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e450: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0002e460: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
+0002e470: 5b27 7061 7261 6d73 275d 2e52 7320 3d20  ['params'].Rs = 
+0002e480: 7365 6c66 2e73 7465 6c6c 6172 5f72 6164  self.stellar_rad
+0002e490: 6975 730a 0a20 2020 2020 2020 2020 2020  ius..           
+0002e4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e4b0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+0002e4c0: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
+0002e4d0: 7275 6d65 6e74 5d5b 2745 636c 6970 7365  rument]['Eclipse
+0002e4e0: 4669 7427 5d3a 0a0a 2020 2020 2020 2020  Fit']:..        
 0002e4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e500: 2020 2020 2020 2020 2020 206e 7265 7361             nresa
-0002e510: 6d70 6c69 6e67 203d 2073 656c 662e 6469  mpling = self.di
-0002e520: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
-0002e530: 656e 745d 5b27 6e72 6573 616d 706c 696e  ent]['nresamplin
-0002e540: 6727 5d2c 205c 0a20 2020 2020 2020 2020  g'], \.         
-0002e550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e510: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+0002e520: 756d 656e 745d 5b27 7061 7261 6d73 275d  ument]['params']
+0002e530: 2e74 5f73 6563 6f6e 6461 7279 203d 2073  .t_secondary = s
+0002e540: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
+0002e550: 6d65 6e74 5d5b 276d 275d 2e67 6574 5f74  ment]['m'].get_t
+0002e560: 5f73 6563 6f6e 6461 7279 2873 656c 662e  _secondary(self.
+0002e570: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
+0002e580: 5d5b 2770 6172 616d 7327 5d29 0a0a 2020  ]['params'])..  
 0002e590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e5a0: 6574 7265 7361 6d70 6c69 6e67 203d 2073  etresampling = s
-0002e5b0: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
-0002e5c0: 6e73 7472 756d 656e 745d 5b27 6578 7074  nstrument]['expt
-0002e5d0: 696d 6572 6573 616d 706c 696e 6727 5d29  imeresampling'])
-0002e5e0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002e5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e5b0: 2020 656c 6966 2073 656c 662e 6469 6374    elif self.dict
+0002e5c0: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
+0002e5d0: 745d 5b27 5472 616e 4563 6c46 6974 275d  t]['TranEclFit']
+0002e5e0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
 0002e5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e600: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0002e610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e630: 2020 2020 2020 2020 2020 2020 205f 2c20               _, 
-0002e640: 5b5f 2c20 7365 6c66 2e6d 6f64 656c 5b69  [_, self.model[i
-0002e650: 6e73 7472 756d 656e 745d 5b27 6d27 5d5d  nstrument]['m']]
-0002e660: 203d 2069 6e69 745f 6261 746d 616e 2863   = init_batman(c
-0002e670: 6f72 7265 6374 6564 5f74 2c20 7365 6c66  orrected_t, self
-0002e680: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
-0002e690: 7275 6d65 6e74 5d5b 276c 646c 6177 275d  rument]['ldlaw']
-0002e6a0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-0002e6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e6c0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-0002e6d0: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
-0002e6e0: 7275 6d65 6e74 5d5b 2754 7261 6e45 636c  rument]['TranEcl
-0002e6f0: 4669 7427 5d3a 0a0a 2020 2020 2020 2020  Fit']:..        
-0002e700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e720: 6966 2073 656c 662e 6469 6374 696f 6e61  if self.dictiona
-0002e730: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
-0002e740: 7265 7361 6d70 6c69 6e67 275d 3a0a 0a20  resampling']:.. 
-0002e750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e600: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002e610: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
+0002e620: 5d5b 2770 6172 616d 7327 5d2e 745f 7365  ]['params'].t_se
+0002e630: 636f 6e64 6172 7920 3d20 7365 6c66 2e6d  condary = self.m
+0002e640: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
+0002e650: 5b27 6d27 5d5b 315d 2e67 6574 5f74 5f73  ['m'][1].get_t_s
+0002e660: 6563 6f6e 6461 7279 2873 656c 662e 6d6f  econdary(self.mo
+0002e670: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
+0002e680: 2770 6172 616d 7327 5d29 0a0a 2020 2020  'params'])..    
+0002e690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e6b0: 2320 4765 7420 7469 6d65 2d64 656c 6179  # Get time-delay
+0002e6c0: 6564 2074 696d 6573 3a0a 2020 2020 2020  ed times:.      
+0002e6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e6e0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0002e6f0: 7272 6563 7465 645f 7420 3d20 636f 7272  rrected_t = corr
+0002e700: 6563 745f 6c69 6768 745f 7472 6176 656c  ect_light_travel
+0002e710: 5f74 696d 6528 7365 6c66 2e74 696d 6573  _time(self.times
+0002e720: 5b69 6e73 7472 756d 656e 745d 2c20 7365  [instrument], se
+0002e730: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
+0002e740: 656e 745d 5b27 7061 7261 6d73 275d 290a  ent]['params']).
+0002e750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0002e760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e770: 2020 2020 2020 2020 2020 205f 2c20 5b5f             _, [_
-0002e780: 2c20 7365 6c66 2e6d 6f64 656c 5b69 6e73  , self.model[ins
-0002e790: 7472 756d 656e 745d 5b27 6d27 5d5b 315d  trument]['m'][1]
-0002e7a0: 5d20 3d20 696e 6974 5f62 6174 6d61 6e28  ] = init_batman(
-0002e7b0: 636f 7272 6563 7465 645f 742c 2073 656c  corrected_t, sel
-0002e7c0: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
-0002e7d0: 7472 756d 656e 745d 5b27 6c64 6c61 7727  trument]['ldlaw'
-0002e7e0: 5d2c 205c 0a20 2020 2020 2020 2020 2020  ], \.           
-0002e7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e770: 2020 2020 2023 2044 796e 616d 6963 616c       # Dynamical
+0002e780: 6c79 206d 6f64 6966 7920 7468 6520 6261  ly modify the ba
+0002e790: 746d 616e 206d 6f64 656c 2066 6f72 2074  tman model for t
+0002e7a0: 6865 2065 636c 6970 7365 2070 6172 743a  he eclipse part:
+0002e7b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e7d0: 2020 2020 2069 6620 7365 6c66 2e64 6963       if self.dic
+0002e7e0: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
+0002e7f0: 6e74 5d5b 2745 636c 6970 7365 4669 7427  nt]['EclipseFit'
+0002e800: 5d3a 0a0a 2020 2020 2020 2020 2020 2020  ]:..            
 0002e810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e830: 2020 2020 2020 2020 2020 2020 2020 6e72                nr
-0002e840: 6573 616d 706c 696e 6720 3d20 7365 6c66  esampling = self
-0002e850: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
-0002e860: 7275 6d65 6e74 5d5b 276e 7265 7361 6d70  rument]['nresamp
-0002e870: 6c69 6e67 275d 2c20 5c0a 2020 2020 2020  ling'], \.      
-0002e880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e8d0: 2020 2065 7472 6573 616d 706c 696e 6720     etresampling 
-0002e8e0: 3d20 7365 6c66 2e64 6963 7469 6f6e 6172  = self.dictionar
-0002e8f0: 795b 696e 7374 7275 6d65 6e74 5d5b 2765  y[instrument]['e
-0002e900: 7870 7469 6d65 7265 7361 6d70 6c69 6e67  xptimeresampling
-0002e910: 275d 290a 0a20 2020 2020 2020 2020 2020  '])..           
+0002e820: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0002e830: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
+0002e840: 6e73 7472 756d 656e 745d 5b27 7265 7361  nstrument]['resa
+0002e850: 6d70 6c69 6e67 275d 3a0a 0a20 2020 2020  mpling']:..     
+0002e860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e880: 2020 2020 2020 205f 2c20 5b5f 2c20 7365         _, [_, se
+0002e890: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
+0002e8a0: 656e 745d 5b27 6d27 5d5d 203d 2069 6e69  ent]['m']] = ini
+0002e8b0: 745f 6261 746d 616e 2863 6f72 7265 6374  t_batman(correct
+0002e8c0: 6564 5f74 2c20 7365 6c66 2e64 6963 7469  ed_t, self.dicti
+0002e8d0: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
+0002e8e0: 5d5b 276c 646c 6177 275d 2c20 5c0a 2020  ]['ldlaw'], \.  
+0002e8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e910: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002e920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e930: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0002e940: 653a 0a0a 2020 2020 2020 2020 2020 2020  e:..            
-0002e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e970: 5f2c 205b 5f2c 2073 656c 662e 6d6f 6465  _, [_, self.mode
-0002e980: 6c5b 696e 7374 7275 6d65 6e74 5d5b 276d  l[instrument]['m
-0002e990: 275d 5b31 5d5d 203d 2069 6e69 745f 6261  '][1]] = init_ba
-0002e9a0: 746d 616e 2863 6f72 7265 6374 6564 5f74  tman(corrected_t
-0002e9b0: 2c20 7365 6c66 2e64 6963 7469 6f6e 6172  , self.dictionar
-0002e9c0: 795b 696e 7374 7275 6d65 6e74 5d5b 276c  y[instrument]['l
-0002e9d0: 646c 6177 275d 290a 0a0a 2020 2020 2020  dlaw'])...      
-0002e9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e9f0: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-0002ea00: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
-0002ea10: 7472 756d 656e 745d 5b27 5472 616e 7369  trument]['Transi
-0002ea20: 7446 6974 4361 7477 6f6d 616e 275d 3a0a  tFitCatwoman']:.
-0002ea30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ea40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ea50: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-0002ea60: 7275 6d65 6e74 5d5b 2770 6172 616d 7327  rument]['params'
-0002ea70: 5d2e 7270 203d 2070 0a20 2020 2020 2020  ].rp = p.       
-0002ea80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ea90: 2020 2020 2020 2020 200a 2020 2020 2020           .      
-0002eaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002eab0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002eac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ead0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+0002e930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e940: 2020 2020 2020 206e 7265 7361 6d70 6c69         nresampli
+0002e950: 6e67 203d 2073 656c 662e 6469 6374 696f  ng = self.dictio
+0002e960: 6e61 7279 5b69 6e73 7472 756d 656e 745d  nary[instrument]
+0002e970: 5b27 6e72 6573 616d 706c 696e 6727 5d2c  ['nresampling'],
+0002e980: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+0002e990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e9d0: 2020 2020 2020 2020 2020 2020 6574 7265              etre
+0002e9e0: 7361 6d70 6c69 6e67 203d 2073 656c 662e  sampling = self.
+0002e9f0: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
+0002ea00: 756d 656e 745d 5b27 6578 7074 696d 6572  ument]['exptimer
+0002ea10: 6573 616d 706c 696e 6727 5d29 0a0a 2020  esampling'])..  
+0002ea20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ea30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ea40: 2020 2020 2020 656c 7365 3a0a 0a20 2020        else:..   
+0002ea50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ea60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ea70: 2020 2020 2020 2020 205f 2c20 5b5f 2c20           _, [_, 
+0002ea80: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+0002ea90: 756d 656e 745d 5b27 6d27 5d5d 203d 2069  ument]['m']] = i
+0002eaa0: 6e69 745f 6261 746d 616e 2863 6f72 7265  nit_batman(corre
+0002eab0: 6374 6564 5f74 2c20 7365 6c66 2e64 6963  cted_t, self.dic
+0002eac0: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
+0002ead0: 6e74 5d5b 276c 646c 6177 275d 290a 0a20  nt]['ldlaw']).. 
 0002eae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002eaf0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002eb00: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
-0002eb10: 5d5b 2770 6172 616d 7327 5d2e 7270 203d  ]['params'].rp =
-0002eb20: 2070 310a 2020 2020 2020 2020 2020 2020   p1.            
-0002eb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002eb40: 2020 2020 7365 6c66 2e6d 6f64 656c 5b69      self.model[i
-0002eb50: 6e73 7472 756d 656e 745d 5b27 7061 7261  nstrument]['para
-0002eb60: 6d73 275d 2e72 7032 203d 2070 320a 2020  ms'].rp2 = p2.  
-0002eb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002eb80: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0002eb90: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
-0002eba0: 656e 745d 5b27 7061 7261 6d73 275d 2e70  ent]['params'].p
-0002ebb0: 6869 203d 2070 6869 0a20 2020 2020 2020  hi = phi.       
-0002ebc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ebd0: 2020 2020 2020 2020 200a 2020 2020 2020           .      
-0002ebe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ebf0: 2020 2020 2020 6966 2073 656c 662e 6469        if self.di
+0002eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eb00: 2020 2065 6c69 6620 7365 6c66 2e64 6963     elif self.dic
+0002eb10: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
+0002eb20: 6e74 5d5b 2754 7261 6e45 636c 4669 7427  nt]['TranEclFit'
+0002eb30: 5d3a 0a0a 2020 2020 2020 2020 2020 2020  ]:..            
+0002eb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eb50: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0002eb60: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
+0002eb70: 6e73 7472 756d 656e 745d 5b27 7265 7361  nstrument]['resa
+0002eb80: 6d70 6c69 6e67 275d 3a0a 0a20 2020 2020  mpling']:..     
+0002eb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ebb0: 2020 2020 2020 205f 2c20 5b5f 2c20 7365         _, [_, se
+0002ebc0: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
+0002ebd0: 656e 745d 5b27 6d27 5d5b 315d 5d20 3d20  ent]['m'][1]] = 
+0002ebe0: 696e 6974 5f62 6174 6d61 6e28 636f 7272  init_batman(corr
+0002ebf0: 6563 7465 645f 742c 2073 656c 662e 6469  ected_t, self.di
 0002ec00: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
-0002ec10: 656e 745d 5b27 6c64 6c61 7727 5d20 213d  ent]['ldlaw'] !=
-0002ec20: 2027 6c69 6e65 6172 273a 0a20 2020 2020   'linear':.     
+0002ec10: 656e 745d 5b27 6c64 6c61 7727 5d2c 205c  ent]['ldlaw'], \
+0002ec20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0002ec30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ec40: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+0002ec40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002ec50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ec60: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0002ec70: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
-0002ec80: 5b27 7061 7261 6d73 275d 2e75 203d 205b  ['params'].u = [
-0002ec90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002eca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ecb0: 2020 2020 2063 6f65 6666 312c 2063 6f65       coeff1, coe
-0002ecc0: 6666 320a 2020 2020 2020 2020 2020 2020  ff2.            
+0002ec60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ec70: 2020 2020 2020 2020 2020 6e72 6573 616d            nresam
+0002ec80: 706c 696e 6720 3d20 7365 6c66 2e64 6963  pling = self.dic
+0002ec90: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
+0002eca0: 6e74 5d5b 276e 7265 7361 6d70 6c69 6e67  nt]['nresampling
+0002ecb0: 275d 2c20 5c0a 2020 2020 2020 2020 2020  '], \.          
+0002ecc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002ecd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ece0: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
+0002ece0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002ecf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ed00: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
-0002ed10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ed20: 2020 2065 6c73 653a 0a0a 2020 2020 2020     else:..      
-0002ed30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ed40: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0002ed50: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
-0002ed60: 5b27 7061 7261 6d73 275d 2e75 203d 205b  ['params'].u = [
-0002ed70: 636f 6566 6631 5d0a 0a20 2020 2020 2020  coeff1]..       
+0002ed00: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002ed10: 7472 6573 616d 706c 696e 6720 3d20 7365  tresampling = se
+0002ed20: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
+0002ed30: 7374 7275 6d65 6e74 5d5b 2765 7870 7469  strument]['expti
+0002ed40: 6d65 7265 7361 6d70 6c69 6e67 275d 290a  meresampling']).
+0002ed50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ed60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ed70: 2020 2020 2020 2020 2065 6c73 653a 0a0a           else:..
 0002ed80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ed90: 2020 2020 2023 2049 6620 5454 5673 2069       # If TTVs i
-0002eda0: 7320 6f6e 2066 6f72 2070 6c61 6e65 7420  s on for planet 
-0002edb0: 692c 2063 6f6d 7075 7465 2074 6865 2065  i, compute the e
-0002edc0: 7870 6563 7465 6420 7469 6d65 206f 6620  xpected time of 
-0002edd0: 7472 616e 7369 742c 2061 6e64 2073 6869  transit, and shi
-0002ede0: 6674 2069 742e 2046 6f72 2074 6869 732c  ft it. For this,
-0002edf0: 2075 7365 2069 6e66 6f72 6d61 7469 6f6e   use information
-0002ee00: 2065 6e63 6f64 6564 2069 6e20 7468 6520   encoded in the 
-0002ee10: 7072 696f 720a 2020 2020 2020 2020 2020  prior.          
+0002ed90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eda0: 2020 2020 2020 2020 2020 2020 5f2c 205b              _, [
+0002edb0: 5f2c 2073 656c 662e 6d6f 6465 6c5b 696e  _, self.model[in
+0002edc0: 7374 7275 6d65 6e74 5d5b 276d 275d 5b31  strument]['m'][1
+0002edd0: 5d5d 203d 2069 6e69 745f 6261 746d 616e  ]] = init_batman
+0002ede0: 2863 6f72 7265 6374 6564 5f74 2c20 7365  (corrected_t, se
+0002edf0: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
+0002ee00: 7374 7275 6d65 6e74 5d5b 276c 646c 6177  strument]['ldlaw
+0002ee10: 275d 290a 0a0a 2020 2020 2020 2020 2020  '])...          
 0002ee20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ee30: 2020 2320 6e61 6d65 3b20 6966 2c20 652e    # name; if, e.
-0002ee40: 672e 2c20 6474 5f70 315f 5445 5353 315f  g., dt_p1_TESS1_
-0002ee50: 2d32 2c20 7468 656e 206e 203d 202d 3220  -2, then n = -2 
-0002ee60: 616e 6420 7468 6520 7469 6d65 206f 6620  and the time of 
-0002ee70: 7472 616e 7369 7420 2877 6974 6820 5454  transit (with TT
-0002ee80: 5629 203d 2074 3020 2b20 6e2a 5020 2b20  V) = t0 + n*P + 
-0002ee90: 6474 5f70 315f 5445 5353 315f 2d32 2e20  dt_p1_TESS1_-2. 
-0002eea0: 436f 6d70 7574 6520 7472 616e 7369 740a  Compute transit.
-0002eeb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002eec0: 2020 2020 2020 2020 2020 2020 2320 6d6f              # mo
-0002eed0: 6465 6c20 6173 7375 6d69 6e67 2074 6861  del assuming tha
-0002eee0: 7420 7469 6d65 2d6f 662d 7472 616e 7369  t time-of-transi
-0002eef0: 743b 2072 6570 6561 7420 666f 7220 616c  t; repeat for al
-0002ef00: 6c20 7468 6520 7472 616e 7369 7473 2e20  l the transits. 
-0002ef10: 4765 6e65 7261 6c6c 7920 7573 6572 7320  Generally users 
-0002ef20: 7769 6c6c 206e 6f74 2064 6f20 5454 5620  will not do TTV 
-0002ef30: 616e 616c 7973 6573 2c20 736f 2073 6574  analyses, so set
-0002ef40: 2074 6869 7320 6c61 7474 6572 0a20 2020   this latter.   
-0002ef50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ef60: 2020 2020 2020 2020 2023 2063 6173 6520           # case 
-0002ef70: 746f 2062 6520 7468 6520 6d6f 7374 2063  to be the most c
-0002ef80: 6f6d 6d6f 6e20 6f6e 6520 6279 2064 6566  ommon one by def
-0002ef90: 6175 6c74 2069 6e20 7468 6520 6966 2d73  ault in the if-s
-0002efa0: 7461 7465 6d65 6e74 3a0a 0a20 2020 2020  tatement:..     
+0002ee30: 2020 6966 206e 6f74 2073 656c 662e 6469    if not self.di
+0002ee40: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
+0002ee50: 656e 745d 5b27 5472 616e 7369 7446 6974  ent]['TransitFit
+0002ee60: 4361 7477 6f6d 616e 275d 3a0a 0a20 2020  Catwoman']:..   
+0002ee70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ee80: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0002ee90: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+0002eea0: 6e74 5d5b 2770 6172 616d 7327 5d2e 7270  nt]['params'].rp
+0002eeb0: 203d 2070 0a20 2020 2020 2020 2020 2020   = p.           
+0002eec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eed0: 2020 2020 200a 2020 2020 2020 2020 2020       .          
+0002eee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eef0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0002ef00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ef10: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
+0002ef20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ef30: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
+0002ef40: 6c5b 696e 7374 7275 6d65 6e74 5d5b 2770  l[instrument]['p
+0002ef50: 6172 616d 7327 5d2e 7270 203d 2070 310a  arams'].rp = p1.
+0002ef60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ef80: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+0002ef90: 756d 656e 745d 5b27 7061 7261 6d73 275d  ument]['params']
+0002efa0: 2e72 7032 203d 2070 320a 2020 2020 2020  .rp2 = p2.      
 0002efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002efc0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-0002efd0: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
-0002efe0: 7374 7275 6d65 6e74 5d5b 2754 5456 7327  strument]['TTVs'
-0002eff0: 5d5b 695d 5b0a 2020 2020 2020 2020 2020  ][i][.          
+0002efc0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0002efd0: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
+0002efe0: 5b27 7061 7261 6d73 275d 2e70 6869 203d  ['params'].phi =
+0002eff0: 2070 6869 0a20 2020 2020 2020 2020 2020   phi.           
 0002f000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f010: 2020 2020 2020 2020 2020 2773 7461 7475            'statu
-0002f020: 7327 5d3a 0a0a 2020 2020 2020 2020 2020  s']:..          
-0002f030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f040: 2020 2020 2020 2320 4966 206c 6f67 5f6c        # If log_l
-0002f050: 696b 655f 6361 6c63 2069 7320 5472 7565  ike_calc is True
-0002f060: 2028 6279 2064 6566 6175 6c74 2064 7572   (by default dur
-0002f070: 696e 6720 6a75 6c69 6574 2e66 6974 292c  ing juliet.fit),
-0002f080: 2064 6f6e 2774 2062 6f74 6865 7220 7361   don't bother sa
-0002f090: 7669 6e67 2074 6865 206c 6967 6874 6375  ving the lightcu
-0002f0a0: 7276 6520 6f66 2070 6c61 6e65 7420 705f  rve of planet p_
-0002f0b0: 693a 0a0a 2020 2020 2020 2020 2020 2020  i:..            
-0002f0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f0d0: 2020 2020 6966 2073 656c 662e 6c6f 675f      if self.log_
-0002f0e0: 6c69 6b65 5f63 616c 633a 0a0a 2020 2020  like_calc:..    
-0002f0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f010: 2020 2020 200a 2020 2020 2020 2020 2020       .          
+0002f020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f030: 2020 6966 2073 656c 662e 6469 6374 696f    if self.dictio
+0002f040: 6e61 7279 5b69 6e73 7472 756d 656e 745d  nary[instrument]
+0002f050: 5b27 6c64 6c61 7727 5d20 213d 2027 6c69  ['ldlaw'] != 'li
+0002f060: 6e65 6172 273a 0a20 2020 2020 2020 2020  near':.         
+0002f070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f080: 2020 2020 200a 2020 2020 2020 2020 2020       .          
+0002f090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f0a0: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
+0002f0b0: 5b69 6e73 7472 756d 656e 745d 5b27 7061  [instrument]['pa
+0002f0c0: 7261 6d73 275d 2e75 203d 205b 0a20 2020  rams'].u = [.   
+0002f0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f0f0: 2063 6f65 6666 312c 2063 6f65 6666 320a   coeff1, coeff2.
 0002f100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f110: 6966 206e 6f74 2073 656c 662e 6469 6374  if not self.dict
-0002f120: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
-0002f130: 745d 5b27 5472 616e 4563 6c46 6974 275d  t]['TranEclFit']
-0002f140: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002f150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f160: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002f170: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
-0002f180: 5d5b 274d 275d 202b 3d20 7365 6c66 2e6d  ]['M'] += self.m
-0002f190: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
-0002f1a0: 5b27 6d27 5d2e 6c69 6768 745f 6375 7276  ['m'].light_curv
-0002f1b0: 6528 7365 6c66 2e6d 6f64 656c 5b69 6e73  e(self.model[ins
-0002f1c0: 7472 756d 656e 745d 5b27 7061 7261 6d73  trument]['params
-0002f1d0: 275d 2920 2d20 312e 0a0a 2020 2020 2020  ']) - 1...      
-0002f1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f1f0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0002f200: 7365 3a0a 0a20 2020 2020 2020 2020 2020  se:..           
-0002f210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f220: 2020 2020 2020 2020 2020 2020 2023 2049               # I
-0002f230: 6e20 636f 6d62 696e 6564 2074 7261 6e73  n combined trans
-0002f240: 6974 202b 2065 636c 6970 7365 206d 6f64  it + eclipse mod
-0002f250: 656c 732c 2061 7373 756d 6520 6569 7468  els, assume eith
-0002f260: 6572 2028 6129 2062 7920 6465 6661 756c  er (a) by defaul
-0002f270: 7420 616e 7920 7068 6173 652d 6375 7276  t any phase-curv
-0002f280: 6520 7661 7269 6174 696f 6e73 2061 7265  e variations are
-0002f290: 2062 6569 6e67 206d 6f64 656c 6c65 6420   being modelled 
-0002f2a0: 6578 7465 726e 616c 6c79 200a 2020 2020  externally .    
-0002f2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f2d0: 2020 2020 2320 2862 792c 2065 2e67 2e2c      # (by, e.g.,
-0002f2e0: 2073 7973 7465 6d61 7469 6373 206d 6f64   systematics mod
-0002f2f0: 656c 732c 2070 6861 7365 2d63 7572 7665  els, phase-curve
-0002f300: 2076 6172 6961 7469 6f6e 7320 6164 6465   variations adde
-0002f310: 6420 6c61 7465 722c 2065 7463 2e29 2e20  d later, etc.). 
-0002f320: 546f 2074 6869 7320 656e 642c 206e 6f74  To this end, not
-0002f330: 6520 6261 746d 616e 2068 6173 206f 7574  e batman has out
-0002f340: 2d6f 662d 6563 6c69 7073 6520 0a20 2020  -of-eclipse .   
-0002f350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f370: 2020 2020 2023 206d 6f64 656c 2076 6172       # model var
-0002f380: 6961 7469 6f6e 7320 3120 2b20 6670 202d  iations 1 + fp -
-0002f390: 2d2d 2077 6974 6820 696e 2d65 636c 6970  -- with in-eclip
-0002f3a0: 7365 2061 6c77 6179 7320 6265 696e 6720  se always being 
-0002f3b0: 312e 2053 7562 7472 6163 7420 6670 2074  1. Subtract fp t
-0002f3c0: 6865 6e3a 3a0a 2020 2020 2020 2020 2020  hen::.          
-0002f3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f3e0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-0002f3f0: 616e 7369 745f 6d6f 6465 6c20 3d20 7365  ansit_model = se
-0002f400: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
-0002f410: 656e 745d 5b27 6d27 5d5b 305d 2e6c 6967  ent]['m'][0].lig
-0002f420: 6874 5f63 7572 7665 2873 656c 662e 6d6f  ht_curve(self.mo
-0002f430: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
-0002f440: 2770 6172 616d 7327 5d29 0a20 2020 2020  'params']).     
-0002f450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f470: 2020 2065 636c 6970 7365 5f6d 6f64 656c     eclipse_model
-0002f480: 203d 2073 656c 662e 6d6f 6465 6c5b 696e   = self.model[in
-0002f490: 7374 7275 6d65 6e74 5d5b 276d 275d 5b31  strument]['m'][1
-0002f4a0: 5d2e 6c69 6768 745f 6375 7276 6528 7365  ].light_curve(se
-0002f4b0: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
-0002f4c0: 656e 745d 5b27 7061 7261 6d73 275d 2920  ent]['params']) 
-0002f4d0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002f4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f4f0: 2020 2020 2020 2020 2020 2320 4e6f 772c            # Now,
-0002f500: 2066 6967 7572 6520 6f75 7420 6966 2061   figure out if a
-0002f510: 2070 6861 7365 2d63 7572 7665 206d 6f64   phase-curve mod
-0002f520: 656c 2069 7320 6265 696e 6720 6669 7420  el is being fit 
-0002f530: 6f72 206e 6f74 3a0a 2020 2020 2020 2020  or not:.        
-0002f540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f560: 6966 206e 6f74 2073 656c 662e 6469 6374  if not self.dict
-0002f570: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
-0002f580: 745d 5b27 5068 6173 6543 7572 7665 4669  t]['PhaseCurveFi
-0002f590: 7427 5d3a 0a0a 2020 2020 2020 2020 2020  t']:..          
-0002f5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f5c0: 2020 6563 6c69 7073 655f 6d6f 6465 6c20    eclipse_model 
-0002f5d0: 3d20 6563 6c69 7073 655f 6d6f 6465 6c20  = eclipse_model 
-0002f5e0: 2d20 7365 6c66 2e6d 6f64 656c 5b69 6e73  - self.model[ins
-0002f5f0: 7472 756d 656e 745d 5b27 7061 7261 6d73  trument]['params
-0002f600: 275d 2e66 700a 2020 2020 2020 2020 2020  '].fp.          
-0002f610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f120: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0002f130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f140: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
+0002f150: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002f160: 6c73 653a 0a0a 2020 2020 2020 2020 2020  lse:..          
+0002f170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f180: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
+0002f190: 5b69 6e73 7472 756d 656e 745d 5b27 7061  [instrument]['pa
+0002f1a0: 7261 6d73 275d 2e75 203d 205b 636f 6566  rams'].u = [coef
+0002f1b0: 6631 5d0a 0a20 2020 2020 2020 2020 2020  f1]..           
+0002f1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f1d0: 2023 2049 6620 5454 5673 2069 7320 6f6e   # If TTVs is on
+0002f1e0: 2066 6f72 2070 6c61 6e65 7420 692c 2063   for planet i, c
+0002f1f0: 6f6d 7075 7465 2074 6865 2065 7870 6563  ompute the expec
+0002f200: 7465 6420 7469 6d65 206f 6620 7472 616e  ted time of tran
+0002f210: 7369 742c 2061 6e64 2073 6869 6674 2069  sit, and shift i
+0002f220: 742e 2046 6f72 2074 6869 732c 2075 7365  t. For this, use
+0002f230: 2069 6e66 6f72 6d61 7469 6f6e 2065 6e63   information enc
+0002f240: 6f64 6564 2069 6e20 7468 6520 7072 696f  oded in the prio
+0002f250: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+0002f260: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0002f270: 6e61 6d65 3b20 6966 2c20 652e 672e 2c20  name; if, e.g., 
+0002f280: 6474 5f70 315f 5445 5353 315f 2d32 2c20  dt_p1_TESS1_-2, 
+0002f290: 7468 656e 206e 203d 202d 3220 616e 6420  then n = -2 and 
+0002f2a0: 7468 6520 7469 6d65 206f 6620 7472 616e  the time of tran
+0002f2b0: 7369 7420 2877 6974 6820 5454 5629 203d  sit (with TTV) =
+0002f2c0: 2074 3020 2b20 6e2a 5020 2b20 6474 5f70   t0 + n*P + dt_p
+0002f2d0: 315f 5445 5353 315f 2d32 2e20 436f 6d70  1_TESS1_-2. Comp
+0002f2e0: 7574 6520 7472 616e 7369 740a 2020 2020  ute transit.    
+0002f2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f300: 2020 2020 2020 2020 2320 6d6f 6465 6c20          # model 
+0002f310: 6173 7375 6d69 6e67 2074 6861 7420 7469  assuming that ti
+0002f320: 6d65 2d6f 662d 7472 616e 7369 743b 2072  me-of-transit; r
+0002f330: 6570 6561 7420 666f 7220 616c 6c20 7468  epeat for all th
+0002f340: 6520 7472 616e 7369 7473 2e20 4765 6e65  e transits. Gene
+0002f350: 7261 6c6c 7920 7573 6572 7320 7769 6c6c  rally users will
+0002f360: 206e 6f74 2064 6f20 5454 5620 616e 616c   not do TTV anal
+0002f370: 7973 6573 2c20 736f 2073 6574 2074 6869  yses, so set thi
+0002f380: 7320 6c61 7474 6572 0a20 2020 2020 2020  s latter.       
+0002f390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f3a0: 2020 2020 2023 2063 6173 6520 746f 2062       # case to b
+0002f3b0: 6520 7468 6520 6d6f 7374 2063 6f6d 6d6f  e the most commo
+0002f3c0: 6e20 6f6e 6520 6279 2064 6566 6175 6c74  n one by default
+0002f3d0: 2069 6e20 7468 6520 6966 2d73 7461 7465   in the if-state
+0002f3e0: 6d65 6e74 3a0a 0a20 2020 2020 2020 2020  ment:..         
+0002f3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f400: 2020 2069 6620 6e6f 7420 7365 6c66 2e64     if not self.d
+0002f410: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
+0002f420: 6d65 6e74 5d5b 2754 5456 7327 5d5b 695d  ment]['TTVs'][i]
+0002f430: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+0002f440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f450: 2020 2020 2020 2773 7461 7475 7327 5d3a        'status']:
+0002f460: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002f470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f480: 2020 2320 4966 206c 6f67 5f6c 696b 655f    # If log_like_
+0002f490: 6361 6c63 2069 7320 5472 7565 2028 6279  calc is True (by
+0002f4a0: 2064 6566 6175 6c74 2064 7572 696e 6720   default during 
+0002f4b0: 6a75 6c69 6574 2e66 6974 292c 2064 6f6e  juliet.fit), don
+0002f4c0: 2774 2062 6f74 6865 7220 7361 7669 6e67  't bother saving
+0002f4d0: 2074 6865 206c 6967 6874 6375 7276 6520   the lightcurve 
+0002f4e0: 6f66 2070 6c61 6e65 7420 705f 693a 0a0a  of planet p_i:..
+0002f4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f510: 6966 2073 656c 662e 6c6f 675f 6c69 6b65  if self.log_like
+0002f520: 5f63 616c 633a 0a0a 2020 2020 2020 2020  _calc:..        
+0002f530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f540: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0002f550: 6f74 2073 656c 662e 6469 6374 696f 6e61  ot self.dictiona
+0002f560: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
+0002f570: 5472 616e 4563 6c46 6974 275d 3a0a 0a20  TranEclFit']:.. 
+0002f580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f5a0: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
+0002f5b0: 6c5b 696e 7374 7275 6d65 6e74 5d5b 274d  l[instrument]['M
+0002f5c0: 275d 202b 3d20 7365 6c66 2e6d 6f64 656c  '] += self.model
+0002f5d0: 5b69 6e73 7472 756d 656e 745d 5b27 6d27  [instrument]['m'
+0002f5e0: 5d2e 6c69 6768 745f 6375 7276 6528 7365  ].light_curve(se
+0002f5f0: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
+0002f600: 656e 745d 5b27 7061 7261 6d73 275d 2920  ent]['params']) 
+0002f610: 2d20 312e 0a0a 2020 2020 2020 2020 2020  - 1...          
 0002f620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f630: 2020 7365 6c66 2e6d 6f64 656c 5b69 6e73    self.model[ins
-0002f640: 7472 756d 656e 745d 5b27 4d27 5d20 2b3d  trument]['M'] +=
-0002f650: 2074 7261 6e73 6974 5f6d 6f64 656c 202a   transit_model *
-0002f660: 2065 636c 6970 7365 5f6d 6f64 656c 202d   eclipse_model -
-0002f670: 2031 2e0a 0a20 2020 2020 2020 2020 2020   1...           
-0002f680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f690: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0002f6a0: 653a 0a0a 2020 2020 2020 2020 2020 2020  e:..            
-0002f6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f6d0: 6f72 6269 7461 6c5f 7068 6173 6520 3d20  orbital_phase = 
-0002f6e0: 2820 2820 2820 7365 6c66 2e6d 6f64 656c  ( ( ( self.model
-0002f6f0: 5b69 6e73 7472 756d 656e 745d 5b27 6d27  [instrument]['m'
-0002f700: 5d5b 315d 2e74 202d 2073 656c 662e 6d6f  ][1].t - self.mo
-0002f710: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
-0002f720: 2770 6172 616d 7327 5d2e 7430 2029 202f  'params'].t0 ) /
-0002f730: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-0002f740: 7275 6d65 6e74 5d5b 2770 6172 616d 7327  rument]['params'
-0002f750: 5d2e 7065 7220 2920 2520 3120 290a 2020  ].per ) % 1 ).  
-0002f760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f780: 2020 2020 2020 2020 2020 6365 6e74 6572            center
-0002f790: 5f70 6861 7365 203d 202d 206e 702e 7069  _phase = - np.pi
-0002f7a0: 202f 2032 2e0a 0a20 2020 2020 2020 2020   / 2...         
-0002f7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f7d0: 2020 2023 2042 7569 6c64 206d 6f64 656c     # Build model
-0002f7e0: 2e20 4669 7273 742c 2074 6865 2062 6173  . First, the bas
-0002f7f0: 6973 2073 696e 6520 6675 6e63 7469 6f6e  is sine function
+0002f630: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0002f640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f660: 2020 2020 2020 2020 2023 2049 6e20 636f           # In co
+0002f670: 6d62 696e 6564 2074 7261 6e73 6974 202b  mbined transit +
+0002f680: 2065 636c 6970 7365 206d 6f64 656c 732c   eclipse models,
+0002f690: 2061 7373 756d 6520 6569 7468 6572 2028   assume either (
+0002f6a0: 6129 2062 7920 6465 6661 756c 7420 616e  a) by default an
+0002f6b0: 7920 7068 6173 652d 6375 7276 6520 7661  y phase-curve va
+0002f6c0: 7269 6174 696f 6e73 2061 7265 2062 6569  riations are bei
+0002f6d0: 6e67 206d 6f64 656c 6c65 6420 6578 7465  ng modelled exte
+0002f6e0: 726e 616c 6c79 200a 2020 2020 2020 2020  rnally .        
+0002f6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f710: 2320 2862 792c 2065 2e67 2e2c 2073 7973  # (by, e.g., sys
+0002f720: 7465 6d61 7469 6373 206d 6f64 656c 732c  tematics models,
+0002f730: 2070 6861 7365 2d63 7572 7665 2076 6172   phase-curve var
+0002f740: 6961 7469 6f6e 7320 6164 6465 6420 6c61  iations added la
+0002f750: 7465 722c 2065 7463 2e29 2e20 546f 2074  ter, etc.). To t
+0002f760: 6869 7320 656e 642c 206e 6f74 6520 6261  his end, note ba
+0002f770: 746d 616e 2068 6173 206f 7574 2d6f 662d  tman has out-of-
+0002f780: 6563 6c69 7073 6520 0a20 2020 2020 2020  eclipse .       
+0002f790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f7b0: 2023 206d 6f64 656c 2076 6172 6961 7469   # model variati
+0002f7c0: 6f6e 7320 3120 2b20 6670 202d 2d2d 2077  ons 1 + fp --- w
+0002f7d0: 6974 6820 696e 2d65 636c 6970 7365 2061  ith in-eclipse a
+0002f7e0: 6c77 6179 7320 6265 696e 6720 312e 2053  lways being 1. S
+0002f7f0: 7562 7472 6163 7420 6670 2074 6865 6e3a  ubtract fp then:
 0002f800: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
 0002f810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f820: 2020 2020 2020 2020 2020 2020 2020 7369                si
-0002f830: 6e65 5f6d 6f64 656c 203d 206e 702e 7369  ne_model = np.si
-0002f840: 6e28 322e 202a 206e 702e 7069 202a 2028  n(2. * np.pi * (
-0002f850: 6f72 6269 7461 6c5f 7068 6173 6529 202b  orbital_phase) +
-0002f860: 2063 656e 7465 725f 7068 6173 6520 2b20   center_phase + 
-0002f870: 7068 6173 655f 6f66 6673 6574 202a 2028  phase_offset * (
-0002f880: 6e70 2e70 6920 2f20 3138 302e 2920 290a  np.pi / 180.) ).
+0002f820: 2020 2020 2020 2020 2020 7472 616e 7369            transi
+0002f830: 745f 6d6f 6465 6c20 3d20 7365 6c66 2e6d  t_model = self.m
+0002f840: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
+0002f850: 5b27 6d27 5d5b 305d 2e6c 6967 6874 5f63  ['m'][0].light_c
+0002f860: 7572 7665 2873 656c 662e 6d6f 6465 6c5b  urve(self.model[
+0002f870: 696e 7374 7275 6d65 6e74 5d5b 2770 6172  instrument]['par
+0002f880: 616d 7327 5d29 0a20 2020 2020 2020 2020  ams']).         
 0002f890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f8b0: 2020 2020 2020 2020 2020 2020 2320 5363              # Sc
-0002f8c0: 616c 6520 746f 2062 6520 3120 6174 2073  ale to be 1 at s
-0002f8d0: 6563 6f6e 6461 7279 2065 636c 6970 7365  econdary eclipse
-0002f8e0: 2c20 3020 6174 2074 7261 6e73 6974 3a0a  , 0 at transit:.
-0002f8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f910: 2020 2020 2020 2020 2020 2020 7369 6e65              sine
-0002f920: 5f6d 6f64 656c 203d 2028 7369 6e65 5f6d  _model = (sine_m
-0002f930: 6f64 656c 202b 2031 2920 2a20 302e 350a  odel + 1) * 0.5.
-0002f940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f960: 2020 2020 2020 2020 2020 2020 2320 416d              # Am
-0002f970: 706c 6966 7920 6279 2070 6861 7365 2d61  plify by phase-a
-0002f980: 6d70 6c69 7475 6465 3a0a 2020 2020 2020  mplitude:.      
-0002f990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f9b0: 2020 2020 2020 7369 6e65 5f6d 6f64 656c        sine_model
-0002f9c0: 203d 2028 7365 6c66 2e6d 6f64 656c 5b69   = (self.model[i
-0002f9d0: 6e73 7472 756d 656e 745d 5b27 7061 7261  nstrument]['para
-0002f9e0: 6d73 275d 2e66 7029 202a 2073 696e 655f  ms'].fp) * sine_
-0002f9f0: 6d6f 6465 6c0a 2020 2020 2020 2020 2020  model.          
-0002fa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fa20: 2020 2320 4d75 6c74 6970 6c79 2062 7920    # Multiply by 
-0002fa30: 6e6f 726d 6564 2065 636c 6970 7365 206d  normed eclipse m
-0002fa40: 6f64 656c 3a0a 2020 2020 2020 2020 2020  odel:.          
+0002f8a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002f8b0: 636c 6970 7365 5f6d 6f64 656c 203d 2073  clipse_model = s
+0002f8c0: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
+0002f8d0: 6d65 6e74 5d5b 276d 275d 5b31 5d2e 6c69  ment]['m'][1].li
+0002f8e0: 6768 745f 6375 7276 6528 7365 6c66 2e6d  ght_curve(self.m
+0002f8f0: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
+0002f900: 5b27 7061 7261 6d73 275d 2920 0a0a 2020  ['params']) ..  
+0002f910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f930: 2020 2020 2020 2320 4e6f 772c 2066 6967        # Now, fig
+0002f940: 7572 6520 6f75 7420 6966 2061 2070 6861  ure out if a pha
+0002f950: 7365 2d63 7572 7665 206d 6f64 656c 2069  se-curve model i
+0002f960: 7320 6265 696e 6720 6669 7420 6f72 206e  s being fit or n
+0002f970: 6f74 3a0a 2020 2020 2020 2020 2020 2020  ot:.            
+0002f980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f990: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0002f9a0: 6f74 2073 656c 662e 6469 6374 696f 6e61  ot self.dictiona
+0002f9b0: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
+0002f9c0: 5068 6173 6543 7572 7665 4669 7427 5d3a  PhaseCurveFit']:
+0002f9d0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002f9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f9f0: 2020 2020 2020 2020 2020 2020 2020 6563                ec
+0002fa00: 6c69 7073 655f 6d6f 6465 6c20 3d20 6563  lipse_model = ec
+0002fa10: 6c69 7073 655f 6d6f 6465 6c20 2d20 7365  lipse_model - se
+0002fa20: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
+0002fa30: 656e 745d 5b27 7061 7261 6d73 275d 2e66  ent]['params'].f
+0002fa40: 700a 2020 2020 2020 2020 2020 2020 2020  p.              
 0002fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fa70: 2020 7369 6e65 5f6d 6f64 656c 203d 2031    sine_model = 1
-0002fa80: 2e20 2b20 7369 6e65 5f6d 6f64 656c 202a  . + sine_model *
-0002fa90: 2028 2865 636c 6970 7365 5f6d 6f64 656c   ((eclipse_model
-0002faa0: 202d 2031 2e29 202f 2073 656c 662e 6d6f   - 1.) / self.mo
-0002fab0: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
-0002fac0: 2770 6172 616d 7327 5d2e 6670 290a 0a20  'params'].fp).. 
-0002fad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fa60: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0002fa70: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
+0002fa80: 656e 745d 5b27 4d27 5d20 2b3d 2074 7261  ent]['M'] += tra
+0002fa90: 6e73 6974 5f6d 6f64 656c 202a 2065 636c  nsit_model * ecl
+0002faa0: 6970 7365 5f6d 6f64 656c 202d 2031 2e0a  ipse_model - 1..
+0002fab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fad0: 2020 2020 2020 2020 2065 6c73 653a 0a0a           else:..
 0002fae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002faf0: 2020 2020 2020 2020 2020 2023 2041 6e64             # And
-0002fb00: 2067 6574 2061 6c6c 2074 6f67 6574 6865   get all togethe
-0002fb10: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
-0002fb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fb30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0002fb40: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
-0002fb50: 6d65 6e74 5d5b 274d 275d 202b 3d20 7472  ment]['M'] += tr
-0002fb60: 616e 7369 745f 6d6f 6465 6c20 2a20 7369  ansit_model * si
-0002fb70: 6e65 5f6d 6f64 656c 202d 2031 2e0a 0a20  ne_model - 1... 
-0002fb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fb90: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0002fba0: 6c73 653a 0a0a 2020 2020 2020 2020 2020  lse:..          
+0002faf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fb00: 2020 2020 2020 2020 2020 2020 6f72 6269              orbi
+0002fb10: 7461 6c5f 7068 6173 6520 3d20 2820 2820  tal_phase = ( ( 
+0002fb20: 2820 7365 6c66 2e6d 6f64 656c 5b69 6e73  ( self.model[ins
+0002fb30: 7472 756d 656e 745d 5b27 6d27 5d5b 315d  trument]['m'][1]
+0002fb40: 2e74 202d 2073 656c 662e 6d6f 6465 6c5b  .t - self.model[
+0002fb50: 696e 7374 7275 6d65 6e74 5d5b 2770 6172  instrument]['par
+0002fb60: 616d 7327 5d2e 7430 2029 202f 2073 656c  ams'].t0 ) / sel
+0002fb70: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+0002fb80: 6e74 5d5b 2770 6172 616d 7327 5d2e 7065  nt]['params'].pe
+0002fb90: 7220 2920 2520 3120 290a 2020 2020 2020  r ) % 1 ).      
+0002fba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002fbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fbc0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0002fbd0: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-0002fbe0: 5b69 6e73 7472 756d 656e 745d 5b27 5472  [instrument]['Tr
-0002fbf0: 616e 4563 6c46 6974 275d 3a0a 0a20 2020  anEclFit']:..   
-0002fc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fc20: 2020 2020 2073 656c 662e 6d6f 6465 6c5b       self.model[
-0002fc30: 696e 7374 7275 6d65 6e74 5d5b 2770 272b  instrument]['p'+
-0002fc40: 7374 7228 6929 5d20 3d20 7365 6c66 2e6d  str(i)] = self.m
-0002fc50: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
-0002fc60: 5b27 6d27 5d2e 6c69 6768 745f 6375 7276  ['m'].light_curv
-0002fc70: 6528 7365 6c66 2e6d 6f64 656c 5b69 6e73  e(self.model[ins
-0002fc80: 7472 756d 656e 745d 5b27 7061 7261 6d73  trument]['params
-0002fc90: 275d 290a 2020 2020 2020 2020 2020 2020  ']).            
-0002fca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fcb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002fcc0: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
-0002fcd0: 745d 5b27 4d27 5d20 2b3d 2073 656c 662e  t]['M'] += self.
-0002fce0: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
-0002fcf0: 5d5b 2770 272b 7374 7228 6929 5d20 2d20  ]['p'+str(i)] - 
-0002fd00: 312e 0a0a 2020 2020 2020 2020 2020 2020  1...            
-0002fd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fd20: 2020 2020 2020 2020 656c 7365 3a0a 0a20          else:.. 
+0002fbc0: 2020 2020 2020 6365 6e74 6572 5f70 6861        center_pha
+0002fbd0: 7365 203d 202d 206e 702e 7069 202f 2032  se = - np.pi / 2
+0002fbe0: 2e0a 0a20 2020 2020 2020 2020 2020 2020  ...             
+0002fbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fc00: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0002fc10: 2042 7569 6c64 206d 6f64 656c 2e20 4669   Build model. Fi
+0002fc20: 7273 742c 2074 6865 2062 6173 6973 2073  rst, the basis s
+0002fc30: 696e 6520 6675 6e63 7469 6f6e 3a0a 2020  ine function:.  
+0002fc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fc60: 2020 2020 2020 2020 2020 7369 6e65 5f6d            sine_m
+0002fc70: 6f64 656c 203d 206e 702e 7369 6e28 322e  odel = np.sin(2.
+0002fc80: 202a 206e 702e 7069 202a 2028 6f72 6269   * np.pi * (orbi
+0002fc90: 7461 6c5f 7068 6173 6529 202b 2063 656e  tal_phase) + cen
+0002fca0: 7465 725f 7068 6173 6520 2b20 7068 6173  ter_phase + phas
+0002fcb0: 655f 6f66 6673 6574 202a 2028 6e70 2e70  e_offset * (np.p
+0002fcc0: 6920 2f20 3138 302e 2920 290a 2020 2020  i / 180.) ).    
+0002fcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fcf0: 2020 2020 2020 2020 2320 5363 616c 6520          # Scale 
+0002fd00: 746f 2062 6520 3120 6174 2073 6563 6f6e  to be 1 at secon
+0002fd10: 6461 7279 2065 636c 6970 7365 2c20 3020  dary eclipse, 0 
+0002fd20: 6174 2074 7261 6e73 6974 3a0a 2020 2020  at transit:.    
 0002fd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002fd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fd50: 2020 2020 2020 2023 2049 6e20 636f 6d62         # In comb
-0002fd60: 696e 6564 2074 7261 6e73 6974 202b 2065  ined transit + e
-0002fd70: 636c 6970 7365 206d 6f64 656c 732c 2061  clipse models, a
-0002fd80: 7373 756d 6520 6279 2064 6566 6175 6c74  ssume by default
-0002fd90: 2061 6e79 2070 6861 7365 2d63 7572 7665   any phase-curve
-0002fda0: 2076 6172 6961 7469 6f6e 7320 6172 6520   variations are 
-0002fdb0: 6265 696e 6720 6d6f 6465 6c6c 6564 2065  being modelled e
-0002fdc0: 7874 6572 6e61 6c6c 7920 0a20 2020 2020  xternally .     
+0002fd50: 2020 2020 2020 2020 7369 6e65 5f6d 6f64          sine_mod
+0002fd60: 656c 203d 2028 7369 6e65 5f6d 6f64 656c  el = (sine_model
+0002fd70: 202b 2031 2920 2a20 302e 350a 2020 2020   + 1) * 0.5.    
+0002fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fda0: 2020 2020 2020 2020 2320 416d 706c 6966          # Amplif
+0002fdb0: 7920 6279 2070 6861 7365 2d61 6d70 6c69  y by phase-ampli
+0002fdc0: 7475 6465 3a0a 2020 2020 2020 2020 2020  tude:.          
 0002fdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002fde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fdf0: 2020 2023 2062 7920 6465 6661 756c 7420     # by default 
-0002fe00: 2862 792c 2065 2e67 2e2c 2073 7973 7465  (by, e.g., syste
-0002fe10: 6d61 7469 6373 206d 6f64 656c 732c 2070  matics models, p
-0002fe20: 6861 7365 2d63 7572 7665 2076 6172 6961  hase-curve varia
-0002fe30: 7469 6f6e 7320 6164 6465 6420 6c61 7465  tions added late
-0002fe40: 722c 2065 7463 2e29 2e20 546f 2074 6869  r, etc.). To thi
-0002fe50: 7320 656e 642c 206e 6f74 6520 6261 746d  s end, note batm
-0002fe60: 616e 2068 6173 206f 7574 2d6f 662d 6563  an has out-of-ec
-0002fe70: 6c69 7073 6520 0a20 2020 2020 2020 2020  lipse .         
-0002fe80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fe90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0002fea0: 206d 6f64 656c 2076 6172 6961 7469 6f6e   model variation
-0002feb0: 7320 3120 2b20 6670 202d 2d2d 2077 6974  s 1 + fp --- wit
-0002fec0: 6820 696e 2d65 636c 6970 7365 2061 6c77  h in-eclipse alw
-0002fed0: 6179 7320 6265 696e 6720 312e 2053 7562  ays being 1. Sub
-0002fee0: 7472 6163 7420 6670 2074 6865 6e3a 3a0a  tract fp then::.
-0002fef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ff00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ff10: 2020 2020 2020 2020 7472 616e 7369 745f          transit_
-0002ff20: 6d6f 6465 6c20 3d20 7365 6c66 2e6d 6f64  model = self.mod
-0002ff30: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
-0002ff40: 6d27 5d5b 305d 2e6c 6967 6874 5f63 7572  m'][0].light_cur
-0002ff50: 7665 2873 656c 662e 6d6f 6465 6c5b 696e  ve(self.model[in
-0002ff60: 7374 7275 6d65 6e74 5d5b 2770 6172 616d  strument]['param
-0002ff70: 7327 5d29 0a20 2020 2020 2020 2020 2020  s']).           
-0002ff80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ff90: 2020 2020 2020 2020 2020 2020 2065 636c               ecl
-0002ffa0: 6970 7365 5f6d 6f64 656c 203d 2073 656c  ipse_model = sel
-0002ffb0: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
-0002ffc0: 6e74 5d5b 276d 275d 5b31 5d2e 6c69 6768  nt]['m'][1].ligh
-0002ffd0: 745f 6375 7276 6528 7365 6c66 2e6d 6f64  t_curve(self.mod
-0002ffe0: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
-0002fff0: 7061 7261 6d73 275d 2920 0a0a 2020 2020  params']) ..    
-00030000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030020: 2020 2020 2320 4e6f 772c 2066 6967 7572      # Now, figur
-00030030: 6520 6f75 7420 6966 2061 2070 6861 7365  e out if a phase
-00030040: 2d63 7572 7665 206d 6f64 656c 2069 7320  -curve model is 
-00030050: 6265 696e 6720 6669 7420 6f72 206e 6f74  being fit or not
-00030060: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00030070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030080: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00030090: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-000300a0: 5b69 6e73 7472 756d 656e 745d 5b27 5068  [instrument]['Ph
-000300b0: 6173 6543 7572 7665 4669 7427 5d3a 0a0a  aseCurveFit']:..
-000300c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fdf0: 2020 7369 6e65 5f6d 6f64 656c 203d 2028    sine_model = (
+0002fe00: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+0002fe10: 756d 656e 745d 5b27 7061 7261 6d73 275d  ument]['params']
+0002fe20: 2e66 7029 202a 2073 696e 655f 6d6f 6465  .fp) * sine_mode
+0002fe30: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
+0002fe40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fe50: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0002fe60: 4d75 6c74 6970 6c79 2062 7920 6e6f 726d  Multiply by norm
+0002fe70: 6564 2065 636c 6970 7365 206d 6f64 656c  ed eclipse model
+0002fe80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002fe90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fea0: 2020 2020 2020 2020 2020 2020 2020 7369                si
+0002feb0: 6e65 5f6d 6f64 656c 203d 2031 2e20 2b20  ne_model = 1. + 
+0002fec0: 7369 6e65 5f6d 6f64 656c 202a 2028 2865  sine_model * ((e
+0002fed0: 636c 6970 7365 5f6d 6f64 656c 202d 2031  clipse_model - 1
+0002fee0: 2e29 202f 2073 656c 662e 6d6f 6465 6c5b  .) / self.model[
+0002fef0: 696e 7374 7275 6d65 6e74 5d5b 2770 6172  instrument]['par
+0002ff00: 616d 7327 5d2e 6670 290a 0a20 2020 2020  ams'].fp)..     
+0002ff10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff30: 2020 2020 2020 2023 2041 6e64 2067 6574         # And get
+0002ff40: 2061 6c6c 2074 6f67 6574 6865 723a 0a20   all together:. 
+0002ff50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002ff80: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
+0002ff90: 5d5b 274d 275d 202b 3d20 7472 616e 7369  ]['M'] += transi
+0002ffa0: 745f 6d6f 6465 6c20 2a20 7369 6e65 5f6d  t_model * sine_m
+0002ffb0: 6f64 656c 202d 2031 2e0a 0a20 2020 2020  odel - 1...     
+0002ffc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ffd0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0002ffe0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030000: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+00030010: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
+00030020: 7472 756d 656e 745d 5b27 5472 616e 4563  trument]['TranEc
+00030030: 6c46 6974 275d 3a0a 0a20 2020 2020 2020  lFit']:..       
+00030040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030060: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
+00030070: 7275 6d65 6e74 5d5b 2770 272b 7374 7228  rument]['p'+str(
+00030080: 6929 5d20 3d20 7365 6c66 2e6d 6f64 656c  i)] = self.model
+00030090: 5b69 6e73 7472 756d 656e 745d 5b27 6d27  [instrument]['m'
+000300a0: 5d2e 6c69 6768 745f 6375 7276 6528 7365  ].light_curve(se
+000300b0: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
+000300c0: 656e 745d 5b27 7061 7261 6d73 275d 290a  ent]['params']).
 000300d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000300e0: 2020 2020 2020 2020 2020 2020 6563 6c69              ecli
-000300f0: 7073 655f 6d6f 6465 6c20 3d20 6563 6c69  pse_model = ecli
-00030100: 7073 655f 6d6f 6465 6c20 2d20 7365 6c66  pse_model - self
-00030110: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
-00030120: 745d 5b27 7061 7261 6d73 275d 2e66 700a  t]['params'].fp.
-00030130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000300e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000300f0: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+00030100: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
+00030110: 4d27 5d20 2b3d 2073 656c 662e 6d6f 6465  M'] += self.mode
+00030120: 6c5b 696e 7374 7275 6d65 6e74 5d5b 2770  l[instrument]['p
+00030130: 272b 7374 7228 6929 5d20 2d20 312e 0a0a  '+str(i)] - 1...
 00030140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030150: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00030160: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
-00030170: 745d 5b27 7027 2b73 7472 2869 295d 203d  t]['p'+str(i)] =
-00030180: 2074 7261 6e73 6974 5f6d 6f64 656c 202a   transit_model *
-00030190: 2065 636c 6970 7365 5f6d 6f64 656c 0a0a   eclipse_model..
-000301a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000301b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000301c0: 2020 2020 2020 2020 656c 7365 3a0a 0a20          else:.. 
-000301d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000301e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000301f0: 2020 2020 2020 2020 2020 206f 7262 6974             orbit
-00030200: 616c 5f70 6861 7365 203d 2028 2028 2028  al_phase = ( ( (
-00030210: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-00030220: 7275 6d65 6e74 5d5b 276d 275d 5b31 5d2e  rument]['m'][1].
-00030230: 7420 2d20 7365 6c66 2e6d 6f64 656c 5b69  t - self.model[i
-00030240: 6e73 7472 756d 656e 745d 5b27 7061 7261  nstrument]['para
-00030250: 6d73 275d 2e74 3020 2920 2f20 7365 6c66  ms'].t0 ) / self
-00030260: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
-00030270: 745d 5b27 7061 7261 6d73 275d 2e70 6572  t]['params'].per
-00030280: 2029 2025 2031 2029 0a20 2020 2020 2020   ) % 1 ).       
-00030290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000302a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000302b0: 2020 2020 2063 656e 7465 725f 7068 6173       center_phas
-000302c0: 6520 3d20 2d20 6e70 2e70 6920 2f20 322e  e = - np.pi / 2.
-000302d0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000302e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000302f0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00030300: 4275 696c 6420 6d6f 6465 6c2e 2046 6972  Build model. Fir
-00030310: 7374 2c20 7468 6520 6261 7369 7320 7369  st, the basis si
-00030320: 6e65 2066 756e 6374 696f 6e3a 0a20 2020  ne function:.   
+00030150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030160: 2020 2020 656c 7365 3a0a 0a20 2020 2020      else:..     
+00030170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030190: 2020 2023 2049 6e20 636f 6d62 696e 6564     # In combined
+000301a0: 2074 7261 6e73 6974 202b 2065 636c 6970   transit + eclip
+000301b0: 7365 206d 6f64 656c 732c 2061 7373 756d  se models, assum
+000301c0: 6520 6279 2064 6566 6175 6c74 2061 6e79  e by default any
+000301d0: 2070 6861 7365 2d63 7572 7665 2076 6172   phase-curve var
+000301e0: 6961 7469 6f6e 7320 6172 6520 6265 696e  iations are bein
+000301f0: 6720 6d6f 6465 6c6c 6564 2065 7874 6572  g modelled exter
+00030200: 6e61 6c6c 7920 0a20 2020 2020 2020 2020  nally .         
+00030210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030220: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00030230: 2062 7920 6465 6661 756c 7420 2862 792c   by default (by,
+00030240: 2065 2e67 2e2c 2073 7973 7465 6d61 7469   e.g., systemati
+00030250: 6373 206d 6f64 656c 732c 2070 6861 7365  cs models, phase
+00030260: 2d63 7572 7665 2076 6172 6961 7469 6f6e  -curve variation
+00030270: 7320 6164 6465 6420 6c61 7465 722c 2065  s added later, e
+00030280: 7463 2e29 2e20 546f 2074 6869 7320 656e  tc.). To this en
+00030290: 642c 206e 6f74 6520 6261 746d 616e 2068  d, note batman h
+000302a0: 6173 206f 7574 2d6f 662d 6563 6c69 7073  as out-of-eclips
+000302b0: 6520 0a20 2020 2020 2020 2020 2020 2020  e .             
+000302c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000302d0: 2020 2020 2020 2020 2020 2023 206d 6f64             # mod
+000302e0: 656c 2076 6172 6961 7469 6f6e 7320 3120  el variations 1 
+000302f0: 2b20 6670 202d 2d2d 2077 6974 6820 696e  + fp --- with in
+00030300: 2d65 636c 6970 7365 2061 6c77 6179 7320  -eclipse always 
+00030310: 6265 696e 6720 312e 2053 7562 7472 6163  being 1. Subtrac
+00030320: 7420 6670 2074 6865 6e3a 3a0a 2020 2020  t fp then::.    
 00030330: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00030340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030350: 2020 2020 2020 2020 2073 696e 655f 6d6f           sine_mo
-00030360: 6465 6c20 3d20 6e70 2e73 696e 2832 2e20  del = np.sin(2. 
-00030370: 2a20 6e70 2e70 6920 2a20 286f 7262 6974  * np.pi * (orbit
-00030380: 616c 5f70 6861 7365 2920 2b20 6365 6e74  al_phase) + cent
-00030390: 6572 5f70 6861 7365 202b 2070 6861 7365  er_phase + phase
-000303a0: 5f6f 6666 7365 7420 2a20 286e 702e 7069  _offset * (np.pi
-000303b0: 202f 2031 3830 2e29 2029 0a20 2020 2020   / 180.) ).     
+00030350: 2020 2020 7472 616e 7369 745f 6d6f 6465      transit_mode
+00030360: 6c20 3d20 7365 6c66 2e6d 6f64 656c 5b69  l = self.model[i
+00030370: 6e73 7472 756d 656e 745d 5b27 6d27 5d5b  nstrument]['m'][
+00030380: 305d 2e6c 6967 6874 5f63 7572 7665 2873  0].light_curve(s
+00030390: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
+000303a0: 6d65 6e74 5d5b 2770 6172 616d 7327 5d29  ment]['params'])
+000303b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000303c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000303d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000303e0: 2020 2020 2020 2023 2053 6361 6c65 2074         # Scale t
-000303f0: 6f20 6265 2031 2061 7420 7365 636f 6e64  o be 1 at second
-00030400: 6172 7920 6563 6c69 7073 652c 2030 2061  ary eclipse, 0 a
-00030410: 7420 7472 616e 7369 743a 0a20 2020 2020  t transit:.     
-00030420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030440: 2020 2020 2020 2073 696e 655f 6d6f 6465         sine_mode
-00030450: 6c20 3d20 2873 696e 655f 6d6f 6465 6c20  l = (sine_model 
-00030460: 2b20 3129 202a 2030 2e35 0a20 2020 2020  + 1) * 0.5.     
-00030470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030490: 2020 2020 2020 2023 2041 6d70 6c69 6679         # Amplify
-000304a0: 2062 7920 7068 6173 652d 616d 706c 6974   by phase-amplit
-000304b0: 7564 653a 0a20 2020 2020 2020 2020 2020  ude:.           
-000304c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000304d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000304e0: 2073 696e 655f 6d6f 6465 6c20 3d20 2873   sine_model = (s
-000304f0: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
-00030500: 6d65 6e74 5d5b 2770 6172 616d 7327 5d2e  ment]['params'].
-00030510: 6670 2920 2a20 7369 6e65 5f6d 6f64 656c  fp) * sine_model
-00030520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030540: 2020 2020 2020 2020 2020 2020 2023 204d               # M
-00030550: 756c 7469 706c 7920 6279 206e 6f72 6d65  ultiply by norme
-00030560: 6420 6563 6c69 7073 6520 6d6f 6465 6c3a  d eclipse model:
-00030570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000303d0: 2020 2020 2020 2020 2065 636c 6970 7365           eclipse
+000303e0: 5f6d 6f64 656c 203d 2073 656c 662e 6d6f  _model = self.mo
+000303f0: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
+00030400: 276d 275d 5b31 5d2e 6c69 6768 745f 6375  'm'][1].light_cu
+00030410: 7276 6528 7365 6c66 2e6d 6f64 656c 5b69  rve(self.model[i
+00030420: 6e73 7472 756d 656e 745d 5b27 7061 7261  nstrument]['para
+00030430: 6d73 275d 2920 0a0a 2020 2020 2020 2020  ms']) ..        
+00030440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030460: 2320 4e6f 772c 2066 6967 7572 6520 6f75  # Now, figure ou
+00030470: 7420 6966 2061 2070 6861 7365 2d63 7572  t if a phase-cur
+00030480: 7665 206d 6f64 656c 2069 7320 6265 696e  ve model is bein
+00030490: 6720 6669 7420 6f72 206e 6f74 3a0a 2020  g fit or not:.  
+000304a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000304b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000304c0: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+000304d0: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
+000304e0: 7472 756d 656e 745d 5b27 5068 6173 6543  trument]['PhaseC
+000304f0: 7572 7665 4669 7427 5d3a 0a0a 2020 2020  urveFit']:..    
+00030500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030520: 2020 2020 2020 2020 6563 6c69 7073 655f          eclipse_
+00030530: 6d6f 6465 6c20 3d20 6563 6c69 7073 655f  model = eclipse_
+00030540: 6d6f 6465 6c20 2d20 7365 6c66 2e6d 6f64  model - self.mod
+00030550: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
+00030560: 7061 7261 6d73 275d 2e66 700a 2020 2020  params'].fp.    
+00030570: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00030580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030590: 2020 2020 2020 2020 2020 2020 2073 696e               sin
-000305a0: 655f 6d6f 6465 6c20 3d20 312e 202b 2073  e_model = 1. + s
-000305b0: 696e 655f 6d6f 6465 6c20 2a20 2828 6563  ine_model * ((ec
-000305c0: 6c69 7073 655f 6d6f 6465 6c20 2d20 312e  lipse_model - 1.
-000305d0: 2920 2f20 7365 6c66 2e6d 6f64 656c 5b69  ) / self.model[i
-000305e0: 6e73 7472 756d 656e 745d 5b27 7061 7261  nstrument]['para
-000305f0: 6d73 275d 2e66 7029 0a0a 2020 2020 2020  ms'].fp)..      
-00030600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030590: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+000305a0: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
+000305b0: 7027 2b73 7472 2869 295d 203d 2074 7261  p'+str(i)] = tra
+000305c0: 6e73 6974 5f6d 6f64 656c 202a 2065 636c  nsit_model * ecl
+000305d0: 6970 7365 5f6d 6f64 656c 0a0a 2020 2020  ipse_model..    
+000305e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000305f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030600: 2020 2020 656c 7365 3a0a 0a20 2020 2020      else:..     
 00030610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030620: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-00030630: 5b69 6e73 7472 756d 656e 745d 5b27 7027  [instrument]['p'
-00030640: 2b73 7472 2869 295d 203d 2074 7261 6e73  +str(i)] = trans
-00030650: 6974 5f6d 6f64 656c 202a 2073 696e 655f  it_model * sine_
-00030660: 6d6f 6465 6c0a 0a20 2020 2020 2020 2020  model..         
-00030670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030680: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00030690: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
-000306a0: 6d65 6e74 5d5b 274d 275d 202b 3d20 7365  ment]['M'] += se
-000306b0: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
-000306c0: 656e 745d 5b27 7027 2b73 7472 2869 295d  ent]['p'+str(i)]
-000306d0: 202d 2031 2e0a 0a20 2020 2020 2020 2020   - 1...         
+00030620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030630: 2020 2020 2020 206f 7262 6974 616c 5f70         orbital_p
+00030640: 6861 7365 203d 2028 2028 2028 2073 656c  hase = ( ( ( sel
+00030650: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+00030660: 6e74 5d5b 276d 275d 5b31 5d2e 7420 2d20  nt]['m'][1].t - 
+00030670: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+00030680: 756d 656e 745d 5b27 7061 7261 6d73 275d  ument]['params']
+00030690: 2e74 3020 2920 2f20 7365 6c66 2e6d 6f64  .t0 ) / self.mod
+000306a0: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
+000306b0: 7061 7261 6d73 275d 2e70 6572 2029 2025  params'].per ) %
+000306c0: 2031 2029 0a20 2020 2020 2020 2020 2020   1 ).           
+000306d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000306e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000306f0: 2020 2065 6c73 653a 0a0a 2020 2020 2020     else:..      
-00030700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030710: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00030720: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-00030730: 5b69 6e73 7472 756d 656e 745d 5b27 5472  [instrument]['Tr
-00030740: 616e 7369 7446 6974 4361 7477 6f6d 616e  ansitFitCatwoman
-00030750: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
-00030760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030770: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00030780: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
-00030790: 756d 656e 745d 5b27 7265 7361 6d70 6c69  ument]['resampli
-000307a0: 6e67 275d 3a0a 2020 2020 2020 2020 2020  ng']:.          
-000307b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000307c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000307d0: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-000307e0: 5b69 6e73 7472 756d 656e 745d 5b27 5472  [instrument]['Tr
-000307f0: 616e 7369 7446 6974 275d 3a0a 2020 2020  ansitFit']:.    
+000306f0: 2063 656e 7465 725f 7068 6173 6520 3d20   center_phase = 
+00030700: 2d20 6e70 2e70 6920 2f20 322e 0a0a 2020  - np.pi / 2...  
+00030710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030730: 2020 2020 2020 2020 2020 2320 4275 696c            # Buil
+00030740: 6420 6d6f 6465 6c2e 2046 6972 7374 2c20  d model. First, 
+00030750: 7468 6520 6261 7369 7320 7369 6e65 2066  the basis sine f
+00030760: 756e 6374 696f 6e3a 0a20 2020 2020 2020  unction:.       
+00030770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030790: 2020 2020 2073 696e 655f 6d6f 6465 6c20       sine_model 
+000307a0: 3d20 6e70 2e73 696e 2832 2e20 2a20 6e70  = np.sin(2. * np
+000307b0: 2e70 6920 2a20 286f 7262 6974 616c 5f70  .pi * (orbital_p
+000307c0: 6861 7365 2920 2b20 6365 6e74 6572 5f70  hase) + center_p
+000307d0: 6861 7365 202b 2070 6861 7365 5f6f 6666  hase + phase_off
+000307e0: 7365 7420 2a20 286e 702e 7069 202f 2031  set * (np.pi / 1
+000307f0: 3830 2e29 2029 0a20 2020 2020 2020 2020  80.) ).         
 00030800: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00030810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030820: 2020 2020 2020 2020 706d 2c20 5b6d 2c5f          pm, [m,_
-00030830: 5d20 3d20 696e 6974 5f62 6174 6d61 6e28  ] = init_batman(
-00030840: 6475 6d6d 795f 7469 6d65 2c20 7365 6c66  dummy_time, self
-00030850: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
-00030860: 7275 6d65 6e74 5d5b 276c 646c 6177 275d  rument]['ldlaw']
-00030870: 2c20 5c0a 2020 2020 2020 2020 2020 2020  , \.            
-00030880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000308a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000308b0: 2020 2020 2020 2020 6e72 6573 616d 706c          nresampl
-000308c0: 696e 6720 3d20 7365 6c66 2e64 6963 7469  ing = self.dicti
-000308d0: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
-000308e0: 5d5b 276e 7265 7361 6d70 6c69 6e67 275d  ]['nresampling']
-000308f0: 2c20 5c0a 2020 2020 2020 2020 2020 2020  , \.            
+00030820: 2020 2023 2053 6361 6c65 2074 6f20 6265     # Scale to be
+00030830: 2031 2061 7420 7365 636f 6e64 6172 7920   1 at secondary 
+00030840: 6563 6c69 7073 652c 2030 2061 7420 7472  eclipse, 0 at tr
+00030850: 616e 7369 743a 0a20 2020 2020 2020 2020  ansit:.         
+00030860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030880: 2020 2073 696e 655f 6d6f 6465 6c20 3d20     sine_model = 
+00030890: 2873 696e 655f 6d6f 6465 6c20 2b20 3129  (sine_model + 1)
+000308a0: 202a 2030 2e35 0a20 2020 2020 2020 2020   * 0.5.         
+000308b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000308c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000308d0: 2020 2023 2041 6d70 6c69 6679 2062 7920     # Amplify by 
+000308e0: 7068 6173 652d 616d 706c 6974 7564 653a  phase-amplitude:
+000308f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00030900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030930: 2020 2020 2020 2020 6574 7265 7361 6d70          etresamp
-00030940: 6c69 6e67 203d 2073 656c 662e 6469 6374  ling = self.dict
-00030950: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
-00030960: 745d 5b27 6578 7074 696d 6572 6573 616d  t]['exptimeresam
-00030970: 706c 696e 6727 5d29 0a20 2020 2020 2020  pling']).       
-00030980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000309a0: 2065 6c69 6620 7365 6c66 2e64 6963 7469   elif self.dicti
-000309b0: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
-000309c0: 5d5b 2745 636c 6970 7365 4669 7427 5d3a  ]['EclipseFit']:
-000309d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000309e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000309f0: 2020 2020 2020 2020 2020 2020 2070 6d2c               pm,
-00030a00: 205b 5f2c 6d5d 203d 2069 6e69 745f 6261   [_,m] = init_ba
-00030a10: 746d 616e 2864 756d 6d79 5f74 696d 652c  tman(dummy_time,
-00030a20: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-00030a30: 5b69 6e73 7472 756d 656e 745d 5b27 6c64  [instrument]['ld
-00030a40: 6c61 7727 5d2c 5c0a 2020 2020 2020 2020  law'],\.        
+00030910: 2020 2020 2020 2020 2020 2020 2073 696e               sin
+00030920: 655f 6d6f 6465 6c20 3d20 2873 656c 662e  e_model = (self.
+00030930: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
+00030940: 5d5b 2770 6172 616d 7327 5d2e 6670 2920  ]['params'].fp) 
+00030950: 2a20 7369 6e65 5f6d 6f64 656c 0a20 2020  * sine_model.   
+00030960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030980: 2020 2020 2020 2020 2023 204d 756c 7469           # Multi
+00030990: 706c 7920 6279 206e 6f72 6d65 6420 6563  ply by normed ec
+000309a0: 6c69 7073 6520 6d6f 6465 6c3a 0a20 2020  lipse model:.   
+000309b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000309c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000309d0: 2020 2020 2020 2020 2073 696e 655f 6d6f           sine_mo
+000309e0: 6465 6c20 3d20 312e 202b 2073 696e 655f  del = 1. + sine_
+000309f0: 6d6f 6465 6c20 2a20 2828 6563 6c69 7073  model * ((eclips
+00030a00: 655f 6d6f 6465 6c20 2d20 312e 2920 2f20  e_model - 1.) / 
+00030a10: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+00030a20: 756d 656e 745d 5b27 7061 7261 6d73 275d  ument]['params']
+00030a30: 2e66 7029 0a0a 2020 2020 2020 2020 2020  .fp)..          
+00030a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00030a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030a80: 2020 2020 2020 2020 2020 2020 6e72 6573              nres
-00030a90: 616d 706c 696e 6720 3d20 7365 6c66 2e64  ampling = self.d
-00030aa0: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
-00030ab0: 6d65 6e74 5d5b 276e 7265 7361 6d70 6c69  ment]['nresampli
-00030ac0: 6e67 275d 2c20 5c0a 2020 2020 2020 2020  ng'], \.        
-00030ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030b00: 2020 2020 2020 2020 2020 2020 6574 7265              etre
-00030b10: 7361 6d70 6c69 6e67 203d 2073 656c 662e  sampling = self.
-00030b20: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
-00030b30: 756d 656e 745d 5b27 6578 7074 696d 6572  ument]['exptimer
-00030b40: 6573 616d 706c 696e 6727 5d29 0a20 2020  esampling']).   
-00030b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030b70: 2020 2020 2065 6c69 6620 7365 6c66 2e64       elif self.d
-00030b80: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
-00030b90: 6d65 6e74 5d5b 2754 7261 6e45 636c 4669  ment]['TranEclFi
-00030ba0: 7427 5d3a 0a20 2020 2020 2020 2020 2020  t']:.           
-00030bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030bd0: 2070 6d2c 206d 203d 2069 6e69 745f 6261   pm, m = init_ba
-00030be0: 746d 616e 2864 756d 6d79 5f74 696d 652c  tman(dummy_time,
-00030bf0: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-00030c00: 5b69 6e73 7472 756d 656e 745d 5b27 6c64  [instrument]['ld
-00030c10: 6c61 7727 5d2c 5c0a 2020 2020 2020 2020  law'],\.        
-00030c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030a60: 2020 7365 6c66 2e6d 6f64 656c 5b69 6e73    self.model[ins
+00030a70: 7472 756d 656e 745d 5b27 7027 2b73 7472  trument]['p'+str
+00030a80: 2869 295d 203d 2074 7261 6e73 6974 5f6d  (i)] = transit_m
+00030a90: 6f64 656c 202a 2073 696e 655f 6d6f 6465  odel * sine_mode
+00030aa0: 6c0a 0a20 2020 2020 2020 2020 2020 2020  l..             
+00030ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030ac0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00030ad0: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
+00030ae0: 5d5b 274d 275d 202b 3d20 7365 6c66 2e6d  ]['M'] += self.m
+00030af0: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
+00030b00: 5b27 7027 2b73 7472 2869 295d 202d 2031  ['p'+str(i)] - 1
+00030b10: 2e0a 0a20 2020 2020 2020 2020 2020 2020  ...             
+00030b20: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00030b30: 6c73 653a 0a0a 2020 2020 2020 2020 2020  lse:..          
+00030b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030b50: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+00030b60: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
+00030b70: 7472 756d 656e 745d 5b27 5472 616e 7369  trument]['Transi
+00030b80: 7446 6974 4361 7477 6f6d 616e 275d 3a0a  tFitCatwoman']:.
+00030b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030bb0: 2020 2020 6966 2073 656c 662e 6469 6374      if self.dict
+00030bc0: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
+00030bd0: 745d 5b27 7265 7361 6d70 6c69 6e67 275d  t]['resampling']
+00030be0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00030bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030c00: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00030c10: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
+00030c20: 7472 756d 656e 745d 5b27 5472 616e 7369  trument]['Transi
+00030c30: 7446 6974 275d 3a0a 2020 2020 2020 2020  tFit']:.        
 00030c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030c50: 2020 2020 2020 2020 2020 2020 6e72 6573              nres
-00030c60: 616d 706c 696e 6720 3d20 7365 6c66 2e64  ampling = self.d
-00030c70: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
-00030c80: 6d65 6e74 5d5b 276e 7265 7361 6d70 6c69  ment]['nresampli
-00030c90: 6e67 275d 2c20 5c0a 2020 2020 2020 2020  ng'], \.        
-00030ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030c60: 2020 2020 706d 2c20 5b6d 2c5f 5d20 3d20      pm, [m,_] = 
+00030c70: 696e 6974 5f62 6174 6d61 6e28 6475 6d6d  init_batman(dumm
+00030c80: 795f 7469 6d65 2c20 7365 6c66 2e64 6963  y_time, self.dic
+00030c90: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
+00030ca0: 6e74 5d5b 276c 646c 6177 275d 2c20 5c0a  nt]['ldlaw'], \.
 00030cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00030cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030cd0: 2020 2020 2020 2020 2020 2020 6574 7265              etre
-00030ce0: 7361 6d70 6c69 6e67 203d 2073 656c 662e  sampling = self.
-00030cf0: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
-00030d00: 756d 656e 745d 5b27 6578 7074 696d 6572  ument]['exptimer
-00030d10: 6573 616d 706c 696e 6727 5d29 0a20 2020  esampling']).   
-00030d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030cf0: 2020 2020 6e72 6573 616d 706c 696e 6720      nresampling 
+00030d00: 3d20 7365 6c66 2e64 6963 7469 6f6e 6172  = self.dictionar
+00030d10: 795b 696e 7374 7275 6d65 6e74 5d5b 276e  y[instrument]['n
+00030d20: 7265 7361 6d70 6c69 6e67 275d 2c20 5c0a  resampling'], \.
 00030d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030d40: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00030d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00030d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030d60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00030d70: 6620 7365 6c66 2e64 6963 7469 6f6e 6172  f self.dictionar
-00030d80: 795b 696e 7374 7275 6d65 6e74 5d5b 2754  y[instrument]['T
-00030d90: 7261 6e73 6974 4669 7427 5d3a 0a20 2020  ransitFit']:.   
-00030da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030dc0: 2020 2020 2020 2020 2070 6d2c 205b 6d2c           pm, [m,
-00030dd0: 5f5d 203d 2069 6e69 745f 6261 746d 616e  _] = init_batman
-00030de0: 2864 756d 6d79 5f74 696d 652c 2073 656c  (dummy_time, sel
-00030df0: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
-00030e00: 7472 756d 656e 745d 5b27 6c64 6c61 7727  trument]['ldlaw'
-00030e10: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+00030d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030d70: 2020 2020 6574 7265 7361 6d70 6c69 6e67      etresampling
+00030d80: 203d 2073 656c 662e 6469 6374 696f 6e61   = self.dictiona
+00030d90: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
+00030da0: 6578 7074 696d 6572 6573 616d 706c 696e  exptimeresamplin
+00030db0: 6727 5d29 0a20 2020 2020 2020 2020 2020  g']).           
+00030dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030dd0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00030de0: 6620 7365 6c66 2e64 6963 7469 6f6e 6172  f self.dictionar
+00030df0: 795b 696e 7374 7275 6d65 6e74 5d5b 2745  y[instrument]['E
+00030e00: 636c 6970 7365 4669 7427 5d3a 0a20 2020  clipseFit']:.   
+00030e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00030e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030e30: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00030e40: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
-00030e50: 696e 7374 7275 6d65 6e74 5d5b 2745 636c  instrument]['Ecl
-00030e60: 6970 7365 4669 7427 5d3a 0a20 2020 2020  ipseFit']:.     
-00030e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030e90: 2020 2020 2020 2070 6d2c 205b 5f2c 6d5d         pm, [_,m]
-00030ea0: 203d 2069 6e69 745f 6261 746d 616e 2864   = init_batman(d
-00030eb0: 756d 6d79 5f74 696d 652c 2073 656c 662e  ummy_time, self.
-00030ec0: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
-00030ed0: 756d 656e 745d 5b27 6c64 6c61 7727 5d29  ument]['ldlaw'])
-00030ee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030f00: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
-00030f10: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
-00030f20: 7374 7275 6d65 6e74 5d5b 2754 7261 6e45  strument]['TranE
-00030f30: 636c 4669 7427 5d3a 0a20 2020 2020 2020  clFit']:.       
-00030f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030f60: 2020 2020 2070 6d2c 206d 203d 2069 6e69       pm, m = ini
-00030f70: 745f 6261 746d 616e 2864 756d 6d79 5f74  t_batman(dummy_t
-00030f80: 696d 652c 2073 656c 662e 6469 6374 696f  ime, self.dictio
-00030f90: 6e61 7279 5b69 6e73 7472 756d 656e 745d  nary[instrument]
-00030fa0: 5b27 6c64 6c61 7727 5d29 0a0a 2020 2020  ['ldlaw'])..    
-00030fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030fc0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00030fd0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00030fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030ff0: 2020 2020 2020 6966 2073 656c 662e 6469        if self.di
-00031000: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
-00031010: 656e 745d 5b0a 2020 2020 2020 2020 2020  ent][.          
-00031020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031040: 2020 2772 6573 616d 706c 696e 6727 5d3a    'resampling']:
-00031050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030e30: 2020 2020 2020 2020 2070 6d2c 205b 5f2c           pm, [_,
+00030e40: 6d5d 203d 2069 6e69 745f 6261 746d 616e  m] = init_batman
+00030e50: 2864 756d 6d79 5f74 696d 652c 2073 656c  (dummy_time, sel
+00030e60: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
+00030e70: 7472 756d 656e 745d 5b27 6c64 6c61 7727  trument]['ldlaw'
+00030e80: 5d2c 5c0a 2020 2020 2020 2020 2020 2020  ],\.            
+00030e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030ec0: 2020 2020 2020 2020 6e72 6573 616d 706c          nresampl
+00030ed0: 696e 6720 3d20 7365 6c66 2e64 6963 7469  ing = self.dicti
+00030ee0: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
+00030ef0: 5d5b 276e 7265 7361 6d70 6c69 6e67 275d  ]['nresampling']
+00030f00: 2c20 5c0a 2020 2020 2020 2020 2020 2020  , \.            
+00030f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030f40: 2020 2020 2020 2020 6574 7265 7361 6d70          etresamp
+00030f50: 6c69 6e67 203d 2073 656c 662e 6469 6374  ling = self.dict
+00030f60: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
+00030f70: 745d 5b27 6578 7074 696d 6572 6573 616d  t]['exptimeresam
+00030f80: 706c 696e 6727 5d29 0a20 2020 2020 2020  pling']).       
+00030f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030fb0: 2065 6c69 6620 7365 6c66 2e64 6963 7469   elif self.dicti
+00030fc0: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
+00030fd0: 5d5b 2754 7261 6e45 636c 4669 7427 5d3a  ]['TranEclFit']:
+00030fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031000: 2020 2020 2020 2020 2020 2020 2070 6d2c               pm,
+00031010: 206d 203d 2069 6e69 745f 6261 746d 616e   m = init_batman
+00031020: 2864 756d 6d79 5f74 696d 652c 2073 656c  (dummy_time, sel
+00031030: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
+00031040: 7472 756d 656e 745d 5b27 6c64 6c61 7727  trument]['ldlaw'
+00031050: 5d2c 5c0a 2020 2020 2020 2020 2020 2020  ],\.            
 00031060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031070: 2020 2020 2020 2020 2070 6d2c 206d 203d           pm, m =
-00031080: 2069 6e69 745f 6361 7477 6f6d 616e 2864   init_catwoman(d
-00031090: 756d 6d79 5f74 696d 652c 2073 656c 662e  ummy_time, self.
-000310a0: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
-000310b0: 756d 656e 745d 5b27 6c64 6c61 7727 5d2c  ument]['ldlaw'],
-000310c0: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
-000310d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031090: 2020 2020 2020 2020 6e72 6573 616d 706c          nresampl
+000310a0: 696e 6720 3d20 7365 6c66 2e64 6963 7469  ing = self.dicti
+000310b0: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
+000310c0: 5d5b 276e 7265 7361 6d70 6c69 6e67 275d  ]['nresampling']
+000310d0: 2c20 5c0a 2020 2020 2020 2020 2020 2020  , \.            
 000310e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000310f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031100: 2020 2020 6e72 6573 616d 706c 696e 6720      nresampling 
-00031110: 3d20 7365 6c66 2e64 6963 7469 6f6e 6172  = self.dictionar
-00031120: 795b 696e 7374 7275 6d65 6e74 5d5b 276e  y[instrument]['n
-00031130: 7265 7361 6d70 6c69 6e67 275d 2c20 5c0a  resampling'], \.
-00031140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031110: 2020 2020 2020 2020 6574 7265 7361 6d70          etresamp
+00031120: 6c69 6e67 203d 2073 656c 662e 6469 6374  ling = self.dict
+00031130: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
+00031140: 745d 5b27 6578 7074 696d 6572 6573 616d  t]['exptimeresam
+00031150: 706c 696e 6727 5d29 0a20 2020 2020 2020  pling']).       
 00031160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031180: 2065 7472 6573 616d 706c 696e 6720 3d20   etresampling = 
-00031190: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
-000311a0: 696e 7374 7275 6d65 6e74 5d5b 2765 7870  instrument]['exp
-000311b0: 7469 6d65 7265 7361 6d70 6c69 6e67 275d  timeresampling']
-000311c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000311d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000311e0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00031170: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00031180: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00031190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000311a0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+000311b0: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
+000311c0: 7374 7275 6d65 6e74 5d5b 2754 7261 6e73  strument]['Trans
+000311d0: 6974 4669 7427 5d3a 0a20 2020 2020 2020  itFit']:.       
+000311e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000311f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031210: 2020 2020 706d 2c20 6d20 3d20 696e 6974      pm, m = init
-00031220: 5f63 6174 776f 6d61 6e28 0a20 2020 2020  _catwoman(.     
-00031230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031250: 2020 2020 2020 2064 756d 6d79 5f74 696d         dummy_tim
-00031260: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00031270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031280: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00031290: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
-000312a0: 6e73 7472 756d 656e 745d 0a20 2020 2020  nstrument].     
+00031200: 2020 2020 2070 6d2c 205b 6d2c 5f5d 203d       pm, [m,_] =
+00031210: 2069 6e69 745f 6261 746d 616e 2864 756d   init_batman(dum
+00031220: 6d79 5f74 696d 652c 2073 656c 662e 6469  my_time, self.di
+00031230: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
+00031240: 656e 745d 5b27 6c64 6c61 7727 5d29 0a20  ent]['ldlaw']). 
+00031250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031270: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00031280: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
+00031290: 7275 6d65 6e74 5d5b 2745 636c 6970 7365  rument]['Eclipse
+000312a0: 4669 7427 5d3a 0a20 2020 2020 2020 2020  Fit']:.         
 000312b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000312c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000312d0: 2020 2020 2020 205b 276c 646c 6177 275d         ['ldlaw']
-000312e0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-000312f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031300: 2020 2023 2049 6620 6c6f 675f 6c69 6b65     # If log_like
-00031310: 5f63 616c 6320 6973 2054 7275 6520 2862  _calc is True (b
-00031320: 7920 6465 6661 756c 7420 6475 7269 6e67  y default during
-00031330: 206a 756c 6965 742e 6669 7429 2c20 646f   juliet.fit), do
-00031340: 6e27 7420 626f 7468 6572 2073 6176 696e  n't bother savin
-00031350: 6720 7468 6520 6c69 6768 7463 7572 7665  g the lightcurve
-00031360: 206f 6620 706c 616e 6574 2070 5f69 3a0a   of planet p_i:.
-00031370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000312d0: 2020 2070 6d2c 205b 5f2c 6d5d 203d 2069     pm, [_,m] = i
+000312e0: 6e69 745f 6261 746d 616e 2864 756d 6d79  nit_batman(dummy
+000312f0: 5f74 696d 652c 2073 656c 662e 6469 6374  _time, self.dict
+00031300: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
+00031310: 745d 5b27 6c64 6c61 7727 5d29 0a20 2020  t]['ldlaw']).   
+00031320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031340: 2020 2020 2065 6c69 6620 7365 6c66 2e64       elif self.d
+00031350: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
+00031360: 6d65 6e74 5d5b 2754 7261 6e45 636c 4669  ment]['TranEclFi
+00031370: 7427 5d3a 0a20 2020 2020 2020 2020 2020  t']:.           
 00031380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031390: 6966 2073 656c 662e 6c6f 675f 6c69 6b65  if self.log_like
-000313a0: 5f63 616c 633a 0a20 2020 2020 2020 2020  _calc:.         
-000313b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000313c0: 2020 2020 2020 2020 200a 2020 2020 2020           .      
-000313d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000313e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000313f0: 206e 6f74 2073 656c 662e 6469 6374 696f   not self.dictio
-00031400: 6e61 7279 5b69 6e73 7472 756d 656e 745d  nary[instrument]
-00031410: 5b27 5472 616e 4563 6c46 6974 275d 3a0a  ['TranEclFit']:.
-00031420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00031430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031440: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-00031450: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
-00031460: 274d 275d 202b 3d20 6d2e 6c69 6768 745f  'M'] += m.light_
-00031470: 6375 7276 6528 7365 6c66 2e6d 6f64 656c  curve(self.model
-00031480: 5b69 6e73 7472 756d 656e 745d 5b27 7061  [instrument]['pa
-00031490: 7261 6d73 275d 2920 2d20 312e 200a 0a20  rams']) - 1. .. 
+00031390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000313a0: 2070 6d2c 206d 203d 2069 6e69 745f 6261   pm, m = init_ba
+000313b0: 746d 616e 2864 756d 6d79 5f74 696d 652c  tman(dummy_time,
+000313c0: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
+000313d0: 5b69 6e73 7472 756d 656e 745d 5b27 6c64  [instrument]['ld
+000313e0: 6c61 7727 5d29 0a0a 2020 2020 2020 2020  law'])..        
+000313f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031400: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00031410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031430: 2020 6966 2073 656c 662e 6469 6374 696f    if self.dictio
+00031440: 6e61 7279 5b69 6e73 7472 756d 656e 745d  nary[instrument]
+00031450: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00031460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031470: 2020 2020 2020 2020 2020 2020 2020 2772                'r
+00031480: 6573 616d 706c 696e 6727 5d3a 0a20 2020  esampling']:.   
+00031490: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000314a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000314b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000314c0: 2020 2065 6c73 653a 0a0a 2020 2020 2020     else:..      
-000314d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000314e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000314f0: 2020 2320 496e 2063 6f6d 6269 6e65 6420    # In combined 
-00031500: 7472 616e 7369 7420 2b20 6563 6c69 7073  transit + eclips
-00031510: 6520 6d6f 6465 6c73 2c20 6173 7375 6d65  e models, assume
-00031520: 2062 7920 6465 6661 756c 7420 616e 7920   by default any 
-00031530: 7068 6173 652d 6375 7276 6520 7661 7269  phase-curve vari
-00031540: 6174 696f 6e73 2061 7265 2062 6569 6e67  ations are being
-00031550: 206d 6f64 656c 6c65 6420 6578 7465 726e   modelled extern
-00031560: 616c 6c79 200a 2020 2020 2020 2020 2020  ally .          
-00031570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031580: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00031590: 6279 2064 6566 6175 6c74 2028 6279 2c20  by default (by, 
-000315a0: 652e 672e 2c20 7379 7374 656d 6174 6963  e.g., systematic
-000315b0: 7320 6d6f 6465 6c73 2c20 7068 6173 652d  s models, phase-
-000315c0: 6375 7276 6520 7661 7269 6174 696f 6e73  curve variations
-000315d0: 2061 6464 6564 206c 6174 6572 2c20 6574   added later, et
-000315e0: 632e 292e 2054 6f20 7468 6973 2065 6e64  c.). To this end
-000315f0: 2c20 6e6f 7465 2062 6174 6d61 6e20 6861  , note batman ha
-00031600: 7320 6f75 742d 6f66 2d65 636c 6970 7365  s out-of-eclipse
-00031610: 200a 2020 2020 2020 2020 2020 2020 2020   .              
-00031620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031630: 2020 2020 2020 2020 2020 2320 6d6f 6465            # mode
-00031640: 6c20 7661 7269 6174 696f 6e73 2031 202b  l variations 1 +
-00031650: 2066 7020 2d2d 2d20 7769 7468 2069 6e2d   fp --- with in-
-00031660: 6563 6c69 7073 6520 616c 7761 7973 2062  eclipse always b
-00031670: 6569 6e67 2031 2e20 5375 6274 7261 6374  eing 1. Subtract
-00031680: 2066 7020 7468 656e 3a3a 0a20 2020 2020   fp then::.     
-00031690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000314b0: 2020 2020 2070 6d2c 206d 203d 2069 6e69       pm, m = ini
+000314c0: 745f 6361 7477 6f6d 616e 2864 756d 6d79  t_catwoman(dummy
+000314d0: 5f74 696d 652c 2073 656c 662e 6469 6374  _time, self.dict
+000314e0: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
+000314f0: 745d 5b27 6c64 6c61 7727 5d2c 205c 0a20  t]['ldlaw'], \. 
+00031500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031540: 6e72 6573 616d 706c 696e 6720 3d20 7365  nresampling = se
+00031550: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
+00031560: 7374 7275 6d65 6e74 5d5b 276e 7265 7361  strument]['nresa
+00031570: 6d70 6c69 6e67 275d 2c20 5c0a 2020 2020  mpling'], \.    
+00031580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000315a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000315b0: 2020 2020 2020 2020 2020 2020 2065 7472               etr
+000315c0: 6573 616d 706c 696e 6720 3d20 7365 6c66  esampling = self
+000315d0: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
+000315e0: 7275 6d65 6e74 5d5b 2765 7870 7469 6d65  rument]['exptime
+000315f0: 7265 7361 6d70 6c69 6e67 275d 290a 2020  resampling']).  
+00031600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031620: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00031630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031650: 706d 2c20 6d20 3d20 696e 6974 5f63 6174  pm, m = init_cat
+00031660: 776f 6d61 6e28 0a20 2020 2020 2020 2020  woman(.         
+00031670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031690: 2020 2064 756d 6d79 5f74 696d 652c 0a20     dummy_time,. 
 000316a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000316b0: 2020 2074 7261 6e73 6974 5f6d 6f64 656c     transit_model
-000316c0: 203d 206d 5b30 5d2e 6c69 6768 745f 6375   = m[0].light_cu
-000316d0: 7276 6528 7365 6c66 2e6d 6f64 656c 5b69  rve(self.model[i
-000316e0: 6e73 7472 756d 656e 745d 5b27 7061 7261  nstrument]['para
-000316f0: 6d73 275d 290a 2020 2020 2020 2020 2020  ms']).          
+000316b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000316c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000316d0: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
+000316e0: 756d 656e 745d 0a20 2020 2020 2020 2020  ument].         
+000316f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00031700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031710: 2020 2020 2020 2020 2020 2020 2020 6563                ec
-00031720: 6c69 7073 655f 6d6f 6465 6c20 3d20 6d5b  lipse_model = m[
-00031730: 315d 2e6c 6967 6874 5f63 7572 7665 2873  1].light_curve(s
-00031740: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
-00031750: 6d65 6e74 5d5b 2770 6172 616d 7327 5d29  ment]['params'])
-00031760: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00031770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031780: 2020 2020 2020 2020 2020 2320 4e6f 772c            # Now,
-00031790: 2066 6967 7572 6520 6f75 7420 6966 2061   figure out if a
-000317a0: 2070 6861 7365 2d63 7572 7665 206d 6f64   phase-curve mod
-000317b0: 656c 2069 7320 6265 696e 6720 6669 7420  el is being fit 
-000317c0: 6f72 206e 6f74 3a0a 2020 2020 2020 2020  or not:.        
-000317d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000317e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000317f0: 6966 206e 6f74 2073 656c 662e 6469 6374  if not self.dict
-00031800: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
-00031810: 745d 5b27 5068 6173 6543 7572 7665 4669  t]['PhaseCurveFi
-00031820: 7427 5d3a 0a0a 2020 2020 2020 2020 2020  t']:..          
-00031830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031850: 2020 6563 6c69 7073 655f 6d6f 6465 6c20    eclipse_model 
-00031860: 3d20 6563 6c69 7073 655f 6d6f 6465 6c20  = eclipse_model 
-00031870: 2d20 7365 6c66 2e6d 6f64 656c 5b69 6e73  - self.model[ins
-00031880: 7472 756d 656e 745d 5b27 7061 7261 6d73  trument]['params
-00031890: 275d 2e66 700a 2020 2020 2020 2020 2020  '].fp.          
-000318a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000318b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000318c0: 2020 7365 6c66 2e6d 6f64 656c 5b69 6e73    self.model[ins
-000318d0: 7472 756d 656e 745d 5b27 4d27 5d20 2b3d  trument]['M'] +=
-000318e0: 2074 7261 6e73 6974 5f6d 6f64 656c 202a   transit_model *
-000318f0: 2065 636c 6970 7365 5f6d 6f64 656c 202d   eclipse_model -
-00031900: 2031 2e0a 0a20 2020 2020 2020 2020 2020   1...           
+00031710: 2020 205b 276c 646c 6177 275d 290a 0a20     ['ldlaw']).. 
+00031720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031730: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00031740: 2049 6620 6c6f 675f 6c69 6b65 5f63 616c   If log_like_cal
+00031750: 6320 6973 2054 7275 6520 2862 7920 6465  c is True (by de
+00031760: 6661 756c 7420 6475 7269 6e67 206a 756c  fault during jul
+00031770: 6965 742e 6669 7429 2c20 646f 6e27 7420  iet.fit), don't 
+00031780: 626f 7468 6572 2073 6176 696e 6720 7468  bother saving th
+00031790: 6520 6c69 6768 7463 7572 7665 206f 6620  e lightcurve of 
+000317a0: 706c 616e 6574 2070 5f69 3a0a 2020 2020  planet p_i:.    
+000317b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000317c0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000317d0: 656c 662e 6c6f 675f 6c69 6b65 5f63 616c  elf.log_like_cal
+000317e0: 633a 0a20 2020 2020 2020 2020 2020 2020  c:.             
+000317f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031800: 2020 2020 200a 2020 2020 2020 2020 2020       .          
+00031810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031820: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00031830: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
+00031840: 5b69 6e73 7472 756d 656e 745d 5b27 5472  [instrument]['Tr
+00031850: 616e 4563 6c46 6974 275d 3a0a 0a20 2020  anEclFit']:..   
+00031860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031880: 2020 2020 2073 656c 662e 6d6f 6465 6c5b       self.model[
+00031890: 696e 7374 7275 6d65 6e74 5d5b 274d 275d  instrument]['M']
+000318a0: 202b 3d20 6d2e 6c69 6768 745f 6375 7276   += m.light_curv
+000318b0: 6528 7365 6c66 2e6d 6f64 656c 5b69 6e73  e(self.model[ins
+000318c0: 7472 756d 656e 745d 5b27 7061 7261 6d73  trument]['params
+000318d0: 275d 2920 2d20 312e 200a 0a20 2020 2020  ']) - 1. ..     
+000318e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000318f0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00031900: 6c73 653a 0a0a 2020 2020 2020 2020 2020  lse:..          
 00031910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031920: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00031930: 653a 0a0a 2020 2020 2020 2020 2020 2020  e:..            
-00031940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031960: 6f72 6269 7461 6c5f 7068 6173 6520 3d20  orbital_phase = 
-00031970: 2820 2820 2820 7365 6c66 2e6d 6f64 656c  ( ( ( self.model
-00031980: 5b69 6e73 7472 756d 656e 745d 5b27 6d27  [instrument]['m'
-00031990: 5d5b 315d 2e74 202d 2073 656c 662e 6d6f  ][1].t - self.mo
-000319a0: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
-000319b0: 2770 6172 616d 7327 5d2e 7430 2029 202f  'params'].t0 ) /
-000319c0: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-000319d0: 7275 6d65 6e74 5d5b 2770 6172 616d 7327  rument]['params'
-000319e0: 5d2e 7065 7220 2920 2520 3120 290a 2020  ].per ) % 1 ).  
-000319f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031a10: 2020 2020 2020 2020 2020 6365 6e74 6572            center
-00031a20: 5f70 6861 7365 203d 202d 206e 702e 7069  _phase = - np.pi
-00031a30: 202f 2032 2e0a 0a20 2020 2020 2020 2020   / 2...         
-00031a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031920: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00031930: 496e 2063 6f6d 6269 6e65 6420 7472 616e  In combined tran
+00031940: 7369 7420 2b20 6563 6c69 7073 6520 6d6f  sit + eclipse mo
+00031950: 6465 6c73 2c20 6173 7375 6d65 2062 7920  dels, assume by 
+00031960: 6465 6661 756c 7420 616e 7920 7068 6173  default any phas
+00031970: 652d 6375 7276 6520 7661 7269 6174 696f  e-curve variatio
+00031980: 6e73 2061 7265 2062 6569 6e67 206d 6f64  ns are being mod
+00031990: 656c 6c65 6420 6578 7465 726e 616c 6c79  elled externally
+000319a0: 200a 2020 2020 2020 2020 2020 2020 2020   .              
+000319b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000319c0: 2020 2020 2020 2020 2020 2320 6279 2064            # by d
+000319d0: 6566 6175 6c74 2028 6279 2c20 652e 672e  efault (by, e.g.
+000319e0: 2c20 7379 7374 656d 6174 6963 7320 6d6f  , systematics mo
+000319f0: 6465 6c73 2c20 7068 6173 652d 6375 7276  dels, phase-curv
+00031a00: 6520 7661 7269 6174 696f 6e73 2061 6464  e variations add
+00031a10: 6564 206c 6174 6572 2c20 6574 632e 292e  ed later, etc.).
+00031a20: 2054 6f20 7468 6973 2065 6e64 2c20 6e6f   To this end, no
+00031a30: 7465 2062 6174 6d61 6e20 6861 7320 6f75  te batman has ou
+00031a40: 742d 6f66 2d65 636c 6970 7365 200a 2020  t-of-eclipse .  
 00031a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031a60: 2020 2023 2042 7569 6c64 206d 6f64 656c     # Build model
-00031a70: 2e20 4669 7273 742c 2074 6865 2062 6173  . First, the bas
-00031a80: 6973 2073 696e 6520 6675 6e63 7469 6f6e  is sine function
-00031a90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00031aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031ab0: 2020 2020 2020 2020 2020 2020 2020 7369                si
-00031ac0: 6e65 5f6d 6f64 656c 203d 206e 702e 7369  ne_model = np.si
-00031ad0: 6e28 322e 202a 206e 702e 7069 202a 2028  n(2. * np.pi * (
-00031ae0: 6f72 6269 7461 6c5f 7068 6173 6529 202b  orbital_phase) +
-00031af0: 2063 656e 7465 725f 7068 6173 6520 2b20   center_phase + 
-00031b00: 7068 6173 655f 6f66 6673 6574 202a 2028  phase_offset * (
-00031b10: 6e70 2e70 6920 2f20 3138 302e 2920 290a  np.pi / 180.) ).
-00031b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031b40: 2020 2020 2020 2020 2020 2020 2320 5363              # Sc
-00031b50: 616c 6520 746f 2062 6520 3120 6174 2073  ale to be 1 at s
-00031b60: 6563 6f6e 6461 7279 2065 636c 6970 7365  econdary eclipse
-00031b70: 2c20 3020 6174 2074 7261 6e73 6974 3a0a  , 0 at transit:.
-00031b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031ba0: 2020 2020 2020 2020 2020 2020 7369 6e65              sine
-00031bb0: 5f6d 6f64 656c 203d 2028 7369 6e65 5f6d  _model = (sine_m
-00031bc0: 6f64 656c 202b 2031 2920 2a20 302e 350a  odel + 1) * 0.5.
-00031bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031bf0: 2020 2020 2020 2020 2020 2020 2320 416d              # Am
-00031c00: 706c 6966 7920 6279 2070 6861 7365 2d61  plify by phase-a
-00031c10: 6d70 6c69 7475 6465 3a0a 2020 2020 2020  mplitude:.      
-00031c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031c40: 2020 2020 2020 7369 6e65 5f6d 6f64 656c        sine_model
-00031c50: 203d 2028 7365 6c66 2e6d 6f64 656c 5b69   = (self.model[i
-00031c60: 6e73 7472 756d 656e 745d 5b27 7061 7261  nstrument]['para
-00031c70: 6d73 275d 2e66 7029 202a 2073 696e 655f  ms'].fp) * sine_
-00031c80: 6d6f 6465 6c0a 2020 2020 2020 2020 2020  model.          
-00031c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031cb0: 2020 2320 4d75 6c74 6970 6c79 2062 7920    # Multiply by 
-00031cc0: 6e6f 726d 6564 2065 636c 6970 7365 206d  normed eclipse m
-00031cd0: 6f64 656c 3a0a 2020 2020 2020 2020 2020  odel:.          
+00031a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031a70: 2020 2020 2020 2320 6d6f 6465 6c20 7661        # model va
+00031a80: 7269 6174 696f 6e73 2031 202b 2066 7020  riations 1 + fp 
+00031a90: 2d2d 2d20 7769 7468 2069 6e2d 6563 6c69  --- with in-ecli
+00031aa0: 7073 6520 616c 7761 7973 2062 6569 6e67  pse always being
+00031ab0: 2031 2e20 5375 6274 7261 6374 2066 7020   1. Subtract fp 
+00031ac0: 7468 656e 3a3a 0a20 2020 2020 2020 2020  then::.         
+00031ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031ae0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00031af0: 7261 6e73 6974 5f6d 6f64 656c 203d 206d  ransit_model = m
+00031b00: 5b30 5d2e 6c69 6768 745f 6375 7276 6528  [0].light_curve(
+00031b10: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+00031b20: 756d 656e 745d 5b27 7061 7261 6d73 275d  ument]['params']
+00031b30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00031b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031b50: 2020 2020 2020 2020 2020 6563 6c69 7073            eclips
+00031b60: 655f 6d6f 6465 6c20 3d20 6d5b 315d 2e6c  e_model = m[1].l
+00031b70: 6967 6874 5f63 7572 7665 2873 656c 662e  ight_curve(self.
+00031b80: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
+00031b90: 5d5b 2770 6172 616d 7327 5d29 0a0a 2020  ]['params'])..  
+00031ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031bc0: 2020 2020 2020 2320 4e6f 772c 2066 6967        # Now, fig
+00031bd0: 7572 6520 6f75 7420 6966 2061 2070 6861  ure out if a pha
+00031be0: 7365 2d63 7572 7665 206d 6f64 656c 2069  se-curve model i
+00031bf0: 7320 6265 696e 6720 6669 7420 6f72 206e  s being fit or n
+00031c00: 6f74 3a0a 2020 2020 2020 2020 2020 2020  ot:.            
+00031c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031c20: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00031c30: 6f74 2073 656c 662e 6469 6374 696f 6e61  ot self.dictiona
+00031c40: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
+00031c50: 5068 6173 6543 7572 7665 4669 7427 5d3a  PhaseCurveFit']:
+00031c60: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00031c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031c80: 2020 2020 2020 2020 2020 2020 2020 6563                ec
+00031c90: 6c69 7073 655f 6d6f 6465 6c20 3d20 6563  lipse_model = ec
+00031ca0: 6c69 7073 655f 6d6f 6465 6c20 2d20 7365  lipse_model - se
+00031cb0: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
+00031cc0: 656e 745d 5b27 7061 7261 6d73 275d 2e66  ent]['params'].f
+00031cd0: 700a 2020 2020 2020 2020 2020 2020 2020  p.              
 00031ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031d00: 2020 7369 6e65 5f6d 6f64 656c 203d 2031    sine_model = 1
-00031d10: 2e20 2b20 7369 6e65 5f6d 6f64 656c 202a  . + sine_model *
-00031d20: 2028 2865 636c 6970 7365 5f6d 6f64 656c   ((eclipse_model
-00031d30: 202d 2031 2e29 202f 2073 656c 662e 6d6f   - 1.) / self.mo
-00031d40: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
-00031d50: 2770 6172 616d 7327 5d2e 6670 290a 0a20  'params'].fp).. 
-00031d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031cf0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00031d00: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
+00031d10: 656e 745d 5b27 4d27 5d20 2b3d 2074 7261  ent]['M'] += tra
+00031d20: 6e73 6974 5f6d 6f64 656c 202a 2065 636c  nsit_model * ecl
+00031d30: 6970 7365 5f6d 6f64 656c 202d 2031 2e0a  ipse_model - 1..
+00031d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031d60: 2020 2020 2020 2020 2065 6c73 653a 0a0a           else:..
 00031d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031d80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00031d90: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
-00031da0: 5d5b 274d 275d 202b 3d20 7472 616e 7369  ]['M'] += transi
-00031db0: 745f 6d6f 6465 6c20 2a20 7369 6e65 5f6d  t_model * sine_m
-00031dc0: 6f64 656c 202d 2031 2e0a 200a 2020 2020  odel - 1.. .    
-00031dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031de0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00031df0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00031e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031e10: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
-00031e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031e30: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-00031e40: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
-00031e50: 696e 7374 7275 6d65 6e74 5d5b 2754 7261  instrument]['Tra
-00031e60: 6e45 636c 4669 7427 5d3a 0a0a 2020 2020  nEclFit']:..    
-00031e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031d90: 2020 2020 2020 2020 2020 2020 6f72 6269              orbi
+00031da0: 7461 6c5f 7068 6173 6520 3d20 2820 2820  tal_phase = ( ( 
+00031db0: 2820 7365 6c66 2e6d 6f64 656c 5b69 6e73  ( self.model[ins
+00031dc0: 7472 756d 656e 745d 5b27 6d27 5d5b 315d  trument]['m'][1]
+00031dd0: 2e74 202d 2073 656c 662e 6d6f 6465 6c5b  .t - self.model[
+00031de0: 696e 7374 7275 6d65 6e74 5d5b 2770 6172  instrument]['par
+00031df0: 616d 7327 5d2e 7430 2029 202f 2073 656c  ams'].t0 ) / sel
+00031e00: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+00031e10: 6e74 5d5b 2770 6172 616d 7327 5d2e 7065  nt]['params'].pe
+00031e20: 7220 2920 2520 3120 290a 2020 2020 2020  r ) % 1 ).      
+00031e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031e50: 2020 2020 2020 6365 6e74 6572 5f70 6861        center_pha
+00031e60: 7365 203d 202d 206e 702e 7069 202f 2032  se = - np.pi / 2
+00031e70: 2e0a 0a20 2020 2020 2020 2020 2020 2020  ...             
 00031e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031e90: 2020 2020 7365 6c66 2e6d 6f64 656c 5b69      self.model[i
-00031ea0: 6e73 7472 756d 656e 745d 5b27 7027 2b73  nstrument]['p'+s
-00031eb0: 7472 2869 295d 203d 206d 2e6c 6967 6874  tr(i)] = m.light
-00031ec0: 5f63 7572 7665 2873 656c 662e 6d6f 6465  _curve(self.mode
-00031ed0: 6c5b 696e 7374 7275 6d65 6e74 5d5b 2770  l[instrument]['p
-00031ee0: 6172 616d 7327 5d29 0a20 2020 2020 2020  arams']).       
-00031ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031f10: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-00031f20: 7275 6d65 6e74 5d5b 274d 275d 202b 3d20  rument]['M'] += 
-00031f30: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
-00031f40: 756d 656e 745d 5b27 7027 2b73 7472 2869  ument]['p'+str(i
-00031f50: 295d 202d 2031 2e20 0a0a 2020 2020 2020  )] - 1. ..      
+00031e90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00031ea0: 2042 7569 6c64 206d 6f64 656c 2e20 4669   Build model. Fi
+00031eb0: 7273 742c 2074 6865 2062 6173 6973 2073  rst, the basis s
+00031ec0: 696e 6520 6675 6e63 7469 6f6e 3a0a 2020  ine function:.  
+00031ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031ef0: 2020 2020 2020 2020 2020 7369 6e65 5f6d            sine_m
+00031f00: 6f64 656c 203d 206e 702e 7369 6e28 322e  odel = np.sin(2.
+00031f10: 202a 206e 702e 7069 202a 2028 6f72 6269   * np.pi * (orbi
+00031f20: 7461 6c5f 7068 6173 6529 202b 2063 656e  tal_phase) + cen
+00031f30: 7465 725f 7068 6173 6520 2b20 7068 6173  ter_phase + phas
+00031f40: 655f 6f66 6673 6574 202a 2028 6e70 2e70  e_offset * (np.p
+00031f50: 6920 2f20 3138 302e 2920 290a 2020 2020  i / 180.) ).    
 00031f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031f70: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00031f80: 7365 3a0a 0a20 2020 2020 2020 2020 2020  se:..           
-00031f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031fa0: 2020 2020 2020 2020 2020 2020 2023 2049               # I
-00031fb0: 6e20 636f 6d62 696e 6564 2074 7261 6e73  n combined trans
-00031fc0: 6974 202b 2065 636c 6970 7365 206d 6f64  it + eclipse mod
-00031fd0: 656c 732c 2061 7373 756d 6520 6279 2064  els, assume by d
-00031fe0: 6566 6175 6c74 2061 6e79 2070 6861 7365  efault any phase
-00031ff0: 2d63 7572 7665 2076 6172 6961 7469 6f6e  -curve variation
-00032000: 7320 6172 6520 6265 696e 6720 6d6f 6465  s are being mode
-00032010: 6c6c 6564 2065 7874 6572 6e61 6c6c 7920  lled externally 
-00032020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032040: 2020 2020 2020 2020 2023 2062 7920 6465           # by de
-00032050: 6661 756c 7420 2862 792c 2065 2e67 2e2c  fault (by, e.g.,
-00032060: 2073 7973 7465 6d61 7469 6373 206d 6f64   systematics mod
-00032070: 656c 732c 2070 6861 7365 2d63 7572 7665  els, phase-curve
-00032080: 2076 6172 6961 7469 6f6e 7320 6164 6465   variations adde
-00032090: 6420 6c61 7465 722c 2065 7463 2e29 2e20  d later, etc.). 
-000320a0: 546f 2074 6869 7320 656e 642c 206e 6f74  To this end, not
-000320b0: 6520 6261 746d 616e 2068 6173 206f 7574  e batman has out
-000320c0: 2d6f 662d 6563 6c69 7073 6520 0a20 2020  -of-eclipse .   
+00031f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031f80: 2020 2020 2020 2020 2320 5363 616c 6520          # Scale 
+00031f90: 746f 2062 6520 3120 6174 2073 6563 6f6e  to be 1 at secon
+00031fa0: 6461 7279 2065 636c 6970 7365 2c20 3020  dary eclipse, 0 
+00031fb0: 6174 2074 7261 6e73 6974 3a0a 2020 2020  at transit:.    
+00031fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031fe0: 2020 2020 2020 2020 7369 6e65 5f6d 6f64          sine_mod
+00031ff0: 656c 203d 2028 7369 6e65 5f6d 6f64 656c  el = (sine_model
+00032000: 202b 2031 2920 2a20 302e 350a 2020 2020   + 1) * 0.5.    
+00032010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032030: 2020 2020 2020 2020 2320 416d 706c 6966          # Amplif
+00032040: 7920 6279 2070 6861 7365 2d61 6d70 6c69  y by phase-ampli
+00032050: 7475 6465 3a0a 2020 2020 2020 2020 2020  tude:.          
+00032060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032080: 2020 7369 6e65 5f6d 6f64 656c 203d 2028    sine_model = (
+00032090: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+000320a0: 756d 656e 745d 5b27 7061 7261 6d73 275d  ument]['params']
+000320b0: 2e66 7029 202a 2073 696e 655f 6d6f 6465  .fp) * sine_mode
+000320c0: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
 000320d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000320e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000320f0: 2020 2020 2023 206d 6f64 656c 2076 6172       # model var
-00032100: 6961 7469 6f6e 7320 3120 2b20 6670 202d  iations 1 + fp -
-00032110: 2d2d 2077 6974 6820 696e 2d65 636c 6970  -- with in-eclip
-00032120: 7365 2061 6c77 6179 7320 6265 696e 6720  se always being 
-00032130: 312e 2053 7562 7472 6163 7420 6670 2074  1. Subtract fp t
-00032140: 6865 6e3a 0a20 2020 2020 2020 2020 2020  hen:.           
-00032150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032160: 2020 2020 2020 2020 2020 2020 2074 7261               tra
-00032170: 6e73 6974 5f6d 6f64 656c 203d 206d 5b30  nsit_model = m[0
-00032180: 5d2e 6c69 6768 745f 6375 7276 6528 7365  ].light_curve(se
-00032190: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
-000321a0: 656e 745d 5b27 7061 7261 6d73 275d 290a  ent]['params']).
+000320e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+000320f0: 4d75 6c74 6970 6c79 2062 7920 6e6f 726d  Multiply by norm
+00032100: 6564 2065 636c 6970 7365 206d 6f64 656c  ed eclipse model
+00032110: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00032120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032130: 2020 2020 2020 2020 2020 2020 2020 7369                si
+00032140: 6e65 5f6d 6f64 656c 203d 2031 2e20 2b20  ne_model = 1. + 
+00032150: 7369 6e65 5f6d 6f64 656c 202a 2028 2865  sine_model * ((e
+00032160: 636c 6970 7365 5f6d 6f64 656c 202d 2031  clipse_model - 1
+00032170: 2e29 202f 2073 656c 662e 6d6f 6465 6c5b  .) / self.model[
+00032180: 696e 7374 7275 6d65 6e74 5d5b 2770 6172  instrument]['par
+00032190: 616d 7327 5d2e 6670 290a 0a20 2020 2020  ams'].fp)..     
+000321a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000321b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000321c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000321d0: 2020 2020 2020 2020 6563 6c69 7073 655f          eclipse_
-000321e0: 6d6f 6465 6c20 3d20 6d5b 315d 2e6c 6967  model = m[1].lig
-000321f0: 6874 5f63 7572 7665 2873 656c 662e 6d6f  ht_curve(self.mo
-00032200: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
-00032210: 2770 6172 616d 7327 5d29 0a0a 2020 2020  'params'])..    
-00032220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000321c0: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
+000321d0: 6c5b 696e 7374 7275 6d65 6e74 5d5b 274d  l[instrument]['M
+000321e0: 275d 202b 3d20 7472 616e 7369 745f 6d6f  '] += transit_mo
+000321f0: 6465 6c20 2a20 7369 6e65 5f6d 6f64 656c  del * sine_model
+00032200: 202d 2031 2e0a 200a 2020 2020 2020 2020   - 1.. .        
+00032210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032220: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
 00032230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032240: 2020 2020 2320 4e6f 772c 2066 6967 7572      # Now, figur
-00032250: 6520 6f75 7420 6966 2061 2070 6861 7365  e out if a phase
-00032260: 2d63 7572 7665 206d 6f64 656c 2069 7320  -curve model is 
-00032270: 6265 696e 6720 6669 7420 6f72 206e 6f74  being fit or not
-00032280: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00032290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000322a0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-000322b0: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-000322c0: 5b69 6e73 7472 756d 656e 745d 5b27 5068  [instrument]['Ph
-000322d0: 6173 6543 7572 7665 4669 7427 5d3a 0a0a  aseCurveFit']:..
-000322e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000322f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032300: 2020 2020 2020 2020 2020 2020 6563 6c69              ecli
-00032310: 7073 655f 6d6f 6465 6c20 3d20 6563 6c69  pse_model = ecli
-00032320: 7073 655f 6d6f 6465 6c20 2d20 7365 6c66  pse_model - self
-00032330: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
-00032340: 745d 5b27 7061 7261 6d73 275d 2e66 700a  t]['params'].fp.
-00032350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032370: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00032380: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
-00032390: 745d 5b27 7027 2b73 7472 2869 295d 203d  t]['p'+str(i)] =
-000323a0: 2074 7261 6e73 6974 5f6d 6f64 656c 202a   transit_model *
-000323b0: 2065 636c 6970 7365 5f6d 6f64 656c 0a0a   eclipse_model..
-000323c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032270: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+00032280: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
+00032290: 7275 6d65 6e74 5d5b 2754 7261 6e45 636c  rument]['TranEcl
+000322a0: 4669 7427 5d3a 0a0a 2020 2020 2020 2020  Fit']:..        
+000322b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000322c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000322d0: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+000322e0: 756d 656e 745d 5b27 7027 2b73 7472 2869  ument]['p'+str(i
+000322f0: 295d 203d 206d 2e6c 6967 6874 5f63 7572  )] = m.light_cur
+00032300: 7665 2873 656c 662e 6d6f 6465 6c5b 696e  ve(self.model[in
+00032310: 7374 7275 6d65 6e74 5d5b 2770 6172 616d  strument]['param
+00032320: 7327 5d29 0a20 2020 2020 2020 2020 2020  s']).           
+00032330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032340: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00032350: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+00032360: 6e74 5d5b 274d 275d 202b 3d20 7365 6c66  nt]['M'] += self
+00032370: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
+00032380: 745d 5b27 7027 2b73 7472 2869 295d 202d  t]['p'+str(i)] -
+00032390: 2031 2e20 0a0a 2020 2020 2020 2020 2020   1. ..          
+000323a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000323b0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000323c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000323d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000323e0: 2020 2020 2020 2020 656c 7365 3a0a 0a20          else:.. 
-000323f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032410: 2020 2020 2020 2020 2020 206f 7262 6974             orbit
-00032420: 616c 5f70 6861 7365 203d 2028 2028 2028  al_phase = ( ( (
-00032430: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-00032440: 7275 6d65 6e74 5d5b 276d 275d 5b31 5d2e  rument]['m'][1].
-00032450: 7420 2d20 7365 6c66 2e6d 6f64 656c 5b69  t - self.model[i
-00032460: 6e73 7472 756d 656e 745d 5b27 7061 7261  nstrument]['para
-00032470: 6d73 275d 2e74 3020 2920 2f20 7365 6c66  ms'].t0 ) / self
-00032480: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
-00032490: 745d 5b27 7061 7261 6d73 275d 2e70 6572  t]['params'].per
-000324a0: 2029 2025 2031 2029 0a20 2020 2020 2020   ) % 1 ).       
-000324b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000324c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000324d0: 2020 2020 2063 656e 7465 725f 7068 6173       center_phas
-000324e0: 6520 3d20 2d20 6e70 2e70 6920 2f20 322e  e = - np.pi / 2.
-000324f0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00032500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032510: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00032520: 4275 696c 6420 6d6f 6465 6c2e 2046 6972  Build model. Fir
-00032530: 7374 2c20 7468 6520 6261 7369 7320 7369  st, the basis si
-00032540: 6e65 2066 756e 6374 696f 6e3a 0a20 2020  ne function:.   
-00032550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032570: 2020 2020 2020 2020 2073 696e 655f 6d6f           sine_mo
-00032580: 6465 6c20 3d20 6e70 2e73 696e 2832 2e20  del = np.sin(2. 
-00032590: 2a20 6e70 2e70 6920 2a20 286f 7262 6974  * np.pi * (orbit
-000325a0: 616c 5f70 6861 7365 2920 2b20 6365 6e74  al_phase) + cent
-000325b0: 6572 5f70 6861 7365 202b 2070 6861 7365  er_phase + phase
-000325c0: 5f6f 6666 7365 7420 2a20 286e 702e 7069  _offset * (np.pi
-000325d0: 202f 2031 3830 2e29 2029 0a20 2020 2020   / 180.) ).     
-000325e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000323e0: 2020 2020 2020 2020 2023 2049 6e20 636f           # In co
+000323f0: 6d62 696e 6564 2074 7261 6e73 6974 202b  mbined transit +
+00032400: 2065 636c 6970 7365 206d 6f64 656c 732c   eclipse models,
+00032410: 2061 7373 756d 6520 6279 2064 6566 6175   assume by defau
+00032420: 6c74 2061 6e79 2070 6861 7365 2d63 7572  lt any phase-cur
+00032430: 7665 2076 6172 6961 7469 6f6e 7320 6172  ve variations ar
+00032440: 6520 6265 696e 6720 6d6f 6465 6c6c 6564  e being modelled
+00032450: 2065 7874 6572 6e61 6c6c 7920 0a20 2020   externally .   
+00032460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032480: 2020 2020 2023 2062 7920 6465 6661 756c       # by defaul
+00032490: 7420 2862 792c 2065 2e67 2e2c 2073 7973  t (by, e.g., sys
+000324a0: 7465 6d61 7469 6373 206d 6f64 656c 732c  tematics models,
+000324b0: 2070 6861 7365 2d63 7572 7665 2076 6172   phase-curve var
+000324c0: 6961 7469 6f6e 7320 6164 6465 6420 6c61  iations added la
+000324d0: 7465 722c 2065 7463 2e29 2e20 546f 2074  ter, etc.). To t
+000324e0: 6869 7320 656e 642c 206e 6f74 6520 6261  his end, note ba
+000324f0: 746d 616e 2068 6173 206f 7574 2d6f 662d  tman has out-of-
+00032500: 6563 6c69 7073 6520 0a20 2020 2020 2020  eclipse .       
+00032510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032530: 2023 206d 6f64 656c 2076 6172 6961 7469   # model variati
+00032540: 6f6e 7320 3120 2b20 6670 202d 2d2d 2077  ons 1 + fp --- w
+00032550: 6974 6820 696e 2d65 636c 6970 7365 2061  ith in-eclipse a
+00032560: 6c77 6179 7320 6265 696e 6720 312e 2053  lways being 1. S
+00032570: 7562 7472 6163 7420 6670 2074 6865 6e3a  ubtract fp then:
+00032580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000325a0: 2020 2020 2020 2020 2074 7261 6e73 6974           transit
+000325b0: 5f6d 6f64 656c 203d 206d 5b30 5d2e 6c69  _model = m[0].li
+000325c0: 6768 745f 6375 7276 6528 7365 6c66 2e6d  ght_curve(self.m
+000325d0: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
+000325e0: 5b27 7061 7261 6d73 275d 290a 2020 2020  ['params']).    
 000325f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032600: 2020 2020 2020 2023 2053 6361 6c65 2074         # Scale t
-00032610: 6f20 6265 2031 2061 7420 7365 636f 6e64  o be 1 at second
-00032620: 6172 7920 6563 6c69 7073 652c 2030 2061  ary eclipse, 0 a
-00032630: 7420 7472 616e 7369 743a 0a20 2020 2020  t transit:.     
-00032640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032660: 2020 2020 2020 2073 696e 655f 6d6f 6465         sine_mode
-00032670: 6c20 3d20 2873 696e 655f 6d6f 6465 6c20  l = (sine_model 
-00032680: 2b20 3129 202a 2030 2e35 0a20 2020 2020  + 1) * 0.5.     
-00032690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000326a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000326b0: 2020 2020 2020 2023 2041 6d70 6c69 6679         # Amplify
-000326c0: 2062 7920 7068 6173 652d 616d 706c 6974   by phase-amplit
-000326d0: 7564 653a 0a20 2020 2020 2020 2020 2020  ude:.           
-000326e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000326f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032700: 2073 696e 655f 6d6f 6465 6c20 3d20 2873   sine_model = (s
-00032710: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
-00032720: 6d65 6e74 5d5b 2770 6172 616d 7327 5d2e  ment]['params'].
-00032730: 6670 2920 2a20 7369 6e65 5f6d 6f64 656c  fp) * sine_model
-00032740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032760: 2020 2020 2020 2020 2020 2020 2023 204d               # M
-00032770: 756c 7469 706c 7920 6279 206e 6f72 6d65  ultiply by norme
-00032780: 6420 6563 6c69 7073 6520 6d6f 6465 6c3a  d eclipse model:
-00032790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032610: 2020 2020 6563 6c69 7073 655f 6d6f 6465      eclipse_mode
+00032620: 6c20 3d20 6d5b 315d 2e6c 6967 6874 5f63  l = m[1].light_c
+00032630: 7572 7665 2873 656c 662e 6d6f 6465 6c5b  urve(self.model[
+00032640: 696e 7374 7275 6d65 6e74 5d5b 2770 6172  instrument]['par
+00032650: 616d 7327 5d29 0a0a 2020 2020 2020 2020  ams'])..        
+00032660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032680: 2320 4e6f 772c 2066 6967 7572 6520 6f75  # Now, figure ou
+00032690: 7420 6966 2061 2070 6861 7365 2d63 7572  t if a phase-cur
+000326a0: 7665 206d 6f64 656c 2069 7320 6265 696e  ve model is bein
+000326b0: 6720 6669 7420 6f72 206e 6f74 3a0a 2020  g fit or not:.  
+000326c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000326d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000326e0: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+000326f0: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
+00032700: 7472 756d 656e 745d 5b27 5068 6173 6543  trument]['PhaseC
+00032710: 7572 7665 4669 7427 5d3a 0a0a 2020 2020  urveFit']:..    
+00032720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032740: 2020 2020 2020 2020 6563 6c69 7073 655f          eclipse_
+00032750: 6d6f 6465 6c20 3d20 6563 6c69 7073 655f  model = eclipse_
+00032760: 6d6f 6465 6c20 2d20 7365 6c66 2e6d 6f64  model - self.mod
+00032770: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
+00032780: 7061 7261 6d73 275d 2e66 700a 2020 2020  params'].fp.    
+00032790: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000327a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000327b0: 2020 2020 2020 2020 2020 2020 2073 696e               sin
-000327c0: 655f 6d6f 6465 6c20 3d20 312e 202b 2073  e_model = 1. + s
-000327d0: 696e 655f 6d6f 6465 6c20 2a20 2828 6563  ine_model * ((ec
-000327e0: 6c69 7073 655f 6d6f 6465 6c20 2d20 312e  lipse_model - 1.
-000327f0: 2920 2f20 7365 6c66 2e6d 6f64 656c 5b69  ) / self.model[i
-00032800: 6e73 7472 756d 656e 745d 5b27 7061 7261  nstrument]['para
-00032810: 6d73 275d 2e66 7029 0a0a 2020 2020 2020  ms'].fp)..      
-00032820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000327b0: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+000327c0: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
+000327d0: 7027 2b73 7472 2869 295d 203d 2074 7261  p'+str(i)] = tra
+000327e0: 6e73 6974 5f6d 6f64 656c 202a 2065 636c  nsit_model * ecl
+000327f0: 6970 7365 5f6d 6f64 656c 0a0a 2020 2020  ipse_model..    
+00032800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032820: 2020 2020 656c 7365 3a0a 0a20 2020 2020      else:..     
 00032830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032840: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-00032850: 5b69 6e73 7472 756d 656e 745d 5b27 7027  [instrument]['p'
-00032860: 2b73 7472 2869 295d 203d 2074 7261 6e73  +str(i)] = trans
-00032870: 6974 5f6d 6f64 656c 202a 2073 696e 655f  it_model * sine_
-00032880: 6d6f 6465 6c0a 0a20 2020 2020 2020 2020  model..         
-00032890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000328a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000328b0: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
-000328c0: 6d65 6e74 5d5b 274d 275d 202b 3d20 7365  ment]['M'] += se
-000328d0: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
-000328e0: 656e 745d 5b27 7027 2b73 7472 2869 295d  ent]['p'+str(i)]
-000328f0: 202d 2031 2e0a 0a20 2020 2020 2020 2020   - 1...         
-00032900: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00032910: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00032920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032930: 2073 656c 662e 6d6f 6465 6c4f 4b20 3d20   self.modelOK = 
-00032940: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00032950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032960: 2020 7265 7475 726e 2046 616c 7365 0a0a    return False..
-00032970: 2020 2020 2020 2020 2020 2020 2320 4f6e              # On
-00032980: 6365 2065 6974 6865 7220 7468 6520 7472  ce either the tr
-00032990: 616e 7369 7420 6d6f 6465 6c20 6973 2067  ansit model is g
-000329a0: 656e 6572 6174 6564 206f 7220 6166 7465  enerated or afte
-000329b0: 7220 706f 7075 6c61 7469 6e67 2074 6865  r populating the
-000329c0: 2066 756c 6c5f 6d6f 6465 6c20 7769 7468   full_model with
-000329d0: 206f 6e65 7320 6966 206e 6f20 7472 616e   ones if no tran
-000329e0: 7369 7420 6669 7420 6973 206f 6e2c 0a20  sit fit is on,. 
-000329f0: 2020 2020 2020 2020 2020 2023 2063 6f6e             # con
-00032a00: 7665 7274 2074 6865 206c 6967 6874 6375  vert the lightcu
-00032a10: 7276 6520 736f 2069 7420 636f 6d70 6c69  rve so it compli
-00032a20: 6573 2077 6974 6820 7468 6520 6a75 6c69  es with the juli
-00032a30: 6574 206d 6f64 656c 2061 6363 6f75 6e74  et model account
-00032a40: 696e 6720 666f 7220 7468 6520 6469 6c75  ing for the dilu
-00032a50: 7469 6f6e 2061 6e64 2074 6865 206d 6561  tion and the mea
-00032a60: 6e20 6f75 742d 6f66 2d74 7261 6e73 6974  n out-of-transit
-00032a70: 2066 6c75 783a 0a20 2020 2020 2020 2020   flux:.         
-00032a80: 2020 2044 2c20 4d20 3d20 7061 7261 6d65     D, M = parame
-00032a90: 7465 725f 7661 6c75 6573 5b0a 2020 2020  ter_values[.    
-00032aa0: 2020 2020 2020 2020 2020 2020 276d 6469              'mdi
-00032ab0: 6c75 7469 6f6e 5f27 202b 0a20 2020 2020  lution_' +.     
-00032ac0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00032ad0: 6d64 696c 7574 696f 6e5f 696e 616d 655b  mdilution_iname[
-00032ae0: 696e 7374 7275 6d65 6e74 5d5d 2c20 7061  instrument]], pa
-00032af0: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
-00032b00: 6d66 6c75 785f 2720 2b0a 2020 2020 2020  mflux_' +.      
-00032b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032850: 2020 2020 2020 206f 7262 6974 616c 5f70         orbital_p
+00032860: 6861 7365 203d 2028 2028 2028 2073 656c  hase = ( ( ( sel
+00032870: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+00032880: 6e74 5d5b 276d 275d 5b31 5d2e 7420 2d20  nt]['m'][1].t - 
+00032890: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+000328a0: 756d 656e 745d 5b27 7061 7261 6d73 275d  ument]['params']
+000328b0: 2e74 3020 2920 2f20 7365 6c66 2e6d 6f64  .t0 ) / self.mod
+000328c0: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
+000328d0: 7061 7261 6d73 275d 2e70 6572 2029 2025  params'].per ) %
+000328e0: 2031 2029 0a20 2020 2020 2020 2020 2020   1 ).           
+000328f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032910: 2063 656e 7465 725f 7068 6173 6520 3d20   center_phase = 
+00032920: 2d20 6e70 2e70 6920 2f20 322e 0a0a 2020  - np.pi / 2...  
+00032930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032950: 2020 2020 2020 2020 2020 2320 4275 696c            # Buil
+00032960: 6420 6d6f 6465 6c2e 2046 6972 7374 2c20  d model. First, 
+00032970: 7468 6520 6261 7369 7320 7369 6e65 2066  the basis sine f
+00032980: 756e 6374 696f 6e3a 0a20 2020 2020 2020  unction:.       
+00032990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000329a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000329b0: 2020 2020 2073 696e 655f 6d6f 6465 6c20       sine_model 
+000329c0: 3d20 6e70 2e73 696e 2832 2e20 2a20 6e70  = np.sin(2. * np
+000329d0: 2e70 6920 2a20 286f 7262 6974 616c 5f70  .pi * (orbital_p
+000329e0: 6861 7365 2920 2b20 6365 6e74 6572 5f70  hase) + center_p
+000329f0: 6861 7365 202b 2070 6861 7365 5f6f 6666  hase + phase_off
+00032a00: 7365 7420 2a20 286e 702e 7069 202f 2031  set * (np.pi / 1
+00032a10: 3830 2e29 2029 0a20 2020 2020 2020 2020  80.) ).         
+00032a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032a40: 2020 2023 2053 6361 6c65 2074 6f20 6265     # Scale to be
+00032a50: 2031 2061 7420 7365 636f 6e64 6172 7920   1 at secondary 
+00032a60: 6563 6c69 7073 652c 2030 2061 7420 7472  eclipse, 0 at tr
+00032a70: 616e 7369 743a 0a20 2020 2020 2020 2020  ansit:.         
+00032a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032aa0: 2020 2073 696e 655f 6d6f 6465 6c20 3d20     sine_model = 
+00032ab0: 2873 696e 655f 6d6f 6465 6c20 2b20 3129  (sine_model + 1)
+00032ac0: 202a 2030 2e35 0a20 2020 2020 2020 2020   * 0.5.         
+00032ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032af0: 2020 2023 2041 6d70 6c69 6679 2062 7920     # Amplify by 
+00032b00: 7068 6173 652d 616d 706c 6974 7564 653a  phase-amplitude:
+00032b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00032b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032b40: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00032b50: 6c66 2e6d 666c 7578 5f69 6e61 6d65 5b69  lf.mflux_iname[i
-00032b60: 6e73 7472 756d 656e 745d 5d0a 2020 2020  nstrument]].    
-00032b70: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
-00032b80: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
-00032b90: 4d27 5d20 3d20 2873 656c 662e 6d6f 6465  M'] = (self.mode
-00032ba0: 6c5b 696e 7374 7275 6d65 6e74 5d5b 274d  l[instrument]['M
-00032bb0: 275d 202a 2044 202b 0a20 2020 2020 2020  '] * D +.       
-00032bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032b30: 2020 2020 2020 2020 2020 2020 2073 696e               sin
+00032b40: 655f 6d6f 6465 6c20 3d20 2873 656c 662e  e_model = (self.
+00032b50: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
+00032b60: 5d5b 2770 6172 616d 7327 5d2e 6670 2920  ]['params'].fp) 
+00032b70: 2a20 7369 6e65 5f6d 6f64 656c 0a20 2020  * sine_model.   
+00032b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032ba0: 2020 2020 2020 2020 2023 204d 756c 7469           # Multi
+00032bb0: 706c 7920 6279 206e 6f72 6d65 6420 6563  ply by normed ec
+00032bc0: 6c69 7073 6520 6d6f 6465 6c3a 0a20 2020  lipse model:.   
 00032bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032be0: 2020 2020 2831 2e20 2d20 4429 2920 2a20      (1. - D)) * 
-00032bf0: 2831 2e20 2f20 2831 2e20 2b20 4420 2a20  (1. / (1. + D * 
-00032c00: 4d29 290a 0a20 2020 2020 2020 2020 2020  M))..           
-00032c10: 2023 204e 6f77 2c20 6966 2061 206c 696e   # Now, if a lin
-00032c20: 6561 7220 6d6f 6465 6c20 7761 7320 6465  ear model was de
-00032c30: 6669 6e65 642c 2067 656e 6572 6174 6520  fined, generate 
-00032c40: 6974 2061 6e64 2061 6464 2069 7420 746f  it and add it to
-00032c50: 2074 6865 2066 756c 6c20 6d6f 6465 6c3a   the full model:
-00032c60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00032c70: 7365 6c66 2e6c 6d5f 626f 6f6c 6561 6e5b  self.lm_boolean[
-00032c80: 696e 7374 7275 6d65 6e74 5d3a 0a20 2020  instrument]:.   
-00032c90: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00032ca0: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
-00032cb0: 6e74 5d5b 274c 4d27 5d20 3d20 6e70 2e7a  nt]['LM'] = np.z
-00032cc0: 6572 6f73 280a 2020 2020 2020 2020 2020  eros(.          
-00032cd0: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
-00032ce0: 6461 7461 706f 696e 7473 5f70 6572 5f69  datapoints_per_i
-00032cf0: 6e73 7472 756d 656e 745b 696e 7374 7275  nstrument[instru
-00032d00: 6d65 6e74 5d29 0a20 2020 2020 2020 2020  ment]).         
-00032d10: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00032d20: 7261 6e67 6528 7365 6c66 2e6c 6d5f 6e5b  range(self.lm_n[
-00032d30: 696e 7374 7275 6d65 6e74 5d29 3a0a 2020  instrument]):.  
-00032d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032d50: 2020 7365 6c66 2e6d 6f64 656c 5b69 6e73    self.model[ins
-00032d60: 7472 756d 656e 745d 5b27 4c4d 275d 202b  trument]['LM'] +
-00032d70: 3d20 7061 7261 6d65 7465 725f 7661 6c75  = parameter_valu
-00032d80: 6573 5b0a 2020 2020 2020 2020 2020 2020  es[.            
-00032d90: 2020 2020 2020 2020 2020 2020 2774 6865              'the
-00032da0: 7461 2720 2b20 7374 7228 6929 202b 2027  ta' + str(i) + '
-00032db0: 5f27 202b 0a20 2020 2020 2020 2020 2020  _' +.           
-00032dc0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00032dd0: 662e 7468 6574 615f 696e 616d 655b 7374  f.theta_iname[st
-00032de0: 7228 6929 2b69 6e73 7472 756d 656e 745d  r(i)+instrument]
-00032df0: 5d20 2a20 7365 6c66 2e6c 6d5f 6172 6775  ] * self.lm_argu
-00032e00: 6d65 6e74 735b 696e 7374 7275 6d65 6e74  ments[instrument
-00032e10: 5d5b 3a2c 2069 5d0a 2020 2020 2020 2020  ][:, i].        
-00032e20: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
-00032e30: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
-00032e40: 6465 7465 726d 696e 6973 7469 6327 5d20  deterministic'] 
-00032e50: 3d20 7365 6c66 2e6d 6f64 656c 5b0a 2020  = self.model[.  
-00032e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032e70: 2020 696e 7374 7275 6d65 6e74 5d5b 274d    instrument]['M
-00032e80: 275d 202b 2073 656c 662e 6d6f 6465 6c5b  '] + self.model[
-00032e90: 696e 7374 7275 6d65 6e74 5d5b 274c 4d27  instrument]['LM'
-00032ea0: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
-00032eb0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00032ec0: 2020 2020 7365 6c66 2e6d 6f64 656c 5b69      self.model[i
-00032ed0: 6e73 7472 756d 656e 745d 5b27 6465 7465  nstrument]['dete
-00032ee0: 726d 696e 6973 7469 6327 5d20 3d20 7365  rministic'] = se
-00032ef0: 6c66 2e6d 6f64 656c 5b0a 2020 2020 2020  lf.model[.      
-00032f00: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00032f10: 7374 7275 6d65 6e74 5d5b 274d 275d 0a20  strument]['M']. 
-00032f20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00032f30: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
-00032f40: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
-00032f50: 2020 2027 6465 7465 726d 696e 6973 7469     'deterministi
-00032f60: 635f 7661 7269 616e 6365 7327 5d20 3d20  c_variances'] = 
-00032f70: 7365 6c66 2e65 7272 6f72 735b 696e 7374  self.errors[inst
-00032f80: 7275 6d65 6e74 5d2a 2a32 202b 2028 0a20  rument]**2 + (. 
-00032f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032fa0: 2020 2070 6172 616d 6574 6572 5f76 616c     parameter_val
-00032fb0: 7565 735b 2773 6967 6d61 5f77 5f27 202b  ues['sigma_w_' +
-00032fc0: 2073 656c 662e 7369 676d 6177 5f69 6e61   self.sigmaw_ina
-00032fd0: 6d65 5b69 6e73 7472 756d 656e 745d 5d20  me[instrument]] 
-00032fe0: 2a20 3165 2d36 292a 2a32 0a20 2020 2020  * 1e-6)**2.     
-00032ff0: 2020 2020 2020 2023 2046 696e 616c 6c79         # Finally
-00033000: 2c20 6966 2074 6865 206d 6f64 656c 2075  , if the model u
-00033010: 6e64 6572 2063 6f6e 7369 6465 7261 7469  nder considerati
-00033020: 6f6e 2069 7320 6120 676c 6f62 616c 206d  on is a global m
-00033030: 6f64 656c 2c20 706f 7075 6c61 7465 2074  odel, populate t
-00033040: 6865 2067 6c6f 6261 6c20 6d6f 6465 6c20  he global model 
-00033050: 6469 6374 696f 6e61 7279 3a0a 2020 2020  dictionary:.    
-00033060: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00033070: 676c 6f62 616c 5f6d 6f64 656c 3a0a 2020  global_model:.  
-00033080: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00033090: 6c66 2e6d 6f64 656c 5b27 676c 6f62 616c  lf.model['global
-000330a0: 275d 5b73 656c 662e 696e 7374 7275 6d65  '][self.instrume
-000330b0: 6e74 5f69 6e64 6578 6573 5b0a 2020 2020  nt_indexes[.    
-000330c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000330d0: 696e 7374 7275 6d65 6e74 5d5d 203d 2073  instrument]] = s
-000330e0: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
-000330f0: 6d65 6e74 5d5b 2764 6574 6572 6d69 6e69  ment]['determini
-00033100: 7374 6963 275d 0a20 2020 2020 2020 2020  stic'].         
-00033110: 2020 2020 2020 2069 6620 6576 616c 7561         if evalua
-00033120: 7465 5f67 6c6f 6261 6c5f 6572 726f 7273  te_global_errors
-00033130: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00033140: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-00033150: 5b27 676c 6f62 616c 5f76 6172 6961 6e63  ['global_varianc
-00033160: 6573 275d 5b73 656c 662e 696e 7374 7275  es'][self.instru
-00033170: 6d65 6e74 5f69 6e64 6578 6573 5b69 6e73  ment_indexes[ins
-00033180: 7472 756d 656e 745d 5d20 3d20 7365 6c66  trument]] = self
-00033190: 2e79 6572 725b 7365 6c66 2e69 6e73 7472  .yerr[self.instr
-000331a0: 756d 656e 745f 696e 6465 7865 735b 696e  ument_indexes[in
-000331b0: 7374 7275 6d65 6e74 5d5d 2a2a 3220 2b20  strument]]**2 + 
-000331c0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-000331d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000331e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000331f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033210: 2020 2020 2020 2020 2020 2020 2870 6172              (par
-00033220: 616d 6574 6572 5f76 616c 7565 735b 2773  ameter_values['s
-00033230: 6967 6d61 5f77 5f27 2b69 6e73 7472 756d  igma_w_'+instrum
-00033240: 656e 745d 2a31 652d 3629 2a2a 320a 0a20  ent]*1e-6)**2.. 
-00033250: 2020 2064 6566 2067 6175 7373 6961 6e5f     def gaussian_
-00033260: 6c6f 675f 6c69 6b65 6c69 686f 6f64 2873  log_likelihood(s
-00033270: 656c 662c 2072 6573 6964 7561 6c73 2c20  elf, residuals, 
-00033280: 7661 7269 616e 6365 7329 3a0a 0a20 2020  variances):..   
-00033290: 2020 2020 2074 6175 7320 3d20 312e 202f       taus = 1. /
-000332a0: 2076 6172 6961 6e63 6573 0a20 2020 2020   variances.     
-000332b0: 2020 2072 6574 7572 6e20 2d30 2e35 202a     return -0.5 *
-000332c0: 2028 6c65 6e28 7265 7369 6475 616c 7329   (len(residuals)
-000332d0: 202a 206c 6f67 3270 6920 2b20 6e70 2e73   * log2pi + np.s
-000332e0: 756d 282d 6e70 2e6c 6f67 2874 6175 732e  um(-np.log(taus.
-000332f0: 6173 7479 7065 2866 6c6f 6174 2929 202b  astype(float)) +
-00033300: 2074 6175 7320 2a20 2872 6573 6964 7561   taus * (residua
-00033310: 6c73 2a2a 3229 2929 0a0a 2020 2020 6465  ls**2)))..    de
-00033320: 6620 6765 745f 6c6f 675f 6c69 6b65 6c69  f get_log_likeli
-00033330: 686f 6f64 2873 656c 662c 2070 6172 616d  hood(self, param
-00033340: 6574 6572 5f76 616c 7565 7329 3a0a 2020  eter_values):.  
-00033350: 2020 2020 2020 6966 2073 656c 662e 676c        if self.gl
-00033360: 6f62 616c 5f6d 6f64 656c 3a0a 2020 2020  obal_model:.    
-00033370: 2020 2020 2020 2020 7265 7369 6475 616c          residual
-00033380: 7320 3d20 7365 6c66 2e79 202d 2073 656c  s = self.y - sel
-00033390: 662e 6d6f 6465 6c5b 2767 6c6f 6261 6c27  f.model['global'
-000333a0: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
-000333b0: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-000333c0: 5b27 676c 6f62 616c 5f6d 6f64 656c 275d  ['global_model']
-000333d0: 5b27 4750 4465 7472 656e 6427 5d3a 0a20  ['GPDetrend']:. 
-000333e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000333f0: 656c 662e 6469 6374 696f 6e61 7279 5b27  elf.dictionary['
-00033400: 676c 6f62 616c 5f6d 6f64 656c 275d 5b0a  global_model'][.
-00033410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033420: 2020 2020 276e 6f69 7365 5f6d 6f64 656c      'noise_model
-00033430: 275d 2e73 6574 5f70 6172 616d 6574 6572  '].set_parameter
-00033440: 5f76 6563 746f 7228 7061 7261 6d65 7465  _vector(paramete
-00033450: 725f 7661 6c75 6573 290a 2020 2020 2020  r_values).      
-00033460: 2020 2020 2020 2020 2020 7365 6c66 2e64            self.d
-00033470: 6963 7469 6f6e 6172 795b 2767 6c6f 6261  ictionary['globa
-00033480: 6c5f 6d6f 6465 6c27 5d5b 276e 6f69 7365  l_model']['noise
-00033490: 5f6d 6f64 656c 275d 2e79 6572 7220 3d20  _model'].yerr = 
-000334a0: 6e70 2e73 7172 7428 0a20 2020 2020 2020  np.sqrt(.       
-000334b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000334c0: 662e 6d6f 6465 6c5b 2767 6c6f 6261 6c5f  f.model['global_
-000334d0: 7661 7269 616e 6365 7327 5d29 0a20 2020  variances']).   
-000334e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000334f0: 662e 6469 6374 696f 6e61 7279 5b27 676c  f.dictionary['gl
-00033500: 6f62 616c 5f6d 6f64 656c 275d 5b27 6e6f  obal_model']['no
-00033510: 6973 655f 6d6f 6465 6c27 5d2e 636f 6d70  ise_model'].comp
-00033520: 7574 655f 4750 2829 0a20 2020 2020 2020  ute_GP().       
-00033530: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00033540: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
-00033550: 2767 6c6f 6261 6c5f 6d6f 6465 6c27 5d5b  'global_model'][
-00033560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033570: 2020 2020 2027 6e6f 6973 655f 6d6f 6465       'noise_mode
-00033580: 6c27 5d2e 4750 2e6c 6f67 5f6c 696b 656c  l'].GP.log_likel
-00033590: 6968 6f6f 6428 7265 7369 6475 616c 7329  ihood(residuals)
-000335a0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-000335b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000335c0: 2020 2073 656c 662e 6761 7573 7369 616e     self.gaussian
-000335d0: 5f6c 6f67 5f6c 696b 656c 6968 6f6f 6428  _log_likelihood(
-000335e0: 7265 7369 6475 616c 732c 0a20 2020 2020  residuals,.     
-000335f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032bf0: 2020 2020 2020 2020 2073 696e 655f 6d6f           sine_mo
+00032c00: 6465 6c20 3d20 312e 202b 2073 696e 655f  del = 1. + sine_
+00032c10: 6d6f 6465 6c20 2a20 2828 6563 6c69 7073  model * ((eclips
+00032c20: 655f 6d6f 6465 6c20 2d20 312e 2920 2f20  e_model - 1.) / 
+00032c30: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+00032c40: 756d 656e 745d 5b27 7061 7261 6d73 275d  ument]['params']
+00032c50: 2e66 7029 0a0a 2020 2020 2020 2020 2020  .fp)..          
+00032c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032c80: 2020 7365 6c66 2e6d 6f64 656c 5b69 6e73    self.model[ins
+00032c90: 7472 756d 656e 745d 5b27 7027 2b73 7472  trument]['p'+str
+00032ca0: 2869 295d 203d 2074 7261 6e73 6974 5f6d  (i)] = transit_m
+00032cb0: 6f64 656c 202a 2073 696e 655f 6d6f 6465  odel * sine_mode
+00032cc0: 6c0a 0a20 2020 2020 2020 2020 2020 2020  l..             
+00032cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032ce0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00032cf0: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
+00032d00: 5d5b 274d 275d 202b 3d20 7365 6c66 2e6d  ]['M'] += self.m
+00032d10: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
+00032d20: 5b27 7027 2b73 7472 2869 295d 202d 2031  ['p'+str(i)] - 1
+00032d30: 2e0a 0a20 2020 2020 2020 2020 2020 2020  ...             
+00032d40: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00032d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032d60: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00032d70: 662e 6d6f 6465 6c4f 4b20 3d20 4661 6c73  f.modelOK = Fals
+00032d80: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00032d90: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00032da0: 7475 726e 2046 616c 7365 0a0a 2020 2020  turn False..    
+00032db0: 2020 2020 2020 2020 2320 4f6e 6365 2065          # Once e
+00032dc0: 6974 6865 7220 7468 6520 7472 616e 7369  ither the transi
+00032dd0: 7420 6d6f 6465 6c20 6973 2067 656e 6572  t model is gener
+00032de0: 6174 6564 206f 7220 6166 7465 7220 706f  ated or after po
+00032df0: 7075 6c61 7469 6e67 2074 6865 2066 756c  pulating the ful
+00032e00: 6c5f 6d6f 6465 6c20 7769 7468 206f 6e65  l_model with one
+00032e10: 7320 6966 206e 6f20 7472 616e 7369 7420  s if no transit 
+00032e20: 6669 7420 6973 206f 6e2c 0a20 2020 2020  fit is on,.     
+00032e30: 2020 2020 2020 2023 2063 6f6e 7665 7274         # convert
+00032e40: 2074 6865 206c 6967 6874 6375 7276 6520   the lightcurve 
+00032e50: 736f 2069 7420 636f 6d70 6c69 6573 2077  so it complies w
+00032e60: 6974 6820 7468 6520 6a75 6c69 6574 206d  ith the juliet m
+00032e70: 6f64 656c 2061 6363 6f75 6e74 696e 6720  odel accounting 
+00032e80: 666f 7220 7468 6520 6469 6c75 7469 6f6e  for the dilution
+00032e90: 2061 6e64 2074 6865 206d 6561 6e20 6f75   and the mean ou
+00032ea0: 742d 6f66 2d74 7261 6e73 6974 2066 6c75  t-of-transit flu
+00032eb0: 783a 0a20 2020 2020 2020 2020 2020 2044  x:.            D
+00032ec0: 2c20 4d20 3d20 7061 7261 6d65 7465 725f  , M = parameter_
+00032ed0: 7661 6c75 6573 5b0a 2020 2020 2020 2020  values[.        
+00032ee0: 2020 2020 2020 2020 276d 6469 6c75 7469          'mdiluti
+00032ef0: 6f6e 5f27 202b 0a20 2020 2020 2020 2020  on_' +.         
+00032f00: 2020 2020 2020 2073 656c 662e 6d64 696c         self.mdil
+00032f10: 7574 696f 6e5f 696e 616d 655b 696e 7374  ution_iname[inst
+00032f20: 7275 6d65 6e74 5d5d 2c20 7061 7261 6d65  rument]], parame
+00032f30: 7465 725f 7661 6c75 6573 5b27 6d66 6c75  ter_values['mflu
+00032f40: 785f 2720 2b0a 2020 2020 2020 2020 2020  x_' +.          
+00032f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032f80: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00032f90: 666c 7578 5f69 6e61 6d65 5b69 6e73 7472  flux_iname[instr
+00032fa0: 756d 656e 745d 5d0a 2020 2020 2020 2020  ument]].        
+00032fb0: 2020 2020 7365 6c66 2e6d 6f64 656c 5b69      self.model[i
+00032fc0: 6e73 7472 756d 656e 745d 5b27 4d27 5d20  nstrument]['M'] 
+00032fd0: 3d20 2873 656c 662e 6d6f 6465 6c5b 696e  = (self.model[in
+00032fe0: 7374 7275 6d65 6e74 5d5b 274d 275d 202a  strument]['M'] *
+00032ff0: 2044 202b 0a20 2020 2020 2020 2020 2020   D +.           
+00033000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033020: 2831 2e20 2d20 4429 2920 2a20 2831 2e20  (1. - D)) * (1. 
+00033030: 2f20 2831 2e20 2b20 4420 2a20 4d29 290a  / (1. + D * M)).
+00033040: 0a20 2020 2020 2020 2020 2020 2023 204e  .            # N
+00033050: 6f77 2c20 6966 2061 206c 696e 6561 7220  ow, if a linear 
+00033060: 6d6f 6465 6c20 7761 7320 6465 6669 6e65  model was define
+00033070: 642c 2067 656e 6572 6174 6520 6974 2061  d, generate it a
+00033080: 6e64 2061 6464 2069 7420 746f 2074 6865  nd add it to the
+00033090: 2066 756c 6c20 6d6f 6465 6c3a 0a20 2020   full model:.   
+000330a0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+000330b0: 2e6c 6d5f 626f 6f6c 6561 6e5b 696e 7374  .lm_boolean[inst
+000330c0: 7275 6d65 6e74 5d3a 0a20 2020 2020 2020  rument]:.       
+000330d0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
+000330e0: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
+000330f0: 274c 4d27 5d20 3d20 6e70 2e7a 6572 6f73  'LM'] = np.zeros
+00033100: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00033110: 2020 2020 2020 7365 6c66 2e6e 6461 7461        self.ndata
+00033120: 706f 696e 7473 5f70 6572 5f69 6e73 7472  points_per_instr
+00033130: 756d 656e 745b 696e 7374 7275 6d65 6e74  ument[instrument
+00033140: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+00033150: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00033160: 6528 7365 6c66 2e6c 6d5f 6e5b 696e 7374  e(self.lm_n[inst
+00033170: 7275 6d65 6e74 5d29 3a0a 2020 2020 2020  rument]):.      
+00033180: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00033190: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
+000331a0: 656e 745d 5b27 4c4d 275d 202b 3d20 7061  ent]['LM'] += pa
+000331b0: 7261 6d65 7465 725f 7661 6c75 6573 5b0a  rameter_values[.
+000331c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000331d0: 2020 2020 2020 2020 2774 6865 7461 2720          'theta' 
+000331e0: 2b20 7374 7228 6929 202b 2027 5f27 202b  + str(i) + '_' +
+000331f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033200: 2020 2020 2020 2020 2073 656c 662e 7468           self.th
+00033210: 6574 615f 696e 616d 655b 7374 7228 6929  eta_iname[str(i)
+00033220: 2b69 6e73 7472 756d 656e 745d 5d20 2a20  +instrument]] * 
+00033230: 7365 6c66 2e6c 6d5f 6172 6775 6d65 6e74  self.lm_argument
+00033240: 735b 696e 7374 7275 6d65 6e74 5d5b 3a2c  s[instrument][:,
+00033250: 2069 5d0a 2020 2020 2020 2020 2020 2020   i].            
+00033260: 2020 2020 7365 6c66 2e6d 6f64 656c 5b69      self.model[i
+00033270: 6e73 7472 756d 656e 745d 5b27 6465 7465  nstrument]['dete
+00033280: 726d 696e 6973 7469 6327 5d20 3d20 7365  rministic'] = se
+00033290: 6c66 2e6d 6f64 656c 5b0a 2020 2020 2020  lf.model[.      
+000332a0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+000332b0: 7374 7275 6d65 6e74 5d5b 274d 275d 202b  strument]['M'] +
+000332c0: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
+000332d0: 7275 6d65 6e74 5d5b 274c 4d27 5d0a 2020  rument]['LM'].  
+000332e0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000332f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033300: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+00033310: 756d 656e 745d 5b27 6465 7465 726d 696e  ument]['determin
+00033320: 6973 7469 6327 5d20 3d20 7365 6c66 2e6d  istic'] = self.m
+00033330: 6f64 656c 5b0a 2020 2020 2020 2020 2020  odel[.          
+00033340: 2020 2020 2020 2020 2020 696e 7374 7275            instru
+00033350: 6d65 6e74 5d5b 274d 275d 0a20 2020 2020  ment]['M'].     
+00033360: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
+00033370: 6c5b 696e 7374 7275 6d65 6e74 5d5b 0a20  l[instrument][. 
+00033380: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00033390: 6465 7465 726d 696e 6973 7469 635f 7661  deterministic_va
+000333a0: 7269 616e 6365 7327 5d20 3d20 7365 6c66  riances'] = self
+000333b0: 2e65 7272 6f72 735b 696e 7374 7275 6d65  .errors[instrume
+000333c0: 6e74 5d2a 2a32 202b 2028 0a20 2020 2020  nt]**2 + (.     
+000333d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000333e0: 6172 616d 6574 6572 5f76 616c 7565 735b  arameter_values[
+000333f0: 2773 6967 6d61 5f77 5f27 202b 2073 656c  'sigma_w_' + sel
+00033400: 662e 7369 676d 6177 5f69 6e61 6d65 5b69  f.sigmaw_iname[i
+00033410: 6e73 7472 756d 656e 745d 5d20 2a20 3165  nstrument]] * 1e
+00033420: 2d36 292a 2a32 0a20 2020 2020 2020 2020  -6)**2.         
+00033430: 2020 2023 2046 696e 616c 6c79 2c20 6966     # Finally, if
+00033440: 2074 6865 206d 6f64 656c 2075 6e64 6572   the model under
+00033450: 2063 6f6e 7369 6465 7261 7469 6f6e 2069   consideration i
+00033460: 7320 6120 676c 6f62 616c 206d 6f64 656c  s a global model
+00033470: 2c20 706f 7075 6c61 7465 2074 6865 2067  , populate the g
+00033480: 6c6f 6261 6c20 6d6f 6465 6c20 6469 6374  lobal model dict
+00033490: 696f 6e61 7279 3a0a 2020 2020 2020 2020  ionary:.        
+000334a0: 2020 2020 6966 2073 656c 662e 676c 6f62      if self.glob
+000334b0: 616c 5f6d 6f64 656c 3a0a 2020 2020 2020  al_model:.      
+000334c0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+000334d0: 6f64 656c 5b27 676c 6f62 616c 275d 5b73  odel['global'][s
+000334e0: 656c 662e 696e 7374 7275 6d65 6e74 5f69  elf.instrument_i
+000334f0: 6e64 6578 6573 5b0a 2020 2020 2020 2020  ndexes[.        
+00033500: 2020 2020 2020 2020 2020 2020 696e 7374              inst
+00033510: 7275 6d65 6e74 5d5d 203d 2073 656c 662e  rument]] = self.
+00033520: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
+00033530: 5d5b 2764 6574 6572 6d69 6e69 7374 6963  ]['deterministic
+00033540: 275d 0a20 2020 2020 2020 2020 2020 2020  '].             
+00033550: 2020 2069 6620 6576 616c 7561 7465 5f67     if evaluate_g
+00033560: 6c6f 6261 6c5f 6572 726f 7273 3a0a 2020  lobal_errors:.  
+00033570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033580: 2020 7365 6c66 2e6d 6f64 656c 5b27 676c    self.model['gl
+00033590: 6f62 616c 5f76 6172 6961 6e63 6573 275d  obal_variances']
+000335a0: 5b73 656c 662e 696e 7374 7275 6d65 6e74  [self.instrument
+000335b0: 5f69 6e64 6578 6573 5b69 6e73 7472 756d  _indexes[instrum
+000335c0: 656e 745d 5d20 3d20 7365 6c66 2e79 6572  ent]] = self.yer
+000335d0: 725b 7365 6c66 2e69 6e73 7472 756d 656e  r[self.instrumen
+000335e0: 745f 696e 6465 7865 735b 696e 7374 7275  t_indexes[instru
+000335f0: 6d65 6e74 5d5d 2a2a 3220 2b20 5c0a 2020  ment]]**2 + \.  
 00033600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033610: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
-00033620: 656c 5b27 676c 6f62 616c 5f76 6172 6961  el['global_varia
-00033630: 6e63 6573 275d 290a 2020 2020 2020 2020  nces']).        
-00033640: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00033650: 2020 6c6f 675f 6c69 6b65 203d 2030 2e30    log_like = 0.0
-00033660: 0a0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-00033670: 7220 696e 7374 7275 6d65 6e74 2069 6e20  r instrument in 
-00033680: 7365 6c66 2e69 6e61 6d65 733a 0a20 2020  self.inames:.   
-00033690: 2020 2020 2020 2020 2020 2020 2072 6573               res
-000336a0: 6964 7561 6c73 203d 2073 656c 662e 6461  iduals = self.da
-000336b0: 7461 5b69 6e73 7472 756d 656e 745d 202d  ta[instrument] -
-000336c0: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-000336d0: 7275 6d65 6e74 5d5b 0a20 2020 2020 2020  rument][.       
-000336e0: 2020 2020 2020 2020 2020 2020 2027 6465               'de
-000336f0: 7465 726d 696e 6973 7469 6327 5d0a 2020  terministic'].  
-00033700: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00033710: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-00033720: 5b69 6e73 7472 756d 656e 745d 5b27 4750  [instrument]['GP
-00033730: 4465 7472 656e 6427 5d3a 0a20 2020 2020  Detrend']:.     
-00033740: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00033750: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
-00033760: 6e73 7472 756d 656e 745d 5b0a 2020 2020  nstrument][.    
-00033770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033780: 2020 2020 276e 6f69 7365 5f6d 6f64 656c      'noise_model
-00033790: 275d 2e73 6574 5f70 6172 616d 6574 6572  '].set_parameter
-000337a0: 5f76 6563 746f 7228 7061 7261 6d65 7465  _vector(paramete
-000337b0: 725f 7661 6c75 6573 290a 2020 2020 2020  r_values).      
-000337c0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-000337d0: 4361 7463 6820 706f 7373 6962 6c65 2047  Catch possible G
-000337e0: 5020 6576 616c 7561 7469 6f6e 2065 7272  P evaluation err
-000337f0: 6f72 733a 0a20 2020 2020 2020 2020 2020  ors:.           
-00033800: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-00033810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033820: 2020 2020 2020 6c6f 675f 6c69 6b65 202b        log_like +
-00033830: 3d20 7365 6c66 2e64 6963 7469 6f6e 6172  = self.dictionar
-00033840: 795b 696e 7374 7275 6d65 6e74 5d5b 0a20  y[instrument][. 
+00033610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033650: 2020 2020 2020 2020 2870 6172 616d 6574          (paramet
+00033660: 6572 5f76 616c 7565 735b 2773 6967 6d61  er_values['sigma
+00033670: 5f77 5f27 2b69 6e73 7472 756d 656e 745d  _w_'+instrument]
+00033680: 2a31 652d 3629 2a2a 320a 0a20 2020 2064  *1e-6)**2..    d
+00033690: 6566 2067 6175 7373 6961 6e5f 6c6f 675f  ef gaussian_log_
+000336a0: 6c69 6b65 6c69 686f 6f64 2873 656c 662c  likelihood(self,
+000336b0: 2072 6573 6964 7561 6c73 2c20 7661 7269   residuals, vari
+000336c0: 616e 6365 7329 3a0a 0a20 2020 2020 2020  ances):..       
+000336d0: 2074 6175 7320 3d20 312e 202f 2076 6172   taus = 1. / var
+000336e0: 6961 6e63 6573 0a20 2020 2020 2020 2072  iances.        r
+000336f0: 6574 7572 6e20 2d30 2e35 202a 2028 6c65  eturn -0.5 * (le
+00033700: 6e28 7265 7369 6475 616c 7329 202a 206c  n(residuals) * l
+00033710: 6f67 3270 6920 2b20 6e70 2e73 756d 282d  og2pi + np.sum(-
+00033720: 6e70 2e6c 6f67 2874 6175 732e 6173 7479  np.log(taus.asty
+00033730: 7065 2866 6c6f 6174 2929 202b 2074 6175  pe(float)) + tau
+00033740: 7320 2a20 2872 6573 6964 7561 6c73 2a2a  s * (residuals**
+00033750: 3229 2929 0a0a 2020 2020 6465 6620 6765  2)))..    def ge
+00033760: 745f 6c6f 675f 6c69 6b65 6c69 686f 6f64  t_log_likelihood
+00033770: 2873 656c 662c 2070 6172 616d 6574 6572  (self, parameter
+00033780: 5f76 616c 7565 7329 3a0a 2020 2020 2020  _values):.      
+00033790: 2020 6966 2073 656c 662e 676c 6f62 616c    if self.global
+000337a0: 5f6d 6f64 656c 3a0a 2020 2020 2020 2020  _model:.        
+000337b0: 2020 2020 7265 7369 6475 616c 7320 3d20      residuals = 
+000337c0: 7365 6c66 2e79 202d 2073 656c 662e 6d6f  self.y - self.mo
+000337d0: 6465 6c5b 2767 6c6f 6261 6c27 5d0a 2020  del['global'].  
+000337e0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+000337f0: 662e 6469 6374 696f 6e61 7279 5b27 676c  f.dictionary['gl
+00033800: 6f62 616c 5f6d 6f64 656c 275d 5b27 4750  obal_model']['GP
+00033810: 4465 7472 656e 6427 5d3a 0a20 2020 2020  Detrend']:.     
+00033820: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00033830: 6469 6374 696f 6e61 7279 5b27 676c 6f62  dictionary['glob
+00033840: 616c 5f6d 6f64 656c 275d 5b0a 2020 2020  al_model'][.    
 00033850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033860: 2020 2020 2020 2020 2020 2027 6e6f 6973             'nois
-00033870: 655f 6d6f 6465 6c27 5d2e 4750 2e6c 6f67  e_model'].GP.log
-00033880: 5f6c 696b 656c 6968 6f6f 6428 7265 7369  _likelihood(resi
-00033890: 6475 616c 7329 0a20 2020 2020 2020 2020  duals).         
-000338a0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-000338b0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-000338c0: 2020 2020 2020 2020 2020 206c 6f67 5f6c             log_l
-000338d0: 696b 6520 3d20 2d6e 702e 696e 660a 2020  ike = -np.inf.  
-000338e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000338f0: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
-00033900: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00033910: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-00033920: 2020 2020 2020 206c 6f67 5f6c 696b 6520         log_like 
-00033930: 2b3d 2073 656c 662e 6761 7573 7369 616e  += self.gaussian
-00033940: 5f6c 6f67 5f6c 696b 656c 6968 6f6f 6428  _log_likelihood(
-00033950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033960: 2020 2020 2020 2020 2072 6573 6964 7561           residua
-00033970: 6c73 2c0a 2020 2020 2020 2020 2020 2020  ls,.            
-00033980: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00033990: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
-000339a0: 745d 5b27 6465 7465 726d 696e 6973 7469  t]['deterministi
-000339b0: 635f 7661 7269 616e 6365 7327 5d29 0a0a  c_variances'])..
-000339c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000339d0: 726e 206c 6f67 5f6c 696b 650a 0a20 2020  rn log_like..   
-000339e0: 2064 6566 2073 6574 5f70 6f73 7465 7269   def set_posteri
-000339f0: 6f72 5f73 616d 706c 6573 2873 656c 662c  or_samples(self,
-00033a00: 2070 6f73 7465 7269 6f72 5f73 616d 706c   posterior_sampl
-00033a10: 6573 293a 0a20 2020 2020 2020 2073 656c  es):.        sel
-00033a20: 662e 706f 7374 6572 696f 7273 203d 2070  f.posteriors = p
-00033a30: 6f73 7465 7269 6f72 5f73 616d 706c 6573  osterior_samples
-00033a40: 0a20 2020 2020 2020 2073 656c 662e 6d65  .        self.me
-00033a50: 6469 616e 5f70 6f73 7465 7269 6f72 5f73  dian_posterior_s
-00033a60: 616d 706c 6573 203d 207b 7d0a 2020 2020  amples = {}.    
-00033a70: 2020 2020 666f 7220 7061 7261 6d65 7465      for paramete
-00033a80: 7220 696e 2073 656c 662e 706f 7374 6572  r in self.poster
-00033a90: 696f 7273 2e6b 6579 7328 293a 0a0a 2020  iors.keys():..  
-00033aa0: 2020 2020 2020 2020 2020 6966 2070 6172            if par
-00033ab0: 616d 6574 6572 2021 3d20 2775 6e6e 616d  ameter != 'unnam
-00033ac0: 6564 273a 0a20 2020 2020 2020 2020 2020  ed':.           
-00033ad0: 2020 2020 2073 656c 662e 6d65 6469 616e       self.median
-00033ae0: 5f70 6f73 7465 7269 6f72 5f73 616d 706c  _posterior_sampl
-00033af0: 6573 5b70 6172 616d 6574 6572 5d20 3d20  es[parameter] = 
-00033b00: 6e70 2e6d 6564 6961 6e28 7365 6c66 2e70  np.median(self.p
-00033b10: 6f73 7465 7269 6f72 735b 7061 7261 6d65  osteriors[parame
-00033b20: 7465 725d 290a 0a20 2020 2020 2020 2066  ter])..        f
-00033b30: 6f72 2070 6172 616d 6574 6572 2069 6e20  or parameter in 
-00033b40: 7365 6c66 2e70 7269 6f72 733a 0a20 2020  self.priors:.   
-00033b50: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00033b60: 2e70 7269 6f72 735b 7061 7261 6d65 7465  .priors[paramete
-00033b70: 725d 5b27 6469 7374 7269 6275 7469 6f6e  r]['distribution
-00033b80: 275d 203d 3d20 2766 6978 6564 273a 0a20  '] == 'fixed':. 
-00033b90: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00033ba0: 656c 662e 6d65 6469 616e 5f70 6f73 7465  elf.median_poste
-00033bb0: 7269 6f72 5f73 616d 706c 6573 5b70 6172  rior_samples[par
-00033bc0: 616d 6574 6572 5d20 3d20 7365 6c66 2e70  ameter] = self.p
-00033bd0: 7269 6f72 735b 0a20 2020 2020 2020 2020  riors[.         
-00033be0: 2020 2020 2020 2020 2020 2070 6172 616d             param
-00033bf0: 6574 6572 5d5b 2768 7970 6572 7061 7261  eter]['hyperpara
-00033c00: 6d65 7465 7273 275d 0a20 2020 2020 2020  meters'].       
-00033c10: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-00033c20: 2020 7365 6c66 2e67 656e 6572 6174 6528    self.generate(
-00033c30: 7365 6c66 2e6d 6564 6961 6e5f 706f 7374  self.median_post
-00033c40: 6572 696f 725f 7361 6d70 6c65 7329 0a20  erior_samples). 
-00033c50: 2020 2020 2020 2065 7863 6570 743a 0a20         except:. 
-00033c60: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00033c70: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00033c80: 2020 2757 6172 6e69 6e67 3a20 6d6f 6465    'Warning: mode
-00033c90: 6c20 6576 616c 7561 7465 6420 6174 2074  l evaluated at t
-00033ca0: 6865 2070 6f73 7465 7269 6f72 206d 6564  he posterior med
-00033cb0: 6961 6e20 6469 6420 6e6f 7420 636f 6d70  ian did not comp
-00033cc0: 7574 6520 7072 6f70 6572 6c79 2e27 0a20  ute properly.'. 
-00033cd0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00033ce0: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-00033cf0: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-00033d00: 2020 2020 2020 6461 7461 2c0a 2020 2020        data,.    
-00033d10: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-00033d20: 656c 7479 7065 2c0a 2020 2020 2020 2020  eltype,.        
-00033d30: 2020 2020 2020 2020 2070 6c3d 302e 302c           pl=0.0,
-00033d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033d50: 2020 7075 3d31 2e30 2c0a 2020 2020 2020    pu=1.0,.      
-00033d60: 2020 2020 2020 2020 2020 2065 6363 6c69             eccli
-00033d70: 6d3d 312e 2c0a 2020 2020 2020 2020 2020  m=1.,.          
-00033d80: 2020 2020 2020 2074 613d 3234 3538 3436         ta=245846
-00033d90: 302e 2c0a 2020 2020 2020 2020 2020 2020  0.,.            
-00033da0: 2020 2020 206c 6967 6874 5f74 7261 7665       light_trave
-00033db0: 6c5f 6465 6c61 7920 3d20 4661 6c73 652c  l_delay = False,
-00033dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033dd0: 2020 7374 656c 6c61 725f 7261 6469 7573    stellar_radius
-00033de0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00033df0: 2020 2020 2020 2020 2020 6c6f 675f 6c69            log_li
-00033e00: 6b65 5f63 616c 633d 4661 6c73 6529 3a0a  ke_calc=False):.
-00033e10: 2020 2020 2020 2020 2320 496e 6865 7274          # Inhert
-00033e20: 2074 6865 2070 7269 6f72 7320 6469 6374   the priors dict
-00033e30: 696f 6e61 7279 2066 726f 6d20 6461 7461  ionary from data
-00033e40: 3a0a 2020 2020 2020 2020 7365 6c66 2e70  :.        self.p
-00033e50: 7269 6f72 7320 3d20 6461 7461 2e70 7269  riors = data.pri
-00033e60: 6f72 730a 2020 2020 2020 2020 2320 4465  ors.        # De
-00033e70: 6669 6e65 2074 6865 2065 6363 6c69 6d20  fine the ecclim 
-00033e80: 7661 6c75 653a 0a20 2020 2020 2020 2073  value:.        s
-00033e90: 656c 662e 6563 636c 696d 203d 2065 6363  elf.ecclim = ecc
-00033ea0: 6c69 6d0a 2020 2020 2020 2020 2320 4465  lim.        # De
-00033eb0: 6669 6e65 2074 613a 0a20 2020 2020 2020  fine ta:.       
-00033ec0: 2073 656c 662e 7461 203d 2074 610a 2020   self.ta = ta.  
-00033ed0: 2020 2020 2020 2320 4465 6669 6e65 206c        # Define l
-00033ee0: 6967 6874 2074 7261 7665 6c20 7469 6d65  ight travel time
-00033ef0: 206f 7074 696f 6e3a 0a20 2020 2020 2020   option:.       
-00033f00: 2073 656c 662e 6c69 6768 745f 7472 6176   self.light_trav
-00033f10: 656c 5f64 656c 6179 203d 206c 6967 6874  el_delay = light
-00033f20: 5f74 7261 7665 6c5f 6465 6c61 790a 2020  _travel_delay.  
-00033f30: 2020 2020 2020 6966 2073 656c 662e 6c69        if self.li
-00033f40: 6768 745f 7472 6176 656c 5f64 656c 6179  ght_travel_delay
-00033f50: 2061 6e64 2028 7374 656c 6c61 725f 7261   and (stellar_ra
-00033f60: 6469 7573 2069 7320 4e6f 6e65 293a 0a0a  dius is None):..
-00033f70: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00033f80: 6520 4578 6365 7074 696f 6e28 2745 7272  e Exception('Err
-00033f90: 6f72 3a20 6966 206c 6967 6874 5f74 7261  or: if light_tra
-00033fa0: 7665 6c5f 6465 6c61 7920 6973 2061 6374  vel_delay is act
-00033fb0: 6976 6174 6564 2c20 6120 7374 656c 6c61  ivated, a stella
-00033fc0: 7220 7261 6469 7573 206e 6565 6473 2074  r radius needs t
-00033fd0: 6f20 6265 2067 6976 656e 2061 7320 7765  o be given as we
-00033fe0: 6c6c 2076 6961 2073 7465 6c6c 6172 5f72  ll via stellar_r
-00033ff0: 6164 6975 7320 3d20 796f 7572 7661 6c75  adius = yourvalu
-00034000: 653b 2065 2e67 2e2c 2064 6174 6173 6574  e; e.g., dataset
-00034010: 2e66 6974 282e 2e2e 2c20 6c69 6768 745f  .fit(..., light_
-00034020: 7472 6176 656c 5f64 656c 6179 203d 2054  travel_delay = T
-00034030: 7275 652c 2073 7465 6c6c 6172 5f72 6164  rue, stellar_rad
-00034040: 6975 7320 3d20 312e 3132 3334 292e 2729  ius = 1.1234).')
-00034050: 0a0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-00034060: 7465 6c6c 6172 5f72 6164 6975 7320 3d20  tellar_radius = 
-00034070: 7374 656c 6c61 725f 7261 6469 7573 0a0a  stellar_radius..
-00034080: 2020 2020 2020 2020 2320 5361 7665 2074          # Save t
-00034090: 6865 206c 6f67 5f6c 696b 655f 6361 6c63  he log_like_calc
-000340a0: 2062 6f6f 6c65 616e 3a0a 2020 2020 2020   boolean:.      
-000340b0: 2020 7365 6c66 2e6c 6f67 5f6c 696b 655f    self.log_like_
-000340c0: 6361 6c63 203d 206c 6f67 5f6c 696b 655f  calc = log_like_
-000340d0: 6361 6c63 0a20 2020 2020 2020 2023 2044  calc.        # D
-000340e0: 6566 696e 6520 7661 7269 6162 6c65 2074  efine variable t
-000340f0: 6861 7420 6174 2065 6163 6820 6974 6572  hat at each iter
-00034100: 6174 696f 6e20 6465 6669 6e65 7320 6966  ation defines if
-00034110: 2074 6865 206d 6f64 656c 2069 7320 4f4b   the model is OK
-00034120: 206f 7220 6e6f 7420 286e 6f74 204f 4b20   or not (not OK 
-00034130: 6d65 616e 7320 736f 6d65 7468 696e 6720  means something 
-00034140: 6661 696c 6564 2069 6e20 7465 726d 7320  failed in terms 
-00034150: 6f66 2074 6865 0a20 2020 2020 2020 2023  of the.        #
-00034160: 2070 6172 616d 6574 6572 2073 7061 6365   parameter space
-00034170: 2062 6569 6e67 2065 7870 6c6f 7265 6429   being explored)
-00034180: 3a0a 2020 2020 2020 2020 7365 6c66 2e6d  :.        self.m
-00034190: 6f64 656c 4f4b 203d 2054 7275 650a 2020  odelOK = True.  
-000341a0: 2020 2020 2020 2320 4465 6669 6e65 2061        # Define a
-000341b0: 2076 6172 6961 626c 6520 7468 6174 2077   variable that w
-000341c0: 696c 6c20 7361 7665 2074 6865 2070 6f73  ill save the pos
-000341d0: 7465 7269 6f72 2073 616d 706c 6573 3a0a  terior samples:.
-000341e0: 2020 2020 2020 2020 7365 6c66 2e70 6f73          self.pos
-000341f0: 7465 7269 6f72 7320 3d20 4e6f 6e65 0a20  teriors = None. 
-00034200: 2020 2020 2020 2073 656c 662e 6d65 6469         self.medi
-00034210: 616e 5f70 6f73 7465 7269 6f72 5f73 616d  an_posterior_sam
-00034220: 706c 6573 203d 204e 6f6e 650a 2020 2020  ples = None.    
-00034230: 2020 2020 2320 4e75 6d62 6572 206f 6620      # Number of 
-00034240: 6461 7461 706f 696e 7473 2070 6572 2069  datapoints per i
-00034250: 6e73 7472 756d 656e 7420 7661 7269 6162  nstrument variab
-00034260: 6c65 3a0a 2020 2020 2020 2020 7365 6c66  le:.        self
-00034270: 2e6e 6461 7461 706f 696e 7473 5f70 6572  .ndatapoints_per
-00034280: 5f69 6e73 7472 756d 656e 7420 3d20 7b7d  _instrument = {}
-00034290: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
-000342a0: 6c74 7970 6520 3d3d 2027 6c63 273a 0a20  ltype == 'lc':. 
-000342b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000342c0: 6d6f 6465 6c74 7970 6520 3d20 276c 6327  modeltype = 'lc'
-000342d0: 0a20 2020 2020 2020 2020 2020 2023 2049  .            # I
-000342e0: 6e68 6572 7420 7469 6d65 732c 2066 6c75  nhert times, flu
-000342f0: 7865 732c 2065 7272 6f72 732c 2069 6e64  xes, errors, ind
-00034300: 6578 6573 2c20 6574 632e 2066 726f 6d20  exes, etc. from 
-00034310: 6461 7461 2e0a 2020 2020 2020 2020 2020  data..          
-00034320: 2020 2320 4659 492c 2069 6e20 6361 7365    # FYI, in case
-00034330: 2074 6869 7320 7365 656d 7320 636f 6e66   this seems conf
-00034340: 7573 696e 673a 2073 656c 662e 742c 2073  using: self.t, s
-00034350: 656c 662e 7920 616e 6420 7365 6c66 2e79  elf.y and self.y
-00034360: 6572 7220 7361 7665 2077 6861 7420 7765  err save what we
-00034370: 2069 6e74 6572 6e61 6c6c 7920 6361 6c6c   internally call
-00034380: 0a20 2020 2020 2020 2020 2020 2023 2022  .            # "
-00034390: 676c 6f62 616c 2220 6461 7461 2d61 7272  global" data-arr
-000343a0: 6179 732e 2054 6865 7365 2068 6176 6520  ays. These have 
-000343b0: 7468 6520 6461 7461 2066 726f 6d20 616c  the data from al
-000343c0: 6c20 7468 6520 696e 7374 7275 6d65 6e74  l the instrument
-000343d0: 7320 7374 6163 6b65 6420 696e 746f 2061  s stacked into a
-000343e0: 6e20 6172 7261 793b 2074 6f20 7265 636f  n array; to reco
-000343f0: 7665 720a 2020 2020 2020 2020 2020 2020  ver.            
-00034400: 2320 7468 6520 6461 7461 2066 6f72 2061  # the data for a
-00034410: 2067 6976 656e 2069 6e73 7472 756d 656e   given instrumen
-00034420: 742c 206f 6e65 2075 7365 7320 7468 6520  t, one uses the 
-00034430: 7365 6c66 2e69 6e73 7472 756d 656e 745f  self.instrument_
-00034440: 696e 6465 7865 7320 6469 6374 696f 6e61  indexes dictiona
-00034450: 7279 2e20 4f6e 2074 6865 206f 7468 6572  ry. On the other
-00034460: 2068 616e 642c 0a20 2020 2020 2020 2020   hand,.         
-00034470: 2020 2023 2073 656c 662e 7469 6d65 732c     # self.times,
-00034480: 2073 656c 662e 6461 7461 2061 6e64 2073   self.data and s
-00034490: 656c 662e 6572 726f 7273 2061 7265 2064  elf.errors are d
-000344a0: 6963 7469 6f6e 6172 6965 7320 7468 6174  ictionaries that
-000344b0: 206f 6e20 6561 6368 206b 6579 2068 6176   on each key hav
-000344c0: 6520 7468 6520 6461 7461 206f 6620 6120  e the data of a 
-000344d0: 6769 7665 6e20 696e 7374 7275 6d65 6e74  given instrument
-000344e0: 2e0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-000344f0: 4361 6c6c 696e 6720 6469 6374 696f 6e61  Calling dictiona
-00034500: 7269 6573 2069 7320 6661 7374 6572 2074  ries is faster t
-00034510: 6861 6e20 6361 6c6c 696e 6720 696e 6465  han calling inde
-00034520: 7865 7320 6f66 2061 7272 6179 732c 2073  xes of arrays, s
-00034530: 6f20 7765 2075 7365 2074 6865 206c 6174  o we use the lat
-00034540: 7465 7220 696e 2067 656e 6572 616c 2074  ter in general t
-00034550: 6f20 6576 616c 7561 7465 206d 6f64 656c  o evaluate model
-00034560: 732e 0a20 2020 2020 2020 2020 2020 2073  s..            s
-00034570: 656c 662e 7420 3d20 6461 7461 2e74 5f6c  elf.t = data.t_l
-00034580: 630a 2020 2020 2020 2020 2020 2020 7365  c.            se
-00034590: 6c66 2e79 203d 2064 6174 612e 795f 6c63  lf.y = data.y_lc
-000345a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000345b0: 662e 7965 7272 203d 2064 6174 612e 7965  f.yerr = data.ye
-000345c0: 7272 5f6c 630a 2020 2020 2020 2020 2020  rr_lc.          
-000345d0: 2020 7365 6c66 2e74 696d 6573 203d 2064    self.times = d
-000345e0: 6174 612e 7469 6d65 735f 6c63 0a20 2020  ata.times_lc.   
-000345f0: 2020 2020 2020 2020 2073 656c 662e 6461           self.da
-00034600: 7461 203d 2064 6174 612e 6461 7461 5f6c  ta = data.data_l
-00034610: 630a 2020 2020 2020 2020 2020 2020 7365  c.            se
-00034620: 6c66 2e65 7272 6f72 7320 3d20 6461 7461  lf.errors = data
-00034630: 2e65 7272 6f72 735f 6c63 0a20 2020 2020  .errors_lc.     
-00034640: 2020 2020 2020 2073 656c 662e 696e 7374         self.inst
-00034650: 7275 6d65 6e74 7320 3d20 6461 7461 2e69  ruments = data.i
-00034660: 6e73 7472 756d 656e 7473 5f6c 630a 2020  nstruments_lc.  
-00034670: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
-00034680: 696e 7374 7275 6d65 6e74 7320 3d20 6461  instruments = da
-00034690: 7461 2e6e 696e 7374 7275 6d65 6e74 735f  ta.ninstruments_
-000346a0: 6c63 0a20 2020 2020 2020 2020 2020 2073  lc.            s
-000346b0: 656c 662e 696e 616d 6573 203d 2064 6174  elf.inames = dat
-000346c0: 612e 696e 616d 6573 5f6c 630a 2020 2020  a.inames_lc.    
-000346d0: 2020 2020 2020 2020 7365 6c66 2e69 6e73          self.ins
-000346e0: 7472 756d 656e 745f 696e 6465 7865 7320  trument_indexes 
-000346f0: 3d20 6461 7461 2e69 6e73 7472 756d 656e  = data.instrumen
-00034700: 745f 696e 6465 7865 735f 6c63 0a20 2020  t_indexes_lc.   
-00034710: 2020 2020 2020 2020 2073 656c 662e 6c6d           self.lm
-00034720: 5f62 6f6f 6c65 616e 203d 2064 6174 612e  _boolean = data.
-00034730: 6c6d 5f6c 635f 626f 6f6c 6561 6e0a 2020  lm_lc_boolean.  
-00034740: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-00034750: 6d5f 6172 6775 6d65 6e74 7320 3d20 6461  m_arguments = da
-00034760: 7461 2e6c 6d5f 6c63 5f61 7267 756d 656e  ta.lm_lc_argumen
-00034770: 7473 0a20 2020 2020 2020 2020 2020 2073  ts.            s
-00034780: 656c 662e 6c6d 5f6e 203d 207b 7d0a 2020  elf.lm_n = {}.  
-00034790: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-000347a0: 6c20 3d20 706c 0a20 2020 2020 2020 2020  l = pl.         
-000347b0: 2020 2073 656c 662e 7075 203d 2070 750a     self.pu = pu.
-000347c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000347d0: 2e41 7220 3d20 2873 656c 662e 7075 202d  .Ar = (self.pu -
-000347e0: 2073 656c 662e 706c 2920 2f20 2832 2e20   self.pl) / (2. 
-000347f0: 2b20 7365 6c66 2e70 6c20 2b20 7365 6c66  + self.pl + self
-00034800: 2e70 7529 0a20 2020 2020 2020 2020 2020  .pu).           
-00034810: 2073 656c 662e 676c 6f62 616c 5f6d 6f64   self.global_mod
-00034820: 656c 203d 2064 6174 612e 676c 6f62 616c  el = data.global
-00034830: 5f6c 635f 6d6f 6465 6c0a 2020 2020 2020  _lc_model.      
-00034840: 2020 2020 2020 7365 6c66 2e64 6963 7469        self.dicti
-00034850: 6f6e 6172 7920 3d20 6461 7461 2e6c 635f  onary = data.lc_
-00034860: 6f70 7469 6f6e 730a 2020 2020 2020 2020  options.        
-00034870: 2020 2020 7365 6c66 2e6e 756d 6265 7269      self.numberi
-00034880: 6e67 203d 2064 6174 612e 6e75 6d62 6572  ng = data.number
-00034890: 696e 675f 7472 616e 7369 7469 6e67 5f70  ing_transiting_p
-000348a0: 6c61 6e65 7473 0a20 2020 2020 2020 2020  lanets.         
-000348b0: 2020 2073 656c 662e 6e75 6d62 6572 696e     self.numberin
-000348c0: 672e 736f 7274 2829 0a20 2020 2020 2020  g.sort().       
-000348d0: 2020 2020 2073 656c 662e 6e70 6c61 6e65       self.nplane
-000348e0: 7473 203d 206c 656e 2873 656c 662e 6e75  ts = len(self.nu
-000348f0: 6d62 6572 696e 6729 0a20 2020 2020 2020  mbering).       
-00034900: 2020 2020 2073 656c 662e 6d6f 6465 6c20       self.model 
-00034910: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
-00034920: 2023 2046 6972 7374 2c20 6966 2061 2067   # First, if a g
-00034930: 6c6f 6261 6c20 6d6f 6465 6c2c 2067 656e  lobal model, gen
-00034940: 6572 6174 6520 6172 7261 7920 7468 6174  erate array that
-00034950: 2077 696c 6c20 7361 7665 2074 6869 733a   will save this:
-00034960: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00034970: 7365 6c66 2e67 6c6f 6261 6c5f 6d6f 6465  self.global_mode
-00034980: 6c3a 0a20 2020 2020 2020 2020 2020 2020  l:.             
-00034990: 2020 2073 656c 662e 6d6f 6465 6c5b 2767     self.model['g
-000349a0: 6c6f 6261 6c27 5d20 3d20 6e70 2e7a 6572  lobal'] = np.zer
-000349b0: 6f73 286c 656e 2873 656c 662e 7429 290a  os(len(self.t)).
-000349c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000349d0: 7365 6c66 2e6d 6f64 656c 5b27 676c 6f62  self.model['glob
-000349e0: 616c 5f76 6172 6961 6e63 6573 275d 203d  al_variances'] =
-000349f0: 206e 702e 7a65 726f 7328 6c65 6e28 7365   np.zeros(len(se
-00034a00: 6c66 2e74 2929 0a20 2020 2020 2020 2020  lf.t)).         
-00034a10: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
-00034a20: 6c5b 2764 6574 6572 6d69 6e69 7374 6963  l['deterministic
-00034a30: 275d 203d 206e 702e 7a65 726f 7328 6c65  '] = np.zeros(le
-00034a40: 6e28 7365 6c66 2e74 2929 0a20 2020 2020  n(self.t)).     
-00034a50: 2020 2020 2020 2023 2049 6620 6c69 6d62         # If limb
-00034a60: 2d64 6172 6b65 6e69 6e67 2c20 6469 6c75  -darkening, dilu
-00034a70: 7469 6f6e 2066 6163 746f 7273 206f 7220  tion factors or 
-00034a80: 6563 6c69 7073 6520 6465 7074 6820 7769  eclipse depth wi
-00034a90: 6c6c 2062 6520 7368 6172 6564 2062 7920  ll be shared by 
-00034aa0: 6469 6666 6572 656e 7420 696e 7374 7275  different instru
-00034ab0: 6d65 6e74 732c 2073 6574 2074 6865 2063  ments, set the c
-00034ac0: 6f72 7265 6374 2076 6172 6961 626c 6520  orrect variable 
-00034ad0: 6e61 6d65 2066 6f72 2065 6163 683a 0a20  name for each:. 
+00033860: 276e 6f69 7365 5f6d 6f64 656c 275d 2e73  'noise_model'].s
+00033870: 6574 5f70 6172 616d 6574 6572 5f76 6563  et_parameter_vec
+00033880: 746f 7228 7061 7261 6d65 7465 725f 7661  tor(parameter_va
+00033890: 6c75 6573 290a 2020 2020 2020 2020 2020  lues).          
+000338a0: 2020 2020 2020 7365 6c66 2e64 6963 7469        self.dicti
+000338b0: 6f6e 6172 795b 2767 6c6f 6261 6c5f 6d6f  onary['global_mo
+000338c0: 6465 6c27 5d5b 276e 6f69 7365 5f6d 6f64  del']['noise_mod
+000338d0: 656c 275d 2e79 6572 7220 3d20 6e70 2e73  el'].yerr = np.s
+000338e0: 7172 7428 0a20 2020 2020 2020 2020 2020  qrt(.           
+000338f0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
+00033900: 6465 6c5b 2767 6c6f 6261 6c5f 7661 7269  del['global_vari
+00033910: 616e 6365 7327 5d29 0a20 2020 2020 2020  ances']).       
+00033920: 2020 2020 2020 2020 2073 656c 662e 6469           self.di
+00033930: 6374 696f 6e61 7279 5b27 676c 6f62 616c  ctionary['global
+00033940: 5f6d 6f64 656c 275d 5b27 6e6f 6973 655f  _model']['noise_
+00033950: 6d6f 6465 6c27 5d2e 636f 6d70 7574 655f  model'].compute_
+00033960: 4750 2829 0a20 2020 2020 2020 2020 2020  GP().           
+00033970: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00033980: 2e64 6963 7469 6f6e 6172 795b 2767 6c6f  .dictionary['glo
+00033990: 6261 6c5f 6d6f 6465 6c27 5d5b 0a20 2020  bal_model'][.   
+000339a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000339b0: 2027 6e6f 6973 655f 6d6f 6465 6c27 5d2e   'noise_model'].
+000339c0: 4750 2e6c 6f67 5f6c 696b 656c 6968 6f6f  GP.log_likelihoo
+000339d0: 6428 7265 7369 6475 616c 7329 0a20 2020  d(residuals).   
+000339e0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+000339f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00033a00: 656c 662e 6761 7573 7369 616e 5f6c 6f67  elf.gaussian_log
+00033a10: 5f6c 696b 656c 6968 6f6f 6428 7265 7369  _likelihood(resi
+00033a20: 6475 616c 732c 0a20 2020 2020 2020 2020  duals,.         
+00033a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033a50: 2020 2020 7365 6c66 2e6d 6f64 656c 5b27      self.model['
+00033a60: 676c 6f62 616c 5f76 6172 6961 6e63 6573  global_variances
+00033a70: 275d 290a 2020 2020 2020 2020 656c 7365  ']).        else
+00033a80: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
+00033a90: 675f 6c69 6b65 203d 2030 2e30 0a0a 2020  g_like = 0.0..  
+00033aa0: 2020 2020 2020 2020 2020 666f 7220 696e            for in
+00033ab0: 7374 7275 6d65 6e74 2069 6e20 7365 6c66  strument in self
+00033ac0: 2e69 6e61 6d65 733a 0a20 2020 2020 2020  .inames:.       
+00033ad0: 2020 2020 2020 2020 2072 6573 6964 7561           residua
+00033ae0: 6c73 203d 2073 656c 662e 6461 7461 5b69  ls = self.data[i
+00033af0: 6e73 7472 756d 656e 745d 202d 2073 656c  nstrument] - sel
+00033b00: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+00033b10: 6e74 5d5b 0a20 2020 2020 2020 2020 2020  nt][.           
+00033b20: 2020 2020 2020 2020 2027 6465 7465 726d           'determ
+00033b30: 696e 6973 7469 6327 5d0a 2020 2020 2020  inistic'].      
+00033b40: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00033b50: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
+00033b60: 7472 756d 656e 745d 5b27 4750 4465 7472  trument]['GPDetr
+00033b70: 656e 6427 5d3a 0a20 2020 2020 2020 2020  end']:.         
+00033b80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00033b90: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
+00033ba0: 756d 656e 745d 5b0a 2020 2020 2020 2020  ument][.        
+00033bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033bc0: 276e 6f69 7365 5f6d 6f64 656c 275d 2e73  'noise_model'].s
+00033bd0: 6574 5f70 6172 616d 6574 6572 5f76 6563  et_parameter_vec
+00033be0: 746f 7228 7061 7261 6d65 7465 725f 7661  tor(parameter_va
+00033bf0: 6c75 6573 290a 2020 2020 2020 2020 2020  lues).          
+00033c00: 2020 2020 2020 2020 2020 2320 4361 7463            # Catc
+00033c10: 6820 706f 7373 6962 6c65 2047 5020 6576  h possible GP ev
+00033c20: 616c 7561 7469 6f6e 2065 7272 6f72 733a  aluation errors:
+00033c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033c40: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00033c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033c60: 2020 6c6f 675f 6c69 6b65 202b 3d20 7365    log_like += se
+00033c70: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
+00033c80: 7374 7275 6d65 6e74 5d5b 0a20 2020 2020  strument][.     
+00033c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033ca0: 2020 2020 2020 2027 6e6f 6973 655f 6d6f         'noise_mo
+00033cb0: 6465 6c27 5d2e 4750 2e6c 6f67 5f6c 696b  del'].GP.log_lik
+00033cc0: 656c 6968 6f6f 6428 7265 7369 6475 616c  elihood(residual
+00033cd0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+00033ce0: 2020 2020 2020 2065 7863 6570 743a 0a20         except:. 
+00033cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033d00: 2020 2020 2020 206c 6f67 5f6c 696b 6520         log_like 
+00033d10: 3d20 2d6e 702e 696e 660a 2020 2020 2020  = -np.inf.      
+00033d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033d30: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+00033d40: 2020 2020 2020 2020 656c 7365 3a0a 0a20          else:.. 
+00033d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033d60: 2020 206c 6f67 5f6c 696b 6520 2b3d 2073     log_like += s
+00033d70: 656c 662e 6761 7573 7369 616e 5f6c 6f67  elf.gaussian_log
+00033d80: 5f6c 696b 656c 6968 6f6f 6428 0a20 2020  _likelihood(.   
+00033d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033da0: 2020 2020 2072 6573 6964 7561 6c73 2c0a       residuals,.
+00033db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033dc0: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+00033dd0: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
+00033de0: 6465 7465 726d 696e 6973 7469 635f 7661  deterministic_va
+00033df0: 7269 616e 6365 7327 5d29 0a0a 2020 2020  riances'])..    
+00033e00: 2020 2020 2020 2020 7265 7475 726e 206c          return l
+00033e10: 6f67 5f6c 696b 650a 0a20 2020 2064 6566  og_like..    def
+00033e20: 2073 6574 5f70 6f73 7465 7269 6f72 5f73   set_posterior_s
+00033e30: 616d 706c 6573 2873 656c 662c 2070 6f73  amples(self, pos
+00033e40: 7465 7269 6f72 5f73 616d 706c 6573 293a  terior_samples):
+00033e50: 0a20 2020 2020 2020 2073 656c 662e 706f  .        self.po
+00033e60: 7374 6572 696f 7273 203d 2070 6f73 7465  steriors = poste
+00033e70: 7269 6f72 5f73 616d 706c 6573 0a20 2020  rior_samples.   
+00033e80: 2020 2020 2073 656c 662e 6d65 6469 616e       self.median
+00033e90: 5f70 6f73 7465 7269 6f72 5f73 616d 706c  _posterior_sampl
+00033ea0: 6573 203d 207b 7d0a 2020 2020 2020 2020  es = {}.        
+00033eb0: 666f 7220 7061 7261 6d65 7465 7220 696e  for parameter in
+00033ec0: 2073 656c 662e 706f 7374 6572 696f 7273   self.posteriors
+00033ed0: 2e6b 6579 7328 293a 0a0a 2020 2020 2020  .keys():..      
+00033ee0: 2020 2020 2020 6966 2070 6172 616d 6574        if paramet
+00033ef0: 6572 2021 3d20 2775 6e6e 616d 6564 273a  er != 'unnamed':
+00033f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033f10: 2073 656c 662e 6d65 6469 616e 5f70 6f73   self.median_pos
+00033f20: 7465 7269 6f72 5f73 616d 706c 6573 5b70  terior_samples[p
+00033f30: 6172 616d 6574 6572 5d20 3d20 6e70 2e6d  arameter] = np.m
+00033f40: 6564 6961 6e28 7365 6c66 2e70 6f73 7465  edian(self.poste
+00033f50: 7269 6f72 735b 7061 7261 6d65 7465 725d  riors[parameter]
+00033f60: 290a 0a20 2020 2020 2020 2066 6f72 2070  )..        for p
+00033f70: 6172 616d 6574 6572 2069 6e20 7365 6c66  arameter in self
+00033f80: 2e70 7269 6f72 733a 0a20 2020 2020 2020  .priors:.       
+00033f90: 2020 2020 2069 6620 7365 6c66 2e70 7269       if self.pri
+00033fa0: 6f72 735b 7061 7261 6d65 7465 725d 5b27  ors[parameter]['
+00033fb0: 6469 7374 7269 6275 7469 6f6e 275d 203d  distribution'] =
+00033fc0: 3d20 2766 6978 6564 273a 0a20 2020 2020  = 'fixed':.     
+00033fd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00033fe0: 6d65 6469 616e 5f70 6f73 7465 7269 6f72  median_posterior
+00033ff0: 5f73 616d 706c 6573 5b70 6172 616d 6574  _samples[paramet
+00034000: 6572 5d20 3d20 7365 6c66 2e70 7269 6f72  er] = self.prior
+00034010: 735b 0a20 2020 2020 2020 2020 2020 2020  s[.             
+00034020: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
+00034030: 5d5b 2768 7970 6572 7061 7261 6d65 7465  ]['hyperparamete
+00034040: 7273 275d 0a20 2020 2020 2020 2074 7279  rs'].        try
+00034050: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00034060: 6c66 2e67 656e 6572 6174 6528 7365 6c66  lf.generate(self
+00034070: 2e6d 6564 6961 6e5f 706f 7374 6572 696f  .median_posterio
+00034080: 725f 7361 6d70 6c65 7329 0a20 2020 2020  r_samples).     
+00034090: 2020 2065 7863 6570 743a 0a20 2020 2020     except:.     
+000340a0: 2020 2020 2020 2070 7269 6e74 280a 2020         print(.  
+000340b0: 2020 2020 2020 2020 2020 2020 2020 2757                'W
+000340c0: 6172 6e69 6e67 3a20 6d6f 6465 6c20 6576  arning: model ev
+000340d0: 616c 7561 7465 6420 6174 2074 6865 2070  aluated at the p
+000340e0: 6f73 7465 7269 6f72 206d 6564 6961 6e20  osterior median 
+000340f0: 6469 6420 6e6f 7420 636f 6d70 7574 6520  did not compute 
+00034100: 7072 6f70 6572 6c79 2e27 0a20 2020 2020  properly.'.     
+00034110: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00034120: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+00034130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034140: 2020 6461 7461 2c0a 2020 2020 2020 2020    data,.        
+00034150: 2020 2020 2020 2020 206d 6f64 656c 7479           modelty
+00034160: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+00034170: 2020 2020 2070 6c3d 302e 302c 0a20 2020       pl=0.0,.   
+00034180: 2020 2020 2020 2020 2020 2020 2020 7075                pu
+00034190: 3d31 2e30 2c0a 2020 2020 2020 2020 2020  =1.0,.          
+000341a0: 2020 2020 2020 2065 6363 6c69 6d3d 312e         ecclim=1.
+000341b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000341c0: 2020 2074 613d 3234 3538 3436 302e 2c0a     ta=2458460.,.
+000341d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000341e0: 206c 6967 6874 5f74 7261 7665 6c5f 6465   light_travel_de
+000341f0: 6c61 7920 3d20 4661 6c73 652c 0a20 2020  lay = False,.   
+00034200: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00034210: 656c 6c61 725f 7261 6469 7573 203d 204e  ellar_radius = N
+00034220: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+00034230: 2020 2020 2020 6c6f 675f 6c69 6b65 5f63        log_like_c
+00034240: 616c 633d 4661 6c73 6529 3a0a 2020 2020  alc=False):.    
+00034250: 2020 2020 2320 496e 6865 7274 2074 6865      # Inhert the
+00034260: 2070 7269 6f72 7320 6469 6374 696f 6e61   priors dictiona
+00034270: 7279 2066 726f 6d20 6461 7461 3a0a 2020  ry from data:.  
+00034280: 2020 2020 2020 7365 6c66 2e70 7269 6f72        self.prior
+00034290: 7320 3d20 6461 7461 2e70 7269 6f72 730a  s = data.priors.
+000342a0: 2020 2020 2020 2020 2320 4465 6669 6e65          # Define
+000342b0: 2074 6865 2065 6363 6c69 6d20 7661 6c75   the ecclim valu
+000342c0: 653a 0a20 2020 2020 2020 2073 656c 662e  e:.        self.
+000342d0: 6563 636c 696d 203d 2065 6363 6c69 6d0a  ecclim = ecclim.
+000342e0: 2020 2020 2020 2020 2320 4465 6669 6e65          # Define
+000342f0: 2074 613a 0a20 2020 2020 2020 2073 656c   ta:.        sel
+00034300: 662e 7461 203d 2074 610a 2020 2020 2020  f.ta = ta.      
+00034310: 2020 2320 4465 6669 6e65 206c 6967 6874    # Define light
+00034320: 2074 7261 7665 6c20 7469 6d65 206f 7074   travel time opt
+00034330: 696f 6e3a 0a20 2020 2020 2020 2073 656c  ion:.        sel
+00034340: 662e 6c69 6768 745f 7472 6176 656c 5f64  f.light_travel_d
+00034350: 656c 6179 203d 206c 6967 6874 5f74 7261  elay = light_tra
+00034360: 7665 6c5f 6465 6c61 790a 2020 2020 2020  vel_delay.      
+00034370: 2020 6966 2073 656c 662e 6c69 6768 745f    if self.light_
+00034380: 7472 6176 656c 5f64 656c 6179 2061 6e64  travel_delay and
+00034390: 2028 7374 656c 6c61 725f 7261 6469 7573   (stellar_radius
+000343a0: 2069 7320 4e6f 6e65 293a 0a0a 2020 2020   is None):..    
+000343b0: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
+000343c0: 6365 7074 696f 6e28 2745 7272 6f72 3a20  ception('Error: 
+000343d0: 6966 206c 6967 6874 5f74 7261 7665 6c5f  if light_travel_
+000343e0: 6465 6c61 7920 6973 2061 6374 6976 6174  delay is activat
+000343f0: 6564 2c20 6120 7374 656c 6c61 7220 7261  ed, a stellar ra
+00034400: 6469 7573 206e 6565 6473 2074 6f20 6265  dius needs to be
+00034410: 2067 6976 656e 2061 7320 7765 6c6c 2076   given as well v
+00034420: 6961 2073 7465 6c6c 6172 5f72 6164 6975  ia stellar_radiu
+00034430: 7320 3d20 796f 7572 7661 6c75 653b 2065  s = yourvalue; e
+00034440: 2e67 2e2c 2064 6174 6173 6574 2e66 6974  .g., dataset.fit
+00034450: 282e 2e2e 2c20 6c69 6768 745f 7472 6176  (..., light_trav
+00034460: 656c 5f64 656c 6179 203d 2054 7275 652c  el_delay = True,
+00034470: 2073 7465 6c6c 6172 5f72 6164 6975 7320   stellar_radius 
+00034480: 3d20 312e 3132 3334 292e 2729 0a0a 2020  = 1.1234).')..  
+00034490: 2020 2020 2020 7365 6c66 2e73 7465 6c6c        self.stell
+000344a0: 6172 5f72 6164 6975 7320 3d20 7374 656c  ar_radius = stel
+000344b0: 6c61 725f 7261 6469 7573 0a0a 2020 2020  lar_radius..    
+000344c0: 2020 2020 2320 5361 7665 2074 6865 206c      # Save the l
+000344d0: 6f67 5f6c 696b 655f 6361 6c63 2062 6f6f  og_like_calc boo
+000344e0: 6c65 616e 3a0a 2020 2020 2020 2020 7365  lean:.        se
+000344f0: 6c66 2e6c 6f67 5f6c 696b 655f 6361 6c63  lf.log_like_calc
+00034500: 203d 206c 6f67 5f6c 696b 655f 6361 6c63   = log_like_calc
+00034510: 0a20 2020 2020 2020 2023 2044 6566 696e  .        # Defin
+00034520: 6520 7661 7269 6162 6c65 2074 6861 7420  e variable that 
+00034530: 6174 2065 6163 6820 6974 6572 6174 696f  at each iteratio
+00034540: 6e20 6465 6669 6e65 7320 6966 2074 6865  n defines if the
+00034550: 206d 6f64 656c 2069 7320 4f4b 206f 7220   model is OK or 
+00034560: 6e6f 7420 286e 6f74 204f 4b20 6d65 616e  not (not OK mean
+00034570: 7320 736f 6d65 7468 696e 6720 6661 696c  s something fail
+00034580: 6564 2069 6e20 7465 726d 7320 6f66 2074  ed in terms of t
+00034590: 6865 0a20 2020 2020 2020 2023 2070 6172  he.        # par
+000345a0: 616d 6574 6572 2073 7061 6365 2062 6569  ameter space bei
+000345b0: 6e67 2065 7870 6c6f 7265 6429 3a0a 2020  ng explored):.  
+000345c0: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
+000345d0: 4f4b 203d 2054 7275 650a 2020 2020 2020  OK = True.      
+000345e0: 2020 2320 4465 6669 6e65 2061 2076 6172    # Define a var
+000345f0: 6961 626c 6520 7468 6174 2077 696c 6c20  iable that will 
+00034600: 7361 7665 2074 6865 2070 6f73 7465 7269  save the posteri
+00034610: 6f72 2073 616d 706c 6573 3a0a 2020 2020  or samples:.    
+00034620: 2020 2020 7365 6c66 2e70 6f73 7465 7269      self.posteri
+00034630: 6f72 7320 3d20 4e6f 6e65 0a20 2020 2020  ors = None.     
+00034640: 2020 2073 656c 662e 6d65 6469 616e 5f70     self.median_p
+00034650: 6f73 7465 7269 6f72 5f73 616d 706c 6573  osterior_samples
+00034660: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00034670: 2320 4e75 6d62 6572 206f 6620 6461 7461  # Number of data
+00034680: 706f 696e 7473 2070 6572 2069 6e73 7472  points per instr
+00034690: 756d 656e 7420 7661 7269 6162 6c65 3a0a  ument variable:.
+000346a0: 2020 2020 2020 2020 7365 6c66 2e6e 6461          self.nda
+000346b0: 7461 706f 696e 7473 5f70 6572 5f69 6e73  tapoints_per_ins
+000346c0: 7472 756d 656e 7420 3d20 7b7d 0a20 2020  trument = {}.   
+000346d0: 2020 2020 2069 6620 6d6f 6465 6c74 7970       if modeltyp
+000346e0: 6520 3d3d 2027 6c63 273a 0a20 2020 2020  e == 'lc':.     
+000346f0: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
+00034700: 6c74 7970 6520 3d20 276c 6327 0a20 2020  ltype = 'lc'.   
+00034710: 2020 2020 2020 2020 2023 2049 6e68 6572           # Inher
+00034720: 7420 7469 6d65 732c 2066 6c75 7865 732c  t times, fluxes,
+00034730: 2065 7272 6f72 732c 2069 6e64 6578 6573   errors, indexes
+00034740: 2c20 6574 632e 2066 726f 6d20 6461 7461  , etc. from data
+00034750: 2e0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00034760: 4659 492c 2069 6e20 6361 7365 2074 6869  FYI, in case thi
+00034770: 7320 7365 656d 7320 636f 6e66 7573 696e  s seems confusin
+00034780: 673a 2073 656c 662e 742c 2073 656c 662e  g: self.t, self.
+00034790: 7920 616e 6420 7365 6c66 2e79 6572 7220  y and self.yerr 
+000347a0: 7361 7665 2077 6861 7420 7765 2069 6e74  save what we int
+000347b0: 6572 6e61 6c6c 7920 6361 6c6c 0a20 2020  ernally call.   
+000347c0: 2020 2020 2020 2020 2023 2022 676c 6f62           # "glob
+000347d0: 616c 2220 6461 7461 2d61 7272 6179 732e  al" data-arrays.
+000347e0: 2054 6865 7365 2068 6176 6520 7468 6520   These have the 
+000347f0: 6461 7461 2066 726f 6d20 616c 6c20 7468  data from all th
+00034800: 6520 696e 7374 7275 6d65 6e74 7320 7374  e instruments st
+00034810: 6163 6b65 6420 696e 746f 2061 6e20 6172  acked into an ar
+00034820: 7261 793b 2074 6f20 7265 636f 7665 720a  ray; to recover.
+00034830: 2020 2020 2020 2020 2020 2020 2320 7468              # th
+00034840: 6520 6461 7461 2066 6f72 2061 2067 6976  e data for a giv
+00034850: 656e 2069 6e73 7472 756d 656e 742c 206f  en instrument, o
+00034860: 6e65 2075 7365 7320 7468 6520 7365 6c66  ne uses the self
+00034870: 2e69 6e73 7472 756d 656e 745f 696e 6465  .instrument_inde
+00034880: 7865 7320 6469 6374 696f 6e61 7279 2e20  xes dictionary. 
+00034890: 4f6e 2074 6865 206f 7468 6572 2068 616e  On the other han
+000348a0: 642c 0a20 2020 2020 2020 2020 2020 2023  d,.            #
+000348b0: 2073 656c 662e 7469 6d65 732c 2073 656c   self.times, sel
+000348c0: 662e 6461 7461 2061 6e64 2073 656c 662e  f.data and self.
+000348d0: 6572 726f 7273 2061 7265 2064 6963 7469  errors are dicti
+000348e0: 6f6e 6172 6965 7320 7468 6174 206f 6e20  onaries that on 
+000348f0: 6561 6368 206b 6579 2068 6176 6520 7468  each key have th
+00034900: 6520 6461 7461 206f 6620 6120 6769 7665  e data of a give
+00034910: 6e20 696e 7374 7275 6d65 6e74 2e0a 2020  n instrument..  
+00034920: 2020 2020 2020 2020 2020 2320 4361 6c6c            # Call
+00034930: 696e 6720 6469 6374 696f 6e61 7269 6573  ing dictionaries
+00034940: 2069 7320 6661 7374 6572 2074 6861 6e20   is faster than 
+00034950: 6361 6c6c 696e 6720 696e 6465 7865 7320  calling indexes 
+00034960: 6f66 2061 7272 6179 732c 2073 6f20 7765  of arrays, so we
+00034970: 2075 7365 2074 6865 206c 6174 7465 7220   use the latter 
+00034980: 696e 2067 656e 6572 616c 2074 6f20 6576  in general to ev
+00034990: 616c 7561 7465 206d 6f64 656c 732e 0a20  aluate models.. 
+000349a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000349b0: 7420 3d20 6461 7461 2e74 5f6c 630a 2020  t = data.t_lc.  
+000349c0: 2020 2020 2020 2020 2020 7365 6c66 2e79            self.y
+000349d0: 203d 2064 6174 612e 795f 6c63 0a20 2020   = data.y_lc.   
+000349e0: 2020 2020 2020 2020 2073 656c 662e 7965           self.ye
+000349f0: 7272 203d 2064 6174 612e 7965 7272 5f6c  rr = data.yerr_l
+00034a00: 630a 2020 2020 2020 2020 2020 2020 7365  c.            se
+00034a10: 6c66 2e74 696d 6573 203d 2064 6174 612e  lf.times = data.
+00034a20: 7469 6d65 735f 6c63 0a20 2020 2020 2020  times_lc.       
+00034a30: 2020 2020 2073 656c 662e 6461 7461 203d       self.data =
+00034a40: 2064 6174 612e 6461 7461 5f6c 630a 2020   data.data_lc.  
+00034a50: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+00034a60: 7272 6f72 7320 3d20 6461 7461 2e65 7272  rrors = data.err
+00034a70: 6f72 735f 6c63 0a20 2020 2020 2020 2020  ors_lc.         
+00034a80: 2020 2073 656c 662e 696e 7374 7275 6d65     self.instrume
+00034a90: 6e74 7320 3d20 6461 7461 2e69 6e73 7472  nts = data.instr
+00034aa0: 756d 656e 7473 5f6c 630a 2020 2020 2020  uments_lc.      
+00034ab0: 2020 2020 2020 7365 6c66 2e6e 696e 7374        self.ninst
+00034ac0: 7275 6d65 6e74 7320 3d20 6461 7461 2e6e  ruments = data.n
+00034ad0: 696e 7374 7275 6d65 6e74 735f 6c63 0a20  instruments_lc. 
 00034ae0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00034af0: 6c64 5f69 6e61 6d65 203d 207b 7d0a 2020  ld_iname = {}.  
-00034b00: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00034b10: 6967 6d61 775f 696e 616d 6520 3d20 7b7d  igmaw_iname = {}
-00034b20: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00034b30: 662e 6d64 696c 7574 696f 6e5f 696e 616d  f.mdilution_inam
-00034b40: 6520 3d20 7b7d 0a20 2020 2020 2020 2020  e = {}.         
-00034b50: 2020 2073 656c 662e 6d66 6c75 785f 696e     self.mflux_in
-00034b60: 616d 6520 3d20 7b7d 0a20 2020 2020 2020  ame = {}.       
-00034b70: 2020 2020 2073 656c 662e 7468 6574 615f       self.theta_
-00034b80: 696e 616d 6520 3d20 7b7d 0a20 2020 2020  iname = {}.     
-00034b90: 2020 2020 2020 2073 656c 662e 6670 5f69         self.fp_i
-00034ba0: 6e61 6d65 203d 207b 7d0a 2020 2020 2020  name = {}.      
-00034bb0: 2020 2020 2020 7365 6c66 2e70 6861 7365        self.phase
-00034bc0: 6f66 6673 6574 5f69 6e61 6d65 203d 207b  offset_iname = {
-00034bd0: 7d0a 2020 2020 2020 2020 2020 2020 2320  }.            # 
-00034be0: 546f 206d 616b 6520 7472 616e 7369 7420  To make transit 
-00034bf0: 6465 7074 6820 2866 6f72 2062 6174 6d61  depth (for batma
-00034c00: 6e20 616e 6420 6361 7477 6f6d 616e 206d  n and catwoman m
-00034c10: 6f64 656c 7329 2077 696c 6c20 6265 2073  odels) will be s
-00034c20: 6861 7265 6420 6279 2064 6966 6665 7265  hared by differe
-00034c30: 6e74 2069 6e73 7472 756d 656e 7473 2c20  nt instruments, 
-00034c40: 7365 7420 7468 6520 636f 7272 6563 7420  set the correct 
-00034c50: 7661 7269 6162 6c65 206e 616d 6520 666f  variable name fo
-00034c60: 7220 6561 6368 3a0a 2020 2020 2020 2020  r each:.        
-00034c70: 2020 2020 7365 6c66 2e70 5f69 6e61 6d65      self.p_iname
-00034c80: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
-00034c90: 2020 7365 6c66 2e70 315f 696e 616d 6520    self.p1_iname 
-00034ca0: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
-00034cb0: 2023 2053 696e 6365 2070 2c20 7031 2028   # Since p, p1 (
-00034cc0: 7032 2920 616e 6420 6670 2061 7265 2061  p2) and fp are a
-00034cd0: 6c6c 2070 6c61 6e65 7461 7279 2061 6e64  ll planetary and
-00034ce0: 2069 6e73 7472 756d 656e 7461 6c20 7061   instrumental pa
-00034cf0: 7261 6d65 7465 7273 2c0a 2020 2020 2020  rameters,.      
-00034d00: 2020 2020 2020 2320 7765 2077 616e 7420        # we want 
-00034d10: 746f 206d 616b 6520 7375 7265 2074 6861  to make sure tha
-00034d20: 7420 7765 2068 6176 6520 636f 7272 6563  t we have correc
-00034d30: 7420 7661 7269 6162 6c65 206e 616d 6520  t variable name 
-00034d40: 666f 7220 6561 6368 2069 6e73 7472 756d  for each instrum
-00034d50: 656e 7473 2028 7768 656e 2074 6865 2069  ents (when the i
-00034d60: 6e73 7472 756d 656e 7473 2061 7265 2073  nstruments are s
-00034d70: 6861 7265 6429 2066 6f72 205f 6576 6572  hared) for _ever
-00034d80: 795f 2070 6c61 6e65 7473 2e0a 2020 2020  y_ planets..    
-00034d90: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00034da0: 2073 656c 662e 6e75 6d62 6572 696e 673a   self.numbering:
-00034db0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034dc0: 2073 656c 662e 705f 696e 616d 655b 2770   self.p_iname['p
-00034dd0: 2720 2b20 7374 7228 6929 5d20 3d20 7b7d  ' + str(i)] = {}
-00034de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034df0: 2073 656c 662e 7031 5f69 6e61 6d65 5b27   self.p1_iname['
-00034e00: 7027 202b 2073 7472 2869 295d 203d 207b  p' + str(i)] = {
-00034e10: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-00034e20: 2020 7365 6c66 2e66 705f 696e 616d 655b    self.fp_iname[
-00034e30: 2770 2720 2b20 7374 7228 6929 5d20 3d20  'p' + str(i)] = 
-00034e40: 7b7d 0a20 2020 2020 2020 2020 2020 2020  {}.             
-00034e50: 2020 2073 656c 662e 7068 6173 656f 6666     self.phaseoff
-00034e60: 7365 745f 696e 616d 655b 2770 2720 2b20  set_iname['p' + 
-00034e70: 7374 7228 6929 5d20 3d20 7b7d 0a20 2020  str(i)] = {}.   
-00034e80: 2020 2020 2020 2020 2073 656c 662e 6e64           self.nd
-00034e90: 6174 6170 6f69 6e74 735f 616c 6c5f 696e  atapoints_all_in
-00034ea0: 7374 7275 6d65 6e74 7320 3d20 300a 2020  struments = 0.  
-00034eb0: 2020 2020 2020 2020 2020 2320 5661 7269            # Vari
-00034ec0: 6162 6c65 2074 6861 7420 7475 726e 7320  able that turns 
-00034ed0: 746f 2066 616c 7365 206f 6e6c 7920 6966  to false only if
-00034ee0: 2074 6865 7265 2061 7265 206e 6f20 5454   there are no TT
-00034ef0: 5673 2e20 4f74 6865 7277 6973 652c 2061  Vs. Otherwise, a
-00034f00: 6c77 6179 7320 706f 7369 7469 7665 3a0a  lways positive:.
-00034f10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00034f20: 2e54 666c 6167 203d 2046 616c 7365 0a20  .Tflag = False. 
-00034f30: 2020 2020 2020 2020 2020 2023 2056 6172             # Var
-00034f40: 6961 626c 6520 7468 6174 2073 6574 7320  iable that sets 
-00034f50: 7468 6520 746f 7461 6c20 6e75 6d62 6572  the total number
-00034f60: 206f 6620 7472 616e 7369 7420 7469 6d65   of transit time
-00034f70: 7320 696e 2074 6865 2077 686f 6c65 2064  s in the whole d
-00034f80: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
-00034f90: 2020 2020 7365 6c66 2e4e 5f54 5456 7320      self.N_TTVs 
+00034af0: 696e 616d 6573 203d 2064 6174 612e 696e  inames = data.in
+00034b00: 616d 6573 5f6c 630a 2020 2020 2020 2020  ames_lc.        
+00034b10: 2020 2020 7365 6c66 2e69 6e73 7472 756d      self.instrum
+00034b20: 656e 745f 696e 6465 7865 7320 3d20 6461  ent_indexes = da
+00034b30: 7461 2e69 6e73 7472 756d 656e 745f 696e  ta.instrument_in
+00034b40: 6465 7865 735f 6c63 0a20 2020 2020 2020  dexes_lc.       
+00034b50: 2020 2020 2073 656c 662e 6c6d 5f62 6f6f       self.lm_boo
+00034b60: 6c65 616e 203d 2064 6174 612e 6c6d 5f6c  lean = data.lm_l
+00034b70: 635f 626f 6f6c 6561 6e0a 2020 2020 2020  c_boolean.      
+00034b80: 2020 2020 2020 7365 6c66 2e6c 6d5f 6172        self.lm_ar
+00034b90: 6775 6d65 6e74 7320 3d20 6461 7461 2e6c  guments = data.l
+00034ba0: 6d5f 6c63 5f61 7267 756d 656e 7473 0a20  m_lc_arguments. 
+00034bb0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00034bc0: 6c6d 5f6e 203d 207b 7d0a 2020 2020 2020  lm_n = {}.      
+00034bd0: 2020 2020 2020 7365 6c66 2e70 6c20 3d20        self.pl = 
+00034be0: 706c 0a20 2020 2020 2020 2020 2020 2073  pl.            s
+00034bf0: 656c 662e 7075 203d 2070 750a 2020 2020  elf.pu = pu.    
+00034c00: 2020 2020 2020 2020 7365 6c66 2e41 7220          self.Ar 
+00034c10: 3d20 2873 656c 662e 7075 202d 2073 656c  = (self.pu - sel
+00034c20: 662e 706c 2920 2f20 2832 2e20 2b20 7365  f.pl) / (2. + se
+00034c30: 6c66 2e70 6c20 2b20 7365 6c66 2e70 7529  lf.pl + self.pu)
+00034c40: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00034c50: 662e 676c 6f62 616c 5f6d 6f64 656c 203d  f.global_model =
+00034c60: 2064 6174 612e 676c 6f62 616c 5f6c 635f   data.global_lc_
+00034c70: 6d6f 6465 6c0a 2020 2020 2020 2020 2020  model.          
+00034c80: 2020 7365 6c66 2e64 6963 7469 6f6e 6172    self.dictionar
+00034c90: 7920 3d20 6461 7461 2e6c 635f 6f70 7469  y = data.lc_opti
+00034ca0: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
+00034cb0: 7365 6c66 2e6e 756d 6265 7269 6e67 203d  self.numbering =
+00034cc0: 2064 6174 612e 6e75 6d62 6572 696e 675f   data.numbering_
+00034cd0: 7472 616e 7369 7469 6e67 5f70 6c61 6e65  transiting_plane
+00034ce0: 7473 0a20 2020 2020 2020 2020 2020 2073  ts.            s
+00034cf0: 656c 662e 6e75 6d62 6572 696e 672e 736f  elf.numbering.so
+00034d00: 7274 2829 0a20 2020 2020 2020 2020 2020  rt().           
+00034d10: 2073 656c 662e 6e70 6c61 6e65 7473 203d   self.nplanets =
+00034d20: 206c 656e 2873 656c 662e 6e75 6d62 6572   len(self.number
+00034d30: 696e 6729 0a20 2020 2020 2020 2020 2020  ing).           
+00034d40: 2073 656c 662e 6d6f 6465 6c20 3d20 7b7d   self.model = {}
+00034d50: 0a20 2020 2020 2020 2020 2020 2023 2046  .            # F
+00034d60: 6972 7374 2c20 6966 2061 2067 6c6f 6261  irst, if a globa
+00034d70: 6c20 6d6f 6465 6c2c 2067 656e 6572 6174  l model, generat
+00034d80: 6520 6172 7261 7920 7468 6174 2077 696c  e array that wil
+00034d90: 6c20 7361 7665 2074 6869 733a 0a20 2020  l save this:.   
+00034da0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00034db0: 2e67 6c6f 6261 6c5f 6d6f 6465 6c3a 0a20  .global_model:. 
+00034dc0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00034dd0: 656c 662e 6d6f 6465 6c5b 2767 6c6f 6261  elf.model['globa
+00034de0: 6c27 5d20 3d20 6e70 2e7a 6572 6f73 286c  l'] = np.zeros(l
+00034df0: 656e 2873 656c 662e 7429 290a 2020 2020  en(self.t)).    
+00034e00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00034e10: 2e6d 6f64 656c 5b27 676c 6f62 616c 5f76  .model['global_v
+00034e20: 6172 6961 6e63 6573 275d 203d 206e 702e  ariances'] = np.
+00034e30: 7a65 726f 7328 6c65 6e28 7365 6c66 2e74  zeros(len(self.t
+00034e40: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00034e50: 2020 2073 656c 662e 6d6f 6465 6c5b 2764     self.model['d
+00034e60: 6574 6572 6d69 6e69 7374 6963 275d 203d  eterministic'] =
+00034e70: 206e 702e 7a65 726f 7328 6c65 6e28 7365   np.zeros(len(se
+00034e80: 6c66 2e74 2929 0a20 2020 2020 2020 2020  lf.t)).         
+00034e90: 2020 2023 2049 6620 6c69 6d62 2d64 6172     # If limb-dar
+00034ea0: 6b65 6e69 6e67 2c20 6469 6c75 7469 6f6e  kening, dilution
+00034eb0: 2066 6163 746f 7273 206f 7220 6563 6c69   factors or ecli
+00034ec0: 7073 6520 6465 7074 6820 7769 6c6c 2062  pse depth will b
+00034ed0: 6520 7368 6172 6564 2062 7920 6469 6666  e shared by diff
+00034ee0: 6572 656e 7420 696e 7374 7275 6d65 6e74  erent instrument
+00034ef0: 732c 2073 6574 2074 6865 2063 6f72 7265  s, set the corre
+00034f00: 6374 2076 6172 6961 626c 6520 6e61 6d65  ct variable name
+00034f10: 2066 6f72 2065 6163 683a 0a20 2020 2020   for each:.     
+00034f20: 2020 2020 2020 2073 656c 662e 6c64 5f69         self.ld_i
+00034f30: 6e61 6d65 203d 207b 7d0a 2020 2020 2020  name = {}.      
+00034f40: 2020 2020 2020 7365 6c66 2e73 6967 6d61        self.sigma
+00034f50: 775f 696e 616d 6520 3d20 7b7d 0a20 2020  w_iname = {}.   
+00034f60: 2020 2020 2020 2020 2073 656c 662e 6d64           self.md
+00034f70: 696c 7574 696f 6e5f 696e 616d 6520 3d20  ilution_iname = 
+00034f80: 7b7d 0a20 2020 2020 2020 2020 2020 2073  {}.            s
+00034f90: 656c 662e 6d66 6c75 785f 696e 616d 6520  elf.mflux_iname 
 00034fa0: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
-00034fb0: 2023 2056 6172 6961 626c 6520 7468 6174   # Variable that
-00034fc0: 2073 6574 7320 6966 2074 6865 2054 2d70   sets if the T-p
-00034fd0: 6172 616d 6574 7269 7a61 7469 6f6e 2077  arametrization w
-00034fe0: 696c 6c20 6265 2054 7275 653a 0a20 2020  ill be True:.   
-00034ff0: 2020 2020 2020 2020 2073 656c 662e 5470           self.Tp
-00035000: 6172 616d 6574 7269 7a61 7469 6f6e 203d  arametrization =
-00035010: 207b 7d0a 2020 2020 2020 2020 2020 2020   {}.            
-00035020: 666f 7220 7069 2069 6e20 7365 6c66 2e6e  for pi in self.n
-00035030: 756d 6265 7269 6e67 3a0a 2020 2020 2020  umbering:.      
-00035040: 2020 2020 2020 2020 2020 7365 6c66 2e4e            self.N
-00035050: 5f54 5456 735b 7069 5d20 3d20 302e 0a0a  _TTVs[pi] = 0...
-00035060: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00035070: 696e 7374 7275 6d65 6e74 2069 6e20 7365  instrument in se
-00035080: 6c66 2e69 6e61 6d65 733a 0a20 2020 2020  lf.inames:.     
-00035090: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-000350a0: 6920 696e 2073 656c 662e 6e75 6d62 6572  i in self.number
-000350b0: 696e 673a 0a20 2020 2020 2020 2020 2020  ing:.           
-000350c0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-000350d0: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
-000350e0: 7275 6d65 6e74 5d5b 2754 5456 7327 5d5b  rument]['TTVs'][
-000350f0: 7069 5d5b 2773 7461 7475 7327 5d3a 0a20  pi]['status']:. 
-00035100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035110: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
-00035120: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
-00035130: 6d65 6e74 5d5b 2754 5456 7327 5d5b 7069  ment]['TTVs'][pi
-00035140: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
-00035150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035160: 2020 2027 7061 7261 6d65 7472 697a 6174     'parametrizat
-00035170: 696f 6e27 5d20 3d3d 2027 5427 3a0a 2020  ion'] == 'T':.  
-00035180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035190: 2020 2020 2020 2020 2020 7365 6c66 2e54            self.T
-000351a0: 7061 7261 6d65 7472 697a 6174 696f 6e5b  parametrization[
-000351b0: 7069 5d20 3d20 5472 7565 0a20 2020 2020  pi] = True.     
-000351c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000351d0: 2020 2020 2020 2073 656c 662e 5466 6c61         self.Tfla
-000351e0: 6720 3d20 5472 7565 0a20 2020 2020 2020  g = True.       
-000351f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035200: 2073 656c 662e 4e5f 5454 5673 5b70 695d   self.N_TTVs[pi]
-00035210: 202b 3d20 7365 6c66 2e64 6963 7469 6f6e   += self.diction
-00035220: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
-00035230: 2754 5456 7327 5d5b 0a20 2020 2020 2020  'TTVs'][.       
-00035240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035250: 2020 2020 2070 695d 5b27 746f 7461 6c54       pi]['totalT
-00035260: 5456 7472 616e 7369 7473 275d 0a20 2020  TVtransits'].   
-00035270: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00035280: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
-00035290: 6e74 5d20 3d20 7b7d 0a20 2020 2020 2020  nt] = {}.       
-000352a0: 2020 2020 2020 2020 2023 2045 7874 7261           # Extra
-000352b0: 6374 206e 756d 6265 7220 6f66 2064 6174  ct number of dat
-000352c0: 6170 6f69 6e74 7320 7065 7220 696e 7374  apoints per inst
-000352d0: 7275 6d65 6e74 3a0a 2020 2020 2020 2020  rument:.        
-000352e0: 2020 2020 2020 2020 7365 6c66 2e6e 6461          self.nda
-000352f0: 7461 706f 696e 7473 5f70 6572 5f69 6e73  tapoints_per_ins
-00035300: 7472 756d 656e 745b 696e 7374 7275 6d65  trument[instrume
-00035310: 6e74 5d20 3d20 6c65 6e28 0a20 2020 2020  nt] = len(.     
-00035320: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00035330: 656c 662e 696e 7374 7275 6d65 6e74 5f69  elf.instrument_i
-00035340: 6e64 6578 6573 5b69 6e73 7472 756d 656e  ndexes[instrumen
-00035350: 745d 290a 2020 2020 2020 2020 2020 2020  t]).            
-00035360: 2020 2020 7365 6c66 2e6e 6461 7461 706f      self.ndatapo
-00035370: 696e 7473 5f61 6c6c 5f69 6e73 7472 756d  ints_all_instrum
-00035380: 656e 7473 202b 3d20 7365 6c66 2e6e 6461  ents += self.nda
-00035390: 7461 706f 696e 7473 5f70 6572 5f69 6e73  tapoints_per_ins
-000353a0: 7472 756d 656e 745b 0a20 2020 2020 2020  trument[.       
-000353b0: 2020 2020 2020 2020 2020 2020 2069 6e73               ins
-000353c0: 7472 756d 656e 745d 0a20 2020 2020 2020  trument].       
-000353d0: 2020 2020 2020 2020 2023 2045 7874 7261           # Extra
-000353e0: 6374 206e 756d 6265 7220 6f66 206c 696e  ct number of lin
-000353f0: 6561 7220 6d6f 6465 6c20 7465 726d 7320  ear model terms 
-00035400: 7065 7220 696e 7374 7275 6d65 6e74 3a0a  per instrument:.
-00035410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035420: 6966 2073 656c 662e 6c6d 5f62 6f6f 6c65  if self.lm_boole
-00035430: 616e 5b69 6e73 7472 756d 656e 745d 3a0a  an[instrument]:.
-00035440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035450: 2020 2020 7365 6c66 2e6c 6d5f 6e5b 696e      self.lm_n[in
-00035460: 7374 7275 6d65 6e74 5d20 3d20 7365 6c66  strument] = self
-00035470: 2e6c 6d5f 6172 6775 6d65 6e74 735b 696e  .lm_arguments[in
-00035480: 7374 7275 6d65 6e74 5d2e 7368 6170 655b  strument].shape[
-00035490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000354a0: 2020 2020 2020 2020 2031 5d0a 2020 2020           1].    
-000354b0: 2020 2020 2020 2020 2020 2020 2320 416e              # An
-000354c0: 2061 7272 6179 206f 6620 6f6e 6573 2074   array of ones t
-000354d0: 6f20 636f 7079 2061 726f 756e 643a 0a20  o copy around:. 
-000354e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000354f0: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
-00035500: 6d65 6e74 5d5b 276f 6e65 7327 5d20 3d20  ment]['ones'] = 
-00035510: 6e70 2e6f 6e65 7328 206c 656e 2873 656c  np.ones( len(sel
-00035520: 662e 696e 7374 7275 6d65 6e74 5f69 6e64  f.instrument_ind
-00035530: 6578 6573 5b69 6e73 7472 756d 656e 745d  exes[instrument]
-00035540: 2920 290a 0a20 2020 2020 2020 2020 2020  ) )..           
-00035550: 2020 2020 2023 2047 656e 6572 6174 6520       # Generate 
-00035560: 696e 7465 726e 616c 206d 6f64 656c 2076  internal model v
-00035570: 6172 6961 626c 6573 206f 6620 696e 7465  ariables of inte
-00035580: 7265 7374 2074 6f20 7468 6520 7573 6572  rest to the user
-00035590: 2e20 4669 7273 742c 2074 6865 206c 6967  . First, the lig
-000355a0: 6874 6375 7276 6520 6d6f 6465 6c20 696e  htcurve model in
-000355b0: 2074 6865 206e 6f74 6174 696f 6e20 6f66   the notation of
-000355c0: 206a 756c 6965 7420 284d 6929 0a20 2020   juliet (Mi).   
-000355d0: 2020 2020 2020 2020 2020 2020 2023 2028               # (
-000355e0: 6675 6c6c 206c 6967 6874 6375 7276 6520  full lightcurve 
-000355f0: 706c 7573 2064 696c 7574 696f 6e20 6661  plus dilution fa
-00035600: 6374 6f72 7320 616e 6420 6d66 6c75 7829  ctors and mflux)
-00035610: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00035620: 2020 7365 6c66 2e6d 6f64 656c 5b69 6e73    self.model[ins
-00035630: 7472 756d 656e 745d 5b27 4d27 5d20 3d20  trument]['M'] = 
-00035640: 6e70 2e6f 6e65 7328 0a20 2020 2020 2020  np.ones(.       
-00035650: 2020 2020 2020 2020 2020 2020 206c 656e               len
-00035660: 2873 656c 662e 696e 7374 7275 6d65 6e74  (self.instrument
-00035670: 5f69 6e64 6578 6573 5b69 6e73 7472 756d  _indexes[instrum
-00035680: 656e 745d 2929 0a20 2020 2020 2020 2020  ent])).         
-00035690: 2020 2020 2020 2023 204c 696e 6561 7220         # Linear 
-000356a0: 6d6f 6465 6c20 2869 6e20 7468 6520 6e6f  model (in the no
-000356b0: 7461 7469 6f6e 206f 6620 6a75 6c69 6574  tation of juliet
-000356c0: 2c20 4c4d 293a 0a20 2020 2020 2020 2020  , LM):.         
-000356d0: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
-000356e0: 6c5b 696e 7374 7275 6d65 6e74 5d5b 274c  l[instrument]['L
-000356f0: 4d27 5d20 3d20 6e70 2e7a 6572 6f73 280a  M'] = np.zeros(.
-00035700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035710: 2020 2020 6c65 6e28 7365 6c66 2e69 6e73      len(self.ins
-00035720: 7472 756d 656e 745f 696e 6465 7865 735b  trument_indexes[
-00035730: 696e 7374 7275 6d65 6e74 5d29 290a 2020  instrument])).  
-00035740: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00035750: 4e6f 772c 2067 656e 6572 6174 6520 6469  Now, generate di
-00035760: 6374 696f 6e61 7279 2074 6861 7420 7769  ctionary that wi
-00035770: 6c6c 2073 6176 6520 7468 6520 6669 6e61  ll save the fina
-00035780: 6c20 6675 6c6c 2c20 6465 7465 726d 696e  l full, determin
-00035790: 6973 7469 6320 6d6f 6465 6c20 284d 202b  istic model (M +
-000357a0: 204c 4d29 3a0a 2020 2020 2020 2020 2020   LM):.          
-000357b0: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-000357c0: 5b69 6e73 7472 756d 656e 745d 5b27 6465  [instrument]['de
-000357d0: 7465 726d 696e 6973 7469 6327 5d20 3d20  terministic'] = 
-000357e0: 6e70 2e7a 6572 6f73 280a 2020 2020 2020  np.zeros(.      
-000357f0: 2020 2020 2020 2020 2020 2020 2020 6c65                le
-00035800: 6e28 7365 6c66 2e69 6e73 7472 756d 656e  n(self.instrumen
-00035810: 745f 696e 6465 7865 735b 696e 7374 7275  t_indexes[instru
-00035820: 6d65 6e74 5d29 290a 2020 2020 2020 2020  ment])).        
-00035830: 2020 2020 2020 2020 2320 5361 6d65 2066          # Same f
-00035840: 6f72 2074 6865 2065 7272 6f72 733a 0a0a  or the errors:..
-00035850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035860: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
-00035870: 756d 656e 745d 5b27 6465 7465 726d 696e  ument]['determin
-00035880: 6973 7469 635f 6572 726f 7273 275d 203d  istic_errors'] =
-00035890: 206e 702e 7a65 726f 7328 206c 656e 2873   np.zeros( len(s
-000358a0: 656c 662e 696e 7374 7275 6d65 6e74 5f69  elf.instrument_i
-000358b0: 6e64 6578 6573 5b69 6e73 7472 756d 656e  ndexes[instrumen
-000358c0: 745d 2920 290a 2020 2020 2020 2020 2020  t]) ).          
-000358d0: 2020 2020 2020 6966 2073 656c 662e 6469        if self.di
-000358e0: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
-000358f0: 656e 745d 5b27 5472 616e 7369 7446 6974  ent]['TransitFit
-00035900: 275d 206f 7220 7365 6c66 2e64 6963 7469  '] or self.dicti
-00035910: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
-00035920: 5d5b 2745 636c 6970 7365 4669 7427 5d20  ]['EclipseFit'] 
-00035930: 6f72 2073 656c 662e 6469 6374 696f 6e61  or self.dictiona
-00035940: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
-00035950: 5472 616e 4563 6c46 6974 275d 3a0a 0a20  TranEclFit']:.. 
-00035960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035970: 2020 2023 2046 6972 7374 2c20 7461 6b65     # First, take
-00035980: 2074 6865 206f 7070 6f72 7475 6e69 7479   the opportunity
-00035990: 2074 6f20 696e 6974 6961 6c69 7a65 2074   to initialize t
-000359a0: 7261 6e73 6974 206c 6967 6874 6375 7276  ransit lightcurv
-000359b0: 6573 2066 6f72 2065 6163 6820 696e 7374  es for each inst
-000359c0: 7275 6d65 6e74 3a0a 2020 2020 2020 2020  rument:.        
-000359d0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000359e0: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
-000359f0: 6e73 7472 756d 656e 745d 5b27 7265 7361  nstrument]['resa
-00035a00: 6d70 6c69 6e67 275d 3a0a 2020 2020 2020  mpling']:.      
-00035a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035a20: 2020 6966 206e 6f74 2073 656c 662e 6469    if not self.di
-00035a30: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
-00035a40: 656e 745d 5b27 5472 616e 7369 7446 6974  ent]['TransitFit
-00035a50: 4361 7477 6f6d 616e 275d 3a0a 2020 2020  Catwoman']:.    
-00035a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035a70: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00035a80: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
-00035a90: 756d 656e 745d 5b27 5472 616e 7369 7446  ument]['TransitF
-00035aa0: 6974 275d 3a0a 2020 2020 2020 2020 2020  it']:.          
-00035ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035ac0: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-00035ad0: 5b69 6e73 7472 756d 656e 745d 5b27 7061  [instrument]['pa
-00035ae0: 7261 6d73 275d 2c20 5b73 656c 662e 6d6f  rams'], [self.mo
-00035af0: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
-00035b00: 276d 275d 2c5f 5d20 3d20 696e 6974 5f62  'm'],_] = init_b
-00035b10: 6174 6d61 6e28 7365 6c66 2e74 696d 6573  atman(self.times
-00035b20: 5b69 6e73 7472 756d 656e 745d 2c20 7365  [instrument], se
-00035b30: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
-00035b40: 7374 7275 6d65 6e74 5d5b 276c 646c 6177  strument]['ldlaw
-00035b50: 275d 2c5c 0a20 2020 2020 2020 2020 2020  '],\.           
-00035b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035bc0: 206e 7265 7361 6d70 6c69 6e67 203d 2073   nresampling = s
-00035bd0: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
-00035be0: 6e73 7472 756d 656e 745d 5b27 6e72 6573  nstrument]['nres
-00035bf0: 616d 706c 696e 6727 5d2c 5c0a 2020 2020  ampling'],\.    
-00035c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035c60: 2020 2020 2020 2020 6574 7265 7361 6d70          etresamp
-00035c70: 6c69 6e67 203d 2073 656c 662e 6469 6374  ling = self.dict
-00035c80: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
-00035c90: 745d 5b27 6578 7074 696d 6572 6573 616d  t]['exptimeresam
-00035ca0: 706c 696e 6727 5d29 0a20 2020 2020 2020  pling']).       
-00035cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035cc0: 2020 2020 2065 6c69 6620 7365 6c66 2e64       elif self.d
-00035cd0: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
-00035ce0: 6d65 6e74 5d5b 2745 636c 6970 7365 4669  ment]['EclipseFi
-00035cf0: 7427 5d3a 0a20 2020 2020 2020 2020 2020  t']:.           
-00035d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035d10: 2020 2020 2073 656c 662e 6d6f 6465 6c5b       self.model[
-00035d20: 696e 7374 7275 6d65 6e74 5d5b 2770 6172  instrument]['par
-00035d30: 616d 7327 5d2c 205b 5f2c 7365 6c66 2e6d  ams'], [_,self.m
-00035d40: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
-00035d50: 5b27 6d27 5d5d 203d 2069 6e69 745f 6261  ['m']] = init_ba
-00035d60: 746d 616e 2873 656c 662e 7469 6d65 735b  tman(self.times[
-00035d70: 696e 7374 7275 6d65 6e74 5d2c 2073 656c  instrument], sel
-00035d80: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
-00035d90: 7472 756d 656e 745d 5b27 6c64 6c61 7727  trument]['ldlaw'
-00035da0: 5d2c 205c 0a20 2020 2020 2020 2020 2020  ], \.           
-00035db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035e10: 206e 7265 7361 6d70 6c69 6e67 203d 2073   nresampling = s
-00035e20: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
-00035e30: 6e73 7472 756d 656e 745d 5b27 6e72 6573  nstrument]['nres
-00035e40: 616d 706c 696e 6727 5d2c 5c0a 2020 2020  ampling'],\.    
-00035e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034fb0: 2073 656c 662e 7468 6574 615f 696e 616d   self.theta_inam
+00034fc0: 6520 3d20 7b7d 0a20 2020 2020 2020 2020  e = {}.         
+00034fd0: 2020 2073 656c 662e 6670 5f69 6e61 6d65     self.fp_iname
+00034fe0: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
+00034ff0: 2020 7365 6c66 2e70 6861 7365 6f66 6673    self.phaseoffs
+00035000: 6574 5f69 6e61 6d65 203d 207b 7d0a 2020  et_iname = {}.  
+00035010: 2020 2020 2020 2020 2020 2320 546f 206d            # To m
+00035020: 616b 6520 7472 616e 7369 7420 6465 7074  ake transit dept
+00035030: 6820 2866 6f72 2062 6174 6d61 6e20 616e  h (for batman an
+00035040: 6420 6361 7477 6f6d 616e 206d 6f64 656c  d catwoman model
+00035050: 7329 2077 696c 6c20 6265 2073 6861 7265  s) will be share
+00035060: 6420 6279 2064 6966 6665 7265 6e74 2069  d by different i
+00035070: 6e73 7472 756d 656e 7473 2c20 7365 7420  nstruments, set 
+00035080: 7468 6520 636f 7272 6563 7420 7661 7269  the correct vari
+00035090: 6162 6c65 206e 616d 6520 666f 7220 6561  able name for ea
+000350a0: 6368 3a0a 2020 2020 2020 2020 2020 2020  ch:.            
+000350b0: 7365 6c66 2e70 5f69 6e61 6d65 203d 207b  self.p_iname = {
+000350c0: 7d0a 2020 2020 2020 2020 2020 2020 7365  }.            se
+000350d0: 6c66 2e70 315f 696e 616d 6520 3d20 7b7d  lf.p1_iname = {}
+000350e0: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
+000350f0: 696e 6365 2070 2c20 7031 2028 7032 2920  ince p, p1 (p2) 
+00035100: 616e 6420 6670 2061 7265 2061 6c6c 2070  and fp are all p
+00035110: 6c61 6e65 7461 7279 2061 6e64 2069 6e73  lanetary and ins
+00035120: 7472 756d 656e 7461 6c20 7061 7261 6d65  trumental parame
+00035130: 7465 7273 2c0a 2020 2020 2020 2020 2020  ters,.          
+00035140: 2020 2320 7765 2077 616e 7420 746f 206d    # we want to m
+00035150: 616b 6520 7375 7265 2074 6861 7420 7765  ake sure that we
+00035160: 2068 6176 6520 636f 7272 6563 7420 7661   have correct va
+00035170: 7269 6162 6c65 206e 616d 6520 666f 7220  riable name for 
+00035180: 6561 6368 2069 6e73 7472 756d 656e 7473  each instruments
+00035190: 2028 7768 656e 2074 6865 2069 6e73 7472   (when the instr
+000351a0: 756d 656e 7473 2061 7265 2073 6861 7265  uments are share
+000351b0: 6429 2066 6f72 205f 6576 6572 795f 2070  d) for _every_ p
+000351c0: 6c61 6e65 7473 2e0a 2020 2020 2020 2020  lanets..        
+000351d0: 2020 2020 666f 7220 6920 696e 2073 656c      for i in sel
+000351e0: 662e 6e75 6d62 6572 696e 673a 0a20 2020  f.numbering:.   
+000351f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00035200: 662e 705f 696e 616d 655b 2770 2720 2b20  f.p_iname['p' + 
+00035210: 7374 7228 6929 5d20 3d20 7b7d 0a20 2020  str(i)] = {}.   
+00035220: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00035230: 662e 7031 5f69 6e61 6d65 5b27 7027 202b  f.p1_iname['p' +
+00035240: 2073 7472 2869 295d 203d 207b 7d0a 2020   str(i)] = {}.  
+00035250: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00035260: 6c66 2e66 705f 696e 616d 655b 2770 2720  lf.fp_iname['p' 
+00035270: 2b20 7374 7228 6929 5d20 3d20 7b7d 0a20  + str(i)] = {}. 
+00035280: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00035290: 656c 662e 7068 6173 656f 6666 7365 745f  elf.phaseoffset_
+000352a0: 696e 616d 655b 2770 2720 2b20 7374 7228  iname['p' + str(
+000352b0: 6929 5d20 3d20 7b7d 0a20 2020 2020 2020  i)] = {}.       
+000352c0: 2020 2020 2073 656c 662e 6e64 6174 6170       self.ndatap
+000352d0: 6f69 6e74 735f 616c 6c5f 696e 7374 7275  oints_all_instru
+000352e0: 6d65 6e74 7320 3d20 300a 2020 2020 2020  ments = 0.      
+000352f0: 2020 2020 2020 2320 5661 7269 6162 6c65        # Variable
+00035300: 2074 6861 7420 7475 726e 7320 746f 2066   that turns to f
+00035310: 616c 7365 206f 6e6c 7920 6966 2074 6865  alse only if the
+00035320: 7265 2061 7265 206e 6f20 5454 5673 2e20  re are no TTVs. 
+00035330: 4f74 6865 7277 6973 652c 2061 6c77 6179  Otherwise, alway
+00035340: 7320 706f 7369 7469 7665 3a0a 2020 2020  s positive:.    
+00035350: 2020 2020 2020 2020 7365 6c66 2e54 666c          self.Tfl
+00035360: 6167 203d 2046 616c 7365 0a20 2020 2020  ag = False.     
+00035370: 2020 2020 2020 2023 2056 6172 6961 626c         # Variabl
+00035380: 6520 7468 6174 2073 6574 7320 7468 6520  e that sets the 
+00035390: 746f 7461 6c20 6e75 6d62 6572 206f 6620  total number of 
+000353a0: 7472 616e 7369 7420 7469 6d65 7320 696e  transit times in
+000353b0: 2074 6865 2077 686f 6c65 2064 6174 6173   the whole datas
+000353c0: 6574 3a0a 2020 2020 2020 2020 2020 2020  et:.            
+000353d0: 7365 6c66 2e4e 5f54 5456 7320 3d20 7b7d  self.N_TTVs = {}
+000353e0: 0a20 2020 2020 2020 2020 2020 2023 2056  .            # V
+000353f0: 6172 6961 626c 6520 7468 6174 2073 6574  ariable that set
+00035400: 7320 6966 2074 6865 2054 2d70 6172 616d  s if the T-param
+00035410: 6574 7269 7a61 7469 6f6e 2077 696c 6c20  etrization will 
+00035420: 6265 2054 7275 653a 0a20 2020 2020 2020  be True:.       
+00035430: 2020 2020 2073 656c 662e 5470 6172 616d       self.Tparam
+00035440: 6574 7269 7a61 7469 6f6e 203d 207b 7d0a  etrization = {}.
+00035450: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00035460: 7069 2069 6e20 7365 6c66 2e6e 756d 6265  pi in self.numbe
+00035470: 7269 6e67 3a0a 2020 2020 2020 2020 2020  ring:.          
+00035480: 2020 2020 2020 7365 6c66 2e4e 5f54 5456        self.N_TTV
+00035490: 735b 7069 5d20 3d20 302e 0a0a 2020 2020  s[pi] = 0...    
+000354a0: 2020 2020 2020 2020 666f 7220 696e 7374          for inst
+000354b0: 7275 6d65 6e74 2069 6e20 7365 6c66 2e69  rument in self.i
+000354c0: 6e61 6d65 733a 0a20 2020 2020 2020 2020  names:.         
+000354d0: 2020 2020 2020 2066 6f72 2070 6920 696e         for pi in
+000354e0: 2073 656c 662e 6e75 6d62 6572 696e 673a   self.numbering:
+000354f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035500: 2020 2020 2069 6620 7365 6c66 2e64 6963       if self.dic
+00035510: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
+00035520: 6e74 5d5b 2754 5456 7327 5d5b 7069 5d5b  nt]['TTVs'][pi][
+00035530: 2773 7461 7475 7327 5d3a 0a20 2020 2020  'status']:.     
+00035540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035550: 2020 2069 6620 7365 6c66 2e64 6963 7469     if self.dicti
+00035560: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
+00035570: 5d5b 2754 5456 7327 5d5b 7069 5d5b 0a20  ]['TTVs'][pi][. 
+00035580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035590: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000355a0: 7061 7261 6d65 7472 697a 6174 696f 6e27  parametrization'
+000355b0: 5d20 3d3d 2027 5427 3a0a 2020 2020 2020  ] == 'T':.      
+000355c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000355d0: 2020 2020 2020 7365 6c66 2e54 7061 7261        self.Tpara
+000355e0: 6d65 7472 697a 6174 696f 6e5b 7069 5d20  metrization[pi] 
+000355f0: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
+00035600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035610: 2020 2073 656c 662e 5466 6c61 6720 3d20     self.Tflag = 
+00035620: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00035630: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00035640: 662e 4e5f 5454 5673 5b70 695d 202b 3d20  f.N_TTVs[pi] += 
+00035650: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
+00035660: 696e 7374 7275 6d65 6e74 5d5b 2754 5456  instrument]['TTV
+00035670: 7327 5d5b 0a20 2020 2020 2020 2020 2020  s'][.           
+00035680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035690: 2070 695d 5b27 746f 7461 6c54 5456 7472   pi]['totalTTVtr
+000356a0: 616e 7369 7473 275d 0a20 2020 2020 2020  ansits'].       
+000356b0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
+000356c0: 6465 6c5b 696e 7374 7275 6d65 6e74 5d20  del[instrument] 
+000356d0: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
+000356e0: 2020 2020 2023 2045 7874 7261 6374 206e       # Extract n
+000356f0: 756d 6265 7220 6f66 2064 6174 6170 6f69  umber of datapoi
+00035700: 6e74 7320 7065 7220 696e 7374 7275 6d65  nts per instrume
+00035710: 6e74 3a0a 2020 2020 2020 2020 2020 2020  nt:.            
+00035720: 2020 2020 7365 6c66 2e6e 6461 7461 706f      self.ndatapo
+00035730: 696e 7473 5f70 6572 5f69 6e73 7472 756d  ints_per_instrum
+00035740: 656e 745b 696e 7374 7275 6d65 6e74 5d20  ent[instrument] 
+00035750: 3d20 6c65 6e28 0a20 2020 2020 2020 2020  = len(.         
+00035760: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00035770: 696e 7374 7275 6d65 6e74 5f69 6e64 6578  instrument_index
+00035780: 6573 5b69 6e73 7472 756d 656e 745d 290a  es[instrument]).
+00035790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000357a0: 7365 6c66 2e6e 6461 7461 706f 696e 7473  self.ndatapoints
+000357b0: 5f61 6c6c 5f69 6e73 7472 756d 656e 7473  _all_instruments
+000357c0: 202b 3d20 7365 6c66 2e6e 6461 7461 706f   += self.ndatapo
+000357d0: 696e 7473 5f70 6572 5f69 6e73 7472 756d  ints_per_instrum
+000357e0: 656e 745b 0a20 2020 2020 2020 2020 2020  ent[.           
+000357f0: 2020 2020 2020 2020 2069 6e73 7472 756d           instrum
+00035800: 656e 745d 0a20 2020 2020 2020 2020 2020  ent].           
+00035810: 2020 2020 2023 2045 7874 7261 6374 206e       # Extract n
+00035820: 756d 6265 7220 6f66 206c 696e 6561 7220  umber of linear 
+00035830: 6d6f 6465 6c20 7465 726d 7320 7065 7220  model terms per 
+00035840: 696e 7374 7275 6d65 6e74 3a0a 2020 2020  instrument:.    
+00035850: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00035860: 656c 662e 6c6d 5f62 6f6f 6c65 616e 5b69  elf.lm_boolean[i
+00035870: 6e73 7472 756d 656e 745d 3a0a 2020 2020  nstrument]:.    
+00035880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035890: 7365 6c66 2e6c 6d5f 6e5b 696e 7374 7275  self.lm_n[instru
+000358a0: 6d65 6e74 5d20 3d20 7365 6c66 2e6c 6d5f  ment] = self.lm_
+000358b0: 6172 6775 6d65 6e74 735b 696e 7374 7275  arguments[instru
+000358c0: 6d65 6e74 5d2e 7368 6170 655b 0a20 2020  ment].shape[.   
+000358d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000358e0: 2020 2020 2031 5d0a 2020 2020 2020 2020       1].        
+000358f0: 2020 2020 2020 2020 2320 416e 2061 7272          # An arr
+00035900: 6179 206f 6620 6f6e 6573 2074 6f20 636f  ay of ones to co
+00035910: 7079 2061 726f 756e 643a 0a20 2020 2020  py around:.     
+00035920: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00035930: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
+00035940: 5d5b 276f 6e65 7327 5d20 3d20 6e70 2e6f  ]['ones'] = np.o
+00035950: 6e65 7328 206c 656e 2873 656c 662e 696e  nes( len(self.in
+00035960: 7374 7275 6d65 6e74 5f69 6e64 6578 6573  strument_indexes
+00035970: 5b69 6e73 7472 756d 656e 745d 2920 290a  [instrument]) ).
+00035980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035990: 2023 2047 656e 6572 6174 6520 696e 7465   # Generate inte
+000359a0: 726e 616c 206d 6f64 656c 2076 6172 6961  rnal model varia
+000359b0: 626c 6573 206f 6620 696e 7465 7265 7374  bles of interest
+000359c0: 2074 6f20 7468 6520 7573 6572 2e20 4669   to the user. Fi
+000359d0: 7273 742c 2074 6865 206c 6967 6874 6375  rst, the lightcu
+000359e0: 7276 6520 6d6f 6465 6c20 696e 2074 6865  rve model in the
+000359f0: 206e 6f74 6174 696f 6e20 6f66 206a 756c   notation of jul
+00035a00: 6965 7420 284d 6929 0a20 2020 2020 2020  iet (Mi).       
+00035a10: 2020 2020 2020 2020 2023 2028 6675 6c6c           # (full
+00035a20: 206c 6967 6874 6375 7276 6520 706c 7573   lightcurve plus
+00035a30: 2064 696c 7574 696f 6e20 6661 6374 6f72   dilution factor
+00035a40: 7320 616e 6420 6d66 6c75 7829 3a0a 2020  s and mflux):.  
+00035a50: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00035a60: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
+00035a70: 656e 745d 5b27 4d27 5d20 3d20 6e70 2e6f  ent]['M'] = np.o
+00035a80: 6e65 7328 0a20 2020 2020 2020 2020 2020  nes(.           
+00035a90: 2020 2020 2020 2020 206c 656e 2873 656c           len(sel
+00035aa0: 662e 696e 7374 7275 6d65 6e74 5f69 6e64  f.instrument_ind
+00035ab0: 6578 6573 5b69 6e73 7472 756d 656e 745d  exes[instrument]
+00035ac0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00035ad0: 2020 2023 204c 696e 6561 7220 6d6f 6465     # Linear mode
+00035ae0: 6c20 2869 6e20 7468 6520 6e6f 7461 7469  l (in the notati
+00035af0: 6f6e 206f 6620 6a75 6c69 6574 2c20 4c4d  on of juliet, LM
+00035b00: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00035b10: 2020 2073 656c 662e 6d6f 6465 6c5b 696e     self.model[in
+00035b20: 7374 7275 6d65 6e74 5d5b 274c 4d27 5d20  strument]['LM'] 
+00035b30: 3d20 6e70 2e7a 6572 6f73 280a 2020 2020  = np.zeros(.    
+00035b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035b50: 6c65 6e28 7365 6c66 2e69 6e73 7472 756d  len(self.instrum
+00035b60: 656e 745f 696e 6465 7865 735b 696e 7374  ent_indexes[inst
+00035b70: 7275 6d65 6e74 5d29 290a 2020 2020 2020  rument])).      
+00035b80: 2020 2020 2020 2020 2020 2320 4e6f 772c            # Now,
+00035b90: 2067 656e 6572 6174 6520 6469 6374 696f   generate dictio
+00035ba0: 6e61 7279 2074 6861 7420 7769 6c6c 2073  nary that will s
+00035bb0: 6176 6520 7468 6520 6669 6e61 6c20 6675  ave the final fu
+00035bc0: 6c6c 2c20 6465 7465 726d 696e 6973 7469  ll, deterministi
+00035bd0: 6320 6d6f 6465 6c20 284d 202b 204c 4d29  c model (M + LM)
+00035be0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00035bf0: 2020 7365 6c66 2e6d 6f64 656c 5b69 6e73    self.model[ins
+00035c00: 7472 756d 656e 745d 5b27 6465 7465 726d  trument]['determ
+00035c10: 696e 6973 7469 6327 5d20 3d20 6e70 2e7a  inistic'] = np.z
+00035c20: 6572 6f73 280a 2020 2020 2020 2020 2020  eros(.          
+00035c30: 2020 2020 2020 2020 2020 6c65 6e28 7365            len(se
+00035c40: 6c66 2e69 6e73 7472 756d 656e 745f 696e  lf.instrument_in
+00035c50: 6465 7865 735b 696e 7374 7275 6d65 6e74  dexes[instrument
+00035c60: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
+00035c70: 2020 2020 2320 5361 6d65 2066 6f72 2074      # Same for t
+00035c80: 6865 2065 7272 6f72 733a 0a0a 2020 2020  he errors:..    
+00035c90: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00035ca0: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
+00035cb0: 745d 5b27 6465 7465 726d 696e 6973 7469  t]['deterministi
+00035cc0: 635f 6572 726f 7273 275d 203d 206e 702e  c_errors'] = np.
+00035cd0: 7a65 726f 7328 206c 656e 2873 656c 662e  zeros( len(self.
+00035ce0: 696e 7374 7275 6d65 6e74 5f69 6e64 6578  instrument_index
+00035cf0: 6573 5b69 6e73 7472 756d 656e 745d 2920  es[instrument]) 
+00035d00: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00035d10: 2020 6966 2073 656c 662e 6469 6374 696f    if self.dictio
+00035d20: 6e61 7279 5b69 6e73 7472 756d 656e 745d  nary[instrument]
+00035d30: 5b27 5472 616e 7369 7446 6974 275d 206f  ['TransitFit'] o
+00035d40: 7220 7365 6c66 2e64 6963 7469 6f6e 6172  r self.dictionar
+00035d50: 795b 696e 7374 7275 6d65 6e74 5d5b 2745  y[instrument]['E
+00035d60: 636c 6970 7365 4669 7427 5d20 6f72 2073  clipseFit'] or s
+00035d70: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
+00035d80: 6e73 7472 756d 656e 745d 5b27 5472 616e  nstrument]['Tran
+00035d90: 4563 6c46 6974 275d 3a0a 0a20 2020 2020  EclFit']:..     
+00035da0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00035db0: 2046 6972 7374 2c20 7461 6b65 2074 6865   First, take the
+00035dc0: 206f 7070 6f72 7475 6e69 7479 2074 6f20   opportunity to 
+00035dd0: 696e 6974 6961 6c69 7a65 2074 7261 6e73  initialize trans
+00035de0: 6974 206c 6967 6874 6375 7276 6573 2066  it lightcurves f
+00035df0: 6f72 2065 6163 6820 696e 7374 7275 6d65  or each instrume
+00035e00: 6e74 3a0a 2020 2020 2020 2020 2020 2020  nt:.            
+00035e10: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00035e20: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
+00035e30: 756d 656e 745d 5b27 7265 7361 6d70 6c69  ument]['resampli
+00035e40: 6e67 275d 3a0a 2020 2020 2020 2020 2020  ng']:.          
+00035e50: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00035e60: 206e 6f74 2073 656c 662e 6469 6374 696f   not self.dictio
+00035e70: 6e61 7279 5b69 6e73 7472 756d 656e 745d  nary[instrument]
+00035e80: 5b27 5472 616e 7369 7446 6974 4361 7477  ['TransitFitCatw
+00035e90: 6f6d 616e 275d 3a0a 2020 2020 2020 2020  oman']:.        
 00035ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035eb0: 2020 2020 2020 2020 6574 7265 7361 6d70          etresamp
-00035ec0: 6c69 6e67 203d 2073 656c 662e 6469 6374  ling = self.dict
-00035ed0: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
-00035ee0: 745d 5b27 6578 7074 696d 6572 6573 616d  t]['exptimeresam
-00035ef0: 706c 696e 6727 5d29 0a20 2020 2020 2020  pling']).       
-00035f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035f10: 2020 2020 2065 6c69 6620 7365 6c66 2e64       elif self.d
-00035f20: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
-00035f30: 6d65 6e74 5d5b 2754 7261 6e45 636c 4669  ment]['TranEclFi
-00035f40: 7427 5d3a 0a20 2020 2020 2020 2020 2020  t']:.           
-00035f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035f60: 2020 2020 2073 656c 662e 6d6f 6465 6c5b       self.model[
-00035f70: 696e 7374 7275 6d65 6e74 5d5b 2770 6172  instrument]['par
-00035f80: 616d 7327 5d2c 2073 656c 662e 6d6f 6465  ams'], self.mode
-00035f90: 6c5b 696e 7374 7275 6d65 6e74 5d5b 276d  l[instrument]['m
-00035fa0: 275d 203d 2069 6e69 745f 6261 746d 616e  '] = init_batman
-00035fb0: 2873 656c 662e 7469 6d65 735b 696e 7374  (self.times[inst
-00035fc0: 7275 6d65 6e74 5d2c 2073 656c 662e 6469  rument], self.di
-00035fd0: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
-00035fe0: 656e 745d 5b27 6c64 6c61 7727 5d2c 205c  ent]['ldlaw'], \
-00035ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035eb0: 2020 2020 6966 2073 656c 662e 6469 6374      if self.dict
+00035ec0: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
+00035ed0: 745d 5b27 5472 616e 7369 7446 6974 275d  t]['TransitFit']
+00035ee0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00035ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035f00: 2020 7365 6c66 2e6d 6f64 656c 5b69 6e73    self.model[ins
+00035f10: 7472 756d 656e 745d 5b27 7061 7261 6d73  trument]['params
+00035f20: 275d 2c20 5b73 656c 662e 6d6f 6465 6c5b  '], [self.model[
+00035f30: 696e 7374 7275 6d65 6e74 5d5b 276d 275d  instrument]['m']
+00035f40: 2c5f 5d20 3d20 696e 6974 5f62 6174 6d61  ,_] = init_batma
+00035f50: 6e28 7365 6c66 2e74 696d 6573 5b69 6e73  n(self.times[ins
+00035f60: 7472 756d 656e 745d 2c20 7365 6c66 2e64  trument], self.d
+00035f70: 6963 7469 6f6e 6172 795b 696e 7374 7275  ictionary[instru
+00035f80: 6d65 6e74 5d5b 276c 646c 6177 275d 2c5c  ment]['ldlaw'],\
+00035f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035ff0: 2020 2020 2020 2020 2020 2020 206e 7265               nre
+00036000: 7361 6d70 6c69 6e67 203d 2073 656c 662e  sampling = self.
+00036010: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
+00036020: 756d 656e 745d 5b27 6e72 6573 616d 706c  ument]['nresampl
+00036030: 696e 6727 5d2c 5c0a 2020 2020 2020 2020  ing'],\.        
 00036040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036050: 2020 2020 2020 2020 2020 2020 206e 7265               nre
-00036060: 7361 6d70 6c69 6e67 203d 2073 656c 662e  sampling = self.
-00036070: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
-00036080: 756d 656e 745d 5b27 6e72 6573 616d 706c  ument]['nresampl
-00036090: 696e 6727 5d2c 5c0a 2020 2020 2020 2020  ing'],\.        
-000360a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000360b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000360c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000360d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000360e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000360a0: 2020 2020 6574 7265 7361 6d70 6c69 6e67      etresampling
+000360b0: 203d 2073 656c 662e 6469 6374 696f 6e61   = self.dictiona
+000360c0: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
+000360d0: 6578 7074 696d 6572 6573 616d 706c 696e  exptimeresamplin
+000360e0: 6727 5d29 0a20 2020 2020 2020 2020 2020  g']).           
 000360f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036100: 2020 2020 6574 7265 7361 6d70 6c69 6e67      etresampling
-00036110: 203d 2073 656c 662e 6469 6374 696f 6e61   = self.dictiona
-00036120: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
-00036130: 6578 7074 696d 6572 6573 616d 706c 696e  exptimeresamplin
-00036140: 6727 5d29 0a20 2020 2020 2020 2020 2020  g']).           
-00036150: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00036160: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00036170: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00036180: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
-00036190: 6d65 6e74 5d5b 2770 6172 616d 7327 5d2c  ment]['params'],
-000361a0: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-000361b0: 7275 6d65 6e74 5d5b 276d 275d 203d 2069  rument]['m'] = i
-000361c0: 6e69 745f 6361 7477 6f6d 616e 2873 656c  nit_catwoman(sel
-000361d0: 662e 7469 6d65 735b 696e 7374 7275 6d65  f.times[instrume
-000361e0: 6e74 5d2c 2073 656c 662e 6469 6374 696f  nt], self.dictio
-000361f0: 6e61 7279 5b69 6e73 7472 756d 656e 745d  nary[instrument]
-00036200: 5b27 6c64 6c61 7727 5d2c 5c0a 2020 2020  ['ldlaw'],\.    
+00036100: 2065 6c69 6620 7365 6c66 2e64 6963 7469   elif self.dicti
+00036110: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
+00036120: 5d5b 2745 636c 6970 7365 4669 7427 5d3a  ]['EclipseFit']:
+00036130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036150: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
+00036160: 7275 6d65 6e74 5d5b 2770 6172 616d 7327  rument]['params'
+00036170: 5d2c 205b 5f2c 7365 6c66 2e6d 6f64 656c  ], [_,self.model
+00036180: 5b69 6e73 7472 756d 656e 745d 5b27 6d27  [instrument]['m'
+00036190: 5d5d 203d 2069 6e69 745f 6261 746d 616e  ]] = init_batman
+000361a0: 2873 656c 662e 7469 6d65 735b 696e 7374  (self.times[inst
+000361b0: 7275 6d65 6e74 5d2c 2073 656c 662e 6469  rument], self.di
+000361c0: 6374 696f 6e61 7279 5b69 6e73 7472 756d  ctionary[instrum
+000361d0: 656e 745d 5b27 6c64 6c61 7727 5d2c 205c  ent]['ldlaw'], \
+000361e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000361f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036200: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00036210: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00036220: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00036230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036270: 2020 2020 6e72 6573 616d 706c 696e 6720      nresampling 
-00036280: 3d20 7365 6c66 2e64 6963 7469 6f6e 6172  = self.dictionar
-00036290: 795b 696e 7374 7275 6d65 6e74 5d5b 276e  y[instrument]['n
-000362a0: 7265 7361 6d70 6c69 6e67 275d 2c5c 0a20  resampling'],\. 
+00036240: 2020 2020 2020 2020 2020 2020 206e 7265               nre
+00036250: 7361 6d70 6c69 6e67 203d 2073 656c 662e  sampling = self.
+00036260: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
+00036270: 756d 656e 745d 5b27 6e72 6573 616d 706c  ument]['nresampl
+00036280: 696e 6727 5d2c 5c0a 2020 2020 2020 2020  ing'],\.        
+00036290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000362a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000362b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000362c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000362d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000362e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000362f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036310: 2020 2020 2020 2065 7472 6573 616d 706c         etresampl
-00036320: 696e 6720 3d20 7365 6c66 2e64 6963 7469  ing = self.dicti
-00036330: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
-00036340: 5d5b 2765 7870 7469 6d65 7265 7361 6d70  ]['exptimeresamp
-00036350: 6c69 6e67 275d 290a 2020 2020 2020 2020  ling']).        
-00036360: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00036370: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00036380: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00036390: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
-000363a0: 5b69 6e73 7472 756d 656e 745d 5b27 5472  [instrument]['Tr
-000363b0: 616e 7369 7446 6974 4361 7477 6f6d 616e  ansitFitCatwoman
-000363c0: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
-000363d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000363e0: 6966 2073 656c 662e 6469 6374 696f 6e61  if self.dictiona
-000363f0: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
-00036400: 5472 616e 7369 7446 6974 275d 3a0a 2020  TransitFit']:.  
-00036410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036420: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00036430: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
-00036440: 656e 745d 5b27 7061 7261 6d73 275d 2c20  ent]['params'], 
-00036450: 5b73 656c 662e 6d6f 6465 6c5b 696e 7374  [self.model[inst
-00036460: 7275 6d65 6e74 5d5b 276d 275d 2c5f 5d20  rument]['m'],_] 
-00036470: 3d20 696e 6974 5f62 6174 6d61 6e28 7365  = init_batman(se
-00036480: 6c66 2e74 696d 6573 5b69 6e73 7472 756d  lf.times[instrum
-00036490: 656e 745d 2c20 5c0a 2020 2020 2020 2020  ent], \.        
-000364a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000364b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000364c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000364d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000362f0: 2020 2020 6574 7265 7361 6d70 6c69 6e67      etresampling
+00036300: 203d 2073 656c 662e 6469 6374 696f 6e61   = self.dictiona
+00036310: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
+00036320: 6578 7074 696d 6572 6573 616d 706c 696e  exptimeresamplin
+00036330: 6727 5d29 0a20 2020 2020 2020 2020 2020  g']).           
+00036340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036350: 2065 6c69 6620 7365 6c66 2e64 6963 7469   elif self.dicti
+00036360: 6f6e 6172 795b 696e 7374 7275 6d65 6e74  onary[instrument
+00036370: 5d5b 2754 7261 6e45 636c 4669 7427 5d3a  ]['TranEclFit']:
+00036380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000363a0: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
+000363b0: 7275 6d65 6e74 5d5b 2770 6172 616d 7327  rument]['params'
+000363c0: 5d2c 2073 656c 662e 6d6f 6465 6c5b 696e  ], self.model[in
+000363d0: 7374 7275 6d65 6e74 5d5b 276d 275d 203d  strument]['m'] =
+000363e0: 2069 6e69 745f 6261 746d 616e 2873 656c   init_batman(sel
+000363f0: 662e 7469 6d65 735b 696e 7374 7275 6d65  f.times[instrume
+00036400: 6e74 5d2c 2073 656c 662e 6469 6374 696f  nt], self.dictio
+00036410: 6e61 7279 5b69 6e73 7472 756d 656e 745d  nary[instrument]
+00036420: 5b27 6c64 6c61 7727 5d2c 205c 0a20 2020  ['ldlaw'], \.   
+00036430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036490: 2020 2020 2020 2020 206e 7265 7361 6d70           nresamp
+000364a0: 6c69 6e67 203d 2073 656c 662e 6469 6374  ling = self.dict
+000364b0: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
+000364c0: 745d 5b27 6e72 6573 616d 706c 696e 6727  t]['nresampling'
+000364d0: 5d2c 5c0a 2020 2020 2020 2020 2020 2020  ],\.            
 000364e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000364f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036500: 2020 2020 2020 2020 7365 6c66 2e64 6963          self.dic
-00036510: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
-00036520: 6e74 5d5b 276c 646c 6177 275d 290a 2020  nt]['ldlaw']).  
+00036500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036520: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00036530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036540: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+00036540: 6574 7265 7361 6d70 6c69 6e67 203d 2073  etresampling = s
 00036550: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
-00036560: 6e73 7472 756d 656e 745d 5b27 4563 6c69  nstrument]['Ecli
-00036570: 7073 6546 6974 275d 3a0a 2020 2020 2020  pseFit']:.      
-00036580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036590: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-000365a0: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
-000365b0: 5b27 7061 7261 6d73 275d 2c20 5b5f 2c73  ['params'], [_,s
-000365c0: 656c 662e 6d6f 6465 6c5b 696e 7374 7275  elf.model[instru
-000365d0: 6d65 6e74 5d5b 276d 275d 5d20 3d20 696e  ment]['m']] = in
-000365e0: 6974 5f62 6174 6d61 6e28 7365 6c66 2e74  it_batman(self.t
-000365f0: 696d 6573 5b69 6e73 7472 756d 656e 745d  imes[instrument]
-00036600: 2c20 5c0a 2020 2020 2020 2020 2020 2020  , \.            
-00036610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036560: 6e73 7472 756d 656e 745d 5b27 6578 7074  nstrument]['expt
+00036570: 696d 6572 6573 616d 706c 696e 6727 5d29  imeresampling'])
+00036580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036590: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+000365a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000365b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000365c0: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
+000365d0: 5d5b 2770 6172 616d 7327 5d2c 2073 656c  ]['params'], sel
+000365e0: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+000365f0: 6e74 5d5b 276d 275d 203d 2069 6e69 745f  nt]['m'] = init_
+00036600: 6361 7477 6f6d 616e 2873 656c 662e 7469  catwoman(self.ti
+00036610: 6d65 735b 696e 7374 7275 6d65 6e74 5d2c  mes[instrument],
+00036620: 2073 656c 662e 6469 6374 696f 6e61 7279   self.dictionary
+00036630: 5b69 6e73 7472 756d 656e 745d 5b27 6c64  [instrument]['ld
+00036640: 6c61 7727 5d2c 5c0a 2020 2020 2020 2020  law'],\.        
 00036650: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00036660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036670: 2020 2020 7365 6c66 2e64 6963 7469 6f6e      self.diction
-00036680: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
-00036690: 276c 646c 6177 275d 290a 2020 2020 2020  'ldlaw']).      
+00036670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036690: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000366a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000366b0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-000366c0: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
-000366d0: 756d 656e 745d 5b27 5472 616e 4563 6c46  ument]['TranEclF
-000366e0: 6974 275d 3a0a 2020 2020 2020 2020 2020  it']:.          
+000366b0: 6e72 6573 616d 706c 696e 6720 3d20 7365  nresampling = se
+000366c0: 6c66 2e64 6963 7469 6f6e 6172 795b 696e  lf.dictionary[in
+000366d0: 7374 7275 6d65 6e74 5d5b 276e 7265 7361  strument]['nresa
+000366e0: 6d70 6c69 6e67 275d 2c5c 0a20 2020 2020  mpling'],\.     
 000366f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036700: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-00036710: 5b69 6e73 7472 756d 656e 745d 5b27 7061  [instrument]['pa
-00036720: 7261 6d73 275d 2c20 7365 6c66 2e6d 6f64  rams'], self.mod
-00036730: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
-00036740: 6d27 5d20 3d20 696e 6974 5f62 6174 6d61  m'] = init_batma
-00036750: 6e28 7365 6c66 2e74 696d 6573 5b69 6e73  n(self.times[ins
-00036760: 7472 756d 656e 745d 2c20 5c0a 2020 2020  trument], \.    
-00036770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000367a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036750: 2020 2065 7472 6573 616d 706c 696e 6720     etresampling 
+00036760: 3d20 7365 6c66 2e64 6963 7469 6f6e 6172  = self.dictionar
+00036770: 795b 696e 7374 7275 6d65 6e74 5d5b 2765  y[instrument]['e
+00036780: 7870 7469 6d65 7265 7361 6d70 6c69 6e67  xptimeresampling
+00036790: 275d 290a 2020 2020 2020 2020 2020 2020  ']).            
+000367a0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
 000367b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000367c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000367d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000367e0: 2e64 6963 7469 6f6e 6172 795b 696e 7374  .dictionary[inst
-000367f0: 7275 6d65 6e74 5d5b 276c 646c 6177 275d  rument]['ldlaw']
-00036800: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00036810: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00036820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036830: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00036840: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
-00036850: 745d 5b27 7061 7261 6d73 275d 2c20 7365  t]['params'], se
-00036860: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
-00036870: 656e 745d 5b27 6d27 5d20 3d20 696e 6974  ent]['m'] = init
-00036880: 5f63 6174 776f 6d61 6e28 7365 6c66 2e74  _catwoman(self.t
-00036890: 696d 6573 5b69 6e73 7472 756d 656e 745d  imes[instrument]
-000368a0: 2c20 5c0a 2020 2020 2020 2020 2020 2020  , \.            
-000368b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000368c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000368d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000367c0: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+000367d0: 662e 6469 6374 696f 6e61 7279 5b69 6e73  f.dictionary[ins
+000367e0: 7472 756d 656e 745d 5b27 5472 616e 7369  trument]['Transi
+000367f0: 7446 6974 4361 7477 6f6d 616e 275d 3a0a  tFitCatwoman']:.
+00036800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036810: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00036820: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
+00036830: 6e73 7472 756d 656e 745d 5b27 5472 616e  nstrument]['Tran
+00036840: 7369 7446 6974 275d 3a0a 2020 2020 2020  sitFit']:.      
+00036850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036860: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00036870: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
+00036880: 5b27 7061 7261 6d73 275d 2c20 5b73 656c  ['params'], [sel
+00036890: 662e 6d6f 6465 6c5b 696e 7374 7275 6d65  f.model[instrume
+000368a0: 6e74 5d5b 276d 275d 2c5f 5d20 3d20 696e  nt]['m'],_] = in
+000368b0: 6974 5f62 6174 6d61 6e28 7365 6c66 2e74  it_batman(self.t
+000368c0: 696d 6573 5b69 6e73 7472 756d 656e 745d  imes[instrument]
+000368d0: 2c20 5c0a 2020 2020 2020 2020 2020 2020  , \.            
 000368e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000368f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00036900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036910: 2020 2073 656c 662e 6469 6374 696f 6e61     self.dictiona
-00036920: 7279 5b69 6e73 7472 756d 656e 745d 5b27  ry[instrument]['
-00036930: 6c64 6c61 7727 5d29 0a20 2020 2020 2020  ldlaw']).       
-00036940: 2020 2020 2020 2020 2020 2020 2023 2049               # I
-00036950: 6e64 6976 6964 7561 6c20 7472 616e 7369  ndividual transi
-00036960: 7420 6c69 6768 7463 7572 7665 7320 666f  t lightcurves fo
-00036970: 7220 6561 6368 2070 6c61 6e65 743a 0a20  r each planet:. 
-00036980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036990: 2020 2066 6f72 2069 2069 6e20 7365 6c66     for i in self
-000369a0: 2e6e 756d 6265 7269 6e67 3a0a 2020 2020  .numbering:.    
-000369b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000369c0: 2020 2020 7365 6c66 2e6d 6f64 656c 5b69      self.model[i
-000369d0: 6e73 7472 756d 656e 745d 5b27 7027 202b  nstrument]['p' +
-000369e0: 2073 7472 2869 295d 203d 206e 702e 6f6e   str(i)] = np.on
-000369f0: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-00036a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036a10: 6c65 6e28 7365 6c66 2e69 6e73 7472 756d  len(self.instrum
-00036a20: 656e 745f 696e 6465 7865 735b 696e 7374  ent_indexes[inst
-00036a30: 7275 6d65 6e74 5d29 290a 0a20 2020 2020  rument]))..     
-00036a40: 2020 2020 2020 2020 2020 2023 204e 6f77             # Now
-00036a50: 2070 726f 6365 6564 2077 6974 6820 696e   proceed with in
-00036a60: 7374 7275 6d65 6e74 206e 616d 696e 6773  strument namings
-00036a70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00036a80: 2020 666f 7220 706e 616d 6520 696e 2073    for pname in s
-00036a90: 656c 662e 7072 696f 7273 2e6b 6579 7328  elf.priors.keys(
-00036aa0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00036ab0: 2020 2020 2020 2023 2043 6865 636b 2069         # Check i
-00036ac0: 6620 7661 7269 6162 6c65 206e 616d 6520  f variable name 
-00036ad0: 6973 2061 206c 696d 622d 6461 726b 656e  is a limb-darken
-00036ae0: 696e 6720 636f 6566 6669 6369 656e 743a  ing coefficient:
-00036af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036b00: 2020 2020 2069 6620 706e 616d 655b 303a       if pname[0:
-00036b10: 325d 203d 3d20 2771 3127 3a0a 2020 2020  2] == 'q1':.    
-00036b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036b30: 2020 2020 7665 6320 3d20 706e 616d 652e      vec = pname.
-00036b40: 7370 6c69 7428 275f 2729 0a20 2020 2020  split('_').     
-00036b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036b60: 2020 2069 6620 6c65 6e28 7665 6329 203e     if len(vec) >
-00036b70: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
-00036b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036b90: 6966 2069 6e73 7472 756d 656e 7420 696e  if instrument in
-00036ba0: 2076 6563 3a0a 2020 2020 2020 2020 2020   vec:.          
+00036910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036940: 2020 2020 7365 6c66 2e64 6963 7469 6f6e      self.diction
+00036950: 6172 795b 696e 7374 7275 6d65 6e74 5d5b  ary[instrument][
+00036960: 276c 646c 6177 275d 290a 2020 2020 2020  'ldlaw']).      
+00036970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036980: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+00036990: 6469 6374 696f 6e61 7279 5b69 6e73 7472  dictionary[instr
+000369a0: 756d 656e 745d 5b27 4563 6c69 7073 6546  ument]['EclipseF
+000369b0: 6974 275d 3a0a 2020 2020 2020 2020 2020  it']:.          
+000369c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000369d0: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
+000369e0: 5b69 6e73 7472 756d 656e 745d 5b27 7061  [instrument]['pa
+000369f0: 7261 6d73 275d 2c20 5b5f 2c73 656c 662e  rams'], [_,self.
+00036a00: 6d6f 6465 6c5b 696e 7374 7275 6d65 6e74  model[instrument
+00036a10: 5d5b 276d 275d 5d20 3d20 696e 6974 5f62  ]['m']] = init_b
+00036a20: 6174 6d61 6e28 7365 6c66 2e74 696d 6573  atman(self.times
+00036a30: 5b69 6e73 7472 756d 656e 745d 2c20 5c0a  [instrument], \.
+00036a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ab0: 7365 6c66 2e64 6963 7469 6f6e 6172 795b  self.dictionary[
+00036ac0: 696e 7374 7275 6d65 6e74 5d5b 276c 646c  instrument]['ldl
+00036ad0: 6177 275d 290a 2020 2020 2020 2020 2020  aw']).          
+00036ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036af0: 2020 656c 6966 2073 656c 662e 6469 6374    elif self.dict
+00036b00: 696f 6e61 7279 5b69 6e73 7472 756d 656e  ionary[instrumen
+00036b10: 745d 5b27 5472 616e 4563 6c46 6974 275d  t]['TranEclFit']
+00036b20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00036b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036b40: 2020 7365 6c66 2e6d 6f64 656c 5b69 6e73    self.model[ins
+00036b50: 7472 756d 656e 745d 5b27 7061 7261 6d73  trument]['params
+00036b60: 275d 2c20 7365 6c66 2e6d 6f64 656c 5b69  '], self.model[i
+00036b70: 6e73 7472 756d 656e 745d 5b27 6d27 5d20  nstrument]['m'] 
+00036b80: 3d20 696e 6974 5f62 6174 6d61 6e28 7365  = init_batman(se
+00036b90: 6c66 2e74 696d 6573 5b69 6e73 7472 756d  lf.times[instrum
+00036ba0: 656e 745d 2c20 5c0a 2020 2020 2020 2020  ent], \.        
 00036bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036bc0: 2020 2020 2020 7365 6c66 2e6c 645f 696e        self.ld_in
-00036bd0: 616d 655b 696e 7374 7275 6d65 6e74 5d20  ame[instrument] 
-00036be0: 3d20 275f 272e 6a6f 696e 280a 2020 2020  = '_'.join(.    
+00036bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00036bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00036c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036c10: 7665 635b 313a 5d29 0a20 2020 2020 2020  vec[1:]).       
-00036c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036c30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00036c10: 2020 2020 2020 2020 7365 6c66 2e64 6963          self.dic
+00036c20: 7469 6f6e 6172 795b 696e 7374 7275 6d65  tionary[instrume
+00036c30: 6e74 5d5b 276c 646c 6177 275d 290a 2020  nt]['ldlaw']).  
 00036c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036c50: 2020 2069 6620 696e 7374 7275 6d65 6e74     if instrument
-00036c60: 2069 6e20 7665 633a 0a20 2020 2020 2020   in vec:.       
-00036c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036c80: 2020 2020 2020 2020 2073 656c 662e 6c64           self.ld
-00036c90: 5f69 6e61 6d65 5b69 6e73 7472 756d 656e  _iname[instrumen
-00036ca0: 745d 203d 2076 6563 5b31 5d0a 2020 2020  t] = vec[1].    
-00036cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036cc0: 2320 4368 6563 6b20 6966 2069 7420 6973  # Check if it is
-00036cd0: 2061 2074 6865 7461 204c 4d3a 0a20 2020   a theta LM:.   
+00036c50: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00036c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036c70: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+00036c80: 656c 5b69 6e73 7472 756d 656e 745d 5b27  el[instrument]['
+00036c90: 7061 7261 6d73 275d 2c20 7365 6c66 2e6d  params'], self.m
+00036ca0: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
+00036cb0: 5b27 6d27 5d20 3d20 696e 6974 5f63 6174  ['m'] = init_cat
+00036cc0: 776f 6d61 6e28 7365 6c66 2e74 696d 6573  woman(self.times
+00036cd0: 5b69 6e73 7472 756d 656e 745d 2c20 5c0a  [instrument], \.
 00036ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036cf0: 2069 6620 706e 616d 655b 303a 355d 203d   if pname[0:5] =
-00036d00: 3d20 2774 6865 7461 273a 0a20 2020 2020  = 'theta':.     
+00036cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00036d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d20: 2020 2076 6563 203d 2070 6e61 6d65 2e73     vec = pname.s
-00036d30: 706c 6974 2827 5f27 290a 2020 2020 2020  plit('_').      
-00036d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d50: 2020 7468 6574 615f 6e75 6d62 6572 203d    theta_number =
-00036d60: 2076 6563 5b30 5d5b 353a 5d0a 2020 2020   vec[0][5:].    
-00036d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d80: 2020 2020 6966 206c 656e 2876 6563 2920      if len(vec) 
-00036d90: 3e20 323a 200a 2020 2020 2020 2020 2020  > 2: .          
-00036da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036db0: 2020 6966 2069 6e73 7472 756d 656e 7420    if instrument 
-00036dc0: 696e 2076 6563 3a0a 2020 2020 2020 2020  in vec:.        
-00036dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036de0: 2020 2020 2020 2020 7365 6c66 2e74 6865          self.the
-00036df0: 7461 5f69 6e61 6d65 5b74 6865 7461 5f6e  ta_iname[theta_n
-00036e00: 756d 6265 722b 696e 7374 7275 6d65 6e74  umber+instrument
-00036e10: 5d20 3d20 275f 272e 6a6f 696e 280a 2020  ] = '_'.join(.  
-00036e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036d40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00036d50: 656c 662e 6469 6374 696f 6e61 7279 5b69  elf.dictionary[i
+00036d60: 6e73 7472 756d 656e 745d 5b27 6c64 6c61  nstrument]['ldla
+00036d70: 7727 5d29 0a20 2020 2020 2020 2020 2020  w']).           
+00036d80: 2020 2020 2020 2020 2023 2049 6e64 6976           # Indiv
+00036d90: 6964 7561 6c20 7472 616e 7369 7420 6c69  idual transit li
+00036da0: 6768 7463 7572 7665 7320 666f 7220 6561  ghtcurves for ea
+00036db0: 6368 2070 6c61 6e65 743a 0a20 2020 2020  ch planet:.     
+00036dc0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00036dd0: 6f72 2069 2069 6e20 7365 6c66 2e6e 756d  or i in self.num
+00036de0: 6265 7269 6e67 3a0a 2020 2020 2020 2020  bering:.        
+00036df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036e00: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
+00036e10: 756d 656e 745d 5b27 7027 202b 2073 7472  ument]['p' + str
+00036e20: 2869 295d 203d 206e 702e 6f6e 6573 280a  (i)] = np.ones(.
 00036e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036e40: 2020 7665 635b 313a 5d29 0a20 2020 2020    vec[1:]).     
-00036e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036e60: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00036e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036e80: 2020 2020 2069 6620 696e 7374 7275 6d65       if instrume
-00036e90: 6e74 2069 6e20 7665 633a 200a 2020 2020  nt in vec: .    
-00036ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036eb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00036ec0: 2e74 6865 7461 5f69 6e61 6d65 5b74 6865  .theta_iname[the
-00036ed0: 7461 5f6e 756d 6265 722b 696e 7374 7275  ta_number+instru
-00036ee0: 6d65 6e74 5d20 3d20 7665 635b 315d 0a20  ment] = vec[1]. 
-00036ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f00: 2020 2023 2043 6865 636b 2069 6620 7369     # Check if si
-00036f10: 676d 615f 773a 0a20 2020 2020 2020 2020  gma_w:.         
-00036f20: 2020 2020 2020 2020 2020 2069 6620 706e             if pn
-00036f30: 616d 655b 303a 375d 203d 3d20 2773 6967  ame[0:7] == 'sig
-00036f40: 6d61 5f77 273a 0a20 2020 2020 2020 2020  ma_w':.         
-00036f50: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00036f60: 6563 203d 2070 6e61 6d65 2e73 706c 6974  ec = pname.split
-00036f70: 2827 5f27 290a 2020 2020 2020 2020 2020  ('_').          
-00036f80: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00036f90: 206c 656e 2876 6563 2920 3e20 333a 200a   len(vec) > 3: .
-00036fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036fb0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00036fc0: 6e73 7472 756d 656e 7420 696e 2076 6563  nstrument in vec
-00036fd0: 3a20 0a20 2020 2020 2020 2020 2020 2020  : .             
-00036fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ff0: 2020 2073 656c 662e 7369 676d 6177 5f69     self.sigmaw_i
-00037000: 6e61 6d65 5b69 6e73 7472 756d 656e 745d  name[instrument]
-00037010: 203d 2027 5f27 2e6a 6f69 6e28 0a20 2020   = '_'.join(.   
-00037020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037040: 2076 6563 5b32 3a5d 290a 2020 2020 2020   vec[2:]).      
-00037050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037060: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00036e40: 2020 2020 2020 2020 2020 2020 6c65 6e28              len(
+00036e50: 7365 6c66 2e69 6e73 7472 756d 656e 745f  self.instrument_
+00036e60: 696e 6465 7865 735b 696e 7374 7275 6d65  indexes[instrume
+00036e70: 6e74 5d29 290a 0a20 2020 2020 2020 2020  nt]))..         
+00036e80: 2020 2020 2020 2023 2046 6972 7374 2c20         # First, 
+00036e90: 6368 6563 6b20 736f 6d65 2065 6467 6520  check some edge 
+00036ea0: 6361 7365 7320 6f66 2075 7365 7220 696e  cases of user in
+00036eb0: 7075 7420 6572 726f 722e 2046 6972 7374  put error. First
+00036ec0: 2c20 6966 2075 7365 7220 6465 6369 6465  , if user decide
+00036ed0: 6420 746f 2075 7365 2061 5f70 3120 616e  d to use a_p1 an
+00036ee0: 6420 7268 6f2c 2072 6169 7365 2061 6e20  d rho, raise an 
+00036ef0: 6572 726f 723a 0a20 2020 2020 2020 2020  error:.         
+00036f00: 2020 2020 2020 2069 6620 2827 615f 7031         if ('a_p1
+00036f10: 2720 696e 2073 656c 662e 7072 696f 7273  ' in self.priors
+00036f20: 2e6b 6579 7328 2929 2061 6e64 2028 2772  .keys()) and ('r
+00036f30: 686f 2720 696e 2073 656c 662e 7072 696f  ho' in self.prio
+00036f40: 7273 2e6b 6579 7328 2929 3a0a 0a20 2020  rs.keys()):..   
+00036f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036f60: 2072 6169 7365 2045 7863 6570 7469 6f6e   raise Exception
+00036f70: 2827 5072 696f 7273 2063 7572 7265 6e74  ('Priors current
+00036f80: 6c79 2064 6566 696e 6520 615f 7031 2028  ly define a_p1 (
+00036f90: 612f 5273 7461 7229 2061 6e64 2072 686f  a/Rstar) and rho
+00036fa0: 2028 7374 656c 6c61 7220 6465 6e73 6974   (stellar densit
+00036fb0: 7929 202d 2d2d 2074 6865 7365 2061 7265  y) --- these are
+00036fc0: 2072 6564 756e 6461 6e74 2e20 506c 6561   redundant. Plea
+00036fd0: 7365 2063 686f 6f73 6520 746f 2066 6974  se choose to fit
+00036fe0: 2065 6974 6865 7220 615f 7031 206f 7220   either a_p1 or 
+00036ff0: 7268 6f20 696e 2079 6f75 7220 6669 742e  rho in your fit.
+00037000: 2729 0a0a 2020 2020 2020 2020 2020 2020  ')..            
+00037010: 2020 2020 2320 4e6f 7720 7072 6f63 6565      # Now procee
+00037020: 6420 7769 7468 2069 6e73 7472 756d 656e  d with instrumen
+00037030: 7420 6e61 6d69 6e67 733a 0a20 2020 2020  t namings:.     
+00037040: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
+00037050: 6e61 6d65 2069 6e20 7365 6c66 2e70 7269  name in self.pri
+00037060: 6f72 732e 6b65 7973 2829 3a0a 2020 2020  ors.keys():.    
 00037070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037080: 2020 2020 6966 2069 6e73 7472 756d 656e      if instrumen
-00037090: 7420 696e 2076 6563 3a20 0a20 2020 2020  t in vec: .     
-000370a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000370b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000370c0: 7369 676d 6177 5f69 6e61 6d65 5b69 6e73  sigmaw_iname[ins
-000370d0: 7472 756d 656e 745d 203d 2076 6563 5b32  trument] = vec[2
-000370e0: 5d20 0a20 2020 2020 2020 2020 2020 2020  ] .             
-000370f0: 2020 2020 2020 2023 2043 6865 636b 2069         # Check i
-00037100: 6620 6974 2069 7320 6120 6469 6c75 7469  f it is a diluti
-00037110: 6f6e 2066 6163 746f 723a 0a20 2020 2020  on factor:.     
-00037120: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00037130: 6620 706e 616d 655b 303a 395d 203d 3d20  f pname[0:9] == 
-00037140: 276d 6469 6c75 7469 6f6e 273a 0a20 2020  'mdilution':.   
-00037150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037160: 2020 2020 2076 6563 203d 2070 6e61 6d65       vec = pname
-00037170: 2e73 706c 6974 2827 5f27 290a 2020 2020  .split('_').    
-00037180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037190: 2020 2020 6966 206c 656e 2876 6563 2920      if len(vec) 
-000371a0: 3e20 323a 0a20 2020 2020 2020 2020 2020  > 2:.           
-000371b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000371c0: 2069 6620 696e 7374 7275 6d65 6e74 2069   if instrument i
-000371d0: 6e20 7665 633a 0a20 2020 2020 2020 2020  n vec:.         
-000371e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000371f0: 2020 2020 2020 2073 656c 662e 6d64 696c         self.mdil
-00037200: 7574 696f 6e5f 696e 616d 655b 696e 7374  ution_iname[inst
-00037210: 7275 6d65 6e74 5d20 3d20 275f 272e 6a6f  rument] = '_'.jo
-00037220: 696e 280a 2020 2020 2020 2020 2020 2020  in(.            
-00037230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037240: 2020 2020 2020 2020 7665 635b 313a 5d29          vec[1:])
-00037250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037260: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00037270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037280: 2020 2020 2020 2020 2020 2069 6620 696e             if in
-00037290: 7374 7275 6d65 6e74 2069 6e20 7665 633a  strument in vec:
-000372a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000372b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000372c0: 2073 656c 662e 6d64 696c 7574 696f 6e5f   self.mdilution_
-000372d0: 696e 616d 655b 696e 7374 7275 6d65 6e74  iname[instrument
-000372e0: 5d20 3d20 7665 635b 315d 0a20 2020 2020  ] = vec[1].     
-000372f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00037300: 6620 706e 616d 655b 303a 355d 203d 3d20  f pname[0:5] == 
-00037310: 276d 666c 7578 273a 0a20 2020 2020 2020  'mflux':.       
-00037320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037330: 2076 6563 203d 2070 6e61 6d65 2e73 706c   vec = pname.spl
-00037340: 6974 2827 5f27 290a 2020 2020 2020 2020  it('_').        
-00037350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037360: 6966 206c 656e 2876 6563 2920 3e20 323a  if len(vec) > 2:
-00037370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037380: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00037390: 696e 7374 7275 6d65 6e74 2069 6e20 7665  instrument in ve
-000373a0: 633a 0a20 2020 2020 2020 2020 2020 2020  c:.             
-000373b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000373c0: 2020 2073 656c 662e 6d66 6c75 785f 696e     self.mflux_in
-000373d0: 616d 655b 696e 7374 7275 6d65 6e74 5d20  ame[instrument] 
-000373e0: 3d20 275f 272e 6a6f 696e 280a 2020 2020  = '_'.join(.    
+00037080: 2320 4368 6563 6b20 6966 2076 6172 6961  # Check if varia
+00037090: 626c 6520 6e61 6d65 2069 7320 6120 6c69  ble name is a li
+000370a0: 6d62 2d64 6172 6b65 6e69 6e67 2063 6f65  mb-darkening coe
+000370b0: 6666 6963 6965 6e74 3a0a 2020 2020 2020  fficient:.      
+000370c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000370d0: 2070 6e61 6d65 5b30 3a32 5d20 3d3d 2027   pname[0:2] == '
+000370e0: 7131 273a 0a20 2020 2020 2020 2020 2020  q1':.           
+000370f0: 2020 2020 2020 2020 2020 2020 2076 6563               vec
+00037100: 203d 2070 6e61 6d65 2e73 706c 6974 2827   = pname.split('
+00037110: 5f27 290a 2020 2020 2020 2020 2020 2020  _').            
+00037120: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00037130: 656e 2876 6563 2920 3e20 323a 0a20 2020  en(vec) > 2:.   
+00037140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037150: 2020 2020 2020 2020 2069 6620 696e 7374           if inst
+00037160: 7275 6d65 6e74 2069 6e20 7665 633a 0a20  rument in vec:. 
+00037170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037180: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00037190: 656c 662e 6c64 5f69 6e61 6d65 5b69 6e73  elf.ld_iname[ins
+000371a0: 7472 756d 656e 745d 203d 2027 5f27 2e6a  trument] = '_'.j
+000371b0: 6f69 6e28 0a20 2020 2020 2020 2020 2020  oin(.           
+000371c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000371d0: 2020 2020 2020 2020 2076 6563 5b31 3a5d           vec[1:]
+000371e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000371f0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00037200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037210: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00037220: 6e73 7472 756d 656e 7420 696e 2076 6563  nstrument in vec
+00037230: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00037240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037250: 2020 7365 6c66 2e6c 645f 696e 616d 655b    self.ld_iname[
+00037260: 696e 7374 7275 6d65 6e74 5d20 3d20 7665  instrument] = ve
+00037270: 635b 315d 0a20 2020 2020 2020 2020 2020  c[1].           
+00037280: 2020 2020 2020 2020 2023 2043 6865 636b           # Check
+00037290: 2069 6620 6974 2069 7320 6120 7468 6574   if it is a thet
+000372a0: 6120 4c4d 3a0a 2020 2020 2020 2020 2020  a LM:.          
+000372b0: 2020 2020 2020 2020 2020 6966 2070 6e61            if pna
+000372c0: 6d65 5b30 3a35 5d20 3d3d 2027 7468 6574  me[0:5] == 'thet
+000372d0: 6127 3a0a 2020 2020 2020 2020 2020 2020  a':.            
+000372e0: 2020 2020 2020 2020 2020 2020 7665 6320              vec 
+000372f0: 3d20 706e 616d 652e 7370 6c69 7428 275f  = pname.split('_
+00037300: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
+00037310: 2020 2020 2020 2020 2020 2074 6865 7461             theta
+00037320: 5f6e 756d 6265 7220 3d20 7665 635b 305d  _number = vec[0]
+00037330: 5b35 3a5d 0a20 2020 2020 2020 2020 2020  [5:].           
+00037340: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00037350: 6c65 6e28 7665 6329 203e 2032 3a20 0a20  len(vec) > 2: . 
+00037360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037370: 2020 2020 2020 2020 2020 2069 6620 696e             if in
+00037380: 7374 7275 6d65 6e74 2069 6e20 7665 633a  strument in vec:
+00037390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000373a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000373b0: 2073 656c 662e 7468 6574 615f 696e 616d   self.theta_inam
+000373c0: 655b 7468 6574 615f 6e75 6d62 6572 2b69  e[theta_number+i
+000373d0: 6e73 7472 756d 656e 745d 203d 2027 5f27  nstrument] = '_'
+000373e0: 2e6a 6f69 6e28 0a20 2020 2020 2020 2020  .join(.         
 000373f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037410: 7665 635b 313a 5d29 0a20 2020 2020 2020  vec[1:]).       
-00037420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037430: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00037440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037450: 2020 2069 6620 696e 7374 7275 6d65 6e74     if instrument
-00037460: 2069 6e20 7665 633a 0a20 2020 2020 2020   in vec:.       
+00037400: 2020 2020 2020 2020 2020 2076 6563 5b31             vec[1
+00037410: 3a5d 290a 2020 2020 2020 2020 2020 2020  :]).            
+00037420: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00037430: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00037440: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00037450: 2069 6e73 7472 756d 656e 7420 696e 2076   instrument in v
+00037460: 6563 3a20 0a20 2020 2020 2020 2020 2020  ec: .           
 00037470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037480: 2020 2020 2020 2020 2073 656c 662e 6d66           self.mf
-00037490: 6c75 785f 696e 616d 655b 696e 7374 7275  lux_iname[instru
-000374a0: 6d65 6e74 5d20 3d20 7665 635b 315d 0a0a  ment] = vec[1]..
-000374b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000374c0: 2020 2020 6966 2070 6e61 6d65 5b30 3a32      if pname[0:2
-000374d0: 5d20 3d3d 2027 6670 273a 0a0a 2020 2020  ] == 'fp':..    
+00037480: 2020 2020 2073 656c 662e 7468 6574 615f       self.theta_
+00037490: 696e 616d 655b 7468 6574 615f 6e75 6d62  iname[theta_numb
+000374a0: 6572 2b69 6e73 7472 756d 656e 745d 203d  er+instrument] =
+000374b0: 2076 6563 5b31 5d0a 2020 2020 2020 2020   vec[1].        
+000374c0: 2020 2020 2020 2020 2020 2020 2320 4368              # Ch
+000374d0: 6563 6b20 6966 2073 6967 6d61 5f77 3a0a  eck if sigma_w:.
 000374e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000374f0: 2020 2020 2320 4e6f 7465 2074 6861 7420      # Note that 
-00037500: 6563 6c69 7073 6520 616e 6420 7472 616e  eclipse and tran
-00037510: 7369 7420 6465 7074 6873 2063 616e 2062  sit depths can b
-00037520: 6520 6120 706c 616e 6574 6172 7920 616e  e a planetary an
-00037530: 6420 696e 7374 7275 6d65 6e74 616c 2070  d instrumental p
-00037540: 6172 616d 6574 6572 0a20 2020 2020 2020  arameter.       
-00037550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037560: 2076 6563 203d 2070 6e61 6d65 2e73 706c   vec = pname.spl
-00037570: 6974 2827 5f27 290a 2020 2020 2020 2020  it('_').        
-00037580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037590: 6966 206c 656e 2876 6563 2920 3e20 333a  if len(vec) > 3:
-000375a0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000375b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-000375c0: 5468 6973 2069 7320 7468 6520 6361 7365  This is the case
-000375d0: 2069 6e20 7768 6963 6820 6d75 6c74 6970   in which multip
-000375e0: 6c65 2069 6e73 7472 756d 656e 7473 2073  le instruments s
-000375f0: 6861 7265 2061 6e20 6563 6c69 7073 6520  hare an eclipse 
-00037600: 6465 7074 682c 2065 2e67 2e2c 2066 705f  depth, e.g., fp_
-00037610: 7031 5f54 4553 5331 5f54 4553 5332 0a20  p1_TESS1_TESS2. 
-00037620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037630: 2020 2020 2020 2020 2020 2069 6620 696e             if in
-00037640: 7374 7275 6d65 6e74 2069 6e20 7665 633a  strument in vec:
-00037650: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00037660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037670: 2020 7365 6c66 2e66 705f 696e 616d 655b    self.fp_iname[
-00037680: 7665 635b 315d 5d5b 696e 7374 7275 6d65  vec[1]][instrume
-00037690: 6e74 5d20 3d20 275f 2720 2b20 275f 272e  nt] = '_' + '_'.
-000376a0: 6a6f 696e 2876 6563 5b32 3a5d 290a 0a20  join(vec[2:]).. 
+000374f0: 2020 2020 6966 2070 6e61 6d65 5b30 3a37      if pname[0:7
+00037500: 5d20 3d3d 2027 7369 676d 615f 7727 3a0a  ] == 'sigma_w':.
+00037510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037520: 2020 2020 2020 2020 7665 6320 3d20 706e          vec = pn
+00037530: 616d 652e 7370 6c69 7428 275f 2729 0a20  ame.split('_'). 
+00037540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037550: 2020 2020 2020 2069 6620 6c65 6e28 7665         if len(ve
+00037560: 6329 203e 2033 3a20 0a20 2020 2020 2020  c) > 3: .       
+00037570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037580: 2020 2020 2069 6620 696e 7374 7275 6d65       if instrume
+00037590: 6e74 2069 6e20 7665 633a 200a 2020 2020  nt in vec: .    
+000375a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000375b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000375c0: 2e73 6967 6d61 775f 696e 616d 655b 696e  .sigmaw_iname[in
+000375d0: 7374 7275 6d65 6e74 5d20 3d20 275f 272e  strument] = '_'.
+000375e0: 6a6f 696e 280a 2020 2020 2020 2020 2020  join(.          
+000375f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037600: 2020 2020 2020 2020 2020 7665 635b 323a            vec[2:
+00037610: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+00037620: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00037630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037640: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00037650: 696e 7374 7275 6d65 6e74 2069 6e20 7665  instrument in ve
+00037660: 633a 200a 2020 2020 2020 2020 2020 2020  c: .            
+00037670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037680: 2020 2020 7365 6c66 2e73 6967 6d61 775f      self.sigmaw_
+00037690: 696e 616d 655b 696e 7374 7275 6d65 6e74  iname[instrument
+000376a0: 5d20 3d20 7665 635b 325d 200a 2020 2020  ] = vec[2] .    
 000376b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000376c0: 2020 2020 2020 2065 6c69 6620 6c65 6e28         elif len(
-000376d0: 7665 6329 203d 3d20 333a 0a0a 2020 2020  vec) == 3:..    
-000376e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000376f0: 2020 2020 2020 2020 2320 5468 6973 2069          # This i
-00037700: 7320 7468 6520 6361 7365 206f 6620 6120  s the case of a 
-00037710: 7369 6e67 6c65 2069 6e73 7472 756d 656e  single instrumen
-00037720: 7420 7769 7468 2066 702c 2065 2e67 2e2c  t with fp, e.g.,
-00037730: 2066 705f 7031 5f54 4553 530a 2020 2020   fp_p1_TESS.    
-00037740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037750: 2020 2020 2020 2020 6966 2069 6e73 7472          if instr
-00037760: 756d 656e 7420 696e 2076 6563 3a0a 2020  ument in vec:.  
+000376c0: 2320 4368 6563 6b20 6966 2069 7420 6973  # Check if it is
+000376d0: 2061 2064 696c 7574 696f 6e20 6661 6374   a dilution fact
+000376e0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+000376f0: 2020 2020 2020 2020 6966 2070 6e61 6d65          if pname
+00037700: 5b30 3a39 5d20 3d3d 2027 6d64 696c 7574  [0:9] == 'mdilut
+00037710: 696f 6e27 3a0a 2020 2020 2020 2020 2020  ion':.          
+00037720: 2020 2020 2020 2020 2020 2020 2020 7665                ve
+00037730: 6320 3d20 706e 616d 652e 7370 6c69 7428  c = pname.split(
+00037740: 275f 2729 0a20 2020 2020 2020 2020 2020  '_').           
+00037750: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00037760: 6c65 6e28 7665 6329 203e 2032 3a0a 2020  len(vec) > 2:.  
 00037770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037780: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
-00037790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000377a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000377b0: 656c 662e 6670 5f69 6e61 6d65 5b76 6563  elf.fp_iname[vec
-000377c0: 5b31 5d5d 5b69 6e73 7472 756d 656e 745d  [1]][instrument]
-000377d0: 203d 2027 5f27 202b 2076 6563 5b32 5d0a   = '_' + vec[2].
-000377e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000377f0: 2020 2020 2020 2020 2065 6c69 6620 6c65           elif le
-00037800: 6e28 7665 6329 203d 3d20 323a 0a20 2020  n(vec) == 2:.   
-00037810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037820: 2020 2020 2020 2020 2020 2020 200a 2020               .  
-00037830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037840: 2020 2020 2020 2020 2020 2320 5468 6973            # This
-00037850: 2061 6464 7320 6261 636b 2d63 6f6d 7061   adds back-compa
-00037860: 7469 6269 6c69 7479 2073 6f20 7573 6572  tibility so user
-00037870: 7320 6361 6e20 6465 6669 6e65 2061 2063  s can define a c
-00037880: 6f6d 6d6f 6e20 6670 2066 6f72 2061 6c6c  ommon fp for all
-00037890: 2069 6e73 7472 756d 656e 7473 2028 652e   instruments (e.
-000378a0: 672e 2c20 6670 5f70 3129 3a0a 2020 2020  g., fp_p1):.    
-000378b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000378c0: 2020 2020 2020 2020 7365 6c66 2e66 705f          self.fp_
-000378d0: 696e 616d 655b 7665 635b 315d 5d5b 696e  iname[vec[1]][in
-000378e0: 7374 7275 6d65 6e74 5d20 3d20 2727 0a0a  strument] = ''..
-000378f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037900: 2020 2020 2020 2020 656c 7365 3a0a 0a20          else:.. 
-00037910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037920: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00037930: 2045 7863 6570 7469 6f6e 2827 5072 696f   Exception('Prio
-00037940: 7220 666f 7220 6670 2069 7320 6e6f 7420  r for fp is not 
-00037950: 7072 6f70 6572 6c79 2064 6566 696e 6564  properly defined
-00037960: 3a20 6d75 7374 2062 652c 2065 2e67 2e2c  : must be, e.g.,
-00037970: 2066 705f 7031 2c20 6670 5f70 315f 696e   fp_p1, fp_p1_in
-00037980: 7374 206f 7220 6670 5f70 315f 696e 7374  st or fp_p1_inst
-00037990: 315f 696e 7374 322e 2043 7572 7265 6e74  1_inst2. Current
-000379a0: 6c79 2069 7320 272b 706e 616d 6529 0a0a  ly is '+pname)..
-000379b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000379c0: 2020 2020 6966 2070 6e61 6d65 5b30 3a31      if pname[0:1
-000379d0: 315d 203d 3d20 2770 6861 7365 6f66 6673  1] == 'phaseoffs
-000379e0: 6574 273a 0a20 2020 2020 2020 2020 2020  et':.           
-000379f0: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+00037780: 2020 2020 2020 2020 2020 6966 2069 6e73            if ins
+00037790: 7472 756d 656e 7420 696e 2076 6563 3a0a  trument in vec:.
+000377a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000377b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000377c0: 7365 6c66 2e6d 6469 6c75 7469 6f6e 5f69  self.mdilution_i
+000377d0: 6e61 6d65 5b69 6e73 7472 756d 656e 745d  name[instrument]
+000377e0: 203d 2027 5f27 2e6a 6f69 6e28 0a20 2020   = '_'.join(.   
+000377f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037810: 2076 6563 5b31 3a5d 290a 2020 2020 2020   vec[1:]).      
+00037820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037830: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00037840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037850: 2020 2020 6966 2069 6e73 7472 756d 656e      if instrumen
+00037860: 7420 696e 2076 6563 3a0a 2020 2020 2020  t in vec:.      
+00037870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037880: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00037890: 6469 6c75 7469 6f6e 5f69 6e61 6d65 5b69  dilution_iname[i
+000378a0: 6e73 7472 756d 656e 745d 203d 2076 6563  nstrument] = vec
+000378b0: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+000378c0: 2020 2020 2020 2020 6966 2070 6e61 6d65          if pname
+000378d0: 5b30 3a35 5d20 3d3d 2027 6d66 6c75 7827  [0:5] == 'mflux'
+000378e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000378f0: 2020 2020 2020 2020 2020 7665 6320 3d20            vec = 
+00037900: 706e 616d 652e 7370 6c69 7428 275f 2729  pname.split('_')
+00037910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037920: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00037930: 7665 6329 203e 2032 3a0a 2020 2020 2020  vec) > 2:.      
+00037940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037950: 2020 2020 2020 6966 2069 6e73 7472 756d        if instrum
+00037960: 656e 7420 696e 2076 6563 3a0a 2020 2020  ent in vec:.    
+00037970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037980: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00037990: 2e6d 666c 7578 5f69 6e61 6d65 5b69 6e73  .mflux_iname[ins
+000379a0: 7472 756d 656e 745d 203d 2027 5f27 2e6a  trument] = '_'.j
+000379b0: 6f69 6e28 0a20 2020 2020 2020 2020 2020  oin(.           
+000379c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000379d0: 2020 2020 2020 2020 2076 6563 5b31 3a5d           vec[1:]
+000379e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000379f0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
 00037a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037a10: 2020 2320 4e6f 7465 2074 6861 7420 616d    # Note that am
-00037a20: 706c 6974 7564 6520 6361 6e20 6265 2061  plitude can be a
-00037a30: 2070 6c61 6e65 7461 7279 2061 6e64 2069   planetary and i
-00037a40: 6e73 7472 756d 656e 7461 6c20 7061 7261  nstrumental para
-00037a50: 6d65 7465 720a 2020 2020 2020 2020 2020  meter.          
-00037a60: 2020 2020 2020 2020 2020 2020 2020 7665                ve
-00037a70: 6320 3d20 706e 616d 652e 7370 6c69 7428  c = pname.split(
-00037a80: 275f 2729 0a20 2020 2020 2020 2020 2020  '_').           
-00037a90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00037aa0: 6c65 6e28 7665 6329 203e 2033 3a0a 0a20  len(vec) > 3:.. 
-00037ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037ac0: 2020 2020 2020 2020 2020 2023 2054 6869             # Thi
-00037ad0: 7320 6973 2074 6865 2063 6173 6520 696e  s is the case in
-00037ae0: 2077 6869 6368 206d 756c 7469 706c 6520   which multiple 
-00037af0: 696e 7374 7275 6d65 6e74 7320 7368 6172  instruments shar
-00037b00: 6520 7468 6520 7061 7261 6d65 7465 723a  e the parameter:
-00037b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037b20: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00037b30: 696e 7374 7275 6d65 6e74 2069 6e20 7665  instrument in ve
-00037b40: 633a 0a0a 2020 2020 2020 2020 2020 2020  c:..            
-00037b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037b60: 2020 2020 7365 6c66 2e70 6861 7365 6f66      self.phaseof
-00037b70: 6673 6574 5f69 6e61 6d65 5b76 6563 5b31  fset_iname[vec[1
-00037b80: 5d5d 5b69 6e73 7472 756d 656e 745d 203d  ]][instrument] =
-00037b90: 2027 5f27 202b 2027 5f27 2e6a 6f69 6e28   '_' + '_'.join(
-00037ba0: 7665 635b 323a 5d29 0a0a 2020 2020 2020  vec[2:])..      
-00037bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037bc0: 2020 656c 6966 206c 656e 2876 6563 2920    elif len(vec) 
-00037bd0: 3d3d 2033 3a0a 0a20 2020 2020 2020 2020  == 3:..         
-00037be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037bf0: 2020 2023 2054 6869 7320 6973 2074 6865     # This is the
-00037c00: 2063 6173 6520 6f66 2061 2073 696e 676c   case of a singl
-00037c10: 6520 696e 7374 7275 6d65 6e74 3a0a 2020  e instrument:.  
+00037a10: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00037a20: 6e73 7472 756d 656e 7420 696e 2076 6563  nstrument in vec
+00037a30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00037a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037a50: 2020 7365 6c66 2e6d 666c 7578 5f69 6e61    self.mflux_ina
+00037a60: 6d65 5b69 6e73 7472 756d 656e 745d 203d  me[instrument] =
+00037a70: 2076 6563 5b31 5d0a 0a20 2020 2020 2020   vec[1]..       
+00037a80: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00037a90: 706e 616d 655b 303a 325d 203d 3d20 2766  pname[0:2] == 'f
+00037aa0: 7027 3a0a 0a20 2020 2020 2020 2020 2020  p':..           
+00037ab0: 2020 2020 2020 2020 2020 2020 2023 204e               # N
+00037ac0: 6f74 6520 7468 6174 2065 636c 6970 7365  ote that eclipse
+00037ad0: 2061 6e64 2074 7261 6e73 6974 2064 6570   and transit dep
+00037ae0: 7468 7320 6361 6e20 6265 2061 2070 6c61  ths can be a pla
+00037af0: 6e65 7461 7279 2061 6e64 2069 6e73 7472  netary and instr
+00037b00: 756d 656e 7461 6c20 7061 7261 6d65 7465  umental paramete
+00037b10: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+00037b20: 2020 2020 2020 2020 2020 7665 6320 3d20            vec = 
+00037b30: 706e 616d 652e 7370 6c69 7428 275f 2729  pname.split('_')
+00037b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037b50: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00037b60: 7665 6329 203e 2033 3a0a 0a20 2020 2020  vec) > 3:..     
+00037b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037b80: 2020 2020 2020 2023 2054 6869 7320 6973         # This is
+00037b90: 2074 6865 2063 6173 6520 696e 2077 6869   the case in whi
+00037ba0: 6368 206d 756c 7469 706c 6520 696e 7374  ch multiple inst
+00037bb0: 7275 6d65 6e74 7320 7368 6172 6520 616e  ruments share an
+00037bc0: 2065 636c 6970 7365 2064 6570 7468 2c20   eclipse depth, 
+00037bd0: 652e 672e 2c20 6670 5f70 315f 5445 5353  e.g., fp_p1_TESS
+00037be0: 315f 5445 5353 320a 2020 2020 2020 2020  1_TESS2.        
+00037bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037c00: 2020 2020 6966 2069 6e73 7472 756d 656e      if instrumen
+00037c10: 7420 696e 2076 6563 3a0a 0a20 2020 2020  t in vec:..     
 00037c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037c30: 2020 2020 2020 2020 2020 6966 2069 6e73            if ins
-00037c40: 7472 756d 656e 7420 696e 2076 6563 3a0a  trument in vec:.
-00037c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037c70: 2073 656c 662e 7068 6173 656f 6666 7365   self.phaseoffse
-00037c80: 745f 696e 616d 655b 7665 635b 315d 5d5b  t_iname[vec[1]][
-00037c90: 696e 7374 7275 6d65 6e74 5d20 3d20 275f  instrument] = '_
-00037ca0: 2720 2b20 7665 635b 325d 0a0a 2020 2020  ' + vec[2]..    
+00037c30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00037c40: 6670 5f69 6e61 6d65 5b76 6563 5b31 5d5d  fp_iname[vec[1]]
+00037c50: 5b69 6e73 7472 756d 656e 745d 203d 2027  [instrument] = '
+00037c60: 5f27 202b 2027 5f27 2e6a 6f69 6e28 7665  _' + '_'.join(ve
+00037c70: 635b 323a 5d29 0a0a 2020 2020 2020 2020  c[2:])..        
+00037c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037c90: 656c 6966 206c 656e 2876 6563 2920 3d3d  elif len(vec) ==
+00037ca0: 2033 3a0a 0a20 2020 2020 2020 2020 2020   3:..           
 00037cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037cc0: 2020 2020 656c 6966 206c 656e 2876 6563      elif len(vec
-00037cd0: 2920 3d3d 2032 3a0a 0a20 2020 2020 2020  ) == 2:..       
-00037ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037cf0: 2020 2020 2023 2054 6869 7320 6164 6473       # This adds
-00037d00: 2062 6163 6b2d 636f 6d70 6174 6962 696c   back-compatibil
-00037d10: 6974 7920 736f 2075 7365 7273 2063 616e  ity so users can
-00037d20: 2064 6566 696e 6520 6120 636f 6d6d 6f6e   define a common
-00037d30: 2066 6f72 2061 6c6c 2069 6e73 7472 756d   for all instrum
-00037d40: 656e 7473 3a0a 2020 2020 2020 2020 2020  ents:.          
-00037d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037d60: 2020 7365 6c66 2e70 6861 7365 6f66 6673    self.phaseoffs
-00037d70: 6574 5f69 6e61 6d65 5b76 6563 5b31 5d5d  et_iname[vec[1]]
-00037d80: 5b69 6e73 7472 756d 656e 745d 203d 2027  [instrument] = '
-00037d90: 270a 0a20 2020 2020 2020 2020 2020 2020  '..             
-00037da0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00037db0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00037dc0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00037dd0: 6973 6520 4578 6365 7074 696f 6e28 2750  ise Exception('P
-00037de0: 7269 6f72 2066 6f72 2070 6861 7365 6f66  rior for phaseof
-00037df0: 6673 6574 2069 7320 6e6f 7420 7072 6f70  fset is not prop
-00037e00: 6572 6c79 2064 6566 696e 6564 3a20 6d75  erly defined: mu
-00037e10: 7374 2062 652c 2065 2e67 2e2c 2070 6861  st be, e.g., pha
-00037e20: 7365 6f66 6673 6574 5f70 312c 2070 6861  seoffset_p1, pha
-00037e30: 7365 6f66 6673 6574 5f70 315f 696e 7374  seoffset_p1_inst
-00037e40: 206f 7220 7068 6173 656f 6666 7365 745f   or phaseoffset_
-00037e50: 7031 5f69 6e73 7431 5f69 6e73 7432 2e20  p1_inst1_inst2. 
-00037e60: 4375 7272 656e 746c 7920 6973 2027 2b70  Currently is '+p
-00037e70: 6e61 6d65 290a 0a20 2020 2020 2020 2020  name)..         
-00037e80: 2020 2020 2020 2020 2020 2069 6620 706e             if pn
-00037e90: 616d 655b 303a 325d 203d 3d20 2770 5f27  ame[0:2] == 'p_'
-00037ea0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-00037eb0: 2020 2020 2020 2020 2020 2076 6563 203d             vec =
-00037ec0: 2070 6e61 6d65 2e73 706c 6974 2827 5f27   pname.split('_'
-00037ed0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00037ee0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-00037ef0: 2876 6563 2920 3e20 333a 0a0a 2020 2020  (vec) > 3:..    
-00037f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037f10: 2020 2020 2020 2020 2320 5468 6973 2069          # This i
-00037f20: 7320 7468 6520 6361 7365 2069 6e20 7768  s the case in wh
-00037f30: 6963 6820 6d75 6c74 6970 6c65 2069 6e73  ich multiple ins
-00037f40: 7472 756d 656e 7473 2073 6861 7265 2061  truments share a
-00037f50: 2070 6c61 6e65 742d 746f 2d73 7461 7220   planet-to-star 
-00037f60: 7261 7469 6f2c 2065 2e67 2e2c 2070 5f70  ratio, e.g., p_p
-00037f70: 315f 5445 5353 315f 5445 5353 320a 2020  1_TESS1_TESS2.  
-00037f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037f90: 2020 2020 2020 2020 2020 6966 2069 6e73            if ins
-00037fa0: 7472 756d 656e 7420 696e 2076 6563 3a0a  trument in vec:.
-00037fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037fd0: 2073 656c 662e 705f 696e 616d 655b 7665   self.p_iname[ve
-00037fe0: 635b 315d 5d5b 696e 7374 7275 6d65 6e74  c[1]][instrument
-00037ff0: 5d20 3d20 275f 2720 2b20 275f 272e 6a6f  ] = '_' + '_'.jo
-00038000: 696e 2876 6563 5b32 3a5d 290a 0a20 2020  in(vec[2:])..   
-00038010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038020: 2020 2020 2065 6c69 6620 6c65 6e28 7665       elif len(ve
-00038030: 6329 203d 3d20 333a 0a0a 2020 2020 2020  c) == 3:..      
-00038040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038050: 2020 2020 2020 2320 5468 6973 2069 7320        # This is 
-00038060: 7468 6520 6361 7365 206f 6620 6120 7369  the case of a si
-00038070: 6e67 6c65 2069 6e73 7472 756d 656e 7420  ngle instrument 
-00038080: 7769 7468 2070 2c20 652e 672e 2c20 705f  with p, e.g., p_
-00038090: 7031 5f54 4553 533a 0a20 2020 2020 2020  p1_TESS:.       
-000380a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000380b0: 2020 2020 2069 6620 696e 7374 7275 6d65       if instrume
-000380c0: 6e74 2069 6e20 7665 633a 0a0a 2020 2020  nt in vec:..    
-000380d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000380e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000380f0: 2e70 5f69 6e61 6d65 5b76 6563 5b31 5d5d  .p_iname[vec[1]]
-00038100: 5b69 6e73 7472 756d 656e 745d 203d 2027  [instrument] = '
-00038110: 5f27 202b 2076 6563 5b32 5d0a 0a20 2020  _' + vec[2]..   
-00038120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038130: 2020 2020 2065 6c69 6620 6c65 6e28 7665       elif len(ve
-00038140: 6329 203d 3d20 323a 0a0a 2020 2020 2020  c) == 2:..      
-00038150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038160: 2020 2020 2020 2320 5468 6973 2061 6464        # This add
-00038170: 7320 6261 636b 2d63 6f6d 7061 7469 6269  s back-compatibi
-00038180: 6c69 7479 2073 6f20 7573 6572 7320 6361  lity so users ca
-00038190: 6e20 6465 6669 6e65 2061 2063 6f6d 6d6f  n define a commo
-000381a0: 6e20 7020 666f 7220 616c 6c20 696e 7374  n p for all inst
-000381b0: 7275 6d65 6e74 7320 2865 2e67 2e2c 2070  ruments (e.g., p
-000381c0: 5f70 3129 3a0a 2020 2020 2020 2020 2020  _p1):.          
-000381d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000381e0: 2020 7365 6c66 2e70 5f69 6e61 6d65 5b76    self.p_iname[v
-000381f0: 6563 5b31 5d5d 5b69 6e73 7472 756d 656e  ec[1]][instrumen
-00038200: 745d 203d 2027 270a 0a20 2020 2020 2020  t] = ''..       
-00038210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038220: 2065 6c73 653a 0a0a 2020 2020 2020 2020   else:..        
-00038230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038240: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
-00038250: 696f 6e28 2750 7269 6f72 2066 6f72 2070  ion('Prior for p
-00038260: 2069 7320 6e6f 7420 7072 6f70 6572 6c79   is not properly
-00038270: 2064 6566 696e 6564 3a20 6d75 7374 2062   defined: must b
-00038280: 652c 2065 2e67 2e2c 2070 5f70 312c 2070  e, e.g., p_p1, p
-00038290: 5f70 315f 696e 7374 206f 7220 705f 7031  _p1_inst or p_p1
-000382a0: 5f69 6e73 7431 5f69 6e73 7432 2e20 4375  _inst1_inst2. Cu
-000382b0: 7272 656e 746c 7920 6973 2027 2b70 6e61  rrently is '+pna
-000382c0: 6d65 290a 0a20 2020 2020 2020 2020 2020  me)..           
-000382d0: 2020 2020 2020 2020 2069 6620 706e 616d           if pnam
-000382e0: 655b 303a 325d 203d 3d20 2770 3127 3a0a  e[0:2] == 'p1':.
-000382f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038300: 2020 2020 2020 2020 2076 6563 203d 2070           vec = p
-00038310: 6e61 6d65 2e73 706c 6974 2827 5f27 290a  name.split('_').
-00038320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038330: 2020 2020 2020 2020 6966 206c 656e 2876          if len(v
-00038340: 6563 2920 3e20 333a 0a0a 2020 2020 2020  ec) > 3:..      
-00038350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038360: 2020 2020 2020 2320 5468 6973 2069 7320        # This is 
-00038370: 7468 6520 6361 7365 2069 6e20 7768 6963  the case in whic
-00038380: 6820 6d75 6c74 6970 6c65 2069 6e73 7472  h multiple instr
-00038390: 756d 656e 7473 2073 6861 7265 2061 2043  uments share a C
-000383a0: 5720 7365 6d69 2d70 6c61 6e65 742d 746f  W semi-planet-to
-000383b0: 2d73 7461 7220 7261 7469 6f2c 2065 2e67  -star ratio, e.g
-000383c0: 2e2c 2070 315f 7031 5f54 4553 5331 5f54  ., p1_p1_TESS1_T
-000383d0: 4553 5332 0a20 2020 2020 2020 2020 2020  ESS2.           
-000383e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000383f0: 2069 6620 696e 7374 7275 6d65 6e74 2069   if instrument i
-00038400: 6e20 7665 633a 0a0a 2020 2020 2020 2020  n vec:..        
-00038410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038420: 2020 2020 2020 2020 7365 6c66 2e70 315f          self.p1_
-00038430: 696e 616d 655b 7665 635b 315d 5d5b 696e  iname[vec[1]][in
-00038440: 7374 7275 6d65 6e74 5d20 3d20 275f 2720  strument] = '_' 
-00038450: 2b20 275f 272e 6a6f 696e 2876 6563 5b32  + '_'.join(vec[2
-00038460: 3a5d 290a 0a20 2020 2020 2020 2020 2020  :])..           
-00038470: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00038480: 6620 6c65 6e28 7665 6329 203d 3d20 333a  f len(vec) == 3:
-00038490: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000384a0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-000384b0: 5468 6973 2069 7320 7468 6520 6361 7365  This is the case
-000384c0: 206f 6620 6120 7369 6e67 6c65 2069 6e73   of a single ins
-000384d0: 7472 756d 656e 7420 7769 7468 2070 312c  trument with p1,
-000384e0: 2065 2e67 2e2c 2070 315f 7031 5f54 4553   e.g., p1_p1_TES
-000384f0: 533a 0a20 2020 2020 2020 2020 2020 2020  S:.             
-00038500: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00038510: 6620 696e 7374 7275 6d65 6e74 2069 6e20  f instrument in 
-00038520: 7665 633a 200a 0a20 2020 2020 2020 2020  vec: ..         
-00038530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038540: 2020 2020 2020 2073 656c 662e 7031 5f69         self.p1_i
-00038550: 6e61 6d65 5b76 6563 5b31 5d5d 5b69 6e73  name[vec[1]][ins
-00038560: 7472 756d 656e 745d 203d 2027 5f27 202b  trument] = '_' +
-00038570: 2076 6563 5b32 5d0a 0a20 2020 2020 2020   vec[2]..       
+00037cc0: 2023 2054 6869 7320 6973 2074 6865 2063   # This is the c
+00037cd0: 6173 6520 6f66 2061 2073 696e 676c 6520  ase of a single 
+00037ce0: 696e 7374 7275 6d65 6e74 2077 6974 6820  instrument with 
+00037cf0: 6670 2c20 652e 672e 2c20 6670 5f70 315f  fp, e.g., fp_p1_
+00037d00: 5445 5353 0a20 2020 2020 2020 2020 2020  TESS.           
+00037d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037d20: 2069 6620 696e 7374 7275 6d65 6e74 2069   if instrument i
+00037d30: 6e20 7665 633a 0a20 2020 2020 2020 2020  n vec:.         
+00037d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037d50: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00037d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037d70: 2020 2020 2020 2020 7365 6c66 2e66 705f          self.fp_
+00037d80: 696e 616d 655b 7665 635b 315d 5d5b 696e  iname[vec[1]][in
+00037d90: 7374 7275 6d65 6e74 5d20 3d20 275f 2720  strument] = '_' 
+00037da0: 2b20 7665 635b 325d 0a0a 2020 2020 2020  + vec[2]..      
+00037db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037dc0: 2020 656c 6966 206c 656e 2876 6563 2920    elif len(vec) 
+00037dd0: 3d3d 2032 3a0a 2020 2020 2020 2020 2020  == 2:.          
+00037de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037df0: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
+00037e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037e10: 2020 2023 2054 6869 7320 6164 6473 2062     # This adds b
+00037e20: 6163 6b2d 636f 6d70 6174 6962 696c 6974  ack-compatibilit
+00037e30: 7920 736f 2075 7365 7273 2063 616e 2064  y so users can d
+00037e40: 6566 696e 6520 6120 636f 6d6d 6f6e 2066  efine a common f
+00037e50: 7020 666f 7220 616c 6c20 696e 7374 7275  p for all instru
+00037e60: 6d65 6e74 7320 2865 2e67 2e2c 2066 705f  ments (e.g., fp_
+00037e70: 7031 293a 0a20 2020 2020 2020 2020 2020  p1):.           
+00037e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037e90: 2073 656c 662e 6670 5f69 6e61 6d65 5b76   self.fp_iname[v
+00037ea0: 6563 5b31 5d5d 5b69 6e73 7472 756d 656e  ec[1]][instrumen
+00037eb0: 745d 203d 2027 270a 0a20 2020 2020 2020  t] = ''..       
+00037ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037ed0: 2065 6c73 653a 0a0a 2020 2020 2020 2020   else:..        
+00037ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037ef0: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
+00037f00: 696f 6e28 2750 7269 6f72 2066 6f72 2066  ion('Prior for f
+00037f10: 7020 6973 206e 6f74 2070 726f 7065 726c  p is not properl
+00037f20: 7920 6465 6669 6e65 643a 206d 7573 7420  y defined: must 
+00037f30: 6265 2c20 652e 672e 2c20 6670 5f70 312c  be, e.g., fp_p1,
+00037f40: 2066 705f 7031 5f69 6e73 7420 6f72 2066   fp_p1_inst or f
+00037f50: 705f 7031 5f69 6e73 7431 5f69 6e73 7432  p_p1_inst1_inst2
+00037f60: 2e20 4375 7272 656e 746c 7920 6973 2027  . Currently is '
+00037f70: 2b70 6e61 6d65 290a 0a20 2020 2020 2020  +pname)..       
+00037f80: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00037f90: 706e 616d 655b 303a 3131 5d20 3d3d 2027  pname[0:11] == '
+00037fa0: 7068 6173 656f 6666 7365 7427 3a0a 2020  phaseoffset':.  
+00037fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037fc0: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
+00037fd0: 2020 2020 2020 2020 2020 2023 204e 6f74             # Not
+00037fe0: 6520 7468 6174 2061 6d70 6c69 7475 6465  e that amplitude
+00037ff0: 2063 616e 2062 6520 6120 706c 616e 6574   can be a planet
+00038000: 6172 7920 616e 6420 696e 7374 7275 6d65  ary and instrume
+00038010: 6e74 616c 2070 6172 616d 6574 6572 0a20  ntal parameter. 
+00038020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038030: 2020 2020 2020 2076 6563 203d 2070 6e61         vec = pna
+00038040: 6d65 2e73 706c 6974 2827 5f27 290a 2020  me.split('_').  
+00038050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038060: 2020 2020 2020 6966 206c 656e 2876 6563        if len(vec
+00038070: 2920 3e20 333a 0a0a 2020 2020 2020 2020  ) > 3:..        
+00038080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038090: 2020 2020 2320 5468 6973 2069 7320 7468      # This is th
+000380a0: 6520 6361 7365 2069 6e20 7768 6963 6820  e case in which 
+000380b0: 6d75 6c74 6970 6c65 2069 6e73 7472 756d  multiple instrum
+000380c0: 656e 7473 2073 6861 7265 2074 6865 2070  ents share the p
+000380d0: 6172 616d 6574 6572 3a0a 2020 2020 2020  arameter:.      
+000380e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000380f0: 2020 2020 2020 6966 2069 6e73 7472 756d        if instrum
+00038100: 656e 7420 696e 2076 6563 3a0a 0a20 2020  ent in vec:..   
+00038110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038120: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00038130: 662e 7068 6173 656f 6666 7365 745f 696e  f.phaseoffset_in
+00038140: 616d 655b 7665 635b 315d 5d5b 696e 7374  ame[vec[1]][inst
+00038150: 7275 6d65 6e74 5d20 3d20 275f 2720 2b20  rument] = '_' + 
+00038160: 275f 272e 6a6f 696e 2876 6563 5b32 3a5d  '_'.join(vec[2:]
+00038170: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00038180: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00038190: 6c65 6e28 7665 6329 203d 3d20 333a 0a0a  len(vec) == 3:..
+000381a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000381b0: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
+000381c0: 6973 2069 7320 7468 6520 6361 7365 206f  is is the case o
+000381d0: 6620 6120 7369 6e67 6c65 2069 6e73 7472  f a single instr
+000381e0: 756d 656e 743a 0a20 2020 2020 2020 2020  ument:.         
+000381f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038200: 2020 2069 6620 696e 7374 7275 6d65 6e74     if instrument
+00038210: 2069 6e20 7665 633a 0a0a 2020 2020 2020   in vec:..      
+00038220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038230: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00038240: 6861 7365 6f66 6673 6574 5f69 6e61 6d65  haseoffset_iname
+00038250: 5b76 6563 5b31 5d5d 5b69 6e73 7472 756d  [vec[1]][instrum
+00038260: 656e 745d 203d 2027 5f27 202b 2076 6563  ent] = '_' + vec
+00038270: 5b32 5d0a 0a20 2020 2020 2020 2020 2020  [2]..           
+00038280: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00038290: 6620 6c65 6e28 7665 6329 203d 3d20 323a  f len(vec) == 2:
+000382a0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000382b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+000382c0: 5468 6973 2061 6464 7320 6261 636b 2d63  This adds back-c
+000382d0: 6f6d 7061 7469 6269 6c69 7479 2073 6f20  ompatibility so 
+000382e0: 7573 6572 7320 6361 6e20 6465 6669 6e65  users can define
+000382f0: 2061 2063 6f6d 6d6f 6e20 666f 7220 616c   a common for al
+00038300: 6c20 696e 7374 7275 6d65 6e74 733a 0a20  l instruments:. 
+00038310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038320: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00038330: 7068 6173 656f 6666 7365 745f 696e 616d  phaseoffset_inam
+00038340: 655b 7665 635b 315d 5d5b 696e 7374 7275  e[vec[1]][instru
+00038350: 6d65 6e74 5d20 3d20 2727 0a0a 2020 2020  ment] = ''..    
+00038360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038370: 2020 2020 656c 7365 3a0a 0a20 2020 2020      else:..     
+00038380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038390: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
+000383a0: 6570 7469 6f6e 2827 5072 696f 7220 666f  eption('Prior fo
+000383b0: 7220 7068 6173 656f 6666 7365 7420 6973  r phaseoffset is
+000383c0: 206e 6f74 2070 726f 7065 726c 7920 6465   not properly de
+000383d0: 6669 6e65 643a 206d 7573 7420 6265 2c20  fined: must be, 
+000383e0: 652e 672e 2c20 7068 6173 656f 6666 7365  e.g., phaseoffse
+000383f0: 745f 7031 2c20 7068 6173 656f 6666 7365  t_p1, phaseoffse
+00038400: 745f 7031 5f69 6e73 7420 6f72 2070 6861  t_p1_inst or pha
+00038410: 7365 6f66 6673 6574 5f70 315f 696e 7374  seoffset_p1_inst
+00038420: 315f 696e 7374 322e 2043 7572 7265 6e74  1_inst2. Current
+00038430: 6c79 2069 7320 272b 706e 616d 6529 0a0a  ly is '+pname)..
+00038440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038450: 2020 2020 6966 2070 6e61 6d65 5b30 3a32      if pname[0:2
+00038460: 5d20 3d3d 2027 705f 273a 0a0a 2020 2020  ] == 'p_':..    
+00038470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038480: 2020 2020 7665 6320 3d20 706e 616d 652e      vec = pname.
+00038490: 7370 6c69 7428 275f 2729 0a20 2020 2020  split('_').     
+000384a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000384b0: 2020 2069 6620 6c65 6e28 7665 6329 203e     if len(vec) >
+000384c0: 2033 3a0a 0a20 2020 2020 2020 2020 2020   3:..           
+000384d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000384e0: 2023 2054 6869 7320 6973 2074 6865 2063   # This is the c
+000384f0: 6173 6520 696e 2077 6869 6368 206d 756c  ase in which mul
+00038500: 7469 706c 6520 696e 7374 7275 6d65 6e74  tiple instrument
+00038510: 7320 7368 6172 6520 6120 706c 616e 6574  s share a planet
+00038520: 2d74 6f2d 7374 6172 2072 6174 696f 2c20  -to-star ratio, 
+00038530: 652e 672e 2c20 705f 7031 5f54 4553 5331  e.g., p_p1_TESS1
+00038540: 5f54 4553 5332 0a20 2020 2020 2020 2020  _TESS2.         
+00038550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038560: 2020 2069 6620 696e 7374 7275 6d65 6e74     if instrument
+00038570: 2069 6e20 7665 633a 0a0a 2020 2020 2020   in vec:..      
 00038580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038590: 2065 6c69 6620 6c65 6e28 7665 6329 203d   elif len(vec) =
-000385a0: 3d20 323a 0a0a 2020 2020 2020 2020 2020  = 2:..          
-000385b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000385c0: 2020 2320 5468 6973 2061 6464 7320 6261    # This adds ba
-000385d0: 636b 2d63 6f6d 7061 7469 6269 6c69 7479  ck-compatibility
-000385e0: 2073 6f20 7573 6572 7320 6361 6e20 6465   so users can de
-000385f0: 6669 6e65 2061 2063 6f6d 6d6f 6e20 7020  fine a common p 
-00038600: 666f 7220 616c 6c20 696e 7374 7275 6d65  for all instrume
-00038610: 6e74 7320 2865 2e67 2e2c 2070 5f70 3129  nts (e.g., p_p1)
-00038620: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00038630: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00038640: 6c66 2e70 315f 696e 616d 655b 7665 635b  lf.p1_iname[vec[
-00038650: 315d 5d5b 696e 7374 7275 6d65 6e74 5d20  1]][instrument] 
-00038660: 3d20 2727 0a0a 2020 2020 2020 2020 2020  = ''..          
-00038670: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00038680: 7365 3a20 200a 0a20 2020 2020 2020 2020  se:  ..         
-00038690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000386a0: 2020 2072 6169 7365 2045 7863 6570 7469     raise Excepti
-000386b0: 6f6e 2827 5072 696f 7220 666f 7220 7031  on('Prior for p1
-000386c0: 2f70 3220 6973 206e 6f74 2070 726f 7065  /p2 is not prope
-000386d0: 726c 7920 6465 6669 6e65 643a 206d 7573  rly defined: mus
-000386e0: 7420 6265 2c20 652e 672e 2c20 7031 5f70  t be, e.g., p1_p
-000386f0: 312c 2070 315f 7031 5f69 6e73 7420 6f72  1, p1_p1_inst or
-00038700: 2070 315f 7031 5f69 6e73 7431 5f69 6e73   p1_p1_inst1_ins
-00038710: 7432 2e20 4375 7272 656e 746c 7920 6973  t2. Currently is
-00038720: 2027 2b70 6e61 6d65 290a 0a20 2020 2020   '+pname)..     
-00038730: 2020 2020 2020 2023 2053 6574 2074 6865         # Set the
-00038740: 206d 6f64 656c 2d74 7970 6520 746f 204d   model-type to M
-00038750: 2874 293a 0a20 2020 2020 2020 2020 2020  (t):.           
-00038760: 2073 656c 662e 6576 616c 7561 7465 203d   self.evaluate =
-00038770: 2073 656c 662e 6576 616c 7561 7465 5f6d   self.evaluate_m
-00038780: 6f64 656c 0a20 2020 2020 2020 2020 2020  odel.           
-00038790: 2073 656c 662e 6765 6e65 7261 7465 203d   self.generate =
-000387a0: 2073 656c 662e 6765 6e65 7261 7465 5f6c   self.generate_l
-000387b0: 635f 6d6f 6465 6c0a 0a20 2020 2020 2020  c_model..       
-000387c0: 2065 6c69 6620 6d6f 6465 6c74 7970 6520   elif modeltype 
-000387d0: 3d3d 2027 7276 273a 0a20 2020 2020 2020  == 'rv':.       
-000387e0: 2020 2020 2073 656c 662e 6d6f 6465 6c74       self.modelt
-000387f0: 7970 6520 3d20 2772 7627 0a20 2020 2020  ype = 'rv'.     
-00038800: 2020 2020 2020 2023 2049 6e68 6572 7420         # Inhert 
-00038810: 7469 6d65 732c 2052 5673 2c20 6572 726f  times, RVs, erro
-00038820: 7273 2c20 696e 6465 7865 732c 2065 7463  rs, indexes, etc
-00038830: 2e20 6672 6f6d 2064 6174 613a 0a20 2020  . from data:.   
-00038840: 2020 2020 2020 2020 2073 656c 662e 7420           self.t 
-00038850: 3d20 6461 7461 2e74 5f72 760a 2020 2020  = data.t_rv.    
-00038860: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
-00038870: 2064 6174 612e 795f 7276 0a20 2020 2020   data.y_rv.     
-00038880: 2020 2020 2020 2073 656c 662e 7965 7272         self.yerr
-00038890: 203d 2064 6174 612e 7965 7272 5f72 760a   = data.yerr_rv.
-000388a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000388b0: 2e74 696d 6573 203d 2064 6174 612e 7469  .times = data.ti
-000388c0: 6d65 735f 7276 0a20 2020 2020 2020 2020  mes_rv.         
-000388d0: 2020 2073 656c 662e 6461 7461 203d 2064     self.data = d
-000388e0: 6174 612e 6461 7461 5f72 760a 2020 2020  ata.data_rv.    
-000388f0: 2020 2020 2020 2020 7365 6c66 2e65 7272          self.err
-00038900: 6f72 7320 3d20 6461 7461 2e65 7272 6f72  ors = data.error
-00038910: 735f 7276 0a20 2020 2020 2020 2020 2020  s_rv.           
-00038920: 2073 656c 662e 696e 7374 7275 6d65 6e74   self.instrument
-00038930: 7320 3d20 6461 7461 2e69 6e73 7472 756d  s = data.instrum
-00038940: 656e 7473 5f72 760a 2020 2020 2020 2020  ents_rv.        
-00038950: 2020 2020 7365 6c66 2e6e 696e 7374 7275      self.ninstru
-00038960: 6d65 6e74 7320 3d20 6461 7461 2e6e 696e  ments = data.nin
-00038970: 7374 7275 6d65 6e74 735f 7276 0a20 2020  struments_rv.   
-00038980: 2020 2020 2020 2020 2073 656c 662e 696e           self.in
-00038990: 616d 6573 203d 2064 6174 612e 696e 616d  ames = data.inam
-000389a0: 6573 5f72 760a 2020 2020 2020 2020 2020  es_rv.          
-000389b0: 2020 7365 6c66 2e69 6e73 7472 756d 656e    self.instrumen
-000389c0: 745f 696e 6465 7865 7320 3d20 6461 7461  t_indexes = data
-000389d0: 2e69 6e73 7472 756d 656e 745f 696e 6465  .instrument_inde
-000389e0: 7865 735f 7276 0a20 2020 2020 2020 2020  xes_rv.         
-000389f0: 2020 2073 656c 662e 6c6d 5f62 6f6f 6c65     self.lm_boole
-00038a00: 616e 203d 2064 6174 612e 6c6d 5f72 765f  an = data.lm_rv_
-00038a10: 626f 6f6c 6561 6e0a 2020 2020 2020 2020  boolean.        
-00038a20: 2020 2020 7365 6c66 2e6c 6d5f 6172 6775      self.lm_argu
-00038a30: 6d65 6e74 7320 3d20 6461 7461 2e6c 6d5f  ments = data.lm_
-00038a40: 7276 5f61 7267 756d 656e 7473 0a20 2020  rv_arguments.   
-00038a50: 2020 2020 2020 2020 2073 656c 662e 6c6d           self.lm
-00038a60: 5f6e 203d 207b 7d0a 2020 2020 2020 2020  _n = {}.        
-00038a70: 2020 2020 7365 6c66 2e67 6c6f 6261 6c5f      self.global_
-00038a80: 6d6f 6465 6c20 3d20 6461 7461 2e67 6c6f  model = data.glo
-00038a90: 6261 6c5f 7276 5f6d 6f64 656c 0a20 2020  bal_rv_model.   
-00038aa0: 2020 2020 2020 2020 2073 656c 662e 6469           self.di
-00038ab0: 6374 696f 6e61 7279 203d 2064 6174 612e  ctionary = data.
-00038ac0: 7276 5f6f 7074 696f 6e73 0a20 2020 2020  rv_options.     
-00038ad0: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
-00038ae0: 6572 696e 6720 3d20 6461 7461 2e6e 756d  ering = data.num
-00038af0: 6265 7269 6e67 5f72 765f 706c 616e 6574  bering_rv_planet
-00038b00: 730a 2020 2020 2020 2020 2020 2020 7365  s.            se
-00038b10: 6c66 2e6e 756d 6265 7269 6e67 2e73 6f72  lf.numbering.sor
-00038b20: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-00038b30: 7365 6c66 2e6e 706c 616e 6574 7320 3d20  self.nplanets = 
-00038b40: 6c65 6e28 7365 6c66 2e6e 756d 6265 7269  len(self.numberi
-00038b50: 6e67 290a 2020 2020 2020 2020 2020 2020  ng).            
-00038b60: 7365 6c66 2e6d 6f64 656c 203d 207b 7d0a  self.model = {}.
-00038b70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00038b80: 2e6e 6461 7461 706f 696e 7473 5f61 6c6c  .ndatapoints_all
-00038b90: 5f69 6e73 7472 756d 656e 7473 203d 2030  _instruments = 0
-00038ba0: 0a20 2020 2020 2020 2020 2020 2023 2046  .            # F
-00038bb0: 6972 7374 2c20 6966 2061 2067 6c6f 6261  irst, if a globa
-00038bc0: 6c20 6d6f 6465 6c2c 2067 656e 6572 6174  l model, generat
-00038bd0: 6520 6172 7261 7920 7468 6174 2077 696c  e array that wil
-00038be0: 6c20 7361 7665 2074 6869 733a 0a20 2020  l save this:.   
-00038bf0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00038c00: 2e67 6c6f 6261 6c5f 6d6f 6465 6c3a 0a20  .global_model:. 
-00038c10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00038c20: 656c 662e 6d6f 6465 6c5b 2767 6c6f 6261  elf.model['globa
-00038c30: 6c27 5d20 3d20 6e70 2e7a 6572 6f73 286c  l'] = np.zeros(l
-00038c40: 656e 2873 656c 662e 7429 290a 2020 2020  en(self.t)).    
-00038c50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00038c60: 2e6d 6f64 656c 5b27 676c 6f62 616c 5f76  .model['global_v
-00038c70: 6172 6961 6e63 6573 275d 203d 206e 702e  ariances'] = np.
-00038c80: 7a65 726f 7328 6c65 6e28 7365 6c66 2e74  zeros(len(self.t
-00038c90: 2929 0a20 2020 2020 2020 2020 2020 2023  )).            #
-00038ca0: 2049 6e69 7469 616c 697a 6520 7261 6476   Initialize radv
-00038cb0: 656c 3a0a 2020 2020 2020 2020 2020 2020  el:.            
-00038cc0: 7365 6c66 2e6d 6f64 656c 5b27 7261 6476  self.model['radv
-00038cd0: 656c 275d 203d 2069 6e69 745f 7261 6476  el'] = init_radv
-00038ce0: 656c 286e 706c 616e 6574 733d 7365 6c66  el(nplanets=self
-00038cf0: 2e6e 706c 616e 6574 7329 0a20 2020 2020  .nplanets).     
-00038d00: 2020 2020 2020 2023 2046 6972 7374 2067         # First g
-00038d10: 6f20 6172 6f75 6e64 2061 6c6c 2070 6c61  o around all pla
-00038d20: 6e65 7473 2074 6f20 636f 6d70 7574 6520  nets to compute 
-00038d30: 7468 6520 6675 6c6c 2052 5620 6d6f 6465  the full RV mode
-00038d40: 6c73 3a0a 2020 2020 2020 2020 2020 2020  ls:.            
-00038d50: 666f 7220 6920 696e 2073 656c 662e 6e75  for i in self.nu
-00038d60: 6d62 6572 696e 673a 0a20 2020 2020 2020  mbering:.       
-00038d70: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-00038d80: 6465 6c5b 2770 2720 2b20 7374 7228 6929  del['p' + str(i)
-00038d90: 5d20 3d20 6e70 2e6f 6e65 7328 6c65 6e28  ] = np.ones(len(
-00038da0: 7365 6c66 2e74 2929 0a20 2020 2020 2020  self.t)).       
-00038db0: 2020 2020 2023 204e 6f77 2076 6172 6961       # Now varia
-00038dc0: 626c 6520 746f 2073 6176 6520 6675 6c6c  ble to save full
-00038dd0: 2052 5620 4b65 706c 6572 6961 6e20 6d6f   RV Keplerian mo
-00038de0: 6465 6c3a 0a20 2020 2020 2020 2020 2020  del:.           
-00038df0: 2073 656c 662e 6d6f 6465 6c5b 274b 6570   self.model['Kep
-00038e00: 6c65 7269 616e 275d 203d 206e 702e 6f6e  lerian'] = np.on
-00038e10: 6573 286c 656e 2873 656c 662e 7429 290a  es(len(self.t)).
-00038e20: 2020 2020 2020 2020 2020 2020 2320 5361              # Sa
-00038e30: 6d65 2066 6f72 204b 6570 6c65 7269 616e  me for Keplerian
-00038e40: 202b 2074 7265 6e64 733a 0a20 2020 2020   + trends:.     
-00038e50: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
-00038e60: 6c5b 274b 6570 6c65 7269 616e 2b54 7265  l['Keplerian+Tre
-00038e70: 6e64 275d 203d 206e 702e 6f6e 6573 286c  nd'] = np.ones(l
-00038e80: 656e 2873 656c 662e 7429 290a 2020 2020  en(self.t)).    
-00038e90: 2020 2020 2020 2020 2320 476f 2061 726f          # Go aro
-00038ea0: 756e 6420 6561 6368 2069 6e73 7472 756d  und each instrum
-00038eb0: 656e 743a 0a20 2020 2020 2020 2020 2020  ent:.           
-00038ec0: 2066 6f72 2069 6e73 7472 756d 656e 7420   for instrument 
-00038ed0: 696e 2073 656c 662e 696e 616d 6573 3a0a  in self.inames:.
-00038ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038ef0: 7365 6c66 2e6d 6f64 656c 5b69 6e73 7472  self.model[instr
-00038f00: 756d 656e 745d 203d 207b 7d0a 2020 2020  ument] = {}.    
-00038f10: 2020 2020 2020 2020 2020 2020 2320 4578              # Ex
-00038f20: 7472 6163 7420 6e75 6d62 6572 206f 6620  tract number of 
-00038f30: 6461 7461 706f 696e 7473 2070 6572 2069  datapoints per i
-00038f40: 6e73 7472 756d 656e 743a 0a20 2020 2020  nstrument:.     
-00038f50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00038f60: 6e64 6174 6170 6f69 6e74 735f 7065 725f  ndatapoints_per_
-00038f70: 696e 7374 7275 6d65 6e74 5b69 6e73 7472  instrument[instr
-00038f80: 756d 656e 745d 203d 206c 656e 280a 2020  ument] = len(.  
-00038f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038fa0: 2020 7365 6c66 2e69 6e73 7472 756d 656e    self.instrumen
-00038fb0: 745f 696e 6465 7865 735b 696e 7374 7275  t_indexes[instru
-00038fc0: 6d65 6e74 5d29 0a20 2020 2020 2020 2020  ment]).         
-00038fd0: 2020 2020 2020 2073 656c 662e 6e64 6174         self.ndat
-00038fe0: 6170 6f69 6e74 735f 616c 6c5f 696e 7374  apoints_all_inst
-00038ff0: 7275 6d65 6e74 7320 2b3d 2073 656c 662e  ruments += self.
-00039000: 6e64 6174 6170 6f69 6e74 735f 7065 725f  ndatapoints_per_
-00039010: 696e 7374 7275 6d65 6e74 5b0a 2020 2020  instrument[.    
-00039020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039030: 696e 7374 7275 6d65 6e74 5d0a 2020 2020  instrument].    
-00039040: 2020 2020 2020 2020 2020 2020 2320 4578              # Ex
-00039050: 7472 6163 7420 6e75 6d62 6572 206f 6620  tract number of 
-00039060: 6c69 6e65 6172 206d 6f64 656c 2074 6572  linear model ter
-00039070: 6d73 2070 6572 2069 6e73 7472 756d 656e  ms per instrumen
-00039080: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-00039090: 2020 2069 6620 7365 6c66 2e6c 6d5f 626f     if self.lm_bo
-000390a0: 6f6c 6561 6e5b 696e 7374 7275 6d65 6e74  olean[instrument
-000390b0: 5d3a 0a0a 2020 2020 2020 2020 2020 2020  ]:..            
-000390c0: 2020 2020 2020 2020 7365 6c66 2e6c 6d5f          self.lm_
-000390d0: 6e5b 696e 7374 7275 6d65 6e74 5d20 3d20  n[instrument] = 
-000390e0: 7365 6c66 2e6c 6d5f 6172 6775 6d65 6e74  self.lm_argument
-000390f0: 735b 696e 7374 7275 6d65 6e74 5d2e 7368  s[instrument].sh
-00039100: 6170 655b 315d 0a0a 2020 2020 2020 2020  ape[1]..        
-00039110: 2020 2020 2020 2020 2320 4765 6e65 7261          # Genera
-00039120: 7465 2069 6e74 6572 6e61 6c20 6d6f 6465  te internal mode
-00039130: 6c20 7661 7269 6162 6c65 7320 6f66 2069  l variables of i
-00039140: 6e74 6572 6573 7420 746f 2074 6865 2075  nterest to the u
-00039150: 7365 722e 2046 6972 7374 2c20 7468 6520  ser. First, the 
-00039160: 5256 206d 6f64 656c 2069 6e20 7468 6520  RV model in the 
-00039170: 6e6f 7461 7469 6f6e 206f 6620 6a75 6c69  notation of juli
-00039180: 6574 2028 4d69 290a 2020 2020 2020 2020  et (Mi).        
-00039190: 2020 2020 2020 2020 2320 2866 756c 6c20          # (full 
-000391a0: 5256 206d 6f64 656c 2070 6c75 7320 6f66  RV model plus of
-000391b0: 6673 6574 2076 656c 6f63 6974 792c 2070  fset velocity, p
-000391c0: 6c75 7320 7472 656e 6429 3a0a 2020 2020  lus trend):.    
-000391d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000391e0: 2e6d 6f64 656c 5b69 6e73 7472 756d 656e  .model[instrumen
-000391f0: 745d 5b27 4d27 5d20 3d20 6e70 2e6f 6e65  t]['M'] = np.one
-00039200: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-00039210: 2020 2020 2020 206c 656e 2873 656c 662e         len(self.
-00039220: 696e 7374 7275 6d65 6e74 5f69 6e64 6578  instrument_index
-00039230: 6573 5b69 6e73 7472 756d 656e 745d 2929  es[instrument]))
-00039240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00039250: 2023 204c 696e 6561 7220 6d6f 6465 6c20   # Linear model 
-00039260: 2869 6e20 7468 6520 6e6f 7461 7469 6f6e  (in the notation
-00039270: 206f 6620 6a75 6c69 6574 2c20 4c4d 293a   of juliet, LM):
-00039280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00039290: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-000392a0: 7275 6d65 6e74 5d5b 274c 4d27 5d20 3d20  rument]['LM'] = 
-000392b0: 6e70 2e7a 6572 6f73 280a 2020 2020 2020  np.zeros(.      
-000392c0: 2020 2020 2020 2020 2020 2020 2020 6c65                le
-000392d0: 6e28 7365 6c66 2e69 6e73 7472 756d 656e  n(self.instrumen
-000392e0: 745f 696e 6465 7865 735b 696e 7374 7275  t_indexes[instru
-000392f0: 6d65 6e74 5d29 290a 2020 2020 2020 2020  ment])).        
-00039300: 2020 2020 2020 2020 2320 4e6f 772c 2067          # Now, g
-00039310: 656e 6572 6174 6520 6469 6374 696f 6e61  enerate dictiona
-00039320: 7279 2074 6861 7420 7769 6c6c 2073 6176  ry that will sav
-00039330: 6520 7468 6520 6669 6e61 6c20 6675 6c6c  e the final full
-00039340: 206d 6f64 656c 2028 4d20 2b20 4c4d 293a   model (M + LM):
-00039350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00039360: 2073 656c 662e 6d6f 6465 6c5b 696e 7374   self.model[inst
-00039370: 7275 6d65 6e74 5d5b 2764 6574 6572 6d69  rument]['determi
-00039380: 6e69 7374 6963 275d 203d 206e 702e 7a65  nistic'] = np.ze
-00039390: 726f 7328 0a20 2020 2020 2020 2020 2020  ros(.           
-000393a0: 2020 2020 2020 2020 206c 656e 2873 656c           len(sel
-000393b0: 662e 696e 7374 7275 6d65 6e74 5f69 6e64  f.instrument_ind
-000393c0: 6578 6573 5b69 6e73 7472 756d 656e 745d  exes[instrument]
-000393d0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-000393e0: 2020 2023 2053 616d 6520 666f 7220 7468     # Same for th
-000393f0: 6520 6572 726f 7273 3a0a 2020 2020 2020  e errors:.      
-00039400: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00039410: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
-00039420: 5b27 6465 7465 726d 696e 6973 7469 635f  ['deterministic_
-00039430: 6572 726f 7273 275d 203d 206e 702e 7a65  errors'] = np.ze
-00039440: 726f 7328 0a20 2020 2020 2020 2020 2020  ros(.           
-00039450: 2020 2020 2020 2020 206c 656e 2873 656c           len(sel
-00039460: 662e 696e 7374 7275 6d65 6e74 5f69 6e64  f.instrument_ind
-00039470: 6578 6573 5b69 6e73 7472 756d 656e 745d  exes[instrument]
-00039480: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-00039490: 2020 2023 2049 6e64 6976 6964 7561 6c20     # Individual 
-000394a0: 6b65 706c 6572 6961 6e73 2066 6f72 2065  keplerians for e
-000394b0: 6163 6820 706c 616e 6574 3a0a 2020 2020  ach planet:.    
-000394c0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000394d0: 6920 696e 2073 656c 662e 6e75 6d62 6572  i in self.number
-000394e0: 696e 673a 0a20 2020 2020 2020 2020 2020  ing:.           
-000394f0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
-00039500: 6465 6c5b 696e 7374 7275 6d65 6e74 5d5b  del[instrument][
-00039510: 2770 2720 2b20 7374 7228 6929 5d20 3d20  'p' + str(i)] = 
-00039520: 6e70 2e6f 6e65 7328 0a20 2020 2020 2020  np.ones(.       
-00039530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039540: 206c 656e 2873 656c 662e 696e 7374 7275   len(self.instru
-00039550: 6d65 6e74 5f69 6e64 6578 6573 5b69 6e73  ment_indexes[ins
-00039560: 7472 756d 656e 745d 2929 0a20 2020 2020  trument])).     
-00039570: 2020 2020 2020 2020 2020 2023 2041 6e20             # An 
-00039580: 6172 7261 7920 6f66 206f 6e65 7320 746f  array of ones to
-00039590: 2063 6f70 7920 6172 6f75 6e64 3a0a 2020   copy around:.  
-000395a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000395b0: 6c66 2e6d 6f64 656c 5b69 6e73 7472 756d  lf.model[instrum
-000395c0: 656e 745d 5b27 6f6e 6573 275d 203d 206e  ent]['ones'] = n
-000395d0: 702e 6f6e 6573 280a 2020 2020 2020 2020  p.ones(.        
-000395e0: 2020 2020 2020 2020 2020 2020 6c65 6e28              len(
-000395f0: 7365 6c66 2e74 5b73 656c 662e 696e 7374  self.t[self.inst
-00039600: 7275 6d65 6e74 5f69 6e64 6578 6573 5b69  rument_indexes[i
-00039610: 6e73 7472 756d 656e 745d 5d29 290a 2020  nstrument]])).  
-00039620: 2020 2020 2020 2020 2020 2320 5365 7420            # Set 
-00039630: 7468 6520 6d6f 6465 6c2d 7479 7065 2074  the model-type t
-00039640: 6f20 4d28 7429 3a0a 2020 2020 2020 2020  o M(t):.        
-00039650: 2020 2020 7365 6c66 2e65 7661 6c75 6174      self.evaluat
-00039660: 6520 3d20 7365 6c66 2e65 7661 6c75 6174  e = self.evaluat
-00039670: 655f 6d6f 6465 6c0a 2020 2020 2020 2020  e_model.        
-00039680: 2020 2020 7365 6c66 2e67 656e 6572 6174      self.generat
-00039690: 6520 3d20 7365 6c66 2e67 656e 6572 6174  e = self.generat
-000396a0: 655f 7276 5f6d 6f64 656c 0a20 2020 2020  e_rv_model.     
-000396b0: 2020 2065 6c73 653a 0a0a 2020 2020 2020     else:..      
-000396c0: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
-000396d0: 7074 696f 6e28 0a20 2020 2020 2020 2020  ption(.         
-000396e0: 2020 2020 2020 2027 4d6f 6465 6c20 7479         'Model ty
-000396f0: 7065 2022 2720 2b20 6c63 202b 0a20 2020  pe "' + lc +.   
-00039700: 2020 2020 2020 2020 2020 2020 2027 2220               '" 
-00039710: 6e6f 7420 7265 636f 676e 697a 6564 2e20  not recognized. 
-00039720: 4375 7272 656e 746c 7920 6974 2063 616e  Currently it can
-00039730: 206f 6e6c 7920 6265 2022 6c63 2220 666f   only be "lc" fo
-00039740: 7220 6120 6c69 6768 742d 6375 7276 6520  r a light-curve 
-00039750: 6d6f 6465 6c20 6f72 2022 7276 2220 666f  model or "rv" fo
-00039760: 7220 7261 6469 616c 2d76 656c 6f63 6974  r radial-velocit
-00039770: 7920 6d6f 6465 6c2e 270a 2020 2020 2020  y model.'.      
-00039780: 2020 2020 2020 290a 0a63 6c61 7373 2067        )..class g
-00039790: 6175 7373 6961 6e5f 7072 6f63 6573 7328  aussian_process(
-000397a0: 6f62 6a65 6374 293a 0a20 2020 2022 2222  object):.    """
-000397b0: 0a20 2020 2047 6976 656e 2061 206a 756c  .    Given a jul
-000397c0: 6965 7420 6461 7461 206f 626a 6563 7420  iet data object 
-000397d0: 2863 7265 6174 6564 2076 6961 206a 756c  (created via jul
-000397e0: 6965 742e 6c6f 6164 292c 2061 206d 6f64  iet.load), a mod
-000397f0: 656c 2074 7970 6520 2869 2e65 2e2c 2069  el type (i.e., i
-00039800: 7320 7468 6973 2061 2047 5020 666f 7220  s this a GP for 
-00039810: 6120 5256 206f 7220 6c69 6768 7463 7572  a RV or lightcur
-00039820: 7665 2064 6174 6173 6574 2920 616e 640a  ve dataset) and.
-00039830: 2020 2020 616e 2069 6e73 7472 756d 656e      an instrumen
-00039840: 7420 6e61 6d65 2c20 7468 6973 206f 626a  t name, this obj
-00039850: 6563 7420 6765 6e65 7261 7465 7320 6120  ect generates a 
-00039860: 4761 7573 7369 616e 2050 726f 6365 7373  Gaussian Process
-00039870: 2028 4750 2920 6f62 6a65 6374 2074 6f20   (GP) object to 
-00039880: 7573 6520 7769 7468 696e 2074 6865 206a  use within the j
-00039890: 756c 6965 7420 6c69 6272 6172 792e 2045  uliet library. E
-000398a0: 7861 6d70 6c65 2075 7361 6765 3a0a 0a20  xample usage:.. 
-000398b0: 2020 2020 2020 2020 2020 2020 2020 3e3e                >>
-000398c0: 3e20 4750 6d6f 6465 6c20 3d20 6a75 6c69  > GPmodel = juli
-000398d0: 6574 2e67 6175 7373 6961 6e5f 7072 6f63  et.gaussian_proc
-000398e0: 6573 7328 6461 7461 2c20 6d6f 6465 6c5f  ess(data, model_
-000398f0: 7479 7065 203d 2027 6c63 272c 2069 6e73  type = 'lc', ins
-00039900: 7472 756d 656e 7420 3d20 2754 4553 5327  trument = 'TESS'
-00039910: 290a 0a20 2020 203a 7061 7261 6d20 6461  )..    :param da
-00039920: 7461 2028 6a75 6c69 6574 2e6c 6f61 6420  ta (juliet.load 
-00039930: 6f62 6a65 6374 290a 2020 2020 2020 2020  object).        
-00039940: 4f62 6a65 6374 2063 6f6e 7461 696e 696e  Object containin
-00039950: 6720 616c 6c20 7468 6520 696e 666f 726d  g all the inform
-00039960: 6174 696f 6e20 6162 6f75 7420 7468 6520  ation about the 
-00039970: 6375 7272 656e 7420 6461 7461 7365 742e  current dataset.
-00039980: 2054 6869 7320 7769 6c6c 2068 656c 7020   This will help 
-00039990: 696e 2064 6574 6572 6d69 6e69 6e67 2074  in determining t
-000399a0: 6865 2074 7970 6520 6f66 206b 6572 6e65  he type of kerne
-000399b0: 6c0a 2020 2020 2020 2020 7468 6520 696e  l.        the in
-000399c0: 7075 7420 696e 7374 7275 6d65 6e74 2068  put instrument h
-000399d0: 6173 2061 6e64 2061 6c73 6f20 6966 2074  as and also if t
-000399e0: 6865 2069 6e73 7472 756d 656e 7420 6861  he instrument ha
-000399f0: 7320 616e 7920 6572 726f 7273 2061 7373  s any errors ass
-00039a00: 6f63 6961 7465 6420 7769 7468 2069 7420  ociated with it 
-00039a10: 746f 2069 6e69 7469 616c 697a 6520 7468  to initialize th
-00039a20: 6520 6b65 726e 656c 2e0a 0a20 2020 203a  e kernel...    :
-00039a30: 7061 7261 6d20 6d6f 6465 6c5f 7479 7065  param model_type
-00039a40: 3a20 2873 7472 696e 6729 0a20 2020 2020  : (string).     
-00039a50: 2020 2041 2073 7472 696e 6720 6465 6669     A string defi
-00039a60: 6e69 6e67 2074 6865 2074 7970 6520 6f66  ning the type of
-00039a70: 2064 6174 6120 7468 6520 4750 2077 696c   data the GP wil
-00039a80: 6c20 6265 206d 6f64 656c 6c69 6e67 2e20  l be modelling. 
-00039a90: 4361 6e20 6265 2065 6974 6865 7220 6060  Can be either ``
-00039aa0: 6c63 6060 2028 666f 7220 7068 6f74 6f6d  lc`` (for photom
-00039ab0: 6574 7279 2920 6f72 2060 6072 7660 6020  etry) or ``rv`` 
-00039ac0: 2866 6f72 2072 6164 6961 6c2d 7665 6c6f  (for radial-velo
-00039ad0: 6369 7469 6573 292e 0a0a 2020 2020 3a70  cities)...    :p
-00039ae0: 6172 616d 2069 6e73 7472 756d 656e 743a  aram instrument:
-00039af0: 2028 7374 7269 6e67 290a 2020 2020 2020   (string).      
-00039b00: 2020 4120 7374 7269 6e67 2069 6e64 6963    A string indic
-00039b10: 6174 696e 6720 7468 6520 6e61 6d65 206f  ating the name o
-00039b20: 6620 7468 6520 696e 7374 7275 6d65 6e74  f the instrument
-00039b30: 2074 6865 2047 5020 6973 2062 6569 6e67   the GP is being
-00039b40: 2061 7070 6c69 6564 2074 6f2e 2054 6869   applied to. Thi
-00039b50: 7320 7374 7269 6e67 2073 696d 706c 6966  s string simplif
-00039b60: 6965 7320 6372 6f73 732d 7461 6c6b 2077  ies cross-talk w
-00039b70: 6974 6820 6a75 6c69 6574 2773 2060 6070  ith juliet's ``p
-00039b80: 6f73 7465 7269 6f72 7360 600a 2020 2020  osteriors``.    
-00039b90: 2020 2020 6469 6374 696f 6e61 7279 2e0a      dictionary..
-00039ba0: 0a20 2020 203a 7061 7261 6d20 6765 6f72  .    :param geor
-00039bb0: 6765 5f68 6f64 6c72 3a20 286f 7074 696f  ge_hodlr: (optio
-00039bc0: 6e61 6c2c 2062 6f6f 6c65 616e 290a 2020  nal, boolean).  
-00039bd0: 2020 2020 2020 4966 2054 7275 652c 2074        If True, t
-00039be0: 6869 7320 7573 6573 2047 656f 7267 6527  his uses George'
-00039bf0: 7320 484f 444c 5220 736f 6c76 6572 2028  s HODLR solver (
-00039c00: 6661 7374 6572 292e 0a0a 2020 2020 2222  faster)...    ""
-00039c10: 220a 0a20 2020 2064 6566 2067 6574 5f6b  "..    def get_k
-00039c20: 6572 6e65 6c5f 6e61 6d65 2873 656c 662c  ernel_name(self,
-00039c30: 2070 7269 6f72 7329 3a0a 0a20 2020 2020   priors):..     
-00039c40: 2020 2023 2046 6972 7374 2c20 6368 6563     # First, chec
-00039c50: 6b20 616c 6c20 7468 6520 4750 2076 6172  k all the GP var
-00039c60: 6961 626c 6573 2069 6e20 7468 6520 7072  iables in the pr
-00039c70: 696f 7273 2066 696c 6520 7468 6174 2061  iors file that a
-00039c80: 7265 206f 6620 7468 6520 666f 726d 2047  re of the form G
-00039c90: 505f 7661 7269 6162 6c65 5f69 6e73 7472  P_variable_instr
-00039ca0: 756d 656e 7431 5f69 6e73 7472 756d 656e  ument1_instrumen
-00039cb0: 7432 5f2e 2e2e 3a0a 2020 2020 2020 2020  t2_...:.        
-00039cc0: 7661 7269 6162 6c65 735f 7468 6174 5f6d  variables_that_m
-00039cd0: 6174 6368 203d 205b 5d0a 2020 2020 2020  atch = [].      
-00039ce0: 2020 666f 7220 706e 616d 6520 696e 2070    for pname in p
-00039cf0: 7269 6f72 732e 6b65 7973 2829 3a0a 2020  riors.keys():.  
-00039d00: 2020 2020 2020 2020 2020 7665 6320 3d20            vec = 
-00039d10: 706e 616d 652e 7370 6c69 7428 275f 2729  pname.split('_')
-00039d20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00039d30: 2876 6563 5b30 5d20 3d3d 2027 4750 2729  (vec[0] == 'GP')
-00039d40: 2061 6e64 2028 7365 6c66 2e69 6e73 7472   and (self.instr
-00039d50: 756d 656e 7420 696e 2076 6563 293a 0a20  ument in vec):. 
-00039d60: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00039d70: 6172 6961 626c 6573 5f74 6861 745f 6d61  ariables_that_ma
-00039d80: 7463 6820 3d20 7661 7269 6162 6c65 735f  tch = variables_
-00039d90: 7468 6174 5f6d 6174 6368 202b 205b 7665  that_match + [ve
-00039da0: 635b 315d 5d0a 2020 2020 2020 2020 2320  c[1]].        # 
-00039db0: 4e6f 7720 7765 2068 6176 6520 616c 6c20  Now we have all 
-00039dc0: 7468 6520 7661 7269 6162 6c65 7320 7468  the variables th
-00039dd0: 6174 206d 6174 6368 2074 6865 2063 7572  at match the cur
-00039de0: 7265 6e74 2069 6e73 7472 756d 656e 7420  rent instrument 
-00039df0: 696e 2076 6172 6961 626c 6573 5f74 6861  in variables_tha
-00039e00: 745f 6d61 7463 682e 2043 6865 636b 2077  t_match. Check w
-00039e10: 6869 6368 206f 6620 7468 650a 2020 2020  hich of the.    
-00039e20: 2020 2020 2320 696d 706c 656d 656e 7465      # implemente
-00039e30: 6420 4750 206d 6f64 656c 7320 6769 7665  d GP models give
-00039e40: 7320 6120 7065 7266 6563 7420 6d61 7463  s a perfect matc
-00039e50: 6820 746f 2061 6c6c 2074 6865 2076 6172  h to all the var
-00039e60: 6961 626c 6573 3b20 7468 6174 2077 696c  iables; that wil
-00039e70: 6c20 6769 7665 2075 7320 7468 6520 6e61  l give us the na
-00039e80: 6d65 206f 6620 7468 6520 6b65 726e 656c  me of the kernel
-00039e90: 3a0a 2020 2020 2020 2020 6e5f 7661 7269  :.        n_vari
-00039ea0: 6162 6c65 735f 7468 6174 5f6d 6174 6368  ables_that_match
-00039eb0: 203d 206c 656e 2876 6172 6961 626c 6573   = len(variables
-00039ec0: 5f74 6861 745f 6d61 7463 6829 0a20 2020  _that_match).   
-00039ed0: 2020 2020 2069 6620 6e5f 7661 7269 6162       if n_variab
-00039ee0: 6c65 735f 7468 6174 5f6d 6174 6368 203d  les_that_match =
-00039ef0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-00039f00: 2072 6169 7365 2045 7863 6570 7469 6f6e   raise Exception
-00039f10: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00039f20: 2020 2749 6e70 7574 2065 7272 6f72 3a20    'Input error: 
-00039f30: 6974 2073 6565 6d73 2069 6e73 7472 756d  it seems instrum
-00039f40: 656e 7420 2720 2b20 7365 6c66 2e69 6e73  ent ' + self.ins
-00039f50: 7472 756d 656e 7420 2b0a 2020 2020 2020  trument +.      
-00039f60: 2020 2020 2020 2020 2020 2720 6861 7320            ' has 
-00039f70: 6e6f 2064 6566 696e 6564 2070 7269 6f72  no defined prior
-00039f80: 7320 696e 2074 6865 2070 7269 6f72 2066  s in the prior f
-00039f90: 696c 6520 666f 7220 6120 4761 7573 7369  ile for a Gaussi
-00039fa0: 616e 2050 726f 6365 7373 2e20 4368 6563  an Process. Chec
-00039fb0: 6b20 7468 6520 7072 696f 7220 6669 6c65  k the prior file
-00039fc0: 2061 6e64 2074 7279 2061 6761 696e 2e27   and try again.'
-00039fd0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00039fe0: 2020 2020 2020 2020 666f 7220 6b65 726e          for kern
-00039ff0: 656c 5f6e 616d 6520 696e 2073 656c 662e  el_name in self.
-0003a000: 616c 6c5f 6b65 726e 656c 5f76 6172 6961  all_kernel_varia
-0003a010: 626c 6573 2e6b 6579 7328 293a 0a20 2020  bles.keys():.   
-0003a020: 2020 2020 2020 2020 2063 6f75 6e74 6572           counter
-0003a030: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
-0003a040: 2066 6f72 2076 6172 6961 626c 655f 6e61   for variable_na
-0003a050: 6d65 2069 6e20 7365 6c66 2e61 6c6c 5f6b  me in self.all_k
-0003a060: 6572 6e65 6c5f 7661 7269 6162 6c65 735b  ernel_variables[
-0003a070: 6b65 726e 656c 5f6e 616d 655d 3a0a 2020  kernel_name]:.  
-0003a080: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0003a090: 2076 6172 6961 626c 655f 6e61 6d65 2069   variable_name i
-0003a0a0: 6e20 7661 7269 6162 6c65 735f 7468 6174  n variables_that
-0003a0b0: 5f6d 6174 6368 3a0a 2020 2020 2020 2020  _match:.        
-0003a0c0: 2020 2020 2020 2020 2020 2020 636f 756e              coun
-0003a0d0: 7465 7220 2b3d 2031 0a20 2020 2020 2020  ter += 1.       
-0003a0e0: 2020 2020 2069 6620 286e 5f76 6172 6961       if (n_varia
-0003a0f0: 626c 6573 5f74 6861 745f 6d61 7463 680a  bles_that_match.
-0003a100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a110: 2020 2020 3d3d 2063 6f75 6e74 6572 2920      == counter) 
-0003a120: 616e 6420 286c 656e 2873 656c 662e 616c  and (len(self.al
-0003a130: 6c5f 6b65 726e 656c 5f76 6172 6961 626c  l_kernel_variabl
-0003a140: 6573 5b6b 6572 6e65 6c5f 6e61 6d65 5d29  es[kernel_name])
-0003a150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a170: 2020 2020 2020 3d3d 206e 5f76 6172 6961        == n_varia
-0003a180: 626c 6573 5f74 6861 745f 6d61 7463 6829  bles_that_match)
-0003a190: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003a1a0: 2020 7265 7475 726e 206b 6572 6e65 6c5f    return kernel_
-0003a1b0: 6e61 6d65 0a0a 2020 2020 6465 6620 696e  name..    def in
-0003a1c0: 6974 5f47 5028 7365 6c66 293a 0a20 2020  it_GP(self):.   
-0003a1d0: 2020 2020 2069 6620 7365 6c66 2e75 7365       if self.use
-0003a1e0: 5f63 656c 6572 6974 653a 0a20 2020 2020  _celerite:.     
-0003a1f0: 2020 2020 2020 2073 656c 662e 4750 203d         self.GP =
-0003a200: 2063 656c 6572 6974 652e 4750 2873 656c   celerite.GP(sel
-0003a210: 662e 6b65 726e 656c 2c20 6d65 616e 3d30  f.kernel, mean=0
-0003a220: 2e30 290a 2020 2020 2020 2020 656c 7365  .0).        else
-0003a230: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0003a240: 2073 656c 662e 676c 6f62 616c 5f47 503a   self.global_GP:
-0003a250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a260: 2069 6620 7365 6c66 2e67 656f 7267 655f   if self.george_
-0003a270: 686f 646c 723a 0a20 2020 2020 2020 2020  hodlr:.         
-0003a280: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003a290: 4750 203d 2067 656f 7267 652e 4750 2873  GP = george.GP(s
-0003a2a0: 656c 662e 6b65 726e 656c 2c20 6d65 616e  elf.kernel, mean
-0003a2b0: 203d 2030 2e30 2c20 6669 745f 6d65 616e   = 0.0, fit_mean
-0003a2c0: 203d 2046 616c 7365 2c5c 0a20 2020 2020   = False,\.     
-0003a2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a2f0: 2020 2066 6974 5f77 6869 7465 5f6e 6f69     fit_white_noi
-0003a300: 7365 203d 2046 616c 7365 2c20 736f 6c76  se = False, solv
-0003a310: 6572 203d 2067 656f 7267 652e 484f 444c  er = george.HODL
-0003a320: 5253 6f6c 7665 7229 0a20 2020 2020 2020  RSolver).       
-0003a330: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0003a340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a350: 2020 2073 656c 662e 4750 203d 2067 656f     self.GP = geo
-0003a360: 7267 652e 4750 2873 656c 662e 6b65 726e  rge.GP(self.kern
-0003a370: 656c 2c20 6d65 616e 203d 2030 2e30 2c20  el, mean = 0.0, 
-0003a380: 6669 745f 6d65 616e 203d 2046 616c 7365  fit_mean = False
-0003a390: 2c5c 0a20 2020 2020 2020 2020 2020 2020  ,\.             
-0003a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a3b0: 2020 2020 2020 2020 2020 2066 6974 5f77             fit_w
-0003a3c0: 6869 7465 5f6e 6f69 7365 203d 2046 616c  hite_noise = Fal
-0003a3d0: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
-0003a3e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0003a3f0: 2020 2020 2020 2320 284e 6f74 6520 6e6f        # (Note no
-0003a400: 206a 6974 7465 7220 6b65 726e 656c 2069   jitter kernel i
-0003a410: 7320 6769 7665 6e2c 2061 7320 7769 7468  s given, as with
-0003a420: 2067 656f 7267 6520 6f6e 6520 6465 6669   george one defi
-0003a430: 6e65 7320 7468 6973 2069 6e20 7468 6520  nes this in the 
-0003a440: 6765 6f72 6765 2e47 5020 6361 6c6c 293a  george.GP call):
-0003a450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a460: 206a 6974 7465 725f 7465 726d 203d 2067   jitter_term = g
-0003a470: 656f 7267 652e 6d6f 6465 6c69 6e67 2e43  eorge.modeling.C
-0003a480: 6f6e 7374 616e 744d 6f64 656c 2831 2e29  onstantModel(1.)
-0003a490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a4a0: 2069 6620 7365 6c66 2e67 656f 7267 655f   if self.george_
-0003a4b0: 686f 646c 723a 0a20 2020 2020 2020 2020  hodlr:.         
-0003a4c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003a4d0: 4750 203d 2067 656f 7267 652e 4750 2873  GP = george.GP(s
-0003a4e0: 656c 662e 6b65 726e 656c 2c20 6d65 616e  elf.kernel, mean
-0003a4f0: 203d 2030 2e30 2c20 6669 745f 6d65 616e   = 0.0, fit_mean
-0003a500: 203d 2046 616c 7365 2c20 7768 6974 655f   = False, white_
-0003a510: 6e6f 6973 6520 3d20 6a69 7474 6572 5f74  noise = jitter_t
-0003a520: 6572 6d2c 5c0a 2020 2020 2020 2020 2020  erm,\.          
-0003a530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a540: 2020 2020 2020 2020 2020 2020 2020 6669                fi
-0003a550: 745f 7768 6974 655f 6e6f 6973 6520 3d20  t_white_noise = 
-0003a560: 5472 7565 2c20 736f 6c76 6572 203d 2067  True, solver = g
-0003a570: 656f 7267 652e 484f 444c 5253 6f6c 7665  eorge.HODLRSolve
-0003a580: 7229 0a20 2020 2020 2020 2020 2020 2020  r).             
-0003a590: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0003a5a0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0003a5b0: 662e 4750 203d 2067 656f 7267 652e 4750  f.GP = george.GP
-0003a5c0: 2873 656c 662e 6b65 726e 656c 2c20 6d65  (self.kernel, me
-0003a5d0: 616e 203d 2030 2e30 2c20 6669 745f 6d65  an = 0.0, fit_me
-0003a5e0: 616e 203d 2046 616c 7365 2c20 7768 6974  an = False, whit
-0003a5f0: 655f 6e6f 6973 6520 3d20 6a69 7474 6572  e_noise = jitter
-0003a600: 5f74 6572 6d2c 5c0a 2020 2020 2020 2020  _term,\.        
-0003a610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a630: 6669 745f 7768 6974 655f 6e6f 6973 6520  fit_white_noise 
-0003a640: 3d20 5472 7565 290a 2020 2020 2020 2020  = True).        
-0003a650: 7365 6c66 2e63 6f6d 7075 7465 5f47 5028  self.compute_GP(
-0003a660: 290a 0a20 2020 2064 6566 2063 6f6d 7075  )..    def compu
-0003a670: 7465 5f47 5028 7365 6c66 2c20 583d 4e6f  te_GP(self, X=No
-0003a680: 6e65 293a 0a20 2020 2020 2020 2069 6620  ne):.        if 
-0003a690: 7365 6c66 2e79 6572 7220 6973 206e 6f74  self.yerr is not
-0003a6a0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0003a6b0: 2020 2069 6620 5820 6973 204e 6f6e 653a     if X is None:
-0003a6c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a6d0: 2073 656c 662e 4750 2e63 6f6d 7075 7465   self.GP.compute
-0003a6e0: 2873 656c 662e 582c 2079 6572 723d 7365  (self.X, yerr=se
-0003a6f0: 6c66 2e79 6572 7229 0a20 2020 2020 2020  lf.yerr).       
-0003a700: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0003a710: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003a720: 4750 2e63 6f6d 7075 7465 2858 2c20 7965  GP.compute(X, ye
-0003a730: 7272 3d73 656c 662e 7965 7272 290a 2020  rr=self.yerr).  
-0003a740: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0003a750: 2020 2020 2020 2020 6966 2058 2069 7320          if X is 
-0003a760: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0003a770: 2020 2020 2020 7365 6c66 2e47 502e 636f        self.GP.co
-0003a780: 6d70 7574 6528 7365 6c66 2e58 290a 2020  mpute(self.X).  
-0003a790: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0003a7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a7b0: 7365 6c66 2e47 502e 636f 6d70 7574 6528  self.GP.compute(
-0003a7c0: 5829 0a0a 2020 2020 6465 6620 7365 745f  X)..    def set_
-0003a7d0: 696e 7075 745f 696e 7374 7275 6d65 6e74  input_instrument
-0003a7e0: 2873 656c 662c 2069 6e70 7574 5f76 6172  (self, input_var
-0003a7f0: 6961 626c 6573 293a 0a0a 2020 2020 2020  iables):..      
-0003a800: 2020 2320 5468 6973 2066 756e 6374 696f    # This functio
-0003a810: 6e20 7365 7473 2074 6865 2022 696e 7075  n sets the "inpu
-0003a820: 7420 696e 7374 7275 6d65 6e74 2220 2873  t instrument" (s
-0003a830: 656c 662e 696e 7075 745f 696e 7374 7275  elf.input_instru
-0003a840: 6d65 6e74 2920 6e61 6d65 2066 6f72 2065  ment) name for e
-0003a850: 6163 6820 7661 7269 6162 6c65 2028 7365  ach variable (se
-0003a860: 6c66 2e76 6172 6961 626c 6573 292e 0a20  lf.variables).. 
-0003a870: 2020 2020 2020 2023 2049 662c 2066 6f72         # If, for
-0003a880: 2065 7861 6d70 6c65 2c20 4750 5f50 726f   example, GP_Pro
-0003a890: 745f 5445 5353 5f4b 325f 7276 2061 6e64  t_TESS_K2_rv and
-0003a8a0: 2047 505f 4761 6d6d 615f 5445 5353 2c20   GP_Gamma_TESS, 
-0003a8b0: 616e 6420 7365 6c66 2e76 6172 6961 626c  and self.variabl
-0003a8c0: 6573 203d 205b 2750 726f 7427 2c27 4761  es = ['Prot','Ga
-0003a8d0: 6d6d 6127 5d2c 0a20 2020 2020 2020 2023  mma'],.        #
-0003a8e0: 2074 6865 6e20 7365 6c66 2e69 6e70 7574   then self.input
-0003a8f0: 5f69 6e73 7472 756d 656e 7420 3d20 5b27  _instrument = ['
-0003a900: 5445 5353 5f4b 325f 7276 272c 2754 4553  TESS_K2_rv','TES
-0003a910: 5327 5d2e 0a20 2020 2020 2020 2066 6f72  S']..        for
-0003a920: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
-0003a930: 7365 6c66 2e76 6172 6961 626c 6573 2929  self.variables))
-0003a940: 3a0a 2020 2020 2020 2020 2020 2020 4750  :.            GP
-0003a950: 7661 7269 6162 6c65 203d 2073 656c 662e  variable = self.
-0003a960: 7661 7269 6162 6c65 735b 695d 0a20 2020  variables[i].   
-0003a970: 2020 2020 2020 2020 2066 6f72 2070 6e61           for pna
-0003a980: 6d65 7320 696e 2069 6e70 7574 5f76 6172  mes in input_var
-0003a990: 6961 626c 6573 2e6b 6579 7328 293a 0a20  iables.keys():. 
-0003a9a0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0003a9b0: 6563 203d 2070 6e61 6d65 732e 7370 6c69  ec = pnames.spli
-0003a9c0: 7428 275f 2729 0a20 2020 2020 2020 2020  t('_').         
-0003a9d0: 2020 2020 2020 2069 6620 2876 6563 5b30         if (vec[0
-0003a9e0: 5d20 3d3d 2027 4750 2729 2061 6e64 2028  ] == 'GP') and (
-0003a9f0: 4750 7661 7269 6162 6c65 0a20 2020 2020  GPvariable.     
-0003aa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003aa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003aa20: 2020 2020 696e 2076 6563 5b31 5d29 2061      in vec[1]) a
-0003aa30: 6e64 2028 7365 6c66 2e69 6e73 7472 756d  nd (self.instrum
-0003aa40: 656e 740a 2020 2020 2020 2020 2020 2020  ent.            
-0003aa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003aa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003aa70: 2020 2020 2020 2020 2020 2020 2069 6e20               in 
-0003aa80: 7665 6329 3a0a 2020 2020 2020 2020 2020  vec):.          
-0003aa90: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
-0003aaa0: 6e70 7574 5f69 6e73 7472 756d 656e 742e  nput_instrument.
-0003aab0: 6170 7065 6e64 2827 5f27 2e6a 6f69 6e28  append('_'.join(
-0003aac0: 7665 635b 323a 5d29 290a 0a20 2020 2064  vec[2:]))..    d
-0003aad0: 6566 2073 6574 5f70 6172 616d 6574 6572  ef set_parameter
-0003aae0: 5f76 6563 746f 7228 7365 6c66 2c20 7061  _vector(self, pa
-0003aaf0: 7261 6d65 7465 725f 7661 6c75 6573 293a  rameter_values):
-0003ab00: 0a20 2020 2020 2020 2023 2054 6f20 7570  .        # To up
-0003ab10: 6461 7465 2074 6865 2070 6172 616d 6574  date the paramet
-0003ab20: 6572 732c 2077 6520 6861 7665 2074 6f20  ers, we have to 
-0003ab30: 7472 616e 7366 6f72 6d20 7468 6520 6a75  transform the ju
-0003ab40: 6c69 6574 2069 6e70 7574 7320 746f 2063  liet inputs to c
-0003ab50: 656c 6572 6974 652f 6765 6f72 6765 2069  elerite/george i
-0003ab60: 6e70 7574 732e 2055 7064 6174 6520 7468  nputs. Update th
-0003ab70: 6973 0a20 2020 2020 2020 2023 2064 6570  is.        # dep
-0003ab80: 656e 6469 6e67 206f 6e20 7468 6520 6b65  ending on the ke
-0003ab90: 726e 656c 2075 6e64 6572 2075 7361 6765  rnel under usage
-0003aba0: 2e20 466f 7220 7468 6973 2c20 7765 2066  . For this, we f
-0003abb0: 6972 7374 2064 6566 696e 6520 6120 6261  irst define a ba
-0003abc0: 7365 5f69 6e64 6578 2076 6172 6961 626c  se_index variabl
-0003abd0: 6520 7468 6174 2077 696c 6c20 6465 6669  e that will defi
-0003abe0: 6e65 2074 6865 206e 756d 6265 7269 6e67  ne the numbering
-0003abf0: 0a20 2020 2020 2020 2023 206f 6620 7468  .        # of th
-0003ac00: 6520 7365 6c66 2e70 6172 616d 6574 6572  e self.parameter
-0003ac10: 5f76 6563 746f 722e 2054 6865 2072 6561  _vector. The rea
-0003ac20: 736f 6e20 666f 7220 7468 6973 2069 7320  son for this is 
-0003ac30: 7468 6174 2074 6865 2064 696d 656e 7369  that the dimensi
-0003ac40: 6f6e 7320 6f66 2074 6865 2073 656c 662e  ons of the self.
-0003ac50: 7061 7261 6d65 7465 725f 7665 6374 6f72  parameter_vector
-0003ac60: 2061 7272 6179 2069 730a 2020 2020 2020   array is.      
-0003ac70: 2020 2320 6469 6666 6572 656e 7420 6966    # different if
-0003ac80: 2074 6865 2047 5020 6973 2067 6c6f 6261   the GP is globa
-0003ac90: 6c20 2869 2e65 2e2c 2073 656c 662e 676c  l (i.e., self.gl
-0003aca0: 6f62 616c 5f47 5020 6973 2054 7275 6520  obal_GP is True 
-0003acb0: 2d2d 2d20 6d65 616e 696e 6720 6120 756e  --- meaning a un
-0003acc0: 6971 7565 2047 5020 6973 2066 6974 7465  ique GP is fitte
-0003acd0: 6420 746f 2061 6c6c 2069 6e73 7472 756d  d to all instrum
-0003ace0: 656e 7473 2920 6f72 0a20 2020 2020 2020  ents) or.       
-0003acf0: 2023 206e 6f74 2028 7365 6c66 2e67 6c6f   # not (self.glo
-0003ad00: 6261 6c5f 4750 2069 7320 4661 6c73 6520  bal_GP is False 
-0003ad10: 2d2d 2d20 6d65 616e 696e 6720 6120 6469  --- meaning a di
-0003ad20: 6666 6572 656e 7420 4750 2070 6572 2069  fferent GP per i
-0003ad30: 6e73 7472 756d 656e 7420 6973 2066 6974  nstrument is fit
-0003ad40: 7465 6429 2e20 4966 2074 6865 2066 6f72  ted). If the for
-0003ad50: 6d65 722c 2074 6865 206a 6974 7465 7220  mer, the jitter 
-0003ad60: 7465 726d 7320 6172 650a 2020 2020 2020  terms are.      
-0003ad70: 2020 2320 6d6f 6469 6669 6564 2064 6972    # modified dir
-0003ad80: 6563 746c 7920 6279 2063 6861 6e67 696e  ectly by changin
-0003ad90: 6720 7468 6520 7365 6c66 2e79 6572 7220  g the self.yerr 
-0003ada0: 7665 6374 6f72 3b20 696e 2074 6865 206c  vector; in the l
-0003adb0: 6174 7465 722c 2077 6520 6861 7665 2074  atter, we have t
-0003adc0: 6f20 6d61 6e75 616c 6c79 2061 6464 2061  o manually add a
-0003add0: 206a 6974 7465 7220 7465 726d 2069 6e20   jitter term in 
-0003ade0: 7468 6520 4750 2070 6172 616d 6574 6572  the GP parameter
-0003adf0: 0a20 2020 2020 2020 2023 2076 6563 746f  .        # vecto
-0003ae00: 722e 2054 6869 7320 6261 7365 5f69 6e64  r. This base_ind
-0003ae10: 6578 2069 7320 6f6e 6c79 2069 6d70 6f72  ex is only impor
-0003ae20: 7461 6e74 2066 6f72 2074 6865 2067 656f  tant for the geo
-0003ae30: 7267 6520 6b65 726e 656c 7320 7468 6f75  rge kernels thou
-0003ae40: 6768 202d 2d2d 2061 6e20 6966 2073 7461  gh --- an if sta
-0003ae50: 7465 6d65 6e74 2073 7566 6669 6365 7320  tement suffices 
-0003ae60: 666f 7220 7468 6520 6365 6c65 7269 7465  for the celerite
-0003ae70: 206f 6e65 732e 0a20 2020 2020 2020 2062   ones..        b
-0003ae80: 6173 655f 696e 6465 7820 3d20 300a 2020  ase_index = 0.  
-0003ae90: 2020 2020 2020 6966 2028 7365 6c66 2e6b        if (self.k
-0003aea0: 6572 6e65 6c5f 6e61 6d65 203d 3d20 2753  ernel_name == 'S
-0003aeb0: 454b 6572 6e65 6c27 2920 6f72 2028 7365  EKernel') or (se
-0003aec0: 6c66 2e6b 6572 6e65 6c5f 6e61 6d65 0a20  lf.kernel_name. 
-0003aed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003aee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003aef0: 2020 2020 2020 2020 2020 2020 2020 203d                 =
-0003af00: 3d20 274d 3332 4b65 726e 656c 2729 3a0a  = 'M32Kernel'):.
-0003af10: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0003af20: 6f74 2073 656c 662e 676c 6f62 616c 5f47  ot self.global_G
-0003af30: 503a 0a20 2020 2020 2020 2020 2020 2020  P:.             
-0003af40: 2020 2073 656c 662e 7061 7261 6d65 7465     self.paramete
-0003af50: 725f 7665 6374 6f72 5b62 6173 655f 696e  r_vector[base_in
-0003af60: 6465 785d 203d 206e 702e 6c6f 6728 0a20  dex] = np.log(. 
-0003af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003af80: 2020 2028 7061 7261 6d65 7465 725f 7661     (parameter_va
-0003af90: 6c75 6573 5b27 7369 676d 615f 775f 2720  lues['sigma_w_' 
-0003afa0: 2b20 7365 6c66 2e69 6e73 7472 756d 656e  + self.instrumen
-0003afb0: 745d 202a 0a20 2020 2020 2020 2020 2020  t] *.           
-0003afc0: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-0003afd0: 6967 6d61 5f66 6163 746f 7229 2a2a 3229  igma_factor)**2)
-0003afe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003aff0: 2062 6173 655f 696e 6465 7820 2b3d 2031   base_index += 1
-0003b000: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0003b010: 662e 7061 7261 6d65 7465 725f 7665 6374  f.parameter_vect
-0003b020: 6f72 5b62 6173 655f 696e 6465 785d 203d  or[base_index] =
-0003b030: 206e 702e 6c6f 6728 0a20 2020 2020 2020   np.log(.       
-0003b040: 2020 2020 2020 2020 2028 7061 7261 6d65           (parame
-0003b050: 7465 725f 7661 6c75 6573 5b27 4750 5f73  ter_values['GP_s
-0003b060: 6967 6d61 5f27 202b 2073 656c 662e 696e  igma_' + self.in
-0003b070: 7075 745f 696e 7374 7275 6d65 6e74 5b30  put_instrument[0
-0003b080: 5d5d 202a 0a20 2020 2020 2020 2020 2020  ]] *.           
-0003b090: 2020 2020 2020 7365 6c66 2e73 6967 6d61        self.sigma
-0003b0a0: 5f66 6163 746f 7229 2a2a 322e 290a 2020  _factor)**2.).  
-0003b0b0: 2020 2020 2020 2020 2020 616c 7068 615f            alpha_
-0003b0c0: 6e61 6d65 203d 2027 616c 7068 6127 2069  name = 'alpha' i
-0003b0d0: 6620 7365 6c66 2e6b 6572 6e65 6c5f 6e61  f self.kernel_na
-0003b0e0: 6d65 203d 3d20 2753 454b 6572 6e65 6c27  me == 'SEKernel'
-0003b0f0: 2065 6c73 6520 276d 616c 7068 6127 0a20   else 'malpha'. 
-0003b100: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-0003b110: 2069 6e20 7261 6e67 6528 7365 6c66 2e6e   in range(self.n
-0003b120: 5829 3a0a 2020 2020 2020 2020 2020 2020  X):.            
-0003b130: 2020 2020 7365 6c66 2e70 6172 616d 6574      self.paramet
-0003b140: 6572 5f76 6563 746f 725b 6261 7365 5f69  er_vector[base_i
-0003b150: 6e64 6578 202b 2031 202b 2069 5d20 3d20  ndex + 1 + i] = 
-0003b160: 6e70 2e6c 6f67 280a 2020 2020 2020 2020  np.log(.        
-0003b170: 2020 2020 2020 2020 2020 2020 312e 202f              1. /
-0003b180: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
-0003b190: 735b 6627 4750 5f7b 616c 7068 615f 6e61  s[f'GP_{alpha_na
-0003b1a0: 6d65 7d27 202b 2073 7472 2869 2920 2b20  me}' + str(i) + 
-0003b1b0: 275f 2720 2b0a 2020 2020 2020 2020 2020  '_' +.          
-0003b1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b1e0: 7365 6c66 2e69 6e70 7574 5f69 6e73 7472  self.input_instr
-0003b1f0: 756d 656e 745b 3120 2b20 695d 5d29 0a20  ument[1 + i]]). 
-0003b200: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-0003b210: 2e6b 6572 6e65 6c5f 6e61 6d65 203d 3d20  .kernel_name == 
-0003b220: 2745 7870 5369 6e65 5371 7561 7265 6453  'ExpSineSquaredS
-0003b230: 454b 6572 6e65 6c27 3a0a 2020 2020 2020  EKernel':.      
-0003b240: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-0003b250: 662e 676c 6f62 616c 5f47 503a 0a20 2020  f.global_GP:.   
-0003b260: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0003b270: 662e 7061 7261 6d65 7465 725f 7665 6374  f.parameter_vect
-0003b280: 6f72 5b62 6173 655f 696e 6465 785d 203d  or[base_index] =
-0003b290: 206e 702e 6c6f 6728 0a20 2020 2020 2020   np.log(.       
-0003b2a0: 2020 2020 2020 2020 2020 2020 2028 7061               (pa
-0003b2b0: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
-0003b2c0: 7369 676d 615f 775f 2720 2b20 7365 6c66  sigma_w_' + self
-0003b2d0: 2e69 6e73 7472 756d 656e 745d 202a 0a20  .instrument] *. 
-0003b2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b2f0: 2020 2020 7365 6c66 2e73 6967 6d61 5f66      self.sigma_f
-0003b300: 6163 746f 7229 2a2a 3229 0a20 2020 2020  actor)**2).     
-0003b310: 2020 2020 2020 2020 2020 2062 6173 655f             base_
-0003b320: 696e 6465 7820 2b3d 2031 0a20 2020 2020  index += 1.     
-0003b330: 2020 2020 2020 2073 656c 662e 7061 7261         self.para
-0003b340: 6d65 7465 725f 7665 6374 6f72 5b62 6173  meter_vector[bas
-0003b350: 655f 696e 6465 785d 203d 206e 702e 6c6f  e_index] = np.lo
-0003b360: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
-0003b370: 2020 2028 7061 7261 6d65 7465 725f 7661     (parameter_va
-0003b380: 6c75 6573 5b27 4750 5f73 6967 6d61 5f27  lues['GP_sigma_'
-0003b390: 202b 2073 656c 662e 696e 7075 745f 696e   + self.input_in
-0003b3a0: 7374 7275 6d65 6e74 5b30 5d5d 202a 0a20  strument[0]] *. 
-0003b3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b3c0: 7365 6c66 2e73 6967 6d61 5f66 6163 746f  self.sigma_facto
-0003b3d0: 7229 2a2a 322e 290a 2020 2020 2020 2020  r)**2.).        
-0003b3e0: 2020 2020 7365 6c66 2e70 6172 616d 6574      self.paramet
-0003b3f0: 6572 5f76 6563 746f 725b 6261 7365 5f69  er_vector[base_i
-0003b400: 6e64 6578 202b 2031 5d20 3d20 6e70 2e6c  ndex + 1] = np.l
-0003b410: 6f67 280a 2020 2020 2020 2020 2020 2020  og(.            
-0003b420: 2020 2020 312e 202f 2028 7061 7261 6d65      1. / (parame
-0003b430: 7465 725f 7661 6c75 6573 5b27 4750 5f61  ter_values['GP_a
-0003b440: 6c70 6861 5f27 202b 2073 656c 662e 696e  lpha_' + self.in
-0003b450: 7075 745f 696e 7374 7275 6d65 6e74 5b31  put_instrument[1
-0003b460: 5d5d 2929 0a20 2020 2020 2020 2020 2020  ]])).           
-0003b470: 2073 656c 662e 7061 7261 6d65 7465 725f   self.parameter_
-0003b480: 7665 6374 6f72 5b62 6173 655f 696e 6465  vector[base_inde
-0003b490: 7820 2b20 325d 203d 2070 6172 616d 6574  x + 2] = paramet
-0003b4a0: 6572 5f76 616c 7565 735b 0a20 2020 2020  er_values[.     
-0003b4b0: 2020 2020 2020 2020 2020 2027 4750 5f47             'GP_G
-0003b4c0: 616d 6d61 5f27 202b 2073 656c 662e 696e  amma_' + self.in
-0003b4d0: 7075 745f 696e 7374 7275 6d65 6e74 5b32  put_instrument[2
-0003b4e0: 5d5d 0a20 2020 2020 2020 2020 2020 2073  ]].            s
-0003b4f0: 656c 662e 7061 7261 6d65 7465 725f 7665  elf.parameter_ve
-0003b500: 6374 6f72 5b62 6173 655f 696e 6465 7820  ctor[base_index 
-0003b510: 2b20 335d 203d 206e 702e 6c6f 6728 0a20  + 3] = np.log(. 
-0003b520: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0003b530: 6172 616d 6574 6572 5f76 616c 7565 735b  arameter_values[
-0003b540: 2747 505f 5072 6f74 5f27 202b 2073 656c  'GP_Prot_' + sel
-0003b550: 662e 696e 7075 745f 696e 7374 7275 6d65  f.input_instrume
-0003b560: 6e74 5b33 5d5d 290a 2020 2020 2020 2020  nt[3]]).        
-0003b570: 656c 6966 2073 656c 662e 6b65 726e 656c  elif self.kernel
-0003b580: 5f6e 616d 6520 3d3d 2027 4365 6c65 7269  _name == 'Celeri
-0003b590: 7465 5150 4b65 726e 656c 273a 0a20 2020  teQPKernel':.   
-0003b5a0: 2020 2020 2020 2020 2073 656c 662e 7061           self.pa
-0003b5b0: 7261 6d65 7465 725f 7665 6374 6f72 5b30  rameter_vector[0
-0003b5c0: 5d20 3d20 6e70 2e6c 6f67 280a 2020 2020  ] = np.log(.    
-0003b5d0: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0003b5e0: 6d65 7465 725f 7661 6c75 6573 5b27 4750  meter_values['GP
-0003b5f0: 5f42 5f27 202b 2073 656c 662e 696e 7075  _B_' + self.inpu
-0003b600: 745f 696e 7374 7275 6d65 6e74 5b30 5d5d  t_instrument[0]]
-0003b610: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0003b620: 6c66 2e70 6172 616d 6574 6572 5f76 6563  lf.parameter_vec
-0003b630: 746f 725b 315d 203d 206e 702e 6c6f 6728  tor[1] = np.log(
-0003b640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b650: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
-0003b660: 735b 2747 505f 4c5f 2720 2b20 7365 6c66  s['GP_L_' + self
-0003b670: 2e69 6e70 7574 5f69 6e73 7472 756d 656e  .input_instrumen
-0003b680: 745b 315d 5d29 0a20 2020 2020 2020 2020  t[1]]).         
-0003b690: 2020 2073 656c 662e 7061 7261 6d65 7465     self.paramete
-0003b6a0: 725f 7665 6374 6f72 5b32 5d20 3d20 6e70  r_vector[2] = np
-0003b6b0: 2e6c 6f67 280a 2020 2020 2020 2020 2020  .log(.          
-0003b6c0: 2020 2020 2020 7061 7261 6d65 7465 725f        parameter_
-0003b6d0: 7661 6c75 6573 5b27 4750 5f50 726f 745f  values['GP_Prot_
-0003b6e0: 2720 2b20 7365 6c66 2e69 6e70 7574 5f69  ' + self.input_i
-0003b6f0: 6e73 7472 756d 656e 745b 325d 5d29 0a20  nstrument[2]]). 
-0003b700: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003b710: 7061 7261 6d65 7465 725f 7665 6374 6f72  parameter_vector
-0003b720: 5b33 5d20 3d20 6e70 2e6c 6f67 280a 2020  [3] = np.log(.  
-0003b730: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-0003b740: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
-0003b750: 4750 5f43 5f27 202b 2073 656c 662e 696e  GP_C_' + self.in
-0003b760: 7075 745f 696e 7374 7275 6d65 6e74 5b33  put_instrument[3
-0003b770: 5d5d 290a 2020 2020 2020 2020 2020 2020  ]]).            
-0003b780: 6966 206e 6f74 2073 656c 662e 676c 6f62  if not self.glob
-0003b790: 616c 5f47 503a 0a20 2020 2020 2020 2020  al_GP:.         
-0003b7a0: 2020 2020 2020 2073 656c 662e 7061 7261         self.para
-0003b7b0: 6d65 7465 725f 7665 6374 6f72 5b34 5d20  meter_vector[4] 
-0003b7c0: 3d20 6e70 2e6c 6f67 280a 2020 2020 2020  = np.log(.      
-0003b7d0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-0003b7e0: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
-0003b7f0: 7369 676d 615f 775f 2720 2b20 7365 6c66  sigma_w_' + self
-0003b800: 2e69 6e73 7472 756d 656e 745d 202a 0a20  .instrument] *. 
-0003b810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b820: 2020 2073 656c 662e 7369 676d 615f 6661     self.sigma_fa
-0003b830: 6374 6f72 290a 2020 2020 2020 2020 656c  ctor).        el
-0003b840: 6966 2073 656c 662e 6b65 726e 656c 5f6e  if self.kernel_n
-0003b850: 616d 6520 3d3d 2027 4365 6c65 7269 7465  ame == 'Celerite
-0003b860: 4578 704b 6572 6e65 6c27 3a0a 2020 2020  ExpKernel':.    
-0003b870: 2020 2020 2020 2020 7365 6c66 2e70 6172          self.par
-0003b880: 616d 6574 6572 5f76 6563 746f 725b 305d  ameter_vector[0]
-0003b890: 203d 206e 702e 6c6f 6728 0a20 2020 2020   = np.log(.     
-0003b8a0: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0003b8b0: 6574 6572 5f76 616c 7565 735b 2747 505f  eter_values['GP_
-0003b8c0: 7369 676d 615f 2720 2b20 7365 6c66 2e69  sigma_' + self.i
-0003b8d0: 6e70 7574 5f69 6e73 7472 756d 656e 745b  nput_instrument[
-0003b8e0: 305d 5d29 0a20 2020 2020 2020 2020 2020  0]]).           
-0003b8f0: 2073 656c 662e 7061 7261 6d65 7465 725f   self.parameter_
-0003b900: 7665 6374 6f72 5b31 5d20 3d20 6e70 2e6c  vector[1] = np.l
-0003b910: 6f67 280a 2020 2020 2020 2020 2020 2020  og(.            
-0003b920: 2020 2020 7061 7261 6d65 7465 725f 7661      parameter_va
-0003b930: 6c75 6573 5b27 4750 5f74 696d 6573 6361  lues['GP_timesca
-0003b940: 6c65 5f27 202b 2073 656c 662e 696e 7075  le_' + self.inpu
-0003b950: 745f 696e 7374 7275 6d65 6e74 5b31 5d5d  t_instrument[1]]
-0003b960: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-0003b970: 206e 6f74 2073 656c 662e 676c 6f62 616c   not self.global
-0003b980: 5f47 503a 0a20 2020 2020 2020 2020 2020  _GP:.           
-0003b990: 2020 2020 2073 656c 662e 7061 7261 6d65       self.parame
-0003b9a0: 7465 725f 7665 6374 6f72 5b32 5d20 3d20  ter_vector[2] = 
-0003b9b0: 6e70 2e6c 6f67 280a 2020 2020 2020 2020  np.log(.        
-0003b9c0: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0003b9d0: 6d65 7465 725f 7661 6c75 6573 5b27 7369  meter_values['si
-0003b9e0: 676d 615f 775f 2720 2b20 7365 6c66 2e69  gma_w_' + self.i
-0003b9f0: 6e73 7472 756d 656e 745d 202a 0a20 2020  nstrument] *.   
-0003ba00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ba10: 2073 656c 662e 7369 676d 615f 6661 6374   self.sigma_fact
-0003ba20: 6f72 290a 2020 2020 2020 2020 656c 6966  or).        elif
-0003ba30: 2073 656c 662e 6b65 726e 656c 5f6e 616d   self.kernel_nam
-0003ba40: 6520 3d3d 2027 4365 6c65 7269 7465 4d61  e == 'CeleriteMa
-0003ba50: 7465 726e 4b65 726e 656c 273a 0a20 2020  ternKernel':.   
-0003ba60: 2020 2020 2020 2020 2073 656c 662e 7061           self.pa
-0003ba70: 7261 6d65 7465 725f 7665 6374 6f72 5b30  rameter_vector[0
-0003ba80: 5d20 3d20 6e70 2e6c 6f67 280a 2020 2020  ] = np.log(.    
-0003ba90: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0003baa0: 6d65 7465 725f 7661 6c75 6573 5b27 4750  meter_values['GP
-0003bab0: 5f73 6967 6d61 5f27 202b 2073 656c 662e  _sigma_' + self.
-0003bac0: 696e 7075 745f 696e 7374 7275 6d65 6e74  input_instrument
-0003bad0: 5b30 5d5d 290a 2020 2020 2020 2020 2020  [0]]).          
-0003bae0: 2020 7365 6c66 2e70 6172 616d 6574 6572    self.parameter
-0003baf0: 5f76 6563 746f 725b 315d 203d 206e 702e  _vector[1] = np.
-0003bb00: 6c6f 6728 0a20 2020 2020 2020 2020 2020  log(.           
-0003bb10: 2020 2020 2070 6172 616d 6574 6572 5f76       parameter_v
-0003bb20: 616c 7565 735b 2747 505f 7268 6f5f 2720  alues['GP_rho_' 
-0003bb30: 2b20 7365 6c66 2e69 6e70 7574 5f69 6e73  + self.input_ins
-0003bb40: 7472 756d 656e 745b 315d 5d29 0a20 2020  trument[1]]).   
-0003bb50: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-0003bb60: 7365 6c66 2e67 6c6f 6261 6c5f 4750 3a0a  self.global_GP:.
-0003bb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bb80: 7365 6c66 2e70 6172 616d 6574 6572 5f76  self.parameter_v
-0003bb90: 6563 746f 725b 325d 203d 206e 702e 6c6f  ector[2] = np.lo
-0003bba0: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
-0003bbb0: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
-0003bbc0: 5f76 616c 7565 735b 2773 6967 6d61 5f77  _values['sigma_w
-0003bbd0: 5f27 202b 2073 656c 662e 696e 7374 7275  _' + self.instru
-0003bbe0: 6d65 6e74 5d20 2a0a 2020 2020 2020 2020  ment] *.        
-0003bbf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003bc00: 2e73 6967 6d61 5f66 6163 746f 7229 0a20  .sigma_factor). 
-0003bc10: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-0003bc20: 2e6b 6572 6e65 6c5f 6e61 6d65 203d 3d20  .kernel_name == 
-0003bc30: 2743 656c 6572 6974 654d 6174 6572 6e45  'CeleriteMaternE
-0003bc40: 7870 4b65 726e 656c 273a 0a20 2020 2020  xpKernel':.     
-0003bc50: 2020 2020 2020 2073 656c 662e 7061 7261         self.para
-0003bc60: 6d65 7465 725f 7665 6374 6f72 5b30 5d20  meter_vector[0] 
-0003bc70: 3d20 6e70 2e6c 6f67 280a 2020 2020 2020  = np.log(.      
-0003bc80: 2020 2020 2020 2020 2020 7061 7261 6d65            parame
-0003bc90: 7465 725f 7661 6c75 6573 5b27 4750 5f73  ter_values['GP_s
-0003bca0: 6967 6d61 5f27 202b 2073 656c 662e 696e  igma_' + self.in
-0003bcb0: 7075 745f 696e 7374 7275 6d65 6e74 5b30  put_instrument[0
-0003bcc0: 5d5d 290a 2020 2020 2020 2020 2020 2020  ]]).            
-0003bcd0: 7365 6c66 2e70 6172 616d 6574 6572 5f76  self.parameter_v
-0003bce0: 6563 746f 725b 315d 203d 206e 702e 6c6f  ector[1] = np.lo
-0003bcf0: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
-0003bd00: 2020 2070 6172 616d 6574 6572 5f76 616c     parameter_val
-0003bd10: 7565 735b 2747 505f 7469 6d65 7363 616c  ues['GP_timescal
-0003bd20: 655f 2720 2b20 7365 6c66 2e69 6e70 7574  e_' + self.input
-0003bd30: 5f69 6e73 7472 756d 656e 745b 315d 5d29  _instrument[1]])
-0003bd40: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0003bd50: 662e 7061 7261 6d65 7465 725f 7665 6374  f.parameter_vect
-0003bd60: 6f72 5b33 5d20 3d20 6e70 2e6c 6f67 280a  or[3] = np.log(.
-0003bd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bd80: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
-0003bd90: 5b27 4750 5f72 686f 5f27 202b 2073 656c  ['GP_rho_' + sel
-0003bda0: 662e 696e 7075 745f 696e 7374 7275 6d65  f.input_instrume
-0003bdb0: 6e74 5b32 5d5d 290a 2020 2020 2020 2020  nt[2]]).        
-0003bdc0: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-0003bdd0: 676c 6f62 616c 5f47 503a 0a20 2020 2020  global_GP:.     
-0003bde0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003bdf0: 7061 7261 6d65 7465 725f 7665 6374 6f72  parameter_vector
-0003be00: 5b34 5d20 3d20 6e70 2e6c 6f67 280a 2020  [4] = np.log(.  
-0003be10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003be20: 2020 7061 7261 6d65 7465 725f 7661 6c75    parameter_valu
-0003be30: 6573 5b27 7369 676d 615f 775f 2720 2b20  es['sigma_w_' + 
-0003be40: 7365 6c66 2e69 6e73 7472 756d 656e 745d  self.instrument]
-0003be50: 202a 0a20 2020 2020 2020 2020 2020 2020   *.             
-0003be60: 2020 2020 2020 2073 656c 662e 7369 676d         self.sigm
-0003be70: 615f 6661 6374 6f72 290a 2020 2020 2020  a_factor).      
-0003be80: 2020 656c 6966 2073 656c 662e 6b65 726e    elif self.kern
-0003be90: 656c 5f6e 616d 6520 3d3d 2027 4365 6c65  el_name == 'Cele
-0003bea0: 7269 7465 5348 4f4b 6572 6e65 6c27 3a0a  riteSHOKernel':.
-0003beb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003bec0: 2e70 6172 616d 6574 6572 5f76 6563 746f  .parameter_vecto
-0003bed0: 725b 305d 203d 206e 702e 6c6f 6728 0a20  r[0] = np.log(. 
-0003bee0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0003bef0: 6172 616d 6574 6572 5f76 616c 7565 735b  arameter_values[
-0003bf00: 2747 505f 5330 5f27 202b 2073 656c 662e  'GP_S0_' + self.
-0003bf10: 696e 7075 745f 696e 7374 7275 6d65 6e74  input_instrument
-0003bf20: 5b30 5d5d 290a 2020 2020 2020 2020 2020  [0]]).          
-0003bf30: 2020 7365 6c66 2e70 6172 616d 6574 6572    self.parameter
-0003bf40: 5f76 6563 746f 725b 315d 203d 206e 702e  _vector[1] = np.
-0003bf50: 6c6f 6728 0a20 2020 2020 2020 2020 2020  log(.           
-0003bf60: 2020 2020 2070 6172 616d 6574 6572 5f76       parameter_v
-0003bf70: 616c 7565 735b 2747 505f 515f 2720 2b20  alues['GP_Q_' + 
-0003bf80: 7365 6c66 2e69 6e70 7574 5f69 6e73 7472  self.input_instr
-0003bf90: 756d 656e 745b 315d 5d29 0a20 2020 2020  ument[1]]).     
-0003bfa0: 2020 2020 2020 2073 656c 662e 7061 7261         self.para
-0003bfb0: 6d65 7465 725f 7665 6374 6f72 5b32 5d20  meter_vector[2] 
-0003bfc0: 3d20 6e70 2e6c 6f67 280a 2020 2020 2020  = np.log(.      
-0003bfd0: 2020 2020 2020 2020 2020 7061 7261 6d65            parame
-0003bfe0: 7465 725f 7661 6c75 6573 5b27 4750 5f6f  ter_values['GP_o
-0003bff0: 6d65 6761 305f 2720 2b20 7365 6c66 2e69  mega0_' + self.i
-0003c000: 6e70 7574 5f69 6e73 7472 756d 656e 745b  nput_instrument[
-0003c010: 325d 5d29 0a20 2020 2020 2020 2020 2020  2]]).           
-0003c020: 200a 2020 2020 2020 2020 2020 2020 6966   .            if
-0003c030: 206e 6f74 2073 656c 662e 676c 6f62 616c   not self.global
-0003c040: 5f47 503a 0a0a 2020 2020 2020 2020 2020  _GP:..          
-0003c050: 2020 2020 2020 7365 6c66 2e70 6172 616d        self.param
-0003c060: 6574 6572 5f76 6563 746f 725b 335d 203d  eter_vector[3] =
-0003c070: 206e 702e 6c6f 6728 0a20 2020 2020 2020   np.log(.       
-0003c080: 2020 2020 2020 2020 2020 2020 2070 6172               par
-0003c090: 616d 6574 6572 5f76 616c 7565 735b 2773  ameter_values['s
-0003c0a0: 6967 6d61 5f77 5f27 202b 2073 656c 662e  igma_w_' + self.
-0003c0b0: 696e 7374 7275 6d65 6e74 5d20 2a0a 2020  instrument] *.  
-0003c0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c0d0: 2020 7365 6c66 2e73 6967 6d61 5f66 6163    self.sigma_fac
-0003c0e0: 746f 7229 0a20 2020 2020 2020 2020 2020  tor).           
-0003c0f0: 2020 2020 200a 2020 2020 2020 2020 656c       .        el
-0003c100: 6966 2073 656c 662e 6b65 726e 656c 5f6e  if self.kernel_n
-0003c110: 616d 6520 3d3d 2027 4365 6c65 7269 7465  ame == 'Celerite
-0003c120: 446f 7562 6c65 5348 4f4b 6572 6e65 6c27  DoubleSHOKernel'
-0003c130: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0003c140: 5468 6520 7061 7261 6d65 7472 697a 6174  The parametrizat
-0003c150: 696f 6e20 666f 6c6c 6f77 7320 7468 6520  ion follows the 
-0003c160: 2252 6f74 6174 696f 6e54 6572 6d22 2069  "RotationTerm" i
-0003c170: 6d70 6c65 6d65 6e74 6564 2069 6e0a 2020  mplemented in.  
-0003c180: 2020 2020 2020 2020 2020 2320 6365 6c65            # cele
-0003c190: 7269 7465 3220 6874 7470 733a 2f2f 6365  rite2 https://ce
-0003c1a0: 6c65 7269 7465 322e 7265 6164 7468 6564  lerite2.readthed
-0003c1b0: 6f63 732e 696f 2f65 6e2f 6c61 7465 7374  ocs.io/en/latest
-0003c1c0: 2f61 7069 2f70 7974 686f 6e2f 2363 656c  /api/python/#cel
-0003c1d0: 6572 6974 6532 2e74 6572 6d73 2e52 6f74  erite2.terms.Rot
-0003c1e0: 6174 696f 6e54 6572 6d0a 2020 2020 2020  ationTerm.      
-0003c1f0: 2020 2020 2020 7369 676d 6120 3d20 7061        sigma = pa
-0003c200: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
-0003c210: 4750 5f73 6967 6d61 5f27 202b 2073 656c  GP_sigma_' + sel
-0003c220: 662e 696e 7075 745f 696e 7374 7275 6d65  f.input_instrume
-0003c230: 6e74 5b30 5d5d 0a20 2020 2020 2020 2020  nt[0]].         
-0003c240: 2020 2051 3020 3d20 7061 7261 6d65 7465     Q0 = paramete
-0003c250: 725f 7661 6c75 6573 5b27 4750 5f51 305f  r_values['GP_Q0_
-0003c260: 2720 2b20 7365 6c66 2e69 6e70 7574 5f69  ' + self.input_i
-0003c270: 6e73 7472 756d 656e 745b 315d 5d0a 2020  nstrument[1]].  
-0003c280: 2020 2020 2020 2020 2020 5020 3d20 7061            P = pa
-0003c290: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
-0003c2a0: 4750 5f70 6572 696f 645f 2720 2b20 7365  GP_period_' + se
-0003c2b0: 6c66 2e69 6e70 7574 5f69 6e73 7472 756d  lf.input_instrum
-0003c2c0: 656e 745b 325d 5d0a 2020 2020 2020 2020  ent[2]].        
-0003c2d0: 2020 2020 6620 3d20 7061 7261 6d65 7465      f = paramete
-0003c2e0: 725f 7661 6c75 6573 5b27 4750 5f66 5f27  r_values['GP_f_'
-0003c2f0: 202b 2073 656c 662e 696e 7075 745f 696e   + self.input_in
-0003c300: 7374 7275 6d65 6e74 5b33 5d5d 0a20 2020  strument[3]].   
-0003c310: 2020 2020 2020 2020 2064 5120 3d20 7061           dQ = pa
-0003c320: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
-0003c330: 4750 5f64 515f 2720 2b20 7365 6c66 2e69  GP_dQ_' + self.i
-0003c340: 6e70 7574 5f69 6e73 7472 756d 656e 745b  nput_instrument[
-0003c350: 345d 5d0a 0a20 2020 2020 2020 2020 2020  4]]..           
-0003c360: 2051 3120 3d20 3120 2f20 3220 2b20 5130   Q1 = 1 / 2 + Q0
-0003c370: 202b 2064 510a 2020 2020 2020 2020 2020   + dQ.          
-0003c380: 2020 6f6d 6567 6131 203d 2034 202a 206e    omega1 = 4 * n
-0003c390: 702e 7069 202a 2051 3120 2f20 2850 202a  p.pi * Q1 / (P *
-0003c3a0: 206e 702e 7371 7274 2834 202a 2051 312a   np.sqrt(4 * Q1*
-0003c3b0: 2a32 202d 2031 2929 0a20 2020 2020 2020  *2 - 1)).       
-0003c3c0: 2020 2020 2053 3120 3d20 7369 676d 612a       S1 = sigma*
-0003c3d0: 2a32 202f 2028 2831 202b 2066 2920 2a20  *2 / ((1 + f) * 
-0003c3e0: 6f6d 6567 6131 202a 2051 3129 0a0a 2020  omega1 * Q1)..  
-0003c3f0: 2020 2020 2020 2020 2020 5132 203d 2031            Q2 = 1
-0003c400: 202f 2032 202b 2051 300a 2020 2020 2020   / 2 + Q0.      
-0003c410: 2020 2020 2020 6f6d 6567 6132 203d 2038        omega2 = 8
-0003c420: 202a 206e 702e 7069 202a 2051 3120 2f20   * np.pi * Q1 / 
-0003c430: 2850 202a 206e 702e 7371 7274 2834 202a  (P * np.sqrt(4 *
-0003c440: 2051 312a 2a32 202d 2031 2929 0a20 2020   Q1**2 - 1)).   
-0003c450: 2020 2020 2020 2020 2053 3220 3d20 6620           S2 = f 
-0003c460: 2a20 7369 676d 612a 2a32 202f 2028 2831  * sigma**2 / ((1
-0003c470: 202b 2066 2920 2a20 6f6d 6567 6132 202a   + f) * omega2 *
-0003c480: 2051 3229 0a0a 2020 2020 2020 2020 2020   Q2)..          
-0003c490: 2020 7365 6c66 2e70 6172 616d 6574 6572    self.parameter
-0003c4a0: 5f76 6563 746f 725b 305d 203d 206e 702e  _vector[0] = np.
-0003c4b0: 6c6f 6728 5331 290a 2020 2020 2020 2020  log(S1).        
-0003c4c0: 2020 2020 7365 6c66 2e70 6172 616d 6574      self.paramet
-0003c4d0: 6572 5f76 6563 746f 725b 315d 203d 206e  er_vector[1] = n
-0003c4e0: 702e 6c6f 6728 5131 290a 2020 2020 2020  p.log(Q1).      
-0003c4f0: 2020 2020 2020 7365 6c66 2e70 6172 616d        self.param
-0003c500: 6574 6572 5f76 6563 746f 725b 325d 203d  eter_vector[2] =
-0003c510: 206e 702e 6c6f 6728 6f6d 6567 6131 290a   np.log(omega1).
-0003c520: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003c530: 2e70 6172 616d 6574 6572 5f76 6563 746f  .parameter_vecto
-0003c540: 725b 335d 203d 206e 702e 6c6f 6728 5332  r[3] = np.log(S2
-0003c550: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0003c560: 6c66 2e70 6172 616d 6574 6572 5f76 6563  lf.parameter_vec
-0003c570: 746f 725b 345d 203d 206e 702e 6c6f 6728  tor[4] = np.log(
-0003c580: 5132 290a 2020 2020 2020 2020 2020 2020  Q2).            
-0003c590: 7365 6c66 2e70 6172 616d 6574 6572 5f76  self.parameter_v
-0003c5a0: 6563 746f 725b 355d 203d 206e 702e 6c6f  ector[5] = np.lo
-0003c5b0: 6728 6f6d 6567 6132 290a 0a20 2020 2020  g(omega2)..     
-0003c5c0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-0003c5d0: 6c66 2e67 6c6f 6261 6c5f 4750 3a0a 0a20  lf.global_GP:.. 
-0003c5e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0003c5f0: 656c 662e 7061 7261 6d65 7465 725f 7665  elf.parameter_ve
-0003c600: 6374 6f72 5b36 5d20 3d20 6e70 2e6c 6f67  ctor[6] = np.log
-0003c610: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0003c620: 2020 2020 2020 7061 7261 6d65 7465 725f        parameter_
-0003c630: 7661 6c75 6573 5b27 7369 676d 615f 775f  values['sigma_w_
-0003c640: 2720 2b20 7365 6c66 2e69 6e73 7472 756d  ' + self.instrum
-0003c650: 656e 745d 202a 0a20 2020 2020 2020 2020  ent] *.         
-0003c660: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003c670: 7369 676d 615f 6661 6374 6f72 290a 0a20  sigma_factor).. 
-0003c680: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-0003c690: 2e6b 6572 6e65 6c5f 6e61 6d65 203d 3d20  .kernel_name == 
-0003c6a0: 2743 656c 6572 6974 6554 7269 706c 6553  'CeleriteTripleS
-0003c6b0: 484f 4b65 726e 656c 273a 0a20 2020 2020  HOKernel':.     
-0003c6c0: 2020 2020 2020 2073 656c 662e 7061 7261         self.para
-0003c6d0: 6d65 7465 725f 7665 6374 6f72 5b30 5d20  meter_vector[0] 
-0003c6e0: 3d20 6e70 2e6c 6f67 280a 2020 2020 2020  = np.log(.      
-0003c6f0: 2020 2020 2020 2020 2020 7061 7261 6d65            parame
-0003c700: 7465 725f 7661 6c75 6573 5b27 4750 5f53  ter_values['GP_S
-0003c710: 305f 2720 2b20 7365 6c66 2e69 6e70 7574  0_' + self.input
-0003c720: 5f69 6e73 7472 756d 656e 745b 305d 5d29  _instrument[0]])
-0003c730: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0003c740: 662e 7061 7261 6d65 7465 725f 7665 6374  f.parameter_vect
-0003c750: 6f72 5b31 5d20 3d20 6e70 2e6c 6f67 280a  or[1] = np.log(.
-0003c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c770: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
-0003c780: 5b27 4750 5f51 305f 2720 2b20 7365 6c66  ['GP_Q0_' + self
-0003c790: 2e69 6e70 7574 5f69 6e73 7472 756d 656e  .input_instrumen
-0003c7a0: 745b 315d 5d29 0a20 2020 2020 2020 2020  t[1]]).         
-0003c7b0: 2020 2073 656c 662e 7061 7261 6d65 7465     self.paramete
-0003c7c0: 725f 7665 6374 6f72 5b32 5d20 3d20 6e70  r_vector[2] = np
-0003c7d0: 2e6c 6f67 280a 2020 2020 2020 2020 2020  .log(.          
-0003c7e0: 2020 2020 2020 3220 2a20 6e70 2e70 6920        2 * np.pi 
-0003c7f0: 2f0a 2020 2020 2020 2020 2020 2020 2020  /.              
-0003c800: 2020 7061 7261 6d65 7465 725f 7661 6c75    parameter_valu
-0003c810: 6573 5b27 4750 5f70 6572 696f 645f 2720  es['GP_period_' 
-0003c820: 2b20 7365 6c66 2e69 6e70 7574 5f69 6e73  + self.input_ins
-0003c830: 7472 756d 656e 745b 325d 5d29 0a20 2020  trument[2]]).   
-0003c840: 2020 2020 2020 2020 2073 656c 662e 7061           self.pa
-0003c850: 7261 6d65 7465 725f 7665 6374 6f72 5b33  rameter_vector[3
-0003c860: 5d20 3d20 6e70 2e6c 6f67 280a 2020 2020  ] = np.log(.    
-0003c870: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0003c880: 6d65 7465 725f 7661 6c75 6573 5b27 4750  meter_values['GP
-0003c890: 5f66 5f27 202b 2073 656c 662e 696e 7075  _f_' + self.inpu
-0003c8a0: 745f 696e 7374 7275 6d65 6e74 5b33 5d5d  t_instrument[3]]
-0003c8b0: 202a 0a20 2020 2020 2020 2020 2020 2020   *.             
-0003c8c0: 2020 2070 6172 616d 6574 6572 5f76 616c     parameter_val
-0003c8d0: 7565 735b 2747 505f 5330 5f27 202b 2073  ues['GP_S0_' + s
-0003c8e0: 656c 662e 696e 7075 745f 696e 7374 7275  elf.input_instru
-0003c8f0: 6d65 6e74 5b30 5d5d 290a 2020 2020 2020  ment[0]]).      
-0003c900: 2020 2020 2020 7365 6c66 2e70 6172 616d        self.param
-0003c910: 6574 6572 5f76 6563 746f 725b 345d 203d  eter_vector[4] =
-0003c920: 206e 702e 6c6f 6728 0a20 2020 2020 2020   np.log(.       
-0003c930: 2020 2020 2020 2020 2070 6172 616d 6574           paramet
-0003c940: 6572 5f76 616c 7565 735b 2747 505f 5130  er_values['GP_Q0
-0003c950: 5f27 202b 2073 656c 662e 696e 7075 745f  _' + self.input_
-0003c960: 696e 7374 7275 6d65 6e74 5b31 5d5d 202d  instrument[1]] -
-0003c970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c980: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
-0003c990: 735b 2747 505f 6451 5f27 202b 2073 656c  s['GP_dQ_' + sel
-0003c9a0: 662e 696e 7075 745f 696e 7374 7275 6d65  f.input_instrume
-0003c9b0: 6e74 5b34 5d5d 290a 2020 2020 2020 2020  nt[4]]).        
-0003c9c0: 2020 2020 7365 6c66 2e70 6172 616d 6574      self.paramet
-0003c9d0: 6572 5f76 6563 746f 725b 355d 203d 206e  er_vector[5] = n
-0003c9e0: 702e 6c6f 6728 0a20 2020 2020 2020 2020  p.log(.         
-0003c9f0: 2020 2020 2020 206e 702e 7069 202f 0a20         np.pi /. 
-0003ca00: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0003ca10: 6172 616d 6574 6572 5f76 616c 7565 735b  arameter_values[
-0003ca20: 2747 505f 7065 7269 6f64 5f27 202b 2073  'GP_period_' + s
-0003ca30: 656c 662e 696e 7075 745f 696e 7374 7275  elf.input_instru
-0003ca40: 6d65 6e74 5b32 5d5d 290a 2020 2020 2020  ment[2]]).      
-0003ca50: 2020 2020 2020 7365 6c66 2e70 6172 616d        self.param
-0003ca60: 6574 6572 5f76 6563 746f 725b 365d 203d  eter_vector[6] =
-0003ca70: 206e 702e 6c6f 6728 0a20 2020 2020 2020   np.log(.       
-0003ca80: 2020 2020 2020 2020 2070 6172 616d 6574           paramet
-0003ca90: 6572 5f76 616c 7565 735b 2747 505f 5330  er_values['GP_S0
-0003caa0: 7363 5f27 202b 2073 656c 662e 696e 7075  sc_' + self.inpu
-0003cab0: 745f 696e 7374 7275 6d65 6e74 5b35 5d5d  t_instrument[5]]
-0003cac0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0003cad0: 6c66 2e70 6172 616d 6574 6572 5f76 6563  lf.parameter_vec
-0003cae0: 746f 725b 375d 203d 206e 702e 6c6f 6728  tor[7] = np.log(
-0003caf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003cb00: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
-0003cb10: 735b 2747 505f 6f6d 6567 6130 7363 5f27  s['GP_omega0sc_'
-0003cb20: 202b 2073 656c 662e 696e 7075 745f 696e   + self.input_in
-0003cb30: 7374 7275 6d65 6e74 5b36 5d5d 290a 0a20  strument[6]]).. 
-0003cb40: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-0003cb50: 7420 7365 6c66 2e67 6c6f 6261 6c5f 4750  t self.global_GP
-0003cb60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003cb70: 2020 7365 6c66 2e70 6172 616d 6574 6572    self.parameter
-0003cb80: 5f76 6563 746f 725b 385d 203d 206e 702e  _vector[8] = np.
-0003cb90: 6c6f 6728 0a20 2020 2020 2020 2020 2020  log(.           
-0003cba0: 2020 2020 2020 2020 2070 6172 616d 6574           paramet
-0003cbb0: 6572 5f76 616c 7565 735b 2773 6967 6d61  er_values['sigma
-0003cbc0: 5f77 5f27 202b 2073 656c 662e 696e 7374  _w_' + self.inst
-0003cbd0: 7275 6d65 6e74 5d20 2a0a 2020 2020 2020  rument] *.      
-0003cbe0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0003cbf0: 6c66 2e73 6967 6d61 5f66 6163 746f 7229  lf.sigma_factor)
-0003cc00: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-0003cc10: 2020 2320 466f 7220 4d61 7465 726e 2b53    # For Matern+S
-0003cc20: 484f 206b 6572 6e65 6c0a 2020 2020 2020  HO kernel.      
-0003cc30: 2020 656c 6966 2073 656c 662e 6b65 726e    elif self.kern
-0003cc40: 656c 5f6e 616d 6520 3d3d 2027 4365 6c65  el_name == 'Cele
-0003cc50: 7269 7465 4d61 7465 726e 5348 4f4b 6572  riteMaternSHOKer
-0003cc60: 6e65 6c27 3a0a 2020 2020 2020 2020 2020  nel':.          
-0003cc70: 2020 7365 6c66 2e70 6172 616d 6574 6572    self.parameter
-0003cc80: 5f76 6563 746f 725b 305d 203d 206e 702e  _vector[0] = np.
-0003cc90: 6c6f 6728 7061 7261 6d65 7465 725f 7661  log(parameter_va
-0003cca0: 6c75 6573 5b27 4750 5f73 6967 6d61 5f27  lues['GP_sigma_'
-0003ccb0: 2b73 656c 662e 696e 7075 745f 696e 7374  +self.input_inst
-0003ccc0: 7275 6d65 6e74 5b30 5d5d 290a 2020 2020  rument[0]]).    
-0003ccd0: 2020 2020 2020 2020 7365 6c66 2e70 6172          self.par
-0003cce0: 616d 6574 6572 5f76 6563 746f 725b 315d  ameter_vector[1]
-0003ccf0: 203d 206e 702e 6c6f 6728 7061 7261 6d65   = np.log(parame
-0003cd00: 7465 725f 7661 6c75 6573 5b27 4750 5f72  ter_values['GP_r
-0003cd10: 686f 5f27 2b73 656c 662e 696e 7075 745f  ho_'+self.input_
-0003cd20: 696e 7374 7275 6d65 6e74 5b31 5d5d 290a  instrument[1]]).
-0003cd30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003cd40: 2e70 6172 616d 6574 6572 5f76 6563 746f  .parameter_vecto
-0003cd50: 725b 325d 203d 206e 702e 6c6f 6728 7061  r[2] = np.log(pa
-0003cd60: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
-0003cd70: 4750 5f53 305f 272b 7365 6c66 2e69 6e70  GP_S0_'+self.inp
-0003cd80: 7574 5f69 6e73 7472 756d 656e 745b 325d  ut_instrument[2]
-0003cd90: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
-0003cda0: 656c 662e 7061 7261 6d65 7465 725f 7665  elf.parameter_ve
-0003cdb0: 6374 6f72 5b33 5d20 3d20 6e70 2e6c 6f67  ctor[3] = np.log
-0003cdc0: 2870 6172 616d 6574 6572 5f76 616c 7565  (parameter_value
-0003cdd0: 735b 2747 505f 515f 272b 7365 6c66 2e69  s['GP_Q_'+self.i
-0003cde0: 6e70 7574 5f69 6e73 7472 756d 656e 745b  nput_instrument[
-0003cdf0: 335d 5d29 0a20 2020 2020 2020 2020 2020  3]]).           
-0003ce00: 2073 656c 662e 7061 7261 6d65 7465 725f   self.parameter_
-0003ce10: 7665 6374 6f72 5b34 5d20 3d20 6e70 2e6c  vector[4] = np.l
-0003ce20: 6f67 2870 6172 616d 6574 6572 5f76 616c  og(parameter_val
-0003ce30: 7565 735b 2747 505f 6f6d 6567 6130 5f27  ues['GP_omega0_'
-0003ce40: 2b73 656c 662e 696e 7075 745f 696e 7374  +self.input_inst
-0003ce50: 7275 6d65 6e74 5b34 5d5d 290a 2020 2020  rument[4]]).    
-0003ce60: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-0003ce70: 656c 662e 676c 6f62 616c 5f47 503a 0a20  elf.global_GP:. 
-0003ce80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0003ce90: 656c 662e 7061 7261 6d65 7465 725f 7665  elf.parameter_ve
-0003cea0: 6374 6f72 5b35 5d20 3d20 6e70 2e6c 6f67  ctor[5] = np.log
-0003ceb0: 2870 6172 616d 6574 6572 5f76 616c 7565  (parameter_value
-0003cec0: 735b 2773 6967 6d61 5f77 5f27 2b73 656c  s['sigma_w_'+sel
-0003ced0: 662e 696e 7374 7275 6d65 6e74 5d2a 7365  f.instrument]*se
-0003cee0: 6c66 2e73 6967 6d61 5f66 6163 746f 7229  lf.sigma_factor)
-0003cef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003cf00: 200a 2020 2020 2020 2020 7365 6c66 2e47   .        self.G
-0003cf10: 502e 7365 745f 7061 7261 6d65 7465 725f  P.set_parameter_
-0003cf20: 7665 6374 6f72 2873 656c 662e 7061 7261  vector(self.para
-0003cf30: 6d65 7465 725f 7665 6374 6f72 290a 0a20  meter_vector).. 
-0003cf40: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-0003cf50: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
-0003cf60: 2020 2020 2020 2064 6174 612c 0a20 2020         data,.   
-0003cf70: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0003cf80: 6465 6c5f 7479 7065 2c0a 2020 2020 2020  del_type,.      
-0003cf90: 2020 2020 2020 2020 2020 2069 6e73 7472             instr
-0003cfa0: 756d 656e 742c 0a20 2020 2020 2020 2020  ument,.         
-0003cfb0: 2020 2020 2020 2020 6765 6f72 6765 5f68          george_h
-0003cfc0: 6f64 6c72 3d54 7275 652c 0a20 2020 2020  odlr=True,.     
-0003cfd0: 2020 2020 2020 2020 2020 2020 6d61 7465              mate
-0003cfe0: 726e 5f65 7073 3d30 2e30 3129 3a0a 2020  rn_eps=0.01):.  
-0003cff0: 2020 2020 2020 7365 6c66 2e69 7349 6e69        self.isIni
-0003d000: 7420 3d20 4661 6c73 650a 2020 2020 2020  t = False.      
-0003d010: 2020 7365 6c66 2e6d 6f64 656c 5f74 7970    self.model_typ
-0003d020: 6520 3d20 6d6f 6465 6c5f 7479 7065 2e6c  e = model_type.l
-0003d030: 6f77 6572 2829 0a20 2020 2020 2020 2023  ower().        #
-0003d040: 2050 6572 666f 726d 2063 6861 6e67 6573   Perform changes
-0003d050: 2074 6861 7420 6465 6669 6e65 2074 6865   that define the
-0003d060: 206d 6f64 656c 5f74 7970 652e 2046 6f72   model_type. For
-0003d070: 2065 7861 6d70 6c65 2c20 7468 6520 6a75   example, the ju
-0003d080: 6c69 6574 2069 6e70 7574 2073 6967 6d61  liet input sigma
-0003d090: 7320 2862 6f74 6820 6a69 7474 6572 7320  s (both jitters 
-0003d0a0: 616e 6420 4750 2061 6d70 6c69 7475 6465  and GP amplitude
-0003d0b0: 7329 2061 7265 0a20 2020 2020 2020 2023  s) are.        #
-0003d0c0: 2067 6976 656e 2069 6e20 7070 6d20 696e   given in ppm in
-0003d0d0: 2074 6865 2069 6e70 7574 2066 696c 6573   the input files
-0003d0e0: 2c20 7768 6572 6561 7320 666f 7220 5256  , whereas for RV
-0003d0f0: 7320 7468 6579 2068 6176 6520 7468 6520  s they have the 
-0003d100: 7361 6d65 2075 6e69 7473 2061 7320 7468  same units as th
-0003d110: 6520 696e 7075 7420 5256 732e 2054 6869  e input RVs. Thi
-0003d120: 7320 636f 6e76 6572 7369 6f6e 2066 6163  s conversion fac
-0003d130: 746f 7220 6973 0a20 2020 2020 2020 2023  tor is.        #
-0003d140: 2064 6566 696e 6564 2062 7920 7468 6520   defined by the 
-0003d150: 6d6f 6465 6c5f 7479 7065 3a0a 2020 2020  model_type:.    
-0003d160: 2020 2020 6966 2073 656c 662e 6d6f 6465      if self.mode
-0003d170: 6c5f 7479 7065 203d 3d20 276c 6327 3a0a  l_type == 'lc':.
-0003d180: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0003d190: 6e73 7472 756d 656e 7420 6973 204e 6f6e  nstrument is Non
-0003d1a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0003d1b0: 2020 2069 6e73 7472 756d 656e 7420 3d20     instrument = 
-0003d1c0: 276c 6327 0a20 2020 2020 2020 2020 2020  'lc'.           
-0003d1d0: 2073 656c 662e 7369 676d 615f 6661 6374   self.sigma_fact
-0003d1e0: 6f72 203d 2031 652d 360a 2020 2020 2020  or = 1e-6.      
-0003d1f0: 2020 656c 6966 2073 656c 662e 6d6f 6465    elif self.mode
-0003d200: 6c5f 7479 7065 203d 3d20 2772 7627 3a0a  l_type == 'rv':.
-0003d210: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0003d220: 6e73 7472 756d 656e 7420 6973 204e 6f6e  nstrument is Non
-0003d230: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0003d240: 2020 2069 6e73 7472 756d 656e 7420 3d20     instrument = 
-0003d250: 2772 7627 0a20 2020 2020 2020 2020 2020  'rv'.           
-0003d260: 2073 656c 662e 7369 676d 615f 6661 6374   self.sigma_fact
-0003d270: 6f72 203d 2031 2e0a 2020 2020 2020 2020  or = 1..        
-0003d280: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0003d290: 2020 7261 6973 6520 4578 6365 7074 696f    raise Exceptio
-0003d2a0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-0003d2b0: 2020 2027 4d6f 6465 6c20 7479 7065 2027     'Model type '
-0003d2c0: 202b 206d 6f64 656c 5f74 7970 6520 2b0a   + model_type +.
-0003d2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d2e0: 2720 6375 7272 656e 746c 7920 6e6f 7420  ' currently not 
-0003d2f0: 7375 7070 6f72 7465 642e 204f 6e6c 7920  supported. Only 
-0003d300: 226c 6322 206f 7220 2272 7622 2063 616e  "lc" or "rv" can
-0003d310: 2073 6572 7665 2061 7320 696e 7075 7473   serve as inputs
-0003d320: 2066 6f72 206e 6f77 2e27 0a20 2020 2020   for now.'.     
-0003d330: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0003d340: 2020 2320 4e61 6d65 206f 6620 696e 7075    # Name of inpu
-0003d350: 7420 696e 7374 7275 6d65 6e74 2069 6620  t instrument if 
-0003d360: 6769 7665 6e3a 0a20 2020 2020 2020 2073  given:.        s
-0003d370: 656c 662e 696e 7374 7275 6d65 6e74 203d  elf.instrument =
-0003d380: 2069 6e73 7472 756d 656e 740a 0a20 2020   instrument..   
-0003d390: 2020 2020 2023 2049 6e69 7469 616c 697a       # Initializ
-0003d3a0: 6520 676c 6f62 616c 206d 6f64 656c 2076  e global model v
-0003d3b0: 6172 6961 626c 653a 0a20 2020 2020 2020  ariable:.       
-0003d3c0: 2073 656c 662e 676c 6f62 616c 5f47 5020   self.global_GP 
-0003d3d0: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
-0003d3e0: 2023 2045 7874 7261 6374 2069 6e66 6f72   # Extract infor
-0003d3f0: 6d61 7469 6f6e 2066 726f 6d20 7468 6520  mation from the 
-0003d400: 6461 7461 206f 626a 6563 743a 0a20 2020  data object:.   
-0003d410: 2020 2020 2069 6620 7365 6c66 2e6d 6f64       if self.mod
-0003d420: 656c 5f74 7970 6520 3d3d 2027 6c63 273a  el_type == 'lc':
-0003d430: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
-0003d440: 6176 6520 696e 7075 7420 7072 6564 6963  ave input predic
-0003d450: 746f 723a 0a20 2020 2020 2020 2020 2020  tor:.           
-0003d460: 2069 6620 696e 7374 7275 6d65 6e74 203d   if instrument =
-0003d470: 3d20 276c 6327 3a0a 2020 2020 2020 2020  = 'lc':.        
-0003d480: 2020 2020 2020 2020 7365 6c66 2e58 203d          self.X =
-0003d490: 2064 6174 612e 4750 5f6c 635f 6172 6775   data.GP_lc_argu
-0003d4a0: 6d65 6e74 735b 276c 6327 5d0a 2020 2020  ments['lc'].    
-0003d4b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003d4c0: 2e67 6c6f 6261 6c5f 4750 203d 2054 7275  .global_GP = Tru
-0003d4d0: 650a 2020 2020 2020 2020 2020 2020 656c  e.            el
-0003d4e0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0003d4f0: 2020 2020 7365 6c66 2e58 203d 2064 6174      self.X = dat
-0003d500: 612e 4750 5f6c 635f 6172 6775 6d65 6e74  a.GP_lc_argument
-0003d510: 735b 696e 7374 7275 6d65 6e74 5d0a 2020  s[instrument].  
-0003d520: 2020 2020 2020 2020 2020 2320 5361 7665            # Save
-0003d530: 2065 7272 6f72 7320 2869 6620 616e 7929   errors (if any)
-0003d540: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0003d550: 2064 6174 612e 7965 7272 5f6c 6320 6973   data.yerr_lc is
-0003d560: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0003d570: 2020 2020 2020 2020 2020 2069 6620 696e             if in
-0003d580: 7374 7275 6d65 6e74 2021 3d20 276c 6327  strument != 'lc'
-0003d590: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003d5a0: 2020 2020 2020 7365 6c66 2e79 6572 7220        self.yerr 
-0003d5b0: 3d20 6461 7461 2e79 6572 725f 6c63 5b0a  = data.yerr_lc[.
-0003d5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d5d0: 2020 2020 2020 2020 6461 7461 2e69 6e73          data.ins
-0003d5e0: 7472 756d 656e 745f 696e 6465 7865 735f  trument_indexes_
-0003d5f0: 6c63 5b69 6e73 7472 756d 656e 745d 5d0a  lc[instrument]].
-0003d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d610: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0003d620: 2020 2020 2020 2020 2020 7365 6c66 2e79            self.y
-0003d630: 6572 7220 3d20 6461 7461 2e79 6572 725f  err = data.yerr_
-0003d640: 6c63 0a20 2020 2020 2020 2020 2020 2065  lc.            e
-0003d650: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0003d660: 2020 2020 2073 656c 662e 7965 7272 203d       self.yerr =
-0003d670: 204e 6f6e 650a 2020 2020 2020 2020 656c   None.        el
-0003d680: 6966 2073 656c 662e 6d6f 6465 6c5f 7479  if self.model_ty
-0003d690: 7065 203d 3d20 2772 7627 3a0a 2020 2020  pe == 'rv':.    
-0003d6a0: 2020 2020 2020 2020 2320 5361 7665 2069          # Save i
-0003d6b0: 6e70 7574 2070 7265 6469 6374 6f72 3a0a  nput predictor:.
-0003d6c0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0003d6d0: 6e73 7472 756d 656e 7420 3d3d 2027 7276  nstrument == 'rv
-0003d6e0: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-0003d6f0: 2020 2073 656c 662e 5820 3d20 6461 7461     self.X = data
-0003d700: 2e47 505f 7276 5f61 7267 756d 656e 7473  .GP_rv_arguments
-0003d710: 5b27 7276 275d 0a20 2020 2020 2020 2020  ['rv'].         
-0003d720: 2020 2020 2020 2073 656c 662e 676c 6f62         self.glob
-0003d730: 616c 5f47 5020 3d20 5472 7565 0a20 2020  al_GP = True.   
-0003d740: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0003d750: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0003d760: 656c 662e 5820 3d20 6461 7461 2e47 505f  elf.X = data.GP_
-0003d770: 7276 5f61 7267 756d 656e 7473 5b69 6e73  rv_arguments[ins
-0003d780: 7472 756d 656e 745d 0a20 2020 2020 2020  trument].       
-0003d790: 2020 2020 2023 2053 6176 6520 6572 726f       # Save erro
-0003d7a0: 7273 2028 6966 2061 6e79 293a 0a20 2020  rs (if any):.   
-0003d7b0: 2020 2020 2020 2020 2069 6620 6461 7461           if data
-0003d7c0: 2e79 6572 725f 7276 2069 7320 6e6f 7420  .yerr_rv is not 
-0003d7d0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0003d7e0: 2020 2020 2020 6966 2069 6e73 7472 756d        if instrum
-0003d7f0: 656e 7420 213d 2027 7276 273a 0a20 2020  ent != 'rv':.   
-0003d800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d810: 2073 656c 662e 7965 7272 203d 2064 6174   self.yerr = dat
-0003d820: 612e 7965 7272 5f72 765b 0a20 2020 2020  a.yerr_rv[.     
-0003d830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d840: 2020 2064 6174 612e 696e 7374 7275 6d65     data.instrume
-0003d850: 6e74 5f69 6e64 6578 6573 5f72 765b 696e  nt_indexes_rv[in
-0003d860: 7374 7275 6d65 6e74 5d5d 0a20 2020 2020  strument]].     
-0003d870: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0003d880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003d890: 2020 2020 2073 656c 662e 7965 7272 203d       self.yerr =
-0003d8a0: 2064 6174 612e 7965 7272 5f72 760a 2020   data.yerr_rv.  
-0003d8b0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0003d8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d8d0: 7365 6c66 2e79 6572 7220 3d20 4e6f 6e65  self.yerr = None
-0003d8e0: 0a0a 2020 2020 2020 2020 2320 4669 7820  ..        # Fix 
-0003d8f0: 7369 7a65 7320 6f66 2072 6567 7265 7373  sizes of regress
-0003d900: 6f72 7320 6966 2077 726f 6e67 3a0a 2020  ors if wrong:.  
-0003d910: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-0003d920: 662e 582e 7368 6170 6529 203d 3d20 323a  f.X.shape) == 2:
-0003d930: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0003d940: 7365 6c66 2e58 2e73 6861 7065 5b31 5d20  self.X.shape[1] 
-0003d950: 213d 2031 3a0a 2020 2020 2020 2020 2020  != 1:.          
-0003d960: 2020 2020 2020 7365 6c66 2e6e 5820 3d20        self.nX = 
-0003d970: 7365 6c66 2e58 2e73 6861 7065 5b31 5d0a  self.X.shape[1].
-0003d980: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0003d990: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003d9a0: 2020 7365 6c66 2e58 203d 2073 656c 662e    self.X = self.
-0003d9b0: 585b 3a2c 2030 5d0a 2020 2020 2020 2020  X[:, 0].        
-0003d9c0: 2020 2020 2020 2020 7365 6c66 2e6e 5820          self.nX 
-0003d9d0: 3d20 310a 2020 2020 2020 2020 656c 7365  = 1.        else
-0003d9e0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0003d9f0: 6c66 2e6e 5820 3d20 310a 0a20 2020 2020  lf.nX = 1..     
-0003da00: 2020 2023 2044 6566 696e 6520 616c 6c20     # Define all 
-0003da10: 706f 7373 6962 6c65 206b 6572 6e65 6c73  possible kernels
-0003da20: 2061 7661 696c 6162 6c65 2062 7920 7468   available by th
-0003da30: 6520 6f62 6a65 6374 3a0a 2020 2020 2020  e object:.      
-0003da40: 2020 7365 6c66 2e61 6c6c 5f6b 6572 6e65    self.all_kerne
-0003da50: 6c5f 7661 7269 6162 6c65 7320 3d20 7b7d  l_variables = {}
-0003da60: 0a20 2020 2020 2020 2073 656c 662e 616c  .        self.al
-0003da70: 6c5f 6b65 726e 656c 5f76 6172 6961 626c  l_kernel_variabl
-0003da80: 6573 5b27 5345 4b65 726e 656c 275d 203d  es['SEKernel'] =
-0003da90: 205b 2773 6967 6d61 275d 0a20 2020 2020   ['sigma'].     
-0003daa0: 2020 2073 656c 662e 616c 6c5f 6b65 726e     self.all_kern
-0003dab0: 656c 5f76 6172 6961 626c 6573 5b27 4d33  el_variables['M3
-0003dac0: 324b 6572 6e65 6c27 5d20 3d20 5b27 7369  2Kernel'] = ['si
-0003dad0: 676d 6127 5d0a 2020 2020 2020 2020 666f  gma'].        fo
-0003dae0: 7220 6920 696e 2072 616e 6765 2873 656c  r i in range(sel
-0003daf0: 662e 6e58 293a 0a20 2020 2020 2020 2020  f.nX):.         
-0003db00: 2020 2073 656c 662e 616c 6c5f 6b65 726e     self.all_kern
-0003db10: 656c 5f76 6172 6961 626c 6573 5b27 5345  el_variables['SE
-0003db20: 4b65 726e 656c 275d 203d 2073 656c 662e  Kernel'] = self.
-0003db30: 616c 6c5f 6b65 726e 656c 5f76 6172 6961  all_kernel_varia
-0003db40: 626c 6573 5b0a 2020 2020 2020 2020 2020  bles[.          
-0003db50: 2020 2020 2020 2753 454b 6572 6e65 6c27        'SEKernel'
-0003db60: 5d20 2b20 5b27 616c 7068 6127 202b 2073  ] + ['alpha' + s
-0003db70: 7472 2869 295d 0a20 2020 2020 2020 2020  tr(i)].         
-0003db80: 2020 2073 656c 662e 616c 6c5f 6b65 726e     self.all_kern
-0003db90: 656c 5f76 6172 6961 626c 6573 5b27 4d33  el_variables['M3
-0003dba0: 324b 6572 6e65 6c27 5d20 3d20 7365 6c66  2Kernel'] = self
-0003dbb0: 2e61 6c6c 5f6b 6572 6e65 6c5f 7661 7269  .all_kernel_vari
-0003dbc0: 6162 6c65 735b 0a20 2020 2020 2020 2020  ables[.         
-0003dbd0: 2020 2020 2020 2027 4d33 324b 6572 6e65         'M32Kerne
-0003dbe0: 6c27 5d20 2b20 5b27 6d61 6c70 6861 2720  l'] + ['malpha' 
-0003dbf0: 2b20 7374 7228 6929 5d0a 2020 2020 2020  + str(i)].      
-0003dc00: 2020 7365 6c66 2e61 6c6c 5f6b 6572 6e65    self.all_kerne
-0003dc10: 6c5f 7661 7269 6162 6c65 735b 2745 7870  l_variables['Exp
-0003dc20: 5369 6e65 5371 7561 7265 6453 454b 6572  SineSquaredSEKer
-0003dc30: 6e65 6c27 5d20 3d20 5b0a 2020 2020 2020  nel'] = [.      
-0003dc40: 2020 2020 2020 2773 6967 6d61 272c 2027        'sigma', '
-0003dc50: 616c 7068 6127 2c20 2747 616d 6d61 272c  alpha', 'Gamma',
-0003dc60: 2027 5072 6f74 270a 2020 2020 2020 2020   'Prot'.        
-0003dc70: 5d0a 2020 2020 2020 2020 7365 6c66 2e61  ].        self.a
-0003dc80: 6c6c 5f6b 6572 6e65 6c5f 7661 7269 6162  ll_kernel_variab
-0003dc90: 6c65 735b 2743 656c 6572 6974 6551 504b  les['CeleriteQPK
-0003dca0: 6572 6e65 6c27 5d20 3d20 5b27 4227 2c20  ernel'] = ['B', 
-0003dcb0: 274c 272c 2027 5072 6f74 272c 2027 4327  'L', 'Prot', 'C'
-0003dcc0: 5d0a 2020 2020 2020 2020 7365 6c66 2e61  ].        self.a
-0003dcd0: 6c6c 5f6b 6572 6e65 6c5f 7661 7269 6162  ll_kernel_variab
-0003dce0: 6c65 735b 2743 656c 6572 6974 6545 7870  les['CeleriteExp
-0003dcf0: 4b65 726e 656c 275d 203d 205b 2773 6967  Kernel'] = ['sig
-0003dd00: 6d61 272c 2027 7469 6d65 7363 616c 6527  ma', 'timescale'
-0003dd10: 5d0a 2020 2020 2020 2020 7365 6c66 2e61  ].        self.a
-0003dd20: 6c6c 5f6b 6572 6e65 6c5f 7661 7269 6162  ll_kernel_variab
-0003dd30: 6c65 735b 2743 656c 6572 6974 654d 6174  les['CeleriteMat
-0003dd40: 6572 6e4b 6572 6e65 6c27 5d20 3d20 5b27  ernKernel'] = ['
-0003dd50: 7369 676d 6127 2c20 2772 686f 275d 0a20  sigma', 'rho']. 
-0003dd60: 2020 2020 2020 2073 656c 662e 616c 6c5f         self.all_
-0003dd70: 6b65 726e 656c 5f76 6172 6961 626c 6573  kernel_variables
-0003dd80: 5b27 4365 6c65 7269 7465 4d61 7465 726e  ['CeleriteMatern
-0003dd90: 4578 704b 6572 6e65 6c27 5d20 3d20 5b0a  ExpKernel'] = [.
-0003dda0: 2020 2020 2020 2020 2020 2020 2773 6967              'sig
-0003ddb0: 6d61 272c 2027 7469 6d65 7363 616c 6527  ma', 'timescale'
-0003ddc0: 2c20 2772 686f 270a 2020 2020 2020 2020  , 'rho'.        
-0003ddd0: 5d0a 2020 2020 2020 2020 7365 6c66 2e61  ].        self.a
-0003dde0: 6c6c 5f6b 6572 6e65 6c5f 7661 7269 6162  ll_kernel_variab
-0003ddf0: 6c65 735b 2743 656c 6572 6974 6553 484f  les['CeleriteSHO
-0003de00: 4b65 726e 656c 275d 203d 205b 2753 3027  Kernel'] = ['S0'
-0003de10: 2c20 2751 272c 2027 6f6d 6567 6130 275d  , 'Q', 'omega0']
-0003de20: 0a20 2020 2020 2020 2073 656c 662e 616c  .        self.al
-0003de30: 6c5f 6b65 726e 656c 5f76 6172 6961 626c  l_kernel_variabl
-0003de40: 6573 5b27 4365 6c65 7269 7465 446f 7562  es['CeleriteDoub
-0003de50: 6c65 5348 4f4b 6572 6e65 6c27 5d20 3d20  leSHOKernel'] = 
-0003de60: 5b0a 2020 2020 2020 2020 2020 2020 2773  [.            's
-0003de70: 6967 6d61 272c 2027 5130 272c 2027 7065  igma', 'Q0', 'pe
-0003de80: 7269 6f64 272c 2027 6627 2c20 2764 5127  riod', 'f', 'dQ'
-0003de90: 0a20 2020 2020 2020 205d 0a20 2020 2020  .        ].     
-0003dea0: 2020 2023 2046 6f72 204d 6174 6572 6e2b     # For Matern+
-0003deb0: 5348 4f20 6b65 726e 656c 0a20 2020 2020  SHO kernel.     
-0003dec0: 2020 2073 656c 662e 616c 6c5f 6b65 726e     self.all_kern
-0003ded0: 656c 5f76 6172 6961 626c 6573 5b27 4365  el_variables['Ce
-0003dee0: 6c65 7269 7465 4d61 7465 726e 5348 4f4b  leriteMaternSHOK
-0003def0: 6572 6e65 6c27 5d20 3d20 5b27 7369 676d  ernel'] = ['sigm
-0003df00: 6127 2c20 2772 686f 272c 2027 5330 272c  a', 'rho', 'S0',
-0003df10: 2027 5127 2c20 276f 6d65 6761 3027 5d0a   'Q', 'omega0'].
-0003df20: 0a20 2020 2020 2020 2023 2046 696e 6420  .        # Find 
-0003df30: 6b65 726e 656c 206e 616d 6520 2861 6e64  kernel name (and
-0003df40: 2073 6176 6520 6974 2074 6f20 7365 6c66   save it to self
-0003df50: 2e6b 6572 6e65 6c5f 6e61 6d65 293a 0a20  .kernel_name):. 
-0003df60: 2020 2020 2020 2073 656c 662e 6b65 726e         self.kern
-0003df70: 656c 5f6e 616d 6520 3d20 7365 6c66 2e67  el_name = self.g
-0003df80: 6574 5f6b 6572 6e65 6c5f 6e61 6d65 2864  et_kernel_name(d
-0003df90: 6174 612e 7072 696f 7273 290a 2020 2020  ata.priors).    
-0003dfa0: 2020 2020 2320 496e 6974 6961 6c69 7a65      # Initialize
-0003dfb0: 2076 6172 6961 626c 6520 666f 7220 7468   variable for th
-0003dfc0: 6520 4750 206f 626a 6563 743a 0a20 2020  e GP object:.   
-0003dfd0: 2020 2020 2073 656c 662e 4750 203d 204e       self.GP = N
-0003dfe0: 6f6e 650a 2020 2020 2020 2020 2320 4172  one.        # Ar
-0003dff0: 6520 7765 2075 7369 6e67 2063 656c 6572  e we using celer
-0003e000: 6974 653f 0a20 2020 2020 2020 2073 656c  ite?.        sel
-0003e010: 662e 7573 655f 6365 6c65 7269 7465 203d  f.use_celerite =
-0003e020: 2046 616c 7365 0a20 2020 2020 2020 2023   False.        #
-0003e030: 2041 7265 2077 6520 7573 696e 6720 6765   Are we using ge
-0003e040: 6f72 6765 5f68 6f64 6c72 3f0a 2020 2020  orge_hodlr?.    
-0003e050: 2020 2020 6966 2067 656f 7267 655f 686f      if george_ho
-0003e060: 646c 723a 0a20 2020 2020 2020 2020 2020  dlr:.           
-0003e070: 2073 656c 662e 6765 6f72 6765 5f68 6f64   self.george_hod
-0003e080: 6c72 203d 2054 7275 650a 2020 2020 2020  lr = True.      
-0003e090: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0003e0a0: 2020 2020 7365 6c66 2e67 656f 7267 655f      self.george_
-0003e0b0: 686f 646c 7220 3d20 4661 6c73 650a 2020  hodlr = False.  
-0003e0c0: 2020 2020 2020 2320 496e 6974 6961 6c69        # Initiali
-0003e0d0: 7a65 2076 6172 6961 626c 6520 7468 6174  ze variable that
-0003e0e0: 2073 6574 7320 7468 6520 2269 6e73 7472   sets the "instr
-0003e0f0: 756d 656e 7422 206e 616d 6520 666f 7220  ument" name for 
-0003e100: 6561 6368 2076 6172 6961 626c 6520 2873  each variable (s
-0003e110: 656c 662e 7661 7269 6162 6c65 7320 6265  elf.variables be
-0003e120: 6c6f 7729 2e20 4966 2c20 666f 7220 6578  low). If, for ex
-0003e130: 616d 706c 652c 0a20 2020 2020 2020 2023  ample,.        #
-0003e140: 2047 505f 5072 6f74 5f54 4553 535f 4b32   GP_Prot_TESS_K2
-0003e150: 5f52 5620 616e 6420 4750 5f47 616d 6d61  _RV and GP_Gamma
-0003e160: 5f54 4553 532c 2061 6e64 2073 656c 662e  _TESS, and self.
-0003e170: 7661 7269 6162 6c65 7320 3d20 5b50 726f  variables = [Pro
-0003e180: 742c 4761 6d6d 615d 2c20 7468 656e 2073  t,Gamma], then s
-0003e190: 656c 662e 696e 7374 7275 6d65 6e74 5f76  elf.instrument_v
-0003e1a0: 6172 6961 626c 6573 203d 205b 2754 4553  ariables = ['TES
-0003e1b0: 535f 4b32 5f52 5627 2c27 5445 5353 275d  S_K2_RV','TESS']
-0003e1c0: 2e0a 2020 2020 2020 2020 7365 6c66 2e69  ..        self.i
-0003e1d0: 6e70 7574 5f69 6e73 7472 756d 656e 7420  nput_instrument 
-0003e1e0: 3d20 5b5d 0a0a 2020 2020 2020 2020 2320  = []..        # 
-0003e1f0: 496e 6974 6961 6c69 7a65 2065 6163 6820  Initialize each 
-0003e200: 6b65 726e 656c 206f 6e20 7468 6520 4750  kernel on the GP
-0003e210: 206f 626a 6563 742e 2046 6972 7374 2c20   object. First, 
-0003e220: 7365 7420 7468 6520 7661 7269 6162 6c65  set the variable
-0003e230: 7320 746f 2074 6865 206f 6e65 7320 6465  s to the ones de
-0003e240: 6669 6e65 6420 6162 6f76 652e 2054 6865  fined above. The
-0003e250: 6e20 696e 6974 6961 6c69 7a65 2074 6865  n initialize the
-0003e260: 0a20 2020 2020 2020 2023 2061 6374 7561  .        # actua
-0003e270: 6c20 6b65 726e 656c 3a0a 2020 2020 2020  l kernel:.      
-0003e280: 2020 7365 6c66 2e76 6172 6961 626c 6573    self.variables
-0003e290: 203d 2073 656c 662e 616c 6c5f 6b65 726e   = self.all_kern
-0003e2a0: 656c 5f76 6172 6961 626c 6573 5b73 656c  el_variables[sel
-0003e2b0: 662e 6b65 726e 656c 5f6e 616d 655d 0a20  f.kernel_name]. 
-0003e2c0: 2020 2020 2020 2070 6861 6e74 6f6d 7661         phantomva
-0003e2d0: 7269 6162 6c65 203d 2030 0a20 2020 2020  riable = 0.     
-0003e2e0: 2020 2069 6620 7365 6c66 2e6b 6572 6e65     if self.kerne
-0003e2f0: 6c5f 6e61 6d65 203d 3d20 2753 454b 6572  l_name == 'SEKer
-0003e300: 6e65 6c27 3a0a 2020 2020 2020 2020 2020  nel':.          
-0003e310: 2020 2320 4765 6e65 7261 7465 2047 5045    # Generate GPE
-0003e320: 7870 5371 7561 7265 6420 6261 7365 206b  xpSquared base k
-0003e330: 6572 6e65 6c3a 0a20 2020 2020 2020 2020  ernel:.         
-0003e340: 2020 2073 656c 662e 6b65 726e 656c 203d     self.kernel =
-0003e350: 2031 2e20 2a20 6765 6f72 6765 2e6b 6572   1. * george.ker
-0003e360: 6e65 6c73 2e45 7870 5371 7561 7265 644b  nels.ExpSquaredK
-0003e370: 6572 6e65 6c28 0a20 2020 2020 2020 2020  ernel(.         
-0003e380: 2020 2020 2020 206e 702e 6f6e 6573 2873         np.ones(s
-0003e390: 656c 662e 6e58 292c 206e 6469 6d3d 7365  elf.nX), ndim=se
-0003e3a0: 6c66 2e6e 582c 2061 7865 733d 7261 6e67  lf.nX, axes=rang
-0003e3b0: 6528 7365 6c66 2e6e 5829 290a 2020 2020  e(self.nX)).    
-0003e3c0: 2020 2020 2020 2020 2320 284e 6f74 6520          # (Note 
-0003e3d0: 6e6f 206a 6974 7465 7220 6b65 726e 656c  no jitter kernel
-0003e3e0: 2069 7320 6769 7665 6e2c 2061 7320 7769   is given, as wi
-0003e3f0: 7468 2067 656f 7267 6520 6f6e 6520 6465  th george one de
-0003e400: 6669 6e65 7320 7468 6973 2069 6e20 7468  fines this in th
-0003e410: 6520 6765 6f72 6765 2e47 5020 6361 6c6c  e george.GP call
-0003e420: 293a 0a20 2020 2020 2020 2065 6c69 6620  ):.        elif 
-0003e430: 7365 6c66 2e6b 6572 6e65 6c5f 6e61 6d65  self.kernel_name
-0003e440: 203d 3d20 274d 3332 4b65 726e 656c 273a   == 'M32Kernel':
-0003e450: 0a20 2020 2020 2020 2020 2020 2023 2047  .            # G
-0003e460: 656e 6572 6174 6520 4750 4d61 7465 726e  enerate GPMatern
-0003e470: 3332 2062 6173 6520 6b65 726e 656c 3a0a  32 base kernel:.
-0003e480: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003e490: 2e6b 6572 6e65 6c20 3d20 312e 202a 2067  .kernel = 1. * g
-0003e4a0: 656f 7267 652e 6b65 726e 656c 732e 4d61  eorge.kernels.Ma
-0003e4b0: 7465 726e 3332 4b65 726e 656c 280a 2020  tern32Kernel(.  
-0003e4c0: 2020 2020 2020 2020 2020 2020 2020 6e70                np
-0003e4d0: 2e6f 6e65 7328 7365 6c66 2e6e 5829 2c20  .ones(self.nX), 
-0003e4e0: 6e64 696d 3d73 656c 662e 6e58 2c20 6178  ndim=self.nX, ax
-0003e4f0: 6573 3d72 616e 6765 2873 656c 662e 6e58  es=range(self.nX
-0003e500: 2929 0a20 2020 2020 2020 2020 2020 2023  )).            #
-0003e510: 2028 4e6f 7465 206e 6f20 6a69 7474 6572   (Note no jitter
-0003e520: 206b 6572 6e65 6c20 6973 2067 6976 656e   kernel is given
-0003e530: 2c20 6173 2077 6974 6820 6765 6f72 6765  , as with george
-0003e540: 206f 6e65 2064 6566 696e 6573 2074 6869   one defines thi
-0003e550: 7320 696e 2074 6865 2067 656f 7267 652e  s in the george.
-0003e560: 4750 2063 616c 6c29 3a0a 2020 2020 2020  GP call):.      
-0003e570: 2020 656c 6966 2073 656c 662e 6b65 726e    elif self.kern
-0003e580: 656c 5f6e 616d 6520 3d3d 2027 4578 7053  el_name == 'ExpS
-0003e590: 696e 6553 7175 6172 6564 5345 4b65 726e  ineSquaredSEKern
-0003e5a0: 656c 273a 0a20 2020 2020 2020 2020 2020  el':.           
-0003e5b0: 2023 2047 656e 6572 6174 6520 7468 6520   # Generate the 
-0003e5c0: 6b65 726e 656c 733a 0a20 2020 2020 2020  kernels:.       
-0003e5d0: 2020 2020 204b 3120 3d20 312e 202a 2067       K1 = 1. * g
-0003e5e0: 656f 7267 652e 6b65 726e 656c 732e 4578  eorge.kernels.Ex
-0003e5f0: 7053 7175 6172 6564 4b65 726e 656c 286d  pSquaredKernel(m
-0003e600: 6574 7269 633d 312e 3029 0a20 2020 2020  etric=1.0).     
-0003e610: 2020 2020 2020 204b 3220 3d20 6765 6f72         K2 = geor
-0003e620: 6765 2e6b 6572 6e65 6c73 2e45 7870 5369  ge.kernels.ExpSi
-0003e630: 6e65 324b 6572 6e65 6c28 6761 6d6d 613d  ne2Kernel(gamma=
-0003e640: 312e 302c 206c 6f67 5f70 6572 696f 643d  1.0, log_period=
-0003e650: 312e 3029 0a20 2020 2020 2020 2020 2020  1.0).           
-0003e660: 2073 656c 662e 6b65 726e 656c 203d 204b   self.kernel = K
-0003e670: 3120 2a20 4b32 0a20 2020 2020 2020 2020  1 * K2.         
-0003e680: 2020 2023 2028 4e6f 7465 206e 6f20 6a69     # (Note no ji
-0003e690: 7474 6572 206b 6572 6e65 6c20 6973 2067  tter kernel is g
-0003e6a0: 6976 656e 2c20 6173 2077 6974 6820 6765  iven, as with ge
-0003e6b0: 6f72 6765 206f 6e65 2064 6566 696e 6573  orge one defines
-0003e6c0: 2074 6869 7320 696e 2074 6865 2067 656f   this in the geo
-0003e6d0: 7267 652e 4750 2063 616c 6c29 3a0a 2020  rge.GP call):.  
-0003e6e0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0003e6f0: 6b65 726e 656c 5f6e 616d 6520 3d3d 2027  kernel_name == '
-0003e700: 4365 6c65 7269 7465 5150 4b65 726e 656c  CeleriteQPKernel
-0003e710: 273a 0a20 2020 2020 2020 2020 2020 2023  ':.            #
-0003e720: 2047 656e 6572 6174 6520 726f 7461 7469   Generate rotati
-0003e730: 6f6e 616c 206b 6572 6e65 6c3a 0a20 2020  onal kernel:.   
-0003e740: 2020 2020 2020 2020 2072 6f74 5f6b 6572           rot_ker
-0003e750: 6e65 6c20 3d20 7465 726d 732e 5465 726d  nel = terms.Term
-0003e760: 5375 6d28 526f 7461 7469 6f6e 5465 726d  Sum(RotationTerm
-0003e770: 286c 6f67 5f61 6d70 3d6e 702e 6c6f 6728  (log_amp=np.log(
-0003e780: 3130 2e29 2c5c 0a20 2020 2020 2020 2020  10.),\.         
-0003e790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e7b0: 2020 2020 2020 2020 2020 206c 6f67 5f74             log_t
-0003e7c0: 696d 6573 6361 6c65 3d6e 702e 6c6f 6728  imescale=np.log(
-0003e7d0: 3130 2e30 292c 5c0a 2020 2020 2020 2020  10.0),\.        
-0003e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e800: 2020 2020 2020 2020 2020 2020 6c6f 675f              log_
-0003e810: 7065 7269 6f64 3d6e 702e 6c6f 6728 332e  period=np.log(3.
-0003e820: 3029 2c5c 0a20 2020 2020 2020 2020 2020  0),\.           
-0003e830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e850: 2020 2020 2020 2020 206c 6f67 5f66 6163           log_fac
-0003e860: 746f 723d 6e70 2e6c 6f67 2831 2e30 2929  tor=np.log(1.0))
-0003e870: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-0003e880: 4a69 7474 6572 2074 6572 6d3a 0a20 2020  Jitter term:.   
-0003e890: 2020 2020 2020 2020 206b 6572 6e65 6c5f           kernel_
-0003e8a0: 6a69 7474 6572 203d 2074 6572 6d73 2e4a  jitter = terms.J
-0003e8b0: 6974 7465 7254 6572 6d28 6e70 2e6c 6f67  itterTerm(np.log
-0003e8c0: 2831 3030 202a 2031 652d 3629 290a 2020  (100 * 1e-6)).  
-0003e8d0: 2020 2020 2020 2020 2020 2320 5772 6170            # Wrap
-0003e8e0: 2047 5020 6b65 726e 656c 2061 6e64 206f   GP kernel and o
-0003e8f0: 626a 6563 743a 0a0a 2020 2020 2020 2020  bject:..        
-0003e900: 2020 2020 6966 2073 656c 662e 696e 7374      if self.inst
-0003e910: 7275 6d65 6e74 2069 6e20 5b27 7276 272c  rument in ['rv',
-0003e920: 2027 6c63 275d 3a0a 0a20 2020 2020 2020   'lc']:..       
-0003e930: 2020 2020 2020 2020 2073 656c 662e 6b65           self.ke
-0003e940: 726e 656c 203d 2072 6f74 5f6b 6572 6e65  rnel = rot_kerne
-0003e950: 6c0a 2020 2020 2020 2020 2020 2020 656c  l.            el
-0003e960: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0003e970: 2020 2020 7365 6c66 2e6b 6572 6e65 6c20      self.kernel 
-0003e980: 3d20 726f 745f 6b65 726e 656c 202b 206b  = rot_kernel + k
-0003e990: 6572 6e65 6c5f 6a69 7474 6572 0a20 2020  ernel_jitter.   
-0003e9a0: 2020 2020 2020 2020 2023 2057 6520 6172           # We ar
-0003e9b0: 6520 7573 696e 6720 6365 6c65 7269 7465  e using celerite
-0003e9c0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0003e9d0: 6c66 2e75 7365 5f63 656c 6572 6974 6520  lf.use_celerite 
-0003e9e0: 3d20 5472 7565 0a20 2020 2020 2020 2065  = True.        e
-0003e9f0: 6c69 6620 7365 6c66 2e6b 6572 6e65 6c5f  lif self.kernel_
-0003ea00: 6e61 6d65 203d 3d20 2743 656c 6572 6974  name == 'Celerit
-0003ea10: 6545 7870 4b65 726e 656c 273a 0a20 2020  eExpKernel':.   
-0003ea20: 2020 2020 2020 2020 2023 2047 656e 6572           # Gener
-0003ea30: 6174 6520 6578 706f 6e65 6e74 6961 6c20  ate exponential 
-0003ea40: 6b65 726e 656c 3a0a 2020 2020 2020 2020  kernel:.        
-0003ea50: 2020 2020 6578 705f 6b65 726e 656c 203d      exp_kernel =
-0003ea60: 2074 6572 6d73 2e52 6561 6c54 6572 6d28   terms.RealTerm(
-0003ea70: 6c6f 675f 613d 6e70 2e6c 6f67 2831 302e  log_a=np.log(10.
-0003ea80: 292c 206c 6f67 5f63 3d6e 702e 6c6f 6728  ), log_c=np.log(
-0003ea90: 3130 2e29 290a 2020 2020 2020 2020 2020  10.)).          
-0003eaa0: 2020 2320 4a69 7474 6572 2074 6572 6d3a    # Jitter term:
-0003eab0: 0a20 2020 2020 2020 2020 2020 206b 6572  .            ker
-0003eac0: 6e65 6c5f 6a69 7474 6572 203d 2074 6572  nel_jitter = ter
-0003ead0: 6d73 2e4a 6974 7465 7254 6572 6d28 6e70  ms.JitterTerm(np
-0003eae0: 2e6c 6f67 2831 3030 202a 2031 652d 3629  .log(100 * 1e-6)
-0003eaf0: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-0003eb00: 5772 6170 2047 5020 6b65 726e 656c 2061  Wrap GP kernel a
-0003eb10: 6e64 206f 626a 6563 743a 0a20 2020 2020  nd object:.     
-0003eb20: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
-0003eb30: 6e73 7472 756d 656e 7420 696e 205b 2772  nstrument in ['r
-0003eb40: 7627 2c20 276c 6327 5d3a 0a20 2020 2020  v', 'lc']:.     
-0003eb50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003eb60: 6b65 726e 656c 203d 2065 7870 5f6b 6572  kernel = exp_ker
-0003eb70: 6e65 6c0a 2020 2020 2020 2020 2020 2020  nel.            
-0003eb80: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0003eb90: 2020 2020 2020 7365 6c66 2e6b 6572 6e65        self.kerne
-0003eba0: 6c20 3d20 6578 705f 6b65 726e 656c 202b  l = exp_kernel +
-0003ebb0: 206b 6572 6e65 6c5f 6a69 7474 6572 0a20   kernel_jitter. 
-0003ebc0: 2020 2020 2020 2020 2020 2023 2057 6520             # We 
-0003ebd0: 6172 6520 7573 696e 6720 6365 6c65 7269  are using celeri
-0003ebe0: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
-0003ebf0: 7365 6c66 2e75 7365 5f63 656c 6572 6974  self.use_celerit
-0003ec00: 6520 3d20 5472 7565 0a20 2020 2020 2020  e = True.       
-0003ec10: 2065 6c69 6620 7365 6c66 2e6b 6572 6e65   elif self.kerne
-0003ec20: 6c5f 6e61 6d65 203d 3d20 2743 656c 6572  l_name == 'Celer
-0003ec30: 6974 654d 6174 6572 6e4b 6572 6e65 6c27  iteMaternKernel'
-0003ec40: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0003ec50: 4765 6e65 7261 7465 206d 6174 6572 6e20  Generate matern 
-0003ec60: 6b65 726e 656c 3a0a 2020 2020 2020 2020  kernel:.        
-0003ec70: 2020 2020 6d61 7465 726e 5f6b 6572 6e65      matern_kerne
-0003ec80: 6c20 3d20 7465 726d 732e 4d61 7465 726e  l = terms.Matern
-0003ec90: 3332 5465 726d 286c 6f67 5f73 6967 6d61  32Term(log_sigma
-0003eca0: 3d6e 702e 6c6f 6728 3130 2e29 2c0a 2020  =np.log(10.),.  
-0003ecb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ecc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ecd0: 2020 2020 2020 2020 2020 2020 206c 6f67               log
-0003ece0: 5f72 686f 3d6e 702e 6c6f 6728 3130 2e29  _rho=np.log(10.)
-0003ecf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ed10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ed20: 2065 7073 3d6d 6174 6572 6e5f 6570 7329   eps=matern_eps)
-0003ed30: 0a20 2020 2020 2020 2020 2020 2023 204a  .            # J
-0003ed40: 6974 7465 7220 7465 726d 3a0a 2020 2020  itter term:.    
-0003ed50: 2020 2020 2020 2020 6b65 726e 656c 5f6a          kernel_j
-0003ed60: 6974 7465 7220 3d20 7465 726d 732e 4a69  itter = terms.Ji
-0003ed70: 7474 6572 5465 726d 286e 702e 6c6f 6728  tterTerm(np.log(
-0003ed80: 3130 3020 2a20 3165 2d36 2929 0a20 2020  100 * 1e-6)).   
-0003ed90: 2020 2020 2020 2020 2023 2057 7261 7020           # Wrap 
-0003eda0: 4750 206b 6572 6e65 6c20 616e 6420 6f62  GP kernel and ob
-0003edb0: 6a65 6374 3a0a 2020 2020 2020 2020 2020  ject:.          
-0003edc0: 2020 6966 2073 656c 662e 696e 7374 7275    if self.instru
-0003edd0: 6d65 6e74 2069 6e20 5b27 7276 272c 2027  ment in ['rv', '
-0003ede0: 6c63 275d 3a0a 2020 2020 2020 2020 2020  lc']:.          
-0003edf0: 2020 2020 2020 7365 6c66 2e6b 6572 6e65        self.kerne
-0003ee00: 6c20 3d20 6d61 7465 726e 5f6b 6572 6e65  l = matern_kerne
-0003ee10: 6c0a 2020 2020 2020 2020 2020 2020 656c  l.            el
-0003ee20: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0003ee30: 2020 2020 7365 6c66 2e6b 6572 6e65 6c20      self.kernel 
-0003ee40: 3d20 6d61 7465 726e 5f6b 6572 6e65 6c20  = matern_kernel 
-0003ee50: 2b20 6b65 726e 656c 5f6a 6974 7465 720a  + kernel_jitter.
-0003ee60: 2020 2020 2020 2020 2020 2020 2320 5765              # We
-0003ee70: 2061 7265 2075 7369 6e67 2063 656c 6572   are using celer
-0003ee80: 6974 653a 0a20 2020 2020 2020 2020 2020  ite:.           
-0003ee90: 2073 656c 662e 7573 655f 6365 6c65 7269   self.use_celeri
-0003eea0: 7465 203d 2054 7275 650a 2020 2020 2020  te = True.      
-0003eeb0: 2020 656c 6966 2073 656c 662e 6b65 726e    elif self.kern
-0003eec0: 656c 5f6e 616d 6520 3d3d 2027 4365 6c65  el_name == 'Cele
-0003eed0: 7269 7465 4d61 7465 726e 4578 704b 6572  riteMaternExpKer
-0003eee0: 6e65 6c27 3a0a 2020 2020 2020 2020 2020  nel':.          
-0003eef0: 2020 2320 4765 6e65 7261 7465 206d 6174    # Generate mat
-0003ef00: 6572 6e20 616e 6420 6578 706f 6e65 6e74  ern and exponent
-0003ef10: 6961 6c20 6b65 726e 656c 733a 0a20 2020  ial kernels:.   
-0003ef20: 2020 2020 2020 2020 206d 6174 6572 6e5f           matern_
-0003ef30: 6b65 726e 656c 203d 2074 6572 6d73 2e4d  kernel = terms.M
-0003ef40: 6174 6572 6e33 3254 6572 6d28 6c6f 675f  atern32Term(log_
-0003ef50: 7369 676d 613d 6e70 2e6c 6f67 2831 302e  sigma=np.log(10.
-0003ef60: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0003ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ef80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ef90: 2020 6c6f 675f 7268 6f3d 6e70 2e6c 6f67    log_rho=np.log
-0003efa0: 2831 302e 292c 0a20 2020 2020 2020 2020  (10.),.         
-0003efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003efc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003efd0: 2020 2020 2020 6570 733d 6d61 7465 726e        eps=matern
-0003efe0: 5f65 7073 290a 2020 2020 2020 2020 2020  _eps).          
-0003eff0: 2020 6578 705f 6b65 726e 656c 203d 2074    exp_kernel = t
-0003f000: 6572 6d73 2e52 6561 6c54 6572 6d28 6c6f  erms.RealTerm(lo
-0003f010: 675f 613d 6e70 2e6c 6f67 2831 302e 292c  g_a=np.log(10.),
-0003f020: 206c 6f67 5f63 3d6e 702e 6c6f 6728 3130   log_c=np.log(10
-0003f030: 2e29 290a 2020 2020 2020 2020 2020 2020  .)).            
-0003f040: 2320 4a69 7474 6572 2074 6572 6d3a 0a20  # Jitter term:. 
-0003f050: 2020 2020 2020 2020 2020 206b 6572 6e65             kerne
-0003f060: 6c5f 6a69 7474 6572 203d 2074 6572 6d73  l_jitter = terms
-0003f070: 2e4a 6974 7465 7254 6572 6d28 6e70 2e6c  .JitterTerm(np.l
-0003f080: 6f67 2831 3030 202a 2031 652d 3629 290a  og(100 * 1e-6)).
-0003f090: 2020 2020 2020 2020 2020 2020 2320 5772              # Wr
-0003f0a0: 6170 2047 5020 6b65 726e 656c 2061 6e64  ap GP kernel and
-0003f0b0: 206f 626a 6563 743a 0a20 2020 2020 2020   object:.       
-0003f0c0: 2020 2020 2069 6620 7365 6c66 2e69 6e73       if self.ins
-0003f0d0: 7472 756d 656e 7420 696e 205b 2772 7627  trument in ['rv'
-0003f0e0: 2c20 276c 6327 5d3a 0a20 2020 2020 2020  , 'lc']:.       
-0003f0f0: 2020 2020 2020 2020 2073 656c 662e 6b65           self.ke
-0003f100: 726e 656c 203d 2065 7870 5f6b 6572 6e65  rnel = exp_kerne
-0003f110: 6c20 2a20 6d61 7465 726e 5f6b 6572 6e65  l * matern_kerne
-0003f120: 6c0a 2020 2020 2020 2020 2020 2020 656c  l.            el
-0003f130: 7365 3a0a 0a20 2020 2020 2020 2020 2020  se:..           
-0003f140: 2020 2020 2073 656c 662e 6b65 726e 656c       self.kernel
-0003f150: 203d 2065 7870 5f6b 6572 6e65 6c20 2a20   = exp_kernel * 
-0003f160: 6d61 7465 726e 5f6b 6572 6e65 6c20 2b20  matern_kernel + 
-0003f170: 6b65 726e 656c 5f6a 6974 7465 720a 0a20  kernel_jitter.. 
-0003f180: 2020 2020 2020 2020 2020 2023 2057 6520             # We 
-0003f190: 6164 6420 6120 7068 616e 746f 6d20 7661  add a phantom va
-0003f1a0: 7269 6162 6c65 2062 6563 6175 7365 2077  riable because w
-0003f1b0: 6520 7761 6e74 2074 6f20 6c65 6176 6520  e want to leave 
-0003f1c0: 696e 6465 7820 3220 7769 7468 6f75 7420  index 2 without 
-0003f1d0: 7661 6c75 6520 4f4e 2050 5552 504f 5345  value ON PURPOSE
-0003f1e0: 3a20 7468 6520 6964 6561 2069 730a 2020  : the idea is.  
-0003f1f0: 2020 2020 2020 2020 2020 2320 7468 6174            # that
-0003f200: 2068 6572 652c 2074 6861 7420 6973 2061   here, that is a
-0003f210: 6c77 6179 7320 3020 2862 6563 6175 7365  lways 0 (because
-0003f220: 2074 6869 7320 6465 6669 6e65 7320 7468   this defines th
-0003f230: 6520 6c6f 6728 7369 676d 6129 206f 6620  e log(sigma) of 
-0003f240: 7468 6520 6d61 7465 726e 206b 6572 6e65  the matern kerne
-0003f250: 6c20 696e 2074 6865 0a20 2020 2020 2020  l in the.       
-0003f260: 2020 2020 2023 206d 756c 7469 706c 6963       # multiplic
-0003f270: 6174 696f 6e2c 2077 6869 6368 2077 6520  ation, which we 
-0003f280: 7365 7420 746f 2031 292e 0a20 2020 2020  set to 1)..     
-0003f290: 2020 2020 2020 2070 6861 6e74 6f6d 7661         phantomva
-0003f2a0: 7269 6162 6c65 203d 2031 0a20 2020 2020  riable = 1.     
-0003f2b0: 2020 2020 2020 2023 2057 6520 6172 6520         # We are 
-0003f2c0: 7573 696e 6720 6365 6c65 7269 7465 3a0a  using celerite:.
-0003f2d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003f2e0: 2e75 7365 5f63 656c 6572 6974 6520 3d20  .use_celerite = 
-0003f2f0: 5472 7565 0a20 2020 2020 2020 2065 6c69  True.        eli
-0003f300: 6620 7365 6c66 2e6b 6572 6e65 6c5f 6e61  f self.kernel_na
-0003f310: 6d65 203d 3d20 2743 656c 6572 6974 6553  me == 'CeleriteS
-0003f320: 484f 4b65 726e 656c 273a 0a20 2020 2020  HOKernel':.     
-0003f330: 2020 2020 2020 2023 2047 656e 6572 6174         # Generat
-0003f340: 6520 6b65 726e 656c 3a0a 2020 2020 2020  e kernel:.      
-0003f350: 2020 2020 2020 7368 6f5f 6b65 726e 656c        sho_kernel
-0003f360: 203d 2074 6572 6d73 2e53 484f 5465 726d   = terms.SHOTerm
-0003f370: 286c 6f67 5f53 303d 6e70 2e6c 6f67 2831  (log_S0=np.log(1
-0003f380: 302e 292c 0a20 2020 2020 2020 2020 2020  0.),.           
-0003f390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f3a0: 2020 2020 2020 2020 2020 2020 6c6f 675f              log_
-0003f3b0: 513d 6e70 2e6c 6f67 2831 302e 292c 0a20  Q=np.log(10.),. 
-0003f3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f3e0: 2020 2020 2020 6c6f 675f 6f6d 6567 6130        log_omega0
-0003f3f0: 3d6e 702e 6c6f 6728 3130 2e29 290a 2020  =np.log(10.)).  
-0003f400: 2020 2020 2020 2020 2020 2320 4a69 7474            # Jitt
-0003f410: 6572 2074 6572 6d3a 0a20 2020 2020 2020  er term:.       
-0003f420: 2020 2020 206b 6572 6e65 6c5f 6a69 7474       kernel_jitt
-0003f430: 6572 203d 2074 6572 6d73 2e4a 6974 7465  er = terms.Jitte
-0003f440: 7254 6572 6d28 6e70 2e6c 6f67 2831 3030  rTerm(np.log(100
-0003f450: 202a 2031 652d 3629 290a 2020 2020 2020   * 1e-6)).      
-0003f460: 2020 2020 2020 2320 5772 6170 2047 5020        # Wrap GP 
-0003f470: 6b65 726e 656c 2061 6e64 206f 626a 6563  kernel and objec
-0003f480: 743a 0a20 2020 2020 2020 2020 2020 2069  t:.            i
-0003f490: 6620 7365 6c66 2e69 6e73 7472 756d 656e  f self.instrumen
-0003f4a0: 7420 696e 205b 2772 7627 2c20 276c 6327  t in ['rv', 'lc'
-0003f4b0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-0003f4c0: 2020 2073 656c 662e 6b65 726e 656c 203d     self.kernel =
-0003f4d0: 2073 686f 5f6b 6572 6e65 6c0a 2020 2020   sho_kernel.    
-0003f4e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0003f4f0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0003f500: 6c66 2e6b 6572 6e65 6c20 3d20 7368 6f5f  lf.kernel = sho_
-0003f510: 6b65 726e 656c 202b 206b 6572 6e65 6c5f  kernel + kernel_
-0003f520: 6a69 7474 6572 0a20 2020 2020 2020 2020  jitter.         
-0003f530: 2020 2023 2057 6520 6172 6520 7573 696e     # We are usin
-0003f540: 6720 6365 6c65 7269 7465 3a0a 2020 2020  g celerite:.    
-0003f550: 2020 2020 2020 2020 7365 6c66 2e75 7365          self.use
-0003f560: 5f63 656c 6572 6974 6520 3d20 5472 7565  _celerite = True
-0003f570: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-0003f580: 6c66 2e6b 6572 6e65 6c5f 6e61 6d65 203d  lf.kernel_name =
-0003f590: 3d20 2743 656c 6572 6974 6544 6f75 626c  = 'CeleriteDoubl
-0003f5a0: 6553 484f 4b65 726e 656c 273a 0a20 2020  eSHOKernel':.   
-0003f5b0: 2020 2020 2020 2020 2023 2047 656e 6572           # Gener
-0003f5c0: 6174 6520 6b65 726e 656c 0a20 2020 2020  ate kernel.     
-0003f5d0: 2020 2020 2020 2023 5468 6973 206b 6572         #This ker
-0003f5e0: 6e65 6c20 6973 2061 6461 7074 6564 2066  nel is adapted f
-0003f5f0: 726f 6d20 7468 6520 2252 6f74 6174 696f  rom the "Rotatio
-0003f600: 6e54 6572 6d22 2069 6e20 6365 6c65 7269  nTerm" in celeri
-0003f610: 7465 3220 6874 7470 733a 2f2f 6365 6c65  te2 https://cele
-0003f620: 7269 7465 322e 7265 6164 7468 6564 6f63  rite2.readthedoc
-0003f630: 732e 696f 2f65 6e2f 6c61 7465 7374 2f61  s.io/en/latest/a
-0003f640: 7069 2f70 7974 686f 6e2f 2363 656c 6572  pi/python/#celer
-0003f650: 6974 6532 2e74 6572 6d73 2e52 6f74 6174  ite2.terms.Rotat
-0003f660: 696f 6e54 6572 6d0a 2020 2020 2020 2020  ionTerm.        
-0003f670: 2020 2020 7368 6f5f 6b65 726e 656c 3120      sho_kernel1 
-0003f680: 3d20 7465 726d 732e 5348 4f54 6572 6d28  = terms.SHOTerm(
-0003f690: 6c6f 675f 5330 3d6e 702e 6c6f 6728 3130  log_S0=np.log(10
-0003f6a0: 2e29 2c0a 2020 2020 2020 2020 2020 2020  .),.            
-0003f6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f6c0: 2020 2020 2020 2020 2020 2020 6c6f 675f              log_
-0003f6d0: 513d 6e70 2e6c 6f67 2831 302e 292c 0a20  Q=np.log(10.),. 
-0003f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f700: 2020 2020 2020 206c 6f67 5f6f 6d65 6761         log_omega
-0003f710: 303d 6e70 2e6c 6f67 2831 302e 2929 0a20  0=np.log(10.)). 
-0003f720: 2020 2020 2020 2020 2020 2073 686f 5f6b             sho_k
-0003f730: 6572 6e65 6c32 203d 2074 6572 6d73 2e53  ernel2 = terms.S
-0003f740: 484f 5465 726d 286c 6f67 5f53 303d 6e70  HOTerm(log_S0=np
-0003f750: 2e6c 6f67 2831 302e 292c 0a20 2020 2020  .log(10.),.     
-0003f760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f780: 2020 206c 6f67 5f51 3d6e 702e 6c6f 6728     log_Q=np.log(
-0003f790: 3130 2e29 2c0a 2020 2020 2020 2020 2020  10.),.          
-0003f7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f7b0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
-0003f7c0: 675f 6f6d 6567 6130 3d6e 702e 6c6f 6728  g_omega0=np.log(
-0003f7d0: 3130 2e29 290a 0a20 2020 2020 2020 2020  10.))..         
-0003f7e0: 2020 2064 6f75 626c 655f 7368 6f5f 6b65     double_sho_ke
-0003f7f0: 726e 656c 203d 2073 686f 5f6b 6572 6e65  rnel = sho_kerne
-0003f800: 6c31 202b 2073 686f 5f6b 6572 6e65 6c32  l1 + sho_kernel2
-0003f810: 0a0a 2020 2020 2020 2020 2020 2020 7068  ..            ph
-0003f820: 616e 746f 6d76 6172 6961 626c 6520 3d20  antomvariable = 
-0003f830: 310a 2020 2020 2020 2020 2020 2020 2320  1.            # 
-0003f840: 4a69 7474 6572 2074 6572 6d3a 0a20 2020  Jitter term:.   
-0003f850: 2020 2020 2020 2020 206b 6572 6e65 6c5f           kernel_
-0003f860: 6a69 7474 6572 203d 2074 6572 6d73 2e4a  jitter = terms.J
-0003f870: 6974 7465 7254 6572 6d28 6e70 2e6c 6f67  itterTerm(np.log
-0003f880: 2831 3030 202a 2031 652d 3629 290a 2020  (100 * 1e-6)).  
-0003f890: 2020 2020 2020 2020 2020 2320 5772 6170            # Wrap
-0003f8a0: 2047 5020 6b65 726e 656c 2061 6e64 206f   GP kernel and o
-0003f8b0: 626a 6563 743a 0a20 2020 2020 2020 2020  bject:.         
-0003f8c0: 2020 2069 6620 7365 6c66 2e69 6e73 7472     if self.instr
-0003f8d0: 756d 656e 7420 696e 205b 2772 7627 2c20  ument in ['rv', 
-0003f8e0: 276c 6327 5d3a 0a20 2020 2020 2020 2020  'lc']:.         
-0003f8f0: 2020 2020 2020 2073 656c 662e 6b65 726e         self.kern
-0003f900: 656c 203d 2064 6f75 626c 655f 7368 6f5f  el = double_sho_
-0003f910: 6b65 726e 656c 0a20 2020 2020 2020 2020  kernel.         
-0003f920: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0003f930: 2020 2020 2020 2020 2073 656c 662e 6b65           self.ke
-0003f940: 726e 656c 203d 2064 6f75 626c 655f 7368  rnel = double_sh
-0003f950: 6f5f 6b65 726e 656c 202b 206b 6572 6e65  o_kernel + kerne
-0003f960: 6c5f 6a69 7474 6572 0a20 2020 2020 2020  l_jitter.       
-0003f970: 2020 2020 2023 2057 6520 6172 6520 7573       # We are us
-0003f980: 696e 6720 6365 6c65 7269 7465 3a0a 2020  ing celerite:.  
-0003f990: 2020 2020 2020 2020 2020 7365 6c66 2e75            self.u
-0003f9a0: 7365 5f63 656c 6572 6974 6520 3d20 5472  se_celerite = Tr
-0003f9b0: 7565 0a20 2020 2020 2020 2023 2320 466f  ue.        ## Fo
-0003f9c0: 7220 4d61 7465 726e 2b53 484f 206b 6572  r Matern+SHO ker
-0003f9d0: 6e65 6c0a 2020 2020 2020 2020 656c 6966  nel.        elif
-0003f9e0: 2073 656c 662e 6b65 726e 656c 5f6e 616d   self.kernel_nam
-0003f9f0: 6520 3d3d 2027 4365 6c65 7269 7465 4d61  e == 'CeleriteMa
-0003fa00: 7465 726e 5348 4f4b 6572 6e65 6c27 3a0a  ternSHOKernel':.
-0003fa10: 2020 2020 2020 2020 2020 2020 2320 4d61              # Ma
-0003fa20: 7465 726e 206b 6572 6e65 6c3a 0a20 2020  tern kernel:.   
-0003fa30: 2020 2020 2020 2020 206d 6174 6572 6e5f           matern_
-0003fa40: 6b65 726e 656c 203d 2074 6572 6d73 2e4d  kernel = terms.M
-0003fa50: 6174 6572 6e33 3254 6572 6d28 6c6f 675f  atern32Term(log_
-0003fa60: 7369 676d 613d 6e70 2e6c 6f67 2831 302e  sigma=np.log(10.
-0003fa70: 292c 206c 6f67 5f72 686f 3d6e 702e 6c6f  ), log_rho=np.lo
-0003fa80: 6728 3130 2e29 2c20 6570 7320 3d20 6d61  g(10.), eps = ma
-0003fa90: 7465 726e 5f65 7073 290a 2020 2020 2020  tern_eps).      
-0003faa0: 2020 2020 2020 2320 5348 4f20 6b65 726e        # SHO kern
-0003fab0: 656c 3a0a 2020 2020 2020 2020 2020 2020  el:.            
-0003fac0: 7368 6f5f 6b65 726e 656c 203d 2074 6572  sho_kernel = ter
-0003fad0: 6d73 2e53 484f 5465 726d 286c 6f67 5f53  ms.SHOTerm(log_S
-0003fae0: 303d 6e70 2e6c 6f67 2831 302e 292c 206c  0=np.log(10.), l
-0003faf0: 6f67 5f51 3d6e 702e 6c6f 6728 3130 2e29  og_Q=np.log(10.)
-0003fb00: 2c6c 6f67 5f6f 6d65 6761 303d 6e70 2e6c  ,log_omega0=np.l
-0003fb10: 6f67 2831 302e 2929 0a20 2020 2020 2020  og(10.)).       
-0003fb20: 2020 2020 2023 204a 6974 7465 7220 7465       # Jitter te
-0003fb30: 726d 3a0a 2020 2020 2020 2020 2020 2020  rm:.            
-0003fb40: 6b65 726e 656c 5f6a 6974 7465 7220 3d20  kernel_jitter = 
-0003fb50: 7465 726d 732e 4a69 7474 6572 5465 726d  terms.JitterTerm
-0003fb60: 286e 702e 6c6f 6728 3130 302a 3165 2d36  (np.log(100*1e-6
-0003fb70: 2929 0a20 2020 2020 2020 2020 2020 2023  )).            #
-0003fb80: 2057 7261 7020 4750 206b 6572 6e65 6c20   Wrap GP kernel 
-0003fb90: 616e 6420 6f62 6a65 6374 3a0a 2020 2020  and object:.    
-0003fba0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0003fbb0: 696e 7374 7275 6d65 6e74 2069 6e20 5b27  instrument in ['
-0003fbc0: 7276 272c 276c 6327 5d3a 0a20 2020 2020  rv','lc']:.     
-0003fbd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003fbe0: 6b65 726e 656c 203d 206d 6174 6572 6e5f  kernel = matern_
-0003fbf0: 6b65 726e 656c 202b 2073 686f 5f6b 6572  kernel + sho_ker
-0003fc00: 6e65 6c0a 2020 2020 2020 2020 2020 2020  nel.            
-0003fc10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0003fc20: 2020 2020 2020 7365 6c66 2e6b 6572 6e65        self.kerne
-0003fc30: 6c20 3d20 6d61 7465 726e 5f6b 6572 6e65  l = matern_kerne
-0003fc40: 6c20 2b20 7368 6f5f 6b65 726e 656c 202b  l + sho_kernel +
-0003fc50: 206b 6572 6e65 6c5f 6a69 7474 6572 0a20   kernel_jitter. 
-0003fc60: 2020 2020 2020 2020 2020 2023 2041 6e64             # And
-0003fc70: 2077 6520 6172 6520 7573 696e 6720 6365   we are using ce
-0003fc80: 6c65 7269 7465 0a20 2020 2020 2020 2020  lerite.         
-0003fc90: 2020 2073 656c 662e 7573 655f 6365 6c65     self.use_cele
-0003fca0: 7269 7465 203d 2054 7275 650a 2020 2020  rite = True.    
-0003fcb0: 2020 2020 2320 4368 6563 6b20 6966 2075      # Check if u
-0003fcc0: 7365 5f63 656c 6572 6974 6520 6973 2054  se_celerite is T
-0003fcd0: 7275 653b 2069 6620 5472 7565 2c20 6368  rue; if True, ch
-0003fce0: 6563 6b20 7468 6174 2074 6865 2072 6567  eck that the reg
-0003fcf0: 7265 7373 6f72 2069 7320 6f72 6465 7265  ressor is ordere
-0003fd00: 642e 2049 6620 6e6f 742c 2064 6f6e 2774  d. If not, don't
-0003fd10: 2064 6f20 7468 6520 7365 6c66 2e69 6e69   do the self.ini
-0003fd20: 745f 4750 2829 3a0a 2020 2020 2020 2020  t_GP():.        
-0003fd30: 6966 2073 656c 662e 7573 655f 6365 6c65  if self.use_cele
-0003fd40: 7269 7465 3a0a 2020 2020 2020 2020 2020  rite:.          
-0003fd50: 2020 6964 785f 736f 7274 6564 203d 206e    idx_sorted = n
-0003fd60: 702e 6172 6773 6f72 7428 7365 6c66 2e58  p.argsort(self.X
-0003fd70: 290a 2020 2020 2020 2020 2020 2020 6c58  ).            lX
-0003fd80: 203d 206c 656e 2873 656c 662e 5829 0a20   = len(self.X). 
-0003fd90: 2020 2020 2020 2020 2020 2064 6966 6631             diff1
-0003fda0: 203d 206e 702e 636f 756e 745f 6e6f 6e7a   = np.count_nonz
-0003fdb0: 6572 6f28 7365 6c66 2e58 202d 2073 656c  ero(self.X - sel
-0003fdc0: 662e 585b 6964 785f 736f 7274 6564 5d29  f.X[idx_sorted])
-0003fdd0: 0a20 2020 2020 2020 2020 2020 2064 6966  .            dif
-0003fde0: 6632 203d 206e 702e 636f 756e 745f 6e6f  f2 = np.count_no
-0003fdf0: 6e7a 6572 6f28 7365 6c66 2e58 202d 2073  nzero(self.X - s
-0003fe00: 656c 662e 585b 6964 785f 736f 7274 6564  elf.X[idx_sorted
-0003fe10: 5b3a 3a2d 315d 5d29 0a20 2020 2020 2020  [::-1]]).       
-0003fe20: 2020 2020 2069 6620 6469 6666 3120 3d3d       if diff1 ==
-0003fe30: 2030 206f 7220 6469 6666 3220 3d3d 2030   0 or diff2 == 0
-0003fe40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003fe50: 2020 7365 6c66 2e69 6e69 745f 4750 2829    self.init_GP()
-0003fe60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003fe70: 2073 656c 662e 6973 496e 6974 203d 2054   self.isInit = T
-0003fe80: 7275 650a 2020 2020 2020 2020 656c 7365  rue.        else
-0003fe90: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0003fea0: 6c66 2e69 6e69 745f 4750 2829 0a20 2020  lf.init_GP().   
-0003feb0: 2020 2020 2020 2020 2073 656c 662e 6973           self.is
-0003fec0: 496e 6974 203d 2054 7275 650a 0a20 2020  Init = True..   
-0003fed0: 2020 2020 2069 6620 7365 6c66 2e67 6c6f       if self.glo
-0003fee0: 6261 6c5f 4750 3a0a 2020 2020 2020 2020  bal_GP:.        
-0003fef0: 2020 2020 2320 4966 2069 6e73 7472 756d      # If instrum
-0003ff00: 656e 7420 6973 2027 7276 2720 6f72 2027  ent is 'rv' or '
-0003ff10: 6c63 272c 2061 7373 756d 6520 4750 206f  lc', assume GP o
-0003ff20: 626a 6563 7420 7769 6c6c 2066 6974 2066  bject will fit f
-0003ff30: 6f72 2061 2067 6c6f 6261 6c20 4750 0a20  or a global GP. 
-0003ff40: 2020 2020 2020 2020 2020 2023 2028 652e             # (e.
-0003ff50: 672e 2c20 676c 6f62 616c 2070 686f 746f  g., global photo
-0003ff60: 6d65 7472 6963 2073 6967 6e61 6c2c 206f  metric signal, o
-0003ff70: 7220 676c 6f62 616c 2052 5620 7369 676e  r global RV sign
-0003ff80: 616c 2920 7468 6174 2061 7373 756d 6573  al) that assumes
-0003ff90: 2061 2067 6976 656e 0a20 2020 2020 2020   a given.       
-0003ffa0: 2020 2020 2023 2047 5020 7265 616c 697a       # GP realiz
-0003ffb0: 6174 696f 6e20 666f 7220 616c 6c20 696e  ation for all in
-0003ffc0: 7374 7275 6d65 6e74 7320 2862 7574 2061  struments (but a
-0003ffd0: 6c6c 6f77 7320 6469 6666 6572 656e 7420  llows different 
-0003ffe0: 6a69 7474 6572 7320 666f 7220 6561 6368  jitters for each
-0003fff0: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
-00040000: 6e73 7472 756d 656e 742c 2061 6464 6564  nstrument, added
-00040010: 2069 6e20 7175 6164 7261 7475 7265 2074   in quadrature t
-00040020: 6f20 7468 6520 7365 6c66 2e79 6572 7229  o the self.yerr)
-00040030: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00040040: 6c66 2e70 6172 616d 6574 6572 5f76 6563  lf.parameter_vec
-00040050: 746f 7220 3d20 6e70 2e7a 6572 6f73 280a  tor = np.zeros(.
-00040060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040070: 6c65 6e28 7365 6c66 2e76 6172 6961 626c  len(self.variabl
-00040080: 6573 2920 2b20 7068 616e 746f 6d76 6172  es) + phantomvar
-00040090: 6961 626c 6529 0a20 2020 2020 2020 2065  iable).        e
-000400a0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000400b0: 2023 2049 6620 4750 2070 6572 2069 6e73   # If GP per ins
-000400c0: 7472 756d 656e 742c 2074 6865 6e20 7468  trument, then th
-000400d0: 6572 6520 6973 206f 6e65 206a 6974 7465  ere is one jitte
-000400e0: 7220 7465 726d 2070 6572 2069 6e73 7472  r term per instr
-000400f0: 756d 656e 7420 6469 7265 6374 6c79 2061  ument directly a
-00040100: 6464 6564 2069 6e20 7468 6520 6d6f 6465  dded in the mode
-00040110: 6c3a 0a20 2020 2020 2020 2020 2020 2073  l:.            s
-00040120: 656c 662e 7061 7261 6d65 7465 725f 7665  elf.parameter_ve
-00040130: 6374 6f72 203d 206e 702e 7a65 726f 7328  ctor = np.zeros(
-00040140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040150: 206c 656e 2873 656c 662e 7661 7269 6162   len(self.variab
-00040160: 6c65 7329 202b 2031 202b 2070 6861 6e74  les) + 1 + phant
-00040170: 6f6d 7661 7269 6162 6c65 290a 2020 2020  omvariable).    
-00040180: 2020 2020 7365 6c66 2e73 6574 5f69 6e70      self.set_inp
-00040190: 7574 5f69 6e73 7472 756d 656e 7428 6461  ut_instrument(da
-000401a0: 7461 2e70 7269 6f72 7329 0a              ta.priors).
+00038590: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+000385a0: 5f69 6e61 6d65 5b76 6563 5b31 5d5d 5b69  _iname[vec[1]][i
+000385b0: 6e73 7472 756d 656e 745d 203d 2027 5f27  nstrument] = '_'
+000385c0: 202b 2027 5f27 2e6a 6f69 6e28 7665 635b   + '_'.join(vec[
+000385d0: 323a 5d29 0a0a 2020 2020 2020 2020 2020  2:])..          
+000385e0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+000385f0: 6966 206c 656e 2876 6563 2920 3d3d 2033  if len(vec) == 3
+00038600: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
+00038610: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00038620: 2054 6869 7320 6973 2074 6865 2063 6173   This is the cas
+00038630: 6520 6f66 2061 2073 696e 676c 6520 696e  e of a single in
+00038640: 7374 7275 6d65 6e74 2077 6974 6820 702c  strument with p,
+00038650: 2065 2e67 2e2c 2070 5f70 315f 5445 5353   e.g., p_p1_TESS
+00038660: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00038670: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00038680: 2069 6e73 7472 756d 656e 7420 696e 2076   instrument in v
+00038690: 6563 3a0a 0a20 2020 2020 2020 2020 2020  ec:..           
+000386a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000386b0: 2020 2020 2073 656c 662e 705f 696e 616d       self.p_inam
+000386c0: 655b 7665 635b 315d 5d5b 696e 7374 7275  e[vec[1]][instru
+000386d0: 6d65 6e74 5d20 3d20 275f 2720 2b20 7665  ment] = '_' + ve
+000386e0: 635b 325d 0a0a 2020 2020 2020 2020 2020  c[2]..          
+000386f0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00038700: 6966 206c 656e 2876 6563 2920 3d3d 2032  if len(vec) == 2
+00038710: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
+00038720: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00038730: 2054 6869 7320 6164 6473 2062 6163 6b2d   This adds back-
+00038740: 636f 6d70 6174 6962 696c 6974 7920 736f  compatibility so
+00038750: 2075 7365 7273 2063 616e 2064 6566 696e   users can defin
+00038760: 6520 6120 636f 6d6d 6f6e 2070 2066 6f72  e a common p for
+00038770: 2061 6c6c 2069 6e73 7472 756d 656e 7473   all instruments
+00038780: 2028 652e 672e 2c20 705f 7031 293a 0a20   (e.g., p_p1):. 
+00038790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000387a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000387b0: 705f 696e 616d 655b 7665 635b 315d 5d5b  p_iname[vec[1]][
+000387c0: 696e 7374 7275 6d65 6e74 5d20 3d20 2727  instrument] = ''
+000387d0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000387e0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000387f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038800: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00038810: 7365 2045 7863 6570 7469 6f6e 2827 5072  se Exception('Pr
+00038820: 696f 7220 666f 7220 7020 6973 206e 6f74  ior for p is not
+00038830: 2070 726f 7065 726c 7920 6465 6669 6e65   properly define
+00038840: 643a 206d 7573 7420 6265 2c20 652e 672e  d: must be, e.g.
+00038850: 2c20 705f 7031 2c20 705f 7031 5f69 6e73  , p_p1, p_p1_ins
+00038860: 7420 6f72 2070 5f70 315f 696e 7374 315f  t or p_p1_inst1_
+00038870: 696e 7374 322e 2043 7572 7265 6e74 6c79  inst2. Currently
+00038880: 2069 7320 272b 706e 616d 6529 0a0a 2020   is '+pname)..  
+00038890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000388a0: 2020 6966 2070 6e61 6d65 5b30 3a32 5d20    if pname[0:2] 
+000388b0: 3d3d 2027 7031 273a 0a0a 2020 2020 2020  == 'p1':..      
+000388c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000388d0: 2020 7665 6320 3d20 706e 616d 652e 7370    vec = pname.sp
+000388e0: 6c69 7428 275f 2729 0a20 2020 2020 2020  lit('_').       
+000388f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038900: 2069 6620 6c65 6e28 7665 6329 203e 2033   if len(vec) > 3
+00038910: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
+00038920: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00038930: 2054 6869 7320 6973 2074 6865 2063 6173   This is the cas
+00038940: 6520 696e 2077 6869 6368 206d 756c 7469  e in which multi
+00038950: 706c 6520 696e 7374 7275 6d65 6e74 7320  ple instruments 
+00038960: 7368 6172 6520 6120 4357 2073 656d 692d  share a CW semi-
+00038970: 706c 616e 6574 2d74 6f2d 7374 6172 2072  planet-to-star r
+00038980: 6174 696f 2c20 652e 672e 2c20 7031 5f70  atio, e.g., p1_p
+00038990: 315f 5445 5353 315f 5445 5353 320a 2020  1_TESS1_TESS2.  
+000389a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000389b0: 2020 2020 2020 2020 2020 6966 2069 6e73            if ins
+000389c0: 7472 756d 656e 7420 696e 2076 6563 3a0a  trument in vec:.
+000389d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000389e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000389f0: 2073 656c 662e 7031 5f69 6e61 6d65 5b76   self.p1_iname[v
+00038a00: 6563 5b31 5d5d 5b69 6e73 7472 756d 656e  ec[1]][instrumen
+00038a10: 745d 203d 2027 5f27 202b 2027 5f27 2e6a  t] = '_' + '_'.j
+00038a20: 6f69 6e28 7665 635b 323a 5d29 0a0a 2020  oin(vec[2:])..  
+00038a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038a40: 2020 2020 2020 656c 6966 206c 656e 2876        elif len(v
+00038a50: 6563 2920 3d3d 2033 3a0a 0a20 2020 2020  ec) == 3:..     
+00038a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038a70: 2020 2020 2020 2023 2054 6869 7320 6973         # This is
+00038a80: 2074 6865 2063 6173 6520 6f66 2061 2073   the case of a s
+00038a90: 696e 676c 6520 696e 7374 7275 6d65 6e74  ingle instrument
+00038aa0: 2077 6974 6820 7031 2c20 652e 672e 2c20   with p1, e.g., 
+00038ab0: 7031 5f70 315f 5445 5353 3a0a 2020 2020  p1_p1_TESS:.    
+00038ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038ad0: 2020 2020 2020 2020 6966 2069 6e73 7472          if instr
+00038ae0: 756d 656e 7420 696e 2076 6563 3a20 0a0a  ument in vec: ..
+00038af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038b10: 7365 6c66 2e70 315f 696e 616d 655b 7665  self.p1_iname[ve
+00038b20: 635b 315d 5d5b 696e 7374 7275 6d65 6e74  c[1]][instrument
+00038b30: 5d20 3d20 275f 2720 2b20 7665 635b 325d  ] = '_' + vec[2]
+00038b40: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00038b50: 2020 2020 2020 2020 2020 656c 6966 206c            elif l
+00038b60: 656e 2876 6563 2920 3d3d 2032 3a0a 0a20  en(vec) == 2:.. 
+00038b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038b80: 2020 2020 2020 2020 2020 2023 2054 6869             # Thi
+00038b90: 7320 6164 6473 2062 6163 6b2d 636f 6d70  s adds back-comp
+00038ba0: 6174 6962 696c 6974 7920 736f 2075 7365  atibility so use
+00038bb0: 7273 2063 616e 2064 6566 696e 6520 6120  rs can define a 
+00038bc0: 636f 6d6d 6f6e 2070 2066 6f72 2061 6c6c  common p for all
+00038bd0: 2069 6e73 7472 756d 656e 7473 2028 652e   instruments (e.
+00038be0: 672e 2c20 705f 7031 293a 0a20 2020 2020  g., p_p1):.     
+00038bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038c00: 2020 2020 2020 2073 656c 662e 7031 5f69         self.p1_i
+00038c10: 6e61 6d65 5b76 6563 5b31 5d5d 5b69 6e73  name[vec[1]][ins
+00038c20: 7472 756d 656e 745d 203d 2027 270a 0a20  trument] = ''.. 
+00038c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038c40: 2020 2020 2020 2065 6c73 653a 2020 0a0a         else:  ..
+00038c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038c60: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00038c70: 6520 4578 6365 7074 696f 6e28 2750 7269  e Exception('Pri
+00038c80: 6f72 2066 6f72 2070 312f 7032 2069 7320  or for p1/p2 is 
+00038c90: 6e6f 7420 7072 6f70 6572 6c79 2064 6566  not properly def
+00038ca0: 696e 6564 3a20 6d75 7374 2062 652c 2065  ined: must be, e
+00038cb0: 2e67 2e2c 2070 315f 7031 2c20 7031 5f70  .g., p1_p1, p1_p
+00038cc0: 315f 696e 7374 206f 7220 7031 5f70 315f  1_inst or p1_p1_
+00038cd0: 696e 7374 315f 696e 7374 322e 2043 7572  inst1_inst2. Cur
+00038ce0: 7265 6e74 6c79 2069 7320 272b 706e 616d  rently is '+pnam
+00038cf0: 6529 0a0a 2020 2020 2020 2020 2020 2020  e)..            
+00038d00: 2320 5365 7420 7468 6520 6d6f 6465 6c2d  # Set the model-
+00038d10: 7479 7065 2074 6f20 4d28 7429 3a0a 2020  type to M(t):.  
+00038d20: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+00038d30: 7661 6c75 6174 6520 3d20 7365 6c66 2e65  valuate = self.e
+00038d40: 7661 6c75 6174 655f 6d6f 6465 6c0a 2020  valuate_model.  
+00038d50: 2020 2020 2020 2020 2020 7365 6c66 2e67            self.g
+00038d60: 656e 6572 6174 6520 3d20 7365 6c66 2e67  enerate = self.g
+00038d70: 656e 6572 6174 655f 6c63 5f6d 6f64 656c  enerate_lc_model
+00038d80: 0a0a 2020 2020 2020 2020 656c 6966 206d  ..        elif m
+00038d90: 6f64 656c 7479 7065 203d 3d20 2772 7627  odeltype == 'rv'
+00038da0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00038db0: 6c66 2e6d 6f64 656c 7479 7065 203d 2027  lf.modeltype = '
+00038dc0: 7276 270a 2020 2020 2020 2020 2020 2020  rv'.            
+00038dd0: 2320 496e 6865 7274 2074 696d 6573 2c20  # Inhert times, 
+00038de0: 5256 732c 2065 7272 6f72 732c 2069 6e64  RVs, errors, ind
+00038df0: 6578 6573 2c20 6574 632e 2066 726f 6d20  exes, etc. from 
+00038e00: 6461 7461 3a0a 2020 2020 2020 2020 2020  data:.          
+00038e10: 2020 7365 6c66 2e74 203d 2064 6174 612e    self.t = data.
+00038e20: 745f 7276 0a20 2020 2020 2020 2020 2020  t_rv.           
+00038e30: 2073 656c 662e 7920 3d20 6461 7461 2e79   self.y = data.y
+00038e40: 5f72 760a 2020 2020 2020 2020 2020 2020  _rv.            
+00038e50: 7365 6c66 2e79 6572 7220 3d20 6461 7461  self.yerr = data
+00038e60: 2e79 6572 725f 7276 0a20 2020 2020 2020  .yerr_rv.       
+00038e70: 2020 2020 2073 656c 662e 7469 6d65 7320       self.times 
+00038e80: 3d20 6461 7461 2e74 696d 6573 5f72 760a  = data.times_rv.
+00038e90: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00038ea0: 2e64 6174 6120 3d20 6461 7461 2e64 6174  .data = data.dat
+00038eb0: 615f 7276 0a20 2020 2020 2020 2020 2020  a_rv.           
+00038ec0: 2073 656c 662e 6572 726f 7273 203d 2064   self.errors = d
+00038ed0: 6174 612e 6572 726f 7273 5f72 760a 2020  ata.errors_rv.  
+00038ee0: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
+00038ef0: 6e73 7472 756d 656e 7473 203d 2064 6174  nstruments = dat
+00038f00: 612e 696e 7374 7275 6d65 6e74 735f 7276  a.instruments_rv
+00038f10: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00038f20: 662e 6e69 6e73 7472 756d 656e 7473 203d  f.ninstruments =
+00038f30: 2064 6174 612e 6e69 6e73 7472 756d 656e   data.ninstrumen
+00038f40: 7473 5f72 760a 2020 2020 2020 2020 2020  ts_rv.          
+00038f50: 2020 7365 6c66 2e69 6e61 6d65 7320 3d20    self.inames = 
+00038f60: 6461 7461 2e69 6e61 6d65 735f 7276 0a20  data.inames_rv. 
+00038f70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00038f80: 696e 7374 7275 6d65 6e74 5f69 6e64 6578  instrument_index
+00038f90: 6573 203d 2064 6174 612e 696e 7374 7275  es = data.instru
+00038fa0: 6d65 6e74 5f69 6e64 6578 6573 5f72 760a  ment_indexes_rv.
+00038fb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00038fc0: 2e6c 6d5f 626f 6f6c 6561 6e20 3d20 6461  .lm_boolean = da
+00038fd0: 7461 2e6c 6d5f 7276 5f62 6f6f 6c65 616e  ta.lm_rv_boolean
+00038fe0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00038ff0: 662e 6c6d 5f61 7267 756d 656e 7473 203d  f.lm_arguments =
+00039000: 2064 6174 612e 6c6d 5f72 765f 6172 6775   data.lm_rv_argu
+00039010: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
+00039020: 2020 7365 6c66 2e6c 6d5f 6e20 3d20 7b7d    self.lm_n = {}
+00039030: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00039040: 662e 676c 6f62 616c 5f6d 6f64 656c 203d  f.global_model =
+00039050: 2064 6174 612e 676c 6f62 616c 5f72 765f   data.global_rv_
+00039060: 6d6f 6465 6c0a 2020 2020 2020 2020 2020  model.          
+00039070: 2020 7365 6c66 2e64 6963 7469 6f6e 6172    self.dictionar
+00039080: 7920 3d20 6461 7461 2e72 765f 6f70 7469  y = data.rv_opti
+00039090: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
+000390a0: 7365 6c66 2e6e 756d 6265 7269 6e67 203d  self.numbering =
+000390b0: 2064 6174 612e 6e75 6d62 6572 696e 675f   data.numbering_
+000390c0: 7276 5f70 6c61 6e65 7473 0a20 2020 2020  rv_planets.     
+000390d0: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
+000390e0: 6572 696e 672e 736f 7274 2829 0a20 2020  ering.sort().   
+000390f0: 2020 2020 2020 2020 2073 656c 662e 6e70           self.np
+00039100: 6c61 6e65 7473 203d 206c 656e 2873 656c  lanets = len(sel
+00039110: 662e 6e75 6d62 6572 696e 6729 0a20 2020  f.numbering).   
+00039120: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
+00039130: 6465 6c20 3d20 7b7d 0a20 2020 2020 2020  del = {}.       
+00039140: 2020 2020 2073 656c 662e 6e64 6174 6170       self.ndatap
+00039150: 6f69 6e74 735f 616c 6c5f 696e 7374 7275  oints_all_instru
+00039160: 6d65 6e74 7320 3d20 300a 2020 2020 2020  ments = 0.      
+00039170: 2020 2020 2020 2320 4669 7273 742c 2069        # First, i
+00039180: 6620 6120 676c 6f62 616c 206d 6f64 656c  f a global model
+00039190: 2c20 6765 6e65 7261 7465 2061 7272 6179  , generate array
+000391a0: 2074 6861 7420 7769 6c6c 2073 6176 6520   that will save 
+000391b0: 7468 6973 3a0a 2020 2020 2020 2020 2020  this:.          
+000391c0: 2020 6966 2073 656c 662e 676c 6f62 616c    if self.global
+000391d0: 5f6d 6f64 656c 3a0a 2020 2020 2020 2020  _model:.        
+000391e0: 2020 2020 2020 2020 7365 6c66 2e6d 6f64          self.mod
+000391f0: 656c 5b27 676c 6f62 616c 275d 203d 206e  el['global'] = n
+00039200: 702e 7a65 726f 7328 6c65 6e28 7365 6c66  p.zeros(len(self
+00039210: 2e74 2929 0a20 2020 2020 2020 2020 2020  .t)).           
+00039220: 2020 2020 2073 656c 662e 6d6f 6465 6c5b       self.model[
+00039230: 2767 6c6f 6261 6c5f 7661 7269 616e 6365  'global_variance
+00039240: 7327 5d20 3d20 6e70 2e7a 6572 6f73 286c  s'] = np.zeros(l
+00039250: 656e 2873 656c 662e 7429 290a 2020 2020  en(self.t)).    
+00039260: 2020 2020 2020 2020 2320 496e 6974 6961          # Initia
+00039270: 6c69 7a65 2072 6164 7665 6c3a 0a20 2020  lize radvel:.   
+00039280: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
+00039290: 6465 6c5b 2772 6164 7665 6c27 5d20 3d20  del['radvel'] = 
+000392a0: 696e 6974 5f72 6164 7665 6c28 6e70 6c61  init_radvel(npla
+000392b0: 6e65 7473 3d73 656c 662e 6e70 6c61 6e65  nets=self.nplane
+000392c0: 7473 290a 2020 2020 2020 2020 2020 2020  ts).            
+000392d0: 2320 4669 7273 7420 676f 2061 726f 756e  # First go aroun
+000392e0: 6420 616c 6c20 706c 616e 6574 7320 746f  d all planets to
+000392f0: 2063 6f6d 7075 7465 2074 6865 2066 756c   compute the ful
+00039300: 6c20 5256 206d 6f64 656c 733a 0a20 2020  l RV models:.   
+00039310: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
+00039320: 6e20 7365 6c66 2e6e 756d 6265 7269 6e67  n self.numbering
+00039330: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00039340: 2020 7365 6c66 2e6d 6f64 656c 5b27 7027    self.model['p'
+00039350: 202b 2073 7472 2869 295d 203d 206e 702e   + str(i)] = np.
+00039360: 6f6e 6573 286c 656e 2873 656c 662e 7429  ones(len(self.t)
+00039370: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+00039380: 4e6f 7720 7661 7269 6162 6c65 2074 6f20  Now variable to 
+00039390: 7361 7665 2066 756c 6c20 5256 204b 6570  save full RV Kep
+000393a0: 6c65 7269 616e 206d 6f64 656c 3a0a 2020  lerian model:.  
+000393b0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+000393c0: 6f64 656c 5b27 4b65 706c 6572 6961 6e27  odel['Keplerian'
+000393d0: 5d20 3d20 6e70 2e6f 6e65 7328 6c65 6e28  ] = np.ones(len(
+000393e0: 7365 6c66 2e74 2929 0a20 2020 2020 2020  self.t)).       
+000393f0: 2020 2020 2023 2053 616d 6520 666f 7220       # Same for 
+00039400: 4b65 706c 6572 6961 6e20 2b20 7472 656e  Keplerian + tren
+00039410: 6473 3a0a 2020 2020 2020 2020 2020 2020  ds:.            
+00039420: 7365 6c66 2e6d 6f64 656c 5b27 4b65 706c  self.model['Kepl
+00039430: 6572 6961 6e2b 5472 656e 6427 5d20 3d20  erian+Trend'] = 
+00039440: 6e70 2e6f 6e65 7328 6c65 6e28 7365 6c66  np.ones(len(self
+00039450: 2e74 2929 0a20 2020 2020 2020 2020 2020  .t)).           
+00039460: 2023 2047 6f20 6172 6f75 6e64 2065 6163   # Go around eac
+00039470: 6820 696e 7374 7275 6d65 6e74 3a0a 2020  h instrument:.  
+00039480: 2020 2020 2020 2020 2020 666f 7220 696e            for in
+00039490: 7374 7275 6d65 6e74 2069 6e20 7365 6c66  strument in self
+000394a0: 2e69 6e61 6d65 733a 0a20 2020 2020 2020  .inames:.       
+000394b0: 2020 2020 2020 2020 2073 656c 662e 6d6f           self.mo
+000394c0: 6465 6c5b 696e 7374 7275 6d65 6e74 5d20  del[instrument] 
+000394d0: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
+000394e0: 2020 2020 2023 2045 7874 7261 6374 206e       # Extract n
+000394f0: 756d 6265 7220 6f66 2064 6174 6170 6f69  umber of datapoi
+00039500: 6e74 7320 7065 7220 696e 7374 7275 6d65  nts per instrume
+00039510: 6e74 3a0a 2020 2020 2020 2020 2020 2020  nt:.            
+00039520: 2020 2020 7365 6c66 2e6e 6461 7461 706f      self.ndatapo
+00039530: 696e 7473 5f70 6572 5f69 6e73 7472 756d  ints_per_instrum
+00039540: 656e 745b 696e 7374 7275 6d65 6e74 5d20  ent[instrument] 
+00039550: 3d20 6c65 6e28 0a20 2020 2020 2020 2020  = len(.         
+00039560: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00039570: 696e 7374 7275 6d65 6e74 5f69 6e64 6578  instrument_index
+00039580: 6573 5b69 6e73 7472 756d 656e 745d 290a  es[instrument]).
+00039590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000395a0: 7365 6c66 2e6e 6461 7461 706f 696e 7473  self.ndatapoints
+000395b0: 5f61 6c6c 5f69 6e73 7472 756d 656e 7473  _all_instruments
+000395c0: 202b 3d20 7365 6c66 2e6e 6461 7461 706f   += self.ndatapo
+000395d0: 696e 7473 5f70 6572 5f69 6e73 7472 756d  ints_per_instrum
+000395e0: 656e 745b 0a20 2020 2020 2020 2020 2020  ent[.           
+000395f0: 2020 2020 2020 2020 2069 6e73 7472 756d           instrum
+00039600: 656e 745d 0a20 2020 2020 2020 2020 2020  ent].           
+00039610: 2020 2020 2023 2045 7874 7261 6374 206e       # Extract n
+00039620: 756d 6265 7220 6f66 206c 696e 6561 7220  umber of linear 
+00039630: 6d6f 6465 6c20 7465 726d 7320 7065 7220  model terms per 
+00039640: 696e 7374 7275 6d65 6e74 3a0a 2020 2020  instrument:.    
+00039650: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00039660: 656c 662e 6c6d 5f62 6f6f 6c65 616e 5b69  elf.lm_boolean[i
+00039670: 6e73 7472 756d 656e 745d 3a0a 0a20 2020  nstrument]:..   
+00039680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039690: 2073 656c 662e 6c6d 5f6e 5b69 6e73 7472   self.lm_n[instr
+000396a0: 756d 656e 745d 203d 2073 656c 662e 6c6d  ument] = self.lm
+000396b0: 5f61 7267 756d 656e 7473 5b69 6e73 7472  _arguments[instr
+000396c0: 756d 656e 745d 2e73 6861 7065 5b31 5d0a  ument].shape[1].
+000396d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000396e0: 2023 2047 656e 6572 6174 6520 696e 7465   # Generate inte
+000396f0: 726e 616c 206d 6f64 656c 2076 6172 6961  rnal model varia
+00039700: 626c 6573 206f 6620 696e 7465 7265 7374  bles of interest
+00039710: 2074 6f20 7468 6520 7573 6572 2e20 4669   to the user. Fi
+00039720: 7273 742c 2074 6865 2052 5620 6d6f 6465  rst, the RV mode
+00039730: 6c20 696e 2074 6865 206e 6f74 6174 696f  l in the notatio
+00039740: 6e20 6f66 206a 756c 6965 7420 284d 6929  n of juliet (Mi)
+00039750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039760: 2023 2028 6675 6c6c 2052 5620 6d6f 6465   # (full RV mode
+00039770: 6c20 706c 7573 206f 6666 7365 7420 7665  l plus offset ve
+00039780: 6c6f 6369 7479 2c20 706c 7573 2074 7265  locity, plus tre
+00039790: 6e64 293a 0a20 2020 2020 2020 2020 2020  nd):.           
+000397a0: 2020 2020 2073 656c 662e 6d6f 6465 6c5b       self.model[
+000397b0: 696e 7374 7275 6d65 6e74 5d5b 274d 275d  instrument]['M']
+000397c0: 203d 206e 702e 6f6e 6573 280a 2020 2020   = np.ones(.    
+000397d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000397e0: 6c65 6e28 7365 6c66 2e69 6e73 7472 756d  len(self.instrum
+000397f0: 656e 745f 696e 6465 7865 735b 696e 7374  ent_indexes[inst
+00039800: 7275 6d65 6e74 5d29 290a 2020 2020 2020  rument])).      
+00039810: 2020 2020 2020 2020 2020 2320 4c69 6e65            # Line
+00039820: 6172 206d 6f64 656c 2028 696e 2074 6865  ar model (in the
+00039830: 206e 6f74 6174 696f 6e20 6f66 206a 756c   notation of jul
+00039840: 6965 742c 204c 4d29 3a0a 2020 2020 2020  iet, LM):.      
+00039850: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00039860: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
+00039870: 5b27 4c4d 275d 203d 206e 702e 7a65 726f  ['LM'] = np.zero
+00039880: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00039890: 2020 2020 2020 206c 656e 2873 656c 662e         len(self.
+000398a0: 696e 7374 7275 6d65 6e74 5f69 6e64 6578  instrument_index
+000398b0: 6573 5b69 6e73 7472 756d 656e 745d 2929  es[instrument]))
+000398c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000398d0: 2023 204e 6f77 2c20 6765 6e65 7261 7465   # Now, generate
+000398e0: 2064 6963 7469 6f6e 6172 7920 7468 6174   dictionary that
+000398f0: 2077 696c 6c20 7361 7665 2074 6865 2066   will save the f
+00039900: 696e 616c 2066 756c 6c20 6d6f 6465 6c20  inal full model 
+00039910: 284d 202b 204c 4d29 3a0a 2020 2020 2020  (M + LM):.      
+00039920: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00039930: 6f64 656c 5b69 6e73 7472 756d 656e 745d  odel[instrument]
+00039940: 5b27 6465 7465 726d 696e 6973 7469 6327  ['deterministic'
+00039950: 5d20 3d20 6e70 2e7a 6572 6f73 280a 2020  ] = np.zeros(.  
+00039960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039970: 2020 6c65 6e28 7365 6c66 2e69 6e73 7472    len(self.instr
+00039980: 756d 656e 745f 696e 6465 7865 735b 696e  ument_indexes[in
+00039990: 7374 7275 6d65 6e74 5d29 290a 2020 2020  strument])).    
+000399a0: 2020 2020 2020 2020 2020 2020 2320 5361              # Sa
+000399b0: 6d65 2066 6f72 2074 6865 2065 7272 6f72  me for the error
+000399c0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+000399d0: 2020 2073 656c 662e 6d6f 6465 6c5b 696e     self.model[in
+000399e0: 7374 7275 6d65 6e74 5d5b 2764 6574 6572  strument]['deter
+000399f0: 6d69 6e69 7374 6963 5f65 7272 6f72 7327  ministic_errors'
+00039a00: 5d20 3d20 6e70 2e7a 6572 6f73 280a 2020  ] = np.zeros(.  
+00039a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039a20: 2020 6c65 6e28 7365 6c66 2e69 6e73 7472    len(self.instr
+00039a30: 756d 656e 745f 696e 6465 7865 735b 696e  ument_indexes[in
+00039a40: 7374 7275 6d65 6e74 5d29 290a 2020 2020  strument])).    
+00039a50: 2020 2020 2020 2020 2020 2020 2320 496e              # In
+00039a60: 6469 7669 6475 616c 206b 6570 6c65 7269  dividual kepleri
+00039a70: 616e 7320 666f 7220 6561 6368 2070 6c61  ans for each pla
+00039a80: 6e65 743a 0a20 2020 2020 2020 2020 2020  net:.           
+00039a90: 2020 2020 2066 6f72 2069 2069 6e20 7365       for i in se
+00039aa0: 6c66 2e6e 756d 6265 7269 6e67 3a0a 2020  lf.numbering:.  
+00039ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039ac0: 2020 7365 6c66 2e6d 6f64 656c 5b69 6e73    self.model[ins
+00039ad0: 7472 756d 656e 745d 5b27 7027 202b 2073  trument]['p' + s
+00039ae0: 7472 2869 295d 203d 206e 702e 6f6e 6573  tr(i)] = np.ones
+00039af0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00039b00: 2020 2020 2020 2020 2020 6c65 6e28 7365            len(se
+00039b10: 6c66 2e69 6e73 7472 756d 656e 745f 696e  lf.instrument_in
+00039b20: 6465 7865 735b 696e 7374 7275 6d65 6e74  dexes[instrument
+00039b30: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
+00039b40: 2020 2020 2320 416e 2061 7272 6179 206f      # An array o
+00039b50: 6620 6f6e 6573 2074 6f20 636f 7079 2061  f ones to copy a
+00039b60: 726f 756e 643a 0a20 2020 2020 2020 2020  round:.         
+00039b70: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
+00039b80: 6c5b 696e 7374 7275 6d65 6e74 5d5b 276f  l[instrument]['o
+00039b90: 6e65 7327 5d20 3d20 6e70 2e6f 6e65 7328  nes'] = np.ones(
+00039ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039bb0: 2020 2020 206c 656e 2873 656c 662e 745b       len(self.t[
+00039bc0: 7365 6c66 2e69 6e73 7472 756d 656e 745f  self.instrument_
+00039bd0: 696e 6465 7865 735b 696e 7374 7275 6d65  indexes[instrume
+00039be0: 6e74 5d5d 2929 0a20 2020 2020 2020 2020  nt]])).         
+00039bf0: 2020 2023 2053 6574 2074 6865 206d 6f64     # Set the mod
+00039c00: 656c 2d74 7970 6520 746f 204d 2874 293a  el-type to M(t):
+00039c10: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00039c20: 662e 6576 616c 7561 7465 203d 2073 656c  f.evaluate = sel
+00039c30: 662e 6576 616c 7561 7465 5f6d 6f64 656c  f.evaluate_model
+00039c40: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00039c50: 662e 6765 6e65 7261 7465 203d 2073 656c  f.generate = sel
+00039c60: 662e 6765 6e65 7261 7465 5f72 765f 6d6f  f.generate_rv_mo
+00039c70: 6465 6c0a 2020 2020 2020 2020 656c 7365  del.        else
+00039c80: 3a0a 0a20 2020 2020 2020 2020 2020 2072  :..            r
+00039c90: 6169 7365 2045 7863 6570 7469 6f6e 280a  aise Exception(.
+00039ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039cb0: 274d 6f64 656c 2074 7970 6520 2227 202b  'Model type "' +
+00039cc0: 206c 6320 2b0a 2020 2020 2020 2020 2020   lc +.          
+00039cd0: 2020 2020 2020 2722 206e 6f74 2072 6563        '" not rec
+00039ce0: 6f67 6e69 7a65 642e 2043 7572 7265 6e74  ognized. Current
+00039cf0: 6c79 2069 7420 6361 6e20 6f6e 6c79 2062  ly it can only b
+00039d00: 6520 226c 6322 2066 6f72 2061 206c 6967  e "lc" for a lig
+00039d10: 6874 2d63 7572 7665 206d 6f64 656c 206f  ht-curve model o
+00039d20: 7220 2272 7622 2066 6f72 2072 6164 6961  r "rv" for radia
+00039d30: 6c2d 7665 6c6f 6369 7479 206d 6f64 656c  l-velocity model
+00039d40: 2e27 0a20 2020 2020 2020 2020 2020 2029  .'.            )
+00039d50: 0a0a 636c 6173 7320 6761 7573 7369 616e  ..class gaussian
+00039d60: 5f70 726f 6365 7373 286f 626a 6563 7429  _process(object)
+00039d70: 3a0a 2020 2020 2222 220a 2020 2020 4769  :.    """.    Gi
+00039d80: 7665 6e20 6120 6a75 6c69 6574 2064 6174  ven a juliet dat
+00039d90: 6120 6f62 6a65 6374 2028 6372 6561 7465  a object (create
+00039da0: 6420 7669 6120 6a75 6c69 6574 2e6c 6f61  d via juliet.loa
+00039db0: 6429 2c20 6120 6d6f 6465 6c20 7479 7065  d), a model type
+00039dc0: 2028 692e 652e 2c20 6973 2074 6869 7320   (i.e., is this 
+00039dd0: 6120 4750 2066 6f72 2061 2052 5620 6f72  a GP for a RV or
+00039de0: 206c 6967 6874 6375 7276 6520 6461 7461   lightcurve data
+00039df0: 7365 7429 2061 6e64 0a20 2020 2061 6e20  set) and.    an 
+00039e00: 696e 7374 7275 6d65 6e74 206e 616d 652c  instrument name,
+00039e10: 2074 6869 7320 6f62 6a65 6374 2067 656e   this object gen
+00039e20: 6572 6174 6573 2061 2047 6175 7373 6961  erates a Gaussia
+00039e30: 6e20 5072 6f63 6573 7320 2847 5029 206f  n Process (GP) o
+00039e40: 626a 6563 7420 746f 2075 7365 2077 6974  bject to use wit
+00039e50: 6869 6e20 7468 6520 6a75 6c69 6574 206c  hin the juliet l
+00039e60: 6962 7261 7279 2e20 4578 616d 706c 6520  ibrary. Example 
+00039e70: 7573 6167 653a 0a0a 2020 2020 2020 2020  usage:..        
+00039e80: 2020 2020 2020 203e 3e3e 2047 506d 6f64         >>> GPmod
+00039e90: 656c 203d 206a 756c 6965 742e 6761 7573  el = juliet.gaus
+00039ea0: 7369 616e 5f70 726f 6365 7373 2864 6174  sian_process(dat
+00039eb0: 612c 206d 6f64 656c 5f74 7970 6520 3d20  a, model_type = 
+00039ec0: 276c 6327 2c20 696e 7374 7275 6d65 6e74  'lc', instrument
+00039ed0: 203d 2027 5445 5353 2729 0a0a 2020 2020   = 'TESS')..    
+00039ee0: 3a70 6172 616d 2064 6174 6120 286a 756c  :param data (jul
+00039ef0: 6965 742e 6c6f 6164 206f 626a 6563 7429  iet.load object)
+00039f00: 0a20 2020 2020 2020 204f 626a 6563 7420  .        Object 
+00039f10: 636f 6e74 6169 6e69 6e67 2061 6c6c 2074  containing all t
+00039f20: 6865 2069 6e66 6f72 6d61 7469 6f6e 2061  he information a
+00039f30: 626f 7574 2074 6865 2063 7572 7265 6e74  bout the current
+00039f40: 2064 6174 6173 6574 2e20 5468 6973 2077   dataset. This w
+00039f50: 696c 6c20 6865 6c70 2069 6e20 6465 7465  ill help in dete
+00039f60: 726d 696e 696e 6720 7468 6520 7479 7065  rmining the type
+00039f70: 206f 6620 6b65 726e 656c 0a20 2020 2020   of kernel.     
+00039f80: 2020 2074 6865 2069 6e70 7574 2069 6e73     the input ins
+00039f90: 7472 756d 656e 7420 6861 7320 616e 6420  trument has and 
+00039fa0: 616c 736f 2069 6620 7468 6520 696e 7374  also if the inst
+00039fb0: 7275 6d65 6e74 2068 6173 2061 6e79 2065  rument has any e
+00039fc0: 7272 6f72 7320 6173 736f 6369 6174 6564  rrors associated
+00039fd0: 2077 6974 6820 6974 2074 6f20 696e 6974   with it to init
+00039fe0: 6961 6c69 7a65 2074 6865 206b 6572 6e65  ialize the kerne
+00039ff0: 6c2e 0a0a 2020 2020 3a70 6172 616d 206d  l...    :param m
+0003a000: 6f64 656c 5f74 7970 653a 2028 7374 7269  odel_type: (stri
+0003a010: 6e67 290a 2020 2020 2020 2020 4120 7374  ng).        A st
+0003a020: 7269 6e67 2064 6566 696e 696e 6720 7468  ring defining th
+0003a030: 6520 7479 7065 206f 6620 6461 7461 2074  e type of data t
+0003a040: 6865 2047 5020 7769 6c6c 2062 6520 6d6f  he GP will be mo
+0003a050: 6465 6c6c 696e 672e 2043 616e 2062 6520  delling. Can be 
+0003a060: 6569 7468 6572 2060 606c 6360 6020 2866  either ``lc`` (f
+0003a070: 6f72 2070 686f 746f 6d65 7472 7929 206f  or photometry) o
+0003a080: 7220 6060 7276 6060 2028 666f 7220 7261  r ``rv`` (for ra
+0003a090: 6469 616c 2d76 656c 6f63 6974 6965 7329  dial-velocities)
+0003a0a0: 2e0a 0a20 2020 203a 7061 7261 6d20 696e  ...    :param in
+0003a0b0: 7374 7275 6d65 6e74 3a20 2873 7472 696e  strument: (strin
+0003a0c0: 6729 0a20 2020 2020 2020 2041 2073 7472  g).        A str
+0003a0d0: 696e 6720 696e 6469 6361 7469 6e67 2074  ing indicating t
+0003a0e0: 6865 206e 616d 6520 6f66 2074 6865 2069  he name of the i
+0003a0f0: 6e73 7472 756d 656e 7420 7468 6520 4750  nstrument the GP
+0003a100: 2069 7320 6265 696e 6720 6170 706c 6965   is being applie
+0003a110: 6420 746f 2e20 5468 6973 2073 7472 696e  d to. This strin
+0003a120: 6720 7369 6d70 6c69 6669 6573 2063 726f  g simplifies cro
+0003a130: 7373 2d74 616c 6b20 7769 7468 206a 756c  ss-talk with jul
+0003a140: 6965 7427 7320 6060 706f 7374 6572 696f  iet's ``posterio
+0003a150: 7273 6060 0a20 2020 2020 2020 2064 6963  rs``.        dic
+0003a160: 7469 6f6e 6172 792e 0a0a 2020 2020 3a70  tionary...    :p
+0003a170: 6172 616d 2067 656f 7267 655f 686f 646c  aram george_hodl
+0003a180: 723a 2028 6f70 7469 6f6e 616c 2c20 626f  r: (optional, bo
+0003a190: 6f6c 6561 6e29 0a20 2020 2020 2020 2049  olean).        I
+0003a1a0: 6620 5472 7565 2c20 7468 6973 2075 7365  f True, this use
+0003a1b0: 7320 4765 6f72 6765 2773 2048 4f44 4c52  s George's HODLR
+0003a1c0: 2073 6f6c 7665 7220 2866 6173 7465 7229   solver (faster)
+0003a1d0: 2e0a 0a20 2020 2022 2222 0a0a 2020 2020  ...    """..    
+0003a1e0: 6465 6620 6765 745f 6b65 726e 656c 5f6e  def get_kernel_n
+0003a1f0: 616d 6528 7365 6c66 2c20 7072 696f 7273  ame(self, priors
+0003a200: 293a 0a0a 2020 2020 2020 2020 2320 4669  ):..        # Fi
+0003a210: 7273 742c 2063 6865 636b 2061 6c6c 2074  rst, check all t
+0003a220: 6865 2047 5020 7661 7269 6162 6c65 7320  he GP variables 
+0003a230: 696e 2074 6865 2070 7269 6f72 7320 6669  in the priors fi
+0003a240: 6c65 2074 6861 7420 6172 6520 6f66 2074  le that are of t
+0003a250: 6865 2066 6f72 6d20 4750 5f76 6172 6961  he form GP_varia
+0003a260: 626c 655f 696e 7374 7275 6d65 6e74 315f  ble_instrument1_
+0003a270: 696e 7374 7275 6d65 6e74 325f 2e2e 2e3a  instrument2_...:
+0003a280: 0a20 2020 2020 2020 2076 6172 6961 626c  .        variabl
+0003a290: 6573 5f74 6861 745f 6d61 7463 6820 3d20  es_that_match = 
+0003a2a0: 5b5d 0a20 2020 2020 2020 2066 6f72 2070  [].        for p
+0003a2b0: 6e61 6d65 2069 6e20 7072 696f 7273 2e6b  name in priors.k
+0003a2c0: 6579 7328 293a 0a20 2020 2020 2020 2020  eys():.         
+0003a2d0: 2020 2076 6563 203d 2070 6e61 6d65 2e73     vec = pname.s
+0003a2e0: 706c 6974 2827 5f27 290a 2020 2020 2020  plit('_').      
+0003a2f0: 2020 2020 2020 6966 2028 7665 635b 305d        if (vec[0]
+0003a300: 203d 3d20 2747 5027 2920 616e 6420 2873   == 'GP') and (s
+0003a310: 656c 662e 696e 7374 7275 6d65 6e74 2069  elf.instrument i
+0003a320: 6e20 7665 6329 3a0a 2020 2020 2020 2020  n vec):.        
+0003a330: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+0003a340: 735f 7468 6174 5f6d 6174 6368 203d 2076  s_that_match = v
+0003a350: 6172 6961 626c 6573 5f74 6861 745f 6d61  ariables_that_ma
+0003a360: 7463 6820 2b20 5b76 6563 5b31 5d5d 0a20  tch + [vec[1]]. 
+0003a370: 2020 2020 2020 2023 204e 6f77 2077 6520         # Now we 
+0003a380: 6861 7665 2061 6c6c 2074 6865 2076 6172  have all the var
+0003a390: 6961 626c 6573 2074 6861 7420 6d61 7463  iables that matc
+0003a3a0: 6820 7468 6520 6375 7272 656e 7420 696e  h the current in
+0003a3b0: 7374 7275 6d65 6e74 2069 6e20 7661 7269  strument in vari
+0003a3c0: 6162 6c65 735f 7468 6174 5f6d 6174 6368  ables_that_match
+0003a3d0: 2e20 4368 6563 6b20 7768 6963 6820 6f66  . Check which of
+0003a3e0: 2074 6865 0a20 2020 2020 2020 2023 2069   the.        # i
+0003a3f0: 6d70 6c65 6d65 6e74 6564 2047 5020 6d6f  mplemented GP mo
+0003a400: 6465 6c73 2067 6976 6573 2061 2070 6572  dels gives a per
+0003a410: 6665 6374 206d 6174 6368 2074 6f20 616c  fect match to al
+0003a420: 6c20 7468 6520 7661 7269 6162 6c65 733b  l the variables;
+0003a430: 2074 6861 7420 7769 6c6c 2067 6976 6520   that will give 
+0003a440: 7573 2074 6865 206e 616d 6520 6f66 2074  us the name of t
+0003a450: 6865 206b 6572 6e65 6c3a 0a20 2020 2020  he kernel:.     
+0003a460: 2020 206e 5f76 6172 6961 626c 6573 5f74     n_variables_t
+0003a470: 6861 745f 6d61 7463 6820 3d20 6c65 6e28  hat_match = len(
+0003a480: 7661 7269 6162 6c65 735f 7468 6174 5f6d  variables_that_m
+0003a490: 6174 6368 290a 2020 2020 2020 2020 6966  atch).        if
+0003a4a0: 206e 5f76 6172 6961 626c 6573 5f74 6861   n_variables_tha
+0003a4b0: 745f 6d61 7463 6820 3d3d 2030 3a0a 2020  t_match == 0:.  
+0003a4c0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0003a4d0: 4578 6365 7074 696f 6e28 0a20 2020 2020  Exception(.     
+0003a4e0: 2020 2020 2020 2020 2020 2027 496e 7075             'Inpu
+0003a4f0: 7420 6572 726f 723a 2069 7420 7365 656d  t error: it seem
+0003a500: 7320 696e 7374 7275 6d65 6e74 2027 202b  s instrument ' +
+0003a510: 2073 656c 662e 696e 7374 7275 6d65 6e74   self.instrument
+0003a520: 202b 0a20 2020 2020 2020 2020 2020 2020   +.             
+0003a530: 2020 2027 2068 6173 206e 6f20 6465 6669     ' has no defi
+0003a540: 6e65 6420 7072 696f 7273 2069 6e20 7468  ned priors in th
+0003a550: 6520 7072 696f 7220 6669 6c65 2066 6f72  e prior file for
+0003a560: 2061 2047 6175 7373 6961 6e20 5072 6f63   a Gaussian Proc
+0003a570: 6573 732e 2043 6865 636b 2074 6865 2070  ess. Check the p
+0003a580: 7269 6f72 2066 696c 6520 616e 6420 7472  rior file and tr
+0003a590: 7920 6167 6169 6e2e 270a 2020 2020 2020  y again.'.      
+0003a5a0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0003a5b0: 2066 6f72 206b 6572 6e65 6c5f 6e61 6d65   for kernel_name
+0003a5c0: 2069 6e20 7365 6c66 2e61 6c6c 5f6b 6572   in self.all_ker
+0003a5d0: 6e65 6c5f 7661 7269 6162 6c65 732e 6b65  nel_variables.ke
+0003a5e0: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
+0003a5f0: 2020 636f 756e 7465 7220 3d20 300a 2020    counter = 0.  
+0003a600: 2020 2020 2020 2020 2020 666f 7220 7661            for va
+0003a610: 7269 6162 6c65 5f6e 616d 6520 696e 2073  riable_name in s
+0003a620: 656c 662e 616c 6c5f 6b65 726e 656c 5f76  elf.all_kernel_v
+0003a630: 6172 6961 626c 6573 5b6b 6572 6e65 6c5f  ariables[kernel_
+0003a640: 6e61 6d65 5d3a 0a20 2020 2020 2020 2020  name]:.         
+0003a650: 2020 2020 2020 2069 6620 7661 7269 6162         if variab
+0003a660: 6c65 5f6e 616d 6520 696e 2076 6172 6961  le_name in varia
+0003a670: 626c 6573 5f74 6861 745f 6d61 7463 683a  bles_that_match:
+0003a680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003a690: 2020 2020 2063 6f75 6e74 6572 202b 3d20       counter += 
+0003a6a0: 310a 2020 2020 2020 2020 2020 2020 6966  1.            if
+0003a6b0: 2028 6e5f 7661 7269 6162 6c65 735f 7468   (n_variables_th
+0003a6c0: 6174 5f6d 6174 6368 0a20 2020 2020 2020  at_match.       
+0003a6d0: 2020 2020 2020 2020 2020 2020 203d 3d20               == 
+0003a6e0: 636f 756e 7465 7229 2061 6e64 2028 6c65  counter) and (le
+0003a6f0: 6e28 7365 6c66 2e61 6c6c 5f6b 6572 6e65  n(self.all_kerne
+0003a700: 6c5f 7661 7269 6162 6c65 735b 6b65 726e  l_variables[kern
+0003a710: 656c 5f6e 616d 655d 290a 2020 2020 2020  el_name]).      
+0003a720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a730: 2020 2020 2020 2020 2020 2020 2020 203d                 =
+0003a740: 3d20 6e5f 7661 7269 6162 6c65 735f 7468  = n_variables_th
+0003a750: 6174 5f6d 6174 6368 293a 0a20 2020 2020  at_match):.     
+0003a760: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0003a770: 6e20 6b65 726e 656c 5f6e 616d 650a 0a20  n kernel_name.. 
+0003a780: 2020 2064 6566 2069 6e69 745f 4750 2873     def init_GP(s
+0003a790: 656c 6629 3a0a 2020 2020 2020 2020 6966  elf):.        if
+0003a7a0: 2073 656c 662e 7573 655f 6365 6c65 7269   self.use_celeri
+0003a7b0: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
+0003a7c0: 7365 6c66 2e47 5020 3d20 6365 6c65 7269  self.GP = celeri
+0003a7d0: 7465 2e47 5028 7365 6c66 2e6b 6572 6e65  te.GP(self.kerne
+0003a7e0: 6c2c 206d 6561 6e3d 302e 3029 0a20 2020  l, mean=0.0).   
+0003a7f0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0003a800: 2020 2020 2020 2069 6620 7365 6c66 2e67         if self.g
+0003a810: 6c6f 6261 6c5f 4750 3a0a 2020 2020 2020  lobal_GP:.      
+0003a820: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0003a830: 662e 6765 6f72 6765 5f68 6f64 6c72 3a0a  f.george_hodlr:.
+0003a840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a850: 2020 2020 7365 6c66 2e47 5020 3d20 6765      self.GP = ge
+0003a860: 6f72 6765 2e47 5028 7365 6c66 2e6b 6572  orge.GP(self.ker
+0003a870: 6e65 6c2c 206d 6561 6e20 3d20 302e 302c  nel, mean = 0.0,
+0003a880: 2066 6974 5f6d 6561 6e20 3d20 4661 6c73   fit_mean = Fals
+0003a890: 652c 5c0a 2020 2020 2020 2020 2020 2020  e,\.            
+0003a8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a8b0: 2020 2020 2020 2020 2020 2020 6669 745f              fit_
+0003a8c0: 7768 6974 655f 6e6f 6973 6520 3d20 4661  white_noise = Fa
+0003a8d0: 6c73 652c 2073 6f6c 7665 7220 3d20 6765  lse, solver = ge
+0003a8e0: 6f72 6765 2e48 4f44 4c52 536f 6c76 6572  orge.HODLRSolver
+0003a8f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0003a900: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0003a910: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0003a920: 2e47 5020 3d20 6765 6f72 6765 2e47 5028  .GP = george.GP(
+0003a930: 7365 6c66 2e6b 6572 6e65 6c2c 206d 6561  self.kernel, mea
+0003a940: 6e20 3d20 302e 302c 2066 6974 5f6d 6561  n = 0.0, fit_mea
+0003a950: 6e20 3d20 4661 6c73 652c 5c0a 2020 2020  n = False,\.    
+0003a960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a980: 2020 2020 6669 745f 7768 6974 655f 6e6f      fit_white_no
+0003a990: 6973 6520 3d20 4661 6c73 6529 0a20 2020  ise = False).   
+0003a9a0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0003a9b0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0003a9c0: 2028 4e6f 7465 206e 6f20 6a69 7474 6572   (Note no jitter
+0003a9d0: 206b 6572 6e65 6c20 6973 2067 6976 656e   kernel is given
+0003a9e0: 2c20 6173 2077 6974 6820 6765 6f72 6765  , as with george
+0003a9f0: 206f 6e65 2064 6566 696e 6573 2074 6869   one defines thi
+0003aa00: 7320 696e 2074 6865 2067 656f 7267 652e  s in the george.
+0003aa10: 4750 2063 616c 6c29 3a0a 2020 2020 2020  GP call):.      
+0003aa20: 2020 2020 2020 2020 2020 6a69 7474 6572            jitter
+0003aa30: 5f74 6572 6d20 3d20 6765 6f72 6765 2e6d  _term = george.m
+0003aa40: 6f64 656c 696e 672e 436f 6e73 7461 6e74  odeling.Constant
+0003aa50: 4d6f 6465 6c28 312e 290a 2020 2020 2020  Model(1.).      
+0003aa60: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0003aa70: 662e 6765 6f72 6765 5f68 6f64 6c72 3a0a  f.george_hodlr:.
+0003aa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003aa90: 2020 2020 7365 6c66 2e47 5020 3d20 6765      self.GP = ge
+0003aaa0: 6f72 6765 2e47 5028 7365 6c66 2e6b 6572  orge.GP(self.ker
+0003aab0: 6e65 6c2c 206d 6561 6e20 3d20 302e 302c  nel, mean = 0.0,
+0003aac0: 2066 6974 5f6d 6561 6e20 3d20 4661 6c73   fit_mean = Fals
+0003aad0: 652c 2077 6869 7465 5f6e 6f69 7365 203d  e, white_noise =
+0003aae0: 206a 6974 7465 725f 7465 726d 2c5c 0a20   jitter_term,\. 
+0003aaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ab00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ab10: 2020 2020 2020 2066 6974 5f77 6869 7465         fit_white
+0003ab20: 5f6e 6f69 7365 203d 2054 7275 652c 2073  _noise = True, s
+0003ab30: 6f6c 7665 7220 3d20 6765 6f72 6765 2e48  olver = george.H
+0003ab40: 4f44 4c52 536f 6c76 6572 290a 2020 2020  ODLRSolver).    
+0003ab50: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0003ab60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0003ab70: 2020 2020 2020 7365 6c66 2e47 5020 3d20        self.GP = 
+0003ab80: 6765 6f72 6765 2e47 5028 7365 6c66 2e6b  george.GP(self.k
+0003ab90: 6572 6e65 6c2c 206d 6561 6e20 3d20 302e  ernel, mean = 0.
+0003aba0: 302c 2066 6974 5f6d 6561 6e20 3d20 4661  0, fit_mean = Fa
+0003abb0: 6c73 652c 2077 6869 7465 5f6e 6f69 7365  lse, white_noise
+0003abc0: 203d 206a 6974 7465 725f 7465 726d 2c5c   = jitter_term,\
+0003abd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003abe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003abf0: 2020 2020 2020 2020 2066 6974 5f77 6869           fit_whi
+0003ac00: 7465 5f6e 6f69 7365 203d 2054 7275 6529  te_noise = True)
+0003ac10: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
+0003ac20: 6d70 7574 655f 4750 2829 0a0a 2020 2020  mpute_GP()..    
+0003ac30: 6465 6620 636f 6d70 7574 655f 4750 2873  def compute_GP(s
+0003ac40: 656c 662c 2058 3d4e 6f6e 6529 3a0a 2020  elf, X=None):.  
+0003ac50: 2020 2020 2020 6966 2073 656c 662e 7965        if self.ye
+0003ac60: 7272 2069 7320 6e6f 7420 4e6f 6e65 3a0a  rr is not None:.
+0003ac70: 2020 2020 2020 2020 2020 2020 6966 2058              if X
+0003ac80: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0003ac90: 2020 2020 2020 2020 2020 7365 6c66 2e47            self.G
+0003aca0: 502e 636f 6d70 7574 6528 7365 6c66 2e58  P.compute(self.X
+0003acb0: 2c20 7965 7272 3d73 656c 662e 7965 7272  , yerr=self.yerr
+0003acc0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+0003acd0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0003ace0: 2020 2020 7365 6c66 2e47 502e 636f 6d70      self.GP.comp
+0003acf0: 7574 6528 582c 2079 6572 723d 7365 6c66  ute(X, yerr=self
+0003ad00: 2e79 6572 7229 0a20 2020 2020 2020 2065  .yerr).        e
+0003ad10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0003ad20: 2069 6620 5820 6973 204e 6f6e 653a 0a20   if X is None:. 
+0003ad30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0003ad40: 656c 662e 4750 2e63 6f6d 7075 7465 2873  elf.GP.compute(s
+0003ad50: 656c 662e 5829 0a20 2020 2020 2020 2020  elf.X).         
+0003ad60: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0003ad70: 2020 2020 2020 2020 2073 656c 662e 4750           self.GP
+0003ad80: 2e63 6f6d 7075 7465 2858 290a 0a20 2020  .compute(X)..   
+0003ad90: 2064 6566 2073 6574 5f69 6e70 7574 5f69   def set_input_i
+0003ada0: 6e73 7472 756d 656e 7428 7365 6c66 2c20  nstrument(self, 
+0003adb0: 696e 7075 745f 7661 7269 6162 6c65 7329  input_variables)
+0003adc0: 3a0a 0a20 2020 2020 2020 2023 2054 6869  :..        # Thi
+0003add0: 7320 6675 6e63 7469 6f6e 2073 6574 7320  s function sets 
+0003ade0: 7468 6520 2269 6e70 7574 2069 6e73 7472  the "input instr
+0003adf0: 756d 656e 7422 2028 7365 6c66 2e69 6e70  ument" (self.inp
+0003ae00: 7574 5f69 6e73 7472 756d 656e 7429 206e  ut_instrument) n
+0003ae10: 616d 6520 666f 7220 6561 6368 2076 6172  ame for each var
+0003ae20: 6961 626c 6520 2873 656c 662e 7661 7269  iable (self.vari
+0003ae30: 6162 6c65 7329 2e0a 2020 2020 2020 2020  ables)..        
+0003ae40: 2320 4966 2c20 666f 7220 6578 616d 706c  # If, for exampl
+0003ae50: 652c 2047 505f 5072 6f74 5f54 4553 535f  e, GP_Prot_TESS_
+0003ae60: 4b32 5f72 7620 616e 6420 4750 5f47 616d  K2_rv and GP_Gam
+0003ae70: 6d61 5f54 4553 532c 2061 6e64 2073 656c  ma_TESS, and sel
+0003ae80: 662e 7661 7269 6162 6c65 7320 3d20 5b27  f.variables = ['
+0003ae90: 5072 6f74 272c 2747 616d 6d61 275d 2c0a  Prot','Gamma'],.
+0003aea0: 2020 2020 2020 2020 2320 7468 656e 2073          # then s
+0003aeb0: 656c 662e 696e 7075 745f 696e 7374 7275  elf.input_instru
+0003aec0: 6d65 6e74 203d 205b 2754 4553 535f 4b32  ment = ['TESS_K2
+0003aed0: 5f72 7627 2c27 5445 5353 275d 2e0a 2020  _rv','TESS']..  
+0003aee0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+0003aef0: 616e 6765 286c 656e 2873 656c 662e 7661  ange(len(self.va
+0003af00: 7269 6162 6c65 7329 293a 0a20 2020 2020  riables)):.     
+0003af10: 2020 2020 2020 2047 5076 6172 6961 626c         GPvariabl
+0003af20: 6520 3d20 7365 6c66 2e76 6172 6961 626c  e = self.variabl
+0003af30: 6573 5b69 5d0a 2020 2020 2020 2020 2020  es[i].          
+0003af40: 2020 666f 7220 706e 616d 6573 2069 6e20    for pnames in 
+0003af50: 696e 7075 745f 7661 7269 6162 6c65 732e  input_variables.
+0003af60: 6b65 7973 2829 3a0a 2020 2020 2020 2020  keys():.        
+0003af70: 2020 2020 2020 2020 7665 6320 3d20 706e          vec = pn
+0003af80: 616d 6573 2e73 706c 6974 2827 5f27 290a  ames.split('_').
+0003af90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003afa0: 6966 2028 7665 635b 305d 203d 3d20 2747  if (vec[0] == 'G
+0003afb0: 5027 2920 616e 6420 2847 5076 6172 6961  P') and (GPvaria
+0003afc0: 626c 650a 2020 2020 2020 2020 2020 2020  ble.            
+0003afd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003afe0: 2020 2020 2020 2020 2020 2020 2069 6e20               in 
+0003aff0: 7665 635b 315d 2920 616e 6420 2873 656c  vec[1]) and (sel
+0003b000: 662e 696e 7374 7275 6d65 6e74 0a20 2020  f.instrument.   
+0003b010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b040: 2020 2020 2020 696e 2076 6563 293a 0a20        in vec):. 
+0003b050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b060: 2020 2073 656c 662e 696e 7075 745f 696e     self.input_in
+0003b070: 7374 7275 6d65 6e74 2e61 7070 656e 6428  strument.append(
+0003b080: 275f 272e 6a6f 696e 2876 6563 5b32 3a5d  '_'.join(vec[2:]
+0003b090: 2929 0a0a 2020 2020 6465 6620 7365 745f  ))..    def set_
+0003b0a0: 7061 7261 6d65 7465 725f 7665 6374 6f72  parameter_vector
+0003b0b0: 2873 656c 662c 2070 6172 616d 6574 6572  (self, parameter
+0003b0c0: 5f76 616c 7565 7329 3a0a 2020 2020 2020  _values):.      
+0003b0d0: 2020 2320 546f 2075 7064 6174 6520 7468    # To update th
+0003b0e0: 6520 7061 7261 6d65 7465 7273 2c20 7765  e parameters, we
+0003b0f0: 2068 6176 6520 746f 2074 7261 6e73 666f   have to transfo
+0003b100: 726d 2074 6865 206a 756c 6965 7420 696e  rm the juliet in
+0003b110: 7075 7473 2074 6f20 6365 6c65 7269 7465  puts to celerite
+0003b120: 2f67 656f 7267 6520 696e 7075 7473 2e20  /george inputs. 
+0003b130: 5570 6461 7465 2074 6869 730a 2020 2020  Update this.    
+0003b140: 2020 2020 2320 6465 7065 6e64 696e 6720      # depending 
+0003b150: 6f6e 2074 6865 206b 6572 6e65 6c20 756e  on the kernel un
+0003b160: 6465 7220 7573 6167 652e 2046 6f72 2074  der usage. For t
+0003b170: 6869 732c 2077 6520 6669 7273 7420 6465  his, we first de
+0003b180: 6669 6e65 2061 2062 6173 655f 696e 6465  fine a base_inde
+0003b190: 7820 7661 7269 6162 6c65 2074 6861 7420  x variable that 
+0003b1a0: 7769 6c6c 2064 6566 696e 6520 7468 6520  will define the 
+0003b1b0: 6e75 6d62 6572 696e 670a 2020 2020 2020  numbering.      
+0003b1c0: 2020 2320 6f66 2074 6865 2073 656c 662e    # of the self.
+0003b1d0: 7061 7261 6d65 7465 725f 7665 6374 6f72  parameter_vector
+0003b1e0: 2e20 5468 6520 7265 6173 6f6e 2066 6f72  . The reason for
+0003b1f0: 2074 6869 7320 6973 2074 6861 7420 7468   this is that th
+0003b200: 6520 6469 6d65 6e73 696f 6e73 206f 6620  e dimensions of 
+0003b210: 7468 6520 7365 6c66 2e70 6172 616d 6574  the self.paramet
+0003b220: 6572 5f76 6563 746f 7220 6172 7261 7920  er_vector array 
+0003b230: 6973 0a20 2020 2020 2020 2023 2064 6966  is.        # dif
+0003b240: 6665 7265 6e74 2069 6620 7468 6520 4750  ferent if the GP
+0003b250: 2069 7320 676c 6f62 616c 2028 692e 652e   is global (i.e.
+0003b260: 2c20 7365 6c66 2e67 6c6f 6261 6c5f 4750  , self.global_GP
+0003b270: 2069 7320 5472 7565 202d 2d2d 206d 6561   is True --- mea
+0003b280: 6e69 6e67 2061 2075 6e69 7175 6520 4750  ning a unique GP
+0003b290: 2069 7320 6669 7474 6564 2074 6f20 616c   is fitted to al
+0003b2a0: 6c20 696e 7374 7275 6d65 6e74 7329 206f  l instruments) o
+0003b2b0: 720a 2020 2020 2020 2020 2320 6e6f 7420  r.        # not 
+0003b2c0: 2873 656c 662e 676c 6f62 616c 5f47 5020  (self.global_GP 
+0003b2d0: 6973 2046 616c 7365 202d 2d2d 206d 6561  is False --- mea
+0003b2e0: 6e69 6e67 2061 2064 6966 6665 7265 6e74  ning a different
+0003b2f0: 2047 5020 7065 7220 696e 7374 7275 6d65   GP per instrume
+0003b300: 6e74 2069 7320 6669 7474 6564 292e 2049  nt is fitted). I
+0003b310: 6620 7468 6520 666f 726d 6572 2c20 7468  f the former, th
+0003b320: 6520 6a69 7474 6572 2074 6572 6d73 2061  e jitter terms a
+0003b330: 7265 0a20 2020 2020 2020 2023 206d 6f64  re.        # mod
+0003b340: 6966 6965 6420 6469 7265 6374 6c79 2062  ified directly b
+0003b350: 7920 6368 616e 6769 6e67 2074 6865 2073  y changing the s
+0003b360: 656c 662e 7965 7272 2076 6563 746f 723b  elf.yerr vector;
+0003b370: 2069 6e20 7468 6520 6c61 7474 6572 2c20   in the latter, 
+0003b380: 7765 2068 6176 6520 746f 206d 616e 7561  we have to manua
+0003b390: 6c6c 7920 6164 6420 6120 6a69 7474 6572  lly add a jitter
+0003b3a0: 2074 6572 6d20 696e 2074 6865 2047 5020   term in the GP 
+0003b3b0: 7061 7261 6d65 7465 720a 2020 2020 2020  parameter.      
+0003b3c0: 2020 2320 7665 6374 6f72 2e20 5468 6973    # vector. This
+0003b3d0: 2062 6173 655f 696e 6465 7820 6973 206f   base_index is o
+0003b3e0: 6e6c 7920 696d 706f 7274 616e 7420 666f  nly important fo
+0003b3f0: 7220 7468 6520 6765 6f72 6765 206b 6572  r the george ker
+0003b400: 6e65 6c73 2074 686f 7567 6820 2d2d 2d20  nels though --- 
+0003b410: 616e 2069 6620 7374 6174 656d 656e 7420  an if statement 
+0003b420: 7375 6666 6963 6573 2066 6f72 2074 6865  suffices for the
+0003b430: 2063 656c 6572 6974 6520 6f6e 6573 2e0a   celerite ones..
+0003b440: 2020 2020 2020 2020 6261 7365 5f69 6e64          base_ind
+0003b450: 6578 203d 2030 0a20 2020 2020 2020 2069  ex = 0.        i
+0003b460: 6620 2873 656c 662e 6b65 726e 656c 5f6e  f (self.kernel_n
+0003b470: 616d 6520 3d3d 2027 5345 4b65 726e 656c  ame == 'SEKernel
+0003b480: 2729 206f 7220 2873 656c 662e 6b65 726e  ') or (self.kern
+0003b490: 656c 5f6e 616d 650a 2020 2020 2020 2020  el_name.        
+0003b4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b4c0: 2020 2020 2020 2020 3d3d 2027 4d33 324b          == 'M32K
+0003b4d0: 6572 6e65 6c27 293a 0a20 2020 2020 2020  ernel'):.       
+0003b4e0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+0003b4f0: 2e67 6c6f 6261 6c5f 4750 3a0a 2020 2020  .global_GP:.    
+0003b500: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0003b510: 2e70 6172 616d 6574 6572 5f76 6563 746f  .parameter_vecto
+0003b520: 725b 6261 7365 5f69 6e64 6578 5d20 3d20  r[base_index] = 
+0003b530: 6e70 2e6c 6f67 280a 2020 2020 2020 2020  np.log(.        
+0003b540: 2020 2020 2020 2020 2020 2020 2870 6172              (par
+0003b550: 616d 6574 6572 5f76 616c 7565 735b 2773  ameter_values['s
+0003b560: 6967 6d61 5f77 5f27 202b 2073 656c 662e  igma_w_' + self.
+0003b570: 696e 7374 7275 6d65 6e74 5d20 2a0a 2020  instrument] *.  
+0003b580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b590: 2020 2073 656c 662e 7369 676d 615f 6661     self.sigma_fa
+0003b5a0: 6374 6f72 292a 2a32 290a 2020 2020 2020  ctor)**2).      
+0003b5b0: 2020 2020 2020 2020 2020 6261 7365 5f69            base_i
+0003b5c0: 6e64 6578 202b 3d20 310a 2020 2020 2020  ndex += 1.      
+0003b5d0: 2020 2020 2020 7365 6c66 2e70 6172 616d        self.param
+0003b5e0: 6574 6572 5f76 6563 746f 725b 6261 7365  eter_vector[base
+0003b5f0: 5f69 6e64 6578 5d20 3d20 6e70 2e6c 6f67  _index] = np.log
+0003b600: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003b610: 2020 2870 6172 616d 6574 6572 5f76 616c    (parameter_val
+0003b620: 7565 735b 2747 505f 7369 676d 615f 2720  ues['GP_sigma_' 
+0003b630: 2b20 7365 6c66 2e69 6e70 7574 5f69 6e73  + self.input_ins
+0003b640: 7472 756d 656e 745b 305d 5d20 2a0a 2020  trument[0]] *.  
+0003b650: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0003b660: 656c 662e 7369 676d 615f 6661 6374 6f72  elf.sigma_factor
+0003b670: 292a 2a32 2e29 0a20 2020 2020 2020 2020  )**2.).         
+0003b680: 2020 2061 6c70 6861 5f6e 616d 6520 3d20     alpha_name = 
+0003b690: 2761 6c70 6861 2720 6966 2073 656c 662e  'alpha' if self.
+0003b6a0: 6b65 726e 656c 5f6e 616d 6520 3d3d 2027  kernel_name == '
+0003b6b0: 5345 4b65 726e 656c 2720 656c 7365 2027  SEKernel' else '
+0003b6c0: 6d61 6c70 6861 270a 2020 2020 2020 2020  malpha'.        
+0003b6d0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+0003b6e0: 6765 2873 656c 662e 6e58 293a 0a20 2020  ge(self.nX):.   
+0003b6f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0003b700: 662e 7061 7261 6d65 7465 725f 7665 6374  f.parameter_vect
+0003b710: 6f72 5b62 6173 655f 696e 6465 7820 2b20  or[base_index + 
+0003b720: 3120 2b20 695d 203d 206e 702e 6c6f 6728  1 + i] = np.log(
+0003b730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003b740: 2020 2020 2031 2e20 2f20 7061 7261 6d65       1. / parame
+0003b750: 7465 725f 7661 6c75 6573 5b66 2747 505f  ter_values[f'GP_
+0003b760: 7b61 6c70 6861 5f6e 616d 657d 2720 2b20  {alpha_name}' + 
+0003b770: 7374 7228 6929 202b 2027 5f27 202b 0a20  str(i) + '_' +. 
+0003b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b7a0: 2020 2020 2020 2020 2073 656c 662e 696e           self.in
+0003b7b0: 7075 745f 696e 7374 7275 6d65 6e74 5b31  put_instrument[1
+0003b7c0: 202b 2069 5d5d 290a 2020 2020 2020 2020   + i]]).        
+0003b7d0: 656c 6966 2073 656c 662e 6b65 726e 656c  elif self.kernel
+0003b7e0: 5f6e 616d 6520 3d3d 2027 4578 7053 696e  _name == 'ExpSin
+0003b7f0: 6553 7175 6172 6564 5345 4b65 726e 656c  eSquaredSEKernel
+0003b800: 273a 0a20 2020 2020 2020 2020 2020 2069  ':.            i
+0003b810: 6620 6e6f 7420 7365 6c66 2e67 6c6f 6261  f not self.globa
+0003b820: 6c5f 4750 3a0a 2020 2020 2020 2020 2020  l_GP:.          
+0003b830: 2020 2020 2020 7365 6c66 2e70 6172 616d        self.param
+0003b840: 6574 6572 5f76 6563 746f 725b 6261 7365  eter_vector[base
+0003b850: 5f69 6e64 6578 5d20 3d20 6e70 2e6c 6f67  _index] = np.log
+0003b860: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003b870: 2020 2020 2020 2870 6172 616d 6574 6572        (parameter
+0003b880: 5f76 616c 7565 735b 2773 6967 6d61 5f77  _values['sigma_w
+0003b890: 5f27 202b 2073 656c 662e 696e 7374 7275  _' + self.instru
+0003b8a0: 6d65 6e74 5d20 2a0a 2020 2020 2020 2020  ment] *.        
+0003b8b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0003b8c0: 662e 7369 676d 615f 6661 6374 6f72 292a  f.sigma_factor)*
+0003b8d0: 2a32 290a 2020 2020 2020 2020 2020 2020  *2).            
+0003b8e0: 2020 2020 6261 7365 5f69 6e64 6578 202b      base_index +
+0003b8f0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+0003b900: 7365 6c66 2e70 6172 616d 6574 6572 5f76  self.parameter_v
+0003b910: 6563 746f 725b 6261 7365 5f69 6e64 6578  ector[base_index
+0003b920: 5d20 3d20 6e70 2e6c 6f67 280a 2020 2020  ] = np.log(.    
+0003b930: 2020 2020 2020 2020 2020 2020 2870 6172              (par
+0003b940: 616d 6574 6572 5f76 616c 7565 735b 2747  ameter_values['G
+0003b950: 505f 7369 676d 615f 2720 2b20 7365 6c66  P_sigma_' + self
+0003b960: 2e69 6e70 7574 5f69 6e73 7472 756d 656e  .input_instrumen
+0003b970: 745b 305d 5d20 2a0a 2020 2020 2020 2020  t[0]] *.        
+0003b980: 2020 2020 2020 2020 2073 656c 662e 7369           self.si
+0003b990: 676d 615f 6661 6374 6f72 292a 2a32 2e29  gma_factor)**2.)
+0003b9a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0003b9b0: 662e 7061 7261 6d65 7465 725f 7665 6374  f.parameter_vect
+0003b9c0: 6f72 5b62 6173 655f 696e 6465 7820 2b20  or[base_index + 
+0003b9d0: 315d 203d 206e 702e 6c6f 6728 0a20 2020  1] = np.log(.   
+0003b9e0: 2020 2020 2020 2020 2020 2020 2031 2e20               1. 
+0003b9f0: 2f20 2870 6172 616d 6574 6572 5f76 616c  / (parameter_val
+0003ba00: 7565 735b 2747 505f 616c 7068 615f 2720  ues['GP_alpha_' 
+0003ba10: 2b20 7365 6c66 2e69 6e70 7574 5f69 6e73  + self.input_ins
+0003ba20: 7472 756d 656e 745b 315d 5d29 290a 2020  trument[1]])).  
+0003ba30: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0003ba40: 6172 616d 6574 6572 5f76 6563 746f 725b  arameter_vector[
+0003ba50: 6261 7365 5f69 6e64 6578 202b 2032 5d20  base_index + 2] 
+0003ba60: 3d20 6e70 2e6c 6f67 2820 0a20 2020 2020  = np.log( .     
+0003ba70: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0003ba80: 6574 6572 5f76 616c 7565 735b 2747 505f  eter_values['GP_
+0003ba90: 4761 6d6d 615f 2720 2b20 7365 6c66 2e69  Gamma_' + self.i
+0003baa0: 6e70 7574 5f69 6e73 7472 756d 656e 745b  nput_instrument[
+0003bab0: 325d 5d29 0a20 2020 2020 2020 2020 2020  2]]).           
+0003bac0: 2073 656c 662e 7061 7261 6d65 7465 725f   self.parameter_
+0003bad0: 7665 6374 6f72 5b62 6173 655f 696e 6465  vector[base_inde
+0003bae0: 7820 2b20 335d 203d 206e 702e 6c6f 6728  x + 3] = np.log(
+0003baf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003bb00: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
+0003bb10: 735b 2747 505f 5072 6f74 5f27 202b 2073  s['GP_Prot_' + s
+0003bb20: 656c 662e 696e 7075 745f 696e 7374 7275  elf.input_instru
+0003bb30: 6d65 6e74 5b33 5d5d 290a 2020 2020 2020  ment[3]]).      
+0003bb40: 2020 656c 6966 2073 656c 662e 6b65 726e    elif self.kern
+0003bb50: 656c 5f6e 616d 6520 3d3d 2027 4365 6c65  el_name == 'Cele
+0003bb60: 7269 7465 5150 4b65 726e 656c 273a 0a20  riteQPKernel':. 
+0003bb70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0003bb80: 7061 7261 6d65 7465 725f 7665 6374 6f72  parameter_vector
+0003bb90: 5b30 5d20 3d20 6e70 2e6c 6f67 280a 2020  [0] = np.log(.  
+0003bba0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0003bbb0: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
+0003bbc0: 4750 5f42 5f27 202b 2073 656c 662e 696e  GP_B_' + self.in
+0003bbd0: 7075 745f 696e 7374 7275 6d65 6e74 5b30  put_instrument[0
+0003bbe0: 5d5d 290a 2020 2020 2020 2020 2020 2020  ]]).            
+0003bbf0: 7365 6c66 2e70 6172 616d 6574 6572 5f76  self.parameter_v
+0003bc00: 6563 746f 725b 315d 203d 206e 702e 6c6f  ector[1] = np.lo
+0003bc10: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
+0003bc20: 2020 2070 6172 616d 6574 6572 5f76 616c     parameter_val
+0003bc30: 7565 735b 2747 505f 4c5f 2720 2b20 7365  ues['GP_L_' + se
+0003bc40: 6c66 2e69 6e70 7574 5f69 6e73 7472 756d  lf.input_instrum
+0003bc50: 656e 745b 315d 5d29 0a20 2020 2020 2020  ent[1]]).       
+0003bc60: 2020 2020 2073 656c 662e 7061 7261 6d65       self.parame
+0003bc70: 7465 725f 7665 6374 6f72 5b32 5d20 3d20  ter_vector[2] = 
+0003bc80: 6e70 2e6c 6f67 280a 2020 2020 2020 2020  np.log(.        
+0003bc90: 2020 2020 2020 2020 7061 7261 6d65 7465          paramete
+0003bca0: 725f 7661 6c75 6573 5b27 4750 5f50 726f  r_values['GP_Pro
+0003bcb0: 745f 2720 2b20 7365 6c66 2e69 6e70 7574  t_' + self.input
+0003bcc0: 5f69 6e73 7472 756d 656e 745b 325d 5d29  _instrument[2]])
+0003bcd0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0003bce0: 662e 7061 7261 6d65 7465 725f 7665 6374  f.parameter_vect
+0003bcf0: 6f72 5b33 5d20 3d20 6e70 2e6c 6f67 280a  or[3] = np.log(.
+0003bd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bd10: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0003bd20: 5b27 4750 5f43 5f27 202b 2073 656c 662e  ['GP_C_' + self.
+0003bd30: 696e 7075 745f 696e 7374 7275 6d65 6e74  input_instrument
+0003bd40: 5b33 5d5d 290a 2020 2020 2020 2020 2020  [3]]).          
+0003bd50: 2020 6966 206e 6f74 2073 656c 662e 676c    if not self.gl
+0003bd60: 6f62 616c 5f47 503a 0a20 2020 2020 2020  obal_GP:.       
+0003bd70: 2020 2020 2020 2020 2073 656c 662e 7061           self.pa
+0003bd80: 7261 6d65 7465 725f 7665 6374 6f72 5b34  rameter_vector[4
+0003bd90: 5d20 3d20 6e70 2e6c 6f67 280a 2020 2020  ] = np.log(.    
+0003bda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bdb0: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0003bdc0: 5b27 7369 676d 615f 775f 2720 2b20 7365  ['sigma_w_' + se
+0003bdd0: 6c66 2e69 6e73 7472 756d 656e 745d 202a  lf.instrument] *
+0003bde0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003bdf0: 2020 2020 2073 656c 662e 7369 676d 615f       self.sigma_
+0003be00: 6661 6374 6f72 290a 2020 2020 2020 2020  factor).        
+0003be10: 656c 6966 2073 656c 662e 6b65 726e 656c  elif self.kernel
+0003be20: 5f6e 616d 6520 3d3d 2027 4365 6c65 7269  _name == 'Celeri
+0003be30: 7465 4578 704b 6572 6e65 6c27 3a0a 2020  teExpKernel':.  
+0003be40: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0003be50: 6172 616d 6574 6572 5f76 6563 746f 725b  arameter_vector[
+0003be60: 305d 203d 206e 702e 6c6f 6728 0a20 2020  0] = np.log(.   
+0003be70: 2020 2020 2020 2020 2020 2020 2070 6172               par
+0003be80: 616d 6574 6572 5f76 616c 7565 735b 2747  ameter_values['G
+0003be90: 505f 7369 676d 615f 2720 2b20 7365 6c66  P_sigma_' + self
+0003bea0: 2e69 6e70 7574 5f69 6e73 7472 756d 656e  .input_instrumen
+0003beb0: 745b 305d 5d29 0a20 2020 2020 2020 2020  t[0]]).         
+0003bec0: 2020 2073 656c 662e 7061 7261 6d65 7465     self.paramete
+0003bed0: 725f 7665 6374 6f72 5b31 5d20 3d20 6e70  r_vector[1] = np
+0003bee0: 2e6c 6f67 280a 2020 2020 2020 2020 2020  .log(.          
+0003bef0: 2020 2020 2020 7061 7261 6d65 7465 725f        parameter_
+0003bf00: 7661 6c75 6573 5b27 4750 5f74 696d 6573  values['GP_times
+0003bf10: 6361 6c65 5f27 202b 2073 656c 662e 696e  cale_' + self.in
+0003bf20: 7075 745f 696e 7374 7275 6d65 6e74 5b31  put_instrument[1
+0003bf30: 5d5d 290a 2020 2020 2020 2020 2020 2020  ]]).            
+0003bf40: 6966 206e 6f74 2073 656c 662e 676c 6f62  if not self.glob
+0003bf50: 616c 5f47 503a 0a20 2020 2020 2020 2020  al_GP:.         
+0003bf60: 2020 2020 2020 2073 656c 662e 7061 7261         self.para
+0003bf70: 6d65 7465 725f 7665 6374 6f72 5b32 5d20  meter_vector[2] 
+0003bf80: 3d20 6e70 2e6c 6f67 280a 2020 2020 2020  = np.log(.      
+0003bf90: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0003bfa0: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
+0003bfb0: 7369 676d 615f 775f 2720 2b20 7365 6c66  sigma_w_' + self
+0003bfc0: 2e69 6e73 7472 756d 656e 745d 202a 0a20  .instrument] *. 
+0003bfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bfe0: 2020 2073 656c 662e 7369 676d 615f 6661     self.sigma_fa
+0003bff0: 6374 6f72 290a 2020 2020 2020 2020 656c  ctor).        el
+0003c000: 6966 2073 656c 662e 6b65 726e 656c 5f6e  if self.kernel_n
+0003c010: 616d 6520 3d3d 2027 4365 6c65 7269 7465  ame == 'Celerite
+0003c020: 4d61 7465 726e 4b65 726e 656c 273a 0a20  MaternKernel':. 
+0003c030: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0003c040: 7061 7261 6d65 7465 725f 7665 6374 6f72  parameter_vector
+0003c050: 5b30 5d20 3d20 6e70 2e6c 6f67 280a 2020  [0] = np.log(.  
+0003c060: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0003c070: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
+0003c080: 4750 5f73 6967 6d61 5f27 202b 2073 656c  GP_sigma_' + sel
+0003c090: 662e 696e 7075 745f 696e 7374 7275 6d65  f.input_instrume
+0003c0a0: 6e74 5b30 5d5d 290a 2020 2020 2020 2020  nt[0]]).        
+0003c0b0: 2020 2020 7365 6c66 2e70 6172 616d 6574      self.paramet
+0003c0c0: 6572 5f76 6563 746f 725b 315d 203d 206e  er_vector[1] = n
+0003c0d0: 702e 6c6f 6728 0a20 2020 2020 2020 2020  p.log(.         
+0003c0e0: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
+0003c0f0: 5f76 616c 7565 735b 2747 505f 7268 6f5f  _values['GP_rho_
+0003c100: 2720 2b20 7365 6c66 2e69 6e70 7574 5f69  ' + self.input_i
+0003c110: 6e73 7472 756d 656e 745b 315d 5d29 0a20  nstrument[1]]). 
+0003c120: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0003c130: 7420 7365 6c66 2e67 6c6f 6261 6c5f 4750  t self.global_GP
+0003c140: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0003c150: 2020 7365 6c66 2e70 6172 616d 6574 6572    self.parameter
+0003c160: 5f76 6563 746f 725b 325d 203d 206e 702e  _vector[2] = np.
+0003c170: 6c6f 6728 0a20 2020 2020 2020 2020 2020  log(.           
+0003c180: 2020 2020 2020 2020 2070 6172 616d 6574           paramet
+0003c190: 6572 5f76 616c 7565 735b 2773 6967 6d61  er_values['sigma
+0003c1a0: 5f77 5f27 202b 2073 656c 662e 696e 7374  _w_' + self.inst
+0003c1b0: 7275 6d65 6e74 5d20 2a0a 2020 2020 2020  rument] *.      
+0003c1c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0003c1d0: 6c66 2e73 6967 6d61 5f66 6163 746f 7229  lf.sigma_factor)
+0003c1e0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+0003c1f0: 6c66 2e6b 6572 6e65 6c5f 6e61 6d65 203d  lf.kernel_name =
+0003c200: 3d20 2743 656c 6572 6974 654d 6174 6572  = 'CeleriteMater
+0003c210: 6e45 7870 4b65 726e 656c 273a 0a20 2020  nExpKernel':.   
+0003c220: 2020 2020 2020 2020 2073 656c 662e 7061           self.pa
+0003c230: 7261 6d65 7465 725f 7665 6374 6f72 5b30  rameter_vector[0
+0003c240: 5d20 3d20 6e70 2e6c 6f67 280a 2020 2020  ] = np.log(.    
+0003c250: 2020 2020 2020 2020 2020 2020 7061 7261              para
+0003c260: 6d65 7465 725f 7661 6c75 6573 5b27 4750  meter_values['GP
+0003c270: 5f73 6967 6d61 5f27 202b 2073 656c 662e  _sigma_' + self.
+0003c280: 696e 7075 745f 696e 7374 7275 6d65 6e74  input_instrument
+0003c290: 5b30 5d5d 290a 2020 2020 2020 2020 2020  [0]]).          
+0003c2a0: 2020 7365 6c66 2e70 6172 616d 6574 6572    self.parameter
+0003c2b0: 5f76 6563 746f 725b 315d 203d 206e 702e  _vector[1] = np.
+0003c2c0: 6c6f 6728 0a20 2020 2020 2020 2020 2020  log(.           
+0003c2d0: 2020 2020 2070 6172 616d 6574 6572 5f76       parameter_v
+0003c2e0: 616c 7565 735b 2747 505f 7469 6d65 7363  alues['GP_timesc
+0003c2f0: 616c 655f 2720 2b20 7365 6c66 2e69 6e70  ale_' + self.inp
+0003c300: 7574 5f69 6e73 7472 756d 656e 745b 315d  ut_instrument[1]
+0003c310: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
+0003c320: 656c 662e 7061 7261 6d65 7465 725f 7665  elf.parameter_ve
+0003c330: 6374 6f72 5b33 5d20 3d20 6e70 2e6c 6f67  ctor[3] = np.log
+0003c340: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003c350: 2020 7061 7261 6d65 7465 725f 7661 6c75    parameter_valu
+0003c360: 6573 5b27 4750 5f72 686f 5f27 202b 2073  es['GP_rho_' + s
+0003c370: 656c 662e 696e 7075 745f 696e 7374 7275  elf.input_instru
+0003c380: 6d65 6e74 5b32 5d5d 290a 2020 2020 2020  ment[2]]).      
+0003c390: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+0003c3a0: 662e 676c 6f62 616c 5f47 503a 0a20 2020  f.global_GP:.   
+0003c3b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0003c3c0: 662e 7061 7261 6d65 7465 725f 7665 6374  f.parameter_vect
+0003c3d0: 6f72 5b34 5d20 3d20 6e70 2e6c 6f67 280a  or[4] = np.log(.
+0003c3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c3f0: 2020 2020 7061 7261 6d65 7465 725f 7661      parameter_va
+0003c400: 6c75 6573 5b27 7369 676d 615f 775f 2720  lues['sigma_w_' 
+0003c410: 2b20 7365 6c66 2e69 6e73 7472 756d 656e  + self.instrumen
+0003c420: 745d 202a 0a20 2020 2020 2020 2020 2020  t] *.           
+0003c430: 2020 2020 2020 2020 2073 656c 662e 7369           self.si
+0003c440: 676d 615f 6661 6374 6f72 290a 2020 2020  gma_factor).    
+0003c450: 2020 2020 656c 6966 2073 656c 662e 6b65      elif self.ke
+0003c460: 726e 656c 5f6e 616d 6520 3d3d 2027 4365  rnel_name == 'Ce
+0003c470: 6c65 7269 7465 5348 4f4b 6572 6e65 6c27  leriteSHOKernel'
+0003c480: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0003c490: 6c66 2e70 6172 616d 6574 6572 5f76 6563  lf.parameter_vec
+0003c4a0: 746f 725b 305d 203d 206e 702e 6c6f 6728  tor[0] = np.log(
+0003c4b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c4c0: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
+0003c4d0: 735b 2747 505f 5330 5f27 202b 2073 656c  s['GP_S0_' + sel
+0003c4e0: 662e 696e 7075 745f 696e 7374 7275 6d65  f.input_instrume
+0003c4f0: 6e74 5b30 5d5d 290a 2020 2020 2020 2020  nt[0]]).        
+0003c500: 2020 2020 7365 6c66 2e70 6172 616d 6574      self.paramet
+0003c510: 6572 5f76 6563 746f 725b 315d 203d 206e  er_vector[1] = n
+0003c520: 702e 6c6f 6728 0a20 2020 2020 2020 2020  p.log(.         
+0003c530: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
+0003c540: 5f76 616c 7565 735b 2747 505f 515f 2720  _values['GP_Q_' 
+0003c550: 2b20 7365 6c66 2e69 6e70 7574 5f69 6e73  + self.input_ins
+0003c560: 7472 756d 656e 745b 315d 5d29 0a20 2020  trument[1]]).   
+0003c570: 2020 2020 2020 2020 2073 656c 662e 7061           self.pa
+0003c580: 7261 6d65 7465 725f 7665 6374 6f72 5b32  rameter_vector[2
+0003c590: 5d20 3d20 6e70 2e6c 6f67 280a 2020 2020  ] = np.log(.    
+0003c5a0: 2020 2020 2020 2020 2020 2020 7061 7261              para
+0003c5b0: 6d65 7465 725f 7661 6c75 6573 5b27 4750  meter_values['GP
+0003c5c0: 5f6f 6d65 6761 305f 2720 2b20 7365 6c66  _omega0_' + self
+0003c5d0: 2e69 6e70 7574 5f69 6e73 7472 756d 656e  .input_instrumen
+0003c5e0: 745b 325d 5d29 0a20 2020 2020 2020 2020  t[2]]).         
+0003c5f0: 2020 200a 2020 2020 2020 2020 2020 2020     .            
+0003c600: 6966 206e 6f74 2073 656c 662e 676c 6f62  if not self.glob
+0003c610: 616c 5f47 503a 0a0a 2020 2020 2020 2020  al_GP:..        
+0003c620: 2020 2020 2020 2020 7365 6c66 2e70 6172          self.par
+0003c630: 616d 6574 6572 5f76 6563 746f 725b 335d  ameter_vector[3]
+0003c640: 203d 206e 702e 6c6f 6728 0a20 2020 2020   = np.log(.     
+0003c650: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0003c660: 6172 616d 6574 6572 5f76 616c 7565 735b  arameter_values[
+0003c670: 2773 6967 6d61 5f77 5f27 202b 2073 656c  'sigma_w_' + sel
+0003c680: 662e 696e 7374 7275 6d65 6e74 5d20 2a0a  f.instrument] *.
+0003c690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c6a0: 2020 2020 7365 6c66 2e73 6967 6d61 5f66      self.sigma_f
+0003c6b0: 6163 746f 7229 0a20 2020 2020 2020 2020  actor).         
+0003c6c0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+0003c6d0: 656c 6966 2073 656c 662e 6b65 726e 656c  elif self.kernel
+0003c6e0: 5f6e 616d 6520 3d3d 2027 4365 6c65 7269  _name == 'Celeri
+0003c6f0: 7465 446f 7562 6c65 5348 4f4b 6572 6e65  teDoubleSHOKerne
+0003c700: 6c27 3a0a 2020 2020 2020 2020 2020 2020  l':.            
+0003c710: 2320 5468 6520 7061 7261 6d65 7472 697a  # The parametriz
+0003c720: 6174 696f 6e20 666f 6c6c 6f77 7320 7468  ation follows th
+0003c730: 6520 2252 6f74 6174 696f 6e54 6572 6d22  e "RotationTerm"
+0003c740: 2069 6d70 6c65 6d65 6e74 6564 2069 6e0a   implemented in.
+0003c750: 2020 2020 2020 2020 2020 2020 2320 6365              # ce
+0003c760: 6c65 7269 7465 3220 6874 7470 733a 2f2f  lerite2 https://
+0003c770: 6365 6c65 7269 7465 322e 7265 6164 7468  celerite2.readth
+0003c780: 6564 6f63 732e 696f 2f65 6e2f 6c61 7465  edocs.io/en/late
+0003c790: 7374 2f61 7069 2f70 7974 686f 6e2f 2363  st/api/python/#c
+0003c7a0: 656c 6572 6974 6532 2e74 6572 6d73 2e52  elerite2.terms.R
+0003c7b0: 6f74 6174 696f 6e54 6572 6d0a 2020 2020  otationTerm.    
+0003c7c0: 2020 2020 2020 2020 7369 676d 6120 3d20          sigma = 
+0003c7d0: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0003c7e0: 5b27 4750 5f73 6967 6d61 5f27 202b 2073  ['GP_sigma_' + s
+0003c7f0: 656c 662e 696e 7075 745f 696e 7374 7275  elf.input_instru
+0003c800: 6d65 6e74 5b30 5d5d 0a20 2020 2020 2020  ment[0]].       
+0003c810: 2020 2020 2051 3020 3d20 7061 7261 6d65       Q0 = parame
+0003c820: 7465 725f 7661 6c75 6573 5b27 4750 5f51  ter_values['GP_Q
+0003c830: 305f 2720 2b20 7365 6c66 2e69 6e70 7574  0_' + self.input
+0003c840: 5f69 6e73 7472 756d 656e 745b 315d 5d0a  _instrument[1]].
+0003c850: 2020 2020 2020 2020 2020 2020 5020 3d20              P = 
+0003c860: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0003c870: 5b27 4750 5f70 6572 696f 645f 2720 2b20  ['GP_period_' + 
+0003c880: 7365 6c66 2e69 6e70 7574 5f69 6e73 7472  self.input_instr
+0003c890: 756d 656e 745b 325d 5d0a 2020 2020 2020  ument[2]].      
+0003c8a0: 2020 2020 2020 6620 3d20 7061 7261 6d65        f = parame
+0003c8b0: 7465 725f 7661 6c75 6573 5b27 4750 5f66  ter_values['GP_f
+0003c8c0: 5f27 202b 2073 656c 662e 696e 7075 745f  _' + self.input_
+0003c8d0: 696e 7374 7275 6d65 6e74 5b33 5d5d 0a20  instrument[3]]. 
+0003c8e0: 2020 2020 2020 2020 2020 2064 5120 3d20             dQ = 
+0003c8f0: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0003c900: 5b27 4750 5f64 515f 2720 2b20 7365 6c66  ['GP_dQ_' + self
+0003c910: 2e69 6e70 7574 5f69 6e73 7472 756d 656e  .input_instrumen
+0003c920: 745b 345d 5d0a 0a20 2020 2020 2020 2020  t[4]]..         
+0003c930: 2020 2051 3120 3d20 3120 2f20 3220 2b20     Q1 = 1 / 2 + 
+0003c940: 5130 202b 2064 510a 2020 2020 2020 2020  Q0 + dQ.        
+0003c950: 2020 2020 6f6d 6567 6131 203d 2034 202a      omega1 = 4 *
+0003c960: 206e 702e 7069 202a 2051 3120 2f20 2850   np.pi * Q1 / (P
+0003c970: 202a 206e 702e 7371 7274 2834 202a 2051   * np.sqrt(4 * Q
+0003c980: 312a 2a32 202d 2031 2929 0a20 2020 2020  1**2 - 1)).     
+0003c990: 2020 2020 2020 2053 3120 3d20 7369 676d         S1 = sigm
+0003c9a0: 612a 2a32 202f 2028 2831 202b 2066 2920  a**2 / ((1 + f) 
+0003c9b0: 2a20 6f6d 6567 6131 202a 2051 3129 0a0a  * omega1 * Q1)..
+0003c9c0: 2020 2020 2020 2020 2020 2020 5132 203d              Q2 =
+0003c9d0: 2031 202f 2032 202b 2051 300a 2020 2020   1 / 2 + Q0.    
+0003c9e0: 2020 2020 2020 2020 6f6d 6567 6132 203d          omega2 =
+0003c9f0: 2038 202a 206e 702e 7069 202a 2051 3120   8 * np.pi * Q1 
+0003ca00: 2f20 2850 202a 206e 702e 7371 7274 2834  / (P * np.sqrt(4
+0003ca10: 202a 2051 312a 2a32 202d 2031 2929 0a20   * Q1**2 - 1)). 
+0003ca20: 2020 2020 2020 2020 2020 2053 3220 3d20             S2 = 
+0003ca30: 6620 2a20 7369 676d 612a 2a32 202f 2028  f * sigma**2 / (
+0003ca40: 2831 202b 2066 2920 2a20 6f6d 6567 6132  (1 + f) * omega2
+0003ca50: 202a 2051 3229 0a0a 2020 2020 2020 2020   * Q2)..        
+0003ca60: 2020 2020 7365 6c66 2e70 6172 616d 6574      self.paramet
+0003ca70: 6572 5f76 6563 746f 725b 305d 203d 206e  er_vector[0] = n
+0003ca80: 702e 6c6f 6728 5331 290a 2020 2020 2020  p.log(S1).      
+0003ca90: 2020 2020 2020 7365 6c66 2e70 6172 616d        self.param
+0003caa0: 6574 6572 5f76 6563 746f 725b 315d 203d  eter_vector[1] =
+0003cab0: 206e 702e 6c6f 6728 5131 290a 2020 2020   np.log(Q1).    
+0003cac0: 2020 2020 2020 2020 7365 6c66 2e70 6172          self.par
+0003cad0: 616d 6574 6572 5f76 6563 746f 725b 325d  ameter_vector[2]
+0003cae0: 203d 206e 702e 6c6f 6728 6f6d 6567 6131   = np.log(omega1
+0003caf0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0003cb00: 6c66 2e70 6172 616d 6574 6572 5f76 6563  lf.parameter_vec
+0003cb10: 746f 725b 335d 203d 206e 702e 6c6f 6728  tor[3] = np.log(
+0003cb20: 5332 290a 2020 2020 2020 2020 2020 2020  S2).            
+0003cb30: 7365 6c66 2e70 6172 616d 6574 6572 5f76  self.parameter_v
+0003cb40: 6563 746f 725b 345d 203d 206e 702e 6c6f  ector[4] = np.lo
+0003cb50: 6728 5132 290a 2020 2020 2020 2020 2020  g(Q2).          
+0003cb60: 2020 7365 6c66 2e70 6172 616d 6574 6572    self.parameter
+0003cb70: 5f76 6563 746f 725b 355d 203d 206e 702e  _vector[5] = np.
+0003cb80: 6c6f 6728 6f6d 6567 6132 290a 0a20 2020  log(omega2)..   
+0003cb90: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0003cba0: 7365 6c66 2e67 6c6f 6261 6c5f 4750 3a0a  self.global_GP:.
+0003cbb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003cbc0: 2073 656c 662e 7061 7261 6d65 7465 725f   self.parameter_
+0003cbd0: 7665 6374 6f72 5b36 5d20 3d20 6e70 2e6c  vector[6] = np.l
+0003cbe0: 6f67 280a 2020 2020 2020 2020 2020 2020  og(.            
+0003cbf0: 2020 2020 2020 2020 7061 7261 6d65 7465          paramete
+0003cc00: 725f 7661 6c75 6573 5b27 7369 676d 615f  r_values['sigma_
+0003cc10: 775f 2720 2b20 7365 6c66 2e69 6e73 7472  w_' + self.instr
+0003cc20: 756d 656e 745d 202a 0a20 2020 2020 2020  ument] *.       
+0003cc30: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0003cc40: 662e 7369 676d 615f 6661 6374 6f72 290a  f.sigma_factor).
+0003cc50: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+0003cc60: 6c66 2e6b 6572 6e65 6c5f 6e61 6d65 203d  lf.kernel_name =
+0003cc70: 3d20 2743 656c 6572 6974 6554 7269 706c  = 'CeleriteTripl
+0003cc80: 6553 484f 4b65 726e 656c 273a 0a20 2020  eSHOKernel':.   
+0003cc90: 2020 2020 2020 2020 2073 656c 662e 7061           self.pa
+0003cca0: 7261 6d65 7465 725f 7665 6374 6f72 5b30  rameter_vector[0
+0003ccb0: 5d20 3d20 6e70 2e6c 6f67 280a 2020 2020  ] = np.log(.    
+0003ccc0: 2020 2020 2020 2020 2020 2020 7061 7261              para
+0003ccd0: 6d65 7465 725f 7661 6c75 6573 5b27 4750  meter_values['GP
+0003cce0: 5f53 305f 2720 2b20 7365 6c66 2e69 6e70  _S0_' + self.inp
+0003ccf0: 7574 5f69 6e73 7472 756d 656e 745b 305d  ut_instrument[0]
+0003cd00: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
+0003cd10: 656c 662e 7061 7261 6d65 7465 725f 7665  elf.parameter_ve
+0003cd20: 6374 6f72 5b31 5d20 3d20 6e70 2e6c 6f67  ctor[1] = np.log
+0003cd30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003cd40: 2020 7061 7261 6d65 7465 725f 7661 6c75    parameter_valu
+0003cd50: 6573 5b27 4750 5f51 305f 2720 2b20 7365  es['GP_Q0_' + se
+0003cd60: 6c66 2e69 6e70 7574 5f69 6e73 7472 756d  lf.input_instrum
+0003cd70: 656e 745b 315d 5d29 0a20 2020 2020 2020  ent[1]]).       
+0003cd80: 2020 2020 2073 656c 662e 7061 7261 6d65       self.parame
+0003cd90: 7465 725f 7665 6374 6f72 5b32 5d20 3d20  ter_vector[2] = 
+0003cda0: 6e70 2e6c 6f67 280a 2020 2020 2020 2020  np.log(.        
+0003cdb0: 2020 2020 2020 2020 3220 2a20 6e70 2e70          2 * np.p
+0003cdc0: 6920 2f0a 2020 2020 2020 2020 2020 2020  i /.            
+0003cdd0: 2020 2020 7061 7261 6d65 7465 725f 7661      parameter_va
+0003cde0: 6c75 6573 5b27 4750 5f70 6572 696f 645f  lues['GP_period_
+0003cdf0: 2720 2b20 7365 6c66 2e69 6e70 7574 5f69  ' + self.input_i
+0003ce00: 6e73 7472 756d 656e 745b 325d 5d29 0a20  nstrument[2]]). 
+0003ce10: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0003ce20: 7061 7261 6d65 7465 725f 7665 6374 6f72  parameter_vector
+0003ce30: 5b33 5d20 3d20 6e70 2e6c 6f67 280a 2020  [3] = np.log(.  
+0003ce40: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0003ce50: 7261 6d65 7465 725f 7661 6c75 6573 5b27  rameter_values['
+0003ce60: 4750 5f66 5f27 202b 2073 656c 662e 696e  GP_f_' + self.in
+0003ce70: 7075 745f 696e 7374 7275 6d65 6e74 5b33  put_instrument[3
+0003ce80: 5d5d 202a 0a20 2020 2020 2020 2020 2020  ]] *.           
+0003ce90: 2020 2020 2070 6172 616d 6574 6572 5f76       parameter_v
+0003cea0: 616c 7565 735b 2747 505f 5330 5f27 202b  alues['GP_S0_' +
+0003ceb0: 2073 656c 662e 696e 7075 745f 696e 7374   self.input_inst
+0003cec0: 7275 6d65 6e74 5b30 5d5d 290a 2020 2020  rument[0]]).    
+0003ced0: 2020 2020 2020 2020 7365 6c66 2e70 6172          self.par
+0003cee0: 616d 6574 6572 5f76 6563 746f 725b 345d  ameter_vector[4]
+0003cef0: 203d 206e 702e 6c6f 6728 0a20 2020 2020   = np.log(.     
+0003cf00: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0003cf10: 6574 6572 5f76 616c 7565 735b 2747 505f  eter_values['GP_
+0003cf20: 5130 5f27 202b 2073 656c 662e 696e 7075  Q0_' + self.inpu
+0003cf30: 745f 696e 7374 7275 6d65 6e74 5b31 5d5d  t_instrument[1]]
+0003cf40: 202d 0a20 2020 2020 2020 2020 2020 2020   -.             
+0003cf50: 2020 2070 6172 616d 6574 6572 5f76 616c     parameter_val
+0003cf60: 7565 735b 2747 505f 6451 5f27 202b 2073  ues['GP_dQ_' + s
+0003cf70: 656c 662e 696e 7075 745f 696e 7374 7275  elf.input_instru
+0003cf80: 6d65 6e74 5b34 5d5d 290a 2020 2020 2020  ment[4]]).      
+0003cf90: 2020 2020 2020 7365 6c66 2e70 6172 616d        self.param
+0003cfa0: 6574 6572 5f76 6563 746f 725b 355d 203d  eter_vector[5] =
+0003cfb0: 206e 702e 6c6f 6728 0a20 2020 2020 2020   np.log(.       
+0003cfc0: 2020 2020 2020 2020 206e 702e 7069 202f           np.pi /
+0003cfd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003cfe0: 2070 6172 616d 6574 6572 5f76 616c 7565   parameter_value
+0003cff0: 735b 2747 505f 7065 7269 6f64 5f27 202b  s['GP_period_' +
+0003d000: 2073 656c 662e 696e 7075 745f 696e 7374   self.input_inst
+0003d010: 7275 6d65 6e74 5b32 5d5d 290a 2020 2020  rument[2]]).    
+0003d020: 2020 2020 2020 2020 7365 6c66 2e70 6172          self.par
+0003d030: 616d 6574 6572 5f76 6563 746f 725b 365d  ameter_vector[6]
+0003d040: 203d 206e 702e 6c6f 6728 0a20 2020 2020   = np.log(.     
+0003d050: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0003d060: 6574 6572 5f76 616c 7565 735b 2747 505f  eter_values['GP_
+0003d070: 5330 7363 5f27 202b 2073 656c 662e 696e  S0sc_' + self.in
+0003d080: 7075 745f 696e 7374 7275 6d65 6e74 5b35  put_instrument[5
+0003d090: 5d5d 290a 2020 2020 2020 2020 2020 2020  ]]).            
+0003d0a0: 7365 6c66 2e70 6172 616d 6574 6572 5f76  self.parameter_v
+0003d0b0: 6563 746f 725b 375d 203d 206e 702e 6c6f  ector[7] = np.lo
+0003d0c0: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
+0003d0d0: 2020 2070 6172 616d 6574 6572 5f76 616c     parameter_val
+0003d0e0: 7565 735b 2747 505f 6f6d 6567 6130 7363  ues['GP_omega0sc
+0003d0f0: 5f27 202b 2073 656c 662e 696e 7075 745f  _' + self.input_
+0003d100: 696e 7374 7275 6d65 6e74 5b36 5d5d 290a  instrument[6]]).
+0003d110: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0003d120: 6e6f 7420 7365 6c66 2e67 6c6f 6261 6c5f  not self.global_
+0003d130: 4750 3a0a 2020 2020 2020 2020 2020 2020  GP:.            
+0003d140: 2020 2020 7365 6c66 2e70 6172 616d 6574      self.paramet
+0003d150: 6572 5f76 6563 746f 725b 385d 203d 206e  er_vector[8] = n
+0003d160: 702e 6c6f 6728 0a20 2020 2020 2020 2020  p.log(.         
+0003d170: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0003d180: 6574 6572 5f76 616c 7565 735b 2773 6967  eter_values['sig
+0003d190: 6d61 5f77 5f27 202b 2073 656c 662e 696e  ma_w_' + self.in
+0003d1a0: 7374 7275 6d65 6e74 5d20 2a0a 2020 2020  strument] *.    
+0003d1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d1c0: 7365 6c66 2e73 6967 6d61 5f66 6163 746f  self.sigma_facto
+0003d1d0: 7229 0a20 2020 2020 2020 200a 2020 2020  r).        .    
+0003d1e0: 2020 2020 2320 466f 7220 4d61 7465 726e      # For Matern
+0003d1f0: 2b53 484f 206b 6572 6e65 6c0a 2020 2020  +SHO kernel.    
+0003d200: 2020 2020 656c 6966 2073 656c 662e 6b65      elif self.ke
+0003d210: 726e 656c 5f6e 616d 6520 3d3d 2027 4365  rnel_name == 'Ce
+0003d220: 6c65 7269 7465 4d61 7465 726e 5348 4f4b  leriteMaternSHOK
+0003d230: 6572 6e65 6c27 3a0a 2020 2020 2020 2020  ernel':.        
+0003d240: 2020 2020 7365 6c66 2e70 6172 616d 6574      self.paramet
+0003d250: 6572 5f76 6563 746f 725b 305d 203d 206e  er_vector[0] = n
+0003d260: 702e 6c6f 6728 7061 7261 6d65 7465 725f  p.log(parameter_
+0003d270: 7661 6c75 6573 5b27 4750 5f73 6967 6d61  values['GP_sigma
+0003d280: 5f27 2b73 656c 662e 696e 7075 745f 696e  _'+self.input_in
+0003d290: 7374 7275 6d65 6e74 5b30 5d5d 290a 2020  strument[0]]).  
+0003d2a0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0003d2b0: 6172 616d 6574 6572 5f76 6563 746f 725b  arameter_vector[
+0003d2c0: 315d 203d 206e 702e 6c6f 6728 7061 7261  1] = np.log(para
+0003d2d0: 6d65 7465 725f 7661 6c75 6573 5b27 4750  meter_values['GP
+0003d2e0: 5f72 686f 5f27 2b73 656c 662e 696e 7075  _rho_'+self.inpu
+0003d2f0: 745f 696e 7374 7275 6d65 6e74 5b31 5d5d  t_instrument[1]]
+0003d300: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0003d310: 6c66 2e70 6172 616d 6574 6572 5f76 6563  lf.parameter_vec
+0003d320: 746f 725b 325d 203d 206e 702e 6c6f 6728  tor[2] = np.log(
+0003d330: 7061 7261 6d65 7465 725f 7661 6c75 6573  parameter_values
+0003d340: 5b27 4750 5f53 305f 272b 7365 6c66 2e69  ['GP_S0_'+self.i
+0003d350: 6e70 7574 5f69 6e73 7472 756d 656e 745b  nput_instrument[
+0003d360: 325d 5d29 0a20 2020 2020 2020 2020 2020  2]]).           
+0003d370: 2073 656c 662e 7061 7261 6d65 7465 725f   self.parameter_
+0003d380: 7665 6374 6f72 5b33 5d20 3d20 6e70 2e6c  vector[3] = np.l
+0003d390: 6f67 2870 6172 616d 6574 6572 5f76 616c  og(parameter_val
+0003d3a0: 7565 735b 2747 505f 515f 272b 7365 6c66  ues['GP_Q_'+self
+0003d3b0: 2e69 6e70 7574 5f69 6e73 7472 756d 656e  .input_instrumen
+0003d3c0: 745b 335d 5d29 0a20 2020 2020 2020 2020  t[3]]).         
+0003d3d0: 2020 2073 656c 662e 7061 7261 6d65 7465     self.paramete
+0003d3e0: 725f 7665 6374 6f72 5b34 5d20 3d20 6e70  r_vector[4] = np
+0003d3f0: 2e6c 6f67 2870 6172 616d 6574 6572 5f76  .log(parameter_v
+0003d400: 616c 7565 735b 2747 505f 6f6d 6567 6130  alues['GP_omega0
+0003d410: 5f27 2b73 656c 662e 696e 7075 745f 696e  _'+self.input_in
+0003d420: 7374 7275 6d65 6e74 5b34 5d5d 290a 2020  strument[4]]).  
+0003d430: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0003d440: 2073 656c 662e 676c 6f62 616c 5f47 503a   self.global_GP:
+0003d450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003d460: 2073 656c 662e 7061 7261 6d65 7465 725f   self.parameter_
+0003d470: 7665 6374 6f72 5b35 5d20 3d20 6e70 2e6c  vector[5] = np.l
+0003d480: 6f67 2870 6172 616d 6574 6572 5f76 616c  og(parameter_val
+0003d490: 7565 735b 2773 6967 6d61 5f77 5f27 2b73  ues['sigma_w_'+s
+0003d4a0: 656c 662e 696e 7374 7275 6d65 6e74 5d2a  elf.instrument]*
+0003d4b0: 7365 6c66 2e73 6967 6d61 5f66 6163 746f  self.sigma_facto
+0003d4c0: 7229 0a20 2020 2020 2020 2020 2020 2020  r).             
+0003d4d0: 2020 200a 2020 2020 2020 2020 7365 6c66     .        self
+0003d4e0: 2e47 502e 7365 745f 7061 7261 6d65 7465  .GP.set_paramete
+0003d4f0: 725f 7665 6374 6f72 2873 656c 662e 7061  r_vector(self.pa
+0003d500: 7261 6d65 7465 725f 7665 6374 6f72 290a  rameter_vector).
+0003d510: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+0003d520: 5f28 7365 6c66 2c0a 2020 2020 2020 2020  _(self,.        
+0003d530: 2020 2020 2020 2020 2064 6174 612c 0a20           data,. 
+0003d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d550: 6d6f 6465 6c5f 7479 7065 2c0a 2020 2020  model_type,.    
+0003d560: 2020 2020 2020 2020 2020 2020 2069 6e73               ins
+0003d570: 7472 756d 656e 742c 0a20 2020 2020 2020  trument,.       
+0003d580: 2020 2020 2020 2020 2020 6765 6f72 6765            george
+0003d590: 5f68 6f64 6c72 3d54 7275 652c 0a20 2020  _hodlr=True,.   
+0003d5a0: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+0003d5b0: 7465 726e 5f65 7073 3d30 2e30 3129 3a0a  tern_eps=0.01):.
+0003d5c0: 2020 2020 2020 2020 7365 6c66 2e69 7349          self.isI
+0003d5d0: 6e69 7420 3d20 4661 6c73 650a 2020 2020  nit = False.    
+0003d5e0: 2020 2020 7365 6c66 2e6d 6f64 656c 5f74      self.model_t
+0003d5f0: 7970 6520 3d20 6d6f 6465 6c5f 7479 7065  ype = model_type
+0003d600: 2e6c 6f77 6572 2829 0a20 2020 2020 2020  .lower().       
+0003d610: 2023 2050 6572 666f 726d 2063 6861 6e67   # Perform chang
+0003d620: 6573 2074 6861 7420 6465 6669 6e65 2074  es that define t
+0003d630: 6865 206d 6f64 656c 5f74 7970 652e 2046  he model_type. F
+0003d640: 6f72 2065 7861 6d70 6c65 2c20 7468 6520  or example, the 
+0003d650: 6a75 6c69 6574 2069 6e70 7574 2073 6967  juliet input sig
+0003d660: 6d61 7320 2862 6f74 6820 6a69 7474 6572  mas (both jitter
+0003d670: 7320 616e 6420 4750 2061 6d70 6c69 7475  s and GP amplitu
+0003d680: 6465 7329 2061 7265 0a20 2020 2020 2020  des) are.       
+0003d690: 2023 2067 6976 656e 2069 6e20 7070 6d20   # given in ppm 
+0003d6a0: 696e 2074 6865 2069 6e70 7574 2066 696c  in the input fil
+0003d6b0: 6573 2c20 7768 6572 6561 7320 666f 7220  es, whereas for 
+0003d6c0: 5256 7320 7468 6579 2068 6176 6520 7468  RVs they have th
+0003d6d0: 6520 7361 6d65 2075 6e69 7473 2061 7320  e same units as 
+0003d6e0: 7468 6520 696e 7075 7420 5256 732e 2054  the input RVs. T
+0003d6f0: 6869 7320 636f 6e76 6572 7369 6f6e 2066  his conversion f
+0003d700: 6163 746f 7220 6973 0a20 2020 2020 2020  actor is.       
+0003d710: 2023 2064 6566 696e 6564 2062 7920 7468   # defined by th
+0003d720: 6520 6d6f 6465 6c5f 7479 7065 3a0a 2020  e model_type:.  
+0003d730: 2020 2020 2020 6966 2073 656c 662e 6d6f        if self.mo
+0003d740: 6465 6c5f 7479 7065 203d 3d20 276c 6327  del_type == 'lc'
+0003d750: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0003d760: 2069 6e73 7472 756d 656e 7420 6973 204e   instrument is N
+0003d770: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0003d780: 2020 2020 2069 6e73 7472 756d 656e 7420       instrument 
+0003d790: 3d20 276c 6327 0a20 2020 2020 2020 2020  = 'lc'.         
+0003d7a0: 2020 2073 656c 662e 7369 676d 615f 6661     self.sigma_fa
+0003d7b0: 6374 6f72 203d 2031 652d 360a 2020 2020  ctor = 1e-6.    
+0003d7c0: 2020 2020 656c 6966 2073 656c 662e 6d6f      elif self.mo
+0003d7d0: 6465 6c5f 7479 7065 203d 3d20 2772 7627  del_type == 'rv'
+0003d7e0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0003d7f0: 2069 6e73 7472 756d 656e 7420 6973 204e   instrument is N
+0003d800: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0003d810: 2020 2020 2069 6e73 7472 756d 656e 7420       instrument 
+0003d820: 3d20 2772 7627 0a20 2020 2020 2020 2020  = 'rv'.         
+0003d830: 2020 2073 656c 662e 7369 676d 615f 6661     self.sigma_fa
+0003d840: 6374 6f72 203d 2031 2e0a 2020 2020 2020  ctor = 1..      
+0003d850: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0003d860: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
+0003d870: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+0003d880: 2020 2020 2027 4d6f 6465 6c20 7479 7065       'Model type
+0003d890: 2027 202b 206d 6f64 656c 5f74 7970 6520   ' + model_type 
+0003d8a0: 2b0a 2020 2020 2020 2020 2020 2020 2020  +.              
+0003d8b0: 2020 2720 6375 7272 656e 746c 7920 6e6f    ' currently no
+0003d8c0: 7420 7375 7070 6f72 7465 642e 204f 6e6c  t supported. Onl
+0003d8d0: 7920 226c 6322 206f 7220 2272 7622 2063  y "lc" or "rv" c
+0003d8e0: 616e 2073 6572 7665 2061 7320 696e 7075  an serve as inpu
+0003d8f0: 7473 2066 6f72 206e 6f77 2e27 0a20 2020  ts for now.'.   
+0003d900: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0003d910: 2020 2020 2320 4e61 6d65 206f 6620 696e      # Name of in
+0003d920: 7075 7420 696e 7374 7275 6d65 6e74 2069  put instrument i
+0003d930: 6620 6769 7665 6e3a 0a20 2020 2020 2020  f given:.       
+0003d940: 2073 656c 662e 696e 7374 7275 6d65 6e74   self.instrument
+0003d950: 203d 2069 6e73 7472 756d 656e 740a 0a20   = instrument.. 
+0003d960: 2020 2020 2020 2023 2049 6e69 7469 616c         # Initial
+0003d970: 697a 6520 676c 6f62 616c 206d 6f64 656c  ize global model
+0003d980: 2076 6172 6961 626c 653a 0a20 2020 2020   variable:.     
+0003d990: 2020 2073 656c 662e 676c 6f62 616c 5f47     self.global_G
+0003d9a0: 5020 3d20 4661 6c73 650a 0a20 2020 2020  P = False..     
+0003d9b0: 2020 2023 2045 7874 7261 6374 2069 6e66     # Extract inf
+0003d9c0: 6f72 6d61 7469 6f6e 2066 726f 6d20 7468  ormation from th
+0003d9d0: 6520 6461 7461 206f 626a 6563 743a 0a20  e data object:. 
+0003d9e0: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
+0003d9f0: 6f64 656c 5f74 7970 6520 3d3d 2027 6c63  odel_type == 'lc
+0003da00: 273a 0a20 2020 2020 2020 2020 2020 2023  ':.            #
+0003da10: 2053 6176 6520 696e 7075 7420 7072 6564   Save input pred
+0003da20: 6963 746f 723a 0a20 2020 2020 2020 2020  ictor:.         
+0003da30: 2020 2069 6620 696e 7374 7275 6d65 6e74     if instrument
+0003da40: 203d 3d20 276c 6327 3a0a 2020 2020 2020   == 'lc':.      
+0003da50: 2020 2020 2020 2020 2020 7365 6c66 2e58            self.X
+0003da60: 203d 2064 6174 612e 4750 5f6c 635f 6172   = data.GP_lc_ar
+0003da70: 6775 6d65 6e74 735b 276c 6327 5d0a 2020  guments['lc'].  
+0003da80: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0003da90: 6c66 2e67 6c6f 6261 6c5f 4750 203d 2054  lf.global_GP = T
+0003daa0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+0003dab0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0003dac0: 2020 2020 2020 7365 6c66 2e58 203d 2064        self.X = d
+0003dad0: 6174 612e 4750 5f6c 635f 6172 6775 6d65  ata.GP_lc_argume
+0003dae0: 6e74 735b 696e 7374 7275 6d65 6e74 5d0a  nts[instrument].
+0003daf0: 2020 2020 2020 2020 2020 2020 2320 5361              # Sa
+0003db00: 7665 2065 7272 6f72 7320 2869 6620 616e  ve errors (if an
+0003db10: 7929 3a0a 2020 2020 2020 2020 2020 2020  y):.            
+0003db20: 6966 2064 6174 612e 7965 7272 5f6c 6320  if data.yerr_lc 
+0003db30: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0003db40: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0003db50: 696e 7374 7275 6d65 6e74 2021 3d20 276c  instrument != 'l
+0003db60: 6327 3a0a 2020 2020 2020 2020 2020 2020  c':.            
+0003db70: 2020 2020 2020 2020 7365 6c66 2e79 6572          self.yer
+0003db80: 7220 3d20 6461 7461 2e79 6572 725f 6c63  r = data.yerr_lc
+0003db90: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+0003dba0: 2020 2020 2020 2020 2020 6461 7461 2e69            data.i
+0003dbb0: 6e73 7472 756d 656e 745f 696e 6465 7865  nstrument_indexe
+0003dbc0: 735f 6c63 5b69 6e73 7472 756d 656e 745d  s_lc[instrument]
+0003dbd0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0003dbe0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0003dbf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0003dc00: 2e79 6572 7220 3d20 6461 7461 2e79 6572  .yerr = data.yer
+0003dc10: 725f 6c63 0a20 2020 2020 2020 2020 2020  r_lc.           
+0003dc20: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0003dc30: 2020 2020 2020 2073 656c 662e 7965 7272         self.yerr
+0003dc40: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+0003dc50: 656c 6966 2073 656c 662e 6d6f 6465 6c5f  elif self.model_
+0003dc60: 7479 7065 203d 3d20 2772 7627 3a0a 2020  type == 'rv':.  
+0003dc70: 2020 2020 2020 2020 2020 2320 5361 7665            # Save
+0003dc80: 2069 6e70 7574 2070 7265 6469 6374 6f72   input predictor
+0003dc90: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0003dca0: 2069 6e73 7472 756d 656e 7420 3d3d 2027   instrument == '
+0003dcb0: 7276 273a 0a20 2020 2020 2020 2020 2020  rv':.           
+0003dcc0: 2020 2020 2073 656c 662e 5820 3d20 6461       self.X = da
+0003dcd0: 7461 2e47 505f 7276 5f61 7267 756d 656e  ta.GP_rv_argumen
+0003dce0: 7473 5b27 7276 275d 0a20 2020 2020 2020  ts['rv'].       
+0003dcf0: 2020 2020 2020 2020 2073 656c 662e 676c           self.gl
+0003dd00: 6f62 616c 5f47 5020 3d20 5472 7565 0a20  obal_GP = True. 
+0003dd10: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0003dd20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003dd30: 2073 656c 662e 5820 3d20 6461 7461 2e47   self.X = data.G
+0003dd40: 505f 7276 5f61 7267 756d 656e 7473 5b69  P_rv_arguments[i
+0003dd50: 6e73 7472 756d 656e 745d 0a20 2020 2020  nstrument].     
+0003dd60: 2020 2020 2020 2023 2053 6176 6520 6572         # Save er
+0003dd70: 726f 7273 2028 6966 2061 6e79 293a 0a20  rors (if any):. 
+0003dd80: 2020 2020 2020 2020 2020 2069 6620 6461             if da
+0003dd90: 7461 2e79 6572 725f 7276 2069 7320 6e6f  ta.yerr_rv is no
+0003dda0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0003ddb0: 2020 2020 2020 2020 6966 2069 6e73 7472          if instr
+0003ddc0: 756d 656e 7420 213d 2027 7276 273a 0a20  ument != 'rv':. 
+0003ddd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dde0: 2020 2073 656c 662e 7965 7272 203d 2064     self.yerr = d
+0003ddf0: 6174 612e 7965 7272 5f72 765b 0a20 2020  ata.yerr_rv[.   
+0003de00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003de10: 2020 2020 2064 6174 612e 696e 7374 7275       data.instru
+0003de20: 6d65 6e74 5f69 6e64 6578 6573 5f72 765b  ment_indexes_rv[
+0003de30: 696e 7374 7275 6d65 6e74 5d5d 0a20 2020  instrument]].   
+0003de40: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0003de50: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0003de60: 2020 2020 2020 2073 656c 662e 7965 7272         self.yerr
+0003de70: 203d 2064 6174 612e 7965 7272 5f72 760a   = data.yerr_rv.
+0003de80: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0003de90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0003dea0: 2020 7365 6c66 2e79 6572 7220 3d20 4e6f    self.yerr = No
+0003deb0: 6e65 0a0a 2020 2020 2020 2020 2320 4669  ne..        # Fi
+0003dec0: 7820 7369 7a65 7320 6f66 2072 6567 7265  x sizes of regre
+0003ded0: 7373 6f72 7320 6966 2077 726f 6e67 3a0a  ssors if wrong:.
+0003dee0: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+0003def0: 656c 662e 582e 7368 6170 6529 203d 3d20  elf.X.shape) == 
+0003df00: 323a 0a20 2020 2020 2020 2020 2020 2069  2:.            i
+0003df10: 6620 7365 6c66 2e58 2e73 6861 7065 5b31  f self.X.shape[1
+0003df20: 5d20 213d 2031 3a0a 2020 2020 2020 2020  ] != 1:.        
+0003df30: 2020 2020 2020 2020 7365 6c66 2e6e 5820          self.nX 
+0003df40: 3d20 7365 6c66 2e58 2e73 6861 7065 5b31  = self.X.shape[1
+0003df50: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
+0003df60: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0003df70: 2020 2020 7365 6c66 2e58 203d 2073 656c      self.X = sel
+0003df80: 662e 585b 3a2c 2030 5d0a 2020 2020 2020  f.X[:, 0].      
+0003df90: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
+0003dfa0: 5820 3d20 310a 2020 2020 2020 2020 656c  X = 1.        el
+0003dfb0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0003dfc0: 7365 6c66 2e6e 5820 3d20 310a 0a20 2020  self.nX = 1..   
+0003dfd0: 2020 2020 2023 2044 6566 696e 6520 616c       # Define al
+0003dfe0: 6c20 706f 7373 6962 6c65 206b 6572 6e65  l possible kerne
+0003dff0: 6c73 2061 7661 696c 6162 6c65 2062 7920  ls available by 
+0003e000: 7468 6520 6f62 6a65 6374 3a0a 2020 2020  the object:.    
+0003e010: 2020 2020 7365 6c66 2e61 6c6c 5f6b 6572      self.all_ker
+0003e020: 6e65 6c5f 7661 7269 6162 6c65 7320 3d20  nel_variables = 
+0003e030: 7b7d 0a20 2020 2020 2020 2073 656c 662e  {}.        self.
+0003e040: 616c 6c5f 6b65 726e 656c 5f76 6172 6961  all_kernel_varia
+0003e050: 626c 6573 5b27 5345 4b65 726e 656c 275d  bles['SEKernel']
+0003e060: 203d 205b 2773 6967 6d61 275d 0a20 2020   = ['sigma'].   
+0003e070: 2020 2020 2073 656c 662e 616c 6c5f 6b65       self.all_ke
+0003e080: 726e 656c 5f76 6172 6961 626c 6573 5b27  rnel_variables['
+0003e090: 4d33 324b 6572 6e65 6c27 5d20 3d20 5b27  M32Kernel'] = ['
+0003e0a0: 7369 676d 6127 5d0a 2020 2020 2020 2020  sigma'].        
+0003e0b0: 666f 7220 6920 696e 2072 616e 6765 2873  for i in range(s
+0003e0c0: 656c 662e 6e58 293a 0a20 2020 2020 2020  elf.nX):.       
+0003e0d0: 2020 2020 2073 656c 662e 616c 6c5f 6b65       self.all_ke
+0003e0e0: 726e 656c 5f76 6172 6961 626c 6573 5b27  rnel_variables['
+0003e0f0: 5345 4b65 726e 656c 275d 203d 2073 656c  SEKernel'] = sel
+0003e100: 662e 616c 6c5f 6b65 726e 656c 5f76 6172  f.all_kernel_var
+0003e110: 6961 626c 6573 5b0a 2020 2020 2020 2020  iables[.        
+0003e120: 2020 2020 2020 2020 2753 454b 6572 6e65          'SEKerne
+0003e130: 6c27 5d20 2b20 5b27 616c 7068 6127 202b  l'] + ['alpha' +
+0003e140: 2073 7472 2869 295d 0a20 2020 2020 2020   str(i)].       
+0003e150: 2020 2020 2073 656c 662e 616c 6c5f 6b65       self.all_ke
+0003e160: 726e 656c 5f76 6172 6961 626c 6573 5b27  rnel_variables['
+0003e170: 4d33 324b 6572 6e65 6c27 5d20 3d20 7365  M32Kernel'] = se
+0003e180: 6c66 2e61 6c6c 5f6b 6572 6e65 6c5f 7661  lf.all_kernel_va
+0003e190: 7269 6162 6c65 735b 0a20 2020 2020 2020  riables[.       
+0003e1a0: 2020 2020 2020 2020 2027 4d33 324b 6572           'M32Ker
+0003e1b0: 6e65 6c27 5d20 2b20 5b27 6d61 6c70 6861  nel'] + ['malpha
+0003e1c0: 2720 2b20 7374 7228 6929 5d0a 2020 2020  ' + str(i)].    
+0003e1d0: 2020 2020 7365 6c66 2e61 6c6c 5f6b 6572      self.all_ker
+0003e1e0: 6e65 6c5f 7661 7269 6162 6c65 735b 2745  nel_variables['E
+0003e1f0: 7870 5369 6e65 5371 7561 7265 6453 454b  xpSineSquaredSEK
+0003e200: 6572 6e65 6c27 5d20 3d20 5b0a 2020 2020  ernel'] = [.    
+0003e210: 2020 2020 2020 2020 2773 6967 6d61 272c          'sigma',
+0003e220: 2027 616c 7068 6127 2c20 2747 616d 6d61   'alpha', 'Gamma
+0003e230: 272c 2027 5072 6f74 270a 2020 2020 2020  ', 'Prot'.      
+0003e240: 2020 5d0a 2020 2020 2020 2020 7365 6c66    ].        self
+0003e250: 2e61 6c6c 5f6b 6572 6e65 6c5f 7661 7269  .all_kernel_vari
+0003e260: 6162 6c65 735b 2743 656c 6572 6974 6551  ables['CeleriteQ
+0003e270: 504b 6572 6e65 6c27 5d20 3d20 5b27 4227  PKernel'] = ['B'
+0003e280: 2c20 274c 272c 2027 5072 6f74 272c 2027  , 'L', 'Prot', '
+0003e290: 4327 5d0a 2020 2020 2020 2020 7365 6c66  C'].        self
+0003e2a0: 2e61 6c6c 5f6b 6572 6e65 6c5f 7661 7269  .all_kernel_vari
+0003e2b0: 6162 6c65 735b 2743 656c 6572 6974 6545  ables['CeleriteE
+0003e2c0: 7870 4b65 726e 656c 275d 203d 205b 2773  xpKernel'] = ['s
+0003e2d0: 6967 6d61 272c 2027 7469 6d65 7363 616c  igma', 'timescal
+0003e2e0: 6527 5d0a 2020 2020 2020 2020 7365 6c66  e'].        self
+0003e2f0: 2e61 6c6c 5f6b 6572 6e65 6c5f 7661 7269  .all_kernel_vari
+0003e300: 6162 6c65 735b 2743 656c 6572 6974 654d  ables['CeleriteM
+0003e310: 6174 6572 6e4b 6572 6e65 6c27 5d20 3d20  aternKernel'] = 
+0003e320: 5b27 7369 676d 6127 2c20 2772 686f 275d  ['sigma', 'rho']
+0003e330: 0a20 2020 2020 2020 2073 656c 662e 616c  .        self.al
+0003e340: 6c5f 6b65 726e 656c 5f76 6172 6961 626c  l_kernel_variabl
+0003e350: 6573 5b27 4365 6c65 7269 7465 4d61 7465  es['CeleriteMate
+0003e360: 726e 4578 704b 6572 6e65 6c27 5d20 3d20  rnExpKernel'] = 
+0003e370: 5b0a 2020 2020 2020 2020 2020 2020 2773  [.            's
+0003e380: 6967 6d61 272c 2027 7469 6d65 7363 616c  igma', 'timescal
+0003e390: 6527 2c20 2772 686f 270a 2020 2020 2020  e', 'rho'.      
+0003e3a0: 2020 5d0a 2020 2020 2020 2020 7365 6c66    ].        self
+0003e3b0: 2e61 6c6c 5f6b 6572 6e65 6c5f 7661 7269  .all_kernel_vari
+0003e3c0: 6162 6c65 735b 2743 656c 6572 6974 6553  ables['CeleriteS
+0003e3d0: 484f 4b65 726e 656c 275d 203d 205b 2753  HOKernel'] = ['S
+0003e3e0: 3027 2c20 2751 272c 2027 6f6d 6567 6130  0', 'Q', 'omega0
+0003e3f0: 275d 0a20 2020 2020 2020 2073 656c 662e  '].        self.
+0003e400: 616c 6c5f 6b65 726e 656c 5f76 6172 6961  all_kernel_varia
+0003e410: 626c 6573 5b27 4365 6c65 7269 7465 446f  bles['CeleriteDo
+0003e420: 7562 6c65 5348 4f4b 6572 6e65 6c27 5d20  ubleSHOKernel'] 
+0003e430: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
+0003e440: 2773 6967 6d61 272c 2027 5130 272c 2027  'sigma', 'Q0', '
+0003e450: 7065 7269 6f64 272c 2027 6627 2c20 2764  period', 'f', 'd
+0003e460: 5127 0a20 2020 2020 2020 205d 0a20 2020  Q'.        ].   
+0003e470: 2020 2020 2023 2046 6f72 204d 6174 6572       # For Mater
+0003e480: 6e2b 5348 4f20 6b65 726e 656c 0a20 2020  n+SHO kernel.   
+0003e490: 2020 2020 2073 656c 662e 616c 6c5f 6b65       self.all_ke
+0003e4a0: 726e 656c 5f76 6172 6961 626c 6573 5b27  rnel_variables['
+0003e4b0: 4365 6c65 7269 7465 4d61 7465 726e 5348  CeleriteMaternSH
+0003e4c0: 4f4b 6572 6e65 6c27 5d20 3d20 5b27 7369  OKernel'] = ['si
+0003e4d0: 676d 6127 2c20 2772 686f 272c 2027 5330  gma', 'rho', 'S0
+0003e4e0: 272c 2027 5127 2c20 276f 6d65 6761 3027  ', 'Q', 'omega0'
+0003e4f0: 5d0a 0a20 2020 2020 2020 2023 2046 696e  ]..        # Fin
+0003e500: 6420 6b65 726e 656c 206e 616d 6520 2861  d kernel name (a
+0003e510: 6e64 2073 6176 6520 6974 2074 6f20 7365  nd save it to se
+0003e520: 6c66 2e6b 6572 6e65 6c5f 6e61 6d65 293a  lf.kernel_name):
+0003e530: 0a20 2020 2020 2020 2073 656c 662e 6b65  .        self.ke
+0003e540: 726e 656c 5f6e 616d 6520 3d20 7365 6c66  rnel_name = self
+0003e550: 2e67 6574 5f6b 6572 6e65 6c5f 6e61 6d65  .get_kernel_name
+0003e560: 2864 6174 612e 7072 696f 7273 290a 2020  (data.priors).  
+0003e570: 2020 2020 2020 2320 496e 6974 6961 6c69        # Initiali
+0003e580: 7a65 2076 6172 6961 626c 6520 666f 7220  ze variable for 
+0003e590: 7468 6520 4750 206f 626a 6563 743a 0a20  the GP object:. 
+0003e5a0: 2020 2020 2020 2073 656c 662e 4750 203d         self.GP =
+0003e5b0: 204e 6f6e 650a 2020 2020 2020 2020 2320   None.        # 
+0003e5c0: 4172 6520 7765 2075 7369 6e67 2063 656c  Are we using cel
+0003e5d0: 6572 6974 653f 0a20 2020 2020 2020 2073  erite?.        s
+0003e5e0: 656c 662e 7573 655f 6365 6c65 7269 7465  elf.use_celerite
+0003e5f0: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+0003e600: 2023 2041 7265 2077 6520 7573 696e 6720   # Are we using 
+0003e610: 6765 6f72 6765 5f68 6f64 6c72 3f0a 2020  george_hodlr?.  
+0003e620: 2020 2020 2020 6966 2067 656f 7267 655f        if george_
+0003e630: 686f 646c 723a 0a20 2020 2020 2020 2020  hodlr:.         
+0003e640: 2020 2073 656c 662e 6765 6f72 6765 5f68     self.george_h
+0003e650: 6f64 6c72 203d 2054 7275 650a 2020 2020  odlr = True.    
+0003e660: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0003e670: 2020 2020 2020 7365 6c66 2e67 656f 7267        self.georg
+0003e680: 655f 686f 646c 7220 3d20 4661 6c73 650a  e_hodlr = False.
+0003e690: 2020 2020 2020 2020 2320 496e 6974 6961          # Initia
+0003e6a0: 6c69 7a65 2076 6172 6961 626c 6520 7468  lize variable th
+0003e6b0: 6174 2073 6574 7320 7468 6520 2269 6e73  at sets the "ins
+0003e6c0: 7472 756d 656e 7422 206e 616d 6520 666f  trument" name fo
+0003e6d0: 7220 6561 6368 2076 6172 6961 626c 6520  r each variable 
+0003e6e0: 2873 656c 662e 7661 7269 6162 6c65 7320  (self.variables 
+0003e6f0: 6265 6c6f 7729 2e20 4966 2c20 666f 7220  below). If, for 
+0003e700: 6578 616d 706c 652c 0a20 2020 2020 2020  example,.       
+0003e710: 2023 2047 505f 5072 6f74 5f54 4553 535f   # GP_Prot_TESS_
+0003e720: 4b32 5f52 5620 616e 6420 4750 5f47 616d  K2_RV and GP_Gam
+0003e730: 6d61 5f54 4553 532c 2061 6e64 2073 656c  ma_TESS, and sel
+0003e740: 662e 7661 7269 6162 6c65 7320 3d20 5b50  f.variables = [P
+0003e750: 726f 742c 4761 6d6d 615d 2c20 7468 656e  rot,Gamma], then
+0003e760: 2073 656c 662e 696e 7374 7275 6d65 6e74   self.instrument
+0003e770: 5f76 6172 6961 626c 6573 203d 205b 2754  _variables = ['T
+0003e780: 4553 535f 4b32 5f52 5627 2c27 5445 5353  ESS_K2_RV','TESS
+0003e790: 275d 2e0a 2020 2020 2020 2020 7365 6c66  ']..        self
+0003e7a0: 2e69 6e70 7574 5f69 6e73 7472 756d 656e  .input_instrumen
+0003e7b0: 7420 3d20 5b5d 0a0a 2020 2020 2020 2020  t = []..        
+0003e7c0: 2320 496e 6974 6961 6c69 7a65 2065 6163  # Initialize eac
+0003e7d0: 6820 6b65 726e 656c 206f 6e20 7468 6520  h kernel on the 
+0003e7e0: 4750 206f 626a 6563 742e 2046 6972 7374  GP object. First
+0003e7f0: 2c20 7365 7420 7468 6520 7661 7269 6162  , set the variab
+0003e800: 6c65 7320 746f 2074 6865 206f 6e65 7320  les to the ones 
+0003e810: 6465 6669 6e65 6420 6162 6f76 652e 2054  defined above. T
+0003e820: 6865 6e20 696e 6974 6961 6c69 7a65 2074  hen initialize t
+0003e830: 6865 0a20 2020 2020 2020 2023 2061 6374  he.        # act
+0003e840: 7561 6c20 6b65 726e 656c 3a0a 2020 2020  ual kernel:.    
+0003e850: 2020 2020 7365 6c66 2e76 6172 6961 626c      self.variabl
+0003e860: 6573 203d 2073 656c 662e 616c 6c5f 6b65  es = self.all_ke
+0003e870: 726e 656c 5f76 6172 6961 626c 6573 5b73  rnel_variables[s
+0003e880: 656c 662e 6b65 726e 656c 5f6e 616d 655d  elf.kernel_name]
+0003e890: 0a20 2020 2020 2020 2070 6861 6e74 6f6d  .        phantom
+0003e8a0: 7661 7269 6162 6c65 203d 2030 0a20 2020  variable = 0.   
+0003e8b0: 2020 2020 2069 6620 7365 6c66 2e6b 6572       if self.ker
+0003e8c0: 6e65 6c5f 6e61 6d65 203d 3d20 2753 454b  nel_name == 'SEK
+0003e8d0: 6572 6e65 6c27 3a0a 2020 2020 2020 2020  ernel':.        
+0003e8e0: 2020 2020 2320 4765 6e65 7261 7465 2047      # Generate G
+0003e8f0: 5045 7870 5371 7561 7265 6420 6261 7365  PExpSquared base
+0003e900: 206b 6572 6e65 6c3a 0a20 2020 2020 2020   kernel:.       
+0003e910: 2020 2020 2073 656c 662e 6b65 726e 656c       self.kernel
+0003e920: 203d 2031 2e20 2a20 6765 6f72 6765 2e6b   = 1. * george.k
+0003e930: 6572 6e65 6c73 2e45 7870 5371 7561 7265  ernels.ExpSquare
+0003e940: 644b 6572 6e65 6c28 0a20 2020 2020 2020  dKernel(.       
+0003e950: 2020 2020 2020 2020 206e 702e 6f6e 6573           np.ones
+0003e960: 2873 656c 662e 6e58 292c 206e 6469 6d3d  (self.nX), ndim=
+0003e970: 7365 6c66 2e6e 582c 2061 7865 733d 7261  self.nX, axes=ra
+0003e980: 6e67 6528 7365 6c66 2e6e 5829 290a 2020  nge(self.nX)).  
+0003e990: 2020 2020 2020 2020 2020 2320 284e 6f74            # (Not
+0003e9a0: 6520 6e6f 206a 6974 7465 7220 6b65 726e  e no jitter kern
+0003e9b0: 656c 2069 7320 6769 7665 6e2c 2061 7320  el is given, as 
+0003e9c0: 7769 7468 2067 656f 7267 6520 6f6e 6520  with george one 
+0003e9d0: 6465 6669 6e65 7320 7468 6973 2069 6e20  defines this in 
+0003e9e0: 7468 6520 6765 6f72 6765 2e47 5020 6361  the george.GP ca
+0003e9f0: 6c6c 293a 0a20 2020 2020 2020 2065 6c69  ll):.        eli
+0003ea00: 6620 7365 6c66 2e6b 6572 6e65 6c5f 6e61  f self.kernel_na
+0003ea10: 6d65 203d 3d20 274d 3332 4b65 726e 656c  me == 'M32Kernel
+0003ea20: 273a 0a20 2020 2020 2020 2020 2020 2023  ':.            #
+0003ea30: 2047 656e 6572 6174 6520 4750 4d61 7465   Generate GPMate
+0003ea40: 726e 3332 2062 6173 6520 6b65 726e 656c  rn32 base kernel
+0003ea50: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0003ea60: 6c66 2e6b 6572 6e65 6c20 3d20 312e 202a  lf.kernel = 1. *
+0003ea70: 2067 656f 7267 652e 6b65 726e 656c 732e   george.kernels.
+0003ea80: 4d61 7465 726e 3332 4b65 726e 656c 280a  Matern32Kernel(.
+0003ea90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eaa0: 6e70 2e6f 6e65 7328 7365 6c66 2e6e 5829  np.ones(self.nX)
+0003eab0: 2c20 6e64 696d 3d73 656c 662e 6e58 2c20  , ndim=self.nX, 
+0003eac0: 6178 6573 3d72 616e 6765 2873 656c 662e  axes=range(self.
+0003ead0: 6e58 2929 0a20 2020 2020 2020 2020 2020  nX)).           
+0003eae0: 2023 2028 4e6f 7465 206e 6f20 6a69 7474   # (Note no jitt
+0003eaf0: 6572 206b 6572 6e65 6c20 6973 2067 6976  er kernel is giv
+0003eb00: 656e 2c20 6173 2077 6974 6820 6765 6f72  en, as with geor
+0003eb10: 6765 206f 6e65 2064 6566 696e 6573 2074  ge one defines t
+0003eb20: 6869 7320 696e 2074 6865 2067 656f 7267  his in the georg
+0003eb30: 652e 4750 2063 616c 6c29 3a0a 2020 2020  e.GP call):.    
+0003eb40: 2020 2020 656c 6966 2073 656c 662e 6b65      elif self.ke
+0003eb50: 726e 656c 5f6e 616d 6520 3d3d 2027 4578  rnel_name == 'Ex
+0003eb60: 7053 696e 6553 7175 6172 6564 5345 4b65  pSineSquaredSEKe
+0003eb70: 726e 656c 273a 0a20 2020 2020 2020 2020  rnel':.         
+0003eb80: 2020 2023 2047 656e 6572 6174 6520 7468     # Generate th
+0003eb90: 6520 6b65 726e 656c 733a 0a20 2020 2020  e kernels:.     
+0003eba0: 2020 2020 2020 204b 3120 3d20 312e 202a         K1 = 1. *
+0003ebb0: 2067 656f 7267 652e 6b65 726e 656c 732e   george.kernels.
+0003ebc0: 4578 7053 7175 6172 6564 4b65 726e 656c  ExpSquaredKernel
+0003ebd0: 286d 6574 7269 633d 312e 3029 0a20 2020  (metric=1.0).   
+0003ebe0: 2020 2020 2020 2020 204b 3220 3d20 6765           K2 = ge
+0003ebf0: 6f72 6765 2e6b 6572 6e65 6c73 2e45 7870  orge.kernels.Exp
+0003ec00: 5369 6e65 324b 6572 6e65 6c28 6761 6d6d  Sine2Kernel(gamm
+0003ec10: 613d 312e 302c 206c 6f67 5f70 6572 696f  a=1.0, log_perio
+0003ec20: 643d 312e 3029 0a20 2020 2020 2020 2020  d=1.0).         
+0003ec30: 2020 2073 656c 662e 6b65 726e 656c 203d     self.kernel =
+0003ec40: 204b 3120 2a20 4b32 0a20 2020 2020 2020   K1 * K2.       
+0003ec50: 2020 2020 2023 2028 4e6f 7465 206e 6f20       # (Note no 
+0003ec60: 6a69 7474 6572 206b 6572 6e65 6c20 6973  jitter kernel is
+0003ec70: 2067 6976 656e 2c20 6173 2077 6974 6820   given, as with 
+0003ec80: 6765 6f72 6765 206f 6e65 2064 6566 696e  george one defin
+0003ec90: 6573 2074 6869 7320 696e 2074 6865 2067  es this in the g
+0003eca0: 656f 7267 652e 4750 2063 616c 6c29 3a0a  eorge.GP call):.
+0003ecb0: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+0003ecc0: 662e 6b65 726e 656c 5f6e 616d 6520 3d3d  f.kernel_name ==
+0003ecd0: 2027 4365 6c65 7269 7465 5150 4b65 726e   'CeleriteQPKern
+0003ece0: 656c 273a 0a20 2020 2020 2020 2020 2020  el':.           
+0003ecf0: 2023 2047 656e 6572 6174 6520 726f 7461   # Generate rota
+0003ed00: 7469 6f6e 616c 206b 6572 6e65 6c3a 0a20  tional kernel:. 
+0003ed10: 2020 2020 2020 2020 2020 2072 6f74 5f6b             rot_k
+0003ed20: 6572 6e65 6c20 3d20 7465 726d 732e 5465  ernel = terms.Te
+0003ed30: 726d 5375 6d28 526f 7461 7469 6f6e 5465  rmSum(RotationTe
+0003ed40: 726d 286c 6f67 5f61 6d70 3d6e 702e 6c6f  rm(log_amp=np.lo
+0003ed50: 6728 3130 2e29 2c5c 0a20 2020 2020 2020  g(10.),\.       
+0003ed60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ed70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ed80: 2020 2020 2020 2020 2020 2020 206c 6f67               log
+0003ed90: 5f74 696d 6573 6361 6c65 3d6e 702e 6c6f  _timescale=np.lo
+0003eda0: 6728 3130 2e30 292c 5c0a 2020 2020 2020  g(10.0),\.      
+0003edb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003edc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003edd0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+0003ede0: 675f 7065 7269 6f64 3d6e 702e 6c6f 6728  g_period=np.log(
+0003edf0: 332e 3029 2c5c 0a20 2020 2020 2020 2020  3.0),\.         
+0003ee00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ee10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ee20: 2020 2020 2020 2020 2020 206c 6f67 5f66             log_f
+0003ee30: 6163 746f 723d 6e70 2e6c 6f67 2831 2e30  actor=np.log(1.0
+0003ee40: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
+0003ee50: 2320 4a69 7474 6572 2074 6572 6d3a 0a20  # Jitter term:. 
+0003ee60: 2020 2020 2020 2020 2020 206b 6572 6e65             kerne
+0003ee70: 6c5f 6a69 7474 6572 203d 2074 6572 6d73  l_jitter = terms
+0003ee80: 2e4a 6974 7465 7254 6572 6d28 6e70 2e6c  .JitterTerm(np.l
+0003ee90: 6f67 2831 3030 202a 2031 652d 3629 290a  og(100 * 1e-6)).
+0003eea0: 2020 2020 2020 2020 2020 2020 2320 5772              # Wr
+0003eeb0: 6170 2047 5020 6b65 726e 656c 2061 6e64  ap GP kernel and
+0003eec0: 206f 626a 6563 743a 0a0a 2020 2020 2020   object:..      
+0003eed0: 2020 2020 2020 6966 2073 656c 662e 696e        if self.in
+0003eee0: 7374 7275 6d65 6e74 2069 6e20 5b27 7276  strument in ['rv
+0003eef0: 272c 2027 6c63 275d 3a0a 0a20 2020 2020  ', 'lc']:..     
+0003ef00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0003ef10: 6b65 726e 656c 203d 2072 6f74 5f6b 6572  kernel = rot_ker
+0003ef20: 6e65 6c0a 2020 2020 2020 2020 2020 2020  nel.            
+0003ef30: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0003ef40: 2020 2020 2020 7365 6c66 2e6b 6572 6e65        self.kerne
+0003ef50: 6c20 3d20 726f 745f 6b65 726e 656c 202b  l = rot_kernel +
+0003ef60: 206b 6572 6e65 6c5f 6a69 7474 6572 0a20   kernel_jitter. 
+0003ef70: 2020 2020 2020 2020 2020 2023 2057 6520             # We 
+0003ef80: 6172 6520 7573 696e 6720 6365 6c65 7269  are using celeri
+0003ef90: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
+0003efa0: 7365 6c66 2e75 7365 5f63 656c 6572 6974  self.use_celerit
+0003efb0: 6520 3d20 5472 7565 0a20 2020 2020 2020  e = True.       
+0003efc0: 2065 6c69 6620 7365 6c66 2e6b 6572 6e65   elif self.kerne
+0003efd0: 6c5f 6e61 6d65 203d 3d20 2743 656c 6572  l_name == 'Celer
+0003efe0: 6974 6545 7870 4b65 726e 656c 273a 0a20  iteExpKernel':. 
+0003eff0: 2020 2020 2020 2020 2020 2023 2047 656e             # Gen
+0003f000: 6572 6174 6520 6578 706f 6e65 6e74 6961  erate exponentia
+0003f010: 6c20 6b65 726e 656c 3a0a 2020 2020 2020  l kernel:.      
+0003f020: 2020 2020 2020 6578 705f 6b65 726e 656c        exp_kernel
+0003f030: 203d 2074 6572 6d73 2e52 6561 6c54 6572   = terms.RealTer
+0003f040: 6d28 6c6f 675f 613d 6e70 2e6c 6f67 2831  m(log_a=np.log(1
+0003f050: 302e 292c 206c 6f67 5f63 3d6e 702e 6c6f  0.), log_c=np.lo
+0003f060: 6728 3130 2e29 290a 2020 2020 2020 2020  g(10.)).        
+0003f070: 2020 2020 2320 4a69 7474 6572 2074 6572      # Jitter ter
+0003f080: 6d3a 0a20 2020 2020 2020 2020 2020 206b  m:.            k
+0003f090: 6572 6e65 6c5f 6a69 7474 6572 203d 2074  ernel_jitter = t
+0003f0a0: 6572 6d73 2e4a 6974 7465 7254 6572 6d28  erms.JitterTerm(
+0003f0b0: 6e70 2e6c 6f67 2831 3030 202a 2031 652d  np.log(100 * 1e-
+0003f0c0: 3629 290a 2020 2020 2020 2020 2020 2020  6)).            
+0003f0d0: 2320 5772 6170 2047 5020 6b65 726e 656c  # Wrap GP kernel
+0003f0e0: 2061 6e64 206f 626a 6563 743a 0a20 2020   and object:.   
+0003f0f0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+0003f100: 2e69 6e73 7472 756d 656e 7420 696e 205b  .instrument in [
+0003f110: 2772 7627 2c20 276c 6327 5d3a 0a20 2020  'rv', 'lc']:.   
+0003f120: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0003f130: 662e 6b65 726e 656c 203d 2065 7870 5f6b  f.kernel = exp_k
+0003f140: 6572 6e65 6c0a 2020 2020 2020 2020 2020  ernel.          
+0003f150: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0003f160: 2020 2020 2020 2020 7365 6c66 2e6b 6572          self.ker
+0003f170: 6e65 6c20 3d20 6578 705f 6b65 726e 656c  nel = exp_kernel
+0003f180: 202b 206b 6572 6e65 6c5f 6a69 7474 6572   + kernel_jitter
+0003f190: 0a20 2020 2020 2020 2020 2020 2023 2057  .            # W
+0003f1a0: 6520 6172 6520 7573 696e 6720 6365 6c65  e are using cele
+0003f1b0: 7269 7465 3a0a 2020 2020 2020 2020 2020  rite:.          
+0003f1c0: 2020 7365 6c66 2e75 7365 5f63 656c 6572    self.use_celer
+0003f1d0: 6974 6520 3d20 5472 7565 0a20 2020 2020  ite = True.     
+0003f1e0: 2020 2065 6c69 6620 7365 6c66 2e6b 6572     elif self.ker
+0003f1f0: 6e65 6c5f 6e61 6d65 203d 3d20 2743 656c  nel_name == 'Cel
+0003f200: 6572 6974 654d 6174 6572 6e4b 6572 6e65  eriteMaternKerne
+0003f210: 6c27 3a0a 2020 2020 2020 2020 2020 2020  l':.            
+0003f220: 2320 4765 6e65 7261 7465 206d 6174 6572  # Generate mater
+0003f230: 6e20 6b65 726e 656c 3a0a 2020 2020 2020  n kernel:.      
+0003f240: 2020 2020 2020 6d61 7465 726e 5f6b 6572        matern_ker
+0003f250: 6e65 6c20 3d20 7465 726d 732e 4d61 7465  nel = terms.Mate
+0003f260: 726e 3332 5465 726d 286c 6f67 5f73 6967  rn32Term(log_sig
+0003f270: 6d61 3d6e 702e 6c6f 6728 3130 2e29 2c0a  ma=np.log(10.),.
+0003f280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f2a0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0003f2b0: 6f67 5f72 686f 3d6e 702e 6c6f 6728 3130  og_rho=np.log(10
+0003f2c0: 2e29 2c0a 2020 2020 2020 2020 2020 2020  .),.            
+0003f2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f2f0: 2020 2065 7073 3d6d 6174 6572 6e5f 6570     eps=matern_ep
+0003f300: 7329 0a20 2020 2020 2020 2020 2020 2023  s).            #
+0003f310: 204a 6974 7465 7220 7465 726d 3a0a 2020   Jitter term:.  
+0003f320: 2020 2020 2020 2020 2020 6b65 726e 656c            kernel
+0003f330: 5f6a 6974 7465 7220 3d20 7465 726d 732e  _jitter = terms.
+0003f340: 4a69 7474 6572 5465 726d 286e 702e 6c6f  JitterTerm(np.lo
+0003f350: 6728 3130 3020 2a20 3165 2d36 2929 0a20  g(100 * 1e-6)). 
+0003f360: 2020 2020 2020 2020 2020 2023 2057 7261             # Wra
+0003f370: 7020 4750 206b 6572 6e65 6c20 616e 6420  p GP kernel and 
+0003f380: 6f62 6a65 6374 3a0a 2020 2020 2020 2020  object:.        
+0003f390: 2020 2020 6966 2073 656c 662e 696e 7374      if self.inst
+0003f3a0: 7275 6d65 6e74 2069 6e20 5b27 7276 272c  rument in ['rv',
+0003f3b0: 2027 6c63 275d 3a0a 2020 2020 2020 2020   'lc']:.        
+0003f3c0: 2020 2020 2020 2020 7365 6c66 2e6b 6572          self.ker
+0003f3d0: 6e65 6c20 3d20 6d61 7465 726e 5f6b 6572  nel = matern_ker
+0003f3e0: 6e65 6c0a 2020 2020 2020 2020 2020 2020  nel.            
+0003f3f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0003f400: 2020 2020 2020 7365 6c66 2e6b 6572 6e65        self.kerne
+0003f410: 6c20 3d20 6d61 7465 726e 5f6b 6572 6e65  l = matern_kerne
+0003f420: 6c20 2b20 6b65 726e 656c 5f6a 6974 7465  l + kernel_jitte
+0003f430: 720a 2020 2020 2020 2020 2020 2020 2320  r.            # 
+0003f440: 5765 2061 7265 2075 7369 6e67 2063 656c  We are using cel
+0003f450: 6572 6974 653a 0a20 2020 2020 2020 2020  erite:.         
+0003f460: 2020 2073 656c 662e 7573 655f 6365 6c65     self.use_cele
+0003f470: 7269 7465 203d 2054 7275 650a 2020 2020  rite = True.    
+0003f480: 2020 2020 656c 6966 2073 656c 662e 6b65      elif self.ke
+0003f490: 726e 656c 5f6e 616d 6520 3d3d 2027 4365  rnel_name == 'Ce
+0003f4a0: 6c65 7269 7465 4d61 7465 726e 4578 704b  leriteMaternExpK
+0003f4b0: 6572 6e65 6c27 3a0a 2020 2020 2020 2020  ernel':.        
+0003f4c0: 2020 2020 2320 4765 6e65 7261 7465 206d      # Generate m
+0003f4d0: 6174 6572 6e20 616e 6420 6578 706f 6e65  atern and expone
+0003f4e0: 6e74 6961 6c20 6b65 726e 656c 733a 0a20  ntial kernels:. 
+0003f4f0: 2020 2020 2020 2020 2020 206d 6174 6572             mater
+0003f500: 6e5f 6b65 726e 656c 203d 2074 6572 6d73  n_kernel = terms
+0003f510: 2e4d 6174 6572 6e33 3254 6572 6d28 6c6f  .Matern32Term(lo
+0003f520: 675f 7369 676d 613d 6e70 2e6c 6f67 2831  g_sigma=np.log(1
+0003f530: 302e 292c 0a20 2020 2020 2020 2020 2020  0.),.           
+0003f540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f560: 2020 2020 6c6f 675f 7268 6f3d 6e70 2e6c      log_rho=np.l
+0003f570: 6f67 2831 302e 292c 0a20 2020 2020 2020  og(10.),.       
+0003f580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f5a0: 2020 2020 2020 2020 6570 733d 6d61 7465          eps=mate
+0003f5b0: 726e 5f65 7073 290a 2020 2020 2020 2020  rn_eps).        
+0003f5c0: 2020 2020 6578 705f 6b65 726e 656c 203d      exp_kernel =
+0003f5d0: 2074 6572 6d73 2e52 6561 6c54 6572 6d28   terms.RealTerm(
+0003f5e0: 6c6f 675f 613d 6e70 2e6c 6f67 2831 302e  log_a=np.log(10.
+0003f5f0: 292c 206c 6f67 5f63 3d6e 702e 6c6f 6728  ), log_c=np.log(
+0003f600: 3130 2e29 290a 2020 2020 2020 2020 2020  10.)).          
+0003f610: 2020 2320 4a69 7474 6572 2074 6572 6d3a    # Jitter term:
+0003f620: 0a20 2020 2020 2020 2020 2020 206b 6572  .            ker
+0003f630: 6e65 6c5f 6a69 7474 6572 203d 2074 6572  nel_jitter = ter
+0003f640: 6d73 2e4a 6974 7465 7254 6572 6d28 6e70  ms.JitterTerm(np
+0003f650: 2e6c 6f67 2831 3030 202a 2031 652d 3629  .log(100 * 1e-6)
+0003f660: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+0003f670: 5772 6170 2047 5020 6b65 726e 656c 2061  Wrap GP kernel a
+0003f680: 6e64 206f 626a 6563 743a 0a20 2020 2020  nd object:.     
+0003f690: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
+0003f6a0: 6e73 7472 756d 656e 7420 696e 205b 2772  nstrument in ['r
+0003f6b0: 7627 2c20 276c 6327 5d3a 0a20 2020 2020  v', 'lc']:.     
+0003f6c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0003f6d0: 6b65 726e 656c 203d 2065 7870 5f6b 6572  kernel = exp_ker
+0003f6e0: 6e65 6c20 2a20 6d61 7465 726e 5f6b 6572  nel * matern_ker
+0003f6f0: 6e65 6c0a 2020 2020 2020 2020 2020 2020  nel.            
+0003f700: 656c 7365 3a0a 0a20 2020 2020 2020 2020  else:..         
+0003f710: 2020 2020 2020 2073 656c 662e 6b65 726e         self.kern
+0003f720: 656c 203d 2065 7870 5f6b 6572 6e65 6c20  el = exp_kernel 
+0003f730: 2a20 6d61 7465 726e 5f6b 6572 6e65 6c20  * matern_kernel 
+0003f740: 2b20 6b65 726e 656c 5f6a 6974 7465 720a  + kernel_jitter.
+0003f750: 0a20 2020 2020 2020 2020 2020 2023 2057  .            # W
+0003f760: 6520 6164 6420 6120 7068 616e 746f 6d20  e add a phantom 
+0003f770: 7661 7269 6162 6c65 2062 6563 6175 7365  variable because
+0003f780: 2077 6520 7761 6e74 2074 6f20 6c65 6176   we want to leav
+0003f790: 6520 696e 6465 7820 3220 7769 7468 6f75  e index 2 withou
+0003f7a0: 7420 7661 6c75 6520 4f4e 2050 5552 504f  t value ON PURPO
+0003f7b0: 5345 3a20 7468 6520 6964 6561 2069 730a  SE: the idea is.
+0003f7c0: 2020 2020 2020 2020 2020 2020 2320 7468              # th
+0003f7d0: 6174 2068 6572 652c 2074 6861 7420 6973  at here, that is
+0003f7e0: 2061 6c77 6179 7320 3020 2862 6563 6175   always 0 (becau
+0003f7f0: 7365 2074 6869 7320 6465 6669 6e65 7320  se this defines 
+0003f800: 7468 6520 6c6f 6728 7369 676d 6129 206f  the log(sigma) o
+0003f810: 6620 7468 6520 6d61 7465 726e 206b 6572  f the matern ker
+0003f820: 6e65 6c20 696e 2074 6865 0a20 2020 2020  nel in the.     
+0003f830: 2020 2020 2020 2023 206d 756c 7469 706c         # multipl
+0003f840: 6963 6174 696f 6e2c 2077 6869 6368 2077  ication, which w
+0003f850: 6520 7365 7420 746f 2031 292e 0a20 2020  e set to 1)..   
+0003f860: 2020 2020 2020 2020 2070 6861 6e74 6f6d           phantom
+0003f870: 7661 7269 6162 6c65 203d 2031 0a20 2020  variable = 1.   
+0003f880: 2020 2020 2020 2020 2023 2057 6520 6172           # We ar
+0003f890: 6520 7573 696e 6720 6365 6c65 7269 7465  e using celerite
+0003f8a0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0003f8b0: 6c66 2e75 7365 5f63 656c 6572 6974 6520  lf.use_celerite 
+0003f8c0: 3d20 5472 7565 0a20 2020 2020 2020 2065  = True.        e
+0003f8d0: 6c69 6620 7365 6c66 2e6b 6572 6e65 6c5f  lif self.kernel_
+0003f8e0: 6e61 6d65 203d 3d20 2743 656c 6572 6974  name == 'Celerit
+0003f8f0: 6553 484f 4b65 726e 656c 273a 0a20 2020  eSHOKernel':.   
+0003f900: 2020 2020 2020 2020 2023 2047 656e 6572           # Gener
+0003f910: 6174 6520 6b65 726e 656c 3a0a 2020 2020  ate kernel:.    
+0003f920: 2020 2020 2020 2020 7368 6f5f 6b65 726e          sho_kern
+0003f930: 656c 203d 2074 6572 6d73 2e53 484f 5465  el = terms.SHOTe
+0003f940: 726d 286c 6f67 5f53 303d 6e70 2e6c 6f67  rm(log_S0=np.log
+0003f950: 2831 302e 292c 0a20 2020 2020 2020 2020  (10.),.         
+0003f960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f970: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+0003f980: 675f 513d 6e70 2e6c 6f67 2831 302e 292c  g_Q=np.log(10.),
+0003f990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f9b0: 2020 2020 2020 2020 6c6f 675f 6f6d 6567          log_omeg
+0003f9c0: 6130 3d6e 702e 6c6f 6728 3130 2e29 290a  a0=np.log(10.)).
+0003f9d0: 2020 2020 2020 2020 2020 2020 2320 4a69              # Ji
+0003f9e0: 7474 6572 2074 6572 6d3a 0a20 2020 2020  tter term:.     
+0003f9f0: 2020 2020 2020 206b 6572 6e65 6c5f 6a69         kernel_ji
+0003fa00: 7474 6572 203d 2074 6572 6d73 2e4a 6974  tter = terms.Jit
+0003fa10: 7465 7254 6572 6d28 6e70 2e6c 6f67 2831  terTerm(np.log(1
+0003fa20: 3030 202a 2031 652d 3629 290a 2020 2020  00 * 1e-6)).    
+0003fa30: 2020 2020 2020 2020 2320 5772 6170 2047          # Wrap G
+0003fa40: 5020 6b65 726e 656c 2061 6e64 206f 626a  P kernel and obj
+0003fa50: 6563 743a 0a20 2020 2020 2020 2020 2020  ect:.           
+0003fa60: 2069 6620 7365 6c66 2e69 6e73 7472 756d   if self.instrum
+0003fa70: 656e 7420 696e 205b 2772 7627 2c20 276c  ent in ['rv', 'l
+0003fa80: 6327 5d3a 0a20 2020 2020 2020 2020 2020  c']:.           
+0003fa90: 2020 2020 2073 656c 662e 6b65 726e 656c       self.kernel
+0003faa0: 203d 2073 686f 5f6b 6572 6e65 6c0a 2020   = sho_kernel.  
+0003fab0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0003fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fad0: 7365 6c66 2e6b 6572 6e65 6c20 3d20 7368  self.kernel = sh
+0003fae0: 6f5f 6b65 726e 656c 202b 206b 6572 6e65  o_kernel + kerne
+0003faf0: 6c5f 6a69 7474 6572 0a20 2020 2020 2020  l_jitter.       
+0003fb00: 2020 2020 2023 2057 6520 6172 6520 7573       # We are us
+0003fb10: 696e 6720 6365 6c65 7269 7465 3a0a 2020  ing celerite:.  
+0003fb20: 2020 2020 2020 2020 2020 7365 6c66 2e75            self.u
+0003fb30: 7365 5f63 656c 6572 6974 6520 3d20 5472  se_celerite = Tr
+0003fb40: 7565 0a20 2020 2020 2020 2065 6c69 6620  ue.        elif 
+0003fb50: 7365 6c66 2e6b 6572 6e65 6c5f 6e61 6d65  self.kernel_name
+0003fb60: 203d 3d20 2743 656c 6572 6974 6544 6f75   == 'CeleriteDou
+0003fb70: 626c 6553 484f 4b65 726e 656c 273a 0a20  bleSHOKernel':. 
+0003fb80: 2020 2020 2020 2020 2020 2023 2047 656e             # Gen
+0003fb90: 6572 6174 6520 6b65 726e 656c 0a20 2020  erate kernel.   
+0003fba0: 2020 2020 2020 2020 2023 5468 6973 206b           #This k
+0003fbb0: 6572 6e65 6c20 6973 2061 6461 7074 6564  ernel is adapted
+0003fbc0: 2066 726f 6d20 7468 6520 2252 6f74 6174   from the "Rotat
+0003fbd0: 696f 6e54 6572 6d22 2069 6e20 6365 6c65  ionTerm" in cele
+0003fbe0: 7269 7465 3220 6874 7470 733a 2f2f 6365  rite2 https://ce
+0003fbf0: 6c65 7269 7465 322e 7265 6164 7468 6564  lerite2.readthed
+0003fc00: 6f63 732e 696f 2f65 6e2f 6c61 7465 7374  ocs.io/en/latest
+0003fc10: 2f61 7069 2f70 7974 686f 6e2f 2363 656c  /api/python/#cel
+0003fc20: 6572 6974 6532 2e74 6572 6d73 2e52 6f74  erite2.terms.Rot
+0003fc30: 6174 696f 6e54 6572 6d0a 2020 2020 2020  ationTerm.      
+0003fc40: 2020 2020 2020 7368 6f5f 6b65 726e 656c        sho_kernel
+0003fc50: 3120 3d20 7465 726d 732e 5348 4f54 6572  1 = terms.SHOTer
+0003fc60: 6d28 6c6f 675f 5330 3d6e 702e 6c6f 6728  m(log_S0=np.log(
+0003fc70: 3130 2e29 2c0a 2020 2020 2020 2020 2020  10.),.          
+0003fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fc90: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+0003fca0: 675f 513d 6e70 2e6c 6f67 2831 302e 292c  g_Q=np.log(10.),
+0003fcb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003fcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fcd0: 2020 2020 2020 2020 206c 6f67 5f6f 6d65           log_ome
+0003fce0: 6761 303d 6e70 2e6c 6f67 2831 302e 2929  ga0=np.log(10.))
+0003fcf0: 0a20 2020 2020 2020 2020 2020 2073 686f  .            sho
+0003fd00: 5f6b 6572 6e65 6c32 203d 2074 6572 6d73  _kernel2 = terms
+0003fd10: 2e53 484f 5465 726d 286c 6f67 5f53 303d  .SHOTerm(log_S0=
+0003fd20: 6e70 2e6c 6f67 2831 302e 292c 0a20 2020  np.log(10.),.   
+0003fd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fd50: 2020 2020 206c 6f67 5f51 3d6e 702e 6c6f       log_Q=np.lo
+0003fd60: 6728 3130 2e29 2c0a 2020 2020 2020 2020  g(10.),.        
+0003fd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fd90: 6c6f 675f 6f6d 6567 6130 3d6e 702e 6c6f  log_omega0=np.lo
+0003fda0: 6728 3130 2e29 290a 0a20 2020 2020 2020  g(10.))..       
+0003fdb0: 2020 2020 2064 6f75 626c 655f 7368 6f5f       double_sho_
+0003fdc0: 6b65 726e 656c 203d 2073 686f 5f6b 6572  kernel = sho_ker
+0003fdd0: 6e65 6c31 202b 2073 686f 5f6b 6572 6e65  nel1 + sho_kerne
+0003fde0: 6c32 0a0a 2020 2020 2020 2020 2020 2020  l2..            
+0003fdf0: 7068 616e 746f 6d76 6172 6961 626c 6520  phantomvariable 
+0003fe00: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+0003fe10: 2320 4a69 7474 6572 2074 6572 6d3a 0a20  # Jitter term:. 
+0003fe20: 2020 2020 2020 2020 2020 206b 6572 6e65             kerne
+0003fe30: 6c5f 6a69 7474 6572 203d 2074 6572 6d73  l_jitter = terms
+0003fe40: 2e4a 6974 7465 7254 6572 6d28 6e70 2e6c  .JitterTerm(np.l
+0003fe50: 6f67 2831 3030 202a 2031 652d 3629 290a  og(100 * 1e-6)).
+0003fe60: 2020 2020 2020 2020 2020 2020 2320 5772              # Wr
+0003fe70: 6170 2047 5020 6b65 726e 656c 2061 6e64  ap GP kernel and
+0003fe80: 206f 626a 6563 743a 0a20 2020 2020 2020   object:.       
+0003fe90: 2020 2020 2069 6620 7365 6c66 2e69 6e73       if self.ins
+0003fea0: 7472 756d 656e 7420 696e 205b 2772 7627  trument in ['rv'
+0003feb0: 2c20 276c 6327 5d3a 0a20 2020 2020 2020  , 'lc']:.       
+0003fec0: 2020 2020 2020 2020 2073 656c 662e 6b65           self.ke
+0003fed0: 726e 656c 203d 2064 6f75 626c 655f 7368  rnel = double_sh
+0003fee0: 6f5f 6b65 726e 656c 0a20 2020 2020 2020  o_kernel.       
+0003fef0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0003ff00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0003ff10: 6b65 726e 656c 203d 2064 6f75 626c 655f  kernel = double_
+0003ff20: 7368 6f5f 6b65 726e 656c 202b 206b 6572  sho_kernel + ker
+0003ff30: 6e65 6c5f 6a69 7474 6572 0a20 2020 2020  nel_jitter.     
+0003ff40: 2020 2020 2020 2023 2057 6520 6172 6520         # We are 
+0003ff50: 7573 696e 6720 6365 6c65 7269 7465 3a0a  using celerite:.
+0003ff60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0003ff70: 2e75 7365 5f63 656c 6572 6974 6520 3d20  .use_celerite = 
+0003ff80: 5472 7565 0a20 2020 2020 2020 2023 2320  True.        ## 
+0003ff90: 466f 7220 4d61 7465 726e 2b53 484f 206b  For Matern+SHO k
+0003ffa0: 6572 6e65 6c0a 2020 2020 2020 2020 656c  ernel.        el
+0003ffb0: 6966 2073 656c 662e 6b65 726e 656c 5f6e  if self.kernel_n
+0003ffc0: 616d 6520 3d3d 2027 4365 6c65 7269 7465  ame == 'Celerite
+0003ffd0: 4d61 7465 726e 5348 4f4b 6572 6e65 6c27  MaternSHOKernel'
+0003ffe0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0003fff0: 4d61 7465 726e 206b 6572 6e65 6c3a 0a20  Matern kernel:. 
+00040000: 2020 2020 2020 2020 2020 206d 6174 6572             mater
+00040010: 6e5f 6b65 726e 656c 203d 2074 6572 6d73  n_kernel = terms
+00040020: 2e4d 6174 6572 6e33 3254 6572 6d28 6c6f  .Matern32Term(lo
+00040030: 675f 7369 676d 613d 6e70 2e6c 6f67 2831  g_sigma=np.log(1
+00040040: 302e 292c 206c 6f67 5f72 686f 3d6e 702e  0.), log_rho=np.
+00040050: 6c6f 6728 3130 2e29 2c20 6570 7320 3d20  log(10.), eps = 
+00040060: 6d61 7465 726e 5f65 7073 290a 2020 2020  matern_eps).    
+00040070: 2020 2020 2020 2020 2320 5348 4f20 6b65          # SHO ke
+00040080: 726e 656c 3a0a 2020 2020 2020 2020 2020  rnel:.          
+00040090: 2020 7368 6f5f 6b65 726e 656c 203d 2074    sho_kernel = t
+000400a0: 6572 6d73 2e53 484f 5465 726d 286c 6f67  erms.SHOTerm(log
+000400b0: 5f53 303d 6e70 2e6c 6f67 2831 302e 292c  _S0=np.log(10.),
+000400c0: 206c 6f67 5f51 3d6e 702e 6c6f 6728 3130   log_Q=np.log(10
+000400d0: 2e29 2c6c 6f67 5f6f 6d65 6761 303d 6e70  .),log_omega0=np
+000400e0: 2e6c 6f67 2831 302e 2929 0a20 2020 2020  .log(10.)).     
+000400f0: 2020 2020 2020 2023 204a 6974 7465 7220         # Jitter 
+00040100: 7465 726d 3a0a 2020 2020 2020 2020 2020  term:.          
+00040110: 2020 6b65 726e 656c 5f6a 6974 7465 7220    kernel_jitter 
+00040120: 3d20 7465 726d 732e 4a69 7474 6572 5465  = terms.JitterTe
+00040130: 726d 286e 702e 6c6f 6728 3130 302a 3165  rm(np.log(100*1e
+00040140: 2d36 2929 0a20 2020 2020 2020 2020 2020  -6)).           
+00040150: 2023 2057 7261 7020 4750 206b 6572 6e65   # Wrap GP kerne
+00040160: 6c20 616e 6420 6f62 6a65 6374 3a0a 2020  l and object:.  
+00040170: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00040180: 662e 696e 7374 7275 6d65 6e74 2069 6e20  f.instrument in 
+00040190: 5b27 7276 272c 276c 6327 5d3a 0a20 2020  ['rv','lc']:.   
+000401a0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000401b0: 662e 6b65 726e 656c 203d 206d 6174 6572  f.kernel = mater
+000401c0: 6e5f 6b65 726e 656c 202b 2073 686f 5f6b  n_kernel + sho_k
+000401d0: 6572 6e65 6c0a 2020 2020 2020 2020 2020  ernel.          
+000401e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000401f0: 2020 2020 2020 2020 7365 6c66 2e6b 6572          self.ker
+00040200: 6e65 6c20 3d20 6d61 7465 726e 5f6b 6572  nel = matern_ker
+00040210: 6e65 6c20 2b20 7368 6f5f 6b65 726e 656c  nel + sho_kernel
+00040220: 202b 206b 6572 6e65 6c5f 6a69 7474 6572   + kernel_jitter
+00040230: 0a20 2020 2020 2020 2020 2020 2023 2041  .            # A
+00040240: 6e64 2077 6520 6172 6520 7573 696e 6720  nd we are using 
+00040250: 6365 6c65 7269 7465 0a20 2020 2020 2020  celerite.       
+00040260: 2020 2020 2073 656c 662e 7573 655f 6365       self.use_ce
+00040270: 6c65 7269 7465 203d 2054 7275 650a 2020  lerite = True.  
+00040280: 2020 2020 2020 2320 4368 6563 6b20 6966        # Check if
+00040290: 2075 7365 5f63 656c 6572 6974 6520 6973   use_celerite is
+000402a0: 2054 7275 653b 2069 6620 5472 7565 2c20   True; if True, 
+000402b0: 6368 6563 6b20 7468 6174 2074 6865 2072  check that the r
+000402c0: 6567 7265 7373 6f72 2069 7320 6f72 6465  egressor is orde
+000402d0: 7265 642e 2049 6620 6e6f 742c 2064 6f6e  red. If not, don
+000402e0: 2774 2064 6f20 7468 6520 7365 6c66 2e69  't do the self.i
+000402f0: 6e69 745f 4750 2829 3a0a 2020 2020 2020  nit_GP():.      
+00040300: 2020 6966 2073 656c 662e 7573 655f 6365    if self.use_ce
+00040310: 6c65 7269 7465 3a0a 2020 2020 2020 2020  lerite:.        
+00040320: 2020 2020 6964 785f 736f 7274 6564 203d      idx_sorted =
+00040330: 206e 702e 6172 6773 6f72 7428 7365 6c66   np.argsort(self
+00040340: 2e58 290a 2020 2020 2020 2020 2020 2020  .X).            
+00040350: 6c58 203d 206c 656e 2873 656c 662e 5829  lX = len(self.X)
+00040360: 0a20 2020 2020 2020 2020 2020 2064 6966  .            dif
+00040370: 6631 203d 206e 702e 636f 756e 745f 6e6f  f1 = np.count_no
+00040380: 6e7a 6572 6f28 7365 6c66 2e58 202d 2073  nzero(self.X - s
+00040390: 656c 662e 585b 6964 785f 736f 7274 6564  elf.X[idx_sorted
+000403a0: 5d29 0a20 2020 2020 2020 2020 2020 2064  ]).            d
+000403b0: 6966 6632 203d 206e 702e 636f 756e 745f  iff2 = np.count_
+000403c0: 6e6f 6e7a 6572 6f28 7365 6c66 2e58 202d  nonzero(self.X -
+000403d0: 2073 656c 662e 585b 6964 785f 736f 7274   self.X[idx_sort
+000403e0: 6564 5b3a 3a2d 315d 5d29 0a20 2020 2020  ed[::-1]]).     
+000403f0: 2020 2020 2020 2069 6620 6469 6666 3120         if diff1 
+00040400: 3d3d 2030 206f 7220 6469 6666 3220 3d3d  == 0 or diff2 ==
+00040410: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00040420: 2020 2020 7365 6c66 2e69 6e69 745f 4750      self.init_GP
+00040430: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+00040440: 2020 2073 656c 662e 6973 496e 6974 203d     self.isInit =
+00040450: 2054 7275 650a 2020 2020 2020 2020 656c   True.        el
+00040460: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00040470: 7365 6c66 2e69 6e69 745f 4750 2829 0a20  self.init_GP(). 
+00040480: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00040490: 6973 496e 6974 203d 2054 7275 650a 0a20  isInit = True.. 
+000404a0: 2020 2020 2020 2069 6620 7365 6c66 2e67         if self.g
+000404b0: 6c6f 6261 6c5f 4750 3a0a 2020 2020 2020  lobal_GP:.      
+000404c0: 2020 2020 2020 2320 4966 2069 6e73 7472        # If instr
+000404d0: 756d 656e 7420 6973 2027 7276 2720 6f72  ument is 'rv' or
+000404e0: 2027 6c63 272c 2061 7373 756d 6520 4750   'lc', assume GP
+000404f0: 206f 626a 6563 7420 7769 6c6c 2066 6974   object will fit
+00040500: 2066 6f72 2061 2067 6c6f 6261 6c20 4750   for a global GP
+00040510: 0a20 2020 2020 2020 2020 2020 2023 2028  .            # (
+00040520: 652e 672e 2c20 676c 6f62 616c 2070 686f  e.g., global pho
+00040530: 746f 6d65 7472 6963 2073 6967 6e61 6c2c  tometric signal,
+00040540: 206f 7220 676c 6f62 616c 2052 5620 7369   or global RV si
+00040550: 676e 616c 2920 7468 6174 2061 7373 756d  gnal) that assum
+00040560: 6573 2061 2067 6976 656e 0a20 2020 2020  es a given.     
+00040570: 2020 2020 2020 2023 2047 5020 7265 616c         # GP real
+00040580: 697a 6174 696f 6e20 666f 7220 616c 6c20  ization for all 
+00040590: 696e 7374 7275 6d65 6e74 7320 2862 7574  instruments (but
+000405a0: 2061 6c6c 6f77 7320 6469 6666 6572 656e   allows differen
+000405b0: 7420 6a69 7474 6572 7320 666f 7220 6561  t jitters for ea
+000405c0: 6368 0a20 2020 2020 2020 2020 2020 2023  ch.            #
+000405d0: 2069 6e73 7472 756d 656e 742c 2061 6464   instrument, add
+000405e0: 6564 2069 6e20 7175 6164 7261 7475 7265  ed in quadrature
+000405f0: 2074 6f20 7468 6520 7365 6c66 2e79 6572   to the self.yer
+00040600: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00040610: 7365 6c66 2e70 6172 616d 6574 6572 5f76  self.parameter_v
+00040620: 6563 746f 7220 3d20 6e70 2e7a 6572 6f73  ector = np.zeros
+00040630: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00040640: 2020 6c65 6e28 7365 6c66 2e76 6172 6961    len(self.varia
+00040650: 626c 6573 2920 2b20 7068 616e 746f 6d76  bles) + phantomv
+00040660: 6172 6961 626c 6529 0a20 2020 2020 2020  ariable).       
+00040670: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00040680: 2020 2023 2049 6620 4750 2070 6572 2069     # If GP per i
+00040690: 6e73 7472 756d 656e 742c 2074 6865 6e20  nstrument, then 
+000406a0: 7468 6572 6520 6973 206f 6e65 206a 6974  there is one jit
+000406b0: 7465 7220 7465 726d 2070 6572 2069 6e73  ter term per ins
+000406c0: 7472 756d 656e 7420 6469 7265 6374 6c79  trument directly
+000406d0: 2061 6464 6564 2069 6e20 7468 6520 6d6f   added in the mo
+000406e0: 6465 6c3a 0a20 2020 2020 2020 2020 2020  del:.           
+000406f0: 2073 656c 662e 7061 7261 6d65 7465 725f   self.parameter_
+00040700: 7665 6374 6f72 203d 206e 702e 7a65 726f  vector = np.zero
+00040710: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00040720: 2020 206c 656e 2873 656c 662e 7661 7269     len(self.vari
+00040730: 6162 6c65 7329 202b 2031 202b 2070 6861  ables) + 1 + pha
+00040740: 6e74 6f6d 7661 7269 6162 6c65 290a 2020  ntomvariable).  
+00040750: 2020 2020 2020 7365 6c66 2e73 6574 5f69        self.set_i
+00040760: 6e70 7574 5f69 6e73 7472 756d 656e 7428  nput_instrument(
+00040770: 6461 7461 2e70 7269 6f72 7329 0a         data.priors).
```

## juliet/utils.py

```diff
@@ -739,15 +739,15 @@
                 np.sqrt(np.var(y[i:i + n_bin - 1])) /
                 np.sqrt(len(y[i:i + n_bin - 1]))
                              )
 
         else:
 
             y_err_bins.append(
-                np.sqrt( np.sum( yerr[i: i + n_bin - 1]**2 ) / len( yerr[i: i + n_bin - 1] )  )
+                np.sqrt( np.sum( yerr[i: i + n_bin - 1]**2 ) ) / float( len( yerr[i: i + n_bin - 1] )  )
                             ) 
 
     return np.array(x_bins), np.array(y_bins), np.array(y_err_bins)
 
 
 def writepp(fout, posteriors, priors):
     if 'pu' in posteriors:
```

## Comparing `juliet-2.2.5.dist-info/AUTHORS.rst` & `juliet-2.2.6.dist-info/AUTHORS.rst`

 * *Files identical despite different names*

## Comparing `juliet-2.2.5.dist-info/LICENSE` & `juliet-2.2.6.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `juliet-2.2.5.dist-info/METADATA` & `juliet-2.2.6.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: juliet
-Version: 2.2.5
+Version: 2.2.6
 Summary: juliet: a versatile modelling tool for transiting exoplanets, radial-velocity systems or both
 Home-page: http://github.com/nespinoza/juliet
 Author: Nestor Espinoza
 Author-email: nespinoza@stsci.edu
 License: MIT
 Requires-Python: >=2.7
 License-File: LICENSE
```

