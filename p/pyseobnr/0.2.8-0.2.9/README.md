# Comparing `tmp/pyseobnr-0.2.8.tar.gz` & `tmp/pyseobnr-0.2.9.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "pyseobnr-0.2.8.tar", last modified: Mon Feb 19 13:37:17 2024, max compression
+gzip compressed data, was "pyseobnr-0.2.9.tar", last modified: Thu May  2 18:03:44 2024, max compression
```

## Comparing `pyseobnr-0.2.8.tar` & `pyseobnr-0.2.9.tar`

### file list

```diff
@@ -1,167 +1,175 @@
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.533741 pyseobnr-0.2.8/
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.497079 pyseobnr-0.2.8/.gitlab/
--rw-r--r--   0 raffi      (502) admin       (80)     4228 2024-02-19 13:35:42.000000 pyseobnr-0.2.8/.gitlab/aei.yml
--rw-r--r--   0 raffi      (502) admin       (80)      320 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/AUTHORS.md
--rw-r--r--   0 raffi      (502) admin       (80)     1181 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/CHANGELOG.md
--rw-r--r--   0 raffi      (502) admin       (80)     4458 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/CONTRIBUTING.md
--rw-r--r--   0 raffi      (502) admin       (80)    35147 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/LICENSE
--rw-r--r--   0 raffi      (502) admin       (80)       90 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/MANIFEST.in
--rw-r--r--   0 raffi      (502) admin       (80)     7521 2024-02-19 13:37:17.533506 pyseobnr-0.2.8/PKG-INFO
--rw-r--r--   0 raffi      (502) admin       (80)     5813 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/README.rst
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.497725 pyseobnr-0.2.8/docs/
--rw-r--r--   0 raffi      (502) admin       (80)      580 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/docs/Makefile
--rw-r--r--   0 raffi      (502) admin       (80)      194 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/docs/README.md
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.497966 pyseobnr-0.2.8/docs/_static/
--rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/docs/_static/.gitkeep
--rw-r--r--   0 raffi      (502) admin       (80)     7119 2024-02-19 13:35:42.000000 pyseobnr-0.2.8/docs/_static/pyseobnr_120px.png
--rw-r--r--   0 raffi      (502) admin       (80)     2528 2024-02-19 13:35:42.000000 pyseobnr-0.2.8/docs/conf.py
--rw-r--r--   0 raffi      (502) admin       (80)     1019 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/docs/index.rst
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.498534 pyseobnr-0.2.8/docs/source/
--rw-r--r--   0 raffi      (502) admin       (80)     3583 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/docs/source/basic_usage.rst
--rw-r--r--   0 raffi      (502) admin       (80)     3170 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/docs/source/citations.rst
--rw-r--r--   0 raffi      (502) admin       (80)     1768 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/docs/source/expert_mode.rst
--rw-r--r--   0 raffi      (502) admin       (80)     3579 2024-02-19 13:35:42.000000 pyseobnr-0.2.8/docs/source/installation.rst
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.498699 pyseobnr-0.2.8/docs/source/notebooks/
--rw-r--r--   0 raffi      (502) admin       (80)     2712 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/docs/source/notebooks/getting_started.md
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.498955 pyseobnr-0.2.8/docs/templates/
--rw-r--r--   0 raffi      (502) admin       (80)      639 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/docs/templates/custom-class-template.rst
--rw-r--r--   0 raffi      (502) admin       (80)     1465 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/docs/templates/custom-module-template.rst
--rw-r--r--   0 raffi      (502) admin       (80)     1926 2024-02-19 13:35:42.000000 pyseobnr-0.2.8/pyproject.toml
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.499349 pyseobnr-0.2.8/pyseobnr/
--rw-r--r--   0 raffi      (502) admin       (80)      238 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/__init__.py
--rw-r--r--   0 raffi      (502) admin       (80)      411 2024-02-19 13:37:17.000000 pyseobnr-0.2.8/pyseobnr/_version.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.500293 pyseobnr-0.2.8/pyseobnr/auxiliary/
--rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/__init__.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.500631 pyseobnr-0.2.8/pyseobnr/auxiliary/external_models/
--rw-r--r--   0 raffi      (502) admin       (80)      122 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/external_models/__init__.py
--rw-r--r--   0 raffi      (502) admin       (80)     3727 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/external_models/default_settings.py
--rw-r--r--   0 raffi      (502) admin       (80)    19281 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/external_models/external_models.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.500906 pyseobnr-0.2.8/pyseobnr/auxiliary/interpolate/
--rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/interpolate/__init__.py
--rw-r--r--   0 raffi      (502) admin       (80)      363 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/interpolate/vector_spline.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.501125 pyseobnr-0.2.8/pyseobnr/auxiliary/mode_mixing/
--rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/mode_mixing/__init__.py
--rw-r--r--   0 raffi      (502) admin       (80)    16310 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/mode_mixing/auxiliary_functions_modemixing.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.505060 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/
--rw-r--r--   0 raffi      (502) admin       (80)     8717 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/EOB_matches.py
--rw-r--r--   0 raffi      (502) admin       (80)    16819 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/NRSur_IV_difference.py
--rw-r--r--   0 raffi      (502) admin       (80)    10669 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/NRSur_matches.py
--rw-r--r--   0 raffi      (502) admin       (80)    10093 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/NR_mismatches.py
--rw-r--r--   0 raffi      (502) admin       (80)    13097 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.py
--rw-r--r--   0 raffi      (502) admin       (80)      708 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.sh
--rw-r--r--   0 raffi      (502) admin       (80)    14920 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.py
--rw-r--r--   0 raffi      (502) admin       (80)      710 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.sh
--rw-r--r--   0 raffi      (502) admin       (80)     2070 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/amp_hierarchy_test_prec_submission.py
--rw-r--r--   0 raffi      (502) admin       (80)     4831 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test.py
--rw-r--r--   0 raffi      (502) admin       (80)     8561 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test_precessing.py
--rw-r--r--   0 raffi      (502) admin       (80)     2804 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/attachment_smoothness_test.py
--rw-r--r--   0 raffi      (502) admin       (80)     6378 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/battery_of_tests.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.505638 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/metrics/
--rw-r--r--   0 raffi      (502) admin       (80)       48 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/metrics/__init__.py
--rw-r--r--   0 raffi      (502) admin       (80)      389 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/metrics/default_settings.py
--rw-r--r--   0 raffi      (502) admin       (80)     8405 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/metrics/metrics.py
--rw-r--r--   0 raffi      (502) admin       (80)     9059 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/metrics/unfaithfulness_mode_by_mode.py
--rw-r--r--   0 raffi      (502) admin       (80)    16633 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.py
--rw-r--r--   0 raffi      (502) admin       (80)      766 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.sh
--rw-r--r--   0 raffi      (502) admin       (80)     4114 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/mismatch_fixed_waveform_test.py
--rw-r--r--   0 raffi      (502) admin       (80)    11573 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_aligned.py
--rw-r--r--   0 raffi      (502) admin       (80)    15786 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.py
--rw-r--r--   0 raffi      (502) admin       (80)      737 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.sh
--rw-r--r--   0 raffi      (502) admin       (80)     7490 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/monotonicity_test.py
--rw-r--r--   0 raffi      (502) admin       (80)     3720 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/parameters.py
--rw-r--r--   0 raffi      (502) admin       (80)     8464 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/phenom_matches.py
--rw-r--r--   0 raffi      (502) admin       (80)     3706 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/reference_smoothness_test.py
--rw-r--r--   0 raffi      (502) admin       (80)     2322 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/single_waveform_tests.py
--rw-r--r--   0 raffi      (502) admin       (80)     7088 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/smoothness_q_chi.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.505767 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/templates/
--rw-r--r--   0 raffi      (502) admin       (80)      546 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/templates/slurm.jinja
--rw-r--r--   0 raffi      (502) admin       (80)    18240 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/v5P_NR_coprecessing_match.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.505891 pyseobnr-0.2.8/pyseobnr/eob/
--rw-r--r--   0 raffi      (502) admin       (80)       51 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/__init__.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.511838 pyseobnr-0.2.8/pyseobnr/eob/dynamics/
--rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/__init__.py
--rw-r--r--   0 raffi      (502) admin       (80)     4444 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/initial_conditions_aligned_opt.py
--rw-r--r--   0 raffi      (502) admin       (80)     6412 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/initial_conditions_aligned_precessing.py
--rw-r--r--   0 raffi      (502) admin       (80)     4612 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/initial_conditions_precessing_postadiabatic.py
--rwxr-xr-x   0 raffi      (502) admin       (80)     8803 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/integrate_ode.py
--rw-r--r--   0 raffi      (502) admin       (80)    22408 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/integrate_ode_prec.py
--rw-r--r--   0 raffi      (502) admin       (80)    30463 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/pn_evolution_opt.py
--rw-r--r--   0 raffi      (502) admin       (80)  1859465 2024-02-19 13:37:09.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/postadiabatic_C.c
--rw-r--r--   0 raffi      (502) admin       (80)      534 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/postadiabatic_C.pxd
--rw-r--r--   0 raffi      (502) admin       (80)    20939 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/postadiabatic_C.pyx
--rw-r--r--   0 raffi      (502) admin       (80)  1407624 2024-02-19 13:37:10.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/postadiabatic_C_fast.c
--rw-r--r--   0 raffi      (502) admin       (80)    12302 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx
--rw-r--r--   0 raffi      (502) admin       (80)  2040803 2024-02-19 13:37:11.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/postadiabatic_C_prec.c
--rw-r--r--   0 raffi      (502) admin       (80)    52383 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/postadiabatic_C_prec.pyx
--rw-r--r--   0 raffi      (502) admin       (80)  1215819 2024-02-19 13:37:13.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/rhs_aligned.c
--rw-r--r--   0 raffi      (502) admin       (80)     2739 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/rhs_aligned.pyx
--rw-r--r--   0 raffi      (502) admin       (80)  1187244 2024-02-19 13:37:13.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/rhs_precessing.c
--rw-r--r--   0 raffi      (502) admin       (80)      393 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/rhs_precessing.pxd
--rw-r--r--   0 raffi      (502) admin       (80)     2427 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/dynamics/rhs_precessing.pyx
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.512631 pyseobnr-0.2.8/pyseobnr/eob/fits/
--rw-r--r--   0 raffi      (502) admin       (80)     9426 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/fits/EOB_fits.py
--rw-r--r--   0 raffi      (502) admin       (80)     1956 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/fits/GSF_fits.py
--rw-r--r--   0 raffi      (502) admin       (80)    30426 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/fits/IV_fits.py
--rw-r--r--   0 raffi      (502) admin       (80)    14119 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/fits/MR_fits.py
--rw-r--r--   0 raffi      (502) admin       (80)      155 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/fits/__init__.py
--rw-r--r--   0 raffi      (502) admin       (80)     5336 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/fits/fits_Hamiltonian.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.523692 pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/
--rw-r--r--   0 raffi      (502) admin       (80)  2541778 2024-02-19 13:37:14.000000 pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.c
--rw-r--r--   0 raffi      (502) admin       (80)   137452 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.pyx
--rw-r--r--   0 raffi      (502) admin       (80)  2398440 2024-02-19 13:37:16.000000 pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.c
--rw-r--r--   0 raffi      (502) admin       (80)   119553 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.pyx
--rw-r--r--   0 raffi      (502) admin       (80)  1196485 2024-02-19 13:02:51.000000 pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Hamiltonian_C.c
--rw-r--r--   0 raffi      (502) admin       (80)      827 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd
--rw-r--r--   0 raffi      (502) admin       (80)      942 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx
--rw-r--r--   0 raffi      (502) admin       (80)  1251213 2024-02-19 13:02:52.000000 pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.c
--rw-r--r--   0 raffi      (502) admin       (80)     1253 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd
--rw-r--r--   0 raffi      (502) admin       (80)     1342 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx
--rw-r--r--   0 raffi      (502) admin       (80)       56 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/__init__.py
--rw-r--r--   0 raffi      (502) admin       (80)     1196 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/hamiltonian.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.525355 pyseobnr-0.2.8/pyseobnr/eob/utils/
--rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/utils/__init__.pxd
--rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/utils/__init__.py
--rw-r--r--   0 raffi      (502) admin       (80)  1600906 2024-02-19 13:37:16.000000 pyseobnr-0.2.8/pyseobnr/eob/utils/containers.c
--rw-r--r--   0 raffi      (502) admin       (80)     2272 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/utils/containers.pxd
--rw-r--r--   0 raffi      (502) admin       (80)     4283 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/utils/containers.pyx
--rw-r--r--   0 raffi      (502) admin       (80)       37 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/utils/eob_parameters.h
--rw-r--r--   0 raffi      (502) admin       (80)     1409 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/utils/math_ops_opt.py
--rw-r--r--   0 raffi      (502) admin       (80)    23945 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/utils/utils_precession_opt.py
--rw-r--r--   0 raffi      (502) admin       (80)      784 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/utils/waveform_ops.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.526960 pyseobnr-0.2.8/pyseobnr/eob/waveform/
--rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/waveform/__init__.py
--rw-r--r--   0 raffi      (502) admin       (80)     3694 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/waveform/compute_MR.py
--rw-r--r--   0 raffi      (502) admin       (80)    19997 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/waveform/compute_hlms.py
--rw-r--r--   0 raffi      (502) admin       (80)  1969674 2024-02-19 13:37:12.000000 pyseobnr-0.2.8/pyseobnr/eob/waveform/waveform.c
--rw-r--r--   0 raffi      (502) admin       (80)      653 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/waveform/waveform.pxd
--rw-r--r--   0 raffi      (502) admin       (80)    85160 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/eob/waveform/waveform.pyx
--rw-r--r--   0 raffi      (502) admin       (80)    26496 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/generate_waveform.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.530544 pyseobnr-0.2.8/pyseobnr/models/
--rw-r--r--   0 raffi      (502) admin       (80)    53392 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/models/SEOBNRv5HM.py
--rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/models/__init__.py
--rw-r--r--   0 raffi      (502) admin       (80)      280 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/pyseobnr/models/model.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.532570 pyseobnr-0.2.8/pyseobnr.egg-info/
--rw-r--r--   0 raffi      (502) admin       (80)     7521 2024-02-19 13:37:17.000000 pyseobnr-0.2.8/pyseobnr.egg-info/PKG-INFO
--rw-r--r--   0 raffi      (502) admin       (80)     5762 2024-02-19 13:37:17.000000 pyseobnr-0.2.8/pyseobnr.egg-info/SOURCES.txt
--rw-r--r--   0 raffi      (502) admin       (80)        1 2024-02-19 13:37:17.000000 pyseobnr-0.2.8/pyseobnr.egg-info/dependency_links.txt
--rw-r--r--   0 raffi      (502) admin       (80)        1 2024-02-19 13:37:16.000000 pyseobnr-0.2.8/pyseobnr.egg-info/not-zip-safe
--rw-r--r--   0 raffi      (502) admin       (80)      316 2024-02-19 13:37:17.000000 pyseobnr-0.2.8/pyseobnr.egg-info/requires.txt
--rw-r--r--   0 raffi      (502) admin       (80)        9 2024-02-19 13:37:17.000000 pyseobnr-0.2.8/pyseobnr.egg-info/top_level.txt
--rw-r--r--   0 raffi      (502) admin       (80)       38 2024-02-19 13:37:17.533779 pyseobnr-0.2.8/setup.cfg
--rw-r--r--   0 raffi      (502) admin       (80)     3234 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/setup.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.530694 pyseobnr-0.2.8/test/
--rw-r--r--   0 raffi      (502) admin       (80)       74 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/test/conftest.py
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.530846 pyseobnr-0.2.8/test/data/
--rw-r--r--   0 raffi      (502) admin       (80)   181547 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/test/data/frame_hm.csv.gz
-drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-02-19 13:37:17.532398 pyseobnr-0.2.8/test/regression_tests/
--rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/test/regression_tests/__init__.py
--rw-r--r--   0 raffi      (502) admin       (80)     2831 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/test/regression_tests/helpers.py
--rw-r--r--   0 raffi      (502) admin       (80)     3386 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/test/regression_tests/regenerate_SEOBNRv5HM.py
--rw-r--r--   0 raffi      (502) admin       (80)     3413 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/test/regression_tests/regenerate_SEOBNRv5PHM.py
--rw-r--r--   0 raffi      (502) admin       (80)     4458 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/test/regression_tests/template_v5HM_tests.jinja
--rw-r--r--   0 raffi      (502) admin       (80)     4494 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/test/regression_tests/template_v5PHM_tests.jinja
--rw-r--r--   0 raffi      (502) admin       (80)     4635 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/test/regression_tests/test_SEOBNRv5HM.py
--rw-r--r--   0 raffi      (502) admin       (80)     1530 2024-02-19 13:35:42.000000 pyseobnr-0.2.8/test/regression_tests/test_SEOBNRv5HM_dynamics.py
--rw-r--r--   0 raffi      (502) admin       (80)     4697 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/test/regression_tests/test_SEOBNRv5PHM.py
--rw-r--r--   0 raffi      (502) admin       (80)     2297 2024-02-19 12:52:32.000000 pyseobnr-0.2.8/test/regression_tests/test_settings.py
--rw-r--r--   0 raffi      (502) admin       (80)     1225 2024-02-19 13:35:42.000000 pyseobnr-0.2.8/tox.ini
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.190868 pyseobnr-0.2.9/
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.159663 pyseobnr-0.2.9/.github/
+-rw-r--r--   0 raffi      (502) admin       (80)      546 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/.github/PULL_REQUEST_TEMPLATE.md
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.159905 pyseobnr-0.2.9/.github/workflows/
+-rw-r--r--   0 raffi      (502) admin       (80)      535 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/.github/workflows/github.yml
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.160147 pyseobnr-0.2.9/.gitlab/
+-rw-r--r--   0 raffi      (502) admin       (80)     4235 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/.gitlab/aei.yml
+-rw-r--r--   0 raffi      (502) admin       (80)      320 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/AUTHORS.md
+-rw-r--r--   0 raffi      (502) admin       (80)     1252 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/CHANGELOG.md
+-rw-r--r--   0 raffi      (502) admin       (80)     4458 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/CONTRIBUTING.md
+-rw-r--r--   0 raffi      (502) admin       (80)    35147 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/LICENSE
+-rw-r--r--   0 raffi      (502) admin       (80)       90 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/MANIFEST.in
+-rw-r--r--   0 raffi      (502) admin       (80)     7561 2024-05-02 18:03:44.190646 pyseobnr-0.2.9/PKG-INFO
+-rw-r--r--   0 raffi      (502) admin       (80)     5813 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/README.rst
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.160867 pyseobnr-0.2.9/docs/
+-rw-r--r--   0 raffi      (502) admin       (80)      580 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/docs/Makefile
+-rw-r--r--   0 raffi      (502) admin       (80)      194 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/docs/README.md
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.161079 pyseobnr-0.2.9/docs/_static/
+-rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/docs/_static/.gitkeep
+-rw-r--r--   0 raffi      (502) admin       (80)     7119 2024-02-19 13:35:42.000000 pyseobnr-0.2.9/docs/_static/pyseobnr_120px.png
+-rw-r--r--   0 raffi      (502) admin       (80)     2528 2024-02-19 13:35:42.000000 pyseobnr-0.2.9/docs/conf.py
+-rw-r--r--   0 raffi      (502) admin       (80)     1061 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/docs/index.rst
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.161627 pyseobnr-0.2.9/docs/source/
+-rw-r--r--   0 raffi      (502) admin       (80)     3583 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/docs/source/basic_usage.rst
+-rw-r--r--   0 raffi      (502) admin       (80)     3170 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/docs/source/citations.rst
+-rw-r--r--   0 raffi      (502) admin       (80)     1768 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/docs/source/expert_mode.rst
+-rw-r--r--   0 raffi      (502) admin       (80)     3579 2024-02-19 13:35:42.000000 pyseobnr-0.2.9/docs/source/installation.rst
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.161877 pyseobnr-0.2.9/docs/source/notebooks/
+-rw-r--r--   0 raffi      (502) admin       (80)     4103 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/docs/source/notebooks/example_precession.md
+-rw-r--r--   0 raffi      (502) admin       (80)     2712 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/docs/source/notebooks/getting_started.md
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.162127 pyseobnr-0.2.9/docs/templates/
+-rw-r--r--   0 raffi      (502) admin       (80)      639 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/docs/templates/custom-class-template.rst
+-rw-r--r--   0 raffi      (502) admin       (80)     1465 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/docs/templates/custom-module-template.rst
+-rw-r--r--   0 raffi      (502) admin       (80)     2488 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyproject.toml
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.162588 pyseobnr-0.2.9/pyseobnr/
+-rw-r--r--   0 raffi      (502) admin       (80)      160 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/__init__.py
+-rw-r--r--   0 raffi      (502) admin       (80)      411 2024-05-02 18:03:44.000000 pyseobnr-0.2.9/pyseobnr/_version.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.163790 pyseobnr-0.2.9/pyseobnr/auxiliary/
+-rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/__init__.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.164159 pyseobnr-0.2.9/pyseobnr/auxiliary/external_models/
+-rw-r--r--   0 raffi      (502) admin       (80)      122 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/external_models/__init__.py
+-rw-r--r--   0 raffi      (502) admin       (80)     3727 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/external_models/default_settings.py
+-rw-r--r--   0 raffi      (502) admin       (80)    19281 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/external_models/external_models.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.164415 pyseobnr-0.2.9/pyseobnr/auxiliary/interpolate/
+-rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/interpolate/__init__.py
+-rw-r--r--   0 raffi      (502) admin       (80)      363 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/interpolate/vector_spline.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.164631 pyseobnr-0.2.9/pyseobnr/auxiliary/mode_mixing/
+-rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/mode_mixing/__init__.py
+-rw-r--r--   0 raffi      (502) admin       (80)    16393 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/mode_mixing/auxiliary_functions_modemixing.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.168640 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/
+-rw-r--r--   0 raffi      (502) admin       (80)     8717 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/EOB_matches.py
+-rw-r--r--   0 raffi      (502) admin       (80)    16819 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/NRSur_IV_difference.py
+-rw-r--r--   0 raffi      (502) admin       (80)    10669 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/NRSur_matches.py
+-rw-r--r--   0 raffi      (502) admin       (80)    10093 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/NR_mismatches.py
+-rw-r--r--   0 raffi      (502) admin       (80)    13097 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.py
+-rw-r--r--   0 raffi      (502) admin       (80)      708 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.sh
+-rw-r--r--   0 raffi      (502) admin       (80)    14920 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.py
+-rw-r--r--   0 raffi      (502) admin       (80)      710 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.sh
+-rw-r--r--   0 raffi      (502) admin       (80)     2070 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/amp_hierarchy_test_prec_submission.py
+-rw-r--r--   0 raffi      (502) admin       (80)     4831 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test.py
+-rw-r--r--   0 raffi      (502) admin       (80)     8561 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test_precessing.py
+-rw-r--r--   0 raffi      (502) admin       (80)     2804 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/attachment_smoothness_test.py
+-rw-r--r--   0 raffi      (502) admin       (80)     6378 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/battery_of_tests.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.169184 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/metrics/
+-rw-r--r--   0 raffi      (502) admin       (80)       48 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/metrics/__init__.py
+-rw-r--r--   0 raffi      (502) admin       (80)      389 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/metrics/default_settings.py
+-rw-r--r--   0 raffi      (502) admin       (80)     8405 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/metrics/metrics.py
+-rw-r--r--   0 raffi      (502) admin       (80)     9059 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/metrics/unfaithfulness_mode_by_mode.py
+-rw-r--r--   0 raffi      (502) admin       (80)    16633 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.py
+-rw-r--r--   0 raffi      (502) admin       (80)      766 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.sh
+-rw-r--r--   0 raffi      (502) admin       (80)     4114 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/mismatch_fixed_waveform_test.py
+-rw-r--r--   0 raffi      (502) admin       (80)    11573 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_aligned.py
+-rw-r--r--   0 raffi      (502) admin       (80)    15786 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.py
+-rw-r--r--   0 raffi      (502) admin       (80)      737 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.sh
+-rw-r--r--   0 raffi      (502) admin       (80)     7490 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/monotonicity_test.py
+-rw-r--r--   0 raffi      (502) admin       (80)     3720 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/parameters.py
+-rw-r--r--   0 raffi      (502) admin       (80)     8464 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/phenom_matches.py
+-rw-r--r--   0 raffi      (502) admin       (80)     3706 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/reference_smoothness_test.py
+-rw-r--r--   0 raffi      (502) admin       (80)     2322 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/single_waveform_tests.py
+-rw-r--r--   0 raffi      (502) admin       (80)     7088 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/smoothness_q_chi.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.169315 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/templates/
+-rw-r--r--   0 raffi      (502) admin       (80)      546 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/templates/slurm.jinja
+-rw-r--r--   0 raffi      (502) admin       (80)    18240 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/v5P_NR_coprecessing_match.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.169436 pyseobnr-0.2.9/pyseobnr/eob/
+-rw-r--r--   0 raffi      (502) admin       (80)       60 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/__init__.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.174942 pyseobnr-0.2.9/pyseobnr/eob/dynamics/
+-rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/__init__.py
+-rw-r--r--   0 raffi      (502) admin       (80)     4444 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/initial_conditions_aligned_opt.py
+-rw-r--r--   0 raffi      (502) admin       (80)     6412 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/initial_conditions_aligned_precessing.py
+-rw-r--r--   0 raffi      (502) admin       (80)     4820 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/initial_conditions_precessing_postadiabatic.py
+-rwxr-xr-x   0 raffi      (502) admin       (80)     6656 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/integrate_ode.py
+-rw-r--r--   0 raffi      (502) admin       (80)    22292 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/integrate_ode_prec.py
+-rw-r--r--   0 raffi      (502) admin       (80)    29992 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/pn_evolution_opt.py
+-rw-r--r--   0 raffi      (502) admin       (80)  1852551 2024-05-02 18:03:36.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/postadiabatic_C.c
+-rw-r--r--   0 raffi      (502) admin       (80)      534 2024-05-02 18:01:46.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/postadiabatic_C.pxd
+-rw-r--r--   0 raffi      (502) admin       (80)    20939 2024-05-02 18:01:46.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/postadiabatic_C.pyx
+-rw-r--r--   0 raffi      (502) admin       (80)  1407919 2024-05-02 18:03:36.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/postadiabatic_C_fast.c
+-rw-r--r--   0 raffi      (502) admin       (80)    12302 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx
+-rw-r--r--   0 raffi      (502) admin       (80)  2040844 2024-05-02 18:03:37.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/postadiabatic_C_prec.c
+-rw-r--r--   0 raffi      (502) admin       (80)    52383 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/postadiabatic_C_prec.pyx
+-rw-r--r--   0 raffi      (502) admin       (80)  1212505 2024-05-02 18:03:37.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/rhs_aligned.c
+-rw-r--r--   0 raffi      (502) admin       (80)     2806 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/rhs_aligned.pyx
+-rw-r--r--   0 raffi      (502) admin       (80)  1184371 2024-05-02 18:03:38.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/rhs_precessing.c
+-rw-r--r--   0 raffi      (502) admin       (80)      417 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/rhs_precessing.pxd
+-rw-r--r--   0 raffi      (502) admin       (80)     2401 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/dynamics/rhs_precessing.pyx
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.175747 pyseobnr-0.2.9/pyseobnr/eob/fits/
+-rw-r--r--   0 raffi      (502) admin       (80)     9521 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/fits/EOB_fits.py
+-rw-r--r--   0 raffi      (502) admin       (80)     1963 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/fits/GSF_fits.py
+-rw-r--r--   0 raffi      (502) admin       (80)    30073 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/fits/IV_fits.py
+-rw-r--r--   0 raffi      (502) admin       (80)    18675 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/fits/MR_fits.py
+-rw-r--r--   0 raffi      (502) admin       (80)      489 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/fits/__init__.py
+-rw-r--r--   0 raffi      (502) admin       (80)     5504 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/fits/fits_Hamiltonian.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.182814 pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/
+-rw-r--r--   0 raffi      (502) admin       (80)  2542693 2024-05-02 18:03:39.000000 pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.c
+-rw-r--r--   0 raffi      (502) admin       (80)   137452 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.pyx
+-rw-r--r--   0 raffi      (502) admin       (80)  2399319 2024-05-02 18:03:41.000000 pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.c
+-rw-r--r--   0 raffi      (502) admin       (80)   119553 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.pyx
+-rw-r--r--   0 raffi      (502) admin       (80)  1196986 2024-05-02 18:03:41.000000 pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Hamiltonian_C.c
+-rw-r--r--   0 raffi      (502) admin       (80)      827 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd
+-rw-r--r--   0 raffi      (502) admin       (80)      942 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx
+-rw-r--r--   0 raffi      (502) admin       (80)  1251714 2024-05-02 18:03:41.000000 pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.c
+-rw-r--r--   0 raffi      (502) admin       (80)     1253 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd
+-rw-r--r--   0 raffi      (502) admin       (80)     1342 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx
+-rw-r--r--   0 raffi      (502) admin       (80)       56 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/__init__.py
+-rw-r--r--   0 raffi      (502) admin       (80)     1196 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/hamiltonian.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.184936 pyseobnr-0.2.9/pyseobnr/eob/utils/
+-rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/utils/__init__.pxd
+-rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/utils/__init__.py
+-rw-r--r--   0 raffi      (502) admin       (80)  1601442 2024-05-02 18:03:42.000000 pyseobnr-0.2.9/pyseobnr/eob/utils/containers.c
+-rw-r--r--   0 raffi      (502) admin       (80)     2272 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/utils/containers.pxd
+-rw-r--r--   0 raffi      (502) admin       (80)     4283 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/utils/containers.pyx
+-rw-r--r--   0 raffi      (502) admin       (80)       37 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/utils/eob_parameters.h
+-rw-r--r--   0 raffi      (502) admin       (80)     1398 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/utils/math_ops_opt.py
+-rw-r--r--   0 raffi      (502) admin       (80)     2226 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/utils/utils.py
+-rw-r--r--   0 raffi      (502) admin       (80)    24912 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/utils/utils_precession_opt.py
+-rw-r--r--   0 raffi      (502) admin       (80)      809 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/utils/waveform_ops.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.186580 pyseobnr-0.2.9/pyseobnr/eob/waveform/
+-rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/waveform/__init__.py
+-rw-r--r--   0 raffi      (502) admin       (80)     3694 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/eob/waveform/compute_MR.py
+-rw-r--r--   0 raffi      (502) admin       (80)    20162 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/waveform/compute_hlms.py
+-rw-r--r--   0 raffi      (502) admin       (80)  1963980 2024-05-02 18:03:43.000000 pyseobnr-0.2.9/pyseobnr/eob/waveform/waveform.c
+-rw-r--r--   0 raffi      (502) admin       (80)      785 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/waveform/waveform.pxd
+-rw-r--r--   0 raffi      (502) admin       (80)    87304 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/eob/waveform/waveform.pyx
+-rw-r--r--   0 raffi      (502) admin       (80)    29210 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/generate_waveform.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.187283 pyseobnr-0.2.9/pyseobnr/models/
+-rw-r--r--   0 raffi      (502) admin       (80)    53535 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/models/SEOBNRv5HM.py
+-rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/models/__init__.py
+-rw-r--r--   0 raffi      (502) admin       (80)      126 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/pyseobnr/models/common.py
+-rw-r--r--   0 raffi      (502) admin       (80)      280 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/pyseobnr/models/model.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.189639 pyseobnr-0.2.9/pyseobnr.egg-info/
+-rw-r--r--   0 raffi      (502) admin       (80)     7561 2024-05-02 18:03:44.000000 pyseobnr-0.2.9/pyseobnr.egg-info/PKG-INFO
+-rw-r--r--   0 raffi      (502) admin       (80)     5958 2024-05-02 18:03:44.000000 pyseobnr-0.2.9/pyseobnr.egg-info/SOURCES.txt
+-rw-r--r--   0 raffi      (502) admin       (80)        1 2024-05-02 18:03:44.000000 pyseobnr-0.2.9/pyseobnr.egg-info/dependency_links.txt
+-rw-r--r--   0 raffi      (502) admin       (80)        1 2024-02-19 13:37:16.000000 pyseobnr-0.2.9/pyseobnr.egg-info/not-zip-safe
+-rw-r--r--   0 raffi      (502) admin       (80)      324 2024-05-02 18:03:44.000000 pyseobnr-0.2.9/pyseobnr.egg-info/requires.txt
+-rw-r--r--   0 raffi      (502) admin       (80)        9 2024-05-02 18:03:44.000000 pyseobnr-0.2.9/pyseobnr.egg-info/top_level.txt
+-rw-r--r--   0 raffi      (502) admin       (80)       38 2024-05-02 18:03:44.190906 pyseobnr-0.2.9/setup.cfg
+-rw-r--r--   0 raffi      (502) admin       (80)     3234 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/setup.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.187605 pyseobnr-0.2.9/test/
+-rw-r--r--   0 raffi      (502) admin       (80)       74 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/test/conftest.py
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.187793 pyseobnr-0.2.9/test/data/
+-rw-r--r--   0 raffi      (502) admin       (80)   181547 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/test/data/frame_hm.csv.gz
+drwxr-xr-x   0 raffi      (502) admin       (80)        0 2024-05-02 18:03:44.189442 pyseobnr-0.2.9/test/regression_tests/
+-rw-r--r--   0 raffi      (502) admin       (80)        0 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/test/regression_tests/__init__.py
+-rw-r--r--   0 raffi      (502) admin       (80)     3980 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/test/regression_tests/helpers.py
+-rw-r--r--   0 raffi      (502) admin       (80)     3386 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/test/regression_tests/regenerate_SEOBNRv5HM.py
+-rw-r--r--   0 raffi      (502) admin       (80)     3413 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/test/regression_tests/regenerate_SEOBNRv5PHM.py
+-rw-r--r--   0 raffi      (502) admin       (80)     4458 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/test/regression_tests/template_v5HM_tests.jinja
+-rw-r--r--   0 raffi      (502) admin       (80)     4494 2024-02-19 12:52:32.000000 pyseobnr-0.2.9/test/regression_tests/template_v5PHM_tests.jinja
+-rw-r--r--   0 raffi      (502) admin       (80)     4656 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/test/regression_tests/test_SEOBNRv5HM.py
+-rw-r--r--   0 raffi      (502) admin       (80)     1292 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/test/regression_tests/test_SEOBNRv5HM_dynamics.py
+-rw-r--r--   0 raffi      (502) admin       (80)     4718 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/test/regression_tests/test_SEOBNRv5PHM.py
+-rw-r--r--   0 raffi      (502) admin       (80)     7457 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/test/regression_tests/test_settings.py
+-rw-r--r--   0 raffi      (502) admin       (80)     2345 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/test/regression_tests/test_utils.py
+-rw-r--r--   0 raffi      (502) admin       (80)     1136 2024-05-02 17:47:22.000000 pyseobnr-0.2.9/tox.ini
```

### Comparing `pyseobnr-0.2.8/.gitlab/aei.yml` & `pyseobnr-0.2.9/.gitlab/aei.yml`

 * *Files 1% similar despite different names*

```diff
@@ -54,15 +54,15 @@
 
 
 conda-test:
   <<: *conda_build_default
   stage: test
   script:
     - conda activate python311
-    - pip install .
+    - pip install ".[tests]"
     - mkdir .temp-tests
     - export CI_TEST_DYNAMIC_REGRESSIONS=1
     - pytest --junitxml=.temp-tests/junit.xml -vvv test
 
   artifacts:
     paths:
       - .temp-tests/**/junit.xml
@@ -70,15 +70,15 @@
       junit: .temp-tests/**/junit.xml
 
 conda-docs:
   <<: *conda_build_default
   stage: docs
   variables:
     SOURCEDIR: "docs"
-  
+
   script:
     - |
       mamba install \
         --yes \
         --channel conda-forge \
         --channel bioconda \
         --name python311 \
```

### Comparing `pyseobnr-0.2.8/CHANGELOG.md` & `pyseobnr-0.2.9/CHANGELOG.md`

 * *Files 5% similar despite different names*

```diff
@@ -1,19 +1,23 @@
 All notable changes will be noted in this file, whenever a tagged
 version is made
 
+## [0.2.8] 19/02/2024
+
+Bugfix release. Minor update for conda builds.
+
 ## [0.2.7] 23/11/2023
 
 Maintenance release: code and documentation improvements, better test coverage.
 Removal of JAX dependency
 Now accepting "ModeArray" in the settings to remain compatible with Bilby: the previous "mode_array" is de-facto deprecated.
 
 ## [0.2.6] 16/08/2023
 
-Bugifx release. Fixes another compatibility issue with Cython 3.0.0. Increase total mass upper limit to 1e12.
+Bugfix release. Fixes another compatibility issue with Cython 3.0.0. Increase total mass upper limit to 1e12.
 
 ## [0.2.5] 01/08/2023
 
 Bugfix release. Fixes a compatibility issue with Cython 3.0.0.
 
 ## [0.2.4] 15/05/2023
```

### Comparing `pyseobnr-0.2.8/CONTRIBUTING.md` & `pyseobnr-0.2.9/CONTRIBUTING.md`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/LICENSE` & `pyseobnr-0.2.9/LICENSE`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/PKG-INFO` & `pyseobnr-0.2.9/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: pyseobnr
-Version: 0.2.8
+Version: 0.2.9
 Summary: Gravitational wave modelling within the effective-one-body framework
 Author-email: Serguei Ossokine <serguei.ossokine@tutanota.com>, Lorenzo Pompili <lorenzo.pompili@ligo.org>, Deyan Mihaylov <deyan.mihaylov@ligo.org>, Antoni Ramos Buades <antoni.ramos-buades@ligo.org>, Michael Puerrer <michael.puerrer@ligo.org>, Hector Estelles <hector.estelles@ligo.org>
 License: GPL-3.0-or-later
 Requires-Python: >=3.8
 Description-Content-Type: text/x-rst
 License-File: LICENSE
 License-File: AUTHORS.md
@@ -33,14 +33,15 @@
 Requires-Dist: sphinx-tabs; extra == "docs"
 Requires-Dist: cython; extra == "docs"
 Requires-Dist: sphinx_gallery; extra == "docs"
 Requires-Dist: jupytext; extra == "docs"
 Requires-Dist: jupyterlab; extra == "docs"
 Requires-Dist: pandas; extra == "docs"
 Requires-Dist: pyarrow; extra == "docs"
+Requires-Dist: seaborn; extra == "docs"
 Provides-Extra: tests
 Requires-Dist: pytest; extra == "tests"
 Requires-Dist: pytest-sugar; extra == "tests"
 Requires-Dist: pandas; extra == "tests"
 Requires-Dist: pyarrow; extra == "tests"
 
 |pipeline status|
```

### Comparing `pyseobnr-0.2.8/README.rst` & `pyseobnr-0.2.9/README.rst`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/docs/Makefile` & `pyseobnr-0.2.9/docs/Makefile`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/docs/_static/pyseobnr_120px.png` & `pyseobnr-0.2.9/docs/_static/pyseobnr_120px.png`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/docs/conf.py` & `pyseobnr-0.2.9/docs/conf.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/docs/index.rst` & `pyseobnr-0.2.9/docs/index.rst`

 * *Files 16% similar despite different names*

```diff
@@ -18,14 +18,15 @@
 .. the notebooks in the markdown myst format
 
 .. toctree::
    :maxdepth: 1
    :caption: Notebooks
 
    source/notebooks/getting_started.md
+   source/notebooks/example_precession.md
 
 API
 ---
 Throughout the code we refer to several different technical documents, that can be found
 `here <https://dcc.ligo.org/LIGO-T2300060/public>`_
 
 .. autosummary::
```

### Comparing `pyseobnr-0.2.8/docs/source/basic_usage.rst` & `pyseobnr-0.2.9/docs/source/basic_usage.rst`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/docs/source/citations.rst` & `pyseobnr-0.2.9/docs/source/citations.rst`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/docs/source/expert_mode.rst` & `pyseobnr-0.2.9/docs/source/expert_mode.rst`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/docs/source/installation.rst` & `pyseobnr-0.2.9/docs/source/installation.rst`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/docs/source/notebooks/getting_started.md` & `pyseobnr-0.2.9/docs/source/notebooks/getting_started.md`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/docs/templates/custom-class-template.rst` & `pyseobnr-0.2.9/docs/templates/custom-class-template.rst`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/docs/templates/custom-module-template.rst` & `pyseobnr-0.2.9/docs/templates/custom-module-template.rst`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/external_models/default_settings.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/external_models/default_settings.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/external_models/external_models.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/external_models/external_models.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/mode_mixing/auxiliary_functions_modemixing.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/mode_mixing/auxiliary_functions_modemixing.py`

 * *Files 2% similar despite different names*

```diff
@@ -21,21 +21,23 @@
         p4 (float): fourth fitting parameter
 
     Returns:
         float: the spherical-spheroidal mode mixing coefficient
     """
     return p1 * abs(j) ** (p2) + p3 * abs(j) ** (p4)
 
+
 @jit(nopython=True)
-def mu(m: int, l: int, lp: int, j: float) -> float:
+def mu(m: int, l: int, lp: int, j: float) -> float:  # noqa: E741
     """
     Equation 11 from [Berti2014]_ applied to the (2,2), (3,2), (3,3) and (4,3) modes using the
     appropriate fitting parameters
 
-    Data files containing the fits https://git.ligo.org/waveforms/reviews/seobnrv5/-/blob/main/aligned/docs/swsh_fits.dat
+    Data files containing the fits
+    https://git.ligo.org/waveforms/reviews/seobnrv5/-/blob/main/aligned/docs/swsh_fits.dat
     (copied from https://pages.jh.edu/eberti2/ringdown/ on 02/12/2022)
 
     Args:
         m (int): m index of the relevant mode
         l (int): :math:`\\ell` index of the relevant mode
         lp (int): index of modes with the same m and lp<=l which give rise to mode mixing
         j (float): dimensionless spin parameter
@@ -171,32 +173,35 @@
         float: the value of alpha
     """
     return np.arctan2(
         -rho(ell, m, j, h_ellm, h_mm) * np.sin(dphi(ell, m, j, phi_ellm, phi_mm)),
         (1 - rho(ell, m, j, h_ellm, h_mm) * np.cos(dphi(ell, m, j, phi_ellm, phi_mm))),
     )
 
+
 @jit(nopython=True)
 def rho_dot(ell, m, j, h_ellm, h_mm, hdot_ellm, hdot_mm):
     """
     Auxiliary function to obtain the spheroidal mode input values, see Eq.(77) of [SEOBNRv5HM-notes]_
 
     Args:
         ell (int): :math:`\\ell` index of the relevant mode
         m (int): m index of the relevant mode
         j (float): dimensionless spin parameter
         h_ellm (float): amplitude of the (:math:`\\ell,m`) mode at attachment time
         h_mm (float): amplitude of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
         hdot_ellm (float): amplitude's first derivative of the (:math:`\\ell,m`) mode at attachment time
-        hdot_mm (float): amplitude's first derivative of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
+        hdot_mm (float): amplitude's first derivative of the (:math:`\\ell^{\\prime} = m,m`)
+            mode at attachment time
 
     Returns:
         float: the value of rho_dot
     """
-    return abs(mu(m, ell, m, j)) * (hdot_mm / h_ellm - h_mm * hdot_ellm / (h_ellm ** 2))
+    return abs(mu(m, ell, m, j)) * (hdot_mm / h_ellm - h_mm * hdot_ellm / (h_ellm**2))
+
 
 @jit(nopython=True)
 def dphi_dot(omega_ellm, omega_mm):
     """
     Auxiliary function to obtain the spheroidal mode input values, see Eq.(78) of [SEOBNRv5HM-notes]_
 
     Args:
@@ -204,28 +209,30 @@
         omega_mm (float): frequency of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
 
     Returns:
         float: the value of dphi_dot
     """
     return omega_mm - omega_ellm
 
+
 def F_dot(
     ell, m, j, h_ellm, h_mm, hdot_ellm, hdot_mm, omega_ellm, omega_mm, phi_ellm, phi_mm
 ):
     """
     Auxiliary function to obtain the spheroidal mode input values, see Eq.(79) of [SEOBNRv5HM-notes]_
 
     Args:
         ell (int): :math:`\\ell` index of the relevant mode
         m (int): m index of the relevant mode
         j (float): dimensionless spin parameter
         h_ellm (float): amplitude of the (:math:`\\ell,m`) mode at attachment time
         h_mm (float): amplitude of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
         hdot_ellm (float): amplitude's first derivative of the (:math:`\\ell,m`) mode at attachment time
-        hdot_mm (float): amplitude's first derivative of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
+        hdot_mm (float): amplitude's first derivative of the (:math:`\\ell^{\\prime} = m,m`)
+            mode at attachment time
         omega_ellm (float): frequency of the (:math:`\\ell,m`) mode at attachment time
         omega_mm (float): frequency of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
         phi_ellm (float): phase of the (:math:`\\ell,m`) mode at attachment time
         phi_mm (float): phase of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
 
     Returns:
         float: the value of F_dot
@@ -236,28 +243,30 @@
         + rho(ell, m, j, h_ellm, h_mm)
         * np.sin(dphi(ell, m, j, phi_ellm, phi_mm))
         * dphi_dot(omega_ellm, omega_mm)
         - rho_dot(ell, m, j, h_ellm, h_mm, hdot_ellm, hdot_mm)
         * np.cos(dphi(ell, m, j, phi_ellm, phi_mm))
     ) / F(ell, m, j, h_ellm, h_mm, phi_ellm, phi_mm)
 
+
 def alpha_dot(
     ell, m, j, h_ellm, h_mm, hdot_ellm, hdot_mm, omega_ellm, omega_mm, phi_ellm, phi_mm
 ):
     """
     Auxiliary function to obtain the spheroidal mode input values, see Eq.(80) of [SEOBNRv5HM-notes]_
 
     Args:
         ell (int): :math:`\\ell` index of the relevant mode
         m (int): m index of the relevant mode
         j (float): dimensionless spin parameter
         h_ellm (float): amplitude of the (:math:`\\ell,m`) mode at attachment time
         h_mm (float): amplitude of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
         hdot_ellm (float): amplitude's first derivative of the (:math:`\\ell,m`) mode at attachment time
-        hdot_mm (float): amplitude's first derivative of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
+        hdot_mm (float): amplitude's first derivative of the (:math:`\\ell^{\\prime} = m,m`)
+            mode at attachment time
         omega_ellm (float): frequency of the (:math:`\\ell,m`) mode at attachment time
         omega_mm (float): frequency of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
         phi_ellm (float): phase of the (:math:`\\ell,m`) mode at attachment time
         phi_mm (float): phase of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
 
     Returns:
         float: the value of alpha_dot
@@ -271,14 +280,15 @@
         * np.sin(dphi(ell, m, j, phi_ellm, phi_mm))
     ) / (F(ell, m, j, h_ellm, h_mm, phi_ellm, phi_mm) ** 2)
 
 
 # Spheroidal mode input values
 # See Eq. 81 to Eq. 84 of [SEOBNRv5HM-notes]_
 
+
 def h_ellm0_nu(ell, m, j, h_ellm, h_mm, phi_ellm, phi_mm):
     """
     Computes the amplitude of the spheroidal :math:`(\\ell,m,0)` mode at at attachment time
     from the :math:`(\\ell,m)` and (:math:`\\ell^{\\prime} = m,m`) spherical modes
 
     Args:
         ell (int): :math:`\\ell` index of the relevant mode
@@ -294,14 +304,15 @@
     """
     return (
         h_ellm
         * F(ell, m, j, h_ellm, h_mm, phi_ellm, phi_mm)
         / np.abs(mu(m, ell, ell, j))
     )
 
+
 def phi_ellm0(ell, m, j, h_ellm, h_mm, phi_ellm, phi_mm):
     """
     Computes the phase of the spheroidal :math:`(\\ell,m,0)` mode at at attachment time
     from the (:math:`\\ell,m`) and (:math:`\\ell^{\\prime} = m,m`) spherical modes
 
     Args:
         ell (int): :math:`\\ell` index of the relevant mode
@@ -317,29 +328,31 @@
     """
     return (
         phi_ellm
         + np.angle(mu(m, ell, ell, j))
         + alpha(ell, m, j, h_ellm, h_mm, phi_ellm, phi_mm)
     )
 
+
 def hdot_ellm0_nu(
     ell, m, j, h_ellm, h_mm, hdot_ellm, hdot_mm, omega_ellm, omega_mm, phi_ellm, phi_mm
-):  
+):
     """
     Computes the amplitude's first derivative of the spheroidal :math:`(\\ell,m,0)` mode at at attachment time
     from the (:math:`\\ell,m`) and (:math:`\\ell^{\\prime} = m,m`) spherical modes
 
     Args:
         ell (int): :math:`\\ell` index of the relevant mode
         m (int): m index of the relevant mode
         j (float): dimensionless spin parameter
         h_ellm (float): amplitude of the (:math:`\\ell,m`) mode at attachment time
         h_mm (float): amplitude of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
         hdot_ellm (float): amplitude's first derivative of the (:math:`\\ell,m`) mode at attachment time
-        hdot_mm (float): amplitude's first derivative of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
+        hdot_mm (float): amplitude's first derivative of the (:math:`\\ell^{\\prime} = m,m`)
+            mode at attachment time
         omega_ellm (float): frequency of the (:math:`\\ell,m`) mode at attachment time
         omega_mm (float): frequency of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
         phi_ellm (float): phase of the (:math:`\\ell,m`) mode at attachment time
         phi_mm (float): phase of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
 
     Returns:
         float: the amplitude's first derivative of the spheroidal :math:`(\\ell,m,0)` mode at at attachment time
@@ -358,29 +371,31 @@
             omega_ellm,
             omega_mm,
             phi_ellm,
             phi_mm,
         )
     ) / np.abs(mu(m, ell, ell, j))
 
+
 def omega_ellm0(
     ell, m, j, h_ellm, h_mm, hdot_ellm, hdot_mm, omega_ellm, omega_mm, phi_ellm, phi_mm
 ):
     """
     Computes the frequency of the spheroidal :math:`(\\ell,m,0)` mode at at attachment time
     from the (:math:`\\ell,m`) and (:math:`\\ell^{\\prime} = m,m`) spherical modes
 
     Args:
         ell (int): :math:`\\ell` index of the relevant mode
         m (int): m index of the relevant mode
         j (float): dimensionless spin parameter
         h_ellm (float): amplitude of the (:math:`\\ell,m`) mode at attachment time
         h_mm (float): amplitude of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
         hdot_ellm (float): amplitude's first derivative of the (:math:`\\ell,m`) mode at attachment time
-        hdot_mm (float): amplitude's first derivative of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
+        hdot_mm (float): amplitude's first derivative of the (:math:`\\ell^{\\prime} = m,m`)
+            mode at attachment time
         omega_ellm (float): frequency of the (:math:`\\ell,m`) mode at attachment time
         omega_mm (float): frequency of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
         phi_ellm (float): phase of the (:math:`\\ell,m`) mode at attachment time
         phi_mm (float): phase of the (:math:`\\ell^{\\prime} = m,m`) mode at attachment time
 
     Returns:
         float: the frequency of the spheroidal :math:`(\\ell,m,0)` mode at at attachment time
```

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/EOB_matches.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/EOB_matches.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/NRSur_IV_difference.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/NRSur_IV_difference.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/NRSur_matches.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/NRSur_matches.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/NR_mismatches.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/NR_mismatches.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.sh` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM.sh`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.sh` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/aligned_matches_v5PHM_commentedMatch.sh`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/amp_hierarchy_test_prec_submission.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/amp_hierarchy_test_prec_submission.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test_precessing.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/amplitude_hierarchy_test_precessing.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/attachment_smoothness_test.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/attachment_smoothness_test.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/battery_of_tests.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/battery_of_tests.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/metrics/metrics.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/metrics/metrics.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/metrics/unfaithfulness_mode_by_mode.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/metrics/unfaithfulness_mode_by_mode.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.sh` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/mismatch_PA_polarization_precession.sh`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/mismatch_fixed_waveform_test.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/mismatch_fixed_waveform_test.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_aligned.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_aligned.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.sh` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/mismatch_pert_polarization_precession.sh`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/monotonicity_test.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/monotonicity_test.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/parameters.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/parameters.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/phenom_matches.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/phenom_matches.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/reference_smoothness_test.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/reference_smoothness_test.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/single_waveform_tests.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/single_waveform_tests.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/smoothness_q_chi.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/smoothness_q_chi.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/templates/slurm.jinja` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/templates/slurm.jinja`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/auxiliary/sanity_checks/v5P_NR_coprecessing_match.py` & `pyseobnr-0.2.9/pyseobnr/auxiliary/sanity_checks/v5P_NR_coprecessing_match.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/initial_conditions_aligned_opt.py` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/initial_conditions_aligned_opt.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/initial_conditions_aligned_precessing.py` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/initial_conditions_aligned_precessing.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/initial_conditions_precessing_postadiabatic.py` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/initial_conditions_precessing_postadiabatic.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,19 +1,21 @@
 #!/usr/bin/env python3
 """
 Computes post-adiabatic initial conditions in polar coordinates.
 """
 
 from typing import Callable
-from ..hamiltonian import Hamiltonian
+
 import numpy as np
 
-from .postadiabatic_C_prec import compute_postadiabatic_dynamics
 from ..fits.fits_Hamiltonian import dSO as dSO_poly_fit
+from ..hamiltonian import Hamiltonian
 from .initial_conditions_aligned_precessing import computeIC_augm
+from .postadiabatic_C_prec import compute_postadiabatic_dynamics
+
 
 def compute_IC_PA(
     omega_ref: float,
     omega_start: float,
     H: Hamiltonian,
     RR: Callable,
     chi1_v: np.ndarray,
@@ -32,34 +34,38 @@
         omega_start (float): Initial *orbital* frequency in geometric units
         H (Hamiltonian): The Hamiltonian object to use
         RR (function): The RR force to use
         chi1_v (np.ndarray): Dimensionless spin vector of the primary
         chi2_v (np.ndarray): Dimensionless spin vector of the secondary
         m_1 (float): Mass of primary
         m_2 (float): Mass of secondary
-        splines (dict): Dictionary containing the splines in orbital frequency of the vector components of the spins, LN and L as
-                        well as the spin projections onto LN and L
+        splines (dict): Dictionary containing the splines in orbital frequency of the vector components
+                        of the spins, LN and L as well as the spin projections onto LN and L
         t_pn (np.array): Time array of the PN evolution of the spins and Newtonian angular momentum.
-        dynamics_pn (np.array): Array of the spin-precessing PN evolution. It contains the Newtonian angular momentum, the dimensionful spin vectors and the PN orbital frequency.
+        dynamics_pn (np.array): Array of the spin-precessing PN evolution. It contains the Newtonian
+                        angular momentum, the dimensionful spin vectors and the PN orbital frequency.
 
     Returns:
         tuple: The initial conditions: (r,pphi,pr)
     """
 
     params = kwargs["params"]
     postadiabatic_type = kwargs["postadiabatic_type"]
     PA_success = False
 
-    try :
+    try:
         postadiabatic_dynamics, omega_pa = compute_postadiabatic_dynamics(
             omega_ref,
             omega_start,
-            H, RR,
-            chi1_v, chi2_v,
-            m_1, m_2,
+            H,
+            RR,
+            chi1_v,
+            chi2_v,
+            m_1,
+            m_2,
             splines,
             t_pn,
             dynamics_pn,
             tol=1e-12,
             params=params,
             order=8,
             postadiabatic_type=postadiabatic_type,
@@ -67,29 +73,27 @@
             only_first_n=12,
         )
 
         r0 = postadiabatic_dynamics[0, 1]
         pr0 = postadiabatic_dynamics[0, 3]
         pphi0 = postadiabatic_dynamics[0, 4]
 
-
         PA_success = True
-    except:
-
+    except Exception:
         # If PA fails use the adiabatic initial conditions
         r0, pphi0, pr0 = computeIC_augm(
-                omega_start,
-                H,
-                RR,
-                chi1_v,
-                chi2_v,
-                m_1,
-                m_2,
-                params=params,
-            )
+            omega_start,
+            H,
+            RR,
+            chi1_v,
+            chi2_v,
+            m_1,
+            m_2,
+            params=params,
+        )
         params.p_params.omega = omega_start
 
     if PA_success:
         # Note that omega and omega_pa[0] may differ due to numerical noise
         # we set the initial frequency to omega_pa[0] to avoid interpolation errors
         params.p_params.omega = omega_pa[0]
 
@@ -121,16 +125,38 @@
     dSO_start = dSO_poly_fit(params.p_params.nu, ap_start, am_start)
     H.calibration_coeffs["dSO"] = dSO_start
 
     # Evaluate omega_circ and the Hamiltonian at the intial conditions
     q = np.array([r0, 0.0])
     p = np.array([pr0, pphi0])
     p_circ = np.array([0.0, p[1]])
-    dynamics = H.dynamics(q, p, chi1_v_start, chi2_v_start, m_1, m_2, chi1_LN_start, chi2_LN_start, chi1_L_start, chi2_L_start)
+    dynamics = H.dynamics(
+        q,
+        p,
+        chi1_v_start,
+        chi2_v_start,
+        m_1,
+        m_2,
+        chi1_LN_start,
+        chi2_LN_start,
+        chi1_L_start,
+        chi2_L_start,
+    )
     H_val = dynamics[4]
-    omega_circ = H.omega(q, p_circ, chi1_v_start, chi2_v_start, m_1, m_2, chi1_LN_start, chi2_LN_start, chi1_L_start, chi2_L_start)
+    omega_circ = H.omega(
+        q,
+        p_circ,
+        chi1_v_start,
+        chi2_v_start,
+        m_1,
+        m_2,
+        chi1_LN_start,
+        chi2_LN_start,
+        chi1_L_start,
+        chi2_L_start,
+    )
     params.p_params.omega_circ = omega_circ
     params.p_params.H_val = H_val
 
-    #print(f"PA: r0 = {r0}, pphi0 = {pphi0}, pr0 = {pr0}")
+    # print(f"PA: r0 = {r0}, pphi0 = {pphi0}, pr0 = {pr0}")
 
     return r0, pphi0, pr0
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/integrate_ode.py` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/integrate_ode.py`

 * *Files 18% similar despite different names*

```diff
@@ -1,23 +1,21 @@
 #!/usr/bin/env python
 """
 Contains functions associated with evolving the equations of motion
 """
 
 import numpy as np
-from scipy.interpolate import CubicSpline
-from scipy.signal import argrelmin
-from numba import jit
-
 import pygsl_lite.errno as errno
 import pygsl_lite.odeiv2 as odeiv2
+from numba import jit
+from scipy.interpolate import CubicSpline
 
+from ..utils.utils import interpolate_dynamics, iterative_refinement
 from .initial_conditions_aligned_opt import computeIC_opt
-from .rhs_aligned import get_rhs, augment_dynamics
-
+from .rhs_aligned import augment_dynamics, get_rhs
 
 step = odeiv2.pygsl_lite_odeiv2_step
 _control = odeiv2.pygsl_lite_odeiv2_control
 evolve = odeiv2.pygsl_lite_odeiv2_evolve
 
 
 class control_y_new(_control):
@@ -116,15 +114,15 @@
     if y_init is None:
         h = 2 * np.pi / omega0 / 5
     else:
         h = 0.5
     omega_previous = omega0
     res_gsl = []
     ts = []
-    omegas = []
+
     ts.append(0.0)
     res_gsl.append(y)
 
     p_circ = np.zeros(2)
     peak_omega = False
     peak_pr = False
     while t < t1:
@@ -196,21 +194,21 @@
     # In that case make the fine dynamics be _all_ dynamics
     # except the 1st element
     if t_desired < ts[1]:
         idx_close = 1
         step_back = ts[-1] - ts[idx_close]
     dyn_coarse = np.c_[ts[:idx_close], dyn[:idx_close]]
     dyn_fine = np.c_[ts[idx_close:], dyn[idx_close:]]
-    """
-    print(f"t_desired={t_desired}")
-    print(f"len(dyn_coarse)={len(dyn_coarse)}")
-    print(f"len(dyn_fine)={len(dyn_fine)}")
-    print(f"End time: {ts[-1]}")
-    print(f"idx_close:{idx_close}, t[idx_close]={ts[idx_close]}")
-    """
+
+    # print(f"t_desired={t_desired}")
+    # print(f"len(dyn_coarse)={len(dyn_coarse)}")
+    # print(f"len(dyn_fine)={len(dyn_fine)}")
+    # print(f"End time: {ts[-1]}")
+    # print(f"idx_close:{idx_close}, t[idx_close]={ts[idx_close]}")
+
     dyn_coarse = augment_dynamics(dyn_coarse, chi_1, chi_2, m_1, m_2, H)
     dyn_fine = augment_dynamics(dyn_fine, chi_1, chi_2, m_1, m_2, H)
     t_peak = None
     if peak_omega:
         intrp = CubicSpline(dyn_fine[:, 0], dyn_fine[:, -2])
         left = dyn_fine[0, 0]
         right = dyn_fine[-1, 0]
@@ -224,79 +222,7 @@
 
     dyn_fine = interpolate_dynamics(
         dyn_fine[:, :-3], peak_omega=t_peak, step_back=step_back
     )
     dyn_fine = augment_dynamics(dyn_fine, chi_1, chi_2, m_1, m_2, H)
 
     return dyn_coarse, dyn_fine
-
-
-def iterative_refinement(f, interval, levels=2, dt_initial=0.1, pr=False):
-    """
-    Attempts to find the peak of Omega/pr iteratively.
-    Needed to ensure accurate attachment when the attachment point is the last point of the dynamics.
-
-    Args:
-        f (PPoly): derivative of the splined dynamics
-        interval (list): interval where to look for the peak
-        levels (int): number of iterations
-        dt_initial (float): initial time step
-        pr (bool): whether the end of the dynamics is due to a peak of pr instead of Omega
-
-    Returns:
-        np.array: interpolated dynamics array
-
-    """
-    left = interval[0]
-    right = interval[1]
-    for n in range(1, levels + 1):
-        dt = dt_initial / (10**n)
-        t_fine = np.arange(interval[0], interval[1], dt)
-        deriv = np.abs(f(t_fine))
-
-        mins = argrelmin(deriv, order=3)[0]
-        if len(mins) > 0:
-            result = t_fine[mins[0]]
-
-            interval = max(result - 10 * dt, left), min(result + 10 * dt, right)
-
-        else:
-            if pr:
-                return interval[-1]
-            else:
-                return (interval[0] + interval[-1]) / 2
-    return result
-
-
-def interpolate_dynamics(dyn_fine, dt=0.1, peak_omega=None, step_back=250.0):
-    """
-    Interpolate the dynamics to a finer grid.
-    This replaces stepping back that was used in older EOB models.
-
-    Args:
-        dyn_fine (np.array): dynamics array
-        dt (float): time step to which to interpolate
-        peak_omega (float): position of the peak (stopping condition for the dynamics)
-        step_back (float): step back relative to the end of the dynamics
-
-    Returns:
-        np.array: interpolated dynamics array
-
-    """
-
-    res = []
-    n = len(dyn_fine)
-
-    if peak_omega:
-        start = max(peak_omega - step_back, dyn_fine[0, 0])
-        t_new = np.arange(start, peak_omega, dt)
-
-    else:
-        t_new = np.arange(dyn_fine[0, 0], dyn_fine[-1, 0], dt)
-
-    for i in range(1, dyn_fine.shape[1]):
-        intrp = CubicSpline(dyn_fine[:, 0], dyn_fine[:, i])
-        res.append(intrp(t_new))
-
-    res = np.array(res)
-    res = res.T
-    return np.c_[t_new, res]
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/integrate_ode_prec.py` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/integrate_ode_prec.py`

 * *Files 2% similar despite different names*

```diff
@@ -4,35 +4,31 @@
 
 from typing import Callable
 
 import numpy as np
 import pygsl_lite.errno as errno
 import pygsl_lite.odeiv2 as odeiv2
 from numba import *
-from numba import jit, types
+from scipy.interpolate import CubicSpline
 
 from ..fits.fits_Hamiltonian import dSO as dSO_poly_fit
 from ..hamiltonian import Hamiltonian
+from ..utils.containers import EOBParams
 from ..utils.math_ops_opt import *
+from ..utils.utils import interpolate_dynamics, iterative_refinement
 from .initial_conditions_aligned_precessing import computeIC_augm
 from .pn_evolution_opt import (
-    rhs_wrapper,
+    build_splines_PN,
     compute_omega_orb,
     compute_quasiprecessing_PNdynamics_opt,
-    build_splines_PN,
+    rhs_wrapper,
 )
-from .integrate_ode import interpolate_dynamics, iterative_refinement
-from ..utils.containers import EOBParams
-from ..utils.math_ops_opt import my_norm
 
 # Test cythonization of PN equations
 
-from scipy.interpolate import CubicSpline
-from scipy.signal import argrelmin
-
 
 step = odeiv2.pygsl_lite_odeiv2_step
 _control = odeiv2.pygsl_lite_odeiv2_control
 evolve = odeiv2.pygsl_lite_odeiv2_evolve
 
 
 class control_y_new(_control):
@@ -79,15 +75,14 @@
         return 2
 
     if omega < omega_previous:
         # print(f"r = {r}, omega = {omega}, omega_previous = {omega_previous}")
         return 3
 
     if r < 3:
-
         if drdt > 0:
             # print(f"drdt>0 : r = {r}, omega = {omega}, omega_previous = {omega_previous}")
             return 5
 
         if dprdt > 0:
             # print(f"dprdt >0 : r = {r}, omega = {omega}, omega_previous = {omega_previous}")
             return 6
@@ -217,15 +212,14 @@
                 dynamics_pn,
                 params=params,
                 postadiabatic_type=initial_conditions_postadiabatic_type,
             )
         y0 = np.array([r0, 0.0, pr0, pphi0])
 
     else:
-
         y0 = y_init.copy()
         r0 = y0[0]
 
     # Step 3.3: now integrate the dynamics
     sys = odeiv2.system(rhs_wrapper, None, 4, [H, RR, m_1, m_2, params])
 
     T = odeiv2.step_rkf45
@@ -270,15 +264,14 @@
     X1 = params.p_params.X_1
     X2 = params.p_params.X_2
 
     peak_omega = False
     peak_pr = False
 
     while t < t1:
-
         # Take a step
         status, t, h, y = e.apply(c, s, sys, t, t1, h, y)
         if status != errno.GSL_SUCCESS:
             print("break status", status)
             break
         # Compute the error for the step controller
         e.get_yerr()
@@ -300,27 +293,25 @@
                     params.p_params.chi_1,
                     params.p_params.chi_2,
                 ]
             )
 
         # Handle termination conditions
         if r <= 6:
-
             deriv = rhs_wrapper(t, y, [H, RR, m_1, m_2, params])
             drdt = deriv[0]
             omega = deriv[1]
             omega_previous = omegas[-1]
             if np.isnan(omega):
                 res_gsl = res_gsl[:-1]
                 ts = ts[:-1]
                 augm_dyn = augm_dyn[:-1]
                 break
 
             else:
-
                 omegas.append(omega)
                 dprdt = deriv[2]
                 omega_circ = params.p_params.omega_circ
 
             # check termination conditions
             termination = check_terminal(
                 r, omega, drdt, dprdt, omega_circ, omega_previous, r_previous, omegaPN_f
@@ -501,15 +492,14 @@
     t_low = ts[:idx_restart]
     t_fine = ts[idx_restart:]
 
     t_low_last = t_low[-1]
     t_fine_init = t_fine[0]
 
     if t_fine_init - t_low_last > 2:
-
         dt_low_last = t_low[-1] - t_low[-2]
         dt_fine = t_fine[1] - t_fine[0]
         dt_fine = 0.1
 
         t = t_fine[0] - dt_fine
         t_new = []
 
@@ -552,15 +542,14 @@
         dynamics = np.vstack((dyn_low, dyn_middle[:-1, :], dyn_fine))
         omega = np.concatenate((omega_low, omega_middle[:-1], omega_fine))
 
         idx_restart_v1 = (
             len(omega_low) + len(omega_middle) - 1
         )  # idx_restart -1  + window_length
     else:
-
         dynamics = dyn
         time = ts
         omega = omega_eob
         idx_restart_v1 = idx_restart
 
     return time, dynamics, omega, idx_restart_v1
 
@@ -650,20 +639,18 @@
     Returns:
         tuple: Aligned-spin EOB dynamics, PN time, PN dynamics, PN splines
     """
 
     # Step 1: Compute PN dynamics
 
     if initial_conditions == "postadiabatic":
-
         combined_t, combined_y = compute_quasiprecessing_PNdynamics_opt(
             omega_ref, 0.9 * omega_start, m_1, m_2, chi_1, chi_2
         )
     else:
-
         combined_t, combined_y = compute_quasiprecessing_PNdynamics_opt(
             omega_ref, omega_start, m_1, m_2, chi_1, chi_2
         )
     # Compute last value of the orbital frequency from the PN evolution (to be used for
     # the termination conditions of the non-precessing evolution)
     omegaPN_f = combined_y[:, -1][-1]
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/pn_evolution_opt.py` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/pn_evolution_opt.py`

 * *Files 2% similar despite different names*

```diff
@@ -2,26 +2,20 @@
 Contains the PN precession equations and their integration, as well as some auxiliary functions
 """
 
 from math import log
 from typing import Callable
 
 import numpy as np
-
-from numba import *
-from numba import jit, types
-from pyseobnr.auxiliary.interpolate.vector_spline import VectorSpline
+from numba import jit
 from scipy.integrate import solve_ivp
 from scipy.interpolate import CubicSpline
 
 from ..hamiltonian import Hamiltonian
-from .initial_conditions_aligned_precessing import computeIC_augm
-from ..utils.math_ops_opt import *
-
-# Test cythonization of PN equations
+from ..utils.math_ops_opt import my_cross, my_dot, my_norm
 from .rhs_precessing import get_rhs_prec
 
 
 @jit(
     nopython=True,
     cache=True,
 )
@@ -452,14 +446,15 @@
     ]
 
     return derivs
 
 
 ####################################################################################
 
+
 def compute_omega_orb(
     t: float,
     z: np.ndarray,
     H: Hamiltonian,
     RR: Callable,
     m_1: float,
     m_2: float,
@@ -512,25 +507,24 @@
     Returns:
         tuple: Solution of the rhs (drdt,dphidt,dprdt,dpphidt)
     """
 
     return get_rhs_prec(t, z, *args)
 
 
-
 def compute_quasiprecessing_PNdynamics_opt(
     omega_ref: float,
     omega_start: float,
     m_1: float,
     m_2: float,
     chi_1: np.ndarray,
     chi_2: np.ndarray,
     rtol: float = 1e-10,
     atol: float = 1e-12,
-    backend: str="DOP853",
+    backend: str = "DOP853",
 ):
     """
     Compute the dynamics starting from omega_start, with spins
     defined at omega_ref.
 
     First, PN evolution equations are integrated (including backwards in time)
     to get spin and orbital angular momentum. From that we construct splines
@@ -562,53 +556,54 @@
 
     # FIXME: check that the initial omega_ref is not too high
 
     mt = m_1 + m_2
     nu = m_1 * m_2 / mt / mt
     X1 = m_1 / mt
     X2 = m_2 / mt
-    delta = m_1 - m_2
 
     def spinTaylor_stoppingTest(t, y, *args):
         """
-            Function to evaluate stopping conditions of the spin-precessing PN evolution
+        Function to evaluate stopping conditions of the spin-precessing PN evolution
 
-            Args:
-                t (float): Time
-                y (np.ndarray): Solution of the evolution (LNhx, LNhy, LNhz, S1x, S1y, S1z, S2x, S2y, S2z, omega)
+        Args:
+            t (float): Time
+            y (np.ndarray): Solution of the evolution (LNhx, LNhy, LNhz, S1x, S1y, S1z, S2x, S2y, S2z, omega)
 
-            Returns:
-                (int) If 0 stop the evolution, otherwise continue
+        Returns:
+            (int) If 0 stop the evolution, otherwise continue
         """
 
         # Read the solution
         LNhx, LNhy, LNhz, S1x, S1y, S1z, S2x, S2y, S2z, omega = y
 
         r = omega ** (-2.0 / 3)
 
-        omegaEnd = 0.0
-        omegaStart = omega_ref
-
         omegadiff = omega - spinTaylor_stoppingTest.omegas[-1]
 
         # Check d^2omega/dt^2 > 0 (true iff current_domega - prev_domega > 0)
         ddomega = omegadiff
 
         spinTaylor_stoppingTest.omegas.append(omega)
 
-        v = (omega)**(1./3.)
+        v = (omega) ** (1.0 / 3.0)
 
         if np.isnan(omega):
             yout = 0
 
-        elif v >= 1.0:  #  v/c >= 1!
+        elif v >= 1.0:  # v/c >= 1!
             yout = 0
 
-        elif ddomega <= 0.0 or (abs(ddomega) < 1e-9 and r<6.0):  #  // d^2omega/dt^2 <= 0!
-            #printf(f"ddomega <= 0.0 :  omega = {omega}, spinTaylor_stoppingTest.omegas[-1] = {spinTaylor_stoppingTest.omegas[-1]}")
+        elif ddomega <= 0.0 or (
+            abs(ddomega) < 1e-9 and r < 6.0
+        ):  # // d^2omega/dt^2 <= 0!
+            # print(
+            #     f"ddomega <= 0.0 :  omega = {omega}, spinTaylor_stoppingTest.omegas[-1] = "
+            #     f"{spinTaylor_stoppingTest.omegas[-1]}"
+            # )
             yout = 0
 
         # Empirical bound on the PN integration (typically it ends earlier)
         elif omega > 0.35:
             yout = 0
 
         else:
@@ -629,15 +624,14 @@
         events=spinTaylor_stoppingTest,
         args=(nu, m_1, m_2, X1, X2),
         rtol=rtol,
         atol=atol,
         method=backend,
     )
 
-
     if omega_start < omega_ref:
         # We want to start at a lower frequency than omega_ref
         # Thus we first integrate backwards in time
         def term_backwards(t, y, *args):
             return y[-1] - omega_start
 
         term_backwards.terminal = True
@@ -656,15 +650,14 @@
         # Combine the forwards and backward pieces
         combined_t = np.concatenate((res_back.t[::-1][:-1], res_forward.t[1:]))
         combined_y = np.vstack((res_back.y.T[::-1][:-1], res_forward.y.T[1:, :]))
 
         # Set t=0 at the lowest frequency
         combined_t -= combined_t[0]
     else:
-
         combined_t = res_forward.t[:]
         combined_y = res_forward.y.T[:]
 
     # Use this to avoid interpolation errors due to repeating the last point
     tdiff_abs = abs(combined_t[-1] - combined_t[-2])
     if tdiff_abs < 1e-10:
         combined_t = combined_t[:-1]
@@ -673,14 +666,15 @@
     omega_diff = combined_y[-1, -1] - combined_y[-2, -1]
     if omega_diff < 0:
         combined_t = combined_t[:-1]
         combined_y = combined_y[:-1]
 
     return combined_t, combined_y
 
+
 def build_splines_PN(
     combined_t: np.ndarray,
     combined_y: np.ndarray,
     m_1: float,
     m_2: float,
     omega_start: float,
 ):
@@ -749,27 +743,27 @@
     all_array = np.c_[chi1_LN, chi2_LN, chi1_L, chi2_L, chi1_v, chi2_v, LN_hat, L_vec]
     splines["everything"] = CubicSpline(omega, all_array)
 
     return splines
 
 
 def compute_Lvec_35PN_vec_opt(
-                              q:float,
-                              nu:float,
-                              X1:float,
-                              X2:float,
-                              v: np.ndarray,
-                              S1: np.ndarray,
-                              S2: np.ndarray,
-                              Lh: np.ndarray,
-                              S1sq: np.ndarray,
-                              S2sq: np.ndarray,
-                              S1S2: np.ndarray,
-                              lNS1: np.ndarray,
-                              lNS2: np.ndarray
+    q: float,
+    nu: float,
+    X1: float,
+    X2: float,
+    v: np.ndarray,
+    S1: np.ndarray,
+    S2: np.ndarray,
+    Lh: np.ndarray,
+    S1sq: np.ndarray,
+    S2sq: np.ndarray,
+    S1S2: np.ndarray,
+    lNS1: np.ndarray,
+    lNS2: np.ndarray,
 ):
     """
     Compute orbital angular momentum vector, L, up to 4PN using the Newtonian orbital angular momentum
     unit vector and the spin vectors
 
     Args:
         q (float): mass ratio > 1
@@ -780,30 +774,32 @@
         X2 (float): Mass of secondary
         S1 (np.ndarray): Dimensionful spin vector of the primary
         S2 (np.ndarray): Dimensionful spin vector of the secondary
         Lh (np.ndarray): Newtonian orbital angular momentum unit vector
         S1sq (np.ndarray): Dot product of the spin vector of the primary
         S2sq (np.ndarray): Dot product of the spin vector of the secondary
         S1S2 (np.ndarray): Dot product of the spin vectors of the primary and the secondary
-        lNS1 (np.ndarray): Dot product of the Newtonian orbital angular momentum unit vector and the spin vectors of the primary
-        lNS2 (np.ndarray): Dot product of the Newtonian orbital angular momentum unit vector and the spin vectors of the secondary
+        lNS1 (np.ndarray): Dot product of the Newtonian orbital angular momentum unit vector and the spin
+                           vectors of the primary
+        lNS2 (np.ndarray): Dot product of the Newtonian orbital angular momentum unit vector and the spin
+                           vectors of the secondary
 
     Returns:
         (dict): Dictionary containing the splines in orbital frequency of the vector components of
                 the spins, LN and L as well as the spin projections onto LN and L
     """
 
     # Compute necessary powers of v
     v2 = v * v
     v3 = v2 * v
     v4 = v3 * v
     v5 = v4 * v
     v6 = v5 * v
     v7 = v6 * v
-    v8 = v7 * v
+    # v8 = v7 * v
     logv = np.log(v)
 
     nu2 = nu * nu
     nu3 = nu2 * nu
     nu4 = nu3 * nu
 
     lNS1_2 = lNS1 * lNS1
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/postadiabatic_C.c` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/postadiabatic_C.c`

 * *Files 1% similar despite different names*

```diff
@@ -1,21 +1,21 @@
-/* Generated by Cython 3.0.8 */
+/* Generated by Cython 3.0.10 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include",
             "pyseobnr/eob/hamiltonian"
         ],
         "name": "pyseobnr.eob.dynamics.postadiabatic_C",
         "sources": [
             "pyseobnr/eob/dynamics/postadiabatic_C.pyx"
         ]
     },
@@ -43,18 +43,18 @@
     #error Cython requires Python 2.7+ or Python 3.3+.
 #else
 #if defined(CYTHON_LIMITED_API) && CYTHON_LIMITED_API
 #define __PYX_EXTRA_ABI_MODULE_NAME "limited"
 #else
 #define __PYX_EXTRA_ABI_MODULE_NAME ""
 #endif
-#define CYTHON_ABI "3_0_8" __PYX_EXTRA_ABI_MODULE_NAME
+#define CYTHON_ABI "3_0_10" __PYX_EXTRA_ABI_MODULE_NAME
 #define __PYX_ABI_MODULE_NAME "_cython_" CYTHON_ABI
 #define __PYX_TYPE_MODULE_PREFIX __PYX_ABI_MODULE_NAME "."
-#define CYTHON_HEX_VERSION 0x030008F0
+#define CYTHON_HEX_VERSION 0x03000AF0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(_WIN32) && !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -138,14 +138,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(PYPY_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #undef CYTHON_USE_TYPE_SLOTS
@@ -199,14 +201,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(CYTHON_LIMITED_API)
   #ifdef Py_LIMITED_API
     #undef __PYX_LIMITED_VERSION_HEX
     #define __PYX_LIMITED_VERSION_HEX Py_LIMITED_API
   #endif
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
@@ -260,60 +264,83 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(Py_GIL_DISABLED) || defined(Py_NOGIL)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_TYPE_SPECS
+    #define CYTHON_USE_TYPE_SPECS 0
+  #endif
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #ifndef CYTHON_USE_ASYNC_SLOTS
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_PYLONG_INTERNALS
+    #define CYTHON_USE_PYLONG_INTERNALS 0
+  #endif
   #undef CYTHON_USE_PYLIST_INTERNALS
   #define CYTHON_USE_PYLIST_INTERNALS 0
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
   #undef CYTHON_USE_UNICODE_WRITER
   #define CYTHON_USE_UNICODE_WRITER 0
-  #undef CYTHON_USE_PYLONG_INTERNALS
-  #define CYTHON_USE_PYLONG_INTERNALS 0
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
   #undef CYTHON_FAST_THREAD_STATE
   #define CYTHON_FAST_THREAD_STATE 0
+  #undef CYTHON_FAST_GIL
+  #define CYTHON_FAST_GIL 0
+  #ifndef CYTHON_METH_FASTCALL
+    #define CYTHON_METH_FASTCALL 1
+  #endif
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
+  #ifndef CYTHON_PEP487_INIT_SUBCLASS
+    #define CYTHON_PEP487_INIT_SUBCLASS 1
+  #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT 1
   #endif
+  #ifndef CYTHON_USE_MODULE_STATE
+    #define CYTHON_USE_MODULE_STATE 0
+  #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE 1
   #endif
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
@@ -396,14 +423,17 @@
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK 1
   #endif
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
   #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if !defined(CYTHON_VECTORCALL)
 #define CYTHON_VECTORCALL  (CYTHON_FAST_PYCCALL && PY_VERSION_HEX >= 0x030800B1)
 #endif
@@ -739,16 +769,21 @@
   #ifndef METH_FASTCALL
      #define METH_FASTCALL 0x80
   #endif
   typedef PyObject *(*__Pyx_PyCFunctionFast) (PyObject *self, PyObject *const *args, Py_ssize_t nargs);
   typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords) (PyObject *self, PyObject *const *args,
                                                           Py_ssize_t nargs, PyObject *kwnames);
 #else
-  #define __Pyx_PyCFunctionFast _PyCFunctionFast
-  #define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #if PY_VERSION_HEX >= 0x030d00A4
+  #  define __Pyx_PyCFunctionFast PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords PyCFunctionFastWithKeywords
+  #else
+  #  define __Pyx_PyCFunctionFast _PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #endif
 #endif
 #if CYTHON_METH_FASTCALL
   #define __Pyx_METH_FASTCALL METH_FASTCALL
   #define __Pyx_PyCFunction_FastCall __Pyx_PyCFunctionFast
   #define __Pyx_PyCFunction_FastCallWithKeywords __Pyx_PyCFunctionFastWithKeywords
 #else
   #define __Pyx_METH_FASTCALL METH_VARARGS
@@ -1092,15 +1127,15 @@
   #define __Pyx_PyList_SET_ITEM(o, i, v) PyList_SetItem(o, i, v)
   #define __Pyx_PyTuple_GET_SIZE(o) PyTuple_Size(o)
   #define __Pyx_PyList_GET_SIZE(o) PyList_Size(o)
   #define __Pyx_PySet_GET_SIZE(o) PySet_Size(o)
   #define __Pyx_PyBytes_GET_SIZE(o) PyBytes_Size(o)
   #define __Pyx_PyByteArray_GET_SIZE(o) PyByteArray_Size(o)
 #endif
-#if PY_VERSION_HEX >= 0x030d00A1
+#if __PYX_LIMITED_VERSION_HEX >= 0x030d00A1
   #define __Pyx_PyImport_AddModuleRef(name) PyImport_AddModuleRef(name)
 #else
   static CYTHON_INLINE PyObject *__Pyx_PyImport_AddModuleRef(const char *name) {
       PyObject *module = PyImport_AddModule(name);
       Py_XINCREF(module);
       return module;
   }
@@ -1179,15 +1214,15 @@
 #if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
 #define __Pyx_truncl trunc
 #else
 #define __Pyx_truncl truncl
 #endif
 
 #define __PYX_MARK_ERR_POS(f_index, lineno) \
-    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__; (void)__pyx_clineno; }
+    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__;  (void)__pyx_clineno; }
 #define __PYX_ERR(f_index, lineno, Ln_error) \
     { __PYX_MARK_ERR_POS(f_index, lineno) goto Ln_error; }
 
 #ifdef CYTHON_EXTERN_C
     #undef __PYX_EXTERN_C
     #define __PYX_EXTERN_C CYTHON_EXTERN_C
 #elif defined(__PYX_EXTERN_C)
@@ -1287,32 +1322,15 @@
 #define __Pyx_PyObject_AsSString(s)    ((const signed char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_AsUString(s)    ((const unsigned char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
 #define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
 #define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
 #define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
 #define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
-#if CYTHON_COMPILING_IN_LIMITED_API
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const wchar_t *u)
-{
-    const wchar_t *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#else
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
-{
-    const Py_UNICODE *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#endif
 #define __Pyx_PyUnicode_FromOrdinal(o)       PyUnicode_FromOrdinal((int)o)
-#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
-#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
 #define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
 #define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
 #define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
 static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
@@ -1678,17 +1696,17 @@
 struct __pyx_memoryviewslice_obj;
 struct __pyx_ctuple_double__and_double;
 typedef struct __pyx_ctuple_double__and_double __pyx_ctuple_double__and_double;
 
 /* "pyseobnr/eob/waveform/waveform.pxd":7
  *     const int ell_max
  * 
- * cpdef (double, double) RR_force(double[::1] q, double[::1] p, double omega, double omega_circ,             # <<<<<<<<<<<<<<
- *     double H, EOBParams eob_pars)
- * 
+ * cpdef (double, double) RR_force(             # <<<<<<<<<<<<<<
+ *     double[::1] q,
+ *     double[::1] p,
  */
 struct __pyx_ctuple_double__and_double {
   double f0;
   double f1;
 };
 struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative;
 struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral;
@@ -1701,28 +1719,28 @@
 struct __pyx_ctuple_double__and_double__and_double__and_double;
 typedef struct __pyx_ctuple_double__and_double__and_double__and_double __pyx_ctuple_double__and_double__and_double__and_double;
 
 /* "pyseobnr/eob/dynamics/postadiabatic_C.pxd":5
  * from pyseobnr.eob.hamiltonian.Hamiltonian_C cimport Hamiltonian_C
  * 
  * cpdef fin_diff_derivative(             # <<<<<<<<<<<<<<
- *     double[:] x,
- *     double[:] y,
+ *     x: np.array,
+ *     y: np.array,
  */
 struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative {
   int __pyx_n;
   int n;
 };
 
 /* "pyseobnr/eob/dynamics/postadiabatic_C.pxd":11
  * )
  * 
  * cpdef cumulative_integral(             # <<<<<<<<<<<<<<
- *     double[:] x,
- *     double[:] y,
+ *     x: np.array,
+ *     y: np.array,
  */
 struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral {
   int __pyx_n;
   int order;
 };
 
 /* "pyseobnr/eob/dynamics/postadiabatic_C.pxd":24
@@ -1942,32 +1960,33 @@
 struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C {
   PyObject_HEAD
   struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_vtab;
   struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *EOBpars;
 };
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":10
- *     double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":15
+ *     EOBParams eob_pars)
  * 
  * cdef class RadiationReactionForce:             # <<<<<<<<<<<<<<
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,
- *         double omega_circ, double H, EOBParams eob_pars)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce {
   PyObject_HEAD
   struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_vtab;
 };
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":14
- *         double omega_circ, double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":25
+ *         EOBParams eob_pars)
  * 
  * cdef class SEOBNRv5RRForce(RadiationReactionForce):             # <<<<<<<<<<<<<<
- *     cpdef (double,double) RR(self, double[::1] q,double[::1] p,double omega,double omega_circ,double H,EOBParams eob_par)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce {
   struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce __pyx_base;
 };
 
 
 /* "View.MemoryView":114
@@ -2078,33 +2097,34 @@
   PyObject *(*dynamics)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
   double (*omega)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
   PyObject *(*auxderivs)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":10
- *     double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":15
+ *     EOBParams eob_pars)
  * 
  * cdef class RadiationReactionForce:             # <<<<<<<<<<<<<<
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,
- *         double omega_circ, double H, EOBParams eob_pars)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 
 struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce {
   __pyx_ctuple_double__and_double (*RR)(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *, int __pyx_skip_dispatch);
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":14
- *         double omega_circ, double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":25
+ *         EOBParams eob_pars)
  * 
  * cdef class SEOBNRv5RRForce(RadiationReactionForce):             # <<<<<<<<<<<<<<
- *     cpdef (double,double) RR(self, double[::1] q,double[::1] p,double omega,double omega_circ,double H,EOBParams eob_par)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 
 struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce {
   struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce __pyx_base;
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce *__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce;
 
@@ -2980,16 +3000,19 @@
       }\
   }
   #endif
 #else
   #define __Pyx_TraceLine(lineno, nogil, goto_error)   if ((1)); else goto_error;
 #endif
 
-/* BufferIndexError.proto */
-static void __Pyx_RaiseBufferIndexError(int axis);
+/* SliceObject.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(
+        PyObject* obj, Py_ssize_t cstart, Py_ssize_t cstop,
+        PyObject** py_start, PyObject** py_stop, PyObject** py_slice,
+        int has_cstart, int has_cstop, int wraparound);
 
 /* PyIntBinop.proto */
 #if !CYTHON_COMPILING_IN_PYPY
 static PyObject* __Pyx_PyInt_AddCObj(PyObject *op1, PyObject *op2, long intval, int inplace, int zerodivision_check);
 #else
 #define __Pyx_PyInt_AddCObj(op1, op2, intval, inplace, zerodivision_check)\
     (inplace ? PyNumber_InPlaceAdd(op1, op2) : PyNumber_Add(op1, op2))
@@ -3015,29 +3038,26 @@
 #if !CYTHON_COMPILING_IN_PYPY
 static PyObject* __Pyx_PyInt_SubtractObjC(PyObject *op1, PyObject *op2, long intval, int inplace, int zerodivision_check);
 #else
 #define __Pyx_PyInt_SubtractObjC(op1, op2, intval, inplace, zerodivision_check)\
     (inplace ? PyNumber_InPlaceSubtract(op1, op2) : PyNumber_Subtract(op1, op2))
 #endif
 
+/* BufferIndexError.proto */
+static void __Pyx_RaiseBufferIndexError(int axis);
+
 /* ModInt[long].proto */
 static CYTHON_INLINE long __Pyx_mod_long(long, long);
 
 /* IterFinish.proto */
 static CYTHON_INLINE int __Pyx_IterFinish(void);
 
 /* UnpackItemEndCheck.proto */
 static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected);
 
-/* SliceObject.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(
-        PyObject* obj, Py_ssize_t cstart, Py_ssize_t cstop,
-        PyObject** py_start, PyObject** py_stop, PyObject** py_slice,
-        int has_cstart, int has_cstop, int wraparound);
-
 /* PyIntCompare.proto */
 static CYTHON_INLINE int __Pyx_PyInt_BoolEqObjC(PyObject *op1, PyObject *op2, long intval, long inplace);
 
 /* PyIntBinop.proto */
 #if !CYTHON_COMPILING_IN_PYPY
 static PyObject* __Pyx_PyInt_AddObjC(PyObject *op1, PyObject *op2, long intval, int inplace, int zerodivision_check);
 #else
@@ -3097,30 +3117,30 @@
 
 /* SetupReduce.proto */
 #if !CYTHON_COMPILING_IN_LIMITED_API
 static int __Pyx_setup_reduce(PyObject* type_obj);
 #endif
 
 /* TypeImport.proto */
-#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_8
-#define __PYX_HAVE_RT_ImportType_proto_3_0_8
+#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_10
+#define __PYX_HAVE_RT_ImportType_proto_3_0_10
 #if defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L
 #include <stdalign.h>
 #endif
 #if (defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L) || __cplusplus >= 201103L
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) alignof(s)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) alignof(s)
 #else
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) sizeof(void*)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) sizeof(void*)
 #endif
-enum __Pyx_ImportType_CheckSize_3_0_8 {
-   __Pyx_ImportType_CheckSize_Error_3_0_8 = 0,
-   __Pyx_ImportType_CheckSize_Warn_3_0_8 = 1,
-   __Pyx_ImportType_CheckSize_Ignore_3_0_8 = 2
+enum __Pyx_ImportType_CheckSize_3_0_10 {
+   __Pyx_ImportType_CheckSize_Error_3_0_10 = 0,
+   __Pyx_ImportType_CheckSize_Warn_3_0_10 = 1,
+   __Pyx_ImportType_CheckSize_Ignore_3_0_10 = 2
 };
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size);
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size);
 #endif
 
 /* FetchSharedCythonModule.proto */
 static PyObject *__Pyx_FetchSharedCythonABIModule(void);
 
 /* FetchCommonType.proto */
 #if !CYTHON_USE_TYPE_SPECS
@@ -3343,21 +3363,21 @@
 
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_double(PyObject *, int writable_flag);
 
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dc_double(PyObject *, int writable_flag);
 
+/* FromPyCTupleUtility.proto */
+static CYTHON_INLINE __pyx_ctuple_double__and_double__and_double__and_double __pyx_convert__from_py___pyx_ctuple_double__and_double__and_double__and_double(PyObject *);
+
 /* MemviewDtypeToObject.proto */
 static CYTHON_INLINE PyObject *__pyx_memview_get_double(const char *itemp);
 static CYTHON_INLINE int __pyx_memview_set_double(const char *itemp, PyObject *obj);
 
-/* FromPyCTupleUtility.proto */
-static CYTHON_INLINE __pyx_ctuple_double__and_double__and_double__and_double __pyx_convert__from_py___pyx_ctuple_double__and_double__and_double__and_double(PyObject *);
-
 /* RealImag.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     #define __Pyx_CREAL(z) ((z).real())
     #define __Pyx_CIMAG(z) ((z).imag())
   #else
     #define __Pyx_CREAL(z) (__real__(z))
@@ -3446,18 +3466,18 @@
 static CYTHON_INLINE void __Pyx_INC_MEMVIEW(__Pyx_memviewslice *, int, int);
 static CYTHON_INLINE void __Pyx_XCLEAR_MEMVIEW(__Pyx_memviewslice *, int, int);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);
 
 /* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
 
 /* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE char __Pyx_PyInt_As_char(PyObject *);
 
@@ -3517,16 +3537,16 @@
 static PyObject *generic = 0;
 static PyObject *strided = 0;
 static PyObject *indirect = 0;
 static PyObject *contiguous = 0;
 static PyObject *indirect_contiguous = 0;
 static int __pyx_memoryview_thread_locks_used;
 static PyThread_type_lock __pyx_memoryview_thread_locks[8];
-static PyObject *__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(__Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative *__pyx_optional_args); /*proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral(__Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral *__pyx_optional_args); /*proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(PyObject *, PyObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative *__pyx_optional_args); /*proto*/
+static PyObject *__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral(PyObject *, PyObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral *__pyx_optional_args); /*proto*/
 static PyObject *__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_Kerr_ISCO(double, double, double, double, int __pyx_skip_dispatch); /*proto*/
 static PyObject *__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_adiabatic_solution(__Pyx_memviewslice, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, double, double, double, double, __Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_adiabatic_solution *__pyx_optional_args); /*proto*/
 static double __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__Pyx_memviewslice, double, __Pyx_memviewslice); /*proto*/
 static double __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_j0_eqn(double, double, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, double, double, double, double, __Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch); /*proto*/
 static double __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_pr_eqn(double, double, double, double, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *, double, double, double, double, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *, __Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch); /*proto*/
 static double __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_pr_eqn_wrapper(PyObject *, PyObject *, int __pyx_skip_dispatch); /*proto*/
 static PyObject *__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_pr(__Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *, double, double, double, double, __Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_pr *__pyx_optional_args); /*proto*/
@@ -3610,15 +3630,15 @@
 static const char __pyx_k__7[] = ")";
 static const char __pyx_k_gc[] = "gc";
 static const char __pyx_k_id[] = "id";
 static const char __pyx_k_m1[] = "m1";
 static const char __pyx_k_m2[] = "m2";
 static const char __pyx_k_np[] = "np";
 static const char __pyx_k_pr[] = "pr";
-static const char __pyx_k__70[] = "?";
+static const char __pyx_k__78[] = "?";
 static const char __pyx_k_abc[] = "abc";
 static const char __pyx_k_abs[] = "abs";
 static const char __pyx_k_and[] = " and ";
 static const char __pyx_k_c_2[] = "c_";
 static const char __pyx_k_csi[] = "csi";
 static const char __pyx_k_dyn[] = "dyn";
 static const char __pyx_k_got[] = " (got ";
@@ -3870,29 +3890,29 @@
 static PyObject *__pyx_memoryview___pyx_pf_15View_dot_MemoryView_10memoryview_22copy_fortran(struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static void __pyx_memoryviewslice___pyx_pf_15View_dot_MemoryView_16_memoryviewslice___dealloc__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView___pyx_unpickle_Enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, int __pyx_v_n); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, int __pyx_v_n); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_2Kerr_ISCO(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_chi1, double __pyx_v_chi2, double __pyx_v_m1, double __pyx_v_m2); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_4Newtonian_j0(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_r); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_6j0_eqn(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_j0_sol, double __pyx_v_r, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_H, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_8compute_adiabatic_solution(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_r, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_H, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_tol); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_10pr_eqn(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_pr_sol, double __pyx_v_r, double __pyx_v_pphi, double __pyx_v_dpphi_dr, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_H, struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_v_RR, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_params, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_12pr_eqn_wrapper(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pr_sol, PyObject *__pyx_v_args); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_14compute_pr(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_r, __Pyx_memviewslice __pyx_v_pr, __Pyx_memviewslice __pyx_v_pphi, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_H, struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_v_RR, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_tol, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_params); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_16pphi_eqn(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_pphi_sol, double __pyx_v_r, double __pyx_v_pr, double __pyx_v_dpr_dr, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_H, struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_v_RR, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_params, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_18pphi_eqn_wrapper(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pphi_sol, PyObject *__pyx_v_args); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_20compute_pphi(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_r, __Pyx_memviewslice __pyx_v_pr, __Pyx_memviewslice __pyx_v_pphi, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_H, struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_v_RR, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_tol, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_params); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_22compute_postadiabatic_solution(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_r, __Pyx_memviewslice __pyx_v_pphi, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_H, struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_v_RR, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2, __Pyx_memviewslice __pyx_v_q, __Pyx_memviewslice __pyx_v_p, double __pyx_v_tol, int __pyx_v_order, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_params); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_24compute_postadiabatic_dynamics(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_omega0, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_H, struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_v_RR, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_tol, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_params, PyObject *__pyx_v_order); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_26compute_combined_dynamics(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_omega0, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_v_H, struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_v_RR, double __pyx_v_chi_1, double __pyx_v_chi_2, double __pyx_v_m_1, double __pyx_v_m_2, double __pyx_v_tol, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_params, double __pyx_v_step_back, PyObject *__pyx_v_backend, int __pyx_v_PA_order, double __pyx_v_r_stop); /* proto */
-static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_28cumulative_integral(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, int __pyx_v_order); /* proto */
+static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_28cumulative_integral(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, int __pyx_v_order); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_30univariate_spline_integral(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
 static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_32compute_adiabatic_parameter(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dynamics, PyObject *__pyx_v_H, PyObject *__pyx_v_chi_1, PyObject *__pyx_v_chi_2, PyObject *__pyx_v_m_1, PyObject *__pyx_v_m_2, CYTHON_UNUSED PyObject *__pyx_v_params); /* proto */
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_Enum(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new__memoryviewslice(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 /* #### Code section: late_includes ### */
@@ -3996,15 +4016,15 @@
   PyObject *__pyx_kp_s_Unable_to_convert_item_to_object;
   PyObject *__pyx_n_s_ValueError;
   PyObject *__pyx_n_s_View_MemoryView;
   PyObject *__pyx_kp_u__2;
   PyObject *__pyx_n_s__3;
   PyObject *__pyx_kp_u__6;
   PyObject *__pyx_kp_u__7;
-  PyObject *__pyx_n_s__70;
+  PyObject *__pyx_n_s__78;
   PyObject *__pyx_n_s_abc;
   PyObject *__pyx_n_s_abs;
   PyObject *__pyx_n_s_adiabatic_param;
   PyObject *__pyx_n_s_allocate_buffer;
   PyObject *__pyx_kp_u_and;
   PyObject *__pyx_n_s_antiderivative;
   PyObject *__pyx_n_s_args;
@@ -4210,84 +4230,98 @@
   PyObject *__pyx_float_neg_14_;
   PyObject *__pyx_int_0;
   PyObject *__pyx_int_1;
   PyObject *__pyx_int_2;
   PyObject *__pyx_int_3;
   PyObject *__pyx_int_4;
   PyObject *__pyx_int_5;
+  PyObject *__pyx_int_6;
   PyObject *__pyx_int_7;
   PyObject *__pyx_int_8;
+  PyObject *__pyx_int_9;
   PyObject *__pyx_int_112105877;
   PyObject *__pyx_int_136983863;
   PyObject *__pyx_int_184977713;
   PyObject *__pyx_int_neg_1;
+  PyObject *__pyx_int_neg_4;
+  PyObject *__pyx_int_neg_6;
+  PyObject *__pyx_int_neg_8;
+  PyObject *__pyx_int_neg_9;
   PyObject *__pyx_slice__5;
   PyObject *__pyx_tuple__4;
   PyObject *__pyx_tuple__8;
-  PyObject *__pyx_slice__20;
-  PyObject *__pyx_slice__24;
-  PyObject *__pyx_slice__27;
+  PyObject *__pyx_slice__10;
+  PyObject *__pyx_slice__11;
+  PyObject *__pyx_slice__22;
+  PyObject *__pyx_slice__26;
+  PyObject *__pyx_slice__28;
   PyObject *__pyx_slice__29;
   PyObject *__pyx_slice__30;
-  PyObject *__pyx_tuple__21;
-  PyObject *__pyx_tuple__22;
+  PyObject *__pyx_slice__31;
+  PyObject *__pyx_slice__32;
+  PyObject *__pyx_slice__33;
+  PyObject *__pyx_slice__35;
+  PyObject *__pyx_slice__37;
+  PyObject *__pyx_slice__38;
   PyObject *__pyx_tuple__23;
-  PyObject *__pyx_tuple__31;
-  PyObject *__pyx_tuple__32;
-  PyObject *__pyx_tuple__33;
-  PyObject *__pyx_tuple__34;
-  PyObject *__pyx_tuple__35;
-  PyObject *__pyx_tuple__36;
-  PyObject *__pyx_tuple__37;
-  PyObject *__pyx_tuple__38;
+  PyObject *__pyx_tuple__24;
+  PyObject *__pyx_tuple__25;
   PyObject *__pyx_tuple__39;
   PyObject *__pyx_tuple__40;
   PyObject *__pyx_tuple__41;
+  PyObject *__pyx_tuple__42;
   PyObject *__pyx_tuple__43;
   PyObject *__pyx_tuple__44;
   PyObject *__pyx_tuple__45;
   PyObject *__pyx_tuple__46;
   PyObject *__pyx_tuple__47;
   PyObject *__pyx_tuple__48;
-  PyObject *__pyx_tuple__50;
+  PyObject *__pyx_tuple__49;
   PyObject *__pyx_tuple__51;
   PyObject *__pyx_tuple__52;
+  PyObject *__pyx_tuple__53;
   PyObject *__pyx_tuple__54;
   PyObject *__pyx_tuple__55;
   PyObject *__pyx_tuple__56;
-  PyObject *__pyx_tuple__57;
+  PyObject *__pyx_tuple__58;
   PyObject *__pyx_tuple__59;
   PyObject *__pyx_tuple__60;
-  PyObject *__pyx_tuple__61;
   PyObject *__pyx_tuple__62;
   PyObject *__pyx_tuple__63;
   PyObject *__pyx_tuple__64;
   PyObject *__pyx_tuple__65;
-  PyObject *__pyx_tuple__66;
   PyObject *__pyx_tuple__67;
   PyObject *__pyx_tuple__68;
   PyObject *__pyx_tuple__69;
+  PyObject *__pyx_tuple__70;
+  PyObject *__pyx_tuple__71;
+  PyObject *__pyx_tuple__72;
+  PyObject *__pyx_tuple__73;
+  PyObject *__pyx_tuple__74;
+  PyObject *__pyx_tuple__75;
+  PyObject *__pyx_tuple__76;
+  PyObject *__pyx_tuple__77;
   PyObject *__pyx_codeobj__9;
-  PyObject *__pyx_codeobj__10;
-  PyObject *__pyx_codeobj__11;
   PyObject *__pyx_codeobj__12;
   PyObject *__pyx_codeobj__13;
   PyObject *__pyx_codeobj__14;
   PyObject *__pyx_codeobj__15;
   PyObject *__pyx_codeobj__16;
   PyObject *__pyx_codeobj__17;
   PyObject *__pyx_codeobj__18;
   PyObject *__pyx_codeobj__19;
-  PyObject *__pyx_codeobj__25;
-  PyObject *__pyx_codeobj__26;
-  PyObject *__pyx_codeobj__28;
-  PyObject *__pyx_codeobj__42;
-  PyObject *__pyx_codeobj__49;
-  PyObject *__pyx_codeobj__53;
-  PyObject *__pyx_codeobj__58;
+  PyObject *__pyx_codeobj__20;
+  PyObject *__pyx_codeobj__21;
+  PyObject *__pyx_codeobj__27;
+  PyObject *__pyx_codeobj__34;
+  PyObject *__pyx_codeobj__36;
+  PyObject *__pyx_codeobj__50;
+  PyObject *__pyx_codeobj__57;
+  PyObject *__pyx_codeobj__61;
+  PyObject *__pyx_codeobj__66;
 } __pyx_mstate;
 
 #if CYTHON_USE_MODULE_STATE
 #ifdef __cplusplus
 namespace {
   extern struct PyModuleDef __pyx_moduledef;
 } /* anonymous namespace */
@@ -4384,15 +4418,15 @@
   Py_CLEAR(clear_module_state->__pyx_kp_s_Unable_to_convert_item_to_object);
   Py_CLEAR(clear_module_state->__pyx_n_s_ValueError);
   Py_CLEAR(clear_module_state->__pyx_n_s_View_MemoryView);
   Py_CLEAR(clear_module_state->__pyx_kp_u__2);
   Py_CLEAR(clear_module_state->__pyx_n_s__3);
   Py_CLEAR(clear_module_state->__pyx_kp_u__6);
   Py_CLEAR(clear_module_state->__pyx_kp_u__7);
-  Py_CLEAR(clear_module_state->__pyx_n_s__70);
+  Py_CLEAR(clear_module_state->__pyx_n_s__78);
   Py_CLEAR(clear_module_state->__pyx_n_s_abc);
   Py_CLEAR(clear_module_state->__pyx_n_s_abs);
   Py_CLEAR(clear_module_state->__pyx_n_s_adiabatic_param);
   Py_CLEAR(clear_module_state->__pyx_n_s_allocate_buffer);
   Py_CLEAR(clear_module_state->__pyx_kp_u_and);
   Py_CLEAR(clear_module_state->__pyx_n_s_antiderivative);
   Py_CLEAR(clear_module_state->__pyx_n_s_args);
@@ -4598,84 +4632,98 @@
   Py_CLEAR(clear_module_state->__pyx_float_neg_14_);
   Py_CLEAR(clear_module_state->__pyx_int_0);
   Py_CLEAR(clear_module_state->__pyx_int_1);
   Py_CLEAR(clear_module_state->__pyx_int_2);
   Py_CLEAR(clear_module_state->__pyx_int_3);
   Py_CLEAR(clear_module_state->__pyx_int_4);
   Py_CLEAR(clear_module_state->__pyx_int_5);
+  Py_CLEAR(clear_module_state->__pyx_int_6);
   Py_CLEAR(clear_module_state->__pyx_int_7);
   Py_CLEAR(clear_module_state->__pyx_int_8);
+  Py_CLEAR(clear_module_state->__pyx_int_9);
   Py_CLEAR(clear_module_state->__pyx_int_112105877);
   Py_CLEAR(clear_module_state->__pyx_int_136983863);
   Py_CLEAR(clear_module_state->__pyx_int_184977713);
   Py_CLEAR(clear_module_state->__pyx_int_neg_1);
+  Py_CLEAR(clear_module_state->__pyx_int_neg_4);
+  Py_CLEAR(clear_module_state->__pyx_int_neg_6);
+  Py_CLEAR(clear_module_state->__pyx_int_neg_8);
+  Py_CLEAR(clear_module_state->__pyx_int_neg_9);
   Py_CLEAR(clear_module_state->__pyx_slice__5);
   Py_CLEAR(clear_module_state->__pyx_tuple__4);
   Py_CLEAR(clear_module_state->__pyx_tuple__8);
-  Py_CLEAR(clear_module_state->__pyx_slice__20);
-  Py_CLEAR(clear_module_state->__pyx_slice__24);
-  Py_CLEAR(clear_module_state->__pyx_slice__27);
+  Py_CLEAR(clear_module_state->__pyx_slice__10);
+  Py_CLEAR(clear_module_state->__pyx_slice__11);
+  Py_CLEAR(clear_module_state->__pyx_slice__22);
+  Py_CLEAR(clear_module_state->__pyx_slice__26);
+  Py_CLEAR(clear_module_state->__pyx_slice__28);
   Py_CLEAR(clear_module_state->__pyx_slice__29);
   Py_CLEAR(clear_module_state->__pyx_slice__30);
-  Py_CLEAR(clear_module_state->__pyx_tuple__21);
-  Py_CLEAR(clear_module_state->__pyx_tuple__22);
+  Py_CLEAR(clear_module_state->__pyx_slice__31);
+  Py_CLEAR(clear_module_state->__pyx_slice__32);
+  Py_CLEAR(clear_module_state->__pyx_slice__33);
+  Py_CLEAR(clear_module_state->__pyx_slice__35);
+  Py_CLEAR(clear_module_state->__pyx_slice__37);
+  Py_CLEAR(clear_module_state->__pyx_slice__38);
   Py_CLEAR(clear_module_state->__pyx_tuple__23);
-  Py_CLEAR(clear_module_state->__pyx_tuple__31);
-  Py_CLEAR(clear_module_state->__pyx_tuple__32);
-  Py_CLEAR(clear_module_state->__pyx_tuple__33);
-  Py_CLEAR(clear_module_state->__pyx_tuple__34);
-  Py_CLEAR(clear_module_state->__pyx_tuple__35);
-  Py_CLEAR(clear_module_state->__pyx_tuple__36);
-  Py_CLEAR(clear_module_state->__pyx_tuple__37);
-  Py_CLEAR(clear_module_state->__pyx_tuple__38);
+  Py_CLEAR(clear_module_state->__pyx_tuple__24);
+  Py_CLEAR(clear_module_state->__pyx_tuple__25);
   Py_CLEAR(clear_module_state->__pyx_tuple__39);
   Py_CLEAR(clear_module_state->__pyx_tuple__40);
   Py_CLEAR(clear_module_state->__pyx_tuple__41);
+  Py_CLEAR(clear_module_state->__pyx_tuple__42);
   Py_CLEAR(clear_module_state->__pyx_tuple__43);
   Py_CLEAR(clear_module_state->__pyx_tuple__44);
   Py_CLEAR(clear_module_state->__pyx_tuple__45);
   Py_CLEAR(clear_module_state->__pyx_tuple__46);
   Py_CLEAR(clear_module_state->__pyx_tuple__47);
   Py_CLEAR(clear_module_state->__pyx_tuple__48);
-  Py_CLEAR(clear_module_state->__pyx_tuple__50);
+  Py_CLEAR(clear_module_state->__pyx_tuple__49);
   Py_CLEAR(clear_module_state->__pyx_tuple__51);
   Py_CLEAR(clear_module_state->__pyx_tuple__52);
+  Py_CLEAR(clear_module_state->__pyx_tuple__53);
   Py_CLEAR(clear_module_state->__pyx_tuple__54);
   Py_CLEAR(clear_module_state->__pyx_tuple__55);
   Py_CLEAR(clear_module_state->__pyx_tuple__56);
-  Py_CLEAR(clear_module_state->__pyx_tuple__57);
+  Py_CLEAR(clear_module_state->__pyx_tuple__58);
   Py_CLEAR(clear_module_state->__pyx_tuple__59);
   Py_CLEAR(clear_module_state->__pyx_tuple__60);
-  Py_CLEAR(clear_module_state->__pyx_tuple__61);
   Py_CLEAR(clear_module_state->__pyx_tuple__62);
   Py_CLEAR(clear_module_state->__pyx_tuple__63);
   Py_CLEAR(clear_module_state->__pyx_tuple__64);
   Py_CLEAR(clear_module_state->__pyx_tuple__65);
-  Py_CLEAR(clear_module_state->__pyx_tuple__66);
   Py_CLEAR(clear_module_state->__pyx_tuple__67);
   Py_CLEAR(clear_module_state->__pyx_tuple__68);
   Py_CLEAR(clear_module_state->__pyx_tuple__69);
+  Py_CLEAR(clear_module_state->__pyx_tuple__70);
+  Py_CLEAR(clear_module_state->__pyx_tuple__71);
+  Py_CLEAR(clear_module_state->__pyx_tuple__72);
+  Py_CLEAR(clear_module_state->__pyx_tuple__73);
+  Py_CLEAR(clear_module_state->__pyx_tuple__74);
+  Py_CLEAR(clear_module_state->__pyx_tuple__75);
+  Py_CLEAR(clear_module_state->__pyx_tuple__76);
+  Py_CLEAR(clear_module_state->__pyx_tuple__77);
   Py_CLEAR(clear_module_state->__pyx_codeobj__9);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__10);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__11);
   Py_CLEAR(clear_module_state->__pyx_codeobj__12);
   Py_CLEAR(clear_module_state->__pyx_codeobj__13);
   Py_CLEAR(clear_module_state->__pyx_codeobj__14);
   Py_CLEAR(clear_module_state->__pyx_codeobj__15);
   Py_CLEAR(clear_module_state->__pyx_codeobj__16);
   Py_CLEAR(clear_module_state->__pyx_codeobj__17);
   Py_CLEAR(clear_module_state->__pyx_codeobj__18);
   Py_CLEAR(clear_module_state->__pyx_codeobj__19);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__25);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__26);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__28);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__42);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__49);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__53);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__58);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__20);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__21);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__27);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__34);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__36);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__50);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__57);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__61);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__66);
   return 0;
 }
 #endif
 /* #### Code section: module_state_traverse ### */
 #if CYTHON_USE_MODULE_STATE
 static int __pyx_m_traverse(PyObject *m, visitproc visit, void *arg) {
   __pyx_mstate *traverse_module_state = __pyx_mstate(m);
@@ -4750,15 +4798,15 @@
   Py_VISIT(traverse_module_state->__pyx_kp_s_Unable_to_convert_item_to_object);
   Py_VISIT(traverse_module_state->__pyx_n_s_ValueError);
   Py_VISIT(traverse_module_state->__pyx_n_s_View_MemoryView);
   Py_VISIT(traverse_module_state->__pyx_kp_u__2);
   Py_VISIT(traverse_module_state->__pyx_n_s__3);
   Py_VISIT(traverse_module_state->__pyx_kp_u__6);
   Py_VISIT(traverse_module_state->__pyx_kp_u__7);
-  Py_VISIT(traverse_module_state->__pyx_n_s__70);
+  Py_VISIT(traverse_module_state->__pyx_n_s__78);
   Py_VISIT(traverse_module_state->__pyx_n_s_abc);
   Py_VISIT(traverse_module_state->__pyx_n_s_abs);
   Py_VISIT(traverse_module_state->__pyx_n_s_adiabatic_param);
   Py_VISIT(traverse_module_state->__pyx_n_s_allocate_buffer);
   Py_VISIT(traverse_module_state->__pyx_kp_u_and);
   Py_VISIT(traverse_module_state->__pyx_n_s_antiderivative);
   Py_VISIT(traverse_module_state->__pyx_n_s_args);
@@ -4964,84 +5012,98 @@
   Py_VISIT(traverse_module_state->__pyx_float_neg_14_);
   Py_VISIT(traverse_module_state->__pyx_int_0);
   Py_VISIT(traverse_module_state->__pyx_int_1);
   Py_VISIT(traverse_module_state->__pyx_int_2);
   Py_VISIT(traverse_module_state->__pyx_int_3);
   Py_VISIT(traverse_module_state->__pyx_int_4);
   Py_VISIT(traverse_module_state->__pyx_int_5);
+  Py_VISIT(traverse_module_state->__pyx_int_6);
   Py_VISIT(traverse_module_state->__pyx_int_7);
   Py_VISIT(traverse_module_state->__pyx_int_8);
+  Py_VISIT(traverse_module_state->__pyx_int_9);
   Py_VISIT(traverse_module_state->__pyx_int_112105877);
   Py_VISIT(traverse_module_state->__pyx_int_136983863);
   Py_VISIT(traverse_module_state->__pyx_int_184977713);
   Py_VISIT(traverse_module_state->__pyx_int_neg_1);
+  Py_VISIT(traverse_module_state->__pyx_int_neg_4);
+  Py_VISIT(traverse_module_state->__pyx_int_neg_6);
+  Py_VISIT(traverse_module_state->__pyx_int_neg_8);
+  Py_VISIT(traverse_module_state->__pyx_int_neg_9);
   Py_VISIT(traverse_module_state->__pyx_slice__5);
   Py_VISIT(traverse_module_state->__pyx_tuple__4);
   Py_VISIT(traverse_module_state->__pyx_tuple__8);
-  Py_VISIT(traverse_module_state->__pyx_slice__20);
-  Py_VISIT(traverse_module_state->__pyx_slice__24);
-  Py_VISIT(traverse_module_state->__pyx_slice__27);
+  Py_VISIT(traverse_module_state->__pyx_slice__10);
+  Py_VISIT(traverse_module_state->__pyx_slice__11);
+  Py_VISIT(traverse_module_state->__pyx_slice__22);
+  Py_VISIT(traverse_module_state->__pyx_slice__26);
+  Py_VISIT(traverse_module_state->__pyx_slice__28);
   Py_VISIT(traverse_module_state->__pyx_slice__29);
   Py_VISIT(traverse_module_state->__pyx_slice__30);
-  Py_VISIT(traverse_module_state->__pyx_tuple__21);
-  Py_VISIT(traverse_module_state->__pyx_tuple__22);
+  Py_VISIT(traverse_module_state->__pyx_slice__31);
+  Py_VISIT(traverse_module_state->__pyx_slice__32);
+  Py_VISIT(traverse_module_state->__pyx_slice__33);
+  Py_VISIT(traverse_module_state->__pyx_slice__35);
+  Py_VISIT(traverse_module_state->__pyx_slice__37);
+  Py_VISIT(traverse_module_state->__pyx_slice__38);
   Py_VISIT(traverse_module_state->__pyx_tuple__23);
-  Py_VISIT(traverse_module_state->__pyx_tuple__31);
-  Py_VISIT(traverse_module_state->__pyx_tuple__32);
-  Py_VISIT(traverse_module_state->__pyx_tuple__33);
-  Py_VISIT(traverse_module_state->__pyx_tuple__34);
-  Py_VISIT(traverse_module_state->__pyx_tuple__35);
-  Py_VISIT(traverse_module_state->__pyx_tuple__36);
-  Py_VISIT(traverse_module_state->__pyx_tuple__37);
-  Py_VISIT(traverse_module_state->__pyx_tuple__38);
+  Py_VISIT(traverse_module_state->__pyx_tuple__24);
+  Py_VISIT(traverse_module_state->__pyx_tuple__25);
   Py_VISIT(traverse_module_state->__pyx_tuple__39);
   Py_VISIT(traverse_module_state->__pyx_tuple__40);
   Py_VISIT(traverse_module_state->__pyx_tuple__41);
+  Py_VISIT(traverse_module_state->__pyx_tuple__42);
   Py_VISIT(traverse_module_state->__pyx_tuple__43);
   Py_VISIT(traverse_module_state->__pyx_tuple__44);
   Py_VISIT(traverse_module_state->__pyx_tuple__45);
   Py_VISIT(traverse_module_state->__pyx_tuple__46);
   Py_VISIT(traverse_module_state->__pyx_tuple__47);
   Py_VISIT(traverse_module_state->__pyx_tuple__48);
-  Py_VISIT(traverse_module_state->__pyx_tuple__50);
+  Py_VISIT(traverse_module_state->__pyx_tuple__49);
   Py_VISIT(traverse_module_state->__pyx_tuple__51);
   Py_VISIT(traverse_module_state->__pyx_tuple__52);
+  Py_VISIT(traverse_module_state->__pyx_tuple__53);
   Py_VISIT(traverse_module_state->__pyx_tuple__54);
   Py_VISIT(traverse_module_state->__pyx_tuple__55);
   Py_VISIT(traverse_module_state->__pyx_tuple__56);
-  Py_VISIT(traverse_module_state->__pyx_tuple__57);
+  Py_VISIT(traverse_module_state->__pyx_tuple__58);
   Py_VISIT(traverse_module_state->__pyx_tuple__59);
   Py_VISIT(traverse_module_state->__pyx_tuple__60);
-  Py_VISIT(traverse_module_state->__pyx_tuple__61);
   Py_VISIT(traverse_module_state->__pyx_tuple__62);
   Py_VISIT(traverse_module_state->__pyx_tuple__63);
   Py_VISIT(traverse_module_state->__pyx_tuple__64);
   Py_VISIT(traverse_module_state->__pyx_tuple__65);
-  Py_VISIT(traverse_module_state->__pyx_tuple__66);
   Py_VISIT(traverse_module_state->__pyx_tuple__67);
   Py_VISIT(traverse_module_state->__pyx_tuple__68);
   Py_VISIT(traverse_module_state->__pyx_tuple__69);
+  Py_VISIT(traverse_module_state->__pyx_tuple__70);
+  Py_VISIT(traverse_module_state->__pyx_tuple__71);
+  Py_VISIT(traverse_module_state->__pyx_tuple__72);
+  Py_VISIT(traverse_module_state->__pyx_tuple__73);
+  Py_VISIT(traverse_module_state->__pyx_tuple__74);
+  Py_VISIT(traverse_module_state->__pyx_tuple__75);
+  Py_VISIT(traverse_module_state->__pyx_tuple__76);
+  Py_VISIT(traverse_module_state->__pyx_tuple__77);
   Py_VISIT(traverse_module_state->__pyx_codeobj__9);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__10);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__11);
   Py_VISIT(traverse_module_state->__pyx_codeobj__12);
   Py_VISIT(traverse_module_state->__pyx_codeobj__13);
   Py_VISIT(traverse_module_state->__pyx_codeobj__14);
   Py_VISIT(traverse_module_state->__pyx_codeobj__15);
   Py_VISIT(traverse_module_state->__pyx_codeobj__16);
   Py_VISIT(traverse_module_state->__pyx_codeobj__17);
   Py_VISIT(traverse_module_state->__pyx_codeobj__18);
   Py_VISIT(traverse_module_state->__pyx_codeobj__19);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__25);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__26);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__28);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__42);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__49);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__53);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__58);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__20);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__21);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__27);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__34);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__36);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__50);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__57);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__61);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__66);
   return 0;
 }
 #endif
 /* #### Code section: module_state_defines ### */
 #define __pyx_d __pyx_mstate_global->__pyx_d
 #define __pyx_b __pyx_mstate_global->__pyx_b
 #define __pyx_cython_runtime __pyx_mstate_global->__pyx_cython_runtime
@@ -5140,15 +5202,15 @@
 #define __pyx_kp_s_Unable_to_convert_item_to_object __pyx_mstate_global->__pyx_kp_s_Unable_to_convert_item_to_object
 #define __pyx_n_s_ValueError __pyx_mstate_global->__pyx_n_s_ValueError
 #define __pyx_n_s_View_MemoryView __pyx_mstate_global->__pyx_n_s_View_MemoryView
 #define __pyx_kp_u__2 __pyx_mstate_global->__pyx_kp_u__2
 #define __pyx_n_s__3 __pyx_mstate_global->__pyx_n_s__3
 #define __pyx_kp_u__6 __pyx_mstate_global->__pyx_kp_u__6
 #define __pyx_kp_u__7 __pyx_mstate_global->__pyx_kp_u__7
-#define __pyx_n_s__70 __pyx_mstate_global->__pyx_n_s__70
+#define __pyx_n_s__78 __pyx_mstate_global->__pyx_n_s__78
 #define __pyx_n_s_abc __pyx_mstate_global->__pyx_n_s_abc
 #define __pyx_n_s_abs __pyx_mstate_global->__pyx_n_s_abs
 #define __pyx_n_s_adiabatic_param __pyx_mstate_global->__pyx_n_s_adiabatic_param
 #define __pyx_n_s_allocate_buffer __pyx_mstate_global->__pyx_n_s_allocate_buffer
 #define __pyx_kp_u_and __pyx_mstate_global->__pyx_kp_u_and
 #define __pyx_n_s_antiderivative __pyx_mstate_global->__pyx_n_s_antiderivative
 #define __pyx_n_s_args __pyx_mstate_global->__pyx_n_s_args
@@ -5354,84 +5416,98 @@
 #define __pyx_float_neg_14_ __pyx_mstate_global->__pyx_float_neg_14_
 #define __pyx_int_0 __pyx_mstate_global->__pyx_int_0
 #define __pyx_int_1 __pyx_mstate_global->__pyx_int_1
 #define __pyx_int_2 __pyx_mstate_global->__pyx_int_2
 #define __pyx_int_3 __pyx_mstate_global->__pyx_int_3
 #define __pyx_int_4 __pyx_mstate_global->__pyx_int_4
 #define __pyx_int_5 __pyx_mstate_global->__pyx_int_5
+#define __pyx_int_6 __pyx_mstate_global->__pyx_int_6
 #define __pyx_int_7 __pyx_mstate_global->__pyx_int_7
 #define __pyx_int_8 __pyx_mstate_global->__pyx_int_8
+#define __pyx_int_9 __pyx_mstate_global->__pyx_int_9
 #define __pyx_int_112105877 __pyx_mstate_global->__pyx_int_112105877
 #define __pyx_int_136983863 __pyx_mstate_global->__pyx_int_136983863
 #define __pyx_int_184977713 __pyx_mstate_global->__pyx_int_184977713
 #define __pyx_int_neg_1 __pyx_mstate_global->__pyx_int_neg_1
+#define __pyx_int_neg_4 __pyx_mstate_global->__pyx_int_neg_4
+#define __pyx_int_neg_6 __pyx_mstate_global->__pyx_int_neg_6
+#define __pyx_int_neg_8 __pyx_mstate_global->__pyx_int_neg_8
+#define __pyx_int_neg_9 __pyx_mstate_global->__pyx_int_neg_9
 #define __pyx_slice__5 __pyx_mstate_global->__pyx_slice__5
 #define __pyx_tuple__4 __pyx_mstate_global->__pyx_tuple__4
 #define __pyx_tuple__8 __pyx_mstate_global->__pyx_tuple__8
-#define __pyx_slice__20 __pyx_mstate_global->__pyx_slice__20
-#define __pyx_slice__24 __pyx_mstate_global->__pyx_slice__24
-#define __pyx_slice__27 __pyx_mstate_global->__pyx_slice__27
+#define __pyx_slice__10 __pyx_mstate_global->__pyx_slice__10
+#define __pyx_slice__11 __pyx_mstate_global->__pyx_slice__11
+#define __pyx_slice__22 __pyx_mstate_global->__pyx_slice__22
+#define __pyx_slice__26 __pyx_mstate_global->__pyx_slice__26
+#define __pyx_slice__28 __pyx_mstate_global->__pyx_slice__28
 #define __pyx_slice__29 __pyx_mstate_global->__pyx_slice__29
 #define __pyx_slice__30 __pyx_mstate_global->__pyx_slice__30
-#define __pyx_tuple__21 __pyx_mstate_global->__pyx_tuple__21
-#define __pyx_tuple__22 __pyx_mstate_global->__pyx_tuple__22
+#define __pyx_slice__31 __pyx_mstate_global->__pyx_slice__31
+#define __pyx_slice__32 __pyx_mstate_global->__pyx_slice__32
+#define __pyx_slice__33 __pyx_mstate_global->__pyx_slice__33
+#define __pyx_slice__35 __pyx_mstate_global->__pyx_slice__35
+#define __pyx_slice__37 __pyx_mstate_global->__pyx_slice__37
+#define __pyx_slice__38 __pyx_mstate_global->__pyx_slice__38
 #define __pyx_tuple__23 __pyx_mstate_global->__pyx_tuple__23
-#define __pyx_tuple__31 __pyx_mstate_global->__pyx_tuple__31
-#define __pyx_tuple__32 __pyx_mstate_global->__pyx_tuple__32
-#define __pyx_tuple__33 __pyx_mstate_global->__pyx_tuple__33
-#define __pyx_tuple__34 __pyx_mstate_global->__pyx_tuple__34
-#define __pyx_tuple__35 __pyx_mstate_global->__pyx_tuple__35
-#define __pyx_tuple__36 __pyx_mstate_global->__pyx_tuple__36
-#define __pyx_tuple__37 __pyx_mstate_global->__pyx_tuple__37
-#define __pyx_tuple__38 __pyx_mstate_global->__pyx_tuple__38
+#define __pyx_tuple__24 __pyx_mstate_global->__pyx_tuple__24
+#define __pyx_tuple__25 __pyx_mstate_global->__pyx_tuple__25
 #define __pyx_tuple__39 __pyx_mstate_global->__pyx_tuple__39
 #define __pyx_tuple__40 __pyx_mstate_global->__pyx_tuple__40
 #define __pyx_tuple__41 __pyx_mstate_global->__pyx_tuple__41
+#define __pyx_tuple__42 __pyx_mstate_global->__pyx_tuple__42
 #define __pyx_tuple__43 __pyx_mstate_global->__pyx_tuple__43
 #define __pyx_tuple__44 __pyx_mstate_global->__pyx_tuple__44
 #define __pyx_tuple__45 __pyx_mstate_global->__pyx_tuple__45
 #define __pyx_tuple__46 __pyx_mstate_global->__pyx_tuple__46
 #define __pyx_tuple__47 __pyx_mstate_global->__pyx_tuple__47
 #define __pyx_tuple__48 __pyx_mstate_global->__pyx_tuple__48
-#define __pyx_tuple__50 __pyx_mstate_global->__pyx_tuple__50
+#define __pyx_tuple__49 __pyx_mstate_global->__pyx_tuple__49
 #define __pyx_tuple__51 __pyx_mstate_global->__pyx_tuple__51
 #define __pyx_tuple__52 __pyx_mstate_global->__pyx_tuple__52
+#define __pyx_tuple__53 __pyx_mstate_global->__pyx_tuple__53
 #define __pyx_tuple__54 __pyx_mstate_global->__pyx_tuple__54
 #define __pyx_tuple__55 __pyx_mstate_global->__pyx_tuple__55
 #define __pyx_tuple__56 __pyx_mstate_global->__pyx_tuple__56
-#define __pyx_tuple__57 __pyx_mstate_global->__pyx_tuple__57
+#define __pyx_tuple__58 __pyx_mstate_global->__pyx_tuple__58
 #define __pyx_tuple__59 __pyx_mstate_global->__pyx_tuple__59
 #define __pyx_tuple__60 __pyx_mstate_global->__pyx_tuple__60
-#define __pyx_tuple__61 __pyx_mstate_global->__pyx_tuple__61
 #define __pyx_tuple__62 __pyx_mstate_global->__pyx_tuple__62
 #define __pyx_tuple__63 __pyx_mstate_global->__pyx_tuple__63
 #define __pyx_tuple__64 __pyx_mstate_global->__pyx_tuple__64
 #define __pyx_tuple__65 __pyx_mstate_global->__pyx_tuple__65
-#define __pyx_tuple__66 __pyx_mstate_global->__pyx_tuple__66
 #define __pyx_tuple__67 __pyx_mstate_global->__pyx_tuple__67
 #define __pyx_tuple__68 __pyx_mstate_global->__pyx_tuple__68
 #define __pyx_tuple__69 __pyx_mstate_global->__pyx_tuple__69
+#define __pyx_tuple__70 __pyx_mstate_global->__pyx_tuple__70
+#define __pyx_tuple__71 __pyx_mstate_global->__pyx_tuple__71
+#define __pyx_tuple__72 __pyx_mstate_global->__pyx_tuple__72
+#define __pyx_tuple__73 __pyx_mstate_global->__pyx_tuple__73
+#define __pyx_tuple__74 __pyx_mstate_global->__pyx_tuple__74
+#define __pyx_tuple__75 __pyx_mstate_global->__pyx_tuple__75
+#define __pyx_tuple__76 __pyx_mstate_global->__pyx_tuple__76
+#define __pyx_tuple__77 __pyx_mstate_global->__pyx_tuple__77
 #define __pyx_codeobj__9 __pyx_mstate_global->__pyx_codeobj__9
-#define __pyx_codeobj__10 __pyx_mstate_global->__pyx_codeobj__10
-#define __pyx_codeobj__11 __pyx_mstate_global->__pyx_codeobj__11
 #define __pyx_codeobj__12 __pyx_mstate_global->__pyx_codeobj__12
 #define __pyx_codeobj__13 __pyx_mstate_global->__pyx_codeobj__13
 #define __pyx_codeobj__14 __pyx_mstate_global->__pyx_codeobj__14
 #define __pyx_codeobj__15 __pyx_mstate_global->__pyx_codeobj__15
 #define __pyx_codeobj__16 __pyx_mstate_global->__pyx_codeobj__16
 #define __pyx_codeobj__17 __pyx_mstate_global->__pyx_codeobj__17
 #define __pyx_codeobj__18 __pyx_mstate_global->__pyx_codeobj__18
 #define __pyx_codeobj__19 __pyx_mstate_global->__pyx_codeobj__19
-#define __pyx_codeobj__25 __pyx_mstate_global->__pyx_codeobj__25
-#define __pyx_codeobj__26 __pyx_mstate_global->__pyx_codeobj__26
-#define __pyx_codeobj__28 __pyx_mstate_global->__pyx_codeobj__28
-#define __pyx_codeobj__42 __pyx_mstate_global->__pyx_codeobj__42
-#define __pyx_codeobj__49 __pyx_mstate_global->__pyx_codeobj__49
-#define __pyx_codeobj__53 __pyx_mstate_global->__pyx_codeobj__53
-#define __pyx_codeobj__58 __pyx_mstate_global->__pyx_codeobj__58
+#define __pyx_codeobj__20 __pyx_mstate_global->__pyx_codeobj__20
+#define __pyx_codeobj__21 __pyx_mstate_global->__pyx_codeobj__21
+#define __pyx_codeobj__27 __pyx_mstate_global->__pyx_codeobj__27
+#define __pyx_codeobj__34 __pyx_mstate_global->__pyx_codeobj__34
+#define __pyx_codeobj__36 __pyx_mstate_global->__pyx_codeobj__36
+#define __pyx_codeobj__50 __pyx_mstate_global->__pyx_codeobj__50
+#define __pyx_codeobj__57 __pyx_mstate_global->__pyx_codeobj__57
+#define __pyx_codeobj__61 __pyx_mstate_global->__pyx_codeobj__61
+#define __pyx_codeobj__66 __pyx_mstate_global->__pyx_codeobj__66
 /* #### Code section: module_code ### */
 
 /* "carray.from_py":79
  * 
  * @cname("__Pyx_carray_from_py_double")
  * cdef int __Pyx_carray_from_py_double(object o, base_type *v, Py_ssize_t length) except -1:             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t i = length
@@ -19490,47 +19566,44 @@
   return __pyx_r;
 }
 
 /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":81
  * @cython.linetrace(True)
  * @cython.cdivision(True)
  * cpdef fin_diff_derivative(             # <<<<<<<<<<<<<<
- *     double[:] x,
- *     double[:] y,
+ *     x: np.array,
+ *     y: np.array,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8dynamics_15postadiabatic_C_1fin_diff_derivative(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(__Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative *__pyx_optional_args) {
+static PyObject *__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(PyObject *__pyx_v_x, PyObject *__pyx_v_y, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative *__pyx_optional_args) {
   PyObject *__pyx_v_dy_dx = NULL;
   double __pyx_v_h;
   int __pyx_v_size;
   int __pyx_v_i;
   PyObject *__pyx_r = NULL;
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
-  Py_ssize_t __pyx_t_6;
-  Py_ssize_t __pyx_t_7;
+  double __pyx_t_6;
+  int __pyx_t_7;
   int __pyx_t_8;
   int __pyx_t_9;
-  int __pyx_t_10;
+  __Pyx_memviewslice __pyx_t_10 = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_t_11 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  int __pyx_t_12;
-  __Pyx_memviewslice __pyx_t_13 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  double __pyx_t_14;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__9)
   __Pyx_RefNannySetupContext("fin_diff_derivative", 1);
   __Pyx_TraceCall("fin_diff_derivative", __pyx_f[0], 81, 0, __PYX_ERR(0, 81, __pyx_L1_error));
   if (__pyx_optional_args) {
@@ -19545,38 +19618,35 @@
  */
   __Pyx_TraceLine(92,0,__PYX_ERR(0, 92, __pyx_L1_error))
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 92, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = NULL;
+  __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
-    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
-    if (likely(__pyx_t_2)) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
+    if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-      __Pyx_INCREF(__pyx_t_2);
+      __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_5 = 1;
     }
   }
   #endif
   {
-    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_4};
+    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
-    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 92, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_v_dy_dx = __pyx_t_1;
   __pyx_t_1 = 0;
 
@@ -19584,115 +19654,95 @@
  * 
  *     dy_dx = np.zeros(x.size)
  *     cdef double h = fabs(x[1] - x[0])             # <<<<<<<<<<<<<<
  *     cdef int size = x.shape[0]
  *     cdef int i
  */
   __Pyx_TraceLine(93,0,__PYX_ERR(0, 93, __pyx_L1_error))
-  __pyx_t_6 = 1;
-  __pyx_t_5 = -1;
-  if (__pyx_t_6 < 0) {
-    __pyx_t_6 += __pyx_v_x.shape[0];
-    if (unlikely(__pyx_t_6 < 0)) __pyx_t_5 = 0;
-  } else if (unlikely(__pyx_t_6 >= __pyx_v_x.shape[0])) __pyx_t_5 = 0;
-  if (unlikely(__pyx_t_5 != -1)) {
-    __Pyx_RaiseBufferIndexError(__pyx_t_5);
-    __PYX_ERR(0, 93, __pyx_L1_error)
-  }
-  __pyx_t_7 = 0;
-  __pyx_t_5 = -1;
-  if (__pyx_t_7 < 0) {
-    __pyx_t_7 += __pyx_v_x.shape[0];
-    if (unlikely(__pyx_t_7 < 0)) __pyx_t_5 = 0;
-  } else if (unlikely(__pyx_t_7 >= __pyx_v_x.shape[0])) __pyx_t_5 = 0;
-  if (unlikely(__pyx_t_5 != -1)) {
-    __Pyx_RaiseBufferIndexError(__pyx_t_5);
-    __PYX_ERR(0, 93, __pyx_L1_error)
-  }
-  __pyx_v_h = fabs(((*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_6 * __pyx_v_x.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_7 * __pyx_v_x.strides[0]) )))));
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 93, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 93, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = PyNumber_Subtract(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 93, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_6 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 93, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_h = fabs(__pyx_t_6);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":94
  *     dy_dx = np.zeros(x.size)
  *     cdef double h = fabs(x[1] - x[0])
  *     cdef int size = x.shape[0]             # <<<<<<<<<<<<<<
  *     cdef int i
  *     for i in range(size):
  */
   __Pyx_TraceLine(94,0,__PYX_ERR(0, 94, __pyx_L1_error))
-  __pyx_v_size = (__pyx_v_x.shape[0]);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 94, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 94, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_5 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 94, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_size = __pyx_t_5;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":96
  *     cdef int size = x.shape[0]
  *     cdef int i
  *     for i in range(size):             # <<<<<<<<<<<<<<
  *         if i == 0:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[0])
  */
   __Pyx_TraceLine(96,0,__PYX_ERR(0, 96, __pyx_L1_error))
   __pyx_t_5 = __pyx_v_size;
-  __pyx_t_8 = __pyx_t_5;
-  for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
-    __pyx_v_i = __pyx_t_9;
+  __pyx_t_7 = __pyx_t_5;
+  for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
+    __pyx_v_i = __pyx_t_8;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":97
  *     cdef int i
  *     for i in range(size):
  *         if i == 0:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[0])
  *         elif i == 1:
  */
     __Pyx_TraceLine(97,0,__PYX_ERR(0, 97, __pyx_L1_error))
-    __pyx_t_10 = (__pyx_v_i == 0);
-    if (__pyx_t_10) {
+    __pyx_t_9 = (__pyx_v_i == 0);
+    if (__pyx_t_9) {
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":98
  *     for i in range(size):
  *         if i == 0:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[0])             # <<<<<<<<<<<<<<
  *         elif i == 1:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[1])
  */
       __Pyx_TraceLine(98,0,__PYX_ERR(0, 98, __pyx_L1_error))
-      __pyx_t_11.data = __pyx_v_y.data;
-      __pyx_t_11.memview = __pyx_v_y.memview;
-      __PYX_INC_MEMVIEW(&__pyx_t_11, 1);
-      __pyx_t_12 = -1;
-      if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_11,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_12,
-    0,
-    9,
-    0,
-    1,
-    1,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 98, __pyx_L1_error)
-}
-
-__Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 98, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 98, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_y, 0, 9, NULL, NULL, &__pyx_slice__10, 1, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 98, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 98, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 98, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_14 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_11, __pyx_v_h, __pyx_t_13); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 98, __pyx_L1_error)
-      __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
-      __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
-      __PYX_XCLEAR_MEMVIEW(&__pyx_t_13, 1);
-      __pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;
-      __pyx_t_3 = PyFloat_FromDouble(__pyx_t_14); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 98, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 98, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_3, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 98, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 98, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 98, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_6 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_10, __pyx_v_h, __pyx_t_11); if (unlikely(__pyx_t_6 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 98, __pyx_L1_error)
+      __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
+      __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
+      __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
+      __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
+      __pyx_t_2 = PyFloat_FromDouble(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 98, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_2, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 98, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":97
  *     cdef int i
  *     for i in range(size):
  *         if i == 0:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[0])
  *         elif i == 1:
@@ -19704,62 +19754,45 @@
  *         if i == 0:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[0])
  *         elif i == 1:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[1])
  *         elif i == 2:
  */
     __Pyx_TraceLine(99,0,__PYX_ERR(0, 99, __pyx_L1_error))
-    __pyx_t_10 = (__pyx_v_i == 1);
-    if (__pyx_t_10) {
+    __pyx_t_9 = (__pyx_v_i == 1);
+    if (__pyx_t_9) {
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":100
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[0])
  *         elif i == 1:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[1])             # <<<<<<<<<<<<<<
  *         elif i == 2:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[2])
  */
       __Pyx_TraceLine(100,0,__PYX_ERR(0, 100, __pyx_L1_error))
-      __pyx_t_13.data = __pyx_v_y.data;
-      __pyx_t_13.memview = __pyx_v_y.memview;
-      __PYX_INC_MEMVIEW(&__pyx_t_13, 1);
-      __pyx_t_12 = -1;
-      if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_13,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_12,
-    0,
-    9,
-    0,
-    1,
-    1,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 100, __pyx_L1_error)
-}
-
-__Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 100, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_y, 0, 9, NULL, NULL, &__pyx_slice__10, 1, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 100, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 100, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 100, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 100, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 100, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 100, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 100, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_14 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_13, __pyx_v_h, __pyx_t_11); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 100, __pyx_L1_error)
-      __PYX_XCLEAR_MEMVIEW(&__pyx_t_13, 1);
-      __pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;
+      __pyx_t_6 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_11, __pyx_v_h, __pyx_t_10); if (unlikely(__pyx_t_6 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 100, __pyx_L1_error)
       __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
       __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 100, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_1, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 100, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
+      __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
+      __pyx_t_3 = PyFloat_FromDouble(__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 100, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_3, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 100, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":99
  *         if i == 0:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[0])
  *         elif i == 1:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[1])
  *         elif i == 2:
@@ -19771,62 +19804,45 @@
  *         elif i == 1:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[1])
  *         elif i == 2:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[2])
  *         elif i == 3:
  */
     __Pyx_TraceLine(101,0,__PYX_ERR(0, 101, __pyx_L1_error))
-    __pyx_t_10 = (__pyx_v_i == 2);
-    if (__pyx_t_10) {
+    __pyx_t_9 = (__pyx_v_i == 2);
+    if (__pyx_t_9) {
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":102
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[1])
  *         elif i == 2:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[2])             # <<<<<<<<<<<<<<
  *         elif i == 3:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[3])
  */
       __Pyx_TraceLine(102,0,__PYX_ERR(0, 102, __pyx_L1_error))
-      __pyx_t_11.data = __pyx_v_y.data;
-      __pyx_t_11.memview = __pyx_v_y.memview;
-      __PYX_INC_MEMVIEW(&__pyx_t_11, 1);
-      __pyx_t_12 = -1;
-      if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_11,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_12,
-    0,
-    9,
-    0,
-    1,
-    1,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 102, __pyx_L1_error)
-}
-
-__Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 102, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 102, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_y, 0, 9, NULL, NULL, &__pyx_slice__10, 1, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 102, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 102, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 102, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_14 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_11, __pyx_v_h, __pyx_t_13); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 102, __pyx_L1_error)
-      __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
-      __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
-      __PYX_XCLEAR_MEMVIEW(&__pyx_t_13, 1);
-      __pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;
-      __pyx_t_3 = PyFloat_FromDouble(__pyx_t_14); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 102, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 102, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_3, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 102, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 102, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 102, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_6 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_10, __pyx_v_h, __pyx_t_11); if (unlikely(__pyx_t_6 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 102, __pyx_L1_error)
+      __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
+      __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
+      __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
+      __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
+      __pyx_t_2 = PyFloat_FromDouble(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 102, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_2, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 102, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":101
  *         elif i == 1:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[1])
  *         elif i == 2:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[2])
  *         elif i == 3:
@@ -19838,62 +19854,45 @@
  *         elif i == 2:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[2])
  *         elif i == 3:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[3])
  *         elif i == size - 4:
  */
     __Pyx_TraceLine(103,0,__PYX_ERR(0, 103, __pyx_L1_error))
-    __pyx_t_10 = (__pyx_v_i == 3);
-    if (__pyx_t_10) {
+    __pyx_t_9 = (__pyx_v_i == 3);
+    if (__pyx_t_9) {
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":104
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[2])
  *         elif i == 3:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[3])             # <<<<<<<<<<<<<<
  *         elif i == size - 4:
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[5])
  */
       __Pyx_TraceLine(104,0,__PYX_ERR(0, 104, __pyx_L1_error))
-      __pyx_t_13.data = __pyx_v_y.data;
-      __pyx_t_13.memview = __pyx_v_y.memview;
-      __PYX_INC_MEMVIEW(&__pyx_t_13, 1);
-      __pyx_t_12 = -1;
-      if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_13,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_12,
-    0,
-    9,
-    0,
-    1,
-    1,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 104, __pyx_L1_error)
-}
-
-__Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 104, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_y, 0, 9, NULL, NULL, &__pyx_slice__10, 1, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 104, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 104, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 104, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 104, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 104, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 104, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 104, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_14 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_13, __pyx_v_h, __pyx_t_11); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 104, __pyx_L1_error)
-      __PYX_XCLEAR_MEMVIEW(&__pyx_t_13, 1);
-      __pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;
+      __pyx_t_6 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_11, __pyx_v_h, __pyx_t_10); if (unlikely(__pyx_t_6 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 104, __pyx_L1_error)
       __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
       __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 104, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_1, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 104, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
+      __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
+      __pyx_t_3 = PyFloat_FromDouble(__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 104, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_3, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 104, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":103
  *         elif i == 2:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[2])
  *         elif i == 3:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[3])
  *         elif i == size - 4:
@@ -19905,62 +19904,45 @@
  *         elif i == 3:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[3])
  *         elif i == size - 4:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[5])
  *         elif i == size - 3:
  */
     __Pyx_TraceLine(105,0,__PYX_ERR(0, 105, __pyx_L1_error))
-    __pyx_t_10 = (__pyx_v_i == (__pyx_v_size - 4));
-    if (__pyx_t_10) {
+    __pyx_t_9 = (__pyx_v_i == (__pyx_v_size - 4));
+    if (__pyx_t_9) {
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":106
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[3])
  *         elif i == size - 4:
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[5])             # <<<<<<<<<<<<<<
  *         elif i == size - 3:
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[6])
  */
       __Pyx_TraceLine(106,0,__PYX_ERR(0, 106, __pyx_L1_error))
-      __pyx_t_11.data = __pyx_v_y.data;
-      __pyx_t_11.memview = __pyx_v_y.memview;
-      __PYX_INC_MEMVIEW(&__pyx_t_11, 1);
-      __pyx_t_12 = -1;
-      if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_11,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_12,
-    -9L,
-    0,
-    0,
-    1,
-    0,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 106, __pyx_L1_error)
-}
-
-__Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 106, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_y, -9L, 0, NULL, NULL, &__pyx_slice__11, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 106, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 106, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 106, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_14 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_11, __pyx_v_h, __pyx_t_13); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 106, __pyx_L1_error)
-      __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
-      __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
-      __PYX_XCLEAR_MEMVIEW(&__pyx_t_13, 1);
-      __pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;
-      __pyx_t_3 = PyFloat_FromDouble(__pyx_t_14); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 106, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 106, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_3, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 106, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 106, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 106, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_6 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_10, __pyx_v_h, __pyx_t_11); if (unlikely(__pyx_t_6 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 106, __pyx_L1_error)
+      __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
+      __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
+      __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
+      __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
+      __pyx_t_2 = PyFloat_FromDouble(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 106, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_2, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 106, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":105
  *         elif i == 3:
  *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[3])
  *         elif i == size - 4:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[5])
  *         elif i == size - 3:
@@ -19972,62 +19954,45 @@
  *         elif i == size - 4:
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[5])
  *         elif i == size - 3:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[6])
  *         elif i == size - 2:
  */
     __Pyx_TraceLine(107,0,__PYX_ERR(0, 107, __pyx_L1_error))
-    __pyx_t_10 = (__pyx_v_i == (__pyx_v_size - 3));
-    if (__pyx_t_10) {
+    __pyx_t_9 = (__pyx_v_i == (__pyx_v_size - 3));
+    if (__pyx_t_9) {
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":108
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[5])
  *         elif i == size - 3:
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[6])             # <<<<<<<<<<<<<<
  *         elif i == size - 2:
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[7])
  */
       __Pyx_TraceLine(108,0,__PYX_ERR(0, 108, __pyx_L1_error))
-      __pyx_t_13.data = __pyx_v_y.data;
-      __pyx_t_13.memview = __pyx_v_y.memview;
-      __PYX_INC_MEMVIEW(&__pyx_t_13, 1);
-      __pyx_t_12 = -1;
-      if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_13,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_12,
-    -9L,
-    0,
-    0,
-    1,
-    0,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 108, __pyx_L1_error)
-}
-
-__Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_y, -9L, 0, NULL, NULL, &__pyx_slice__11, 1, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 108, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, 6, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, 6, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 108, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 108, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 108, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_14 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_13, __pyx_v_h, __pyx_t_11); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 108, __pyx_L1_error)
-      __PYX_XCLEAR_MEMVIEW(&__pyx_t_13, 1);
-      __pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;
+      __pyx_t_6 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_11, __pyx_v_h, __pyx_t_10); if (unlikely(__pyx_t_6 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 108, __pyx_L1_error)
       __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
       __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 108, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_1, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 108, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
+      __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
+      __pyx_t_3 = PyFloat_FromDouble(__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_3, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 108, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":107
  *         elif i == size - 4:
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[5])
  *         elif i == size - 3:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[6])
  *         elif i == size - 2:
@@ -20039,62 +20004,45 @@
  *         elif i == size - 3:
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[6])
  *         elif i == size - 2:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[7])
  *         elif i == size - 1:
  */
     __Pyx_TraceLine(109,0,__PYX_ERR(0, 109, __pyx_L1_error))
-    __pyx_t_10 = (__pyx_v_i == (__pyx_v_size - 2));
-    if (__pyx_t_10) {
+    __pyx_t_9 = (__pyx_v_i == (__pyx_v_size - 2));
+    if (__pyx_t_9) {
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":110
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[6])
  *         elif i == size - 2:
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[7])             # <<<<<<<<<<<<<<
  *         elif i == size - 1:
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[8])
  */
       __Pyx_TraceLine(110,0,__PYX_ERR(0, 110, __pyx_L1_error))
-      __pyx_t_11.data = __pyx_v_y.data;
-      __pyx_t_11.memview = __pyx_v_y.memview;
-      __PYX_INC_MEMVIEW(&__pyx_t_11, 1);
-      __pyx_t_12 = -1;
-      if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_11,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_12,
-    -9L,
-    0,
-    0,
-    1,
-    0,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 110, __pyx_L1_error)
-}
-
-__Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 7, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_y, -9L, 0, NULL, NULL, &__pyx_slice__11, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 110, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 110, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_14 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_11, __pyx_v_h, __pyx_t_13); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 110, __pyx_L1_error)
-      __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
-      __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
-      __PYX_XCLEAR_MEMVIEW(&__pyx_t_13, 1);
-      __pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;
-      __pyx_t_3 = PyFloat_FromDouble(__pyx_t_14); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_3, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 110, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, 7, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 110, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 110, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_6 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_10, __pyx_v_h, __pyx_t_11); if (unlikely(__pyx_t_6 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 110, __pyx_L1_error)
+      __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
+      __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
+      __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
+      __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
+      __pyx_t_2 = PyFloat_FromDouble(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 110, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_2, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 110, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":109
  *         elif i == size - 3:
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[6])
  *         elif i == size - 2:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[7])
  *         elif i == size - 1:
@@ -20106,62 +20054,45 @@
  *         elif i == size - 2:
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[7])
  *         elif i == size - 1:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[8])
  *         else:
  */
     __Pyx_TraceLine(111,0,__PYX_ERR(0, 111, __pyx_L1_error))
-    __pyx_t_10 = (__pyx_v_i == (__pyx_v_size - 1));
-    if (__pyx_t_10) {
+    __pyx_t_9 = (__pyx_v_i == (__pyx_v_size - 1));
+    if (__pyx_t_9) {
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":112
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[7])
  *         elif i == size - 1:
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[8])             # <<<<<<<<<<<<<<
  *         else:
  *             dy_dx[i] = single_deriv(y[i-4:i+5],h,fin_diff_coeffs_order_9[4])
  */
       __Pyx_TraceLine(112,0,__PYX_ERR(0, 112, __pyx_L1_error))
-      __pyx_t_13.data = __pyx_v_y.data;
-      __pyx_t_13.memview = __pyx_v_y.memview;
-      __PYX_INC_MEMVIEW(&__pyx_t_13, 1);
-      __pyx_t_12 = -1;
-      if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_13,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_12,
-    -9L,
-    0,
-    0,
-    1,
-    0,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 112, __pyx_L1_error)
-}
-
-__Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 112, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_y, -9L, 0, NULL, NULL, &__pyx_slice__11, 1, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 112, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 112, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 112, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, 8, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 112, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, 8, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 112, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 112, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 112, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_14 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_13, __pyx_v_h, __pyx_t_11); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 112, __pyx_L1_error)
-      __PYX_XCLEAR_MEMVIEW(&__pyx_t_13, 1);
-      __pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;
+      __pyx_t_6 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_11, __pyx_v_h, __pyx_t_10); if (unlikely(__pyx_t_6 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 112, __pyx_L1_error)
       __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
       __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 112, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_1, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 112, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
+      __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
+      __pyx_t_3 = PyFloat_FromDouble(__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 112, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_3, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 112, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":111
  *         elif i == size - 2:
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[7])
  *         elif i == size - 1:             # <<<<<<<<<<<<<<
  *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[8])
  *         else:
@@ -20174,51 +20105,34 @@
  *         else:
  *             dy_dx[i] = single_deriv(y[i-4:i+5],h,fin_diff_coeffs_order_9[4])             # <<<<<<<<<<<<<<
  * 
  *     return dy_dx
  */
     __Pyx_TraceLine(114,0,__PYX_ERR(0, 114, __pyx_L1_error))
     /*else*/ {
-      __pyx_t_11.data = __pyx_v_y.data;
-      __pyx_t_11.memview = __pyx_v_y.memview;
-      __PYX_INC_MEMVIEW(&__pyx_t_11, 1);
-      __pyx_t_12 = -1;
-      if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_11,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_12,
-    (__pyx_v_i - 4),
-    (__pyx_v_i + 5),
-    0,
-    1,
-    1,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 114, __pyx_L1_error)
-}
-
-__Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 114, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 114, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_y, (__pyx_v_i - 4), (__pyx_v_i + 5), NULL, NULL, NULL, 1, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 114, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 114, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 114, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_14 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_11, __pyx_v_h, __pyx_t_13); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 114, __pyx_L1_error)
-      __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
-      __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
-      __PYX_XCLEAR_MEMVIEW(&__pyx_t_13, 1);
-      __pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;
-      __pyx_t_3 = PyFloat_FromDouble(__pyx_t_14); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 114, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_fin_diff_coeffs_order_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 114, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_3, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 114, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 114, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 114, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_6 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_single_deriv(__pyx_t_10, __pyx_v_h, __pyx_t_11); if (unlikely(__pyx_t_6 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 114, __pyx_L1_error)
+      __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
+      __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
+      __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
+      __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
+      __pyx_t_2 = PyFloat_FromDouble(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 114, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      if (unlikely((__Pyx_SetItemInt(__pyx_v_dy_dx, __pyx_v_i, __pyx_t_2, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0))) __PYX_ERR(0, 114, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __pyx_L5:;
   }
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":116
  *             dy_dx[i] = single_deriv(y[i-4:i+5],h,fin_diff_coeffs_order_9[4])
  * 
@@ -20232,26 +20146,26 @@
   __pyx_r = __pyx_v_dy_dx;
   goto __pyx_L0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":81
  * @cython.linetrace(True)
  * @cython.cdivision(True)
  * cpdef fin_diff_derivative(             # <<<<<<<<<<<<<<
- *     double[:] x,
- *     double[:] y,
+ *     x: np.array,
+ *     y: np.array,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_13, 1);
   __Pyx_AddTraceback("pyseobnr.eob.dynamics.postadiabatic_C.fin_diff_derivative", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_dy_dx);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
@@ -20271,16 +20185,16 @@
 static PyObject *__pyx_pw_8pyseobnr_3eob_8dynamics_15postadiabatic_C_1fin_diff_derivative(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ) {
-  __Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_y = { 0, 0, { 0 }, { 0 }, { 0 } };
+  PyObject *__pyx_v_x = 0;
+  PyObject *__pyx_v_y = 0;
   int __pyx_v_n;
   #if !CYTHON_METH_FASTCALL
   CYTHON_UNUSED Py_ssize_t __pyx_nargs;
   #endif
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
   PyObject* values[3] = {0,0,0};
   int __pyx_lineno = 0;
@@ -20348,16 +20262,16 @@
         CYTHON_FALLTHROUGH;
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_x = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_x.memview)) __PYX_ERR(0, 82, __pyx_L3_error)
-    __pyx_v_y = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_y.memview)) __PYX_ERR(0, 83, __pyx_L3_error)
+    __pyx_v_x = values[0];
+    __pyx_v_y = values[1];
     if (values[2]) {
       __pyx_v_n = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_n == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 84, __pyx_L3_error)
     } else {
       __pyx_v_n = ((int)8);
     }
   }
   goto __pyx_L6_skip;
@@ -20368,50 +20282,44 @@
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_x, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_y, 1);
   __Pyx_AddTraceback("pyseobnr.eob.dynamics.postadiabatic_C.fin_diff_derivative", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(__pyx_self, __pyx_v_x, __pyx_v_y, __pyx_v_n);
 
   /* function exit code */
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_x, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_y, 1);
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, int __pyx_v_n) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, int __pyx_v_n) {
   PyObject *__pyx_r = NULL;
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__9)
   __Pyx_RefNannySetupContext("fin_diff_derivative", 1);
   __Pyx_TraceCall("fin_diff_derivative (wrapper)", __pyx_f[0], 81, 0, __PYX_ERR(0, 81, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_x.memview)) { __Pyx_RaiseUnboundLocalError("x"); __PYX_ERR(0, 81, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_y.memview)) { __Pyx_RaiseUnboundLocalError("y"); __PYX_ERR(0, 81, __pyx_L1_error) }
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.n = __pyx_v_n;
   __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(__pyx_v_x, __pyx_v_y, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 81, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
@@ -20460,15 +20368,15 @@
   PyObject *__pyx_t_6 = NULL;
   int __pyx_t_7;
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__10)
+  __Pyx_TraceFrameInit(__pyx_codeobj__12)
   __Pyx_RefNannySetupContext("Kerr_ISCO", 1);
   __Pyx_TraceCall("Kerr_ISCO", __pyx_f[0], 120, 0, __PYX_ERR(0, 120, __pyx_L1_error));
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":130
  *     from the remnant spin predicted by NR fits
  *     """
  *     a = nrutils.bbh_final_spin_non_precessing_HBR2016(             # <<<<<<<<<<<<<<
@@ -21053,15 +20961,15 @@
   PyObject *__pyx_r = NULL;
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__10)
+  __Pyx_TraceFrameInit(__pyx_codeobj__12)
   __Pyx_RefNannySetupContext("Kerr_ISCO", 1);
   __Pyx_TraceCall("Kerr_ISCO (wrapper)", __pyx_f[0], 120, 0, __PYX_ERR(0, 120, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_Kerr_ISCO(__pyx_v_chi1, __pyx_v_chi2, __pyx_v_m1, __pyx_v_m2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 120, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -21191,15 +21099,15 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__11)
+  __Pyx_TraceFrameInit(__pyx_codeobj__13)
   __Pyx_RefNannySetupContext("Newtonian_j0", 1);
   __Pyx_TraceCall("Newtonian_j0", __pyx_f[0], 142, 0, __PYX_ERR(0, 142, __pyx_L1_error));
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":149
  *     consistent normalization.
  *     """
  *     return np.sqrt(r)             # <<<<<<<<<<<<<<
@@ -21285,15 +21193,15 @@
   Py_ssize_t __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   __pyx_ctuple_double__and_double__and_double__and_double __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__12)
+  __Pyx_TraceFrameInit(__pyx_codeobj__14)
   __Pyx_RefNannySetupContext("j0_eqn", 1);
   __Pyx_TraceCall("j0_eqn", __pyx_f[0], 153, 0, __PYX_ERR(0, 153, __pyx_L1_error));
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":155
  * cpdef double j0_eqn(double j0_sol, double r, Hamiltonian_C H, double chi_1, double chi_2, double m_1, double m_2,
  *             double[:] q, double[:] p):
  *     q[0] = r             # <<<<<<<<<<<<<<
@@ -21617,15 +21525,15 @@
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   double __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__12)
+  __Pyx_TraceFrameInit(__pyx_codeobj__14)
   __Pyx_RefNannySetupContext("j0_eqn", 1);
   __Pyx_TraceCall("j0_eqn (wrapper)", __pyx_f[0], 153, 0, __PYX_ERR(0, 153, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
   if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(0, 153, __pyx_L1_error) }
   if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(0, 153, __pyx_L1_error) }
   __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_j0_eqn(__pyx_v_j0_sol, __pyx_v_r, __pyx_v_H, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_q, __pyx_v_p, 0); if (unlikely(__pyx_t_1 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 153, __pyx_L1_error)
   __pyx_t_2 = PyFloat_FromDouble(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 153, __pyx_L1_error)
@@ -22261,15 +22169,15 @@
   PyObject *__pyx_t_2 = NULL;
   double __pyx_t_3[6];
   double __pyx_t_4;
   __pyx_ctuple_double__and_double __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__13)
+  __Pyx_TraceFrameInit(__pyx_codeobj__15)
   __Pyx_RefNannySetupContext("pr_eqn", 1);
   __Pyx_TraceCall("pr_eqn", __pyx_f[0], 198, 0, __PYX_ERR(0, 198, __pyx_L1_error));
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":217
  *     See Eq. (2.6) of arXiv:2105.06983
  *     """
  *     q[0] = r             # <<<<<<<<<<<<<<
@@ -22722,15 +22630,15 @@
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   double __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__13)
+  __Pyx_TraceFrameInit(__pyx_codeobj__15)
   __Pyx_RefNannySetupContext("pr_eqn", 1);
   __Pyx_TraceCall("pr_eqn (wrapper)", __pyx_f[0], 198, 0, __PYX_ERR(0, 198, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_pr_eqn(__pyx_v_pr_sol, __pyx_v_r, __pyx_v_pphi, __pyx_v_dpphi_dr, __pyx_v_H, __pyx_v_RR, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_params, __pyx_v_q, __pyx_v_p, 0); if (unlikely(__pyx_t_1 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 198, __pyx_L1_error)
   __pyx_t_2 = PyFloat_FromDouble(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 198, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
@@ -23004,19 +22912,19 @@
   PyObject *__pyx_v_x_up = NULL;
   PyObject *__pyx_v_result = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
-  __Pyx_memviewslice __pyx_t_3 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  Py_ssize_t __pyx_t_4;
+  PyObject *__pyx_t_3 = NULL;
+  __Pyx_memviewslice __pyx_t_4 = { 0, 0, { 0 }, { 0 }, { 0 } };
   Py_ssize_t __pyx_t_5;
-  int __pyx_t_6;
-  PyObject *__pyx_t_7 = NULL;
+  Py_ssize_t __pyx_t_6;
+  int __pyx_t_7;
   Py_ssize_t __pyx_t_8;
   int __pyx_t_9;
   PyObject *__pyx_t_10 = NULL;
   int __pyx_t_11;
   PyObject *__pyx_t_12 = NULL;
   PyObject *__pyx_t_13 = NULL;
   PyObject *__pyx_t_14 = NULL;
@@ -23027,15 +22935,15 @@
   PyObject *__pyx_t_19 = NULL;
   PyObject *__pyx_t_20 = NULL;
   long __pyx_t_21;
   double __pyx_t_22;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__14)
+  __Pyx_TraceFrameInit(__pyx_codeobj__16)
   __Pyx_RefNannySetupContext("compute_pr", 1);
   __Pyx_TraceCall("compute_pr", __pyx_f[0], 248, 0, __PYX_ERR(0, 248, __pyx_L1_error));
   if (__pyx_optional_args) {
     if (__pyx_optional_args->__pyx_n > 0) {
       __pyx_v_tol = __pyx_optional_args->tol;
       if (__pyx_optional_args->__pyx_n > 1) {
         __pyx_v_params = __pyx_optional_args->params;
@@ -23047,90 +22955,96 @@
  *     """
  * 
  *     cdef double[:] dpphi_dr = - fin_diff_derivative(r, pphi)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_TraceLine(269,0,__PYX_ERR(0, 269, __pyx_L1_error))
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(__pyx_v_r, __pyx_v_pphi, 0, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 269, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_r, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 269, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 269, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_pphi, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 269, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(__pyx_t_1, __pyx_t_2, 0, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 269, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v_dpphi_dr = __pyx_t_3;
-  __pyx_t_3.memview = NULL;
-  __pyx_t_3.data = NULL;
+  __pyx_t_2 = PyNumber_Negative(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 269, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 269, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_dpphi_dr = __pyx_t_4;
+  __pyx_t_4.memview = NULL;
+  __pyx_t_4.data = NULL;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":273
  * 
  *     cdef int i
  *     for i in range(r.shape[0]):             # <<<<<<<<<<<<<<
  *         if np.abs(pr[i])<1e-14:
  *             x0 = 0.0
  */
   __Pyx_TraceLine(273,0,__PYX_ERR(0, 273, __pyx_L1_error))
-  __pyx_t_4 = (__pyx_v_r.shape[0]);
-  __pyx_t_5 = __pyx_t_4;
-  for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
-    __pyx_v_i = __pyx_t_6;
+  __pyx_t_5 = (__pyx_v_r.shape[0]);
+  __pyx_t_6 = __pyx_t_5;
+  for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
+    __pyx_v_i = __pyx_t_7;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":274
  *     cdef int i
  *     for i in range(r.shape[0]):
  *         if np.abs(pr[i])<1e-14:             # <<<<<<<<<<<<<<
  *             x0 = 0.0
  *             x1 = -3e-2
  */
     __Pyx_TraceLine(274,0,__PYX_ERR(0, 274, __pyx_L1_error))
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 274, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 274, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_abs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 274, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_abs); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 274, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_8 = __pyx_v_i;
     __pyx_t_9 = -1;
     if (__pyx_t_8 < 0) {
       __pyx_t_8 += __pyx_v_pr.shape[0];
       if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
     } else if (unlikely(__pyx_t_8 >= __pyx_v_pr.shape[0])) __pyx_t_9 = 0;
     if (unlikely(__pyx_t_9 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 274, __pyx_L1_error)
     }
-    __pyx_t_1 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_pr.data + __pyx_t_8 * __pyx_v_pr.strides[0]) )))); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 274, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_pr.data + __pyx_t_8 * __pyx_v_pr.strides[0]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 274, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_10 = NULL;
     __pyx_t_9 = 0;
     #if CYTHON_UNPACK_METHODS
-    if (unlikely(PyMethod_Check(__pyx_t_7))) {
-      __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_7);
+    if (unlikely(PyMethod_Check(__pyx_t_1))) {
+      __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_10)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_7, function);
+        __Pyx_DECREF_SET(__pyx_t_1, function);
         __pyx_t_9 = 1;
       }
     }
     #endif
     {
-      PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_1};
-      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
+      PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_3};
+      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 274, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
-    __pyx_t_7 = PyObject_RichCompare(__pyx_t_2, __pyx_float_1eneg_14, Py_LT); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 274, __pyx_L1_error)
+    __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, __pyx_float_1eneg_14, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 274, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely((__pyx_t_11 < 0))) __PYX_ERR(0, 274, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_11 < 0))) __PYX_ERR(0, 274, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (__pyx_t_11) {
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":275
  *     for i in range(r.shape[0]):
  *         if np.abs(pr[i])<1e-14:
  *             x0 = 0.0             # <<<<<<<<<<<<<<
  *             x1 = -3e-2
@@ -23208,16 +23122,16 @@
  *         mysys = roots.gsl_function(pr_eqn_wrapper, (             # <<<<<<<<<<<<<<
  *                 r[i], pphi[i], dpphi_dr[i],
  *                 H, RR, chi_1, chi_2, m_1, m_2,
  */
     __Pyx_TraceLine(281,0,__PYX_ERR(0, 281, __pyx_L1_error))
     __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_roots); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 281, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_gsl_function); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 281, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_gsl_function); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 281, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_pr_eqn_wrapper); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 281, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":282
  * 
  *         mysys = roots.gsl_function(pr_eqn_wrapper, (
@@ -23338,88 +23252,88 @@
     __pyx_t_16 = 0;
     __pyx_t_17 = 0;
     __pyx_t_18 = 0;
     __pyx_t_19 = 0;
     __pyx_t_19 = NULL;
     __pyx_t_9 = 0;
     #if CYTHON_UNPACK_METHODS
-    if (unlikely(PyMethod_Check(__pyx_t_1))) {
-      __pyx_t_19 = PyMethod_GET_SELF(__pyx_t_1);
+    if (unlikely(PyMethod_Check(__pyx_t_3))) {
+      __pyx_t_19 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_19)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_19);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_1, function);
+        __Pyx_DECREF_SET(__pyx_t_3, function);
         __pyx_t_9 = 1;
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[3] = {__pyx_t_19, __pyx_t_2, __pyx_t_20};
-      __pyx_t_7 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_9, 2+__pyx_t_9);
+      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_9, 2+__pyx_t_9);
       __Pyx_XDECREF(__pyx_t_19); __pyx_t_19 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 281, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 281, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
-    __Pyx_XDECREF_SET(__pyx_v_mysys, __pyx_t_7);
-    __pyx_t_7 = 0;
+    __Pyx_XDECREF_SET(__pyx_v_mysys, __pyx_t_1);
+    __pyx_t_1 = 0;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":286
  *                 params,q,p
  *             ))
  *         solver = roots.brent(mysys)             # <<<<<<<<<<<<<<
  *         solver.set(x1,x0)
  *         for iter in range(100):
  */
     __Pyx_TraceLine(286,0,__PYX_ERR(0, 286, __pyx_L1_error))
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_roots); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_brent); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_roots); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_brent); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 286, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_20);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = NULL;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = NULL;
     __pyx_t_9 = 0;
     #if CYTHON_UNPACK_METHODS
     if (unlikely(PyMethod_Check(__pyx_t_20))) {
-      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_20);
-      if (likely(__pyx_t_1)) {
+      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_20);
+      if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_20);
-        __Pyx_INCREF(__pyx_t_1);
+        __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_20, function);
         __pyx_t_9 = 1;
       }
     }
     #endif
     {
-      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_mysys};
-      __pyx_t_7 = __Pyx_PyObject_FastCall(__pyx_t_20, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
-      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 286, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
+      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_mysys};
+      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_20, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
+      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
     }
-    __Pyx_XDECREF_SET(__pyx_v_solver, __pyx_t_7);
-    __pyx_t_7 = 0;
+    __Pyx_XDECREF_SET(__pyx_v_solver, __pyx_t_1);
+    __pyx_t_1 = 0;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":287
  *             ))
  *         solver = roots.brent(mysys)
  *         solver.set(x1,x0)             # <<<<<<<<<<<<<<
  *         for iter in range(100):
  *             status = solver.iterate()
  */
     __Pyx_TraceLine(287,0,__PYX_ERR(0, 287, __pyx_L1_error))
     __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_set); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 287, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_20);
-    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_x1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_x1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 287, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_2 = PyFloat_FromDouble(__pyx_v_x0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 287, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_19 = NULL;
     __pyx_t_9 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_20))) {
       __pyx_t_19 = PyMethod_GET_SELF(__pyx_t_20);
@@ -23429,24 +23343,24 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_20, function);
         __pyx_t_9 = 1;
       }
     }
     #endif
     {
-      PyObject *__pyx_callargs[3] = {__pyx_t_19, __pyx_t_1, __pyx_t_2};
-      __pyx_t_7 = __Pyx_PyObject_FastCall(__pyx_t_20, __pyx_callargs+1-__pyx_t_9, 2+__pyx_t_9);
+      PyObject *__pyx_callargs[3] = {__pyx_t_19, __pyx_t_3, __pyx_t_2};
+      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_20, __pyx_callargs+1-__pyx_t_9, 2+__pyx_t_9);
       __Pyx_XDECREF(__pyx_t_19); __pyx_t_19 = 0;
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 287, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
     }
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":288
  *         solver = roots.brent(mysys)
  *         solver.set(x1,x0)
  *         for iter in range(100):             # <<<<<<<<<<<<<<
  *             status = solver.iterate()
  *             x_lo = solver.x_lower()
@@ -23477,22 +23391,22 @@
           __Pyx_DECREF_SET(__pyx_t_20, function);
           __pyx_t_9 = 1;
         }
       }
       #endif
       {
         PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
-        __pyx_t_7 = __Pyx_PyObject_FastCall(__pyx_t_20, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);
+        __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_20, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-        if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 289, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
+        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
       }
-      __Pyx_XDECREF_SET(__pyx_v_status, __pyx_t_7);
-      __pyx_t_7 = 0;
+      __Pyx_XDECREF_SET(__pyx_v_status, __pyx_t_1);
+      __pyx_t_1 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":290
  *         for iter in range(100):
  *             status = solver.iterate()
  *             x_lo = solver.x_lower()             # <<<<<<<<<<<<<<
  *             x_up = solver.x_upper()
  *             status = roots.test_interval(x_lo, x_up, tol,tol)
@@ -23512,22 +23426,22 @@
           __Pyx_DECREF_SET(__pyx_t_20, function);
           __pyx_t_9 = 1;
         }
       }
       #endif
       {
         PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
-        __pyx_t_7 = __Pyx_PyObject_FastCall(__pyx_t_20, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);
+        __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_20, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-        if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 290, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
+        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 290, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
       }
-      __Pyx_XDECREF_SET(__pyx_v_x_lo, __pyx_t_7);
-      __pyx_t_7 = 0;
+      __Pyx_XDECREF_SET(__pyx_v_x_lo, __pyx_t_1);
+      __pyx_t_1 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":291
  *             status = solver.iterate()
  *             x_lo = solver.x_lower()
  *             x_up = solver.x_upper()             # <<<<<<<<<<<<<<
  *             status = roots.test_interval(x_lo, x_up, tol,tol)
  *             result = solver.root()
@@ -23547,22 +23461,22 @@
           __Pyx_DECREF_SET(__pyx_t_20, function);
           __pyx_t_9 = 1;
         }
       }
       #endif
       {
         PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
-        __pyx_t_7 = __Pyx_PyObject_FastCall(__pyx_t_20, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);
+        __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_20, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-        if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 291, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
+        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 291, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
       }
-      __Pyx_XDECREF_SET(__pyx_v_x_up, __pyx_t_7);
-      __pyx_t_7 = 0;
+      __Pyx_XDECREF_SET(__pyx_v_x_up, __pyx_t_1);
+      __pyx_t_1 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":292
  *             x_lo = solver.x_lower()
  *             x_up = solver.x_upper()
  *             status = roots.test_interval(x_lo, x_up, tol,tol)             # <<<<<<<<<<<<<<
  *             result = solver.root()
  *             if status == errno.GSL_SUCCESS:
@@ -23571,16 +23485,16 @@
       __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_roots); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 292, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_20);
       __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_test_interval); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 292, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
       __pyx_t_20 = PyFloat_FromDouble(__pyx_v_tol); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 292, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_20);
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_tol); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_3 = PyFloat_FromDouble(__pyx_v_tol); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 292, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_19 = NULL;
       __pyx_t_9 = 0;
       #if CYTHON_UNPACK_METHODS
       if (unlikely(PyMethod_Check(__pyx_t_2))) {
         __pyx_t_19 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_19)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -23588,78 +23502,78 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_2, function);
           __pyx_t_9 = 1;
         }
       }
       #endif
       {
-        PyObject *__pyx_callargs[5] = {__pyx_t_19, __pyx_v_x_lo, __pyx_v_x_up, __pyx_t_20, __pyx_t_1};
-        __pyx_t_7 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_9, 4+__pyx_t_9);
+        PyObject *__pyx_callargs[5] = {__pyx_t_19, __pyx_v_x_lo, __pyx_v_x_up, __pyx_t_20, __pyx_t_3};
+        __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_9, 4+__pyx_t_9);
         __Pyx_XDECREF(__pyx_t_19); __pyx_t_19 = 0;
         __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 292, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       }
-      __Pyx_DECREF_SET(__pyx_v_status, __pyx_t_7);
-      __pyx_t_7 = 0;
+      __Pyx_DECREF_SET(__pyx_v_status, __pyx_t_1);
+      __pyx_t_1 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":293
  *             x_up = solver.x_upper()
  *             status = roots.test_interval(x_lo, x_up, tol,tol)
  *             result = solver.root()             # <<<<<<<<<<<<<<
  *             if status == errno.GSL_SUCCESS:
  *                 break
  */
       __Pyx_TraceLine(293,0,__PYX_ERR(0, 293, __pyx_L1_error))
       __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_root); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 293, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = NULL;
+      __pyx_t_3 = NULL;
       __pyx_t_9 = 0;
       #if CYTHON_UNPACK_METHODS
       if (likely(PyMethod_Check(__pyx_t_2))) {
-        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
-        if (likely(__pyx_t_1)) {
+        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
+        if (likely(__pyx_t_3)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-          __Pyx_INCREF(__pyx_t_1);
+          __Pyx_INCREF(__pyx_t_3);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_2, function);
           __pyx_t_9 = 1;
         }
       }
       #endif
       {
-        PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
-        __pyx_t_7 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);
-        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-        if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 293, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
+        PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
+        __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);
+        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       }
-      __Pyx_XDECREF_SET(__pyx_v_result, __pyx_t_7);
-      __pyx_t_7 = 0;
+      __Pyx_XDECREF_SET(__pyx_v_result, __pyx_t_1);
+      __pyx_t_1 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":294
  *             status = roots.test_interval(x_lo, x_up, tol,tol)
  *             result = solver.root()
  *             if status == errno.GSL_SUCCESS:             # <<<<<<<<<<<<<<
  *                 break
  *         pr[i] = result
  */
       __Pyx_TraceLine(294,0,__PYX_ERR(0, 294, __pyx_L1_error))
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_errno); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 294, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_GSL_SUCCESS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 294, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_errno); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 294, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_GSL_SUCCESS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 294, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyObject_RichCompare(__pyx_v_status, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 294, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = PyObject_RichCompare(__pyx_v_status, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 294, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely((__pyx_t_11 < 0))) __PYX_ERR(0, 294, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_11 < 0))) __PYX_ERR(0, 294, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (__pyx_t_11) {
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":295
  *             result = solver.root()
  *             if status == errno.GSL_SUCCESS:
  *                 break             # <<<<<<<<<<<<<<
  *         pr[i] = result
@@ -23707,34 +23621,34 @@
  *         pr[i] = result
  *     return pr             # <<<<<<<<<<<<<<
  * 
  * @cython.wraparound(False)
  */
   __Pyx_TraceLine(297,0,__PYX_ERR(0, 297, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_pr, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 297, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __pyx_r = __pyx_t_7;
-  __pyx_t_7 = 0;
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_pr, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 297, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":248
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef compute_pr(             # <<<<<<<<<<<<<<
  *     double[:] r,
  *     double[:] pr,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_3, 1);
-  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_3);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_t_4, 1);
   __Pyx_XDECREF(__pyx_t_10);
   __Pyx_XDECREF(__pyx_t_12);
   __Pyx_XDECREF(__pyx_t_13);
   __Pyx_XDECREF(__pyx_t_14);
   __Pyx_XDECREF(__pyx_t_15);
   __Pyx_XDECREF(__pyx_t_16);
   __Pyx_XDECREF(__pyx_t_17);
@@ -24075,15 +23989,15 @@
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_pr __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__14)
+  __Pyx_TraceFrameInit(__pyx_codeobj__16)
   __Pyx_RefNannySetupContext("compute_pr", 1);
   __Pyx_TraceCall("compute_pr (wrapper)", __pyx_f[0], 248, 0, __PYX_ERR(0, 248, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
   if (unlikely(!__pyx_v_r.memview)) { __Pyx_RaiseUnboundLocalError("r"); __PYX_ERR(0, 248, __pyx_L1_error) }
   if (unlikely(!__pyx_v_pr.memview)) { __Pyx_RaiseUnboundLocalError("pr"); __PYX_ERR(0, 248, __pyx_L1_error) }
   if (unlikely(!__pyx_v_pphi.memview)) { __Pyx_RaiseUnboundLocalError("pphi"); __PYX_ERR(0, 248, __pyx_L1_error) }
   if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(0, 248, __pyx_L1_error) }
@@ -24141,15 +24055,15 @@
   PyObject *__pyx_t_2 = NULL;
   double __pyx_t_3[6];
   double __pyx_t_4;
   __pyx_ctuple_double__and_double __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__15)
+  __Pyx_TraceFrameInit(__pyx_codeobj__17)
   __Pyx_RefNannySetupContext("pphi_eqn", 1);
   __Pyx_TraceCall("pphi_eqn", __pyx_f[0], 306, 0, __PYX_ERR(0, 306, __pyx_L1_error));
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":326
  *     """
  *     cdef double dH_dr,dH_dpr,H_val,csi,omega,omega_circ,result
  *     q[0] = r             # <<<<<<<<<<<<<<
@@ -24612,15 +24526,15 @@
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   double __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__15)
+  __Pyx_TraceFrameInit(__pyx_codeobj__17)
   __Pyx_RefNannySetupContext("pphi_eqn", 1);
   __Pyx_TraceCall("pphi_eqn (wrapper)", __pyx_f[0], 306, 0, __PYX_ERR(0, 306, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_pphi_eqn(__pyx_v_pphi_sol, __pyx_v_r, __pyx_v_pr, __pyx_v_dpr_dr, __pyx_v_H, __pyx_v_RR, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_params, __pyx_v_q, __pyx_v_p, 0); if (unlikely(__pyx_t_1 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 306, __pyx_L1_error)
   __pyx_t_2 = PyFloat_FromDouble(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 306, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
@@ -24894,21 +24808,21 @@
   PyObject *__pyx_v_x_up = NULL;
   PyObject *__pyx_v_result = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
-  __Pyx_memviewslice __pyx_t_3 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  Py_ssize_t __pyx_t_4;
+  PyObject *__pyx_t_3 = NULL;
+  __Pyx_memviewslice __pyx_t_4 = { 0, 0, { 0 }, { 0 }, { 0 } };
   Py_ssize_t __pyx_t_5;
-  int __pyx_t_6;
-  Py_ssize_t __pyx_t_7;
-  int __pyx_t_8;
-  PyObject *__pyx_t_9 = NULL;
+  Py_ssize_t __pyx_t_6;
+  int __pyx_t_7;
+  Py_ssize_t __pyx_t_8;
+  int __pyx_t_9;
   PyObject *__pyx_t_10 = NULL;
   PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
   PyObject *__pyx_t_13 = NULL;
   PyObject *__pyx_t_14 = NULL;
   PyObject *__pyx_t_15 = NULL;
   PyObject *__pyx_t_16 = NULL;
@@ -24917,15 +24831,15 @@
   PyObject *__pyx_t_19 = NULL;
   long __pyx_t_20;
   int __pyx_t_21;
   double __pyx_t_22;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__16)
+  __Pyx_TraceFrameInit(__pyx_codeobj__18)
   __Pyx_RefNannySetupContext("compute_pphi", 1);
   __Pyx_TraceCall("compute_pphi", __pyx_f[0], 356, 0, __PYX_ERR(0, 356, __pyx_L1_error));
   if (__pyx_optional_args) {
     if (__pyx_optional_args->__pyx_n > 0) {
       __pyx_v_tol = __pyx_optional_args->tol;
       if (__pyx_optional_args->__pyx_n > 1) {
         __pyx_v_params = __pyx_optional_args->params;
@@ -24937,137 +24851,143 @@
  *     """
  * 
  *     cdef double[:] dpr_dr = - fin_diff_derivative(r, pr)             # <<<<<<<<<<<<<<
  *     cdef int i
  *     for i in range(r.shape[0]):
  */
   __Pyx_TraceLine(377,0,__PYX_ERR(0, 377, __pyx_L1_error))
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(__pyx_v_r, __pyx_v_pr, 0, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 377, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_r, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 377, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 377, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_pr, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 377, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(__pyx_t_1, __pyx_t_2, 0, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 377, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 377, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v_dpr_dr = __pyx_t_3;
-  __pyx_t_3.memview = NULL;
-  __pyx_t_3.data = NULL;
+  __pyx_t_2 = PyNumber_Negative(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 377, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 377, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_dpr_dr = __pyx_t_4;
+  __pyx_t_4.memview = NULL;
+  __pyx_t_4.data = NULL;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":379
  *     cdef double[:] dpr_dr = - fin_diff_derivative(r, pr)
  *     cdef int i
  *     for i in range(r.shape[0]):             # <<<<<<<<<<<<<<
  * 
  *         x0 = 0.95*pphi[i]
  */
   __Pyx_TraceLine(379,0,__PYX_ERR(0, 379, __pyx_L1_error))
-  __pyx_t_4 = (__pyx_v_r.shape[0]);
-  __pyx_t_5 = __pyx_t_4;
-  for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
-    __pyx_v_i = __pyx_t_6;
+  __pyx_t_5 = (__pyx_v_r.shape[0]);
+  __pyx_t_6 = __pyx_t_5;
+  for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
+    __pyx_v_i = __pyx_t_7;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":381
  *     for i in range(r.shape[0]):
  * 
  *         x0 = 0.95*pphi[i]             # <<<<<<<<<<<<<<
  *         x1 = 1.05*pphi[i]
  *         mysys = roots.gsl_function(pphi_eqn_wrapper, (
  */
     __Pyx_TraceLine(381,0,__PYX_ERR(0, 381, __pyx_L1_error))
-    __pyx_t_7 = __pyx_v_i;
-    __pyx_t_8 = -1;
-    if (__pyx_t_7 < 0) {
-      __pyx_t_7 += __pyx_v_pphi.shape[0];
-      if (unlikely(__pyx_t_7 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_7 >= __pyx_v_pphi.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
+    __pyx_t_8 = __pyx_v_i;
+    __pyx_t_9 = -1;
+    if (__pyx_t_8 < 0) {
+      __pyx_t_8 += __pyx_v_pphi.shape[0];
+      if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_8 >= __pyx_v_pphi.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 381, __pyx_L1_error)
     }
-    __pyx_v_x0 = (0.95 * (*((double *) ( /* dim=0 */ (__pyx_v_pphi.data + __pyx_t_7 * __pyx_v_pphi.strides[0]) ))));
+    __pyx_v_x0 = (0.95 * (*((double *) ( /* dim=0 */ (__pyx_v_pphi.data + __pyx_t_8 * __pyx_v_pphi.strides[0]) ))));
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":382
  * 
  *         x0 = 0.95*pphi[i]
  *         x1 = 1.05*pphi[i]             # <<<<<<<<<<<<<<
  *         mysys = roots.gsl_function(pphi_eqn_wrapper, (
  *                 r[i], pr[i], dpr_dr[i], H, RR, chi_1, chi_2, m_1, m_2, params,q,p
  */
     __Pyx_TraceLine(382,0,__PYX_ERR(0, 382, __pyx_L1_error))
-    __pyx_t_7 = __pyx_v_i;
-    __pyx_t_8 = -1;
-    if (__pyx_t_7 < 0) {
-      __pyx_t_7 += __pyx_v_pphi.shape[0];
-      if (unlikely(__pyx_t_7 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_7 >= __pyx_v_pphi.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
+    __pyx_t_8 = __pyx_v_i;
+    __pyx_t_9 = -1;
+    if (__pyx_t_8 < 0) {
+      __pyx_t_8 += __pyx_v_pphi.shape[0];
+      if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_8 >= __pyx_v_pphi.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 382, __pyx_L1_error)
     }
-    __pyx_v_x1 = (1.05 * (*((double *) ( /* dim=0 */ (__pyx_v_pphi.data + __pyx_t_7 * __pyx_v_pphi.strides[0]) ))));
+    __pyx_v_x1 = (1.05 * (*((double *) ( /* dim=0 */ (__pyx_v_pphi.data + __pyx_t_8 * __pyx_v_pphi.strides[0]) ))));
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":383
  *         x0 = 0.95*pphi[i]
  *         x1 = 1.05*pphi[i]
  *         mysys = roots.gsl_function(pphi_eqn_wrapper, (             # <<<<<<<<<<<<<<
  *                 r[i], pr[i], dpr_dr[i], H, RR, chi_1, chi_2, m_1, m_2, params,q,p
  *             ))
  */
     __Pyx_TraceLine(383,0,__PYX_ERR(0, 383, __pyx_L1_error))
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_roots); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 383, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_gsl_function); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 383, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pphi_eqn_wrapper); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 383, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_roots); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 383, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_gsl_function); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 383, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_pphi_eqn_wrapper); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 383, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":384
  *         x1 = 1.05*pphi[i]
  *         mysys = roots.gsl_function(pphi_eqn_wrapper, (
  *                 r[i], pr[i], dpr_dr[i], H, RR, chi_1, chi_2, m_1, m_2, params,q,p             # <<<<<<<<<<<<<<
  *             ))
  *         solver = roots.brent(mysys)
  */
     __Pyx_TraceLine(384,0,__PYX_ERR(0, 384, __pyx_L1_error))
-    __pyx_t_7 = __pyx_v_i;
-    __pyx_t_8 = -1;
-    if (__pyx_t_7 < 0) {
-      __pyx_t_7 += __pyx_v_r.shape[0];
-      if (unlikely(__pyx_t_7 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_7 >= __pyx_v_r.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
+    __pyx_t_8 = __pyx_v_i;
+    __pyx_t_9 = -1;
+    if (__pyx_t_8 < 0) {
+      __pyx_t_8 += __pyx_v_r.shape[0];
+      if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_8 >= __pyx_v_r.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 384, __pyx_L1_error)
     }
-    __pyx_t_10 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_r.data + __pyx_t_7 * __pyx_v_r.strides[0]) )))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 384, __pyx_L1_error)
+    __pyx_t_10 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_r.data + __pyx_t_8 * __pyx_v_r.strides[0]) )))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 384, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_7 = __pyx_v_i;
-    __pyx_t_8 = -1;
-    if (__pyx_t_7 < 0) {
-      __pyx_t_7 += __pyx_v_pr.shape[0];
-      if (unlikely(__pyx_t_7 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_7 >= __pyx_v_pr.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
+    __pyx_t_8 = __pyx_v_i;
+    __pyx_t_9 = -1;
+    if (__pyx_t_8 < 0) {
+      __pyx_t_8 += __pyx_v_pr.shape[0];
+      if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_8 >= __pyx_v_pr.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 384, __pyx_L1_error)
     }
-    __pyx_t_11 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_pr.data + __pyx_t_7 * __pyx_v_pr.strides[0]) )))); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 384, __pyx_L1_error)
+    __pyx_t_11 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_pr.data + __pyx_t_8 * __pyx_v_pr.strides[0]) )))); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 384, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_7 = __pyx_v_i;
-    __pyx_t_8 = -1;
-    if (__pyx_t_7 < 0) {
-      __pyx_t_7 += __pyx_v_dpr_dr.shape[0];
-      if (unlikely(__pyx_t_7 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_7 >= __pyx_v_dpr_dr.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
+    __pyx_t_8 = __pyx_v_i;
+    __pyx_t_9 = -1;
+    if (__pyx_t_8 < 0) {
+      __pyx_t_8 += __pyx_v_dpr_dr.shape[0];
+      if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_8 >= __pyx_v_dpr_dr.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 384, __pyx_L1_error)
     }
-    __pyx_t_12 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_dpr_dr.data + __pyx_t_7 * __pyx_v_dpr_dr.strides[0]) )))); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 384, __pyx_L1_error)
+    __pyx_t_12 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_dpr_dr.data + __pyx_t_8 * __pyx_v_dpr_dr.strides[0]) )))); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 384, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __pyx_t_13 = PyFloat_FromDouble(__pyx_v_chi_1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 384, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __pyx_t_14 = PyFloat_FromDouble(__pyx_v_chi_2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 384, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __pyx_t_15 = PyFloat_FromDouble(__pyx_v_m_1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 384, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
@@ -25112,71 +25032,71 @@
     __pyx_t_13 = 0;
     __pyx_t_14 = 0;
     __pyx_t_15 = 0;
     __pyx_t_16 = 0;
     __pyx_t_17 = 0;
     __pyx_t_18 = 0;
     __pyx_t_18 = NULL;
-    __pyx_t_8 = 0;
+    __pyx_t_9 = 0;
     #if CYTHON_UNPACK_METHODS
-    if (unlikely(PyMethod_Check(__pyx_t_9))) {
-      __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_9);
+    if (unlikely(PyMethod_Check(__pyx_t_1))) {
+      __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_18)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_18);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_9, function);
-        __pyx_t_8 = 1;
+        __Pyx_DECREF_SET(__pyx_t_1, function);
+        __pyx_t_9 = 1;
       }
     }
     #endif
     {
-      PyObject *__pyx_callargs[3] = {__pyx_t_18, __pyx_t_1, __pyx_t_19};
-      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_9, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
+      PyObject *__pyx_callargs[3] = {__pyx_t_18, __pyx_t_3, __pyx_t_19};
+      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_9, 2+__pyx_t_9);
       __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
       if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 383, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __Pyx_XDECREF_SET(__pyx_v_mysys, __pyx_t_2);
     __pyx_t_2 = 0;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":386
  *                 r[i], pr[i], dpr_dr[i], H, RR, chi_1, chi_2, m_1, m_2, params,q,p
  *             ))
  *         solver = roots.brent(mysys)             # <<<<<<<<<<<<<<
  *         solver.set(x0,x1)
  *         for iter in range(100):
  */
     __Pyx_TraceLine(386,0,__PYX_ERR(0, 386, __pyx_L1_error))
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_roots); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 386, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_brent); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 386, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_roots); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 386, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_brent); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 386, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_19);
-    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = NULL;
-    __pyx_t_8 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = NULL;
+    __pyx_t_9 = 0;
     #if CYTHON_UNPACK_METHODS
     if (unlikely(PyMethod_Check(__pyx_t_19))) {
-      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_19);
-      if (likely(__pyx_t_9)) {
+      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_19);
+      if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_19);
-        __Pyx_INCREF(__pyx_t_9);
+        __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_19, function);
-        __pyx_t_8 = 1;
+        __pyx_t_9 = 1;
       }
     }
     #endif
     {
-      PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_v_mysys};
-      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_19, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
-      __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_mysys};
+      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_19, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
+      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 386, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
     }
     __Pyx_XDECREF_SET(__pyx_v_solver, __pyx_t_2);
     __pyx_t_2 = 0;
 
@@ -25186,38 +25106,38 @@
  *         solver.set(x0,x1)             # <<<<<<<<<<<<<<
  *         for iter in range(100):
  *             status = solver.iterate()
  */
     __Pyx_TraceLine(387,0,__PYX_ERR(0, 387, __pyx_L1_error))
     __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_set); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 387, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_19);
-    __pyx_t_9 = PyFloat_FromDouble(__pyx_v_x0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 387, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_x1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 387, __pyx_L1_error)
+    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_x0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 387, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_x1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 387, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_18 = NULL;
-    __pyx_t_8 = 0;
+    __pyx_t_9 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_19))) {
       __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_19);
       if (likely(__pyx_t_18)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_19);
         __Pyx_INCREF(__pyx_t_18);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_19, function);
-        __pyx_t_8 = 1;
+        __pyx_t_9 = 1;
       }
     }
     #endif
     {
-      PyObject *__pyx_callargs[3] = {__pyx_t_18, __pyx_t_9, __pyx_t_1};
-      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_19, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
+      PyObject *__pyx_callargs[3] = {__pyx_t_18, __pyx_t_1, __pyx_t_3};
+      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_19, __pyx_callargs+1-__pyx_t_9, 2+__pyx_t_9);
       __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
-      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 387, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":388
@@ -25237,32 +25157,32 @@
  *             status = solver.iterate()             # <<<<<<<<<<<<<<
  *             x_lo = solver.x_lower()
  *             x_up = solver.x_upper()
  */
       __Pyx_TraceLine(389,0,__PYX_ERR(0, 389, __pyx_L1_error))
       __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_iterate); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 389, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_19);
-      __pyx_t_1 = NULL;
-      __pyx_t_8 = 0;
+      __pyx_t_3 = NULL;
+      __pyx_t_9 = 0;
       #if CYTHON_UNPACK_METHODS
       if (likely(PyMethod_Check(__pyx_t_19))) {
-        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_19);
-        if (likely(__pyx_t_1)) {
+        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_19);
+        if (likely(__pyx_t_3)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_19);
-          __Pyx_INCREF(__pyx_t_1);
+          __Pyx_INCREF(__pyx_t_3);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_19, function);
-          __pyx_t_8 = 1;
+          __pyx_t_9 = 1;
         }
       }
       #endif
       {
-        PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
-        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_19, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
-        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+        PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
+        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_19, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);
+        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 389, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
       }
       __Pyx_XDECREF_SET(__pyx_v_status, __pyx_t_2);
       __pyx_t_2 = 0;
 
@@ -25272,32 +25192,32 @@
  *             x_lo = solver.x_lower()             # <<<<<<<<<<<<<<
  *             x_up = solver.x_upper()
  *             status = roots.test_interval(x_lo, x_up, tol,tol)
  */
       __Pyx_TraceLine(390,0,__PYX_ERR(0, 390, __pyx_L1_error))
       __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_x_lower); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 390, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_19);
-      __pyx_t_1 = NULL;
-      __pyx_t_8 = 0;
+      __pyx_t_3 = NULL;
+      __pyx_t_9 = 0;
       #if CYTHON_UNPACK_METHODS
       if (likely(PyMethod_Check(__pyx_t_19))) {
-        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_19);
-        if (likely(__pyx_t_1)) {
+        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_19);
+        if (likely(__pyx_t_3)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_19);
-          __Pyx_INCREF(__pyx_t_1);
+          __Pyx_INCREF(__pyx_t_3);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_19, function);
-          __pyx_t_8 = 1;
+          __pyx_t_9 = 1;
         }
       }
       #endif
       {
-        PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
-        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_19, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
-        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+        PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
+        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_19, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);
+        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 390, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
       }
       __Pyx_XDECREF_SET(__pyx_v_x_lo, __pyx_t_2);
       __pyx_t_2 = 0;
 
@@ -25307,32 +25227,32 @@
  *             x_up = solver.x_upper()             # <<<<<<<<<<<<<<
  *             status = roots.test_interval(x_lo, x_up, tol,tol)
  *             result = solver.root()
  */
       __Pyx_TraceLine(391,0,__PYX_ERR(0, 391, __pyx_L1_error))
       __pyx_t_19 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_x_upper); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 391, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_19);
-      __pyx_t_1 = NULL;
-      __pyx_t_8 = 0;
+      __pyx_t_3 = NULL;
+      __pyx_t_9 = 0;
       #if CYTHON_UNPACK_METHODS
       if (likely(PyMethod_Check(__pyx_t_19))) {
-        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_19);
-        if (likely(__pyx_t_1)) {
+        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_19);
+        if (likely(__pyx_t_3)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_19);
-          __Pyx_INCREF(__pyx_t_1);
+          __Pyx_INCREF(__pyx_t_3);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_19, function);
-          __pyx_t_8 = 1;
+          __pyx_t_9 = 1;
         }
       }
       #endif
       {
-        PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
-        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_19, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
-        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+        PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
+        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_19, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);
+        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 391, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
       }
       __Pyx_XDECREF_SET(__pyx_v_x_up, __pyx_t_2);
       __pyx_t_2 = 0;
 
@@ -25342,98 +25262,98 @@
  *             status = roots.test_interval(x_lo, x_up, tol,tol)             # <<<<<<<<<<<<<<
  *             result = solver.root()
  *             if status == errno.GSL_SUCCESS:
  */
       __Pyx_TraceLine(392,0,__PYX_ERR(0, 392, __pyx_L1_error))
       __Pyx_GetModuleGlobalName(__pyx_t_19, __pyx_n_s_roots); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 392, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_19);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_19, __pyx_n_s_test_interval); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 392, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_19, __pyx_n_s_test_interval); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 392, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
       __pyx_t_19 = PyFloat_FromDouble(__pyx_v_tol); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 392, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_19);
-      __pyx_t_9 = PyFloat_FromDouble(__pyx_v_tol); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 392, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_9);
+      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_tol); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 392, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_18 = NULL;
-      __pyx_t_8 = 0;
+      __pyx_t_9 = 0;
       #if CYTHON_UNPACK_METHODS
-      if (unlikely(PyMethod_Check(__pyx_t_1))) {
-        __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_1);
+      if (unlikely(PyMethod_Check(__pyx_t_3))) {
+        __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_18)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
           __Pyx_INCREF(__pyx_t_18);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_1, function);
-          __pyx_t_8 = 1;
+          __Pyx_DECREF_SET(__pyx_t_3, function);
+          __pyx_t_9 = 1;
         }
       }
       #endif
       {
-        PyObject *__pyx_callargs[5] = {__pyx_t_18, __pyx_v_x_lo, __pyx_v_x_up, __pyx_t_19, __pyx_t_9};
-        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_8, 4+__pyx_t_8);
+        PyObject *__pyx_callargs[5] = {__pyx_t_18, __pyx_v_x_lo, __pyx_v_x_up, __pyx_t_19, __pyx_t_1};
+        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_9, 4+__pyx_t_9);
         __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
         __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
-        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 392, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       }
       __Pyx_DECREF_SET(__pyx_v_status, __pyx_t_2);
       __pyx_t_2 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":393
  *             x_up = solver.x_upper()
  *             status = roots.test_interval(x_lo, x_up, tol,tol)
  *             result = solver.root()             # <<<<<<<<<<<<<<
  *             if status == errno.GSL_SUCCESS:
  *                 break
  */
       __Pyx_TraceLine(393,0,__PYX_ERR(0, 393, __pyx_L1_error))
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_root); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 393, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_9 = NULL;
-      __pyx_t_8 = 0;
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_root); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 393, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_1 = NULL;
+      __pyx_t_9 = 0;
       #if CYTHON_UNPACK_METHODS
-      if (likely(PyMethod_Check(__pyx_t_1))) {
-        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_1);
-        if (likely(__pyx_t_9)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-          __Pyx_INCREF(__pyx_t_9);
+      if (likely(PyMethod_Check(__pyx_t_3))) {
+        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
+        if (likely(__pyx_t_1)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+          __Pyx_INCREF(__pyx_t_1);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_1, function);
-          __pyx_t_8 = 1;
+          __Pyx_DECREF_SET(__pyx_t_3, function);
+          __pyx_t_9 = 1;
         }
       }
       #endif
       {
-        PyObject *__pyx_callargs[2] = {__pyx_t_9, NULL};
-        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
-        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+        PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
+        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);
+        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 393, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       }
       __Pyx_XDECREF_SET(__pyx_v_result, __pyx_t_2);
       __pyx_t_2 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":394
  *             status = roots.test_interval(x_lo, x_up, tol,tol)
  *             result = solver.root()
  *             if status == errno.GSL_SUCCESS:             # <<<<<<<<<<<<<<
  *                 break
  *         pphi[i] = result
  */
       __Pyx_TraceLine(394,0,__PYX_ERR(0, 394, __pyx_L1_error))
       __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_errno); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 394, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_GSL_SUCCESS); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 394, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_GSL_SUCCESS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 394, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyObject_RichCompare(__pyx_v_status, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 394, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_2 = PyObject_RichCompare(__pyx_v_status, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 394, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_t_21 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_21 < 0))) __PYX_ERR(0, 394, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       if (__pyx_t_21) {
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":395
  *             result = solver.root()
  *             if status == errno.GSL_SUCCESS:
@@ -25461,25 +25381,25 @@
  *         pphi[i] = result             # <<<<<<<<<<<<<<
  *     return pphi
  * 
  */
     __Pyx_TraceLine(396,0,__PYX_ERR(0, 396, __pyx_L1_error))
     if (unlikely(!__pyx_v_result)) { __Pyx_RaiseUnboundLocalError("result"); __PYX_ERR(0, 396, __pyx_L1_error) }
     __pyx_t_22 = __pyx_PyFloat_AsDouble(__pyx_v_result); if (unlikely((__pyx_t_22 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 396, __pyx_L1_error)
-    __pyx_t_7 = __pyx_v_i;
-    __pyx_t_8 = -1;
-    if (__pyx_t_7 < 0) {
-      __pyx_t_7 += __pyx_v_pphi.shape[0];
-      if (unlikely(__pyx_t_7 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_7 >= __pyx_v_pphi.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
+    __pyx_t_8 = __pyx_v_i;
+    __pyx_t_9 = -1;
+    if (__pyx_t_8 < 0) {
+      __pyx_t_8 += __pyx_v_pphi.shape[0];
+      if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_8 >= __pyx_v_pphi.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 396, __pyx_L1_error)
     }
-    *((double *) ( /* dim=0 */ (__pyx_v_pphi.data + __pyx_t_7 * __pyx_v_pphi.strides[0]) )) = __pyx_t_22;
+    *((double *) ( /* dim=0 */ (__pyx_v_pphi.data + __pyx_t_8 * __pyx_v_pphi.strides[0]) )) = __pyx_t_22;
   }
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":397
  *                 break
  *         pphi[i] = result
  *     return pphi             # <<<<<<<<<<<<<<
  * 
@@ -25501,16 +25421,16 @@
  *     double[:] pr,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_3, 1);
-  __Pyx_XDECREF(__pyx_t_9);
+  __Pyx_XDECREF(__pyx_t_3);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_t_4, 1);
   __Pyx_XDECREF(__pyx_t_10);
   __Pyx_XDECREF(__pyx_t_11);
   __Pyx_XDECREF(__pyx_t_12);
   __Pyx_XDECREF(__pyx_t_13);
   __Pyx_XDECREF(__pyx_t_14);
   __Pyx_XDECREF(__pyx_t_15);
   __Pyx_XDECREF(__pyx_t_16);
@@ -25851,15 +25771,15 @@
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_pphi __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__16)
+  __Pyx_TraceFrameInit(__pyx_codeobj__18)
   __Pyx_RefNannySetupContext("compute_pphi", 1);
   __Pyx_TraceCall("compute_pphi (wrapper)", __pyx_f[0], 356, 0, __PYX_ERR(0, 356, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
   if (unlikely(!__pyx_v_r.memview)) { __Pyx_RaiseUnboundLocalError("r"); __PYX_ERR(0, 356, __pyx_L1_error) }
   if (unlikely(!__pyx_v_pr.memview)) { __Pyx_RaiseUnboundLocalError("pr"); __PYX_ERR(0, 356, __pyx_L1_error) }
   if (unlikely(!__pyx_v_pphi.memview)) { __Pyx_RaiseUnboundLocalError("pphi"); __PYX_ERR(0, 356, __pyx_L1_error) }
   if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(0, 356, __pyx_L1_error) }
@@ -25930,15 +25850,15 @@
   int __pyx_t_9;
   __Pyx_memviewslice __pyx_t_10 = { 0, 0, { 0 }, { 0 }, { 0 } };
   struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_pr __pyx_t_11;
   struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_pphi __pyx_t_12;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__17)
+  __Pyx_TraceFrameInit(__pyx_codeobj__19)
   __Pyx_RefNannySetupContext("compute_postadiabatic_solution", 1);
   __Pyx_TraceCall("compute_postadiabatic_solution", __pyx_f[0], 401, 0, __PYX_ERR(0, 401, __pyx_L1_error));
   if (__pyx_optional_args) {
     if (__pyx_optional_args->__pyx_n > 0) {
       __pyx_v_tol = __pyx_optional_args->tol;
       if (__pyx_optional_args->__pyx_n > 1) {
         __pyx_v_order = __pyx_optional_args->order;
@@ -26523,15 +26443,15 @@
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_postadiabatic_solution __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__17)
+  __Pyx_TraceFrameInit(__pyx_codeobj__19)
   __Pyx_RefNannySetupContext("compute_postadiabatic_solution", 1);
   __Pyx_TraceCall("compute_postadiabatic_solution (wrapper)", __pyx_f[0], 401, 0, __PYX_ERR(0, 401, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
   if (unlikely(!__pyx_v_r.memview)) { __Pyx_RaiseUnboundLocalError("r"); __PYX_ERR(0, 401, __pyx_L1_error) }
   if (unlikely(!__pyx_v_pphi.memview)) { __Pyx_RaiseUnboundLocalError("pphi"); __PYX_ERR(0, 401, __pyx_L1_error) }
   if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(0, 401, __pyx_L1_error) }
   if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(0, 401, __pyx_L1_error) }
@@ -26634,15 +26554,15 @@
   long __pyx_t_19;
   long __pyx_t_20;
   int __pyx_t_21;
   double __pyx_t_22[6];
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__18)
+  __Pyx_TraceFrameInit(__pyx_codeobj__20)
   __Pyx_RefNannySetupContext("compute_postadiabatic_dynamics", 1);
   __Pyx_TraceCall("compute_postadiabatic_dynamics", __pyx_f[0], 465, 0, __PYX_ERR(0, 465, __pyx_L1_error));
   if (__pyx_optional_args) {
     if (__pyx_optional_args->__pyx_n > 0) {
       __pyx_v_tol = __pyx_optional_args->tol;
       if (__pyx_optional_args->__pyx_n > 1) {
         __pyx_v_params = __pyx_optional_args->params;
@@ -27712,41 +27632,29 @@
  * 
  * 
  *     t = cumulative_integral(r, dt_dr)             # <<<<<<<<<<<<<<
  * 
  *     phi = cumulative_integral(r, dphi_dr)
  */
   __Pyx_TraceLine(557,0,__PYX_ERR(0, 557, __pyx_L1_error))
-  __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_r, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 557, __pyx_L1_error)
-  __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_dt_dr, PyBUF_WRITABLE); if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 557, __pyx_L1_error)
-  __pyx_t_7 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral(__pyx_t_17, __pyx_t_15, 0, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 557, __pyx_L1_error)
+  __pyx_t_7 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral(__pyx_v_r, __pyx_v_dt_dr, 0, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 557, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_17, 1);
-  __pyx_t_17.memview = NULL; __pyx_t_17.data = NULL;
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_15, 1);
-  __pyx_t_15.memview = NULL; __pyx_t_15.data = NULL;
   __pyx_v_t = __pyx_t_7;
   __pyx_t_7 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":559
  *     t = cumulative_integral(r, dt_dr)
  * 
  *     phi = cumulative_integral(r, dphi_dr)             # <<<<<<<<<<<<<<
  * 
  *     postadiabatic_dynamics = np.c_[t, r, phi, pr, pphi]
  */
   __Pyx_TraceLine(559,0,__PYX_ERR(0, 559, __pyx_L1_error))
-  __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_r, PyBUF_WRITABLE); if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_dphi_dr, PyBUF_WRITABLE); if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_7 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral(__pyx_t_15, __pyx_t_17, 0, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 559, __pyx_L1_error)
+  __pyx_t_7 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral(__pyx_v_r, __pyx_v_dphi_dr, 0, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 559, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_15, 1);
-  __pyx_t_15.memview = NULL; __pyx_t_15.data = NULL;
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_17, 1);
-  __pyx_t_17.memview = NULL; __pyx_t_17.data = NULL;
   __pyx_v_phi = __pyx_t_7;
   __pyx_t_7 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":561
  *     phi = cumulative_integral(r, dphi_dr)
  * 
  *     postadiabatic_dynamics = np.c_[t, r, phi, pr, pphi]             # <<<<<<<<<<<<<<
@@ -28099,15 +28007,15 @@
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_postadiabatic_dynamics __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__18)
+  __Pyx_TraceFrameInit(__pyx_codeobj__20)
   __Pyx_RefNannySetupContext("compute_postadiabatic_dynamics", 1);
   __Pyx_TraceCall("compute_postadiabatic_dynamics (wrapper)", __pyx_f[0], 465, 0, __PYX_ERR(0, 465, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 3;
   __pyx_t_2.tol = __pyx_v_tol;
   __pyx_t_2.params = __pyx_v_params;
   __pyx_t_2.order = __pyx_v_order;
@@ -28191,15 +28099,15 @@
   PyObject *__pyx_t_20 = NULL;
   PyObject *(*__pyx_t_21)(PyObject *);
   int __pyx_t_22;
   PyObject *__pyx_t_23 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__19)
+  __Pyx_TraceFrameInit(__pyx_codeobj__21)
   __Pyx_RefNannySetupContext("compute_combined_dynamics", 1);
   __Pyx_TraceCall("compute_combined_dynamics", __pyx_f[0], 572, 0, __PYX_ERR(0, 572, __pyx_L1_error));
   if (__pyx_optional_args) {
     if (__pyx_optional_args->__pyx_n > 0) {
       __pyx_v_tol = __pyx_optional_args->tol;
       if (__pyx_optional_args->__pyx_n > 1) {
         __pyx_v_params = __pyx_optional_args->params;
@@ -28279,15 +28187,15 @@
  *         )
  *         PA_success = True
  *         ode_y_init = postadiabatic_dynamics[-1, 1:]             # <<<<<<<<<<<<<<
  *     except ValueError as e:
  *         PA_success = False
  */
       __Pyx_TraceLine(607,0,__PYX_ERR(0, 607, __pyx_L3_error))
-      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_postadiabatic_dynamics, __pyx_tuple__21); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 607, __pyx_L3_error)
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_postadiabatic_dynamics, __pyx_tuple__23); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 607, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_5);
       __pyx_v_ode_y_init = __pyx_t_5;
       __pyx_t_5 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":593
  *     integration.
  *     """
@@ -28715,19 +28623,19 @@
  *     if PA_success is True:
  *         postadiabatic_dynamics = augment_dynamics(postadiabatic_dynamics,chi_1,chi_2,m_1,m_2,H)
  *         ode_dynamics_low[:, 0] += postadiabatic_dynamics[-1, 0]             # <<<<<<<<<<<<<<
  *         ode_dynamics_high[:, 0] += postadiabatic_dynamics[-1, 0]
  *         combined_dynamics = np.vstack(
  */
     __Pyx_TraceLine(635,0,__PYX_ERR(0, 635, __pyx_L1_error))
-    __Pyx_INCREF(__pyx_tuple__22);
-    __pyx_t_23 = __pyx_tuple__22;
+    __Pyx_INCREF(__pyx_tuple__24);
+    __pyx_t_23 = __pyx_tuple__24;
     __pyx_t_18 = __Pyx_PyObject_GetItem(__pyx_v_ode_dynamics_low, __pyx_t_23); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 635, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_18);
-    __pyx_t_20 = __Pyx_PyObject_GetItem(__pyx_v_postadiabatic_dynamics, __pyx_tuple__23); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 635, __pyx_L1_error)
+    __pyx_t_20 = __Pyx_PyObject_GetItem(__pyx_v_postadiabatic_dynamics, __pyx_tuple__25); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 635, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_20);
     __pyx_t_5 = PyNumber_InPlaceAdd(__pyx_t_18, __pyx_t_20); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 635, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
     __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
     if (unlikely((PyObject_SetItem(__pyx_v_ode_dynamics_low, __pyx_t_23, __pyx_t_5) < 0))) __PYX_ERR(0, 635, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
@@ -28737,19 +28645,19 @@
  *         postadiabatic_dynamics = augment_dynamics(postadiabatic_dynamics,chi_1,chi_2,m_1,m_2,H)
  *         ode_dynamics_low[:, 0] += postadiabatic_dynamics[-1, 0]
  *         ode_dynamics_high[:, 0] += postadiabatic_dynamics[-1, 0]             # <<<<<<<<<<<<<<
  *         combined_dynamics = np.vstack(
  *             (postadiabatic_dynamics[:-1], ode_dynamics_low)
  */
     __Pyx_TraceLine(636,0,__PYX_ERR(0, 636, __pyx_L1_error))
-    __Pyx_INCREF(__pyx_tuple__22);
-    __pyx_t_23 = __pyx_tuple__22;
+    __Pyx_INCREF(__pyx_tuple__24);
+    __pyx_t_23 = __pyx_tuple__24;
     __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_ode_dynamics_high, __pyx_t_23); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 636, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_20 = __Pyx_PyObject_GetItem(__pyx_v_postadiabatic_dynamics, __pyx_tuple__23); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 636, __pyx_L1_error)
+    __pyx_t_20 = __Pyx_PyObject_GetItem(__pyx_v_postadiabatic_dynamics, __pyx_tuple__25); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 636, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_20);
     __pyx_t_18 = PyNumber_InPlaceAdd(__pyx_t_5, __pyx_t_20); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 636, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_18);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
     if (unlikely((PyObject_SetItem(__pyx_v_ode_dynamics_high, __pyx_t_23, __pyx_t_18) < 0))) __PYX_ERR(0, 636, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
@@ -28773,15 +28681,15 @@
  *         ode_dynamics_high[:, 0] += postadiabatic_dynamics[-1, 0]
  *         combined_dynamics = np.vstack(
  *             (postadiabatic_dynamics[:-1], ode_dynamics_low)             # <<<<<<<<<<<<<<
  *         )
  *     else:
  */
     __Pyx_TraceLine(638,0,__PYX_ERR(0, 638, __pyx_L1_error))
-    __pyx_t_20 = __Pyx_PyObject_GetSlice(__pyx_v_postadiabatic_dynamics, 0, -1L, NULL, NULL, &__pyx_slice__24, 0, 1, 1); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 638, __pyx_L1_error)
+    __pyx_t_20 = __Pyx_PyObject_GetSlice(__pyx_v_postadiabatic_dynamics, 0, -1L, NULL, NULL, &__pyx_slice__26, 0, 1, 1); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 638, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_20);
     __pyx_t_17 = PyTuple_New(2); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 638, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_17);
     __Pyx_GIVEREF(__pyx_t_20);
     if (__Pyx_PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_20)) __PYX_ERR(0, 638, __pyx_L1_error);
     __Pyx_INCREF(__pyx_v_ode_dynamics_low);
     __Pyx_GIVEREF(__pyx_v_ode_dynamics_low);
@@ -29205,15 +29113,15 @@
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_combined_dynamics __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__19)
+  __Pyx_TraceFrameInit(__pyx_codeobj__21)
   __Pyx_RefNannySetupContext("compute_combined_dynamics", 1);
   __Pyx_TraceCall("compute_combined_dynamics (wrapper)", __pyx_f[0], 572, 0, __PYX_ERR(0, 572, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 6;
   __pyx_t_2.tol = __pyx_v_tol;
   __pyx_t_2.params = __pyx_v_params;
   __pyx_t_2.step_back = __pyx_v_step_back;
@@ -29238,53 +29146,50 @@
   return __pyx_r;
 }
 
 /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":648
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef cumulative_integral(             # <<<<<<<<<<<<<<
- *     double[:] x,
- *     double[:] y,
+ *     x: np.array,
+ *     y: np.array,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8dynamics_15postadiabatic_C_29cumulative_integral(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-static PyObject *__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral(__Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral *__pyx_optional_args) {
+static PyObject *__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral(PyObject *__pyx_v_x, PyObject *__pyx_v_y, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral *__pyx_optional_args) {
   int __pyx_v_order = ((int)7);
   double __pyx_v_h;
   PyObject *__pyx_v_integral = NULL;
   PyObject *__pyx_v_i = NULL;
   PyObject *__pyx_v_z = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
-  Py_ssize_t __pyx_t_1;
-  int __pyx_t_2;
-  Py_ssize_t __pyx_t_3;
-  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  double __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
-  PyObject *__pyx_t_6 = NULL;
-  PyObject *__pyx_t_7 = NULL;
-  Py_ssize_t __pyx_t_8;
-  PyObject *(*__pyx_t_9)(PyObject *);
-  int __pyx_t_10;
+  int __pyx_t_6;
+  Py_ssize_t __pyx_t_7;
+  PyObject *(*__pyx_t_8)(PyObject *);
+  int __pyx_t_9;
+  PyObject *__pyx_t_10 = NULL;
   PyObject *__pyx_t_11 = NULL;
-  __Pyx_memviewslice __pyx_t_12 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  PyObject *__pyx_t_13 = NULL;
-  Py_ssize_t __pyx_t_14;
-  Py_ssize_t __pyx_t_15;
+  PyObject *__pyx_t_12 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__25)
+  __Pyx_TraceFrameInit(__pyx_codeobj__27)
   __Pyx_RefNannySetupContext("cumulative_integral", 1);
   __Pyx_TraceCall("cumulative_integral", __pyx_f[0], 648, 0, __PYX_ERR(0, 648, __pyx_L1_error));
   if (__pyx_optional_args) {
     if (__pyx_optional_args->__pyx_n > 0) {
       __pyx_v_order = __pyx_optional_args->order;
     }
   }
@@ -29293,79 +29198,66 @@
  *     to a given order in accuracy. Assumes an equally spaced grid
  *     """
  *     cdef double h = x[1] - x[0]             # <<<<<<<<<<<<<<
  * 
  *     integral = np.zeros(x.size)
  */
   __Pyx_TraceLine(657,0,__PYX_ERR(0, 657, __pyx_L1_error))
-  __pyx_t_1 = 1;
-  __pyx_t_2 = -1;
-  if (__pyx_t_1 < 0) {
-    __pyx_t_1 += __pyx_v_x.shape[0];
-    if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
-  } else if (unlikely(__pyx_t_1 >= __pyx_v_x.shape[0])) __pyx_t_2 = 0;
-  if (unlikely(__pyx_t_2 != -1)) {
-    __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 657, __pyx_L1_error)
-  }
-  __pyx_t_3 = 0;
-  __pyx_t_2 = -1;
-  if (__pyx_t_3 < 0) {
-    __pyx_t_3 += __pyx_v_x.shape[0];
-    if (unlikely(__pyx_t_3 < 0)) __pyx_t_2 = 0;
-  } else if (unlikely(__pyx_t_3 >= __pyx_v_x.shape[0])) __pyx_t_2 = 0;
-  if (unlikely(__pyx_t_2 != -1)) {
-    __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 657, __pyx_L1_error)
-  }
-  __pyx_v_h = ((*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_1 * __pyx_v_x.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_3 * __pyx_v_x.strides[0]) ))));
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 657, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 657, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 657, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_h = __pyx_t_4;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":659
  *     cdef double h = x[1] - x[0]
  * 
  *     integral = np.zeros(x.size)             # <<<<<<<<<<<<<<
  * 
  *     if order == 3:
  */
   __Pyx_TraceLine(659,0,__PYX_ERR(0, 659, __pyx_L1_error))
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 659, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 659, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 659, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_size); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 659, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 659, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 659, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 659, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_5 = NULL;
-  __pyx_t_2 = 0;
+  __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
-  if (unlikely(PyMethod_Check(__pyx_t_6))) {
-    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
+  if (unlikely(PyMethod_Check(__pyx_t_1))) {
+    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_5)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_6, function);
-      __pyx_t_2 = 1;
+      __Pyx_DECREF_SET(__pyx_t_1, function);
+      __pyx_t_6 = 1;
     }
   }
   #endif
   {
-    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_7};
-    __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
+    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_2};
+    __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 659, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 659, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
-  __pyx_v_integral = __pyx_t_4;
-  __pyx_t_4 = 0;
+  __pyx_v_integral = __pyx_t_3;
+  __pyx_t_3 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":661
  *     integral = np.zeros(x.size)
  * 
  *     if order == 3:             # <<<<<<<<<<<<<<
  *         for i in range(x.size - 1):
  *             if i == 0:
@@ -29378,164 +29270,138 @@
  * 
  *     if order == 3:
  *         for i in range(x.size - 1):             # <<<<<<<<<<<<<<
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_3[0] * y[:4])
  */
     __Pyx_TraceLine(662,0,__PYX_ERR(0, 662, __pyx_L1_error))
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 662, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 662, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 662, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 662, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
-      __pyx_t_4 = __pyx_t_6; __Pyx_INCREF(__pyx_t_4);
-      __pyx_t_8 = 0;
-      __pyx_t_9 = NULL;
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_3, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
+      __pyx_t_1 = __pyx_t_3; __Pyx_INCREF(__pyx_t_1);
+      __pyx_t_7 = 0;
+      __pyx_t_8 = NULL;
     } else {
-      __pyx_t_8 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 662, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_9 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_7 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_8 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 662, __pyx_L1_error)
     }
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     for (;;) {
-      if (likely(!__pyx_t_9)) {
-        if (likely(PyList_CheckExact(__pyx_t_4))) {
+      if (likely(!__pyx_t_8)) {
+        if (likely(PyList_CheckExact(__pyx_t_1))) {
           {
-            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_4);
+            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_1);
             #if !CYTHON_ASSUME_SAFE_MACROS
             if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 662, __pyx_L1_error)
             #endif
-            if (__pyx_t_8 >= __pyx_temp) break;
+            if (__pyx_t_7 >= __pyx_temp) break;
           }
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_8); __Pyx_INCREF(__pyx_t_6); __pyx_t_8++; if (unlikely((0 < 0))) __PYX_ERR(0, 662, __pyx_L1_error)
+          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_7); __Pyx_INCREF(__pyx_t_3); __pyx_t_7++; if (unlikely((0 < 0))) __PYX_ERR(0, 662, __pyx_L1_error)
           #else
-          __pyx_t_6 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 662, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
+          __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
           #endif
         } else {
           {
-            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_4);
+            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_1);
             #if !CYTHON_ASSUME_SAFE_MACROS
             if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 662, __pyx_L1_error)
             #endif
-            if (__pyx_t_8 >= __pyx_temp) break;
+            if (__pyx_t_7 >= __pyx_temp) break;
           }
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_8); __Pyx_INCREF(__pyx_t_6); __pyx_t_8++; if (unlikely((0 < 0))) __PYX_ERR(0, 662, __pyx_L1_error)
+          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_7); __Pyx_INCREF(__pyx_t_3); __pyx_t_7++; if (unlikely((0 < 0))) __PYX_ERR(0, 662, __pyx_L1_error)
           #else
-          __pyx_t_6 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 662, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
+          __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
           #endif
         }
       } else {
-        __pyx_t_6 = __pyx_t_9(__pyx_t_4);
-        if (unlikely(!__pyx_t_6)) {
+        __pyx_t_3 = __pyx_t_8(__pyx_t_1);
+        if (unlikely(!__pyx_t_3)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
             else __PYX_ERR(0, 662, __pyx_L1_error)
           }
           break;
         }
-        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_GOTREF(__pyx_t_3);
       }
-      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_6);
-      __pyx_t_6 = 0;
+      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
+      __pyx_t_3 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":663
  *     if order == 3:
  *         for i in range(x.size - 1):
  *             if i == 0:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_3[0] * y[:4])
  *             elif i == x.size - 2:
  */
       __Pyx_TraceLine(663,0,__PYX_ERR(0, 663, __pyx_L1_error))
-      __pyx_t_10 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_i, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_10 < 0))) __PYX_ERR(0, 663, __pyx_L1_error)
-      if (__pyx_t_10) {
+      __pyx_t_9 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_i, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 663, __pyx_L1_error)
+      if (__pyx_t_9) {
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":664
  *         for i in range(x.size - 1):
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_3[0] * y[:4])             # <<<<<<<<<<<<<<
  *             elif i == x.size - 2:
  *                 z = np.sum(interpolated_integral_order_3[2] * y[-4:])
  */
         __Pyx_TraceLine(664,0,__PYX_ERR(0, 664, __pyx_L1_error))
-        __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 664, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 664, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 664, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 664, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_interpolated_integral_order_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 664, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_7, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 664, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_interpolated_integral_order_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 664, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 664, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_y, 0, 4, NULL, NULL, &__pyx_slice__28, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 664, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_11 = PyNumber_Multiply(__pyx_t_10, __pyx_t_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 664, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    0,
-    4,
-    0,
-    0,
-    1,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 664, __pyx_L1_error)
-}
-
-__pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 664, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_13 = PyNumber_Multiply(__pyx_t_11, __pyx_t_7); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 664, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = NULL;
-        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __pyx_t_2 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
         if (unlikely(PyMethod_Check(__pyx_t_5))) {
-          __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
-          if (likely(__pyx_t_7)) {
+          __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
+          if (likely(__pyx_t_2)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
-            __Pyx_INCREF(__pyx_t_7);
+            __Pyx_INCREF(__pyx_t_2);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_5, function);
-            __pyx_t_2 = 1;
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_13};
-          __pyx_t_6 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 664, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
+          PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_11};
+          __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 664, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_6);
-        __pyx_t_6 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_3);
+        __pyx_t_3 = 0;
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":663
  *     if order == 3:
  *         for i in range(x.size - 1):
  *             if i == 0:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_3[0] * y[:4])
  *             elif i == x.size - 2:
@@ -29547,100 +29413,74 @@
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_3[0] * y[:4])
  *             elif i == x.size - 2:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_3[2] * y[-4:])
  *             else:
  */
       __Pyx_TraceLine(665,0,__PYX_ERR(0, 665, __pyx_L1_error))
-      __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 665, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 665, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 665, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_t_3, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 665, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_t_5, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 665, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyObject_RichCompare(__pyx_v_i, __pyx_t_6, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 665, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely((__pyx_t_10 < 0))) __PYX_ERR(0, 665, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_3 = PyObject_RichCompare(__pyx_v_i, __pyx_t_5, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 665, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (__pyx_t_10) {
+      __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 665, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      if (__pyx_t_9) {
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":666
  *                 z = np.sum(interpolated_integral_order_3[0] * y[:4])
  *             elif i == x.size - 2:
  *                 z = np.sum(interpolated_integral_order_3[2] * y[-4:])             # <<<<<<<<<<<<<<
  *             else:
  *                 z = np.sum(interpolated_integral_order_3[1] * y[i-1:i+3])
  */
         __Pyx_TraceLine(666,0,__PYX_ERR(0, 666, __pyx_L1_error))
-        __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 666, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_sum); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 666, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_interpolated_integral_order_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 666, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_6, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 666, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    -4L,
-    0,
-    0,
-    1,
-    0,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 666, __pyx_L1_error)
-}
-
-__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 666, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_11 = PyNumber_Multiply(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 666, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 666, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 666, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = NULL;
-        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_interpolated_integral_order_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 666, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_5, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 666, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_y, -4L, 0, NULL, NULL, &__pyx_slice__29, 1, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 666, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_10 = PyNumber_Multiply(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 666, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_t_5 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
-        if (unlikely(PyMethod_Check(__pyx_t_13))) {
-          __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_13);
-          if (likely(__pyx_t_6)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-            __Pyx_INCREF(__pyx_t_6);
+        if (unlikely(PyMethod_Check(__pyx_t_11))) {
+          __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_11);
+          if (likely(__pyx_t_5)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
+            __Pyx_INCREF(__pyx_t_5);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_13, function);
-            __pyx_t_2 = 1;
+            __Pyx_DECREF_SET(__pyx_t_11, function);
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_11};
-          __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_13, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+          PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_10};
+          __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_11, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+          if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 666, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 666, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_5);
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_5);
-        __pyx_t_5 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_3);
+        __pyx_t_3 = 0;
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":665
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_3[0] * y[:4])
  *             elif i == x.size - 2:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_3[2] * y[-4:])
  *             else:
@@ -29653,124 +29493,99 @@
  *             else:
  *                 z = np.sum(interpolated_integral_order_3[1] * y[i-1:i+3])             # <<<<<<<<<<<<<<
  * 
  *             integral[i+1] = integral[i] + z * h
  */
       __Pyx_TraceLine(668,0,__PYX_ERR(0, 668, __pyx_L1_error))
       /*else*/ {
-        __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 668, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_sum); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 668, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 668, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_interpolated_integral_order_3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 668, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_13, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 668, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __pyx_t_13 = __Pyx_PyInt_SubtractObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 668, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_t_13); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 668, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __pyx_t_13 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_3, 3, 0, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 668, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __pyx_t_15 = __Pyx_PyIndex_AsSsize_t(__pyx_t_13); if (unlikely((__pyx_t_15 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 668, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    __pyx_t_14,
-    __pyx_t_15,
-    0,
-    1,
-    1,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 668, __pyx_L1_error)
-}
-
-__pyx_t_13 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 668, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_7 = PyNumber_Multiply(__pyx_t_6, __pyx_t_13); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 668, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __pyx_t_13 = NULL;
-        __pyx_t_2 = 0;
+        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_sum); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 668, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_interpolated_integral_order_3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 668, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_11, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 668, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+        __pyx_t_11 = __Pyx_PyInt_SubtractObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 668, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_3, 3, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 668, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_12 = __Pyx_PyObject_GetSlice(__pyx_v_y, 0, 0, &__pyx_t_11, &__pyx_t_2, NULL, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 668, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __pyx_t_2 = PyNumber_Multiply(__pyx_t_5, __pyx_t_12); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 668, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __pyx_t_12 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
-        if (unlikely(PyMethod_Check(__pyx_t_11))) {
-          __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_11);
-          if (likely(__pyx_t_13)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-            __Pyx_INCREF(__pyx_t_13);
+        if (unlikely(PyMethod_Check(__pyx_t_10))) {
+          __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_10);
+          if (likely(__pyx_t_12)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
+            __Pyx_INCREF(__pyx_t_12);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_11, function);
-            __pyx_t_2 = 1;
+            __Pyx_DECREF_SET(__pyx_t_10, function);
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_13, __pyx_t_7};
-          __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_11, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 668, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_5);
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          PyObject *__pyx_callargs[2] = {__pyx_t_12, __pyx_t_2};
+          __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_10, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
+          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+          if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 668, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
+          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_5);
-        __pyx_t_5 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_3);
+        __pyx_t_3 = 0;
       }
       __pyx_L5:;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":670
  *                 z = np.sum(interpolated_integral_order_3[1] * y[i-1:i+3])
  * 
  *             integral[i+1] = integral[i] + z * h             # <<<<<<<<<<<<<<
  *     elif order == 5:
  *         for i in range(x.size - 1):
  */
       __Pyx_TraceLine(670,0,__PYX_ERR(0, 670, __pyx_L1_error))
-      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_integral, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 670, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_11 = PyFloat_FromDouble(__pyx_v_h); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 670, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_7 = PyNumber_Multiply(__pyx_v_z, __pyx_t_11); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 670, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = PyNumber_Add(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 670, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 670, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      if (unlikely((PyObject_SetItem(__pyx_v_integral, __pyx_t_7, __pyx_t_11) < 0))) __PYX_ERR(0, 670, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_integral, __pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 670, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_10 = PyFloat_FromDouble(__pyx_v_h); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 670, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __pyx_t_2 = PyNumber_Multiply(__pyx_v_z, __pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 670, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      __pyx_t_10 = PyNumber_Add(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 670, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 670, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      if (unlikely((PyObject_SetItem(__pyx_v_integral, __pyx_t_2, __pyx_t_10) < 0))) __PYX_ERR(0, 670, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":662
  * 
  *     if order == 3:
  *         for i in range(x.size - 1):             # <<<<<<<<<<<<<<
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_3[0] * y[:4])
  */
       __Pyx_TraceLine(662,0,__PYX_ERR(0, 662, __pyx_L1_error))
     }
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":661
  *     integral = np.zeros(x.size)
  * 
  *     if order == 3:             # <<<<<<<<<<<<<<
  *         for i in range(x.size - 1):
  *             if i == 0:
@@ -29782,164 +29597,138 @@
  *             integral[i+1] = integral[i] + z * h
  *     elif order == 5:
  *         for i in range(x.size - 1):             # <<<<<<<<<<<<<<
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_5[0] * y[:6])
  */
     __Pyx_TraceLine(672,0,__PYX_ERR(0, 672, __pyx_L1_error))
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 672, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_size); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 672, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_11);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_11, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 672, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 672, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_11);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (likely(PyList_CheckExact(__pyx_t_11)) || PyTuple_CheckExact(__pyx_t_11)) {
-      __pyx_t_4 = __pyx_t_11; __Pyx_INCREF(__pyx_t_4);
-      __pyx_t_8 = 0;
-      __pyx_t_9 = NULL;
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_10 = __Pyx_PyInt_SubtractObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 672, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_10);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
+      __pyx_t_10 = __pyx_t_1; __Pyx_INCREF(__pyx_t_10);
+      __pyx_t_7 = 0;
+      __pyx_t_8 = NULL;
     } else {
-      __pyx_t_8 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 672, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_9 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 672, __pyx_L1_error)
+      __pyx_t_7 = -1; __pyx_t_10 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 672, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __pyx_t_8 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_10); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 672, __pyx_L1_error)
     }
-    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     for (;;) {
-      if (likely(!__pyx_t_9)) {
-        if (likely(PyList_CheckExact(__pyx_t_4))) {
+      if (likely(!__pyx_t_8)) {
+        if (likely(PyList_CheckExact(__pyx_t_10))) {
           {
-            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_4);
+            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_10);
             #if !CYTHON_ASSUME_SAFE_MACROS
             if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 672, __pyx_L1_error)
             #endif
-            if (__pyx_t_8 >= __pyx_temp) break;
+            if (__pyx_t_7 >= __pyx_temp) break;
           }
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_11 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_8); __Pyx_INCREF(__pyx_t_11); __pyx_t_8++; if (unlikely((0 < 0))) __PYX_ERR(0, 672, __pyx_L1_error)
+          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_7); __Pyx_INCREF(__pyx_t_1); __pyx_t_7++; if (unlikely((0 < 0))) __PYX_ERR(0, 672, __pyx_L1_error)
           #else
-          __pyx_t_11 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 672, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
+          __pyx_t_1 = __Pyx_PySequence_ITEM(__pyx_t_10, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
           #endif
         } else {
           {
-            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_4);
+            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_10);
             #if !CYTHON_ASSUME_SAFE_MACROS
             if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 672, __pyx_L1_error)
             #endif
-            if (__pyx_t_8 >= __pyx_temp) break;
+            if (__pyx_t_7 >= __pyx_temp) break;
           }
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_8); __Pyx_INCREF(__pyx_t_11); __pyx_t_8++; if (unlikely((0 < 0))) __PYX_ERR(0, 672, __pyx_L1_error)
+          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_7); __Pyx_INCREF(__pyx_t_1); __pyx_t_7++; if (unlikely((0 < 0))) __PYX_ERR(0, 672, __pyx_L1_error)
           #else
-          __pyx_t_11 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 672, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
+          __pyx_t_1 = __Pyx_PySequence_ITEM(__pyx_t_10, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
           #endif
         }
       } else {
-        __pyx_t_11 = __pyx_t_9(__pyx_t_4);
-        if (unlikely(!__pyx_t_11)) {
+        __pyx_t_1 = __pyx_t_8(__pyx_t_10);
+        if (unlikely(!__pyx_t_1)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
             else __PYX_ERR(0, 672, __pyx_L1_error)
           }
           break;
         }
-        __Pyx_GOTREF(__pyx_t_11);
+        __Pyx_GOTREF(__pyx_t_1);
       }
-      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_11);
-      __pyx_t_11 = 0;
+      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
+      __pyx_t_1 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":673
  *     elif order == 5:
  *         for i in range(x.size - 1):
  *             if i == 0:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_5[0] * y[:6])
  *             elif i == 1:
  */
       __Pyx_TraceLine(673,0,__PYX_ERR(0, 673, __pyx_L1_error))
-      __pyx_t_10 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_i, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_10 < 0))) __PYX_ERR(0, 673, __pyx_L1_error)
-      if (__pyx_t_10) {
+      __pyx_t_9 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_i, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 673, __pyx_L1_error)
+      if (__pyx_t_9) {
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":674
  *         for i in range(x.size - 1):
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_5[0] * y[:6])             # <<<<<<<<<<<<<<
  *             elif i == 1:
  *                 z = np.sum(interpolated_integral_order_5[1] * y[:6])
  */
         __Pyx_TraceLine(674,0,__PYX_ERR(0, 674, __pyx_L1_error))
-        __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 674, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 674, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 674, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 674, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_interpolated_integral_order_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 674, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_12 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 674, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_y, 0, 6, NULL, NULL, &__pyx_slice__30, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 674, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_5 = PyNumber_Multiply(__pyx_t_12, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 674, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_interpolated_integral_order_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 674, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_13 = __Pyx_GetItemInt(__pyx_t_7, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 674, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    0,
-    6,
-    0,
-    0,
-    1,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 674, __pyx_L1_error)
-}
-
-__pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 674, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_6 = PyNumber_Multiply(__pyx_t_13, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 674, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = NULL;
-        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __pyx_t_2 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
-        if (unlikely(PyMethod_Check(__pyx_t_5))) {
-          __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
-          if (likely(__pyx_t_7)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
-            __Pyx_INCREF(__pyx_t_7);
+        if (unlikely(PyMethod_Check(__pyx_t_3))) {
+          __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
+          if (likely(__pyx_t_2)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+            __Pyx_INCREF(__pyx_t_2);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_5, function);
-            __pyx_t_2 = 1;
+            __Pyx_DECREF_SET(__pyx_t_3, function);
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_6};
-          __pyx_t_11 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 674, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
+          PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_5};
+          __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 674, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_11);
-        __pyx_t_11 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_1);
+        __pyx_t_1 = 0;
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":673
  *     elif order == 5:
  *         for i in range(x.size - 1):
  *             if i == 0:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_5[0] * y[:6])
  *             elif i == 1:
@@ -29951,89 +29740,66 @@
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_5[0] * y[:6])
  *             elif i == 1:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_5[1] * y[:6])
  *             elif i == x.size - 3:
  */
       __Pyx_TraceLine(675,0,__PYX_ERR(0, 675, __pyx_L1_error))
-      __pyx_t_10 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_i, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_10 < 0))) __PYX_ERR(0, 675, __pyx_L1_error)
-      if (__pyx_t_10) {
+      __pyx_t_9 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_i, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 675, __pyx_L1_error)
+      if (__pyx_t_9) {
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":676
  *                 z = np.sum(interpolated_integral_order_5[0] * y[:6])
  *             elif i == 1:
  *                 z = np.sum(interpolated_integral_order_5[1] * y[:6])             # <<<<<<<<<<<<<<
  *             elif i == x.size - 3:
  *                 z = np.sum(interpolated_integral_order_5[3] * y[-6:])
  */
         __Pyx_TraceLine(676,0,__PYX_ERR(0, 676, __pyx_L1_error))
-        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 676, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_interpolated_integral_order_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_5, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 676, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    0,
-    6,
-    0,
-    0,
-    1,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 676, __pyx_L1_error)
-}
-
-__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 676, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_13 = PyNumber_Multiply(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 676, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_5 = NULL;
-        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_interpolated_integral_order_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 676, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 676, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_y, 0, 6, NULL, NULL, &__pyx_slice__30, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 676, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_12 = PyNumber_Multiply(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 676, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_t_3 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
-        if (unlikely(PyMethod_Check(__pyx_t_6))) {
-          __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
-          if (likely(__pyx_t_5)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
-            __Pyx_INCREF(__pyx_t_5);
+        if (unlikely(PyMethod_Check(__pyx_t_5))) {
+          __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
+          if (likely(__pyx_t_3)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+            __Pyx_INCREF(__pyx_t_3);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_6, function);
-            __pyx_t_2 = 1;
+            __Pyx_DECREF_SET(__pyx_t_5, function);
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_13};
-          __pyx_t_11 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 676, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_12};
+          __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 676, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_11);
-        __pyx_t_11 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_1);
+        __pyx_t_1 = 0;
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":675
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_5[0] * y[:6])
  *             elif i == 1:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_5[1] * y[:6])
  *             elif i == x.size - 3:
@@ -30045,100 +29811,74 @@
  *             elif i == 1:
  *                 z = np.sum(interpolated_integral_order_5[1] * y[:6])
  *             elif i == x.size - 3:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_5[3] * y[-6:])
  *             elif i == x.size - 2:
  */
       __Pyx_TraceLine(677,0,__PYX_ERR(0, 677, __pyx_L1_error))
-      __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 677, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_size); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 677, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_3, 3, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 677, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyObject_RichCompare(__pyx_v_i, __pyx_t_11, Py_EQ); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 677, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely((__pyx_t_10 < 0))) __PYX_ERR(0, 677, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (__pyx_t_10) {
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 677, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_t_1, __pyx_int_3, 3, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 677, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = PyObject_RichCompare(__pyx_v_i, __pyx_t_5, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 677, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 677, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      if (__pyx_t_9) {
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":678
  *                 z = np.sum(interpolated_integral_order_5[1] * y[:6])
  *             elif i == x.size - 3:
  *                 z = np.sum(interpolated_integral_order_5[3] * y[-6:])             # <<<<<<<<<<<<<<
  *             elif i == x.size - 2:
  *                 z = np.sum(interpolated_integral_order_5[4] * y[-6:])
  */
         __Pyx_TraceLine(678,0,__PYX_ERR(0, 678, __pyx_L1_error))
-        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 678, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_sum); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 678, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_interpolated_integral_order_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 678, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_11, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 678, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 678, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    -6L,
-    0,
-    0,
-    1,
-    0,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 678, __pyx_L1_error)
-}
-
-__pyx_t_11 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 678, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_7 = PyNumber_Multiply(__pyx_t_5, __pyx_t_11); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 678, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
+        __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 678, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_11 = NULL;
-        __pyx_t_2 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_interpolated_integral_order_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 678, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_5, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 678, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_y, -6L, 0, NULL, NULL, &__pyx_slice__31, 1, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 678, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_2 = PyNumber_Multiply(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 678, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_t_5 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
-        if (unlikely(PyMethod_Check(__pyx_t_13))) {
-          __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_13);
-          if (likely(__pyx_t_11)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-            __Pyx_INCREF(__pyx_t_11);
+        if (unlikely(PyMethod_Check(__pyx_t_12))) {
+          __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_12);
+          if (likely(__pyx_t_5)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
+            __Pyx_INCREF(__pyx_t_5);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_13, function);
-            __pyx_t_2 = 1;
+            __Pyx_DECREF_SET(__pyx_t_12, function);
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_7};
-          __pyx_t_6 = __Pyx_PyObject_FastCall(__pyx_t_13, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+          PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_2};
+          __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_12, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_6);
-        __pyx_t_6 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_1);
+        __pyx_t_1 = 0;
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":677
  *             elif i == 1:
  *                 z = np.sum(interpolated_integral_order_5[1] * y[:6])
  *             elif i == x.size - 3:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_5[3] * y[-6:])
  *             elif i == x.size - 2:
@@ -30150,100 +29890,74 @@
  *             elif i == x.size - 3:
  *                 z = np.sum(interpolated_integral_order_5[3] * y[-6:])
  *             elif i == x.size - 2:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_5[4] * y[-6:])
  *             else:
  */
       __Pyx_TraceLine(679,0,__PYX_ERR(0, 679, __pyx_L1_error))
-      __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 679, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_size); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 679, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_13);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_t_13, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 679, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      __pyx_t_13 = PyObject_RichCompare(__pyx_v_i, __pyx_t_6, Py_EQ); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 679, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_13); if (unlikely((__pyx_t_10 < 0))) __PYX_ERR(0, 679, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      if (__pyx_t_10) {
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 679, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_12 = __Pyx_PyInt_SubtractObjC(__pyx_t_1, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 679, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = PyObject_RichCompare(__pyx_v_i, __pyx_t_12, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 679, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+      __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 679, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      if (__pyx_t_9) {
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":680
  *                 z = np.sum(interpolated_integral_order_5[3] * y[-6:])
  *             elif i == x.size - 2:
  *                 z = np.sum(interpolated_integral_order_5[4] * y[-6:])             # <<<<<<<<<<<<<<
  *             else:
  *                 z = np.sum(interpolated_integral_order_5[2] * y[i-2:i+4])
  */
         __Pyx_TraceLine(680,0,__PYX_ERR(0, 680, __pyx_L1_error))
-        __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 680, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_sum); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 680, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_interpolated_integral_order_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 680, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_6, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 680, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    -6L,
-    0,
-    0,
-    1,
-    0,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 680, __pyx_L1_error)
-}
-
-__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 680, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_5 = PyNumber_Multiply(__pyx_t_11, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 680, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_np); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 680, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 680, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_interpolated_integral_order_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 680, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_12, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 680, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = NULL;
-        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __pyx_t_12 = __Pyx_PyObject_GetSlice(__pyx_v_y, -6L, 0, NULL, NULL, &__pyx_slice__31, 1, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 680, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __pyx_t_3 = PyNumber_Multiply(__pyx_t_5, __pyx_t_12); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 680, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __pyx_t_12 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
-        if (unlikely(PyMethod_Check(__pyx_t_7))) {
-          __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
-          if (likely(__pyx_t_6)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
-            __Pyx_INCREF(__pyx_t_6);
+        if (unlikely(PyMethod_Check(__pyx_t_2))) {
+          __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_2);
+          if (likely(__pyx_t_12)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+            __Pyx_INCREF(__pyx_t_12);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_7, function);
-            __pyx_t_2 = 1;
+            __Pyx_DECREF_SET(__pyx_t_2, function);
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_5};
-          __pyx_t_13 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 680, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_13);
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+          PyObject *__pyx_callargs[2] = {__pyx_t_12, __pyx_t_3};
+          __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 680, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
+          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_13);
-        __pyx_t_13 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_1);
+        __pyx_t_1 = 0;
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":679
  *             elif i == x.size - 3:
  *                 z = np.sum(interpolated_integral_order_5[3] * y[-6:])
  *             elif i == x.size - 2:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_5[4] * y[-6:])
  *             else:
@@ -30256,124 +29970,99 @@
  *             else:
  *                 z = np.sum(interpolated_integral_order_5[2] * y[i-2:i+4])             # <<<<<<<<<<<<<<
  * 
  *             integral[i+1] = integral[i] + z * h
  */
       __Pyx_TraceLine(682,0,__PYX_ERR(0, 682, __pyx_L1_error))
       /*else*/ {
-        __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 682, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 682, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 682, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_interpolated_integral_order_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_12 = __Pyx_GetItemInt(__pyx_t_2, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 682, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_v_i, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_4, 4, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 682, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_interpolated_integral_order_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 682, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_7, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 682, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyInt_SubtractObjC(__pyx_v_i, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 682, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_15 = __Pyx_PyIndex_AsSsize_t(__pyx_t_7); if (unlikely((__pyx_t_15 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 682, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_4, 4, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 682, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_t_7); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 682, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    __pyx_t_15,
-    __pyx_t_14,
-    0,
-    1,
-    1,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 682, __pyx_L1_error)
-}
-
-__pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 682, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_11 = PyNumber_Multiply(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 682, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyObject_GetSlice(__pyx_v_y, 0, 0, &__pyx_t_2, &__pyx_t_5, NULL, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 682, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = NULL;
-        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_t_5 = PyNumber_Multiply(__pyx_t_12, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 682, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+        __pyx_t_11 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
-        if (unlikely(PyMethod_Check(__pyx_t_5))) {
-          __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
-          if (likely(__pyx_t_7)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
-            __Pyx_INCREF(__pyx_t_7);
+        if (unlikely(PyMethod_Check(__pyx_t_3))) {
+          __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_3);
+          if (likely(__pyx_t_11)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+            __Pyx_INCREF(__pyx_t_11);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_5, function);
-            __pyx_t_2 = 1;
+            __Pyx_DECREF_SET(__pyx_t_3, function);
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_11};
-          __pyx_t_13 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 682, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_13);
+          PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_5};
+          __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 682, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_1);
+          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_13);
-        __pyx_t_13 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_1);
+        __pyx_t_1 = 0;
       }
       __pyx_L9:;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":684
  *                 z = np.sum(interpolated_integral_order_5[2] * y[i-2:i+4])
  * 
  *             integral[i+1] = integral[i] + z * h             # <<<<<<<<<<<<<<
  *     elif order == 7:
  *         for i in range(x.size - 1):
  */
       __Pyx_TraceLine(684,0,__PYX_ERR(0, 684, __pyx_L1_error))
-      __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_v_integral, __pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 684, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_13);
-      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_h); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 684, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_integral, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 684, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_3 = PyFloat_FromDouble(__pyx_v_h); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 684, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_5 = PyNumber_Multiply(__pyx_v_z, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 684, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_11 = PyNumber_Multiply(__pyx_v_z, __pyx_t_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 684, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 684, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyNumber_Add(__pyx_t_13, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 684, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 684, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 684, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      if (unlikely((PyObject_SetItem(__pyx_v_integral, __pyx_t_11, __pyx_t_5) < 0))) __PYX_ERR(0, 684, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      if (unlikely((PyObject_SetItem(__pyx_v_integral, __pyx_t_5, __pyx_t_3) < 0))) __PYX_ERR(0, 684, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":672
  *             integral[i+1] = integral[i] + z * h
  *     elif order == 5:
  *         for i in range(x.size - 1):             # <<<<<<<<<<<<<<
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_5[0] * y[:6])
  */
       __Pyx_TraceLine(672,0,__PYX_ERR(0, 672, __pyx_L1_error))
     }
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":671
  * 
  *             integral[i+1] = integral[i] + z * h
  *     elif order == 5:             # <<<<<<<<<<<<<<
  *         for i in range(x.size - 1):
  *             if i == 0:
@@ -30385,164 +30074,138 @@
  *             integral[i+1] = integral[i] + z * h
  *     elif order == 7:
  *         for i in range(x.size - 1):             # <<<<<<<<<<<<<<
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_7[0] * y[:8])
  */
     __Pyx_TraceLine(686,0,__PYX_ERR(0, 686, __pyx_L1_error))
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 686, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 686, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_5, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 686, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 686, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
-      __pyx_t_4 = __pyx_t_5; __Pyx_INCREF(__pyx_t_4);
-      __pyx_t_8 = 0;
-      __pyx_t_9 = NULL;
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_size); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 686, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_10);
+    __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 686, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+    __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 686, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_10);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (likely(PyList_CheckExact(__pyx_t_10)) || PyTuple_CheckExact(__pyx_t_10)) {
+      __pyx_t_3 = __pyx_t_10; __Pyx_INCREF(__pyx_t_3);
+      __pyx_t_7 = 0;
+      __pyx_t_8 = NULL;
     } else {
-      __pyx_t_8 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 686, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_9 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 686, __pyx_L1_error)
+      __pyx_t_7 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 686, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_8 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 686, __pyx_L1_error)
     }
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     for (;;) {
-      if (likely(!__pyx_t_9)) {
-        if (likely(PyList_CheckExact(__pyx_t_4))) {
+      if (likely(!__pyx_t_8)) {
+        if (likely(PyList_CheckExact(__pyx_t_3))) {
           {
-            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_4);
+            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_3);
             #if !CYTHON_ASSUME_SAFE_MACROS
             if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 686, __pyx_L1_error)
             #endif
-            if (__pyx_t_8 >= __pyx_temp) break;
+            if (__pyx_t_7 >= __pyx_temp) break;
           }
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely((0 < 0))) __PYX_ERR(0, 686, __pyx_L1_error)
+          __pyx_t_10 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_10); __pyx_t_7++; if (unlikely((0 < 0))) __PYX_ERR(0, 686, __pyx_L1_error)
           #else
-          __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 686, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_5);
+          __pyx_t_10 = __Pyx_PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 686, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_10);
           #endif
         } else {
           {
-            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_4);
+            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_3);
             #if !CYTHON_ASSUME_SAFE_MACROS
             if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 686, __pyx_L1_error)
             #endif
-            if (__pyx_t_8 >= __pyx_temp) break;
+            if (__pyx_t_7 >= __pyx_temp) break;
           }
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely((0 < 0))) __PYX_ERR(0, 686, __pyx_L1_error)
+          __pyx_t_10 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_10); __pyx_t_7++; if (unlikely((0 < 0))) __PYX_ERR(0, 686, __pyx_L1_error)
           #else
-          __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 686, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_5);
+          __pyx_t_10 = __Pyx_PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 686, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_10);
           #endif
         }
       } else {
-        __pyx_t_5 = __pyx_t_9(__pyx_t_4);
-        if (unlikely(!__pyx_t_5)) {
+        __pyx_t_10 = __pyx_t_8(__pyx_t_3);
+        if (unlikely(!__pyx_t_10)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
             else __PYX_ERR(0, 686, __pyx_L1_error)
           }
           break;
         }
-        __Pyx_GOTREF(__pyx_t_5);
+        __Pyx_GOTREF(__pyx_t_10);
       }
-      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
-      __pyx_t_5 = 0;
+      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_10);
+      __pyx_t_10 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":687
  *     elif order == 7:
  *         for i in range(x.size - 1):
  *             if i == 0:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_7[0] * y[:8])
  *             elif i == 1:
  */
       __Pyx_TraceLine(687,0,__PYX_ERR(0, 687, __pyx_L1_error))
-      __pyx_t_10 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_i, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_10 < 0))) __PYX_ERR(0, 687, __pyx_L1_error)
-      if (__pyx_t_10) {
+      __pyx_t_9 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_i, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 687, __pyx_L1_error)
+      if (__pyx_t_9) {
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":688
  *         for i in range(x.size - 1):
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_7[0] * y[:8])             # <<<<<<<<<<<<<<
  *             elif i == 1:
  *                 z = np.sum(interpolated_integral_order_7[1] * y[:8])
  */
         __Pyx_TraceLine(688,0,__PYX_ERR(0, 688, __pyx_L1_error))
-        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 688, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_sum); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 688, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_interpolated_integral_order_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 688, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_11, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 688, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    0,
-    8,
-    0,
-    0,
-    1,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 688, __pyx_L1_error)
-}
-
-__pyx_t_11 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 688, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 688, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 688, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_interpolated_integral_order_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 688, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 688, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_6 = PyNumber_Multiply(__pyx_t_7, __pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 688, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_y, 0, 8, NULL, NULL, &__pyx_slice__32, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 688, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_12 = PyNumber_Multiply(__pyx_t_11, __pyx_t_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 688, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_11 = NULL;
-        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_t_5 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
-        if (unlikely(PyMethod_Check(__pyx_t_13))) {
-          __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_13);
-          if (likely(__pyx_t_11)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-            __Pyx_INCREF(__pyx_t_11);
+        if (unlikely(PyMethod_Check(__pyx_t_1))) {
+          __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
+          if (likely(__pyx_t_5)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+            __Pyx_INCREF(__pyx_t_5);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_13, function);
-            __pyx_t_2 = 1;
+            __Pyx_DECREF_SET(__pyx_t_1, function);
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_6};
-          __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_13, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 688, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_5);
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+          PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_12};
+          __pyx_t_10 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 688, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_10);
+          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_5);
-        __pyx_t_5 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_10);
+        __pyx_t_10 = 0;
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":687
  *     elif order == 7:
  *         for i in range(x.size - 1):
  *             if i == 0:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_7[0] * y[:8])
  *             elif i == 1:
@@ -30554,89 +30217,66 @@
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_7[0] * y[:8])
  *             elif i == 1:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_7[1] * y[:8])
  *             elif i == 2:
  */
       __Pyx_TraceLine(689,0,__PYX_ERR(0, 689, __pyx_L1_error))
-      __pyx_t_10 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_i, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_10 < 0))) __PYX_ERR(0, 689, __pyx_L1_error)
-      if (__pyx_t_10) {
+      __pyx_t_9 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_i, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 689, __pyx_L1_error)
+      if (__pyx_t_9) {
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":690
  *                 z = np.sum(interpolated_integral_order_7[0] * y[:8])
  *             elif i == 1:
  *                 z = np.sum(interpolated_integral_order_7[1] * y[:8])             # <<<<<<<<<<<<<<
  *             elif i == 2:
  *                 z = np.sum(interpolated_integral_order_7[2] * y[:8])
  */
         __Pyx_TraceLine(690,0,__PYX_ERR(0, 690, __pyx_L1_error))
-        __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 690, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 690, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_interpolated_integral_order_7); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 690, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_13, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 690, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 690, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 690, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_interpolated_integral_order_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 690, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 690, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_y, 0, 8, NULL, NULL, &__pyx_slice__32, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 690, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_11 = PyNumber_Multiply(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 690, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    0,
-    8,
-    0,
-    0,
-    1,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 690, __pyx_L1_error)
-}
-
-__pyx_t_13 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 690, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_7 = PyNumber_Multiply(__pyx_t_11, __pyx_t_13); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 690, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __pyx_t_13 = NULL;
-        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __pyx_t_1 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
-        if (unlikely(PyMethod_Check(__pyx_t_6))) {
-          __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_6);
-          if (likely(__pyx_t_13)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
-            __Pyx_INCREF(__pyx_t_13);
+        if (unlikely(PyMethod_Check(__pyx_t_12))) {
+          __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_12);
+          if (likely(__pyx_t_1)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
+            __Pyx_INCREF(__pyx_t_1);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_6, function);
-            __pyx_t_2 = 1;
+            __Pyx_DECREF_SET(__pyx_t_12, function);
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_13, __pyx_t_7};
-          __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 690, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_5);
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_11};
+          __pyx_t_10 = __Pyx_PyObject_FastCall(__pyx_t_12, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 690, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_10);
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_5);
-        __pyx_t_5 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_10);
+        __pyx_t_10 = 0;
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":689
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_7[0] * y[:8])
  *             elif i == 1:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_7[1] * y[:8])
  *             elif i == 2:
@@ -30648,89 +30288,66 @@
  *             elif i == 1:
  *                 z = np.sum(interpolated_integral_order_7[1] * y[:8])
  *             elif i == 2:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_7[2] * y[:8])
  *             elif i == x.size - 4:
  */
       __Pyx_TraceLine(691,0,__PYX_ERR(0, 691, __pyx_L1_error))
-      __pyx_t_10 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_i, __pyx_int_2, 2, 0)); if (unlikely((__pyx_t_10 < 0))) __PYX_ERR(0, 691, __pyx_L1_error)
-      if (__pyx_t_10) {
+      __pyx_t_9 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_i, __pyx_int_2, 2, 0)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 691, __pyx_L1_error)
+      if (__pyx_t_9) {
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":692
  *                 z = np.sum(interpolated_integral_order_7[1] * y[:8])
  *             elif i == 2:
  *                 z = np.sum(interpolated_integral_order_7[2] * y[:8])             # <<<<<<<<<<<<<<
  *             elif i == x.size - 4:
  *                 z = np.sum(interpolated_integral_order_7[4] * y[-8:])
  */
         __Pyx_TraceLine(692,0,__PYX_ERR(0, 692, __pyx_L1_error))
-        __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 692, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_sum); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 692, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_interpolated_integral_order_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 692, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_13 = __Pyx_GetItemInt(__pyx_t_6, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 692, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    0,
-    8,
-    0,
-    0,
-    1,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 692, __pyx_L1_error)
-}
-
-__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 692, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_11 = PyNumber_Multiply(__pyx_t_13, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 692, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_np); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 692, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_sum); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 692, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = NULL;
-        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_interpolated_integral_order_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 692, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_12, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 692, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __pyx_t_12 = __Pyx_PyObject_GetSlice(__pyx_v_y, 0, 8, NULL, NULL, &__pyx_slice__32, 0, 1, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 692, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __pyx_t_5 = PyNumber_Multiply(__pyx_t_1, __pyx_t_12); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 692, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __pyx_t_12 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
-        if (unlikely(PyMethod_Check(__pyx_t_7))) {
-          __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
-          if (likely(__pyx_t_6)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
-            __Pyx_INCREF(__pyx_t_6);
+        if (unlikely(PyMethod_Check(__pyx_t_11))) {
+          __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_11);
+          if (likely(__pyx_t_12)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
+            __Pyx_INCREF(__pyx_t_12);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_7, function);
-            __pyx_t_2 = 1;
+            __Pyx_DECREF_SET(__pyx_t_11, function);
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_11};
-          __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+          PyObject *__pyx_callargs[2] = {__pyx_t_12, __pyx_t_5};
+          __pyx_t_10 = __Pyx_PyObject_FastCall(__pyx_t_11, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 692, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 692, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_5);
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_5);
-        __pyx_t_5 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_10);
+        __pyx_t_10 = 0;
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":691
  *             elif i == 1:
  *                 z = np.sum(interpolated_integral_order_7[1] * y[:8])
  *             elif i == 2:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_7[2] * y[:8])
  *             elif i == x.size - 4:
@@ -30742,100 +30359,74 @@
  *             elif i == 2:
  *                 z = np.sum(interpolated_integral_order_7[2] * y[:8])
  *             elif i == x.size - 4:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_7[4] * y[-8:])
  *             elif i == x.size - 3:
  */
       __Pyx_TraceLine(693,0,__PYX_ERR(0, 693, __pyx_L1_error))
-      __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 693, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_size); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 693, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_t_7, __pyx_int_4, 4, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 693, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyObject_RichCompare(__pyx_v_i, __pyx_t_5, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 693, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely((__pyx_t_10 < 0))) __PYX_ERR(0, 693, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (__pyx_t_10) {
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_size); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 693, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __pyx_t_11 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_4, 4, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 693, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      __pyx_t_10 = PyObject_RichCompare(__pyx_v_i, __pyx_t_11, Py_EQ); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 693, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 693, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      if (__pyx_t_9) {
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":694
  *                 z = np.sum(interpolated_integral_order_7[2] * y[:8])
  *             elif i == x.size - 4:
  *                 z = np.sum(interpolated_integral_order_7[4] * y[-8:])             # <<<<<<<<<<<<<<
  *             elif i == x.size - 3:
  *                 z = np.sum(interpolated_integral_order_7[5] * y[-8:])
  */
         __Pyx_TraceLine(694,0,__PYX_ERR(0, 694, __pyx_L1_error))
-        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 694, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 694, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 694, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_interpolated_integral_order_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 694, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 694, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_5, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 694, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    -8L,
-    0,
-    0,
-    1,
-    0,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 694, __pyx_L1_error)
-}
-
-__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 694, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_5);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_13 = PyNumber_Multiply(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 694, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_5 = NULL;
-        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_interpolated_integral_order_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 694, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __pyx_t_12 = __Pyx_GetItemInt(__pyx_t_11, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 694, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+        __pyx_t_11 = __Pyx_PyObject_GetSlice(__pyx_v_y, -8L, 0, NULL, NULL, &__pyx_slice__33, 1, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 694, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __pyx_t_1 = PyNumber_Multiply(__pyx_t_12, __pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 694, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+        __pyx_t_11 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
-        if (unlikely(PyMethod_Check(__pyx_t_11))) {
-          __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_11);
-          if (likely(__pyx_t_5)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-            __Pyx_INCREF(__pyx_t_5);
+        if (unlikely(PyMethod_Check(__pyx_t_5))) {
+          __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_5);
+          if (likely(__pyx_t_11)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
+            __Pyx_INCREF(__pyx_t_11);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_11, function);
-            __pyx_t_2 = 1;
+            __Pyx_DECREF_SET(__pyx_t_5, function);
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_13};
-          __pyx_t_7 = __Pyx_PyObject_FastCall(__pyx_t_11, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 694, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_7);
-          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_1};
+          __pyx_t_10 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
+          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 694, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_10);
+          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_7);
-        __pyx_t_7 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_10);
+        __pyx_t_10 = 0;
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":693
  *             elif i == 2:
  *                 z = np.sum(interpolated_integral_order_7[2] * y[:8])
  *             elif i == x.size - 4:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_7[4] * y[-8:])
  *             elif i == x.size - 3:
@@ -30847,100 +30438,74 @@
  *             elif i == x.size - 4:
  *                 z = np.sum(interpolated_integral_order_7[4] * y[-8:])
  *             elif i == x.size - 3:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_7[5] * y[-8:])
  *             elif i == x.size - 2:
  */
       __Pyx_TraceLine(695,0,__PYX_ERR(0, 695, __pyx_L1_error))
-      __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 695, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_size); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 695, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyInt_SubtractObjC(__pyx_t_11, __pyx_int_3, 3, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 695, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = PyObject_RichCompare(__pyx_v_i, __pyx_t_7, Py_EQ); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 695, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely((__pyx_t_10 < 0))) __PYX_ERR(0, 695, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      if (__pyx_t_10) {
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_size); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 695, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_3, 3, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 695, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      __pyx_t_10 = PyObject_RichCompare(__pyx_v_i, __pyx_t_5, Py_EQ); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 695, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 695, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      if (__pyx_t_9) {
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":696
  *                 z = np.sum(interpolated_integral_order_7[4] * y[-8:])
  *             elif i == x.size - 3:
  *                 z = np.sum(interpolated_integral_order_7[5] * y[-8:])             # <<<<<<<<<<<<<<
  *             elif i == x.size - 2:
  *                 z = np.sum(interpolated_integral_order_7[6] * y[-8:])
  */
         __Pyx_TraceLine(696,0,__PYX_ERR(0, 696, __pyx_L1_error))
-        __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 696, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sum); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 696, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_13);
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_interpolated_integral_order_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 696, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_7, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    -8L,
-    0,
-    0,
-    1,
-    0,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 696, __pyx_L1_error)
-}
-
-__pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 696, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_6 = PyNumber_Multiply(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 696, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 696, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = NULL;
-        __pyx_t_2 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_interpolated_integral_order_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_5, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 696, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_y, -8L, 0, NULL, NULL, &__pyx_slice__33, 1, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_12 = PyNumber_Multiply(__pyx_t_11, __pyx_t_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 696, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_t_5 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
-        if (unlikely(PyMethod_Check(__pyx_t_13))) {
-          __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_13);
-          if (likely(__pyx_t_7)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
-            __Pyx_INCREF(__pyx_t_7);
+        if (unlikely(PyMethod_Check(__pyx_t_1))) {
+          __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
+          if (likely(__pyx_t_5)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+            __Pyx_INCREF(__pyx_t_5);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_13, function);
-            __pyx_t_2 = 1;
+            __Pyx_DECREF_SET(__pyx_t_1, function);
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_6};
-          __pyx_t_11 = __Pyx_PyObject_FastCall(__pyx_t_13, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 696, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_11);
-          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
+          PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_12};
+          __pyx_t_10 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 696, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_10);
+          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_11);
-        __pyx_t_11 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_10);
+        __pyx_t_10 = 0;
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":695
  *             elif i == x.size - 4:
  *                 z = np.sum(interpolated_integral_order_7[4] * y[-8:])
  *             elif i == x.size - 3:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_7[5] * y[-8:])
  *             elif i == x.size - 2:
@@ -30952,100 +30517,74 @@
  *             elif i == x.size - 3:
  *                 z = np.sum(interpolated_integral_order_7[5] * y[-8:])
  *             elif i == x.size - 2:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_7[6] * y[-8:])
  *             else:
  */
       __Pyx_TraceLine(697,0,__PYX_ERR(0, 697, __pyx_L1_error))
-      __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_v_x, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 697, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_size); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 697, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_13);
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = __Pyx_PyInt_SubtractObjC(__pyx_t_13, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 697, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_11);
-      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      __pyx_t_13 = PyObject_RichCompare(__pyx_v_i, __pyx_t_11, Py_EQ); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 697, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_13); if (unlikely((__pyx_t_10 < 0))) __PYX_ERR(0, 697, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      if (__pyx_t_10) {
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_size); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 697, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 697, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      __pyx_t_10 = PyObject_RichCompare(__pyx_v_i, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 697, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 697, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      if (__pyx_t_9) {
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":698
  *                 z = np.sum(interpolated_integral_order_7[5] * y[-8:])
  *             elif i == x.size - 2:
  *                 z = np.sum(interpolated_integral_order_7[6] * y[-8:])             # <<<<<<<<<<<<<<
  *             else:
  *                 z = np.sum(interpolated_integral_order_7[3] * y[i-3:i+5])
  */
         __Pyx_TraceLine(698,0,__PYX_ERR(0, 698, __pyx_L1_error))
-        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 698, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_sum); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 698, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_interpolated_integral_order_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 698, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_11, 6, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 698, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    -8L,
-    0,
-    0,
-    1,
-    0,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 698, __pyx_L1_error)
-}
-
-__pyx_t_11 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 698, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_11);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_5 = PyNumber_Multiply(__pyx_t_7, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 698, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 698, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_interpolated_integral_order_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_1, 6, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 698, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __pyx_t_11 = NULL;
-        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_y, -8L, 0, NULL, NULL, &__pyx_slice__33, 1, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_11 = PyNumber_Multiply(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 698, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_11);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __pyx_t_1 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
-        if (unlikely(PyMethod_Check(__pyx_t_6))) {
-          __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_6);
-          if (likely(__pyx_t_11)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
-            __Pyx_INCREF(__pyx_t_11);
+        if (unlikely(PyMethod_Check(__pyx_t_12))) {
+          __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_12);
+          if (likely(__pyx_t_1)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
+            __Pyx_INCREF(__pyx_t_1);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_6, function);
-            __pyx_t_2 = 1;
+            __Pyx_DECREF_SET(__pyx_t_12, function);
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_5};
-          __pyx_t_13 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 698, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_13);
-          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+          PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_11};
+          __pyx_t_10 = __Pyx_PyObject_FastCall(__pyx_t_12, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 698, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_10);
+          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_13);
-        __pyx_t_13 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_10);
+        __pyx_t_10 = 0;
 
         /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":697
  *             elif i == x.size - 3:
  *                 z = np.sum(interpolated_integral_order_7[5] * y[-8:])
  *             elif i == x.size - 2:             # <<<<<<<<<<<<<<
  *                 z = np.sum(interpolated_integral_order_7[6] * y[-8:])
  *             else:
@@ -31058,124 +30597,99 @@
  *             else:
  *                 z = np.sum(interpolated_integral_order_7[3] * y[i-3:i+5])             # <<<<<<<<<<<<<<
  * 
  *             integral[i+1] = integral[i] + z * h
  */
       __Pyx_TraceLine(700,0,__PYX_ERR(0, 700, __pyx_L1_error))
       /*else*/ {
-        __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 700, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 700, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_5);
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_interpolated_integral_order_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 700, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_6, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 700, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_np); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 700, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_sum); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 700, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_v_i, __pyx_int_3, 3, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 700, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 700, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_5, 5, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 700, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_15 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_15 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 700, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_12.data = __pyx_v_y.data;
-        __pyx_t_12.memview = __pyx_v_y.memview;
-        __PYX_INC_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_2 = -1;
-        if (unlikely(__pyx_memoryview_slice_memviewslice(
-    &__pyx_t_12,
-    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
-    0,
-    0,
-    &__pyx_t_2,
-    __pyx_t_14,
-    __pyx_t_15,
-    0,
-    1,
-    1,
-    0,
-    1) < 0))
-{
-    __PYX_ERR(0, 700, __pyx_L1_error)
-}
-
-__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_12, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 700, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-        __pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;
-        __pyx_t_7 = PyNumber_Multiply(__pyx_t_11, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 700, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_7);
-        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = NULL;
-        __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_interpolated_integral_order_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 700, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_12, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 700, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __pyx_t_12 = __Pyx_PyInt_SubtractObjC(__pyx_v_i, __pyx_int_3, 3, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 700, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_12);
+        __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_5, 5, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 700, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_y, 0, 0, &__pyx_t_12, &__pyx_t_5, NULL, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 700, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __pyx_t_5 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 700, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __pyx_t_2 = NULL;
+        __pyx_t_6 = 0;
         #if CYTHON_UNPACK_METHODS
-        if (unlikely(PyMethod_Check(__pyx_t_5))) {
-          __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
-          if (likely(__pyx_t_6)) {
-            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
-            __Pyx_INCREF(__pyx_t_6);
+        if (unlikely(PyMethod_Check(__pyx_t_11))) {
+          __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_11);
+          if (likely(__pyx_t_2)) {
+            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
+            __Pyx_INCREF(__pyx_t_2);
             __Pyx_INCREF(function);
-            __Pyx_DECREF_SET(__pyx_t_5, function);
-            __pyx_t_2 = 1;
+            __Pyx_DECREF_SET(__pyx_t_11, function);
+            __pyx_t_6 = 1;
           }
         }
         #endif
         {
-          PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_7};
-          __pyx_t_13 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_2, 1+__pyx_t_2);
-          __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 700, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_13);
+          PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_5};
+          __pyx_t_10 = __Pyx_PyObject_FastCall(__pyx_t_11, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
+          __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 700, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_10);
+          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         }
-        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_13);
-        __pyx_t_13 = 0;
+        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_10);
+        __pyx_t_10 = 0;
       }
       __pyx_L13:;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":702
  *                 z = np.sum(interpolated_integral_order_7[3] * y[i-3:i+5])
  * 
  *             integral[i+1] = integral[i] + z * h             # <<<<<<<<<<<<<<
  * 
  *     return integral
  */
       __Pyx_TraceLine(702,0,__PYX_ERR(0, 702, __pyx_L1_error))
-      __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_v_integral, __pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 702, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_13);
-      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_h); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 702, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_v_integral, __pyx_v_i); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 702, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __pyx_t_11 = PyFloat_FromDouble(__pyx_v_h); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 702, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __pyx_t_5 = PyNumber_Multiply(__pyx_v_z, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 702, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = PyNumber_Multiply(__pyx_v_z, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 702, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+      __pyx_t_11 = PyNumber_Add(__pyx_t_10, __pyx_t_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 702, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_11);
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyNumber_Add(__pyx_t_13, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 702, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 702, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 702, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      if (unlikely((PyObject_SetItem(__pyx_v_integral, __pyx_t_7, __pyx_t_5) < 0))) __PYX_ERR(0, 702, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      if (unlikely((PyObject_SetItem(__pyx_v_integral, __pyx_t_5, __pyx_t_11) < 0))) __PYX_ERR(0, 702, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
       /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":686
  *             integral[i+1] = integral[i] + z * h
  *     elif order == 7:
  *         for i in range(x.size - 1):             # <<<<<<<<<<<<<<
  *             if i == 0:
  *                 z = np.sum(interpolated_integral_order_7[0] * y[:8])
  */
       __Pyx_TraceLine(686,0,__PYX_ERR(0, 686, __pyx_L1_error))
     }
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":685
  * 
  *             integral[i+1] = integral[i] + z * h
  *     elif order == 7:             # <<<<<<<<<<<<<<
  *         for i in range(x.size - 1):
  *             if i == 0:
@@ -31197,27 +30711,27 @@
   __pyx_r = __pyx_v_integral;
   goto __pyx_L0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":648
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef cumulative_integral(             # <<<<<<<<<<<<<<
- *     double[:] x,
- *     double[:] y,
+ *     x: np.array,
+ *     y: np.array,
  */
 
   /* function exit code */
   __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_7);
+  __Pyx_XDECREF(__pyx_t_10);
   __Pyx_XDECREF(__pyx_t_11);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_12, 1);
-  __Pyx_XDECREF(__pyx_t_13);
+  __Pyx_XDECREF(__pyx_t_12);
   __Pyx_AddTraceback("pyseobnr.eob.dynamics.postadiabatic_C.cumulative_integral", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_integral);
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_z);
   __Pyx_XGIVEREF(__pyx_r);
@@ -31239,16 +30753,16 @@
 static PyObject *__pyx_pw_8pyseobnr_3eob_8dynamics_15postadiabatic_C_29cumulative_integral(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ) {
-  __Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_v_y = { 0, 0, { 0 }, { 0 }, { 0 } };
+  PyObject *__pyx_v_x = 0;
+  PyObject *__pyx_v_y = 0;
   int __pyx_v_order;
   #if !CYTHON_METH_FASTCALL
   CYTHON_UNUSED Py_ssize_t __pyx_nargs;
   #endif
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
   PyObject* values[3] = {0,0,0};
   int __pyx_lineno = 0;
@@ -31316,16 +30830,16 @@
         CYTHON_FALLTHROUGH;
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_x = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_x.memview)) __PYX_ERR(0, 649, __pyx_L3_error)
-    __pyx_v_y = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_y.memview)) __PYX_ERR(0, 650, __pyx_L3_error)
+    __pyx_v_x = values[0];
+    __pyx_v_y = values[1];
     if (values[2]) {
       __pyx_v_order = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_order == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 651, __pyx_L3_error)
     } else {
       __pyx_v_order = ((int)7);
     }
   }
   goto __pyx_L6_skip;
@@ -31336,50 +30850,44 @@
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_x, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_y, 1);
   __Pyx_AddTraceback("pyseobnr.eob.dynamics.postadiabatic_C.cumulative_integral", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_28cumulative_integral(__pyx_self, __pyx_v_x, __pyx_v_y, __pyx_v_order);
 
   /* function exit code */
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_x, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_y, 1);
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_28cumulative_integral(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, int __pyx_v_order) {
+static PyObject *__pyx_pf_8pyseobnr_3eob_8dynamics_15postadiabatic_C_28cumulative_integral(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, int __pyx_v_order) {
   PyObject *__pyx_r = NULL;
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__25)
+  __Pyx_TraceFrameInit(__pyx_codeobj__27)
   __Pyx_RefNannySetupContext("cumulative_integral", 1);
   __Pyx_TraceCall("cumulative_integral (wrapper)", __pyx_f[0], 648, 0, __PYX_ERR(0, 648, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_x.memview)) { __Pyx_RaiseUnboundLocalError("x"); __PYX_ERR(0, 648, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_y.memview)) { __Pyx_RaiseUnboundLocalError("y"); __PYX_ERR(0, 648, __pyx_L1_error) }
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.order = __pyx_v_order;
   __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral(__pyx_v_x, __pyx_v_y, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 648, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
@@ -31527,31 +31035,31 @@
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__26)
+  __Pyx_TraceFrameInit(__pyx_codeobj__34)
   __Pyx_RefNannySetupContext("univariate_spline_integral", 1);
   __Pyx_TraceCall("univariate_spline_integral", __pyx_f[0], 706, 0, __PYX_ERR(0, 706, __pyx_L1_error));
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":712
  *     y: np.array,
  * ) -> np.array:
  *     y_x_interp = InterpolatedUnivariateSpline(x[::-1], y[::-1])             # <<<<<<<<<<<<<<
  *     y_x_integral = y_x_interp.antiderivative()(x[::-1])[::-1]
  *     integral = y_x_integral - y_x_integral[0]
  */
   __Pyx_TraceLine(712,0,__PYX_ERR(0, 712, __pyx_L1_error))
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_InterpolatedUnivariateSpline); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_x, __pyx_slice__27); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 712, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_x, __pyx_slice__35); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_y, __pyx_slice__27); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 712, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_y, __pyx_slice__35); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_5)) {
@@ -31604,15 +31112,15 @@
     PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 713, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
-  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_x, __pyx_slice__27); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 713, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_x, __pyx_slice__35); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 713, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -31629,15 +31137,15 @@
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 713, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_slice__27); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 713, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_slice__35); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 713, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_y_x_integral = __pyx_t_2;
   __pyx_t_2 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":714
  *     y_x_interp = InterpolatedUnivariateSpline(x[::-1], y[::-1])
@@ -31907,20 +31415,18 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
   Py_ssize_t __pyx_t_6;
   PyObject *(*__pyx_t_7)(PyObject *);
-  __Pyx_memviewslice __pyx_t_8 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  __Pyx_memviewslice __pyx_t_9 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceFrameInit(__pyx_codeobj__28)
+  __Pyx_TraceFrameInit(__pyx_codeobj__36)
   __Pyx_RefNannySetupContext("compute_adiabatic_parameter", 1);
   __Pyx_TraceCall("compute_adiabatic_parameter", __pyx_f[0], 718, 0, __PYX_ERR(0, 718, __pyx_L1_error));
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":732
  *     Compute the adiabatic parameter :math:`\\frac{\\dot{\\Omega}}{2 \\Omega^{2}}` .
  *     """
  *     omega = np.zeros(dynamics.shape[0])             # <<<<<<<<<<<<<<
@@ -32089,17 +31595,17 @@
  */
     __Pyx_TraceLine(736,0,__PYX_ERR(0, 736, __pyx_L1_error))
     __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_i);
     __Pyx_GIVEREF(__pyx_v_i);
     if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_i)) __PYX_ERR(0, 736, __pyx_L1_error);
-    __Pyx_INCREF(__pyx_slice__29);
-    __Pyx_GIVEREF(__pyx_slice__29);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_slice__29)) __PYX_ERR(0, 736, __pyx_L1_error);
+    __Pyx_INCREF(__pyx_slice__37);
+    __Pyx_GIVEREF(__pyx_slice__37);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_slice__37)) __PYX_ERR(0, 736, __pyx_L1_error);
     __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_dynamics, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF_SET(__pyx_v_q, __pyx_t_2);
     __pyx_t_2 = 0;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":737
@@ -32111,17 +31617,17 @@
  */
     __Pyx_TraceLine(737,0,__PYX_ERR(0, 737, __pyx_L1_error))
     __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 737, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_v_i);
     __Pyx_GIVEREF(__pyx_v_i);
     if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_i)) __PYX_ERR(0, 737, __pyx_L1_error);
-    __Pyx_INCREF(__pyx_slice__30);
-    __Pyx_GIVEREF(__pyx_slice__30);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_slice__30)) __PYX_ERR(0, 737, __pyx_L1_error);
+    __Pyx_INCREF(__pyx_slice__38);
+    __Pyx_GIVEREF(__pyx_slice__38);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_slice__38)) __PYX_ERR(0, 737, __pyx_L1_error);
     __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dynamics, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 737, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF_SET(__pyx_v_p, __pyx_t_1);
     __pyx_t_1 = 0;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":739
@@ -32226,49 +31732,43 @@
  *         omega[i] = dyn[-1]
  * 
  *     domega_dr = fin_diff_derivative(dynamics[:, 1], omega)             # <<<<<<<<<<<<<<
  * 
  *     adiabatic_param = dr_dt * domega_dr / (2 * omega * omega)
  */
   __Pyx_TraceLine(747,0,__PYX_ERR(0, 747, __pyx_L1_error))
-  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_dynamics, __pyx_tuple__31); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 747, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_dynamics, __pyx_tuple__39); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 747, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 747, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(__pyx_t_4, __pyx_v_omega, 0, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 747, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_omega, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 747, __pyx_L1_error)
-  __pyx_t_4 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(__pyx_t_8, __pyx_t_9, 0, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 747, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_8, 1);
-  __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_9, 1);
-  __pyx_t_9.memview = NULL; __pyx_t_9.data = NULL;
-  __pyx_v_domega_dr = __pyx_t_4;
-  __pyx_t_4 = 0;
+  __pyx_v_domega_dr = __pyx_t_1;
+  __pyx_t_1 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":749
  *     domega_dr = fin_diff_derivative(dynamics[:, 1], omega)
  * 
  *     adiabatic_param = dr_dt * domega_dr / (2 * omega * omega)             # <<<<<<<<<<<<<<
  * 
  *     return adiabatic_param
  */
   __Pyx_TraceLine(749,0,__PYX_ERR(0, 749, __pyx_L1_error))
-  __pyx_t_4 = PyNumber_Multiply(__pyx_v_dr_dt, __pyx_v_domega_dr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 749, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyInt_MultiplyCObj(__pyx_int_2, __pyx_v_omega, 2, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 749, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_dr_dt, __pyx_v_domega_dr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 749, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_t_1, __pyx_v_omega); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 749, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_MultiplyCObj(__pyx_int_2, __pyx_v_omega, 2, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 749, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_2 = PyNumber_Multiply(__pyx_t_4, __pyx_v_omega); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 749, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 749, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 749, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v_adiabatic_param = __pyx_t_1;
-  __pyx_t_1 = 0;
+  __pyx_v_adiabatic_param = __pyx_t_4;
+  __pyx_t_4 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":751
  *     adiabatic_param = dr_dt * domega_dr / (2 * omega * omega)
  * 
  *     return adiabatic_param             # <<<<<<<<<<<<<<
  */
   __Pyx_TraceLine(751,0,__PYX_ERR(0, 751, __pyx_L1_error))
@@ -32287,16 +31787,14 @@
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_8, 1);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_9, 1);
   __Pyx_AddTraceback("pyseobnr.eob.dynamics.postadiabatic_C.compute_adiabatic_parameter", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_omega);
   __Pyx_XDECREF(__pyx_v_dr_dt);
   __Pyx_XDECREF(__pyx_v_i);
   __Pyx_XDECREF(__pyx_v_q);
@@ -33316,15 +32814,15 @@
     {&__pyx_kp_s_Unable_to_convert_item_to_object, __pyx_k_Unable_to_convert_item_to_object, sizeof(__pyx_k_Unable_to_convert_item_to_object), 0, 0, 1, 0},
     {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
     {&__pyx_n_s_View_MemoryView, __pyx_k_View_MemoryView, sizeof(__pyx_k_View_MemoryView), 0, 0, 1, 1},
     {&__pyx_kp_u__2, __pyx_k__2, sizeof(__pyx_k__2), 0, 1, 0, 0},
     {&__pyx_n_s__3, __pyx_k__3, sizeof(__pyx_k__3), 0, 0, 1, 1},
     {&__pyx_kp_u__6, __pyx_k__6, sizeof(__pyx_k__6), 0, 1, 0, 0},
     {&__pyx_kp_u__7, __pyx_k__7, sizeof(__pyx_k__7), 0, 1, 0, 0},
-    {&__pyx_n_s__70, __pyx_k__70, sizeof(__pyx_k__70), 0, 0, 1, 1},
+    {&__pyx_n_s__78, __pyx_k__78, sizeof(__pyx_k__78), 0, 0, 1, 1},
     {&__pyx_n_s_abc, __pyx_k_abc, sizeof(__pyx_k_abc), 0, 0, 1, 1},
     {&__pyx_n_s_abs, __pyx_k_abs, sizeof(__pyx_k_abs), 0, 0, 1, 1},
     {&__pyx_n_s_adiabatic_param, __pyx_k_adiabatic_param, sizeof(__pyx_k_adiabatic_param), 0, 0, 1, 1},
     {&__pyx_n_s_allocate_buffer, __pyx_k_allocate_buffer, sizeof(__pyx_k_allocate_buffer), 0, 0, 1, 1},
     {&__pyx_kp_u_and, __pyx_k_and, sizeof(__pyx_k_and), 0, 1, 0, 0},
     {&__pyx_n_s_antiderivative, __pyx_k_antiderivative, sizeof(__pyx_k_antiderivative), 0, 0, 1, 1},
     {&__pyx_n_s_args, __pyx_k_args, sizeof(__pyx_k_args), 0, 0, 1, 1},
@@ -33574,422 +33072,510 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
+  /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":98
+ *     for i in range(size):
+ *         if i == 0:
+ *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[0])             # <<<<<<<<<<<<<<
+ *         elif i == 1:
+ *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[1])
+ */
+  __pyx_slice__10 = PySlice_New(__pyx_int_0, __pyx_int_9, Py_None); if (unlikely(!__pyx_slice__10)) __PYX_ERR(0, 98, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__10);
+  __Pyx_GIVEREF(__pyx_slice__10);
+
+  /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":106
+ *             dy_dx[i] = single_deriv(y[0:9],h,fin_diff_coeffs_order_9[3])
+ *         elif i == size - 4:
+ *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[5])             # <<<<<<<<<<<<<<
+ *         elif i == size - 3:
+ *             dy_dx[i] = single_deriv(y[-9:],h,fin_diff_coeffs_order_9[6])
+ */
+  __pyx_slice__11 = PySlice_New(__pyx_int_neg_9, Py_None, Py_None); if (unlikely(!__pyx_slice__11)) __PYX_ERR(0, 106, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__11);
+  __Pyx_GIVEREF(__pyx_slice__11);
+
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":607
  *         )
  *         PA_success = True
  *         ode_y_init = postadiabatic_dynamics[-1, 1:]             # <<<<<<<<<<<<<<
  *     except ValueError as e:
  *         PA_success = False
  */
-  __pyx_slice__20 = PySlice_New(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__20)) __PYX_ERR(0, 607, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__20);
-  __Pyx_GIVEREF(__pyx_slice__20);
-  __pyx_tuple__21 = PyTuple_Pack(2, __pyx_int_neg_1, __pyx_slice__20); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 607, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__21);
-  __Pyx_GIVEREF(__pyx_tuple__21);
+  __pyx_slice__22 = PySlice_New(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__22)) __PYX_ERR(0, 607, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__22);
+  __Pyx_GIVEREF(__pyx_slice__22);
+  __pyx_tuple__23 = PyTuple_Pack(2, __pyx_int_neg_1, __pyx_slice__22); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 607, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__23);
+  __Pyx_GIVEREF(__pyx_tuple__23);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":635
  *     if PA_success is True:
  *         postadiabatic_dynamics = augment_dynamics(postadiabatic_dynamics,chi_1,chi_2,m_1,m_2,H)
  *         ode_dynamics_low[:, 0] += postadiabatic_dynamics[-1, 0]             # <<<<<<<<<<<<<<
  *         ode_dynamics_high[:, 0] += postadiabatic_dynamics[-1, 0]
  *         combined_dynamics = np.vstack(
  */
-  __pyx_tuple__22 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_0); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 635, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__22);
-  __Pyx_GIVEREF(__pyx_tuple__22);
-  __pyx_tuple__23 = PyTuple_Pack(2, __pyx_int_neg_1, __pyx_int_0); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 635, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__23);
-  __Pyx_GIVEREF(__pyx_tuple__23);
+  __pyx_tuple__24 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_0); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__24);
+  __Pyx_GIVEREF(__pyx_tuple__24);
+  __pyx_tuple__25 = PyTuple_Pack(2, __pyx_int_neg_1, __pyx_int_0); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__25);
+  __Pyx_GIVEREF(__pyx_tuple__25);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":638
  *         ode_dynamics_high[:, 0] += postadiabatic_dynamics[-1, 0]
  *         combined_dynamics = np.vstack(
  *             (postadiabatic_dynamics[:-1], ode_dynamics_low)             # <<<<<<<<<<<<<<
  *         )
  *     else:
  */
-  __pyx_slice__24 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__24)) __PYX_ERR(0, 638, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__24);
-  __Pyx_GIVEREF(__pyx_slice__24);
+  __pyx_slice__26 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__26)) __PYX_ERR(0, 638, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__26);
+  __Pyx_GIVEREF(__pyx_slice__26);
+
+  /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":664
+ *         for i in range(x.size - 1):
+ *             if i == 0:
+ *                 z = np.sum(interpolated_integral_order_3[0] * y[:4])             # <<<<<<<<<<<<<<
+ *             elif i == x.size - 2:
+ *                 z = np.sum(interpolated_integral_order_3[2] * y[-4:])
+ */
+  __pyx_slice__28 = PySlice_New(Py_None, __pyx_int_4, Py_None); if (unlikely(!__pyx_slice__28)) __PYX_ERR(0, 664, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__28);
+  __Pyx_GIVEREF(__pyx_slice__28);
+
+  /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":666
+ *                 z = np.sum(interpolated_integral_order_3[0] * y[:4])
+ *             elif i == x.size - 2:
+ *                 z = np.sum(interpolated_integral_order_3[2] * y[-4:])             # <<<<<<<<<<<<<<
+ *             else:
+ *                 z = np.sum(interpolated_integral_order_3[1] * y[i-1:i+3])
+ */
+  __pyx_slice__29 = PySlice_New(__pyx_int_neg_4, Py_None, Py_None); if (unlikely(!__pyx_slice__29)) __PYX_ERR(0, 666, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__29);
+  __Pyx_GIVEREF(__pyx_slice__29);
+
+  /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":674
+ *         for i in range(x.size - 1):
+ *             if i == 0:
+ *                 z = np.sum(interpolated_integral_order_5[0] * y[:6])             # <<<<<<<<<<<<<<
+ *             elif i == 1:
+ *                 z = np.sum(interpolated_integral_order_5[1] * y[:6])
+ */
+  __pyx_slice__30 = PySlice_New(Py_None, __pyx_int_6, Py_None); if (unlikely(!__pyx_slice__30)) __PYX_ERR(0, 674, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__30);
+  __Pyx_GIVEREF(__pyx_slice__30);
+
+  /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":678
+ *                 z = np.sum(interpolated_integral_order_5[1] * y[:6])
+ *             elif i == x.size - 3:
+ *                 z = np.sum(interpolated_integral_order_5[3] * y[-6:])             # <<<<<<<<<<<<<<
+ *             elif i == x.size - 2:
+ *                 z = np.sum(interpolated_integral_order_5[4] * y[-6:])
+ */
+  __pyx_slice__31 = PySlice_New(__pyx_int_neg_6, Py_None, Py_None); if (unlikely(!__pyx_slice__31)) __PYX_ERR(0, 678, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__31);
+  __Pyx_GIVEREF(__pyx_slice__31);
+
+  /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":688
+ *         for i in range(x.size - 1):
+ *             if i == 0:
+ *                 z = np.sum(interpolated_integral_order_7[0] * y[:8])             # <<<<<<<<<<<<<<
+ *             elif i == 1:
+ *                 z = np.sum(interpolated_integral_order_7[1] * y[:8])
+ */
+  __pyx_slice__32 = PySlice_New(Py_None, __pyx_int_8, Py_None); if (unlikely(!__pyx_slice__32)) __PYX_ERR(0, 688, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__32);
+  __Pyx_GIVEREF(__pyx_slice__32);
+
+  /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":694
+ *                 z = np.sum(interpolated_integral_order_7[2] * y[:8])
+ *             elif i == x.size - 4:
+ *                 z = np.sum(interpolated_integral_order_7[4] * y[-8:])             # <<<<<<<<<<<<<<
+ *             elif i == x.size - 3:
+ *                 z = np.sum(interpolated_integral_order_7[5] * y[-8:])
+ */
+  __pyx_slice__33 = PySlice_New(__pyx_int_neg_8, Py_None, Py_None); if (unlikely(!__pyx_slice__33)) __PYX_ERR(0, 694, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__33);
+  __Pyx_GIVEREF(__pyx_slice__33);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":712
  *     y: np.array,
  * ) -> np.array:
  *     y_x_interp = InterpolatedUnivariateSpline(x[::-1], y[::-1])             # <<<<<<<<<<<<<<
  *     y_x_integral = y_x_interp.antiderivative()(x[::-1])[::-1]
  *     integral = y_x_integral - y_x_integral[0]
  */
-  __pyx_slice__27 = PySlice_New(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__27)) __PYX_ERR(0, 712, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__27);
-  __Pyx_GIVEREF(__pyx_slice__27);
+  __pyx_slice__35 = PySlice_New(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__35)) __PYX_ERR(0, 712, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__35);
+  __Pyx_GIVEREF(__pyx_slice__35);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":736
  * 
  *     for i in range(dynamics.shape[0]):
  *         q = dynamics[i, 1:3]             # <<<<<<<<<<<<<<
  *         p = dynamics[i, 3:]
  * 
  */
-  __pyx_slice__29 = PySlice_New(__pyx_int_1, __pyx_int_3, Py_None); if (unlikely(!__pyx_slice__29)) __PYX_ERR(0, 736, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__29);
-  __Pyx_GIVEREF(__pyx_slice__29);
+  __pyx_slice__37 = PySlice_New(__pyx_int_1, __pyx_int_3, Py_None); if (unlikely(!__pyx_slice__37)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__37);
+  __Pyx_GIVEREF(__pyx_slice__37);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":737
  *     for i in range(dynamics.shape[0]):
  *         q = dynamics[i, 1:3]
  *         p = dynamics[i, 3:]             # <<<<<<<<<<<<<<
  * 
  *         dyn = H.dynamics(q, p, chi_1, chi_2, m_1, m_2)
  */
-  __pyx_slice__30 = PySlice_New(__pyx_int_3, Py_None, Py_None); if (unlikely(!__pyx_slice__30)) __PYX_ERR(0, 737, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__30);
-  __Pyx_GIVEREF(__pyx_slice__30);
+  __pyx_slice__38 = PySlice_New(__pyx_int_3, Py_None, Py_None); if (unlikely(!__pyx_slice__38)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__38);
+  __Pyx_GIVEREF(__pyx_slice__38);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":747
  *         omega[i] = dyn[-1]
  * 
  *     domega_dr = fin_diff_derivative(dynamics[:, 1], omega)             # <<<<<<<<<<<<<<
  * 
  *     adiabatic_param = dr_dt * domega_dr / (2 * omega * omega)
  */
-  __pyx_tuple__31 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_1); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 747, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__31);
-  __Pyx_GIVEREF(__pyx_tuple__31);
+  __pyx_tuple__39 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_1); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 747, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__39);
+  __Pyx_GIVEREF(__pyx_tuple__39);
 
   /* "View.MemoryView":100
  * cdef object __pyx_collections_abc_Sequence "__pyx_collections_abc_Sequence"
  * try:
  *     if __import__("sys").version_info >= (3, 3):             # <<<<<<<<<<<<<<
  *         __pyx_collections_abc_Sequence = __import__("collections.abc").abc.Sequence
  *     else:
  */
-  __pyx_tuple__32 = PyTuple_Pack(1, __pyx_n_s_sys); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(1, 100, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__32);
-  __Pyx_GIVEREF(__pyx_tuple__32);
-  __pyx_tuple__33 = PyTuple_Pack(2, __pyx_int_3, __pyx_int_3); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(1, 100, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__33);
-  __Pyx_GIVEREF(__pyx_tuple__33);
+  __pyx_tuple__40 = PyTuple_Pack(1, __pyx_n_s_sys); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(1, 100, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__40);
+  __Pyx_GIVEREF(__pyx_tuple__40);
+  __pyx_tuple__41 = PyTuple_Pack(2, __pyx_int_3, __pyx_int_3); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(1, 100, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__41);
+  __Pyx_GIVEREF(__pyx_tuple__41);
 
   /* "View.MemoryView":101
  * try:
  *     if __import__("sys").version_info >= (3, 3):
  *         __pyx_collections_abc_Sequence = __import__("collections.abc").abc.Sequence             # <<<<<<<<<<<<<<
  *     else:
  *         __pyx_collections_abc_Sequence = __import__("collections").Sequence
  */
-  __pyx_tuple__34 = PyTuple_Pack(1, __pyx_kp_s_collections_abc); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(1, 101, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__34);
-  __Pyx_GIVEREF(__pyx_tuple__34);
+  __pyx_tuple__42 = PyTuple_Pack(1, __pyx_kp_s_collections_abc); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(1, 101, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__42);
+  __Pyx_GIVEREF(__pyx_tuple__42);
 
   /* "View.MemoryView":103
  *         __pyx_collections_abc_Sequence = __import__("collections.abc").abc.Sequence
  *     else:
  *         __pyx_collections_abc_Sequence = __import__("collections").Sequence             # <<<<<<<<<<<<<<
  * except:
  * 
  */
-  __pyx_tuple__35 = PyTuple_Pack(1, __pyx_n_s_collections); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(1, 103, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__35);
-  __Pyx_GIVEREF(__pyx_tuple__35);
+  __pyx_tuple__43 = PyTuple_Pack(1, __pyx_n_s_collections); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(1, 103, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__43);
+  __Pyx_GIVEREF(__pyx_tuple__43);
 
   /* "View.MemoryView":309
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_tuple__36 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(1, 309, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__36);
-  __Pyx_GIVEREF(__pyx_tuple__36);
+  __pyx_tuple__44 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(1, 309, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__44);
+  __Pyx_GIVEREF(__pyx_tuple__44);
 
   /* "View.MemoryView":310
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_tuple__37 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(1, 310, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__37);
-  __Pyx_GIVEREF(__pyx_tuple__37);
+  __pyx_tuple__45 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(1, 310, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__45);
+  __Pyx_GIVEREF(__pyx_tuple__45);
 
   /* "View.MemoryView":311
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__38 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(1, 311, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__38);
-  __Pyx_GIVEREF(__pyx_tuple__38);
+  __pyx_tuple__46 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(1, 311, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__46);
+  __Pyx_GIVEREF(__pyx_tuple__46);
 
   /* "View.MemoryView":314
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_tuple__39 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(1, 314, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__39);
-  __Pyx_GIVEREF(__pyx_tuple__39);
+  __pyx_tuple__47 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(1, 314, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__47);
+  __Pyx_GIVEREF(__pyx_tuple__47);
 
   /* "View.MemoryView":315
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__40 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(1, 315, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__40);
-  __Pyx_GIVEREF(__pyx_tuple__40);
+  __pyx_tuple__48 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(1, 315, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__48);
+  __Pyx_GIVEREF(__pyx_tuple__48);
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_Enum(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
-  __pyx_tuple__41 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__41);
-  __Pyx_GIVEREF(__pyx_tuple__41);
-  __pyx_codeobj__42 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__42)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __pyx_tuple__49 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__49);
+  __Pyx_GIVEREF(__pyx_tuple__49);
+  __pyx_codeobj__50 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__49, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__50)) __PYX_ERR(1, 1, __pyx_L1_error)
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":81
  * @cython.linetrace(True)
  * @cython.cdivision(True)
  * cpdef fin_diff_derivative(             # <<<<<<<<<<<<<<
- *     double[:] x,
- *     double[:] y,
+ *     x: np.array,
+ *     y: np.array,
  */
-  __pyx_tuple__43 = PyTuple_Pack(3, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_n); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 81, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__43);
-  __Pyx_GIVEREF(__pyx_tuple__43);
-  __pyx_codeobj__9 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__43, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_fin_diff_derivative, 81, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__9)) __PYX_ERR(0, 81, __pyx_L1_error)
-  __pyx_tuple__44 = PyTuple_Pack(1, __pyx_int_8); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 81, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__44);
-  __Pyx_GIVEREF(__pyx_tuple__44);
+  __pyx_tuple__51 = PyTuple_Pack(3, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_n); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 81, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__51);
+  __Pyx_GIVEREF(__pyx_tuple__51);
+  __pyx_codeobj__9 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__51, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_fin_diff_derivative, 81, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__9)) __PYX_ERR(0, 81, __pyx_L1_error)
+  __pyx_tuple__52 = PyTuple_Pack(1, __pyx_int_8); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 81, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__52);
+  __Pyx_GIVEREF(__pyx_tuple__52);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":120
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef Kerr_ISCO(             # <<<<<<<<<<<<<<
  *     double chi1,
  *     double chi2,
  */
-  __pyx_tuple__45 = PyTuple_Pack(4, __pyx_n_s_chi1, __pyx_n_s_chi2, __pyx_n_s_m1, __pyx_n_s_m2); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 120, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__45);
-  __Pyx_GIVEREF(__pyx_tuple__45);
-  __pyx_codeobj__10 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__45, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_Kerr_ISCO, 120, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__10)) __PYX_ERR(0, 120, __pyx_L1_error)
+  __pyx_tuple__53 = PyTuple_Pack(4, __pyx_n_s_chi1, __pyx_n_s_chi2, __pyx_n_s_m1, __pyx_n_s_m2); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 120, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__53);
+  __Pyx_GIVEREF(__pyx_tuple__53);
+  __pyx_codeobj__12 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__53, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_Kerr_ISCO, 120, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__12)) __PYX_ERR(0, 120, __pyx_L1_error)
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":142
  *     return np.array([r_ISCO,L_ISCO])
  * 
  * @cython.profile(True)             # <<<<<<<<<<<<<<
  * @cython.linetrace(True)
  * def Newtonian_j0(r):
  */
-  __pyx_tuple__46 = PyTuple_Pack(1, __pyx_n_s_r); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 142, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__46);
-  __Pyx_GIVEREF(__pyx_tuple__46);
-  __pyx_codeobj__11 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__46, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_Newtonian_j0, 142, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 142, __pyx_L1_error)
+  __pyx_tuple__54 = PyTuple_Pack(1, __pyx_n_s_r); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 142, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__54);
+  __Pyx_GIVEREF(__pyx_tuple__54);
+  __pyx_codeobj__13 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__54, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_Newtonian_j0, 142, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__13)) __PYX_ERR(0, 142, __pyx_L1_error)
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":153
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double j0_eqn(double j0_sol, double r, Hamiltonian_C H, double chi_1, double chi_2, double m_1, double m_2,             # <<<<<<<<<<<<<<
  *             double[:] q, double[:] p):
  *     q[0] = r
  */
-  __pyx_tuple__47 = PyTuple_Pack(9, __pyx_n_s_j0_sol, __pyx_n_s_r, __pyx_n_s_H, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_q, __pyx_n_s_p); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 153, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__47);
-  __Pyx_GIVEREF(__pyx_tuple__47);
-  __pyx_codeobj__12 = (PyObject*)__Pyx_PyCode_New(9, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__47, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_j0_eqn, 153, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__12)) __PYX_ERR(0, 153, __pyx_L1_error)
+  __pyx_tuple__55 = PyTuple_Pack(9, __pyx_n_s_j0_sol, __pyx_n_s_r, __pyx_n_s_H, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_q, __pyx_n_s_p); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 153, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__55);
+  __Pyx_GIVEREF(__pyx_tuple__55);
+  __pyx_codeobj__14 = (PyObject*)__Pyx_PyCode_New(9, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__55, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_j0_eqn, 153, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(0, 153, __pyx_L1_error)
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":162
  *     return dH_dr
  * 
  * cpdef compute_adiabatic_solution(             # <<<<<<<<<<<<<<
  *     double[:] r,
  *     Hamiltonian_C H,
  */
-  __pyx_tuple__48 = PyTuple_Pack(9, __pyx_n_s_r, __pyx_n_s_H, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_q, __pyx_n_s_p, __pyx_n_s_tol); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 162, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__48);
-  __Pyx_GIVEREF(__pyx_tuple__48);
-  __pyx_codeobj__49 = (PyObject*)__Pyx_PyCode_New(9, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__48, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_compute_adiabatic_solution, 162, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__49)) __PYX_ERR(0, 162, __pyx_L1_error)
-  __pyx_tuple__50 = PyTuple_Pack(1, __pyx_float_1eneg_12); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(0, 162, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__50);
-  __Pyx_GIVEREF(__pyx_tuple__50);
+  __pyx_tuple__56 = PyTuple_Pack(9, __pyx_n_s_r, __pyx_n_s_H, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_q, __pyx_n_s_p, __pyx_n_s_tol); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(0, 162, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__56);
+  __Pyx_GIVEREF(__pyx_tuple__56);
+  __pyx_codeobj__57 = (PyObject*)__Pyx_PyCode_New(9, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__56, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_compute_adiabatic_solution, 162, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__57)) __PYX_ERR(0, 162, __pyx_L1_error)
+  __pyx_tuple__58 = PyTuple_Pack(1, __pyx_float_1eneg_12); if (unlikely(!__pyx_tuple__58)) __PYX_ERR(0, 162, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__58);
+  __Pyx_GIVEREF(__pyx_tuple__58);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":198
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double pr_eqn(             # <<<<<<<<<<<<<<
  *     double pr_sol,
  *     double r,
  */
-  __pyx_tuple__51 = PyTuple_Pack(13, __pyx_n_s_pr_sol, __pyx_n_s_r, __pyx_n_s_pphi, __pyx_n_s_dpphi_dr, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_params, __pyx_n_s_q, __pyx_n_s_p); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 198, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__51);
-  __Pyx_GIVEREF(__pyx_tuple__51);
-  __pyx_codeobj__13 = (PyObject*)__Pyx_PyCode_New(13, 0, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__51, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_pr_eqn, 198, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__13)) __PYX_ERR(0, 198, __pyx_L1_error)
+  __pyx_tuple__59 = PyTuple_Pack(13, __pyx_n_s_pr_sol, __pyx_n_s_r, __pyx_n_s_pphi, __pyx_n_s_dpphi_dr, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_params, __pyx_n_s_q, __pyx_n_s_p); if (unlikely(!__pyx_tuple__59)) __PYX_ERR(0, 198, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__59);
+  __Pyx_GIVEREF(__pyx_tuple__59);
+  __pyx_codeobj__15 = (PyObject*)__Pyx_PyCode_New(13, 0, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__59, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_pr_eqn, 198, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__15)) __PYX_ERR(0, 198, __pyx_L1_error)
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":243
  *     return result
  * 
  * cpdef double pr_eqn_wrapper(pr_sol,args):             # <<<<<<<<<<<<<<
  *     return pr_eqn(pr_sol,*args)
  * 
  */
-  __pyx_tuple__52 = PyTuple_Pack(2, __pyx_n_s_pr_sol, __pyx_n_s_args); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 243, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__52);
-  __Pyx_GIVEREF(__pyx_tuple__52);
-  __pyx_codeobj__53 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__52, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_pr_eqn_wrapper, 243, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__53)) __PYX_ERR(0, 243, __pyx_L1_error)
+  __pyx_tuple__60 = PyTuple_Pack(2, __pyx_n_s_pr_sol, __pyx_n_s_args); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 243, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__60);
+  __Pyx_GIVEREF(__pyx_tuple__60);
+  __pyx_codeobj__61 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__60, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_pr_eqn_wrapper, 243, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__61)) __PYX_ERR(0, 243, __pyx_L1_error)
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":248
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef compute_pr(             # <<<<<<<<<<<<<<
  *     double[:] r,
  *     double[:] pr,
  */
-  __pyx_tuple__54 = PyTuple_Pack(13, __pyx_n_s_r, __pyx_n_s_pr, __pyx_n_s_pphi, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_q, __pyx_n_s_p, __pyx_n_s_tol, __pyx_n_s_params); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 248, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__54);
-  __Pyx_GIVEREF(__pyx_tuple__54);
-  __pyx_codeobj__14 = (PyObject*)__Pyx_PyCode_New(13, 0, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__54, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_compute_pr, 248, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(0, 248, __pyx_L1_error)
-  __pyx_tuple__55 = PyTuple_Pack(2, __pyx_float_1eneg_12, Py_None); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 248, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__55);
-  __Pyx_GIVEREF(__pyx_tuple__55);
+  __pyx_tuple__62 = PyTuple_Pack(13, __pyx_n_s_r, __pyx_n_s_pr, __pyx_n_s_pphi, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_q, __pyx_n_s_p, __pyx_n_s_tol, __pyx_n_s_params); if (unlikely(!__pyx_tuple__62)) __PYX_ERR(0, 248, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__62);
+  __Pyx_GIVEREF(__pyx_tuple__62);
+  __pyx_codeobj__16 = (PyObject*)__Pyx_PyCode_New(13, 0, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__62, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_compute_pr, 248, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(0, 248, __pyx_L1_error)
+  __pyx_tuple__63 = PyTuple_Pack(2, __pyx_float_1eneg_12, Py_None); if (unlikely(!__pyx_tuple__63)) __PYX_ERR(0, 248, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__63);
+  __Pyx_GIVEREF(__pyx_tuple__63);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":306
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double pphi_eqn(             # <<<<<<<<<<<<<<
  *     double pphi_sol,
  *     double r,
  */
-  __pyx_tuple__56 = PyTuple_Pack(13, __pyx_n_s_pphi_sol, __pyx_n_s_r, __pyx_n_s_pr, __pyx_n_s_dpr_dr, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_params, __pyx_n_s_q, __pyx_n_s_p); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(0, 306, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__56);
-  __Pyx_GIVEREF(__pyx_tuple__56);
-  __pyx_codeobj__15 = (PyObject*)__Pyx_PyCode_New(13, 0, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__56, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_pphi_eqn, 306, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__15)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __pyx_tuple__64 = PyTuple_Pack(13, __pyx_n_s_pphi_sol, __pyx_n_s_r, __pyx_n_s_pr, __pyx_n_s_dpr_dr, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_params, __pyx_n_s_q, __pyx_n_s_p); if (unlikely(!__pyx_tuple__64)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__64);
+  __Pyx_GIVEREF(__pyx_tuple__64);
+  __pyx_codeobj__17 = (PyObject*)__Pyx_PyCode_New(13, 0, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__64, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_pphi_eqn, 306, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__17)) __PYX_ERR(0, 306, __pyx_L1_error)
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":351
  *     return result
  * 
  * cpdef double pphi_eqn_wrapper(pphi_sol,args):             # <<<<<<<<<<<<<<
  *     return pphi_eqn(pphi_sol,*args)
  * 
  */
-  __pyx_tuple__57 = PyTuple_Pack(2, __pyx_n_s_pphi_sol, __pyx_n_s_args); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 351, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__57);
-  __Pyx_GIVEREF(__pyx_tuple__57);
-  __pyx_codeobj__58 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__57, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_pphi_eqn_wrapper, 351, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__58)) __PYX_ERR(0, 351, __pyx_L1_error)
+  __pyx_tuple__65 = PyTuple_Pack(2, __pyx_n_s_pphi_sol, __pyx_n_s_args); if (unlikely(!__pyx_tuple__65)) __PYX_ERR(0, 351, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__65);
+  __Pyx_GIVEREF(__pyx_tuple__65);
+  __pyx_codeobj__66 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__65, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_pphi_eqn_wrapper, 351, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__66)) __PYX_ERR(0, 351, __pyx_L1_error)
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":356
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef compute_pphi(             # <<<<<<<<<<<<<<
  *     double[:] r,
  *     double[:] pr,
  */
-  __pyx_codeobj__16 = (PyObject*)__Pyx_PyCode_New(13, 0, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__54, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_compute_pphi, 356, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(0, 356, __pyx_L1_error)
-  __pyx_tuple__59 = PyTuple_Pack(2, __pyx_float_1eneg_12, Py_None); if (unlikely(!__pyx_tuple__59)) __PYX_ERR(0, 356, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__59);
-  __Pyx_GIVEREF(__pyx_tuple__59);
+  __pyx_codeobj__18 = (PyObject*)__Pyx_PyCode_New(13, 0, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__62, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_compute_pphi, 356, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__18)) __PYX_ERR(0, 356, __pyx_L1_error)
+  __pyx_tuple__67 = PyTuple_Pack(2, __pyx_float_1eneg_12, Py_None); if (unlikely(!__pyx_tuple__67)) __PYX_ERR(0, 356, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__67);
+  __Pyx_GIVEREF(__pyx_tuple__67);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":401
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef compute_postadiabatic_solution(             # <<<<<<<<<<<<<<
  *     double[:] r,
  *     double[:] pphi,
  */
-  __pyx_tuple__60 = PyTuple_Pack(13, __pyx_n_s_r, __pyx_n_s_pphi, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_q, __pyx_n_s_p, __pyx_n_s_tol, __pyx_n_s_order, __pyx_n_s_params); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 401, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__60);
-  __Pyx_GIVEREF(__pyx_tuple__60);
-  __pyx_codeobj__17 = (PyObject*)__Pyx_PyCode_New(13, 0, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__60, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_compute_postadiabatic_solution, 401, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__17)) __PYX_ERR(0, 401, __pyx_L1_error)
-  __pyx_tuple__61 = PyTuple_Pack(3, __pyx_float_1eneg_12, __pyx_int_8, Py_None); if (unlikely(!__pyx_tuple__61)) __PYX_ERR(0, 401, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__61);
-  __Pyx_GIVEREF(__pyx_tuple__61);
+  __pyx_tuple__68 = PyTuple_Pack(13, __pyx_n_s_r, __pyx_n_s_pphi, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_q, __pyx_n_s_p, __pyx_n_s_tol, __pyx_n_s_order, __pyx_n_s_params); if (unlikely(!__pyx_tuple__68)) __PYX_ERR(0, 401, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__68);
+  __Pyx_GIVEREF(__pyx_tuple__68);
+  __pyx_codeobj__19 = (PyObject*)__Pyx_PyCode_New(13, 0, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__68, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_compute_postadiabatic_solution, 401, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__19)) __PYX_ERR(0, 401, __pyx_L1_error)
+  __pyx_tuple__69 = PyTuple_Pack(3, __pyx_float_1eneg_12, __pyx_int_8, Py_None); if (unlikely(!__pyx_tuple__69)) __PYX_ERR(0, 401, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__69);
+  __Pyx_GIVEREF(__pyx_tuple__69);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":465
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef compute_postadiabatic_dynamics(             # <<<<<<<<<<<<<<
  *     double omega0,
  *     Hamiltonian_C H,
  */
-  __pyx_tuple__62 = PyTuple_Pack(10, __pyx_n_s_omega0, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_tol, __pyx_n_s_params, __pyx_n_s_order); if (unlikely(!__pyx_tuple__62)) __PYX_ERR(0, 465, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__62);
-  __Pyx_GIVEREF(__pyx_tuple__62);
-  __pyx_codeobj__18 = (PyObject*)__Pyx_PyCode_New(10, 0, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__62, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_compute_postadiabatic_dynamics, 465, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__18)) __PYX_ERR(0, 465, __pyx_L1_error)
-  __pyx_tuple__63 = PyTuple_Pack(3, __pyx_float_1eneg_12, Py_None, __pyx_int_8); if (unlikely(!__pyx_tuple__63)) __PYX_ERR(0, 465, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__63);
-  __Pyx_GIVEREF(__pyx_tuple__63);
+  __pyx_tuple__70 = PyTuple_Pack(10, __pyx_n_s_omega0, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_tol, __pyx_n_s_params, __pyx_n_s_order); if (unlikely(!__pyx_tuple__70)) __PYX_ERR(0, 465, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__70);
+  __Pyx_GIVEREF(__pyx_tuple__70);
+  __pyx_codeobj__20 = (PyObject*)__Pyx_PyCode_New(10, 0, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__70, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_compute_postadiabatic_dynamics, 465, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__20)) __PYX_ERR(0, 465, __pyx_L1_error)
+  __pyx_tuple__71 = PyTuple_Pack(3, __pyx_float_1eneg_12, Py_None, __pyx_int_8); if (unlikely(!__pyx_tuple__71)) __PYX_ERR(0, 465, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__71);
+  __Pyx_GIVEREF(__pyx_tuple__71);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":572
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef compute_combined_dynamics(             # <<<<<<<<<<<<<<
  *     double omega0,
  *     Hamiltonian_C H,
  */
-  __pyx_tuple__64 = PyTuple_Pack(13, __pyx_n_s_omega0, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_tol, __pyx_n_s_params, __pyx_n_s_step_back, __pyx_n_s_backend, __pyx_n_s_PA_order, __pyx_n_s_r_stop); if (unlikely(!__pyx_tuple__64)) __PYX_ERR(0, 572, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__64);
-  __Pyx_GIVEREF(__pyx_tuple__64);
-  __pyx_codeobj__19 = (PyObject*)__Pyx_PyCode_New(13, 0, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__64, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_compute_combined_dynamics, 572, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__19)) __PYX_ERR(0, 572, __pyx_L1_error)
-  __pyx_tuple__65 = PyTuple_Pack(6, __pyx_float_1eneg_12, Py_None, __pyx_float_50_0, __pyx_n_u_ode, __pyx_int_8, __pyx_float_neg_1_0); if (unlikely(!__pyx_tuple__65)) __PYX_ERR(0, 572, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__65);
-  __Pyx_GIVEREF(__pyx_tuple__65);
+  __pyx_tuple__72 = PyTuple_Pack(13, __pyx_n_s_omega0, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_tol, __pyx_n_s_params, __pyx_n_s_step_back, __pyx_n_s_backend, __pyx_n_s_PA_order, __pyx_n_s_r_stop); if (unlikely(!__pyx_tuple__72)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__72);
+  __Pyx_GIVEREF(__pyx_tuple__72);
+  __pyx_codeobj__21 = (PyObject*)__Pyx_PyCode_New(13, 0, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__72, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_compute_combined_dynamics, 572, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__21)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __pyx_tuple__73 = PyTuple_Pack(6, __pyx_float_1eneg_12, Py_None, __pyx_float_50_0, __pyx_n_u_ode, __pyx_int_8, __pyx_float_neg_1_0); if (unlikely(!__pyx_tuple__73)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__73);
+  __Pyx_GIVEREF(__pyx_tuple__73);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":648
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef cumulative_integral(             # <<<<<<<<<<<<<<
- *     double[:] x,
- *     double[:] y,
+ *     x: np.array,
+ *     y: np.array,
  */
-  __pyx_tuple__66 = PyTuple_Pack(3, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_order); if (unlikely(!__pyx_tuple__66)) __PYX_ERR(0, 648, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__66);
-  __Pyx_GIVEREF(__pyx_tuple__66);
-  __pyx_codeobj__25 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__66, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_cumulative_integral, 648, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 648, __pyx_L1_error)
-  __pyx_tuple__67 = PyTuple_Pack(1, __pyx_int_7); if (unlikely(!__pyx_tuple__67)) __PYX_ERR(0, 648, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__67);
-  __Pyx_GIVEREF(__pyx_tuple__67);
+  __pyx_tuple__74 = PyTuple_Pack(3, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_order); if (unlikely(!__pyx_tuple__74)) __PYX_ERR(0, 648, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__74);
+  __Pyx_GIVEREF(__pyx_tuple__74);
+  __pyx_codeobj__27 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__74, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_cumulative_integral, 648, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 648, __pyx_L1_error)
+  __pyx_tuple__75 = PyTuple_Pack(1, __pyx_int_7); if (unlikely(!__pyx_tuple__75)) __PYX_ERR(0, 648, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__75);
+  __Pyx_GIVEREF(__pyx_tuple__75);
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":706
  *     return integral
  * 
  * @cython.profile(True)             # <<<<<<<<<<<<<<
  * @cython.linetrace(True)
  * def univariate_spline_integral(
  */
-  __pyx_tuple__68 = PyTuple_Pack(5, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_y_x_interp, __pyx_n_s_y_x_integral, __pyx_n_s_integral); if (unlikely(!__pyx_tuple__68)) __PYX_ERR(0, 706, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__68);
-  __Pyx_GIVEREF(__pyx_tuple__68);
-  __pyx_codeobj__26 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__68, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_univariate_spline_integral, 706, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__26)) __PYX_ERR(0, 706, __pyx_L1_error)
+  __pyx_tuple__76 = PyTuple_Pack(5, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_y_x_interp, __pyx_n_s_y_x_integral, __pyx_n_s_integral); if (unlikely(!__pyx_tuple__76)) __PYX_ERR(0, 706, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__76);
+  __Pyx_GIVEREF(__pyx_tuple__76);
+  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__76, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_univariate_spline_integral, 706, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 706, __pyx_L1_error)
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":718
  *     return integral
  * 
  * @cython.profile(True)             # <<<<<<<<<<<<<<
  * @cython.linetrace(True)
  * def compute_adiabatic_parameter(
  */
-  __pyx_tuple__69 = PyTuple_Pack(17, __pyx_n_s_dynamics, __pyx_n_s_H, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_params, __pyx_n_s_omega, __pyx_n_s_dr_dt, __pyx_n_s_i, __pyx_n_s_q, __pyx_n_s_p, __pyx_n_s_dyn, __pyx_n_s_dH_dpr, __pyx_n_s_csi, __pyx_n_s_domega_dr, __pyx_n_s_adiabatic_param); if (unlikely(!__pyx_tuple__69)) __PYX_ERR(0, 718, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__69);
-  __Pyx_GIVEREF(__pyx_tuple__69);
-  __pyx_codeobj__28 = (PyObject*)__Pyx_PyCode_New(7, 0, 0, 17, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__69, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_compute_adiabatic_parameter, 718, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 718, __pyx_L1_error)
+  __pyx_tuple__77 = PyTuple_Pack(17, __pyx_n_s_dynamics, __pyx_n_s_H, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_params, __pyx_n_s_omega, __pyx_n_s_dr_dt, __pyx_n_s_i, __pyx_n_s_q, __pyx_n_s_p, __pyx_n_s_dyn, __pyx_n_s_dH_dpr, __pyx_n_s_csi, __pyx_n_s_domega_dr, __pyx_n_s_adiabatic_param); if (unlikely(!__pyx_tuple__77)) __PYX_ERR(0, 718, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__77);
+  __Pyx_GIVEREF(__pyx_tuple__77);
+  __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(7, 0, 0, 17, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__77, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_postadiaba, __pyx_n_s_compute_adiabatic_parameter, 718, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 718, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 /* #### Code section: init_constants ### */
@@ -34011,20 +33597,26 @@
   __pyx_float_neg_14_ = PyFloat_FromDouble(-14.); if (unlikely(!__pyx_float_neg_14_)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_3 = PyInt_FromLong(3); if (unlikely(!__pyx_int_3)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_4 = PyInt_FromLong(4); if (unlikely(!__pyx_int_4)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_5 = PyInt_FromLong(5); if (unlikely(!__pyx_int_5)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_int_6 = PyInt_FromLong(6); if (unlikely(!__pyx_int_6)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_7 = PyInt_FromLong(7); if (unlikely(!__pyx_int_7)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_8 = PyInt_FromLong(8); if (unlikely(!__pyx_int_8)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_int_9 = PyInt_FromLong(9); if (unlikely(!__pyx_int_9)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_112105877 = PyInt_FromLong(112105877L); if (unlikely(!__pyx_int_112105877)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_136983863 = PyInt_FromLong(136983863L); if (unlikely(!__pyx_int_136983863)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_184977713 = PyInt_FromLong(184977713L); if (unlikely(!__pyx_int_184977713)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_neg_1 = PyInt_FromLong(-1); if (unlikely(!__pyx_int_neg_1)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_int_neg_4 = PyInt_FromLong(-4); if (unlikely(!__pyx_int_neg_4)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_int_neg_6 = PyInt_FromLong(-6); if (unlikely(!__pyx_int_neg_6)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_int_neg_8 = PyInt_FromLong(-8); if (unlikely(!__pyx_int_neg_8)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __pyx_int_neg_9 = PyInt_FromLong(-9); if (unlikely(!__pyx_int_neg_9)) __PYX_ERR(0, 1, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 /* #### Code section: init_globals ### */
 
 static CYTHON_SMALL_CODE int __Pyx_InitGlobals(void) {
@@ -34072,16 +33664,16 @@
 static int __Pyx_modinit_function_export_code(void) {
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_function_export_code", 0);
   /*--- Function export code ---*/
-  if (__Pyx_ExportFunction("fin_diff_derivative", (void (*)(void))__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative, "PyObject *(__Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative *__pyx_optional_args)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  if (__Pyx_ExportFunction("cumulative_integral", (void (*)(void))__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral, "PyObject *(__Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral *__pyx_optional_args)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_ExportFunction("fin_diff_derivative", (void (*)(void))__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative, "PyObject *(PyObject *, PyObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative *__pyx_optional_args)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_ExportFunction("cumulative_integral", (void (*)(void))__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral, "PyObject *(PyObject *, PyObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral *__pyx_optional_args)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   if (__Pyx_ExportFunction("Kerr_ISCO", (void (*)(void))__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_Kerr_ISCO, "PyObject *(double, double, double, double, int __pyx_skip_dispatch)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   if (__Pyx_ExportFunction("compute_adiabatic_solution", (void (*)(void))__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_adiabatic_solution, "PyObject *(__Pyx_memviewslice, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, double, double, double, double, __Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_adiabatic_solution *__pyx_optional_args)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -34249,32 +33841,32 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(2, 8, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(2, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(2, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(2, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(2, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(2, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(2, 67, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(2, 23, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(2, 26, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(2, 29, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(2, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 6, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) __PYX_ERR(3, 6, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) __PYX_ERR(3, 6, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C)) __PYX_ERR(3, 6, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 10, __pyx_L1_error)
+  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(4, 10, __pyx_L1_error)
-  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(4, 10, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(4, 14, __pyx_L1_error)
-  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(4, 14, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(4, 15, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(4, 15, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(4, 25, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(4, 25, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -34614,33 +34206,33 @@
       /* "View.MemoryView":100
  * cdef object __pyx_collections_abc_Sequence "__pyx_collections_abc_Sequence"
  * try:
  *     if __import__("sys").version_info >= (3, 3):             # <<<<<<<<<<<<<<
  *         __pyx_collections_abc_Sequence = __import__("collections.abc").abc.Sequence
  *     else:
  */
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin___import__, __pyx_tuple__32, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 100, __pyx_L2_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin___import__, __pyx_tuple__40, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 100, __pyx_L2_error)
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_version_info); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 100, __pyx_L2_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = PyObject_RichCompare(__pyx_t_5, __pyx_tuple__33, Py_GE); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 100, __pyx_L2_error)
+      __pyx_t_4 = PyObject_RichCompare(__pyx_t_5, __pyx_tuple__41, Py_GE); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 100, __pyx_L2_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(1, 100, __pyx_L2_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       if (__pyx_t_6) {
 
         /* "View.MemoryView":101
  * try:
  *     if __import__("sys").version_info >= (3, 3):
  *         __pyx_collections_abc_Sequence = __import__("collections.abc").abc.Sequence             # <<<<<<<<<<<<<<
  *     else:
  *         __pyx_collections_abc_Sequence = __import__("collections").Sequence
  */
-        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin___import__, __pyx_tuple__34, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 101, __pyx_L2_error)
+        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin___import__, __pyx_tuple__42, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 101, __pyx_L2_error)
         __Pyx_GOTREF(__pyx_t_4);
         __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_abc); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 101, __pyx_L2_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_Sequence); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 101, __pyx_L2_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
@@ -34663,15 +34255,15 @@
  *         __pyx_collections_abc_Sequence = __import__("collections.abc").abc.Sequence
  *     else:
  *         __pyx_collections_abc_Sequence = __import__("collections").Sequence             # <<<<<<<<<<<<<<
  * except:
  * 
  */
       /*else*/ {
-        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin___import__, __pyx_tuple__35, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 103, __pyx_L2_error)
+        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin___import__, __pyx_tuple__43, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 103, __pyx_L2_error)
         __Pyx_GOTREF(__pyx_t_4);
         __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_Sequence); if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 103, __pyx_L2_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XGOTREF(__pyx_collections_abc_Sequence);
         __Pyx_DECREF_SET(__pyx_collections_abc_Sequence, __pyx_t_5);
         __Pyx_GIVEREF(__pyx_t_5);
@@ -34828,71 +34420,71 @@
   /* "View.MemoryView":309
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__36, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 309, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__44, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_XGOTREF(generic);
   __Pyx_DECREF_SET(generic, __pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_7);
   __pyx_t_7 = 0;
 
   /* "View.MemoryView":310
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__37, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 310, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 310, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_XGOTREF(strided);
   __Pyx_DECREF_SET(strided, __pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_7);
   __pyx_t_7 = 0;
 
   /* "View.MemoryView":311
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__38, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 311, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__46, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 311, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_XGOTREF(indirect);
   __Pyx_DECREF_SET(indirect, __pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_7);
   __pyx_t_7 = 0;
 
   /* "View.MemoryView":314
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__39, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 314, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__47, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 314, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_XGOTREF(contiguous);
   __Pyx_DECREF_SET(contiguous, __pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_7);
   __pyx_t_7 = 0;
 
   /* "View.MemoryView":315
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__40, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 315, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 315, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_XGOTREF(indirect_contiguous);
   __Pyx_DECREF_SET(indirect_contiguous, __pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_7);
   __pyx_t_7 = 0;
 
   /* "View.MemoryView":323
@@ -36590,99 +36182,105 @@
  */
 
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":81
  * @cython.linetrace(True)
  * @cython.cdivision(True)
  * cpdef fin_diff_derivative(             # <<<<<<<<<<<<<<
- *     double[:] x,
- *     double[:] y,
+ *     x: np.array,
+ *     y: np.array,
  */
 
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_1fin_diff_derivative, 0, __pyx_n_s_fin_diff_derivative, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__9)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 81, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 81, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_11, __pyx_tuple__44);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_fin_diff_derivative, __pyx_t_11) < 0) __PYX_ERR(0, 81, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_x, __pyx_kp_s_np_array) < 0) __PYX_ERR(0, 81, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_y, __pyx_kp_s_np_array) < 0) __PYX_ERR(0, 81, __pyx_L1_error)
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_1fin_diff_derivative, 0, __pyx_n_s_fin_diff_derivative, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__9)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 81, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_18, __pyx_tuple__52);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_18, __pyx_t_11);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_fin_diff_derivative, __pyx_t_18) < 0) __PYX_ERR(0, 81, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":120
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef Kerr_ISCO(             # <<<<<<<<<<<<<<
  *     double chi1,
  *     double chi2,
  */
 
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_3Kerr_ISCO, 0, __pyx_n_s_Kerr_ISCO, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__10)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 120, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Kerr_ISCO, __pyx_t_11) < 0) __PYX_ERR(0, 120, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_3Kerr_ISCO, 0, __pyx_n_s_Kerr_ISCO, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__12)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 120, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Kerr_ISCO, __pyx_t_18) < 0) __PYX_ERR(0, 120, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":142
  *     return np.array([r_ISCO,L_ISCO])
  * 
  * @cython.profile(True)             # <<<<<<<<<<<<<<
  * @cython.linetrace(True)
  * def Newtonian_j0(r):
  */
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_5Newtonian_j0, 0, __pyx_n_s_Newtonian_j0, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__11)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 142, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Newtonian_j0, __pyx_t_11) < 0) __PYX_ERR(0, 142, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_5Newtonian_j0, 0, __pyx_n_s_Newtonian_j0, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__13)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 142, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Newtonian_j0, __pyx_t_18) < 0) __PYX_ERR(0, 142, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":153
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double j0_eqn(double j0_sol, double r, Hamiltonian_C H, double chi_1, double chi_2, double m_1, double m_2,             # <<<<<<<<<<<<<<
  *             double[:] q, double[:] p):
  *     q[0] = r
  */
 
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_7j0_eqn, 0, __pyx_n_s_j0_eqn, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__12)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 153, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_j0_eqn, __pyx_t_11) < 0) __PYX_ERR(0, 153, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_7j0_eqn, 0, __pyx_n_s_j0_eqn, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__14)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 153, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_j0_eqn, __pyx_t_18) < 0) __PYX_ERR(0, 153, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":162
  *     return dH_dr
  * 
  * cpdef compute_adiabatic_solution(             # <<<<<<<<<<<<<<
  *     double[:] r,
  *     Hamiltonian_C H,
  */
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_9compute_adiabatic_solution, 0, __pyx_n_s_compute_adiabatic_solution, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__49)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 162, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_11, __pyx_tuple__50);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_adiabatic_solution, __pyx_t_11) < 0) __PYX_ERR(0, 162, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_9compute_adiabatic_solution, 0, __pyx_n_s_compute_adiabatic_solution, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__57)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 162, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_18, __pyx_tuple__58);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_adiabatic_solution, __pyx_t_18) < 0) __PYX_ERR(0, 162, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":198
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double pr_eqn(             # <<<<<<<<<<<<<<
  *     double pr_sol,
  *     double r,
  */
 
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_11pr_eqn, 0, __pyx_n_s_pr_eqn, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__13)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 198, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pr_eqn, __pyx_t_11) < 0) __PYX_ERR(0, 198, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_11pr_eqn, 0, __pyx_n_s_pr_eqn, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__15)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 198, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pr_eqn, __pyx_t_18) < 0) __PYX_ERR(0, 198, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":243
  *     return result
  * 
  * cpdef double pr_eqn_wrapper(pr_sol,args):             # <<<<<<<<<<<<<<
  *     return pr_eqn(pr_sol,*args)
  * 
  */
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_13pr_eqn_wrapper, 0, __pyx_n_s_pr_eqn_wrapper, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__53)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 243, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pr_eqn_wrapper, __pyx_t_11) < 0) __PYX_ERR(0, 243, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_13pr_eqn_wrapper, 0, __pyx_n_s_pr_eqn_wrapper, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__61)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 243, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pr_eqn_wrapper, __pyx_t_18) < 0) __PYX_ERR(0, 243, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":248
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef compute_pr(             # <<<<<<<<<<<<<<
  *     double[:] r,
  *     double[:] pr,
@@ -36692,44 +36290,44 @@
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":261
  *     double[::1] p,
  *     double tol=1e-12,
  *     EOBParams params=None,             # <<<<<<<<<<<<<<
  * ):
  *     """
  */
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_15compute_pr, 0, __pyx_n_s_compute_pr, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__14)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 248, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_11, __pyx_tuple__55);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_pr, __pyx_t_11) < 0) __PYX_ERR(0, 248, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_15compute_pr, 0, __pyx_n_s_compute_pr, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__16)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 248, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_18, __pyx_tuple__63);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_pr, __pyx_t_18) < 0) __PYX_ERR(0, 248, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":306
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double pphi_eqn(             # <<<<<<<<<<<<<<
  *     double pphi_sol,
  *     double r,
  */
 
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_17pphi_eqn, 0, __pyx_n_s_pphi_eqn, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__15)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 306, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pphi_eqn, __pyx_t_11) < 0) __PYX_ERR(0, 306, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_17pphi_eqn, 0, __pyx_n_s_pphi_eqn, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__17)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pphi_eqn, __pyx_t_18) < 0) __PYX_ERR(0, 306, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":351
  *     return result
  * 
  * cpdef double pphi_eqn_wrapper(pphi_sol,args):             # <<<<<<<<<<<<<<
  *     return pphi_eqn(pphi_sol,*args)
  * 
  */
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_19pphi_eqn_wrapper, 0, __pyx_n_s_pphi_eqn_wrapper, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__58)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 351, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pphi_eqn_wrapper, __pyx_t_11) < 0) __PYX_ERR(0, 351, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_19pphi_eqn_wrapper, 0, __pyx_n_s_pphi_eqn_wrapper, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__66)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 351, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pphi_eqn_wrapper, __pyx_t_18) < 0) __PYX_ERR(0, 351, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":356
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef compute_pphi(             # <<<<<<<<<<<<<<
  *     double[:] r,
  *     double[:] pr,
@@ -36739,19 +36337,19 @@
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":369
  *     double[::1] p,
  *     double tol=1e-12,
  *     EOBParams params=None             # <<<<<<<<<<<<<<
  * ):
  *     """
  */
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_21compute_pphi, 0, __pyx_n_s_compute_pphi, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__16)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 356, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_11, __pyx_tuple__59);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_pphi, __pyx_t_11) < 0) __PYX_ERR(0, 356, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_21compute_pphi, 0, __pyx_n_s_compute_pphi, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__18)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 356, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_18, __pyx_tuple__67);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_pphi, __pyx_t_18) < 0) __PYX_ERR(0, 356, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":401
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef compute_postadiabatic_solution(             # <<<<<<<<<<<<<<
  *     double[:] r,
  *     double[:] pphi,
@@ -36761,19 +36359,19 @@
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":414
  *     double tol=1e-12,
  *     int order=8,
  *     EOBParams params=None,             # <<<<<<<<<<<<<<
  * ):
  *     """
  */
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_23compute_postadiabatic_solution, 0, __pyx_n_s_compute_postadiabatic_solution, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__17)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 401, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_11, __pyx_tuple__61);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_postadiabatic_solution, __pyx_t_11) < 0) __PYX_ERR(0, 401, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_23compute_postadiabatic_solution, 0, __pyx_n_s_compute_postadiabatic_solution, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__19)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 401, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_18, __pyx_tuple__69);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_postadiabatic_solution, __pyx_t_18) < 0) __PYX_ERR(0, 401, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":465
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef compute_postadiabatic_dynamics(             # <<<<<<<<<<<<<<
  *     double omega0,
  *     Hamiltonian_C H,
@@ -36783,19 +36381,19 @@
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":474
  *     double m_2,
  *     double tol=1e-12,
  *     EOBParams params=None,             # <<<<<<<<<<<<<<
  *     order=8
  * ):
  */
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_25compute_postadiabatic_dynamics, 0, __pyx_n_s_compute_postadiabatic_dynamics, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__18)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 465, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_11, __pyx_tuple__63);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_postadiabatic_dynamics, __pyx_t_11) < 0) __PYX_ERR(0, 465, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_25compute_postadiabatic_dynamics, 0, __pyx_n_s_compute_postadiabatic_dynamics, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__20)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 465, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_18, __pyx_tuple__71);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_postadiabatic_dynamics, __pyx_t_18) < 0) __PYX_ERR(0, 465, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":572
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef compute_combined_dynamics(             # <<<<<<<<<<<<<<
  *     double omega0,
  *     Hamiltonian_C H,
@@ -36805,31 +36403,37 @@
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":581
  *     double m_2,
  *     double tol=1e-12,
  *     EOBParams params=None,             # <<<<<<<<<<<<<<
  *     double step_back=50,
  *     str backend="ode",
  */
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_27compute_combined_dynamics, 0, __pyx_n_s_compute_combined_dynamics, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__19)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 572, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_11);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_11, __pyx_tuple__65);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_combined_dynamics, __pyx_t_11) < 0) __PYX_ERR(0, 572, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_27compute_combined_dynamics, 0, __pyx_n_s_compute_combined_dynamics, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__21)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 572, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_18, __pyx_tuple__73);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_combined_dynamics, __pyx_t_18) < 0) __PYX_ERR(0, 572, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":648
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef cumulative_integral(             # <<<<<<<<<<<<<<
- *     double[:] x,
- *     double[:] y,
+ *     x: np.array,
+ *     y: np.array,
  */
 
-  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_29cumulative_integral, 0, __pyx_n_s_cumulative_integral, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__25)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 648, __pyx_L1_error)
+  __pyx_t_18 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 648, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_18);
+  if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_x, __pyx_kp_s_np_array) < 0) __PYX_ERR(0, 648, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_y, __pyx_kp_s_np_array) < 0) __PYX_ERR(0, 648, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_29cumulative_integral, 0, __pyx_n_s_cumulative_integral, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__27)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 648, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_11, __pyx_tuple__67);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_11, __pyx_tuple__75);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_11, __pyx_t_18);
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_cumulative_integral, __pyx_t_11) < 0) __PYX_ERR(0, 648, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":706
  *     return integral
  * 
  * @cython.profile(True)             # <<<<<<<<<<<<<<
@@ -36837,29 +36441,29 @@
  * def univariate_spline_integral(
  */
   __pyx_t_11 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 706, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_x, __pyx_kp_s_np_array) < 0) __PYX_ERR(0, 706, __pyx_L1_error)
   if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_y, __pyx_kp_s_np_array) < 0) __PYX_ERR(0, 706, __pyx_L1_error)
   if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_return, __pyx_kp_s_np_array) < 0) __PYX_ERR(0, 706, __pyx_L1_error)
-  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_31univariate_spline_integral, 0, __pyx_n_s_univariate_spline_integral, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__26)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 706, __pyx_L1_error)
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_31univariate_spline_integral, 0, __pyx_n_s_univariate_spline_integral, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__34)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 706, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_18);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_18, __pyx_t_11);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_univariate_spline_integral, __pyx_t_18) < 0) __PYX_ERR(0, 706, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":718
  *     return integral
  * 
  * @cython.profile(True)             # <<<<<<<<<<<<<<
  * @cython.linetrace(True)
  * def compute_adiabatic_parameter(
  */
-  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_33compute_adiabatic_parameter, 0, __pyx_n_s_compute_adiabatic_parameter, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__28)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 718, __pyx_L1_error)
+  __pyx_t_18 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_15postadiabatic_C_33compute_adiabatic_parameter, 0, __pyx_n_s_compute_adiabatic_parameter, NULL, __pyx_n_s_pyseobnr_eob_dynamics_postadiaba_2, __pyx_d, ((PyObject *)__pyx_codeobj__36)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 718, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_18);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_adiabatic_parameter, __pyx_t_18) < 0) __PYX_ERR(0, 718, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C.pyx":1
  * # cython: language_level=3             # <<<<<<<<<<<<<<
  * 
@@ -39457,18 +39061,116 @@
     Py_XDECREF(py_srcfile);
     Py_XDECREF(py_funcname);
 #endif
     return py_code;
 }
 #endif
 
-/* BufferIndexError */
-static void __Pyx_RaiseBufferIndexError(int axis) {
-  PyErr_Format(PyExc_IndexError,
-     "Out of bounds on buffer access (axis %d)", axis);
+/* SliceObject */
+static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(PyObject* obj,
+        Py_ssize_t cstart, Py_ssize_t cstop,
+        PyObject** _py_start, PyObject** _py_stop, PyObject** _py_slice,
+        int has_cstart, int has_cstop, int wraparound) {
+    __Pyx_TypeName obj_type_name;
+#if CYTHON_USE_TYPE_SLOTS
+    PyMappingMethods* mp;
+#if PY_MAJOR_VERSION < 3
+    PySequenceMethods* ms = Py_TYPE(obj)->tp_as_sequence;
+    if (likely(ms && ms->sq_slice)) {
+        if (!has_cstart) {
+            if (_py_start && (*_py_start != Py_None)) {
+                cstart = __Pyx_PyIndex_AsSsize_t(*_py_start);
+                if ((cstart == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
+            } else
+                cstart = 0;
+        }
+        if (!has_cstop) {
+            if (_py_stop && (*_py_stop != Py_None)) {
+                cstop = __Pyx_PyIndex_AsSsize_t(*_py_stop);
+                if ((cstop == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
+            } else
+                cstop = PY_SSIZE_T_MAX;
+        }
+        if (wraparound && unlikely((cstart < 0) | (cstop < 0)) && likely(ms->sq_length)) {
+            Py_ssize_t l = ms->sq_length(obj);
+            if (likely(l >= 0)) {
+                if (cstop < 0) {
+                    cstop += l;
+                    if (cstop < 0) cstop = 0;
+                }
+                if (cstart < 0) {
+                    cstart += l;
+                    if (cstart < 0) cstart = 0;
+                }
+            } else {
+                if (!PyErr_ExceptionMatches(PyExc_OverflowError))
+                    goto bad;
+                PyErr_Clear();
+            }
+        }
+        return ms->sq_slice(obj, cstart, cstop);
+    }
+#else
+    CYTHON_UNUSED_VAR(wraparound);
+#endif
+    mp = Py_TYPE(obj)->tp_as_mapping;
+    if (likely(mp && mp->mp_subscript))
+#else
+    CYTHON_UNUSED_VAR(wraparound);
+#endif
+    {
+        PyObject* result;
+        PyObject *py_slice, *py_start, *py_stop;
+        if (_py_slice) {
+            py_slice = *_py_slice;
+        } else {
+            PyObject* owned_start = NULL;
+            PyObject* owned_stop = NULL;
+            if (_py_start) {
+                py_start = *_py_start;
+            } else {
+                if (has_cstart) {
+                    owned_start = py_start = PyInt_FromSsize_t(cstart);
+                    if (unlikely(!py_start)) goto bad;
+                } else
+                    py_start = Py_None;
+            }
+            if (_py_stop) {
+                py_stop = *_py_stop;
+            } else {
+                if (has_cstop) {
+                    owned_stop = py_stop = PyInt_FromSsize_t(cstop);
+                    if (unlikely(!py_stop)) {
+                        Py_XDECREF(owned_start);
+                        goto bad;
+                    }
+                } else
+                    py_stop = Py_None;
+            }
+            py_slice = PySlice_New(py_start, py_stop, Py_None);
+            Py_XDECREF(owned_start);
+            Py_XDECREF(owned_stop);
+            if (unlikely(!py_slice)) goto bad;
+        }
+#if CYTHON_USE_TYPE_SLOTS
+        result = mp->mp_subscript(obj, py_slice);
+#else
+        result = PyObject_GetItem(obj, py_slice);
+#endif
+        if (!_py_slice) {
+            Py_DECREF(py_slice);
+        }
+        return result;
+    }
+    obj_type_name = __Pyx_PyType_GetName(Py_TYPE(obj));
+    PyErr_Format(PyExc_TypeError,
+        "'" __Pyx_FMT_TYPENAME "' object is unsliceable", obj_type_name);
+    __Pyx_DECREF_TypeName(obj_type_name);
+bad:
+    return NULL;
 }
 
 /* PyIntBinop */
 #if !CYTHON_COMPILING_IN_PYPY
 static PyObject* __Pyx_PyInt_AddCObj(PyObject *op1, PyObject *op2, long intval, int inplace, int zerodivision_check) {
     CYTHON_MAYBE_UNUSED_VAR(intval);
     CYTHON_MAYBE_UNUSED_VAR(inplace);
@@ -40009,14 +39711,20 @@
             PyFPE_END_PROTECT(result)
             return PyFloat_FromDouble(result);
     }
     return (inplace ? PyNumber_InPlaceSubtract : PyNumber_Subtract)(op1, op2);
 }
 #endif
 
+/* BufferIndexError */
+static void __Pyx_RaiseBufferIndexError(int axis) {
+  PyErr_Format(PyExc_IndexError,
+     "Out of bounds on buffer access (axis %d)", axis);
+}
+
 /* ModInt[long] */
 static CYTHON_INLINE long __Pyx_mod_long(long a, long b) {
     long r = a % b;
     r += ((r != 0) & ((r ^ b) < 0)) * b;
     return r;
 }
 
@@ -40041,118 +39749,14 @@
         Py_DECREF(retval);
         __Pyx_RaiseTooManyValuesError(expected);
         return -1;
     }
     return __Pyx_IterFinish();
 }
 
-/* SliceObject */
-static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(PyObject* obj,
-        Py_ssize_t cstart, Py_ssize_t cstop,
-        PyObject** _py_start, PyObject** _py_stop, PyObject** _py_slice,
-        int has_cstart, int has_cstop, int wraparound) {
-    __Pyx_TypeName obj_type_name;
-#if CYTHON_USE_TYPE_SLOTS
-    PyMappingMethods* mp;
-#if PY_MAJOR_VERSION < 3
-    PySequenceMethods* ms = Py_TYPE(obj)->tp_as_sequence;
-    if (likely(ms && ms->sq_slice)) {
-        if (!has_cstart) {
-            if (_py_start && (*_py_start != Py_None)) {
-                cstart = __Pyx_PyIndex_AsSsize_t(*_py_start);
-                if ((cstart == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
-            } else
-                cstart = 0;
-        }
-        if (!has_cstop) {
-            if (_py_stop && (*_py_stop != Py_None)) {
-                cstop = __Pyx_PyIndex_AsSsize_t(*_py_stop);
-                if ((cstop == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
-            } else
-                cstop = PY_SSIZE_T_MAX;
-        }
-        if (wraparound && unlikely((cstart < 0) | (cstop < 0)) && likely(ms->sq_length)) {
-            Py_ssize_t l = ms->sq_length(obj);
-            if (likely(l >= 0)) {
-                if (cstop < 0) {
-                    cstop += l;
-                    if (cstop < 0) cstop = 0;
-                }
-                if (cstart < 0) {
-                    cstart += l;
-                    if (cstart < 0) cstart = 0;
-                }
-            } else {
-                if (!PyErr_ExceptionMatches(PyExc_OverflowError))
-                    goto bad;
-                PyErr_Clear();
-            }
-        }
-        return ms->sq_slice(obj, cstart, cstop);
-    }
-#else
-    CYTHON_UNUSED_VAR(wraparound);
-#endif
-    mp = Py_TYPE(obj)->tp_as_mapping;
-    if (likely(mp && mp->mp_subscript))
-#else
-    CYTHON_UNUSED_VAR(wraparound);
-#endif
-    {
-        PyObject* result;
-        PyObject *py_slice, *py_start, *py_stop;
-        if (_py_slice) {
-            py_slice = *_py_slice;
-        } else {
-            PyObject* owned_start = NULL;
-            PyObject* owned_stop = NULL;
-            if (_py_start) {
-                py_start = *_py_start;
-            } else {
-                if (has_cstart) {
-                    owned_start = py_start = PyInt_FromSsize_t(cstart);
-                    if (unlikely(!py_start)) goto bad;
-                } else
-                    py_start = Py_None;
-            }
-            if (_py_stop) {
-                py_stop = *_py_stop;
-            } else {
-                if (has_cstop) {
-                    owned_stop = py_stop = PyInt_FromSsize_t(cstop);
-                    if (unlikely(!py_stop)) {
-                        Py_XDECREF(owned_start);
-                        goto bad;
-                    }
-                } else
-                    py_stop = Py_None;
-            }
-            py_slice = PySlice_New(py_start, py_stop, Py_None);
-            Py_XDECREF(owned_start);
-            Py_XDECREF(owned_stop);
-            if (unlikely(!py_slice)) goto bad;
-        }
-#if CYTHON_USE_TYPE_SLOTS
-        result = mp->mp_subscript(obj, py_slice);
-#else
-        result = PyObject_GetItem(obj, py_slice);
-#endif
-        if (!_py_slice) {
-            Py_DECREF(py_slice);
-        }
-        return result;
-    }
-    obj_type_name = __Pyx_PyType_GetName(Py_TYPE(obj));
-    PyErr_Format(PyExc_TypeError,
-        "'" __Pyx_FMT_TYPENAME "' object is unsliceable", obj_type_name);
-    __Pyx_DECREF_TypeName(obj_type_name);
-bad:
-    return NULL;
-}
-
 /* PyIntCompare */
 static CYTHON_INLINE int __Pyx_PyInt_BoolEqObjC(PyObject *op1, PyObject *op2, long intval, long inplace) {
     CYTHON_MAYBE_UNUSED_VAR(intval);
     CYTHON_UNUSED_VAR(inplace);
     if (op1 == op2) {
         return 1;
     }
@@ -40968,18 +40572,18 @@
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
 }
 #endif
 
 /* TypeImport */
-#ifndef __PYX_HAVE_RT_ImportType_3_0_8
-#define __PYX_HAVE_RT_ImportType_3_0_8
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size)
+#ifndef __PYX_HAVE_RT_ImportType_3_0_10
+#define __PYX_HAVE_RT_ImportType_3_0_10
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject *module, const char *module_name, const char *class_name,
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
     Py_ssize_t itemsize;
 #if CYTHON_COMPILING_IN_LIMITED_API
     PyObject *py_basicsize;
@@ -41025,23 +40629,23 @@
     if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize+itemsize);
         goto bad;
     }
-    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_8 &&
+    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_10 &&
             ((size_t)basicsize > size || (size_t)(basicsize + itemsize) < size)) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd-%zd from PyObject",
             module_name, class_name, size, basicsize, basicsize+itemsize);
         goto bad;
     }
-    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_8 && (size_t)basicsize > size) {
+    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_10 && (size_t)basicsize > size) {
         PyOS_snprintf(warning, sizeof(warning),
             "%s.%s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
     }
     return (PyTypeObject *)result;
@@ -42033,15 +41637,15 @@
         break;
     case 0:
         self = ((PyCFunctionObject*)cyfunc)->m_self;
         break;
     default:
         return NULL;
     }
-    return ((_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
+    return ((__Pyx_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
 }
 static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS_METHOD(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
 {
     __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
     PyMethodDef* def = ((PyCFunctionObject*)cyfunc)->m_ml;
     PyTypeObject *cls = (PyTypeObject *) __Pyx_CyFunction_GetClassObj(cyfunc);
 #if CYTHON_BACKPORT_VECTORCALL
@@ -42626,14 +42230,36 @@
 {
     void *start1, *end1, *start2, *end2;
     __pyx_get_array_memory_extents(slice1, &start1, &end1, ndim, itemsize);
     __pyx_get_array_memory_extents(slice2, &start2, &end2, ndim, itemsize);
     return (start1 < end2) && (start2 < end1);
 }
 
+/* CIntFromPyVerify */
+#define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
+    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
+#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
+    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
+#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
+    {\
+        func_type value = func_value;\
+        if (sizeof(target_type) < sizeof(func_type)) {\
+            if (unlikely(value != (func_type) (target_type) value)) {\
+                func_type zero = 0;\
+                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
+                    return (target_type) -1;\
+                if (is_unsigned && unlikely(value < zero))\
+                    goto raise_neg_overflow;\
+                else\
+                    goto raise_overflow;\
+            }\
+        }\
+        return (target_type) value;\
+    }
+
 /* IsLittleEndian */
 static CYTHON_INLINE int __Pyx_Is_Little_Endian(void)
 {
   union {
     uint32_t u32;
     uint8_t u8[4];
   } S;
@@ -43393,36 +43019,14 @@
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
-/* CIntFromPyVerify */
-  #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
-    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
-#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
-    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
-#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
-    {\
-        func_type value = func_value;\
-        if (sizeof(target_type) < sizeof(func_type)) {\
-            if (unlikely(value != (func_type) (target_type) value)) {\
-                func_type zero = 0;\
-                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
-                    return (target_type) -1;\
-                if (is_unsigned && unlikely(value < zero))\
-                    goto raise_neg_overflow;\
-                else\
-                    goto raise_overflow;\
-            }\
-        }\
-        return (target_type) value;\
-    }
-
 /* ObjectToMemviewSlice */
   static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dc_double(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
     int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_CONTIG) };
     int retcode;
     if (obj == Py_None) {
@@ -43438,26 +43042,14 @@
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
-/* MemviewDtypeToObject */
-  static CYTHON_INLINE PyObject *__pyx_memview_get_double(const char *itemp) {
-    return (PyObject *) PyFloat_FromDouble(*(double *) itemp);
-}
-static CYTHON_INLINE int __pyx_memview_set_double(const char *itemp, PyObject *obj) {
-    double value = __pyx_PyFloat_AsDouble(obj);
-    if (unlikely((value == (double)-1) && PyErr_Occurred()))
-        return 0;
-    *(double *) itemp = value;
-    return 1;
-}
-
 /* FromPyCTupleUtility */
   #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
 static void __Pyx_tuple___pyx_convert__from_py___pyx_ctuple_double__and_double__and_double__and_double(PyObject * o, __pyx_ctuple_double__and_double__and_double__and_double *result) {
         result->f0 = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(o, 0));
         if ((result->f0 == (double)-1) && PyErr_Occurred()) goto bad;
         result->f1 = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(o, 1));
         if ((result->f1 == (double)-1) && PyErr_Occurred()) goto bad;
@@ -43529,14 +43121,26 @@
     #endif
     {
         __Pyx_seq___pyx_convert__from_py___pyx_ctuple_double__and_double__and_double__and_double(o, &result);
     }
     return result;
 }
 
+/* MemviewDtypeToObject */
+  static CYTHON_INLINE PyObject *__pyx_memview_get_double(const char *itemp) {
+    return (PyObject *) PyFloat_FromDouble(*(double *) itemp);
+}
+static CYTHON_INLINE int __pyx_memview_set_double(const char *itemp, PyObject *obj) {
+    double value = __pyx_PyFloat_AsDouble(obj);
+    if (unlikely((value == (double)-1) && PyErr_Occurred()))
+        return 0;
+    *(double *) itemp = value;
+    return 1;
+}
+
 /* Declarations */
   #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
   #ifdef __cplusplus
     static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
       return ::std::complex< double >(x, y);
     }
   #else
@@ -44159,55 +43763,55 @@
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to int");
     return (int) -1;
 }
 
 /* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
-    const int neg_one = (int) -1, const_zero = (int) 0;
+    const long neg_one = (long) -1, const_zero = (long) 0;
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic pop
 #endif
     const int is_unsigned = neg_one > const_zero;
     if (is_unsigned) {
-        if (sizeof(int) < sizeof(long)) {
+        if (sizeof(long) < sizeof(long)) {
             return PyInt_FromLong((long) value);
-        } else if (sizeof(int) <= sizeof(unsigned long)) {
+        } else if (sizeof(long) <= sizeof(unsigned long)) {
             return PyLong_FromUnsignedLong((unsigned long) value);
 #ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
+        } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
             return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
 #endif
         }
     } else {
-        if (sizeof(int) <= sizeof(long)) {
+        if (sizeof(long) <= sizeof(long)) {
             return PyInt_FromLong((long) value);
 #ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
+        } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
             return PyLong_FromLongLong((PY_LONG_LONG) value);
 #endif
         }
     }
     {
         int one = 1; int little = (int)*(unsigned char *)&one;
         unsigned char *bytes = (unsigned char *)&value;
 #if !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030d0000
-        return _PyLong_FromByteArray(bytes, sizeof(int),
+        return _PyLong_FromByteArray(bytes, sizeof(long),
                                      little, !is_unsigned);
 #else
         PyObject *from_bytes, *result = NULL;
         PyObject *py_bytes = NULL, *arg_tuple = NULL, *kwds = NULL, *order_str = NULL;
         from_bytes = PyObject_GetAttrString((PyObject*)&PyLong_Type, "from_bytes");
         if (!from_bytes) return NULL;
-        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(int));
+        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(long));
         if (!py_bytes) goto limited_bad;
         order_str = PyUnicode_FromString(little ? "little" : "big");
         if (!order_str) goto limited_bad;
         arg_tuple = PyTuple_Pack(2, py_bytes, order_str);
         if (!arg_tuple) goto limited_bad;
         if (!is_unsigned) {
             kwds = PyDict_New();
@@ -44223,55 +43827,55 @@
         Py_XDECREF(from_bytes);
         return result;
 #endif
     }
 }
 
 /* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
-    const long neg_one = (long) -1, const_zero = (long) 0;
+    const int neg_one = (int) -1, const_zero = (int) 0;
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic pop
 #endif
     const int is_unsigned = neg_one > const_zero;
     if (is_unsigned) {
-        if (sizeof(long) < sizeof(long)) {
+        if (sizeof(int) < sizeof(long)) {
             return PyInt_FromLong((long) value);
-        } else if (sizeof(long) <= sizeof(unsigned long)) {
+        } else if (sizeof(int) <= sizeof(unsigned long)) {
             return PyLong_FromUnsignedLong((unsigned long) value);
 #ifdef HAVE_LONG_LONG
-        } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
+        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
             return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
 #endif
         }
     } else {
-        if (sizeof(long) <= sizeof(long)) {
+        if (sizeof(int) <= sizeof(long)) {
             return PyInt_FromLong((long) value);
 #ifdef HAVE_LONG_LONG
-        } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
+        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
             return PyLong_FromLongLong((PY_LONG_LONG) value);
 #endif
         }
     }
     {
         int one = 1; int little = (int)*(unsigned char *)&one;
         unsigned char *bytes = (unsigned char *)&value;
 #if !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030d0000
-        return _PyLong_FromByteArray(bytes, sizeof(long),
+        return _PyLong_FromByteArray(bytes, sizeof(int),
                                      little, !is_unsigned);
 #else
         PyObject *from_bytes, *result = NULL;
         PyObject *py_bytes = NULL, *arg_tuple = NULL, *kwds = NULL, *order_str = NULL;
         from_bytes = PyObject_GetAttrString((PyObject*)&PyLong_Type, "from_bytes");
         if (!from_bytes) return NULL;
-        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(long));
+        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(int));
         if (!py_bytes) goto limited_bad;
         order_str = PyUnicode_FromString(little ? "little" : "big");
         if (!order_str) goto limited_bad;
         arg_tuple = PyTuple_Pack(2, py_bytes, order_str);
         if (!arg_tuple) goto limited_bad;
         if (!is_unsigned) {
             kwds = PyDict_New();
@@ -44842,15 +44446,15 @@
 __Pyx_PyType_GetName(PyTypeObject* tp)
 {
     PyObject *name = __Pyx_PyObject_GetAttrStr((PyObject *)tp,
                                                __pyx_n_s_name_2);
     if (unlikely(name == NULL) || unlikely(!PyUnicode_Check(name))) {
         PyErr_Clear();
         Py_XDECREF(name);
-        name = __Pyx_NewRef(__pyx_n_s__70);
+        name = __Pyx_NewRef(__pyx_n_s__78);
     }
     return name;
 }
 #endif
 
 /* CheckBinaryVersion */
   static unsigned long __Pyx_get_runtime_version(void) {
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/postadiabatic_C.pxd` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/postadiabatic_C.pxd`

 * *Files 22% similar despite different names*

```diff
@@ -1,20 +1,20 @@
 # cython: language_level=3
 
 from pyseobnr.eob.hamiltonian.Hamiltonian_C cimport Hamiltonian_C
 
 cpdef fin_diff_derivative(
-    double[:] x,
-    double[:] y,
+    x: np.array,
+    y: np.array,
     int n=?,
 )
 
 cpdef cumulative_integral(
-    double[:] x,
-    double[:] y,
+    x: np.array,
+    y: np.array,
     int order=?,
 )
 
 cpdef Kerr_ISCO(
     double chi1,
     double chi2,
     double m1,
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/postadiabatic_C.pyx` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/postadiabatic_C.pyx`

 * *Files 1% similar despite different names*

```diff
@@ -75,16 +75,16 @@
     total/=h
     return total
 
 @cython.profile(True)
 @cython.linetrace(True)
 @cython.cdivision(True)
 cpdef fin_diff_derivative(
-    double[:] x,
-    double[:] y,
+    x: np.array,
+    y: np.array,
     int n=8,
 ):
     """
     Compute 8th order finite difference derivative,
     assuming an equally spaced grid. Correctly uses
     asymmetric stencils at the end points.
     """
@@ -642,16 +642,16 @@
 
     return combined_dynamics, ode_dynamics_high
 
 
 @cython.profile(True)
 @cython.linetrace(True)
 cpdef cumulative_integral(
-    double[:] x,
-    double[:] y,
+    x: np.array,
+    y: np.array,
     int order=7,
 ):
     """
     Compute a cumulative integral numerically using sampled data
     to a given order in accuracy. Assumes an equally spaced grid
     """
     cdef double h = x[1] - x[0]
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/postadiabatic_C_fast.c` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/postadiabatic_C_fast.c`

 * *Files 0% similar despite different names*

```diff
@@ -1,21 +1,21 @@
-/* Generated by Cython 3.0.8 */
+/* Generated by Cython 3.0.10 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include",
             "pyseobnr/eob/hamiltonian"
         ],
         "name": "pyseobnr.eob.dynamics.postadiabatic_C_fast",
         "sources": [
             "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx"
         ]
     },
@@ -43,18 +43,18 @@
     #error Cython requires Python 2.7+ or Python 3.3+.
 #else
 #if defined(CYTHON_LIMITED_API) && CYTHON_LIMITED_API
 #define __PYX_EXTRA_ABI_MODULE_NAME "limited"
 #else
 #define __PYX_EXTRA_ABI_MODULE_NAME ""
 #endif
-#define CYTHON_ABI "3_0_8" __PYX_EXTRA_ABI_MODULE_NAME
+#define CYTHON_ABI "3_0_10" __PYX_EXTRA_ABI_MODULE_NAME
 #define __PYX_ABI_MODULE_NAME "_cython_" CYTHON_ABI
 #define __PYX_TYPE_MODULE_PREFIX __PYX_ABI_MODULE_NAME "."
-#define CYTHON_HEX_VERSION 0x030008F0
+#define CYTHON_HEX_VERSION 0x03000AF0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(_WIN32) && !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -138,14 +138,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(PYPY_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #undef CYTHON_USE_TYPE_SLOTS
@@ -199,14 +201,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(CYTHON_LIMITED_API)
   #ifdef Py_LIMITED_API
     #undef __PYX_LIMITED_VERSION_HEX
     #define __PYX_LIMITED_VERSION_HEX Py_LIMITED_API
   #endif
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
@@ -260,60 +264,83 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(Py_GIL_DISABLED) || defined(Py_NOGIL)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_TYPE_SPECS
+    #define CYTHON_USE_TYPE_SPECS 0
+  #endif
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #ifndef CYTHON_USE_ASYNC_SLOTS
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_PYLONG_INTERNALS
+    #define CYTHON_USE_PYLONG_INTERNALS 0
+  #endif
   #undef CYTHON_USE_PYLIST_INTERNALS
   #define CYTHON_USE_PYLIST_INTERNALS 0
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
   #undef CYTHON_USE_UNICODE_WRITER
   #define CYTHON_USE_UNICODE_WRITER 0
-  #undef CYTHON_USE_PYLONG_INTERNALS
-  #define CYTHON_USE_PYLONG_INTERNALS 0
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
   #undef CYTHON_FAST_THREAD_STATE
   #define CYTHON_FAST_THREAD_STATE 0
+  #undef CYTHON_FAST_GIL
+  #define CYTHON_FAST_GIL 0
+  #ifndef CYTHON_METH_FASTCALL
+    #define CYTHON_METH_FASTCALL 1
+  #endif
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
+  #ifndef CYTHON_PEP487_INIT_SUBCLASS
+    #define CYTHON_PEP487_INIT_SUBCLASS 1
+  #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT 1
   #endif
+  #ifndef CYTHON_USE_MODULE_STATE
+    #define CYTHON_USE_MODULE_STATE 0
+  #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE 1
   #endif
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
@@ -396,14 +423,17 @@
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK 1
   #endif
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
   #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if !defined(CYTHON_VECTORCALL)
 #define CYTHON_VECTORCALL  (CYTHON_FAST_PYCCALL && PY_VERSION_HEX >= 0x030800B1)
 #endif
@@ -739,16 +769,21 @@
   #ifndef METH_FASTCALL
      #define METH_FASTCALL 0x80
   #endif
   typedef PyObject *(*__Pyx_PyCFunctionFast) (PyObject *self, PyObject *const *args, Py_ssize_t nargs);
   typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords) (PyObject *self, PyObject *const *args,
                                                           Py_ssize_t nargs, PyObject *kwnames);
 #else
-  #define __Pyx_PyCFunctionFast _PyCFunctionFast
-  #define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #if PY_VERSION_HEX >= 0x030d00A4
+  #  define __Pyx_PyCFunctionFast PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords PyCFunctionFastWithKeywords
+  #else
+  #  define __Pyx_PyCFunctionFast _PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #endif
 #endif
 #if CYTHON_METH_FASTCALL
   #define __Pyx_METH_FASTCALL METH_FASTCALL
   #define __Pyx_PyCFunction_FastCall __Pyx_PyCFunctionFast
   #define __Pyx_PyCFunction_FastCallWithKeywords __Pyx_PyCFunctionFastWithKeywords
 #else
   #define __Pyx_METH_FASTCALL METH_VARARGS
@@ -1092,15 +1127,15 @@
   #define __Pyx_PyList_SET_ITEM(o, i, v) PyList_SetItem(o, i, v)
   #define __Pyx_PyTuple_GET_SIZE(o) PyTuple_Size(o)
   #define __Pyx_PyList_GET_SIZE(o) PyList_Size(o)
   #define __Pyx_PySet_GET_SIZE(o) PySet_Size(o)
   #define __Pyx_PyBytes_GET_SIZE(o) PyBytes_Size(o)
   #define __Pyx_PyByteArray_GET_SIZE(o) PyByteArray_Size(o)
 #endif
-#if PY_VERSION_HEX >= 0x030d00A1
+#if __PYX_LIMITED_VERSION_HEX >= 0x030d00A1
   #define __Pyx_PyImport_AddModuleRef(name) PyImport_AddModuleRef(name)
 #else
   static CYTHON_INLINE PyObject *__Pyx_PyImport_AddModuleRef(const char *name) {
       PyObject *module = PyImport_AddModule(name);
       Py_XINCREF(module);
       return module;
   }
@@ -1179,15 +1214,15 @@
 #if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
 #define __Pyx_truncl trunc
 #else
 #define __Pyx_truncl truncl
 #endif
 
 #define __PYX_MARK_ERR_POS(f_index, lineno) \
-    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__; (void)__pyx_clineno; }
+    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__;  (void)__pyx_clineno; }
 #define __PYX_ERR(f_index, lineno, Ln_error) \
     { __PYX_MARK_ERR_POS(f_index, lineno) goto Ln_error; }
 
 #ifdef CYTHON_EXTERN_C
     #undef __PYX_EXTERN_C
     #define __PYX_EXTERN_C CYTHON_EXTERN_C
 #elif defined(__PYX_EXTERN_C)
@@ -1287,32 +1322,15 @@
 #define __Pyx_PyObject_AsSString(s)    ((const signed char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_AsUString(s)    ((const unsigned char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
 #define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
 #define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
 #define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
 #define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
-#if CYTHON_COMPILING_IN_LIMITED_API
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const wchar_t *u)
-{
-    const wchar_t *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#else
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
-{
-    const Py_UNICODE *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#endif
 #define __Pyx_PyUnicode_FromOrdinal(o)       PyUnicode_FromOrdinal((int)o)
-#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
-#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
 #define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
 #define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
 #define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
 static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
@@ -1678,44 +1696,44 @@
 struct __pyx_memoryviewslice_obj;
 struct __pyx_ctuple_double__and_double;
 typedef struct __pyx_ctuple_double__and_double __pyx_ctuple_double__and_double;
 
 /* "pyseobnr/eob/waveform/waveform.pxd":7
  *     const int ell_max
  * 
- * cpdef (double, double) RR_force(double[::1] q, double[::1] p, double omega, double omega_circ,             # <<<<<<<<<<<<<<
- *     double H, EOBParams eob_pars)
- * 
+ * cpdef (double, double) RR_force(             # <<<<<<<<<<<<<<
+ *     double[::1] q,
+ *     double[::1] p,
  */
 struct __pyx_ctuple_double__and_double {
   double f0;
   double f1;
 };
 struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative;
 struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral;
 struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_adiabatic_solution;
 
 /* "pyseobnr/eob/dynamics/postadiabatic_C.pxd":5
  * from pyseobnr.eob.hamiltonian.Hamiltonian_C cimport Hamiltonian_C
  * 
  * cpdef fin_diff_derivative(             # <<<<<<<<<<<<<<
- *     double[:] x,
- *     double[:] y,
+ *     x: np.array,
+ *     y: np.array,
  */
 struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative {
   int __pyx_n;
   int n;
 };
 
 /* "pyseobnr/eob/dynamics/postadiabatic_C.pxd":11
  * )
  * 
  * cpdef cumulative_integral(             # <<<<<<<<<<<<<<
- *     double[:] x,
- *     double[:] y,
+ *     x: np.array,
+ *     y: np.array,
  */
 struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral {
   int __pyx_n;
   int order;
 };
 
 /* "pyseobnr/eob/dynamics/postadiabatic_C.pxd":24
@@ -1924,32 +1942,33 @@
 struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C {
   PyObject_HEAD
   struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_vtab;
   struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *EOBpars;
 };
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":10
- *     double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":15
+ *     EOBParams eob_pars)
  * 
  * cdef class RadiationReactionForce:             # <<<<<<<<<<<<<<
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,
- *         double omega_circ, double H, EOBParams eob_pars)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce {
   PyObject_HEAD
   struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_vtab;
 };
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":14
- *         double omega_circ, double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":25
+ *         EOBParams eob_pars)
  * 
  * cdef class SEOBNRv5RRForce(RadiationReactionForce):             # <<<<<<<<<<<<<<
- *     cpdef (double,double) RR(self, double[::1] q,double[::1] p,double omega,double omega_circ,double H,EOBParams eob_par)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce {
   struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce __pyx_base;
 };
 
 
 /* "View.MemoryView":114
@@ -2060,33 +2079,34 @@
   PyObject *(*dynamics)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
   double (*omega)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
   PyObject *(*auxderivs)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch);
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":10
- *     double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":15
+ *     EOBParams eob_pars)
  * 
  * cdef class RadiationReactionForce:             # <<<<<<<<<<<<<<
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,
- *         double omega_circ, double H, EOBParams eob_pars)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 
 struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce {
   __pyx_ctuple_double__and_double (*RR)(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *, int __pyx_skip_dispatch);
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":14
- *         double omega_circ, double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":25
+ *         EOBParams eob_pars)
  * 
  * cdef class SEOBNRv5RRForce(RadiationReactionForce):             # <<<<<<<<<<<<<<
- *     cpdef (double,double) RR(self, double[::1] q,double[::1] p,double omega,double omega_circ,double H,EOBParams eob_par)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 
 struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce {
   struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce __pyx_base;
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce *__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce;
 
@@ -3036,30 +3056,30 @@
 
 /* SetupReduce.proto */
 #if !CYTHON_COMPILING_IN_LIMITED_API
 static int __Pyx_setup_reduce(PyObject* type_obj);
 #endif
 
 /* TypeImport.proto */
-#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_8
-#define __PYX_HAVE_RT_ImportType_proto_3_0_8
+#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_10
+#define __PYX_HAVE_RT_ImportType_proto_3_0_10
 #if defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L
 #include <stdalign.h>
 #endif
 #if (defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L) || __cplusplus >= 201103L
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) alignof(s)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) alignof(s)
 #else
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) sizeof(void*)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) sizeof(void*)
 #endif
-enum __Pyx_ImportType_CheckSize_3_0_8 {
-   __Pyx_ImportType_CheckSize_Error_3_0_8 = 0,
-   __Pyx_ImportType_CheckSize_Warn_3_0_8 = 1,
-   __Pyx_ImportType_CheckSize_Ignore_3_0_8 = 2
+enum __Pyx_ImportType_CheckSize_3_0_10 {
+   __Pyx_ImportType_CheckSize_Error_3_0_10 = 0,
+   __Pyx_ImportType_CheckSize_Warn_3_0_10 = 1,
+   __Pyx_ImportType_CheckSize_Ignore_3_0_10 = 2
 };
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size);
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size);
 #endif
 
 /* FetchSharedCythonModule.proto */
 static PyObject *__Pyx_FetchSharedCythonABIModule(void);
 
 /* FetchCommonType.proto */
 #if !CYTHON_USE_TYPE_SPECS
@@ -3411,15 +3431,15 @@
 #endif
 
 /* CheckBinaryVersion.proto */
 static unsigned long __Pyx_get_runtime_version(void);
 static int __Pyx_check_binary_version(unsigned long ct_version, unsigned long rt_version, int allow_newer);
 
 /* FunctionImport.proto */
-static int __Pyx_ImportFunction_3_0_8(PyObject *module, const char *funcname, void (**f)(void), const char *sig);
+static int __Pyx_ImportFunction_3_0_10(PyObject *module, const char *funcname, void (**f)(void), const char *sig);
 
 /* InitStrings.proto */
 static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);
 
 /* #### Code section: module_declarations ### */
 static PyObject *__pyx_array_get_memview(struct __pyx_array_obj *__pyx_v_self); /* proto*/
 static char *__pyx_memoryview_get_item_pointer(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_index); /* proto*/
@@ -3445,16 +3465,16 @@
 /* Module declarations from "pyseobnr.eob.hamiltonian.Hamiltonian_C" */
 
 /* Module declarations from "pyseobnr.eob.waveform.waveform" */
 
 /* Module declarations from "libc.math" */
 
 /* Module declarations from "pyseobnr.eob.dynamics.postadiabatic_C" */
-static PyObject *(*__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative)(__Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative *__pyx_optional_args); /*proto*/
-static PyObject *(*__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral)(__Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral *__pyx_optional_args); /*proto*/
+static PyObject *(*__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative)(PyObject *, PyObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative *__pyx_optional_args); /*proto*/
+static PyObject *(*__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral)(PyObject *, PyObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral *__pyx_optional_args); /*proto*/
 static PyObject *(*__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_Kerr_ISCO)(double, double, double, double, int __pyx_skip_dispatch); /*proto*/
 static PyObject *(*__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_adiabatic_solution)(__Pyx_memviewslice, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, double, double, double, double, __Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_adiabatic_solution *__pyx_optional_args); /*proto*/
 
 /* Module declarations from "pyseobnr.eob.dynamics.postadiabatic_C_fast" */
 static PyObject *__pyx_collections_abc_Sequence = 0;
 static PyObject *generic = 0;
 static PyObject *strided = 0;
@@ -19719,24 +19739,25 @@
   __Pyx_memviewslice __pyx_v_dpphi_dr = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_v_i;
   PyObject *__pyx_r = NULL;
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
-  __Pyx_memviewslice __pyx_t_3 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  Py_ssize_t __pyx_t_4;
+  PyObject *__pyx_t_3 = NULL;
+  __Pyx_memviewslice __pyx_t_4 = { 0, 0, { 0 }, { 0 }, { 0 } };
   Py_ssize_t __pyx_t_5;
-  int __pyx_t_6;
-  Py_ssize_t __pyx_t_7;
-  int __pyx_t_8;
-  Py_ssize_t __pyx_t_9;
+  Py_ssize_t __pyx_t_6;
+  int __pyx_t_7;
+  Py_ssize_t __pyx_t_8;
+  int __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
-  double __pyx_t_12;
+  Py_ssize_t __pyx_t_12;
+  double __pyx_t_13;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__10)
   __Pyx_RefNannySetupContext("compute_pr", 1);
   __Pyx_TraceCall("compute_pr", __pyx_f[0], 94, 0, __PYX_ERR(0, 94, __pyx_L1_error));
   if (__pyx_optional_args) {
@@ -19749,116 +19770,122 @@
  *     See DCC:T2300060
  *     """
  *     cdef double[:] dpphi_dr = - fin_diff_derivative(r, pphi)             # <<<<<<<<<<<<<<
  *     cdef int i
  *     for i in range(r.shape[0]):
  */
   __Pyx_TraceLine(114,0,__PYX_ERR(0, 114, __pyx_L1_error))
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(__pyx_v_r, __pyx_v_pphi, 0, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 114, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_r, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 114, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 114, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_pphi, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 114, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(__pyx_t_1, __pyx_t_2, 0, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 114, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 114, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v_dpphi_dr = __pyx_t_3;
-  __pyx_t_3.memview = NULL;
-  __pyx_t_3.data = NULL;
+  __pyx_t_2 = PyNumber_Negative(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 114, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 114, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_dpphi_dr = __pyx_t_4;
+  __pyx_t_4.memview = NULL;
+  __pyx_t_4.data = NULL;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx":116
  *     cdef double[:] dpphi_dr = - fin_diff_derivative(r, pphi)
  *     cdef int i
  *     for i in range(r.shape[0]):             # <<<<<<<<<<<<<<
  * 
  *         pr[i]= pr_eqn(pr[i],r[i], pphi[i], dpphi_dr[i],
  */
   __Pyx_TraceLine(116,0,__PYX_ERR(0, 116, __pyx_L1_error))
-  __pyx_t_4 = (__pyx_v_r.shape[0]);
-  __pyx_t_5 = __pyx_t_4;
-  for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
-    __pyx_v_i = __pyx_t_6;
+  __pyx_t_5 = (__pyx_v_r.shape[0]);
+  __pyx_t_6 = __pyx_t_5;
+  for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
+    __pyx_v_i = __pyx_t_7;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx":118
  *     for i in range(r.shape[0]):
  * 
  *         pr[i]= pr_eqn(pr[i],r[i], pphi[i], dpphi_dr[i],             # <<<<<<<<<<<<<<
  *                 H, RR, chi_1, chi_2, m_1, m_2,
  *                 params,q,p)
  */
     __Pyx_TraceLine(118,0,__PYX_ERR(0, 118, __pyx_L1_error))
-    __pyx_t_7 = __pyx_v_i;
-    __pyx_t_8 = -1;
-    if (__pyx_t_7 < 0) {
-      __pyx_t_7 += __pyx_v_pr.shape[0];
-      if (unlikely(__pyx_t_7 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_7 >= __pyx_v_pr.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
-      __PYX_ERR(0, 118, __pyx_L1_error)
-    }
-    __pyx_t_9 = __pyx_v_i;
-    __pyx_t_8 = -1;
-    if (__pyx_t_9 < 0) {
-      __pyx_t_9 += __pyx_v_r.shape[0];
-      if (unlikely(__pyx_t_9 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_9 >= __pyx_v_r.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
+    __pyx_t_8 = __pyx_v_i;
+    __pyx_t_9 = -1;
+    if (__pyx_t_8 < 0) {
+      __pyx_t_8 += __pyx_v_pr.shape[0];
+      if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_8 >= __pyx_v_pr.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 118, __pyx_L1_error)
     }
     __pyx_t_10 = __pyx_v_i;
-    __pyx_t_8 = -1;
+    __pyx_t_9 = -1;
     if (__pyx_t_10 < 0) {
-      __pyx_t_10 += __pyx_v_pphi.shape[0];
-      if (unlikely(__pyx_t_10 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_10 >= __pyx_v_pphi.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
+      __pyx_t_10 += __pyx_v_r.shape[0];
+      if (unlikely(__pyx_t_10 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_10 >= __pyx_v_r.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 118, __pyx_L1_error)
     }
     __pyx_t_11 = __pyx_v_i;
-    __pyx_t_8 = -1;
+    __pyx_t_9 = -1;
     if (__pyx_t_11 < 0) {
-      __pyx_t_11 += __pyx_v_dpphi_dr.shape[0];
-      if (unlikely(__pyx_t_11 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_11 >= __pyx_v_dpphi_dr.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
+      __pyx_t_11 += __pyx_v_pphi.shape[0];
+      if (unlikely(__pyx_t_11 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_11 >= __pyx_v_pphi.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
+      __PYX_ERR(0, 118, __pyx_L1_error)
+    }
+    __pyx_t_12 = __pyx_v_i;
+    __pyx_t_9 = -1;
+    if (__pyx_t_12 < 0) {
+      __pyx_t_12 += __pyx_v_dpphi_dr.shape[0];
+      if (unlikely(__pyx_t_12 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_12 >= __pyx_v_dpphi_dr.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 118, __pyx_L1_error)
     }
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx":120
  *         pr[i]= pr_eqn(pr[i],r[i], pphi[i], dpphi_dr[i],
  *                 H, RR, chi_1, chi_2, m_1, m_2,
  *                 params,q,p)             # <<<<<<<<<<<<<<
  * 
  *     return pr
  */
     __Pyx_TraceLine(120,0,__PYX_ERR(0, 120, __pyx_L1_error))
-    __pyx_t_12 = __pyx_f_8pyseobnr_3eob_8dynamics_20postadiabatic_C_fast_pr_eqn((*((double *) ( /* dim=0 */ (__pyx_v_pr.data + __pyx_t_7 * __pyx_v_pr.strides[0]) ))), (*((double *) ( /* dim=0 */ (__pyx_v_r.data + __pyx_t_9 * __pyx_v_r.strides[0]) ))), (*((double *) ( /* dim=0 */ (__pyx_v_pphi.data + __pyx_t_10 * __pyx_v_pphi.strides[0]) ))), (*((double *) ( /* dim=0 */ (__pyx_v_dpphi_dr.data + __pyx_t_11 * __pyx_v_dpphi_dr.strides[0]) ))), __pyx_v_H, __pyx_v_RR, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_params, __pyx_v_q, __pyx_v_p, 0); if (unlikely(__pyx_t_12 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 118, __pyx_L1_error)
+    __pyx_t_13 = __pyx_f_8pyseobnr_3eob_8dynamics_20postadiabatic_C_fast_pr_eqn((*((double *) ( /* dim=0 */ (__pyx_v_pr.data + __pyx_t_8 * __pyx_v_pr.strides[0]) ))), (*((double *) ( /* dim=0 */ (__pyx_v_r.data + __pyx_t_10 * __pyx_v_r.strides[0]) ))), (*((double *) ( /* dim=0 */ (__pyx_v_pphi.data + __pyx_t_11 * __pyx_v_pphi.strides[0]) ))), (*((double *) ( /* dim=0 */ (__pyx_v_dpphi_dr.data + __pyx_t_12 * __pyx_v_dpphi_dr.strides[0]) ))), __pyx_v_H, __pyx_v_RR, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_params, __pyx_v_q, __pyx_v_p, 0); if (unlikely(__pyx_t_13 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 118, __pyx_L1_error)
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx":118
  *     for i in range(r.shape[0]):
  * 
  *         pr[i]= pr_eqn(pr[i],r[i], pphi[i], dpphi_dr[i],             # <<<<<<<<<<<<<<
  *                 H, RR, chi_1, chi_2, m_1, m_2,
  *                 params,q,p)
  */
     __Pyx_TraceLine(118,0,__PYX_ERR(0, 118, __pyx_L1_error))
-    __pyx_t_11 = __pyx_v_i;
-    __pyx_t_8 = -1;
-    if (__pyx_t_11 < 0) {
-      __pyx_t_11 += __pyx_v_pr.shape[0];
-      if (unlikely(__pyx_t_11 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_11 >= __pyx_v_pr.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
+    __pyx_t_12 = __pyx_v_i;
+    __pyx_t_9 = -1;
+    if (__pyx_t_12 < 0) {
+      __pyx_t_12 += __pyx_v_pr.shape[0];
+      if (unlikely(__pyx_t_12 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_12 >= __pyx_v_pr.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 118, __pyx_L1_error)
     }
-    *((double *) ( /* dim=0 */ (__pyx_v_pr.data + __pyx_t_11 * __pyx_v_pr.strides[0]) )) = __pyx_t_12;
+    *((double *) ( /* dim=0 */ (__pyx_v_pr.data + __pyx_t_12 * __pyx_v_pr.strides[0]) )) = __pyx_t_13;
   }
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx":122
  *                 params,q,p)
  * 
  *     return pr             # <<<<<<<<<<<<<<
  * 
@@ -19880,15 +19907,16 @@
  *     double[:] pr,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_3, 1);
+  __Pyx_XDECREF(__pyx_t_3);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_t_4, 1);
   __Pyx_AddTraceback("pyseobnr.eob.dynamics.postadiabatic_C_fast.compute_pr", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_dpphi_dr, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
@@ -21257,24 +21285,25 @@
   __Pyx_memviewslice __pyx_v_dpr_dr = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_v_i;
   PyObject *__pyx_r = NULL;
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
-  __Pyx_memviewslice __pyx_t_3 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  Py_ssize_t __pyx_t_4;
+  PyObject *__pyx_t_3 = NULL;
+  __Pyx_memviewslice __pyx_t_4 = { 0, 0, { 0 }, { 0 }, { 0 } };
   Py_ssize_t __pyx_t_5;
-  int __pyx_t_6;
-  Py_ssize_t __pyx_t_7;
-  int __pyx_t_8;
-  Py_ssize_t __pyx_t_9;
+  Py_ssize_t __pyx_t_6;
+  int __pyx_t_7;
+  Py_ssize_t __pyx_t_8;
+  int __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
-  double __pyx_t_12;
+  Py_ssize_t __pyx_t_12;
+  double __pyx_t_13;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__12)
   __Pyx_RefNannySetupContext("compute_pphi", 1);
   __Pyx_TraceCall("compute_pphi", __pyx_f[0], 209, 0, __PYX_ERR(0, 209, __pyx_L1_error));
   if (__pyx_optional_args) {
@@ -21287,98 +21316,104 @@
  *     """
  * 
  *     cdef double[:] dpr_dr = - fin_diff_derivative(r, pr)             # <<<<<<<<<<<<<<
  *     cdef int i
  *     for i in range(r.shape[0]):
  */
   __Pyx_TraceLine(230,0,__PYX_ERR(0, 230, __pyx_L1_error))
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(__pyx_v_r, __pyx_v_pr, 0, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_r, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 230, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_pr, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 230, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative(__pyx_t_1, __pyx_t_2, 0, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 230, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_v_dpr_dr = __pyx_t_3;
-  __pyx_t_3.memview = NULL;
-  __pyx_t_3.data = NULL;
+  __pyx_t_2 = PyNumber_Negative(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_dpr_dr = __pyx_t_4;
+  __pyx_t_4.memview = NULL;
+  __pyx_t_4.data = NULL;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx":232
  *     cdef double[:] dpr_dr = - fin_diff_derivative(r, pr)
  *     cdef int i
  *     for i in range(r.shape[0]):             # <<<<<<<<<<<<<<
  * 
  *         pphi[i]  = pphi_eqn(pphi[i],r[i], pr[i], dpr_dr[i], H, RR, chi_1, chi_2, m_1, m_2, params,q,p)
  */
   __Pyx_TraceLine(232,0,__PYX_ERR(0, 232, __pyx_L1_error))
-  __pyx_t_4 = (__pyx_v_r.shape[0]);
-  __pyx_t_5 = __pyx_t_4;
-  for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
-    __pyx_v_i = __pyx_t_6;
+  __pyx_t_5 = (__pyx_v_r.shape[0]);
+  __pyx_t_6 = __pyx_t_5;
+  for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
+    __pyx_v_i = __pyx_t_7;
 
     /* "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx":234
  *     for i in range(r.shape[0]):
  * 
  *         pphi[i]  = pphi_eqn(pphi[i],r[i], pr[i], dpr_dr[i], H, RR, chi_1, chi_2, m_1, m_2, params,q,p)             # <<<<<<<<<<<<<<
  * 
  *     return pphi
  */
     __Pyx_TraceLine(234,0,__PYX_ERR(0, 234, __pyx_L1_error))
-    __pyx_t_7 = __pyx_v_i;
-    __pyx_t_8 = -1;
-    if (__pyx_t_7 < 0) {
-      __pyx_t_7 += __pyx_v_pphi.shape[0];
-      if (unlikely(__pyx_t_7 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_7 >= __pyx_v_pphi.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
-      __PYX_ERR(0, 234, __pyx_L1_error)
-    }
-    __pyx_t_9 = __pyx_v_i;
-    __pyx_t_8 = -1;
-    if (__pyx_t_9 < 0) {
-      __pyx_t_9 += __pyx_v_r.shape[0];
-      if (unlikely(__pyx_t_9 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_9 >= __pyx_v_r.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
+    __pyx_t_8 = __pyx_v_i;
+    __pyx_t_9 = -1;
+    if (__pyx_t_8 < 0) {
+      __pyx_t_8 += __pyx_v_pphi.shape[0];
+      if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_8 >= __pyx_v_pphi.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 234, __pyx_L1_error)
     }
     __pyx_t_10 = __pyx_v_i;
-    __pyx_t_8 = -1;
+    __pyx_t_9 = -1;
     if (__pyx_t_10 < 0) {
-      __pyx_t_10 += __pyx_v_pr.shape[0];
-      if (unlikely(__pyx_t_10 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_10 >= __pyx_v_pr.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
+      __pyx_t_10 += __pyx_v_r.shape[0];
+      if (unlikely(__pyx_t_10 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_10 >= __pyx_v_r.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 234, __pyx_L1_error)
     }
     __pyx_t_11 = __pyx_v_i;
-    __pyx_t_8 = -1;
+    __pyx_t_9 = -1;
     if (__pyx_t_11 < 0) {
-      __pyx_t_11 += __pyx_v_dpr_dr.shape[0];
-      if (unlikely(__pyx_t_11 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_11 >= __pyx_v_dpr_dr.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
+      __pyx_t_11 += __pyx_v_pr.shape[0];
+      if (unlikely(__pyx_t_11 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_11 >= __pyx_v_pr.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 234, __pyx_L1_error)
     }
-    __pyx_t_12 = __pyx_f_8pyseobnr_3eob_8dynamics_20postadiabatic_C_fast_pphi_eqn((*((double *) ( /* dim=0 */ (__pyx_v_pphi.data + __pyx_t_7 * __pyx_v_pphi.strides[0]) ))), (*((double *) ( /* dim=0 */ (__pyx_v_r.data + __pyx_t_9 * __pyx_v_r.strides[0]) ))), (*((double *) ( /* dim=0 */ (__pyx_v_pr.data + __pyx_t_10 * __pyx_v_pr.strides[0]) ))), (*((double *) ( /* dim=0 */ (__pyx_v_dpr_dr.data + __pyx_t_11 * __pyx_v_dpr_dr.strides[0]) ))), __pyx_v_H, __pyx_v_RR, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_params, __pyx_v_q, __pyx_v_p, 0); if (unlikely(__pyx_t_12 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 234, __pyx_L1_error)
-    __pyx_t_11 = __pyx_v_i;
-    __pyx_t_8 = -1;
-    if (__pyx_t_11 < 0) {
-      __pyx_t_11 += __pyx_v_pphi.shape[0];
-      if (unlikely(__pyx_t_11 < 0)) __pyx_t_8 = 0;
-    } else if (unlikely(__pyx_t_11 >= __pyx_v_pphi.shape[0])) __pyx_t_8 = 0;
-    if (unlikely(__pyx_t_8 != -1)) {
-      __Pyx_RaiseBufferIndexError(__pyx_t_8);
+    __pyx_t_12 = __pyx_v_i;
+    __pyx_t_9 = -1;
+    if (__pyx_t_12 < 0) {
+      __pyx_t_12 += __pyx_v_dpr_dr.shape[0];
+      if (unlikely(__pyx_t_12 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_12 >= __pyx_v_dpr_dr.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
       __PYX_ERR(0, 234, __pyx_L1_error)
     }
-    *((double *) ( /* dim=0 */ (__pyx_v_pphi.data + __pyx_t_11 * __pyx_v_pphi.strides[0]) )) = __pyx_t_12;
+    __pyx_t_13 = __pyx_f_8pyseobnr_3eob_8dynamics_20postadiabatic_C_fast_pphi_eqn((*((double *) ( /* dim=0 */ (__pyx_v_pphi.data + __pyx_t_8 * __pyx_v_pphi.strides[0]) ))), (*((double *) ( /* dim=0 */ (__pyx_v_r.data + __pyx_t_10 * __pyx_v_r.strides[0]) ))), (*((double *) ( /* dim=0 */ (__pyx_v_pr.data + __pyx_t_11 * __pyx_v_pr.strides[0]) ))), (*((double *) ( /* dim=0 */ (__pyx_v_dpr_dr.data + __pyx_t_12 * __pyx_v_dpr_dr.strides[0]) ))), __pyx_v_H, __pyx_v_RR, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_params, __pyx_v_q, __pyx_v_p, 0); if (unlikely(__pyx_t_13 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 234, __pyx_L1_error)
+    __pyx_t_12 = __pyx_v_i;
+    __pyx_t_9 = -1;
+    if (__pyx_t_12 < 0) {
+      __pyx_t_12 += __pyx_v_pphi.shape[0];
+      if (unlikely(__pyx_t_12 < 0)) __pyx_t_9 = 0;
+    } else if (unlikely(__pyx_t_12 >= __pyx_v_pphi.shape[0])) __pyx_t_9 = 0;
+    if (unlikely(__pyx_t_9 != -1)) {
+      __Pyx_RaiseBufferIndexError(__pyx_t_9);
+      __PYX_ERR(0, 234, __pyx_L1_error)
+    }
+    *((double *) ( /* dim=0 */ (__pyx_v_pphi.data + __pyx_t_12 * __pyx_v_pphi.strides[0]) )) = __pyx_t_13;
   }
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx":236
  *         pphi[i]  = pphi_eqn(pphi[i],r[i], pr[i], dpr_dr[i], H, RR, chi_1, chi_2, m_1, m_2, params,q,p)
  * 
  *     return pphi             # <<<<<<<<<<<<<<
  * 
@@ -21400,15 +21435,16 @@
  *     double[:] pr,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_3, 1);
+  __Pyx_XDECREF(__pyx_t_3);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_t_4, 1);
   __Pyx_AddTraceback("pyseobnr.eob.dynamics.postadiabatic_C_fast.compute_pphi", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_dpr_dr, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
@@ -23513,41 +23549,29 @@
  * 
  * 
  *     t = cumulative_integral(r, dt_dr)             # <<<<<<<<<<<<<<
  * 
  *     phi = cumulative_integral(r, dphi_dr)
  */
   __Pyx_TraceLine(393,0,__PYX_ERR(0, 393, __pyx_L1_error))
-  __pyx_t_18 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_r, PyBUF_WRITABLE); if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 393, __pyx_L1_error)
-  __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_dt_dr, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 393, __pyx_L1_error)
-  __pyx_t_7 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral(__pyx_t_18, __pyx_t_16, 0, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 393, __pyx_L1_error)
+  __pyx_t_7 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral(__pyx_v_r, __pyx_v_dt_dr, 0, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 393, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_18, 1);
-  __pyx_t_18.memview = NULL; __pyx_t_18.data = NULL;
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_16, 1);
-  __pyx_t_16.memview = NULL; __pyx_t_16.data = NULL;
   __pyx_v_t = __pyx_t_7;
   __pyx_t_7 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx":395
  *     t = cumulative_integral(r, dt_dr)
  * 
  *     phi = cumulative_integral(r, dphi_dr)             # <<<<<<<<<<<<<<
  * 
  *     postadiabatic_dynamics = np.c_[t, r, phi, pr, pphi]
  */
   __Pyx_TraceLine(395,0,__PYX_ERR(0, 395, __pyx_L1_error))
-  __pyx_t_16 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_r, PyBUF_WRITABLE); if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 395, __pyx_L1_error)
-  __pyx_t_18 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_dphi_dr, PyBUF_WRITABLE); if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 395, __pyx_L1_error)
-  __pyx_t_7 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral(__pyx_t_16, __pyx_t_18, 0, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 395, __pyx_L1_error)
+  __pyx_t_7 = __pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral(__pyx_v_r, __pyx_v_dphi_dr, 0, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 395, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_16, 1);
-  __pyx_t_16.memview = NULL; __pyx_t_16.data = NULL;
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_18, 1);
-  __pyx_t_18.memview = NULL; __pyx_t_18.data = NULL;
   __pyx_v_phi = __pyx_t_7;
   __pyx_t_7 = 0;
 
   /* "pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx":397
  *     phi = cumulative_integral(r, dphi_dr)
  * 
  *     postadiabatic_dynamics = np.c_[t, r, phi, pr, pphi]             # <<<<<<<<<<<<<<
@@ -26718,32 +26742,32 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(2, 8, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(2, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(2, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(2, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(2, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(2, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(2, 67, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(2, 23, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(2, 26, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(2, 29, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(2, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 6, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) __PYX_ERR(3, 6, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) __PYX_ERR(3, 6, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C)) __PYX_ERR(3, 6, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 10, __pyx_L1_error)
+  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(4, 10, __pyx_L1_error)
-  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(4, 10, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(4, 14, __pyx_L1_error)
-  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(4, 14, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(4, 15, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(4, 15, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(4, 25, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(4, 25, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -26763,18 +26787,18 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_function_import_code", 0);
   /*--- Function import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.dynamics.postadiabatic_C"); if (!__pyx_t_1) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (__Pyx_ImportFunction_3_0_8(__pyx_t_1, "fin_diff_derivative", (void (**)(void))&__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative, "PyObject *(__Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative *__pyx_optional_args)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  if (__Pyx_ImportFunction_3_0_8(__pyx_t_1, "cumulative_integral", (void (**)(void))&__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral, "PyObject *(__Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral *__pyx_optional_args)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  if (__Pyx_ImportFunction_3_0_8(__pyx_t_1, "Kerr_ISCO", (void (**)(void))&__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_Kerr_ISCO, "PyObject *(double, double, double, double, int __pyx_skip_dispatch)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  if (__Pyx_ImportFunction_3_0_8(__pyx_t_1, "compute_adiabatic_solution", (void (**)(void))&__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_adiabatic_solution, "PyObject *(__Pyx_memviewslice, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, double, double, double, double, __Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_adiabatic_solution *__pyx_optional_args)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_ImportFunction_3_0_10(__pyx_t_1, "fin_diff_derivative", (void (**)(void))&__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative, "PyObject *(PyObject *, PyObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_fin_diff_derivative *__pyx_optional_args)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_ImportFunction_3_0_10(__pyx_t_1, "cumulative_integral", (void (**)(void))&__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral, "PyObject *(PyObject *, PyObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_cumulative_integral *__pyx_optional_args)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_ImportFunction_3_0_10(__pyx_t_1, "Kerr_ISCO", (void (**)(void))&__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_Kerr_ISCO, "PyObject *(double, double, double, double, int __pyx_skip_dispatch)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_ImportFunction_3_0_10(__pyx_t_1, "compute_adiabatic_solution", (void (**)(void))&__pyx_f_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_adiabatic_solution, "PyObject *(__Pyx_memviewslice, struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, double, double, double, double, __Pyx_memviewslice, __Pyx_memviewslice, int __pyx_skip_dispatch, struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_15postadiabatic_C_compute_adiabatic_solution *__pyx_optional_args)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -31335,18 +31359,18 @@
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
 }
 #endif
 
 /* TypeImport */
-#ifndef __PYX_HAVE_RT_ImportType_3_0_8
-#define __PYX_HAVE_RT_ImportType_3_0_8
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size)
+#ifndef __PYX_HAVE_RT_ImportType_3_0_10
+#define __PYX_HAVE_RT_ImportType_3_0_10
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject *module, const char *module_name, const char *class_name,
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
     Py_ssize_t itemsize;
 #if CYTHON_COMPILING_IN_LIMITED_API
     PyObject *py_basicsize;
@@ -31392,23 +31416,23 @@
     if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize+itemsize);
         goto bad;
     }
-    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_8 &&
+    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_10 &&
             ((size_t)basicsize > size || (size_t)(basicsize + itemsize) < size)) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd-%zd from PyObject",
             module_name, class_name, size, basicsize, basicsize+itemsize);
         goto bad;
     }
-    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_8 && (size_t)basicsize > size) {
+    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_10 && (size_t)basicsize > size) {
         PyOS_snprintf(warning, sizeof(warning),
             "%s.%s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
     }
     return (PyTypeObject *)result;
@@ -32400,15 +32424,15 @@
         break;
     case 0:
         self = ((PyCFunctionObject*)cyfunc)->m_self;
         break;
     default:
         return NULL;
     }
-    return ((_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
+    return ((__Pyx_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
 }
 static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS_METHOD(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
 {
     __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
     PyMethodDef* def = ((PyCFunctionObject*)cyfunc)->m_ml;
     PyTypeObject *cls = (PyTypeObject *) __Pyx_CyFunction_GetClassObj(cyfunc);
 #if CYTHON_BACKPORT_VECTORCALL
@@ -35184,17 +35208,17 @@
                        (int) (rt_version >> 24), (int) ((rt_version >> 16) & 0xFF)
        );
         return PyErr_WarnEx(NULL, message, 1);
     }
 }
 
 /* FunctionImport */
-  #ifndef __PYX_HAVE_RT_ImportFunction_3_0_8
-#define __PYX_HAVE_RT_ImportFunction_3_0_8
-static int __Pyx_ImportFunction_3_0_8(PyObject *module, const char *funcname, void (**f)(void), const char *sig) {
+  #ifndef __PYX_HAVE_RT_ImportFunction_3_0_10
+#define __PYX_HAVE_RT_ImportFunction_3_0_10
+static int __Pyx_ImportFunction_3_0_10(PyObject *module, const char *funcname, void (**f)(void), const char *sig) {
     PyObject *d = 0;
     PyObject *cobj = 0;
     union {
         void (*fp)(void);
         void *p;
     } tmp;
     d = PyObject_GetAttrString(module, (char *)"__pyx_capi__");
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/postadiabatic_C_fast.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/postadiabatic_C_prec.c` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/postadiabatic_C_prec.c`

 * *Files 1% similar despite different names*

```diff
@@ -1,21 +1,21 @@
-/* Generated by Cython 3.0.8 */
+/* Generated by Cython 3.0.10 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include",
             "pyseobnr/eob/hamiltonian"
         ],
         "name": "pyseobnr.eob.dynamics.postadiabatic_C_prec",
         "sources": [
             "pyseobnr/eob/dynamics/postadiabatic_C_prec.pyx"
         ]
     },
@@ -43,18 +43,18 @@
     #error Cython requires Python 2.7+ or Python 3.3+.
 #else
 #if defined(CYTHON_LIMITED_API) && CYTHON_LIMITED_API
 #define __PYX_EXTRA_ABI_MODULE_NAME "limited"
 #else
 #define __PYX_EXTRA_ABI_MODULE_NAME ""
 #endif
-#define CYTHON_ABI "3_0_8" __PYX_EXTRA_ABI_MODULE_NAME
+#define CYTHON_ABI "3_0_10" __PYX_EXTRA_ABI_MODULE_NAME
 #define __PYX_ABI_MODULE_NAME "_cython_" CYTHON_ABI
 #define __PYX_TYPE_MODULE_PREFIX __PYX_ABI_MODULE_NAME "."
-#define CYTHON_HEX_VERSION 0x030008F0
+#define CYTHON_HEX_VERSION 0x03000AF0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(_WIN32) && !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -138,14 +138,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(PYPY_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #undef CYTHON_USE_TYPE_SLOTS
@@ -199,14 +201,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(CYTHON_LIMITED_API)
   #ifdef Py_LIMITED_API
     #undef __PYX_LIMITED_VERSION_HEX
     #define __PYX_LIMITED_VERSION_HEX Py_LIMITED_API
   #endif
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
@@ -260,60 +264,83 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(Py_GIL_DISABLED) || defined(Py_NOGIL)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_TYPE_SPECS
+    #define CYTHON_USE_TYPE_SPECS 0
+  #endif
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #ifndef CYTHON_USE_ASYNC_SLOTS
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_PYLONG_INTERNALS
+    #define CYTHON_USE_PYLONG_INTERNALS 0
+  #endif
   #undef CYTHON_USE_PYLIST_INTERNALS
   #define CYTHON_USE_PYLIST_INTERNALS 0
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
   #undef CYTHON_USE_UNICODE_WRITER
   #define CYTHON_USE_UNICODE_WRITER 0
-  #undef CYTHON_USE_PYLONG_INTERNALS
-  #define CYTHON_USE_PYLONG_INTERNALS 0
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
   #undef CYTHON_FAST_THREAD_STATE
   #define CYTHON_FAST_THREAD_STATE 0
+  #undef CYTHON_FAST_GIL
+  #define CYTHON_FAST_GIL 0
+  #ifndef CYTHON_METH_FASTCALL
+    #define CYTHON_METH_FASTCALL 1
+  #endif
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
+  #ifndef CYTHON_PEP487_INIT_SUBCLASS
+    #define CYTHON_PEP487_INIT_SUBCLASS 1
+  #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT 1
   #endif
+  #ifndef CYTHON_USE_MODULE_STATE
+    #define CYTHON_USE_MODULE_STATE 0
+  #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE 1
   #endif
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
@@ -396,14 +423,17 @@
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK 1
   #endif
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
   #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if !defined(CYTHON_VECTORCALL)
 #define CYTHON_VECTORCALL  (CYTHON_FAST_PYCCALL && PY_VERSION_HEX >= 0x030800B1)
 #endif
@@ -739,16 +769,21 @@
   #ifndef METH_FASTCALL
      #define METH_FASTCALL 0x80
   #endif
   typedef PyObject *(*__Pyx_PyCFunctionFast) (PyObject *self, PyObject *const *args, Py_ssize_t nargs);
   typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords) (PyObject *self, PyObject *const *args,
                                                           Py_ssize_t nargs, PyObject *kwnames);
 #else
-  #define __Pyx_PyCFunctionFast _PyCFunctionFast
-  #define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #if PY_VERSION_HEX >= 0x030d00A4
+  #  define __Pyx_PyCFunctionFast PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords PyCFunctionFastWithKeywords
+  #else
+  #  define __Pyx_PyCFunctionFast _PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #endif
 #endif
 #if CYTHON_METH_FASTCALL
   #define __Pyx_METH_FASTCALL METH_FASTCALL
   #define __Pyx_PyCFunction_FastCall __Pyx_PyCFunctionFast
   #define __Pyx_PyCFunction_FastCallWithKeywords __Pyx_PyCFunctionFastWithKeywords
 #else
   #define __Pyx_METH_FASTCALL METH_VARARGS
@@ -1092,15 +1127,15 @@
   #define __Pyx_PyList_SET_ITEM(o, i, v) PyList_SetItem(o, i, v)
   #define __Pyx_PyTuple_GET_SIZE(o) PyTuple_Size(o)
   #define __Pyx_PyList_GET_SIZE(o) PyList_Size(o)
   #define __Pyx_PySet_GET_SIZE(o) PySet_Size(o)
   #define __Pyx_PyBytes_GET_SIZE(o) PyBytes_Size(o)
   #define __Pyx_PyByteArray_GET_SIZE(o) PyByteArray_Size(o)
 #endif
-#if PY_VERSION_HEX >= 0x030d00A1
+#if __PYX_LIMITED_VERSION_HEX >= 0x030d00A1
   #define __Pyx_PyImport_AddModuleRef(name) PyImport_AddModuleRef(name)
 #else
   static CYTHON_INLINE PyObject *__Pyx_PyImport_AddModuleRef(const char *name) {
       PyObject *module = PyImport_AddModule(name);
       Py_XINCREF(module);
       return module;
   }
@@ -1179,15 +1214,15 @@
 #if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
 #define __Pyx_truncl trunc
 #else
 #define __Pyx_truncl truncl
 #endif
 
 #define __PYX_MARK_ERR_POS(f_index, lineno) \
-    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__; (void)__pyx_clineno; }
+    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__;  (void)__pyx_clineno; }
 #define __PYX_ERR(f_index, lineno, Ln_error) \
     { __PYX_MARK_ERR_POS(f_index, lineno) goto Ln_error; }
 
 #ifdef CYTHON_EXTERN_C
     #undef __PYX_EXTERN_C
     #define __PYX_EXTERN_C CYTHON_EXTERN_C
 #elif defined(__PYX_EXTERN_C)
@@ -1287,32 +1322,15 @@
 #define __Pyx_PyObject_AsSString(s)    ((const signed char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_AsUString(s)    ((const unsigned char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
 #define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
 #define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
 #define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
 #define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
-#if CYTHON_COMPILING_IN_LIMITED_API
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const wchar_t *u)
-{
-    const wchar_t *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#else
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
-{
-    const Py_UNICODE *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#endif
 #define __Pyx_PyUnicode_FromOrdinal(o)       PyUnicode_FromOrdinal((int)o)
-#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
-#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
 #define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
 #define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
 #define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
 static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
@@ -1678,17 +1696,17 @@
 struct __pyx_memoryviewslice_obj;
 struct __pyx_ctuple_double__and_double;
 typedef struct __pyx_ctuple_double__and_double __pyx_ctuple_double__and_double;
 
 /* "pyseobnr/eob/waveform/waveform.pxd":7
  *     const int ell_max
  * 
- * cpdef (double, double) RR_force(double[::1] q, double[::1] p, double omega, double omega_circ,             # <<<<<<<<<<<<<<
- *     double H, EOBParams eob_pars)
- * 
+ * cpdef (double, double) RR_force(             # <<<<<<<<<<<<<<
+ *     double[::1] q,
+ *     double[::1] p,
  */
 struct __pyx_ctuple_double__and_double {
   double f0;
   double f1;
 };
 struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_20postadiabatic_C_prec_compute_adiabatic_solution;
 struct __pyx_opt_args_8pyseobnr_3eob_8dynamics_20postadiabatic_C_prec_compute_pr;
@@ -1922,32 +1940,33 @@
 struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C {
   PyObject_HEAD
   struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_vtab;
   struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *EOBpars;
 };
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":10
- *     double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":15
+ *     EOBParams eob_pars)
  * 
  * cdef class RadiationReactionForce:             # <<<<<<<<<<<<<<
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,
- *         double omega_circ, double H, EOBParams eob_pars)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce {
   PyObject_HEAD
   struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_vtab;
 };
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":14
- *         double omega_circ, double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":25
+ *         EOBParams eob_pars)
  * 
  * cdef class SEOBNRv5RRForce(RadiationReactionForce):             # <<<<<<<<<<<<<<
- *     cpdef (double,double) RR(self, double[::1] q,double[::1] p,double omega,double omega_circ,double H,EOBParams eob_par)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce {
   struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce __pyx_base;
 };
 
 
 /* "View.MemoryView":114
@@ -2058,33 +2077,34 @@
   PyObject *(*dynamics)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
   double (*omega)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
   PyObject *(*aux_derivs)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch);
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":10
- *     double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":15
+ *     EOBParams eob_pars)
  * 
  * cdef class RadiationReactionForce:             # <<<<<<<<<<<<<<
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,
- *         double omega_circ, double H, EOBParams eob_pars)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 
 struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce {
   __pyx_ctuple_double__and_double (*RR)(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *, int __pyx_skip_dispatch);
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":14
- *         double omega_circ, double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":25
+ *         EOBParams eob_pars)
  * 
  * cdef class SEOBNRv5RRForce(RadiationReactionForce):             # <<<<<<<<<<<<<<
- *     cpdef (double,double) RR(self, double[::1] q,double[::1] p,double omega,double omega_circ,double H,EOBParams eob_par)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 
 struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce {
   struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce __pyx_base;
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce *__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce;
 
@@ -3082,30 +3102,30 @@
 
 /* SetupReduce.proto */
 #if !CYTHON_COMPILING_IN_LIMITED_API
 static int __Pyx_setup_reduce(PyObject* type_obj);
 #endif
 
 /* TypeImport.proto */
-#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_8
-#define __PYX_HAVE_RT_ImportType_proto_3_0_8
+#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_10
+#define __PYX_HAVE_RT_ImportType_proto_3_0_10
 #if defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L
 #include <stdalign.h>
 #endif
 #if (defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L) || __cplusplus >= 201103L
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) alignof(s)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) alignof(s)
 #else
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) sizeof(void*)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) sizeof(void*)
 #endif
-enum __Pyx_ImportType_CheckSize_3_0_8 {
-   __Pyx_ImportType_CheckSize_Error_3_0_8 = 0,
-   __Pyx_ImportType_CheckSize_Warn_3_0_8 = 1,
-   __Pyx_ImportType_CheckSize_Ignore_3_0_8 = 2
+enum __Pyx_ImportType_CheckSize_3_0_10 {
+   __Pyx_ImportType_CheckSize_Error_3_0_10 = 0,
+   __Pyx_ImportType_CheckSize_Warn_3_0_10 = 1,
+   __Pyx_ImportType_CheckSize_Ignore_3_0_10 = 2
 };
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size);
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size);
 #endif
 
 /* FetchSharedCythonModule.proto */
 static PyObject *__Pyx_FetchSharedCythonABIModule(void);
 
 /* FetchCommonType.proto */
 #if !CYTHON_USE_TYPE_SPECS
@@ -39524,32 +39544,32 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(2, 8, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(2, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(2, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(2, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(2, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(2, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(2, 67, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(2, 23, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(2, 26, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(2, 29, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(2, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", "Hamiltonian_v5PHM_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) __PYX_ERR(3, 4, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", "Hamiltonian_v5PHM_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) __PYX_ERR(3, 4, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C)) __PYX_ERR(3, 4, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 10, __pyx_L1_error)
+  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(4, 10, __pyx_L1_error)
-  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(4, 10, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(4, 14, __pyx_L1_error)
-  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(4, 14, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(4, 15, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(4, 15, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(4, 25, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(4, 25, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -44511,18 +44531,18 @@
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
 }
 #endif
 
 /* TypeImport */
-#ifndef __PYX_HAVE_RT_ImportType_3_0_8
-#define __PYX_HAVE_RT_ImportType_3_0_8
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size)
+#ifndef __PYX_HAVE_RT_ImportType_3_0_10
+#define __PYX_HAVE_RT_ImportType_3_0_10
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject *module, const char *module_name, const char *class_name,
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
     Py_ssize_t itemsize;
 #if CYTHON_COMPILING_IN_LIMITED_API
     PyObject *py_basicsize;
@@ -44568,23 +44588,23 @@
     if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize+itemsize);
         goto bad;
     }
-    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_8 &&
+    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_10 &&
             ((size_t)basicsize > size || (size_t)(basicsize + itemsize) < size)) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd-%zd from PyObject",
             module_name, class_name, size, basicsize, basicsize+itemsize);
         goto bad;
     }
-    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_8 && (size_t)basicsize > size) {
+    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_10 && (size_t)basicsize > size) {
         PyOS_snprintf(warning, sizeof(warning),
             "%s.%s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
     }
     return (PyTypeObject *)result;
@@ -45576,15 +45596,15 @@
         break;
     case 0:
         self = ((PyCFunctionObject*)cyfunc)->m_self;
         break;
     default:
         return NULL;
     }
-    return ((_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
+    return ((__Pyx_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
 }
 static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS_METHOD(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
 {
     __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
     PyMethodDef* def = ((PyCFunctionObject*)cyfunc)->m_ml;
     PyTypeObject *cls = (PyTypeObject *) __Pyx_CyFunction_GetClassObj(cyfunc);
 #if CYTHON_BACKPORT_VECTORCALL
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/postadiabatic_C_prec.pyx` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/postadiabatic_C_prec.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/rhs_aligned.c` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/rhs_aligned.c`

 * *Files 1% similar despite different names*

```diff
@@ -1,32 +1,32 @@
-/* Generated by Cython 3.0.8 */
+/* Generated by Cython 3.0.10 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "define_macros": [
             [
                 "CYTHON_TRACE",
                 "1"
             ]
         ],
         "depends": [
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ufuncobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include"
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include"
         ],
         "name": "pyseobnr.eob.dynamics.rhs_aligned",
         "sources": [
             "pyseobnr/eob/dynamics/rhs_aligned.pyx"
         ]
     },
     "module_name": "pyseobnr.eob.dynamics.rhs_aligned"
@@ -53,18 +53,18 @@
     #error Cython requires Python 2.7+ or Python 3.3+.
 #else
 #if defined(CYTHON_LIMITED_API) && CYTHON_LIMITED_API
 #define __PYX_EXTRA_ABI_MODULE_NAME "limited"
 #else
 #define __PYX_EXTRA_ABI_MODULE_NAME ""
 #endif
-#define CYTHON_ABI "3_0_8" __PYX_EXTRA_ABI_MODULE_NAME
+#define CYTHON_ABI "3_0_10" __PYX_EXTRA_ABI_MODULE_NAME
 #define __PYX_ABI_MODULE_NAME "_cython_" CYTHON_ABI
 #define __PYX_TYPE_MODULE_PREFIX __PYX_ABI_MODULE_NAME "."
-#define CYTHON_HEX_VERSION 0x030008F0
+#define CYTHON_HEX_VERSION 0x03000AF0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(_WIN32) && !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -148,14 +148,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(PYPY_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #undef CYTHON_USE_TYPE_SLOTS
@@ -209,14 +211,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(CYTHON_LIMITED_API)
   #ifdef Py_LIMITED_API
     #undef __PYX_LIMITED_VERSION_HEX
     #define __PYX_LIMITED_VERSION_HEX Py_LIMITED_API
   #endif
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
@@ -270,60 +274,83 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(Py_GIL_DISABLED) || defined(Py_NOGIL)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_TYPE_SPECS
+    #define CYTHON_USE_TYPE_SPECS 0
+  #endif
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #ifndef CYTHON_USE_ASYNC_SLOTS
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_PYLONG_INTERNALS
+    #define CYTHON_USE_PYLONG_INTERNALS 0
+  #endif
   #undef CYTHON_USE_PYLIST_INTERNALS
   #define CYTHON_USE_PYLIST_INTERNALS 0
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
   #undef CYTHON_USE_UNICODE_WRITER
   #define CYTHON_USE_UNICODE_WRITER 0
-  #undef CYTHON_USE_PYLONG_INTERNALS
-  #define CYTHON_USE_PYLONG_INTERNALS 0
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
   #undef CYTHON_FAST_THREAD_STATE
   #define CYTHON_FAST_THREAD_STATE 0
+  #undef CYTHON_FAST_GIL
+  #define CYTHON_FAST_GIL 0
+  #ifndef CYTHON_METH_FASTCALL
+    #define CYTHON_METH_FASTCALL 1
+  #endif
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
+  #ifndef CYTHON_PEP487_INIT_SUBCLASS
+    #define CYTHON_PEP487_INIT_SUBCLASS 1
+  #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT 1
   #endif
+  #ifndef CYTHON_USE_MODULE_STATE
+    #define CYTHON_USE_MODULE_STATE 0
+  #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE 1
   #endif
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
@@ -406,14 +433,17 @@
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK 1
   #endif
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
   #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if !defined(CYTHON_VECTORCALL)
 #define CYTHON_VECTORCALL  (CYTHON_FAST_PYCCALL && PY_VERSION_HEX >= 0x030800B1)
 #endif
@@ -749,16 +779,21 @@
   #ifndef METH_FASTCALL
      #define METH_FASTCALL 0x80
   #endif
   typedef PyObject *(*__Pyx_PyCFunctionFast) (PyObject *self, PyObject *const *args, Py_ssize_t nargs);
   typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords) (PyObject *self, PyObject *const *args,
                                                           Py_ssize_t nargs, PyObject *kwnames);
 #else
-  #define __Pyx_PyCFunctionFast _PyCFunctionFast
-  #define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #if PY_VERSION_HEX >= 0x030d00A4
+  #  define __Pyx_PyCFunctionFast PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords PyCFunctionFastWithKeywords
+  #else
+  #  define __Pyx_PyCFunctionFast _PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #endif
 #endif
 #if CYTHON_METH_FASTCALL
   #define __Pyx_METH_FASTCALL METH_FASTCALL
   #define __Pyx_PyCFunction_FastCall __Pyx_PyCFunctionFast
   #define __Pyx_PyCFunction_FastCallWithKeywords __Pyx_PyCFunctionFastWithKeywords
 #else
   #define __Pyx_METH_FASTCALL METH_VARARGS
@@ -1102,15 +1137,15 @@
   #define __Pyx_PyList_SET_ITEM(o, i, v) PyList_SetItem(o, i, v)
   #define __Pyx_PyTuple_GET_SIZE(o) PyTuple_Size(o)
   #define __Pyx_PyList_GET_SIZE(o) PyList_Size(o)
   #define __Pyx_PySet_GET_SIZE(o) PySet_Size(o)
   #define __Pyx_PyBytes_GET_SIZE(o) PyBytes_Size(o)
   #define __Pyx_PyByteArray_GET_SIZE(o) PyByteArray_Size(o)
 #endif
-#if PY_VERSION_HEX >= 0x030d00A1
+#if __PYX_LIMITED_VERSION_HEX >= 0x030d00A1
   #define __Pyx_PyImport_AddModuleRef(name) PyImport_AddModuleRef(name)
 #else
   static CYTHON_INLINE PyObject *__Pyx_PyImport_AddModuleRef(const char *name) {
       PyObject *module = PyImport_AddModule(name);
       Py_XINCREF(module);
       return module;
   }
@@ -1189,15 +1224,15 @@
 #if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
 #define __Pyx_truncl trunc
 #else
 #define __Pyx_truncl truncl
 #endif
 
 #define __PYX_MARK_ERR_POS(f_index, lineno) \
-    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__; (void)__pyx_clineno; }
+    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__;  (void)__pyx_clineno; }
 #define __PYX_ERR(f_index, lineno, Ln_error) \
     { __PYX_MARK_ERR_POS(f_index, lineno) goto Ln_error; }
 
 #ifdef CYTHON_EXTERN_C
     #undef __PYX_EXTERN_C
     #define __PYX_EXTERN_C CYTHON_EXTERN_C
 #elif defined(__PYX_EXTERN_C)
@@ -1213,25 +1248,25 @@
     #define __PYX_EXTERN_C extern
   #endif
 #endif
 
 #define __PYX_HAVE__pyseobnr__eob__dynamics__rhs_aligned
 #define __PYX_HAVE_API__pyseobnr__eob__dynamics__rhs_aligned
 /* Early includes */
-#include "eob_parameters.h"
 #include <string.h>
 #include <stdio.h>
 
     /* Using NumPy API declarations from "numpy/__init__.cython-30.pxd" */
     
 #include "numpy/arrayobject.h"
 #include "numpy/ndarrayobject.h"
 #include "numpy/ndarraytypes.h"
 #include "numpy/arrayscalars.h"
 #include "numpy/ufuncobject.h"
+#include "eob_parameters.h"
 #include "pythread.h"
 #include <stdlib.h>
 #ifdef _OPENMP
 #include <omp.h>
 #endif /* _OPENMP */
 
 #if defined(PYREX_WITHOUT_ASSERTIONS) && !defined(CYTHON_WITHOUT_ASSERTIONS)
@@ -1305,32 +1340,15 @@
 #define __Pyx_PyObject_AsSString(s)    ((const signed char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_AsUString(s)    ((const unsigned char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
 #define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
 #define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
 #define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
 #define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
-#if CYTHON_COMPILING_IN_LIMITED_API
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const wchar_t *u)
-{
-    const wchar_t *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#else
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
-{
-    const Py_UNICODE *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#endif
 #define __Pyx_PyUnicode_FromOrdinal(o)       PyUnicode_FromOrdinal((int)o)
-#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
-#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
 #define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
 #define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
 #define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
 static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
@@ -1516,18 +1534,18 @@
 
 /* #### Code section: filename_table ### */
 
 static const char *__pyx_f[] = {
   "pyseobnr/eob/dynamics/rhs_aligned.pyx",
   "<stringsource>",
   "__init__.cython-30.pxd",
+  "type.pxd",
   "pyseobnr/eob/utils/containers.pxd",
   "pyseobnr/eob/waveform/waveform.pxd",
   "pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd",
-  "type.pxd",
 };
 /* #### Code section: utility_code_proto_before_types ### */
 /* NoFastGil.proto */
 #define __Pyx_PyGILState_Ensure PyGILState_Ensure
 #define __Pyx_PyGILState_Release PyGILState_Release
 #define __Pyx_FastGIL_Remember()
 #define __Pyx_FastGIL_Forget()
@@ -1665,208 +1683,208 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
 /* #### Code section: complex_type_declarations ### */
 /* Declarations.proto */
 #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
   #ifdef __cplusplus
-    typedef ::std::complex< double > __pyx_t_double_complex;
+    typedef ::std::complex< float > __pyx_t_float_complex;
   #else
-    typedef double _Complex __pyx_t_double_complex;
+    typedef float _Complex __pyx_t_float_complex;
   #endif
 #else
-    typedef struct { double real, imag; } __pyx_t_double_complex;
+    typedef struct { float real, imag; } __pyx_t_float_complex;
 #endif
-static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double, double);
+static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float, float);
 
 /* Declarations.proto */
 #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
   #ifdef __cplusplus
-    typedef ::std::complex< float > __pyx_t_float_complex;
+    typedef ::std::complex< double > __pyx_t_double_complex;
   #else
-    typedef float _Complex __pyx_t_float_complex;
+    typedef double _Complex __pyx_t_double_complex;
   #endif
 #else
-    typedef struct { float real, imag; } __pyx_t_float_complex;
+    typedef struct { double real, imag; } __pyx_t_double_complex;
 #endif
-static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float, float);
+static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double, double);
 
 /* #### Code section: type_declarations ### */
 
 /*--- Type declarations ---*/
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs;
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics;
@@ -1875,64 +1893,64 @@
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce;
 struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
-struct __pyx_ctuple_double__and_double;
-typedef struct __pyx_ctuple_double__and_double __pyx_ctuple_double__and_double;
 
-/* "pyseobnr/eob/waveform/waveform.pxd":7
- *     const int ell_max
- * 
- * cpdef (double, double) RR_force(double[::1] q, double[::1] p, double omega, double omega_circ,             # <<<<<<<<<<<<<<
- *     double H, EOBParams eob_pars)
- * 
- */
-struct __pyx_ctuple_double__and_double {
-  double f0;
-  double f1;
-};
-
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
+struct __pyx_ctuple_double__and_double;
+typedef struct __pyx_ctuple_double__and_double __pyx_ctuple_double__and_double;
+
+/* "pyseobnr/eob/waveform/waveform.pxd":7
+ *     const int ell_max
+ * 
+ * cpdef (double, double) RR_force(             # <<<<<<<<<<<<<<
+ *     double[::1] q,
+ *     double[::1] p,
+ */
+struct __pyx_ctuple_double__and_double {
+  double f0;
+  double f1;
+};
 
 /* "pyseobnr/eob/utils/containers.pxd":8
  * 
  * 
  * cdef class PhysicalParams:             # <<<<<<<<<<<<<<
  *     cdef public double m_1,m_2,nu,M,X_1,X_2,delta,chi_1,chi_2,chi_S,chi_A,a,ap,am
  *     cdef public double chi1_L, chi2_L,a1,a2, H_val
@@ -2036,32 +2054,33 @@
   struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *flux_params;
   struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *dynamics;
   PyObject *mode_array;
   int aligned;
 };
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":10
- *     double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":15
+ *     EOBParams eob_pars)
  * 
  * cdef class RadiationReactionForce:             # <<<<<<<<<<<<<<
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,
- *         double omega_circ, double H, EOBParams eob_pars)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce {
   PyObject_HEAD
   struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_vtab;
 };
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":14
- *         double omega_circ, double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":25
+ *         EOBParams eob_pars)
  * 
  * cdef class SEOBNRv5RRForce(RadiationReactionForce):             # <<<<<<<<<<<<<<
- *     cpdef (double,double) RR(self, double[::1] q,double[::1] p,double omega,double omega_circ,double H,EOBParams eob_par)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce {
   struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce __pyx_base;
 };
 
 
 /* "pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd":6
@@ -2166,33 +2185,34 @@
 struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams {
   PyObject *(*update_spins)(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *, double, double, int __pyx_skip_dispatch);
   PyObject *(*_compute_derived_quants)(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *);
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":10
- *     double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":15
+ *     EOBParams eob_pars)
  * 
  * cdef class RadiationReactionForce:             # <<<<<<<<<<<<<<
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,
- *         double omega_circ, double H, EOBParams eob_pars)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 
 struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce {
   __pyx_ctuple_double__and_double (*RR)(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *, int __pyx_skip_dispatch);
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":14
- *         double omega_circ, double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":25
+ *         EOBParams eob_pars)
  * 
  * cdef class SEOBNRv5RRForce(RadiationReactionForce):             # <<<<<<<<<<<<<<
- *     cpdef (double,double) RR(self, double[::1] q,double[::1] p,double omega,double omega_circ,double H,EOBParams eob_par)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 
 struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce {
   struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce __pyx_base;
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce *__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce;
 
@@ -3174,30 +3194,30 @@
 
 /* SetupReduce.proto */
 #if !CYTHON_COMPILING_IN_LIMITED_API
 static int __Pyx_setup_reduce(PyObject* type_obj);
 #endif
 
 /* TypeImport.proto */
-#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_8
-#define __PYX_HAVE_RT_ImportType_proto_3_0_8
+#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_10
+#define __PYX_HAVE_RT_ImportType_proto_3_0_10
 #if defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L
 #include <stdalign.h>
 #endif
 #if (defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L) || __cplusplus >= 201103L
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) alignof(s)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) alignof(s)
 #else
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) sizeof(void*)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) sizeof(void*)
 #endif
-enum __Pyx_ImportType_CheckSize_3_0_8 {
-   __Pyx_ImportType_CheckSize_Error_3_0_8 = 0,
-   __Pyx_ImportType_CheckSize_Warn_3_0_8 = 1,
-   __Pyx_ImportType_CheckSize_Ignore_3_0_8 = 2
+enum __Pyx_ImportType_CheckSize_3_0_10 {
+   __Pyx_ImportType_CheckSize_Error_3_0_10 = 0,
+   __Pyx_ImportType_CheckSize_Warn_3_0_10 = 1,
+   __Pyx_ImportType_CheckSize_Ignore_3_0_10 = 2
 };
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size);
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size);
 #endif
 
 /* FetchSharedCythonModule.proto */
 static PyObject *__Pyx_FetchSharedCythonABIModule(void);
 
 /* FetchCommonType.proto */
 #if !CYTHON_USE_TYPE_SPECS
@@ -3451,52 +3471,14 @@
 #else
     #define __Pyx_SET_CREAL(z,x) __Pyx_CREAL(z) = (x)
     #define __Pyx_SET_CIMAG(z,y) __Pyx_CIMAG(z) = (y)
 #endif
 
 /* Arithmetic.proto */
 #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
-    #define __Pyx_c_eq_double(a, b)   ((a)==(b))
-    #define __Pyx_c_sum_double(a, b)  ((a)+(b))
-    #define __Pyx_c_diff_double(a, b) ((a)-(b))
-    #define __Pyx_c_prod_double(a, b) ((a)*(b))
-    #define __Pyx_c_quot_double(a, b) ((a)/(b))
-    #define __Pyx_c_neg_double(a)     (-(a))
-  #ifdef __cplusplus
-    #define __Pyx_c_is_zero_double(z) ((z)==(double)0)
-    #define __Pyx_c_conj_double(z)    (::std::conj(z))
-    #if 1
-        #define __Pyx_c_abs_double(z)     (::std::abs(z))
-        #define __Pyx_c_pow_double(a, b)  (::std::pow(a, b))
-    #endif
-  #else
-    #define __Pyx_c_is_zero_double(z) ((z)==0)
-    #define __Pyx_c_conj_double(z)    (conj(z))
-    #if 1
-        #define __Pyx_c_abs_double(z)     (cabs(z))
-        #define __Pyx_c_pow_double(a, b)  (cpow(a, b))
-    #endif
- #endif
-#else
-    static CYTHON_INLINE int __Pyx_c_eq_double(__pyx_t_double_complex, __pyx_t_double_complex);
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_sum_double(__pyx_t_double_complex, __pyx_t_double_complex);
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_diff_double(__pyx_t_double_complex, __pyx_t_double_complex);
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_prod_double(__pyx_t_double_complex, __pyx_t_double_complex);
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex, __pyx_t_double_complex);
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_neg_double(__pyx_t_double_complex);
-    static CYTHON_INLINE int __Pyx_c_is_zero_double(__pyx_t_double_complex);
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj_double(__pyx_t_double_complex);
-    #if 1
-        static CYTHON_INLINE double __Pyx_c_abs_double(__pyx_t_double_complex);
-        static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow_double(__pyx_t_double_complex, __pyx_t_double_complex);
-    #endif
-#endif
-
-/* Arithmetic.proto */
-#if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
     #define __Pyx_c_eq_float(a, b)   ((a)==(b))
     #define __Pyx_c_sum_float(a, b)  ((a)+(b))
     #define __Pyx_c_diff_float(a, b) ((a)-(b))
     #define __Pyx_c_prod_float(a, b) ((a)*(b))
     #define __Pyx_c_quot_float(a, b) ((a)/(b))
     #define __Pyx_c_neg_float(a)     (-(a))
   #ifdef __cplusplus
@@ -3525,14 +3507,52 @@
     static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_conj_float(__pyx_t_float_complex);
     #if 1
         static CYTHON_INLINE float __Pyx_c_abs_float(__pyx_t_float_complex);
         static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_pow_float(__pyx_t_float_complex, __pyx_t_float_complex);
     #endif
 #endif
 
+/* Arithmetic.proto */
+#if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
+    #define __Pyx_c_eq_double(a, b)   ((a)==(b))
+    #define __Pyx_c_sum_double(a, b)  ((a)+(b))
+    #define __Pyx_c_diff_double(a, b) ((a)-(b))
+    #define __Pyx_c_prod_double(a, b) ((a)*(b))
+    #define __Pyx_c_quot_double(a, b) ((a)/(b))
+    #define __Pyx_c_neg_double(a)     (-(a))
+  #ifdef __cplusplus
+    #define __Pyx_c_is_zero_double(z) ((z)==(double)0)
+    #define __Pyx_c_conj_double(z)    (::std::conj(z))
+    #if 1
+        #define __Pyx_c_abs_double(z)     (::std::abs(z))
+        #define __Pyx_c_pow_double(a, b)  (::std::pow(a, b))
+    #endif
+  #else
+    #define __Pyx_c_is_zero_double(z) ((z)==0)
+    #define __Pyx_c_conj_double(z)    (conj(z))
+    #if 1
+        #define __Pyx_c_abs_double(z)     (cabs(z))
+        #define __Pyx_c_pow_double(a, b)  (cpow(a, b))
+    #endif
+ #endif
+#else
+    static CYTHON_INLINE int __Pyx_c_eq_double(__pyx_t_double_complex, __pyx_t_double_complex);
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_sum_double(__pyx_t_double_complex, __pyx_t_double_complex);
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_diff_double(__pyx_t_double_complex, __pyx_t_double_complex);
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_prod_double(__pyx_t_double_complex, __pyx_t_double_complex);
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex, __pyx_t_double_complex);
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_neg_double(__pyx_t_double_complex);
+    static CYTHON_INLINE int __Pyx_c_is_zero_double(__pyx_t_double_complex);
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj_double(__pyx_t_double_complex);
+    #if 1
+        static CYTHON_INLINE double __Pyx_c_abs_double(__pyx_t_double_complex);
+        static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow_double(__pyx_t_double_complex, __pyx_t_double_complex);
+    #endif
+#endif
+
 /* MemviewSliceCopyTemplate.proto */
 static __Pyx_memviewslice
 __pyx_memoryview_copy_new_contig(const __Pyx_memviewslice *from_mvs,
                                  const char *mode, int ndim,
                                  size_t sizeof_dtype, int contig_flag,
                                  int dtype_is_object);
 
@@ -3592,17 +3612,14 @@
 #define __Pyx_DECREF_TypeName(obj)
 #endif
 
 /* CheckBinaryVersion.proto */
 static unsigned long __Pyx_get_runtime_version(void);
 static int __Pyx_check_binary_version(unsigned long ct_version, unsigned long rt_version, int allow_newer);
 
-/* FunctionImport.proto */
-static int __Pyx_ImportFunction_3_0_8(PyObject *module, const char *funcname, void (**f)(void), const char *sig);
-
 /* InitStrings.proto */
 static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);
 
 /* #### Code section: module_declarations ### */
 static PyObject *__pyx_array_get_memview(struct __pyx_array_obj *__pyx_v_self); /* proto*/
 static char *__pyx_memoryview_get_item_pointer(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_index); /* proto*/
 static PyObject *__pyx_memoryview_is_slice(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_obj); /* proto*/
@@ -3619,27 +3636,14 @@
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self); /* proto*/
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self); /* proto*/
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self); /* proto*/
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self); /* proto*/
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self); /* proto*/
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self); /* proto*/
 
-/* Module declarations from "cython.view" */
-
-/* Module declarations from "cython.dataclasses" */
-
-/* Module declarations from "cython" */
-
-/* Module declarations from "pyseobnr.eob.utils.containers" */
-
-/* Module declarations from "pyseobnr.eob.waveform.waveform" */
-static __pyx_ctuple_double__and_double (*__pyx_f_8pyseobnr_3eob_8waveform_8waveform_RR_force)(__Pyx_memviewslice, __Pyx_memviewslice, double, double, double, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *, int __pyx_skip_dispatch); /*proto*/
-
-/* Module declarations from "pyseobnr.eob.hamiltonian.Hamiltonian_C" */
-
 /* Module declarations from "libc.string" */
 
 /* Module declarations from "libc.stdio" */
 
 /* Module declarations from "__builtin__" */
 
 /* Module declarations from "cpython.type" */
@@ -3650,14 +3654,26 @@
 
 /* Module declarations from "cpython.ref" */
 
 /* Module declarations from "numpy" */
 
 /* Module declarations from "numpy" */
 
+/* Module declarations from "pyseobnr.eob.utils.containers" */
+
+/* Module declarations from "pyseobnr.eob.waveform.waveform" */
+
+/* Module declarations from "cython.view" */
+
+/* Module declarations from "cython.dataclasses" */
+
+/* Module declarations from "cython" */
+
+/* Module declarations from "pyseobnr.eob.hamiltonian.Hamiltonian_C" */
+
 /* Module declarations from "pyseobnr.eob.dynamics.rhs_aligned" */
 static PyObject *__pyx_collections_abc_Sequence = 0;
 static PyObject *generic = 0;
 static PyObject *strided = 0;
 static PyObject *indirect = 0;
 static PyObject *contiguous = 0;
 static PyObject *indirect_contiguous = 0;
@@ -3943,34 +3959,14 @@
   #endif
   #if CYTHON_USE_MODULE_STATE
   #endif
   #if CYTHON_USE_MODULE_STATE
   #endif
   #if CYTHON_USE_MODULE_STATE
   #endif
-  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
-  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs;
-  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics;
-  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams;
-  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams;
-  #if CYTHON_USE_MODULE_STATE
-  #endif
-  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
-  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce;
-  #if CYTHON_USE_MODULE_STATE
-  #endif
-  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
-  #if CYTHON_USE_MODULE_STATE
-  #endif
-  #if CYTHON_USE_MODULE_STATE
-  #endif
-  #if CYTHON_USE_MODULE_STATE
-  #endif
-  #if CYTHON_USE_MODULE_STATE
-  #endif
   PyTypeObject *__pyx_ptype_7cpython_4type_type;
   #if CYTHON_USE_MODULE_STATE
   #endif
   #if CYTHON_USE_MODULE_STATE
   #endif
   #if CYTHON_USE_MODULE_STATE
   #endif
@@ -3990,14 +3986,34 @@
   PyTypeObject *__pyx_ptype_5numpy_inexact;
   PyTypeObject *__pyx_ptype_5numpy_floating;
   PyTypeObject *__pyx_ptype_5numpy_complexfloating;
   PyTypeObject *__pyx_ptype_5numpy_flexible;
   PyTypeObject *__pyx_ptype_5numpy_character;
   PyTypeObject *__pyx_ptype_5numpy_ufunc;
   #if CYTHON_USE_MODULE_STATE
+  #endif
+  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
+  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs;
+  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics;
+  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams;
+  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams;
+  #if CYTHON_USE_MODULE_STATE
+  #endif
+  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
+  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce;
+  #if CYTHON_USE_MODULE_STATE
+  #endif
+  #if CYTHON_USE_MODULE_STATE
+  #endif
+  #if CYTHON_USE_MODULE_STATE
+  #endif
+  #if CYTHON_USE_MODULE_STATE
+  #endif
+  PyTypeObject *__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
+  #if CYTHON_USE_MODULE_STATE
   PyObject *__pyx_type___pyx_array;
   PyObject *__pyx_type___pyx_MemviewEnum;
   PyObject *__pyx_type___pyx_memoryview;
   PyObject *__pyx_type___pyx_memoryviewslice;
   #endif
   PyTypeObject *__pyx_array_type;
   PyTypeObject *__pyx_MemviewEnum_type;
@@ -4210,22 +4226,14 @@
   Py_CLEAR(clear_module_state->__pyx_empty_unicode);
   #ifdef __Pyx_CyFunction_USED
   Py_CLEAR(clear_module_state->__pyx_CyFunctionType);
   #endif
   #ifdef __Pyx_FusedFunction_USED
   Py_CLEAR(clear_module_state->__pyx_FusedFunctionType);
   #endif
-  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams);
-  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs);
-  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics);
-  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams);
-  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams);
-  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce);
-  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce);
-  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C);
   Py_CLEAR(clear_module_state->__pyx_ptype_7cpython_4type_type);
   Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_dtype);
   Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_flatiter);
   Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_broadcast);
   Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_ndarray);
   Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_generic);
   Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_number);
@@ -4234,14 +4242,22 @@
   Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_unsignedinteger);
   Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_inexact);
   Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_floating);
   Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_complexfloating);
   Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_flexible);
   Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_character);
   Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_ufunc);
+  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams);
+  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs);
+  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics);
+  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams);
+  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams);
+  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce);
+  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce);
+  Py_CLEAR(clear_module_state->__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C);
   Py_CLEAR(clear_module_state->__pyx_array_type);
   Py_CLEAR(clear_module_state->__pyx_type___pyx_array);
   Py_CLEAR(clear_module_state->__pyx_MemviewEnum_type);
   Py_CLEAR(clear_module_state->__pyx_type___pyx_MemviewEnum);
   Py_CLEAR(clear_module_state->__pyx_memoryview_type);
   Py_CLEAR(clear_module_state->__pyx_type___pyx_memoryview);
   Py_CLEAR(clear_module_state->__pyx_memoryviewslice_type);
@@ -4431,22 +4447,14 @@
   Py_VISIT(traverse_module_state->__pyx_empty_unicode);
   #ifdef __Pyx_CyFunction_USED
   Py_VISIT(traverse_module_state->__pyx_CyFunctionType);
   #endif
   #ifdef __Pyx_FusedFunction_USED
   Py_VISIT(traverse_module_state->__pyx_FusedFunctionType);
   #endif
-  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams);
-  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs);
-  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics);
-  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams);
-  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams);
-  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce);
-  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce);
-  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C);
   Py_VISIT(traverse_module_state->__pyx_ptype_7cpython_4type_type);
   Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_dtype);
   Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_flatiter);
   Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_broadcast);
   Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_ndarray);
   Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_generic);
   Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_number);
@@ -4455,14 +4463,22 @@
   Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_unsignedinteger);
   Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_inexact);
   Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_floating);
   Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_complexfloating);
   Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_flexible);
   Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_character);
   Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_ufunc);
+  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams);
+  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs);
+  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics);
+  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams);
+  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams);
+  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce);
+  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce);
+  Py_VISIT(traverse_module_state->__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C);
   Py_VISIT(traverse_module_state->__pyx_array_type);
   Py_VISIT(traverse_module_state->__pyx_type___pyx_array);
   Py_VISIT(traverse_module_state->__pyx_MemviewEnum_type);
   Py_VISIT(traverse_module_state->__pyx_type___pyx_MemviewEnum);
   Py_VISIT(traverse_module_state->__pyx_memoryview_type);
   Py_VISIT(traverse_module_state->__pyx_type___pyx_memoryview);
   Py_VISIT(traverse_module_state->__pyx_memoryviewslice_type);
@@ -4668,34 +4684,14 @@
 #endif
 #if CYTHON_USE_MODULE_STATE
 #endif
 #if CYTHON_USE_MODULE_STATE
 #endif
 #if CYTHON_USE_MODULE_STATE
 #endif
-#define __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams
-#define __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs
-#define __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics
-#define __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams
-#define __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams
-#if CYTHON_USE_MODULE_STATE
-#endif
-#define __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce
-#define __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce
-#if CYTHON_USE_MODULE_STATE
-#endif
-#define __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C
-#if CYTHON_USE_MODULE_STATE
-#endif
-#if CYTHON_USE_MODULE_STATE
-#endif
-#if CYTHON_USE_MODULE_STATE
-#endif
-#if CYTHON_USE_MODULE_STATE
-#endif
 #define __pyx_ptype_7cpython_4type_type __pyx_mstate_global->__pyx_ptype_7cpython_4type_type
 #if CYTHON_USE_MODULE_STATE
 #endif
 #if CYTHON_USE_MODULE_STATE
 #endif
 #if CYTHON_USE_MODULE_STATE
 #endif
@@ -4715,14 +4711,34 @@
 #define __pyx_ptype_5numpy_inexact __pyx_mstate_global->__pyx_ptype_5numpy_inexact
 #define __pyx_ptype_5numpy_floating __pyx_mstate_global->__pyx_ptype_5numpy_floating
 #define __pyx_ptype_5numpy_complexfloating __pyx_mstate_global->__pyx_ptype_5numpy_complexfloating
 #define __pyx_ptype_5numpy_flexible __pyx_mstate_global->__pyx_ptype_5numpy_flexible
 #define __pyx_ptype_5numpy_character __pyx_mstate_global->__pyx_ptype_5numpy_character
 #define __pyx_ptype_5numpy_ufunc __pyx_mstate_global->__pyx_ptype_5numpy_ufunc
 #if CYTHON_USE_MODULE_STATE
+#endif
+#define __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams
+#define __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs
+#define __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics
+#define __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams
+#define __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams
+#if CYTHON_USE_MODULE_STATE
+#endif
+#define __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce
+#define __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce
+#if CYTHON_USE_MODULE_STATE
+#endif
+#if CYTHON_USE_MODULE_STATE
+#endif
+#if CYTHON_USE_MODULE_STATE
+#endif
+#if CYTHON_USE_MODULE_STATE
+#endif
+#define __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C __pyx_mstate_global->__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C
+#if CYTHON_USE_MODULE_STATE
 #define __pyx_type___pyx_array __pyx_mstate_global->__pyx_type___pyx_array
 #define __pyx_type___pyx_MemviewEnum __pyx_mstate_global->__pyx_type___pyx_MemviewEnum
 #define __pyx_type___pyx_memoryview __pyx_mstate_global->__pyx_type___pyx_memoryview
 #define __pyx_type___pyx_memoryviewslice __pyx_mstate_global->__pyx_type___pyx_memoryviewslice
 #endif
 #define __pyx_array_type __pyx_mstate_global->__pyx_array_type
 #define __pyx_MemviewEnum_type __pyx_mstate_global->__pyx_MemviewEnum_type
@@ -19115,261 +19131,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19378,29 +19394,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19411,15 +19427,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19428,29 +19444,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19461,15 +19477,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19478,29 +19494,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19511,15 +19527,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19528,29 +19544,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19561,15 +19577,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19578,29 +19594,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19611,217 +19627,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":969
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":970
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":970
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 970, __pyx_L1_error)
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":973
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":975
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":975
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":976
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":976
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19837,15 +19853,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -19853,68 +19869,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":982
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":982
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 982, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":983
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":983
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 984, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 984, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19922,15 +19938,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19945,15 +19961,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19969,15 +19985,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19985,68 +20001,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":988
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":988
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 988, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":989
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":989
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 990, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 990, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -20054,15 +20070,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20077,15 +20093,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20101,15 +20117,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -20117,68 +20133,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":994
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":994
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 994, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":995
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":995
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":996
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":996
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 996, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 996, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -20186,15 +20202,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20209,188 +20225,188 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1011
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1011
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1026
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1026
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1036
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1036
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1043
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1043
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1050
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1050
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/dynamics/rhs_aligned.pyx":14
- * cimport numpy as np
+/* "pyseobnr/eob/dynamics/rhs_aligned.pyx":16
  * 
- * cpdef get_rhs(double t,double[::1] z,Hamiltonian_C H,RadiationReactionForce RR,             # <<<<<<<<<<<<<<
- *     double chi_1,double chi_2,double m_1,double m_2,EOBParams params):
- *     """
+ * 
+ * cpdef get_rhs(             # <<<<<<<<<<<<<<
+ *     double t,
+ *     double[::1] z,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8dynamics_11rhs_aligned_1get_rhs(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
@@ -20419,24 +20435,24 @@
   __pyx_ctuple_double__and_double __pyx_t_8;
   double __pyx_t_9[4];
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__11)
   __Pyx_RefNannySetupContext("get_rhs", 1);
-  __Pyx_TraceCall("get_rhs", __pyx_f[0], 14, 0, __PYX_ERR(0, 14, __pyx_L1_error));
+  __Pyx_TraceCall("get_rhs", __pyx_f[0], 16, 0, __PYX_ERR(0, 16, __pyx_L1_error));
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":29
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":44
  * 
  *     """
  *     cdef double[::1] q = z[:2]             # <<<<<<<<<<<<<<
  *     cdef double[::1] p = z[2:]
  * 
  */
-  __Pyx_TraceLine(29,0,__PYX_ERR(0, 29, __pyx_L1_error))
+  __Pyx_TraceLine(44,0,__PYX_ERR(0, 44, __pyx_L1_error))
   __pyx_t_1.data = __pyx_v_z.data;
   __pyx_t_1.memview = __pyx_v_z.memview;
   __PYX_INC_MEMVIEW(&__pyx_t_1, 1);
   __pyx_t_2 = -1;
   if (unlikely(__pyx_memoryview_slice_memviewslice(
     &__pyx_t_1,
     __pyx_v_z.shape[0], __pyx_v_z.strides[0], __pyx_v_z.suboffsets[0],
@@ -20447,29 +20463,29 @@
     2,
     0,
     0,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 29, __pyx_L1_error)
+    __PYX_ERR(0, 44, __pyx_L1_error)
 }
 
 __pyx_v_q = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":30
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":45
  *     """
  *     cdef double[::1] q = z[:2]
  *     cdef double[::1] p = z[2:]             # <<<<<<<<<<<<<<
  * 
- *     cdef double H_val,omega,omega_circ,xi
+ *     cdef double H_val, omega, omega_circ, xi
  */
-  __Pyx_TraceLine(30,0,__PYX_ERR(0, 30, __pyx_L1_error))
+  __Pyx_TraceLine(45,0,__PYX_ERR(0, 45, __pyx_L1_error))
   __pyx_t_1.data = __pyx_v_z.data;
   __pyx_t_1.memview = __pyx_v_z.memview;
   __PYX_INC_MEMVIEW(&__pyx_t_1, 1);
   __pyx_t_2 = -1;
   if (unlikely(__pyx_memoryview_slice_memviewslice(
     &__pyx_t_1,
     __pyx_v_z.shape[0], __pyx_v_z.strides[0], __pyx_v_z.suboffsets[0],
@@ -20480,134 +20496,134 @@
     0,
     0,
     1,
     0,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 30, __pyx_L1_error)
+    __PYX_ERR(0, 45, __pyx_L1_error)
 }
 
 __pyx_v_p = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":34
- *     cdef double H_val,omega,omega_circ,xi
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":49
+ *     cdef double H_val, omega, omega_circ, xi
  *     cdef double dynamics[6]
  *     dynamics[:] = H.dynamics(q, p, chi_1, chi_2, m_1, m_2)             # <<<<<<<<<<<<<<
  *     H_val = dynamics[4]
  *     omega = dynamics[3]
  */
-  __Pyx_TraceLine(34,0,__PYX_ERR(0, 34, __pyx_L1_error))
-  __pyx_t_3 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_H->__pyx_vtab)->dynamics(__pyx_v_H, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 34, __pyx_L1_error)
+  __Pyx_TraceLine(49,0,__PYX_ERR(0, 49, __pyx_L1_error))
+  __pyx_t_3 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_H->__pyx_vtab)->dynamics(__pyx_v_H, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 49, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (unlikely((__Pyx_carray_from_py_double(__pyx_t_3, __pyx_t_4, 6) < 0))) __PYX_ERR(0, 34, __pyx_L1_error)
+  if (unlikely((__Pyx_carray_from_py_double(__pyx_t_3, __pyx_t_4, 6) < 0))) __PYX_ERR(0, 49, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   memcpy(&(__pyx_v_dynamics[0]), __pyx_t_4, sizeof(__pyx_v_dynamics[0]) * (6));
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":35
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":50
  *     cdef double dynamics[6]
  *     dynamics[:] = H.dynamics(q, p, chi_1, chi_2, m_1, m_2)
  *     H_val = dynamics[4]             # <<<<<<<<<<<<<<
  *     omega = dynamics[3]
  *     params.dynamics.p_circ[1] = p[1]
  */
-  __Pyx_TraceLine(35,0,__PYX_ERR(0, 35, __pyx_L1_error))
+  __Pyx_TraceLine(50,0,__PYX_ERR(0, 50, __pyx_L1_error))
   __pyx_v_H_val = (__pyx_v_dynamics[4]);
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":36
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":51
  *     dynamics[:] = H.dynamics(q, p, chi_1, chi_2, m_1, m_2)
  *     H_val = dynamics[4]
  *     omega = dynamics[3]             # <<<<<<<<<<<<<<
  *     params.dynamics.p_circ[1] = p[1]
  * 
  */
-  __Pyx_TraceLine(36,0,__PYX_ERR(0, 36, __pyx_L1_error))
+  __Pyx_TraceLine(51,0,__PYX_ERR(0, 51, __pyx_L1_error))
   __pyx_v_omega = (__pyx_v_dynamics[3]);
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":37
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":52
  *     H_val = dynamics[4]
  *     omega = dynamics[3]
  *     params.dynamics.p_circ[1] = p[1]             # <<<<<<<<<<<<<<
  * 
  *     omega_circ = H.omega(q, params.dynamics.p_circ, chi_1, chi_2, m_1, m_2)
  */
-  __Pyx_TraceLine(37,0,__PYX_ERR(0, 37, __pyx_L1_error))
+  __Pyx_TraceLine(52,0,__PYX_ERR(0, 52, __pyx_L1_error))
   __pyx_t_5 = 1;
   __pyx_t_6 = 1;
   *((double *) ( /* dim=0 */ (__pyx_v_params->dynamics->p_circ.data + __pyx_t_6 * __pyx_v_params->dynamics->p_circ.strides[0]) )) = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_p.data) + __pyx_t_5)) )));
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":39
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":54
  *     params.dynamics.p_circ[1] = p[1]
  * 
  *     omega_circ = H.omega(q, params.dynamics.p_circ, chi_1, chi_2, m_1, m_2)             # <<<<<<<<<<<<<<
  * 
  *     xi = dynamics[5]
  */
-  __Pyx_TraceLine(39,0,__PYX_ERR(0, 39, __pyx_L1_error))
-  __pyx_t_7 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_H->__pyx_vtab)->omega(__pyx_v_H, __pyx_v_q, __pyx_v_params->dynamics->p_circ, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 39, __pyx_L1_error)
+  __Pyx_TraceLine(54,0,__PYX_ERR(0, 54, __pyx_L1_error))
+  __pyx_t_7 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_H->__pyx_vtab)->omega(__pyx_v_H, __pyx_v_q, __pyx_v_params->dynamics->p_circ, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 54, __pyx_L1_error)
   __pyx_v_omega_circ = __pyx_t_7;
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":41
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":56
  *     omega_circ = H.omega(q, params.dynamics.p_circ, chi_1, chi_2, m_1, m_2)
  * 
  *     xi = dynamics[5]             # <<<<<<<<<<<<<<
  * 
  *     cdef (double, double) RR_f = RR.RR(q, p, omega, omega_circ, H_val, params)
  */
-  __Pyx_TraceLine(41,0,__PYX_ERR(0, 41, __pyx_L1_error))
+  __Pyx_TraceLine(56,0,__PYX_ERR(0, 56, __pyx_L1_error))
   __pyx_v_xi = (__pyx_v_dynamics[5]);
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":43
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":58
  *     xi = dynamics[5]
  * 
  *     cdef (double, double) RR_f = RR.RR(q, p, omega, omega_circ, H_val, params)             # <<<<<<<<<<<<<<
  * 
  *     cdef double deriv[4]
  */
-  __Pyx_TraceLine(43,0,__PYX_ERR(0, 43, __pyx_L1_error))
-  __pyx_t_8 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *)__pyx_v_RR->__pyx_vtab)->RR(__pyx_v_RR, __pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H_val, __pyx_v_params, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 43, __pyx_L1_error)
+  __Pyx_TraceLine(58,0,__PYX_ERR(0, 58, __pyx_L1_error))
+  __pyx_t_8 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *)__pyx_v_RR->__pyx_vtab)->RR(__pyx_v_RR, __pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H_val, __pyx_v_params, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 58, __pyx_L1_error)
   __pyx_v_RR_f = __pyx_t_8;
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":46
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":61
  * 
  *     cdef double deriv[4]
  *     deriv[:] = [xi * dynamics[2], dynamics[3], -dynamics[0] * xi + RR_f[0], -dynamics[1] + RR_f[1]]             # <<<<<<<<<<<<<<
  *     return deriv
  * 
  */
-  __Pyx_TraceLine(46,0,__PYX_ERR(0, 46, __pyx_L1_error))
+  __Pyx_TraceLine(61,0,__PYX_ERR(0, 61, __pyx_L1_error))
   __pyx_t_9[0] = (__pyx_v_xi * (__pyx_v_dynamics[2]));
   __pyx_t_9[1] = (__pyx_v_dynamics[3]);
   __pyx_t_9[2] = (((-(__pyx_v_dynamics[0])) * __pyx_v_xi) + __pyx_v_RR_f.f0);
   __pyx_t_9[3] = ((-(__pyx_v_dynamics[1])) + __pyx_v_RR_f.f1);
   memcpy(&(__pyx_v_deriv[0]), __pyx_t_9, sizeof(__pyx_v_deriv[0]) * (4));
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":47
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":62
  *     cdef double deriv[4]
  *     deriv[:] = [xi * dynamics[2], dynamics[3], -dynamics[0] * xi + RR_f[0], -dynamics[1] + RR_f[1]]
  *     return deriv             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_TraceLine(47,0,__PYX_ERR(0, 47, __pyx_L1_error))
+  __Pyx_TraceLine(62,0,__PYX_ERR(0, 62, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_carray_to_py_double(__pyx_v_deriv, 4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 47, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_carray_to_py_double(__pyx_v_deriv, 4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 62, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":14
- * cimport numpy as np
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":16
  * 
- * cpdef get_rhs(double t,double[::1] z,Hamiltonian_C H,RadiationReactionForce RR,             # <<<<<<<<<<<<<<
- *     double chi_1,double chi_2,double m_1,double m_2,EOBParams params):
- *     """
+ * 
+ * cpdef get_rhs(             # <<<<<<<<<<<<<<
+ *     double t,
+ *     double[::1] z,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_1, 1);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_AddTraceback("pyseobnr.eob.dynamics.rhs_aligned.get_rhs", __pyx_clineno, __pyx_lineno, __pyx_filename);
@@ -20625,15 +20641,15 @@
 static PyObject *__pyx_pw_8pyseobnr_3eob_8dynamics_11rhs_aligned_1get_rhs(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-PyDoc_STRVAR(__pyx_doc_8pyseobnr_3eob_8dynamics_11rhs_aligned_get_rhs, "\n    Compute the RHS of the EOB evolution equations.\n    In particular this function returns\n    :math:`\\dot{r}`, :math:`\\dot{\\phi}` , :math:`\\dot{p}_{r}` and :math:`\\dot{p}_{\\phi}` .\n\n    See for example Eq(2) of [Buades2021]_ .\n\n    The Hamiltonian is given by Eq(14) in [SEOBNRv5HM]_ doc\n    and explicitly spelled out in Section I.C of [SEOBNRv5HM-theory]_\n    and the RR force is described in Eq(43) of [SEOBNRv5HM]_ document, both\n    contained in [DCC_T2300060]_ .\n\n    ");
+PyDoc_STRVAR(__pyx_doc_8pyseobnr_3eob_8dynamics_11rhs_aligned_get_rhs, "\n    Compute the RHS of the EOB evolution equations.\n    In particular this function returns\n\n    * :math:`\\dot{r}`,\n    * :math:`\\dot{\\phi}`,\n    * :math:`\\dot{p}_{r}`,\n    * and :math:`\\dot{p}_{\\phi}`.\n\n    See for example Eq(2) of [Buades2021]_ .\n\n    The Hamiltonian is given by Eq(14) in [SEOBNRv5HM]_ doc\n    and explicitly spelled out in Section I.C of [SEOBNRv5HM-theory]_\n    and the RR force is described in Eq(43) of [SEOBNRv5HM]_ document, both\n    contained in [DCC_T2300060]_ .\n\n    ");
 static PyMethodDef __pyx_mdef_8pyseobnr_3eob_8dynamics_11rhs_aligned_1get_rhs = {"get_rhs", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8pyseobnr_3eob_8dynamics_11rhs_aligned_1get_rhs, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8pyseobnr_3eob_8dynamics_11rhs_aligned_get_rhs};
 static PyObject *__pyx_pw_8pyseobnr_3eob_8dynamics_11rhs_aligned_1get_rhs(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
@@ -20695,144 +20711,144 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 14, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 16, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 14, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 16, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 1); __PYX_ERR(0, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 1); __PYX_ERR(0, 16, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_H)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 14, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 16, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 2); __PYX_ERR(0, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 2); __PYX_ERR(0, 16, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_RR)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 14, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 16, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 3); __PYX_ERR(0, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 3); __PYX_ERR(0, 16, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_chi_1)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 14, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 16, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 4); __PYX_ERR(0, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 4); __PYX_ERR(0, 16, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_chi_2)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[5]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 14, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 16, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 5); __PYX_ERR(0, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 5); __PYX_ERR(0, 16, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_m_1)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[6]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 14, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 16, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 6); __PYX_ERR(0, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 6); __PYX_ERR(0, 16, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_m_2)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[7]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 14, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 16, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 7); __PYX_ERR(0, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 7); __PYX_ERR(0, 16, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
         if (likely((values[8] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_params)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[8]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 14, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 16, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 8); __PYX_ERR(0, 14, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, 8); __PYX_ERR(0, 16, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "get_rhs") < 0)) __PYX_ERR(0, 14, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "get_rhs") < 0)) __PYX_ERR(0, 16, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 9)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
       values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
       values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
       values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
       values[6] = __Pyx_Arg_FASTCALL(__pyx_args, 6);
       values[7] = __Pyx_Arg_FASTCALL(__pyx_args, 7);
       values[8] = __Pyx_Arg_FASTCALL(__pyx_args, 8);
     }
-    __pyx_v_t = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_t == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 14, __pyx_L3_error)
-    __pyx_v_z = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_z.memview)) __PYX_ERR(0, 14, __pyx_L3_error)
+    __pyx_v_t = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_t == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 17, __pyx_L3_error)
+    __pyx_v_z = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_z.memview)) __PYX_ERR(0, 18, __pyx_L3_error)
     __pyx_v_H = ((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)values[2]);
     __pyx_v_RR = ((struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *)values[3]);
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 15, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 15, __pyx_L3_error)
-    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 15, __pyx_L3_error)
-    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 15, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 21, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 22, __pyx_L3_error)
+    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
+    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 24, __pyx_L3_error)
     __pyx_v_params = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)values[8]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, __pyx_nargs); __PYX_ERR(0, 14, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("get_rhs", 1, 9, 9, __pyx_nargs); __PYX_ERR(0, 16, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_z, 1);
   __Pyx_AddTraceback("pyseobnr.eob.dynamics.rhs_aligned.get_rhs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_H), __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, 1, "H", 0))) __PYX_ERR(0, 14, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_RR), __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce, 1, "RR", 0))) __PYX_ERR(0, 14, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_params), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "params", 0))) __PYX_ERR(0, 15, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_H), __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, 1, "H", 0))) __PYX_ERR(0, 19, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_RR), __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce, 1, "RR", 0))) __PYX_ERR(0, 20, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_params), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "params", 0))) __PYX_ERR(0, 25, __pyx_L1_error)
   __pyx_r = __pyx_pf_8pyseobnr_3eob_8dynamics_11rhs_aligned_get_rhs(__pyx_self, __pyx_v_t, __pyx_v_z, __pyx_v_H, __pyx_v_RR, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_params);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -20853,17 +20869,17 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__11)
   __Pyx_RefNannySetupContext("get_rhs", 1);
-  __Pyx_TraceCall("get_rhs (wrapper)", __pyx_f[0], 14, 0, __PYX_ERR(0, 14, __pyx_L1_error));
+  __Pyx_TraceCall("get_rhs (wrapper)", __pyx_f[0], 16, 0, __PYX_ERR(0, 16, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_11rhs_aligned_get_rhs(__pyx_v_t, __pyx_v_z, __pyx_v_H, __pyx_v_RR, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_params, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 14, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_11rhs_aligned_get_rhs(__pyx_v_t, __pyx_v_z, __pyx_v_H, __pyx_v_RR, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_params, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -20873,20 +20889,20 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/dynamics/rhs_aligned.pyx":50
- * 
+/* "pyseobnr/eob/dynamics/rhs_aligned.pyx":65
  * 
- * cpdef augment_dynamics(double[:,:] dynamics, double chi_1, double chi_2, double m_1, double m_2, Hamiltonian_C  H):             # <<<<<<<<<<<<<<
- *     """Compute dynamical quantities we need for the waveform
  * 
+ * cpdef augment_dynamics(             # <<<<<<<<<<<<<<
+ *     double[:, :] dynamics,
+ *     double chi_1,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8dynamics_11rhs_aligned_3augment_dynamics(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
@@ -20922,40 +20938,40 @@
   PyObject *__pyx_t_13 = NULL;
   int __pyx_t_14;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__12)
   __Pyx_RefNannySetupContext("augment_dynamics", 1);
-  __Pyx_TraceCall("augment_dynamics", __pyx_f[0], 50, 0, __PYX_ERR(0, 50, __pyx_L1_error));
+  __Pyx_TraceCall("augment_dynamics", __pyx_f[0], 65, 0, __PYX_ERR(0, 65, __pyx_L1_error));
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":56
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":78
  *         dynamics (np,ndarray): The dynamics array: t,r,phi,pr,pphi
  *     """
  *     result = []             # <<<<<<<<<<<<<<
  *     cdef double[:] p_c = np.zeros(2)
- *     cdef double H_val,omega,omega_c,xi
+ *     cdef double H_val, omega, omega_c
  */
-  __Pyx_TraceLine(56,0,__PYX_ERR(0, 56, __pyx_L1_error))
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 56, __pyx_L1_error)
+  __Pyx_TraceLine(78,0,__PYX_ERR(0, 78, __pyx_L1_error))
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 78, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_result = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":57
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":79
  *     """
  *     result = []
  *     cdef double[:] p_c = np.zeros(2)             # <<<<<<<<<<<<<<
- *     cdef double H_val,omega,omega_c,xi
+ *     cdef double H_val, omega, omega_c
  *     cdef double dyn[6]
  */
-  __Pyx_TraceLine(57,0,__PYX_ERR(0, 57, __pyx_L1_error))
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 57, __pyx_L1_error)
+  __Pyx_TraceLine(79,0,__PYX_ERR(0, 79, __pyx_L1_error))
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 79, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 57, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 79, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -20968,55 +20984,55 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_int_2};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 57, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 79, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 57, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 79, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_p_c = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":64
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":86
  *     cdef double[:] row
- *     cdef int i,N
+ *     cdef int i, N
  *     N = dynamics.shape[0]             # <<<<<<<<<<<<<<
  * 
  *     for i in range(N):
  */
-  __Pyx_TraceLine(64,0,__PYX_ERR(0, 64, __pyx_L1_error))
+  __Pyx_TraceLine(86,0,__PYX_ERR(0, 86, __pyx_L1_error))
   __pyx_v_N = (__pyx_v_dynamics.shape[0]);
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":66
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":88
  *     N = dynamics.shape[0]
  * 
  *     for i in range(N):             # <<<<<<<<<<<<<<
  *         row = dynamics[i]
  *         q = row[1:3]
  */
-  __Pyx_TraceLine(66,0,__PYX_ERR(0, 66, __pyx_L1_error))
+  __Pyx_TraceLine(88,0,__PYX_ERR(0, 88, __pyx_L1_error))
   __pyx_t_4 = __pyx_v_N;
   __pyx_t_6 = __pyx_t_4;
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
     __pyx_v_i = __pyx_t_7;
 
-    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":67
+    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":89
  * 
  *     for i in range(N):
  *         row = dynamics[i]             # <<<<<<<<<<<<<<
  *         q = row[1:3]
  *         p = row[3:5]
  */
-    __Pyx_TraceLine(67,0,__PYX_ERR(0, 67, __pyx_L1_error))
+    __Pyx_TraceLine(89,0,__PYX_ERR(0, 89, __pyx_L1_error))
     __pyx_t_5.data = __pyx_v_dynamics.data;
     __pyx_t_5.memview = __pyx_v_dynamics.memview;
     __PYX_INC_MEMVIEW(&__pyx_t_5, 1);
     {
     Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
     Py_ssize_t __pyx_tmp_stride = __pyx_v_dynamics.strides[0];
         __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
@@ -21027,22 +21043,22 @@
     __pyx_t_5.suboffsets[0] = -1;
 
 __PYX_XCLEAR_MEMVIEW(&__pyx_v_row, 1);
     __pyx_v_row = __pyx_t_5;
     __pyx_t_5.memview = NULL;
     __pyx_t_5.data = NULL;
 
-    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":68
+    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":90
  *     for i in range(N):
  *         row = dynamics[i]
  *         q = row[1:3]             # <<<<<<<<<<<<<<
  *         p = row[3:5]
  *         p_c[1] = p[1]
  */
-    __Pyx_TraceLine(68,0,__PYX_ERR(0, 68, __pyx_L1_error))
+    __Pyx_TraceLine(90,0,__PYX_ERR(0, 90, __pyx_L1_error))
     __pyx_t_5.data = __pyx_v_row.data;
     __pyx_t_5.memview = __pyx_v_row.memview;
     __PYX_INC_MEMVIEW(&__pyx_t_5, 1);
     __pyx_t_8 = -1;
     if (unlikely(__pyx_memoryview_slice_memviewslice(
     &__pyx_t_5,
     __pyx_v_row.shape[0], __pyx_v_row.strides[0], __pyx_v_row.suboffsets[0],
@@ -21053,30 +21069,30 @@
     3,
     0,
     1,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 68, __pyx_L1_error)
+    __PYX_ERR(0, 90, __pyx_L1_error)
 }
 
 __PYX_XCLEAR_MEMVIEW(&__pyx_v_q, 1);
     __pyx_v_q = __pyx_t_5;
     __pyx_t_5.memview = NULL;
     __pyx_t_5.data = NULL;
 
-    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":69
+    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":91
  *         row = dynamics[i]
  *         q = row[1:3]
  *         p = row[3:5]             # <<<<<<<<<<<<<<
  *         p_c[1] = p[1]
  * 
  */
-    __Pyx_TraceLine(69,0,__PYX_ERR(0, 69, __pyx_L1_error))
+    __Pyx_TraceLine(91,0,__PYX_ERR(0, 91, __pyx_L1_error))
     __pyx_t_5.data = __pyx_v_row.data;
     __pyx_t_5.memview = __pyx_v_row.memview;
     __PYX_INC_MEMVIEW(&__pyx_t_5, 1);
     __pyx_t_8 = -1;
     if (unlikely(__pyx_memoryview_slice_memviewslice(
     &__pyx_t_5,
     __pyx_v_row.shape[0], __pyx_v_row.strides[0], __pyx_v_row.suboffsets[0],
@@ -21087,118 +21103,118 @@
     5,
     0,
     1,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 69, __pyx_L1_error)
+    __PYX_ERR(0, 91, __pyx_L1_error)
 }
 
 __PYX_XCLEAR_MEMVIEW(&__pyx_v_p, 1);
     __pyx_v_p = __pyx_t_5;
     __pyx_t_5.memview = NULL;
     __pyx_t_5.data = NULL;
 
-    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":70
+    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":92
  *         q = row[1:3]
  *         p = row[3:5]
  *         p_c[1] = p[1]             # <<<<<<<<<<<<<<
  * 
  *         # Evaluate a few things: H, omega, omega_circ
  */
-    __Pyx_TraceLine(70,0,__PYX_ERR(0, 70, __pyx_L1_error))
+    __Pyx_TraceLine(92,0,__PYX_ERR(0, 92, __pyx_L1_error))
     __pyx_t_9 = 1;
     __pyx_t_10 = 1;
     *((double *) ( /* dim=0 */ (__pyx_v_p_c.data + __pyx_t_10 * __pyx_v_p_c.strides[0]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_p.data + __pyx_t_9 * __pyx_v_p.strides[0]) )));
 
-    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":74
+    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":96
  *         # Evaluate a few things: H, omega, omega_circ
  * 
  *         dyn[:] = H.dynamics(q, p, chi_1, chi_2, m_1, m_2)             # <<<<<<<<<<<<<<
  *         omega = dyn[3]
  *         H_val = dyn[4]
  */
-    __Pyx_TraceLine(74,0,__PYX_ERR(0, 74, __pyx_L1_error))
-    __pyx_t_1 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_H->__pyx_vtab)->dynamics(__pyx_v_H, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 74, __pyx_L1_error)
+    __Pyx_TraceLine(96,0,__PYX_ERR(0, 96, __pyx_L1_error))
+    __pyx_t_1 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_H->__pyx_vtab)->dynamics(__pyx_v_H, __pyx_v_q, __pyx_v_p, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 96, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (unlikely((__Pyx_carray_from_py_double(__pyx_t_1, __pyx_t_11, 6) < 0))) __PYX_ERR(0, 74, __pyx_L1_error)
+    if (unlikely((__Pyx_carray_from_py_double(__pyx_t_1, __pyx_t_11, 6) < 0))) __PYX_ERR(0, 96, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     memcpy(&(__pyx_v_dyn[0]), __pyx_t_11, sizeof(__pyx_v_dyn[0]) * (6));
 
-    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":75
+    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":97
  * 
  *         dyn[:] = H.dynamics(q, p, chi_1, chi_2, m_1, m_2)
  *         omega = dyn[3]             # <<<<<<<<<<<<<<
  *         H_val = dyn[4]
  * 
  */
-    __Pyx_TraceLine(75,0,__PYX_ERR(0, 75, __pyx_L1_error))
+    __Pyx_TraceLine(97,0,__PYX_ERR(0, 97, __pyx_L1_error))
     __pyx_v_omega = (__pyx_v_dyn[3]);
 
-    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":76
+    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":98
  *         dyn[:] = H.dynamics(q, p, chi_1, chi_2, m_1, m_2)
  *         omega = dyn[3]
  *         H_val = dyn[4]             # <<<<<<<<<<<<<<
  * 
  *         omega_c = H.omega(q, p_c, chi_1, chi_2, m_1, m_2)
  */
-    __Pyx_TraceLine(76,0,__PYX_ERR(0, 76, __pyx_L1_error))
+    __Pyx_TraceLine(98,0,__PYX_ERR(0, 98, __pyx_L1_error))
     __pyx_v_H_val = (__pyx_v_dyn[4]);
 
-    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":78
+    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":100
  *         H_val = dyn[4]
  * 
  *         omega_c = H.omega(q, p_c, chi_1, chi_2, m_1, m_2)             # <<<<<<<<<<<<<<
  * 
  *         result.append([H_val, omega, omega_c])
  */
-    __Pyx_TraceLine(78,0,__PYX_ERR(0, 78, __pyx_L1_error))
-    __pyx_t_12 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_H->__pyx_vtab)->omega(__pyx_v_H, __pyx_v_q, __pyx_v_p_c, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 78, __pyx_L1_error)
+    __Pyx_TraceLine(100,0,__PYX_ERR(0, 100, __pyx_L1_error))
+    __pyx_t_12 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)__pyx_v_H->__pyx_vtab)->omega(__pyx_v_H, __pyx_v_q, __pyx_v_p_c, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 100, __pyx_L1_error)
     __pyx_v_omega_c = __pyx_t_12;
 
-    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":80
+    /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":102
  *         omega_c = H.omega(q, p_c, chi_1, chi_2, m_1, m_2)
  * 
  *         result.append([H_val, omega, omega_c])             # <<<<<<<<<<<<<<
  *     result = np.array(result)
  *     return np.c_[dynamics, result]
  */
-    __Pyx_TraceLine(80,0,__PYX_ERR(0, 80, __pyx_L1_error))
-    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_H_val); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 80, __pyx_L1_error)
+    __Pyx_TraceLine(102,0,__PYX_ERR(0, 102, __pyx_L1_error))
+    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_H_val); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 102, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_omega); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 80, __pyx_L1_error)
+    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_omega); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 102, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = PyFloat_FromDouble(__pyx_v_omega_c); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 80, __pyx_L1_error)
+    __pyx_t_2 = PyFloat_FromDouble(__pyx_v_omega_c); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 102, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_13 = PyList_New(3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 80, __pyx_L1_error)
+    __pyx_t_13 = PyList_New(3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 102, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __Pyx_GIVEREF(__pyx_t_1);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_13, 0, __pyx_t_1)) __PYX_ERR(0, 80, __pyx_L1_error);
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_13, 0, __pyx_t_1)) __PYX_ERR(0, 102, __pyx_L1_error);
     __Pyx_GIVEREF(__pyx_t_3);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_13, 1, __pyx_t_3)) __PYX_ERR(0, 80, __pyx_L1_error);
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_13, 1, __pyx_t_3)) __PYX_ERR(0, 102, __pyx_L1_error);
     __Pyx_GIVEREF(__pyx_t_2);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_13, 2, __pyx_t_2)) __PYX_ERR(0, 80, __pyx_L1_error);
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_13, 2, __pyx_t_2)) __PYX_ERR(0, 102, __pyx_L1_error);
     __pyx_t_1 = 0;
     __pyx_t_3 = 0;
     __pyx_t_2 = 0;
-    __pyx_t_14 = __Pyx_PyObject_Append(__pyx_v_result, __pyx_t_13); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 80, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_Append(__pyx_v_result, __pyx_t_13); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 102, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
   }
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":81
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":103
  * 
  *         result.append([H_val, omega, omega_c])
  *     result = np.array(result)             # <<<<<<<<<<<<<<
  *     return np.c_[dynamics, result]
  */
-  __Pyx_TraceLine(81,0,__PYX_ERR(0, 81, __pyx_L1_error))
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 81, __pyx_L1_error)
+  __Pyx_TraceLine(103,0,__PYX_ERR(0, 103, __pyx_L1_error))
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 103, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 81, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 103, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -21211,57 +21227,57 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_result};
     __pyx_t_13 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 81, __pyx_L1_error)
+    if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 103, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __Pyx_DECREF_SET(__pyx_v_result, __pyx_t_13);
   __pyx_t_13 = 0;
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":82
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":104
  *         result.append([H_val, omega, omega_c])
  *     result = np.array(result)
  *     return np.c_[dynamics, result]             # <<<<<<<<<<<<<<
  */
-  __Pyx_TraceLine(82,0,__PYX_ERR(0, 82, __pyx_L1_error))
+  __Pyx_TraceLine(104,0,__PYX_ERR(0, 104, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 82, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 104, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_c_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 82, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_c_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 104, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_dynamics, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 82, __pyx_L1_error)
+  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_dynamics, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 104, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 82, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 104, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_13);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_13)) __PYX_ERR(0, 82, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_13)) __PYX_ERR(0, 104, __pyx_L1_error);
   __Pyx_INCREF(__pyx_v_result);
   __Pyx_GIVEREF(__pyx_v_result);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_result)) __PYX_ERR(0, 82, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_result)) __PYX_ERR(0, 104, __pyx_L1_error);
   __pyx_t_13 = 0;
-  __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 82, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 104, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_13;
   __pyx_t_13 = 0;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":50
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":65
  * 
  * 
- * cpdef augment_dynamics(double[:,:] dynamics, double chi_1, double chi_2, double m_1, double m_2, Hamiltonian_C  H):             # <<<<<<<<<<<<<<
- *     """Compute dynamical quantities we need for the waveform
- * 
+ * cpdef augment_dynamics(             # <<<<<<<<<<<<<<
+ *     double[:, :] dynamics,
+ *     double chi_1,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
@@ -21346,106 +21362,106 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dynamics)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 50, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 65, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_chi_1)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 50, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 65, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("augment_dynamics", 1, 6, 6, 1); __PYX_ERR(0, 50, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("augment_dynamics", 1, 6, 6, 1); __PYX_ERR(0, 65, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_chi_2)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 50, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 65, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("augment_dynamics", 1, 6, 6, 2); __PYX_ERR(0, 50, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("augment_dynamics", 1, 6, 6, 2); __PYX_ERR(0, 65, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_m_1)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 50, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 65, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("augment_dynamics", 1, 6, 6, 3); __PYX_ERR(0, 50, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("augment_dynamics", 1, 6, 6, 3); __PYX_ERR(0, 65, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_m_2)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 50, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 65, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("augment_dynamics", 1, 6, 6, 4); __PYX_ERR(0, 50, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("augment_dynamics", 1, 6, 6, 4); __PYX_ERR(0, 65, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_H)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[5]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 50, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 65, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("augment_dynamics", 1, 6, 6, 5); __PYX_ERR(0, 50, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("augment_dynamics", 1, 6, 6, 5); __PYX_ERR(0, 65, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "augment_dynamics") < 0)) __PYX_ERR(0, 50, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "augment_dynamics") < 0)) __PYX_ERR(0, 65, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 6)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
       values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
       values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
       values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
     }
-    __pyx_v_dynamics = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_dynamics.memview)) __PYX_ERR(0, 50, __pyx_L3_error)
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 50, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 50, __pyx_L3_error)
-    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 50, __pyx_L3_error)
-    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 50, __pyx_L3_error)
+    __pyx_v_dynamics = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_dynamics.memview)) __PYX_ERR(0, 66, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 67, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 68, __pyx_L3_error)
+    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 69, __pyx_L3_error)
+    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 70, __pyx_L3_error)
     __pyx_v_H = ((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *)values[5]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("augment_dynamics", 1, 6, 6, __pyx_nargs); __PYX_ERR(0, 50, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("augment_dynamics", 1, 6, 6, __pyx_nargs); __PYX_ERR(0, 65, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_dynamics, 1);
   __Pyx_AddTraceback("pyseobnr.eob.dynamics.rhs_aligned.augment_dynamics", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_H), __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, 1, "H", 0))) __PYX_ERR(0, 50, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_H), __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, 1, "H", 0))) __PYX_ERR(0, 71, __pyx_L1_error)
   __pyx_r = __pyx_pf_8pyseobnr_3eob_8dynamics_11rhs_aligned_2augment_dynamics(__pyx_self, __pyx_v_dynamics, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_H);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -21466,17 +21482,17 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__12)
   __Pyx_RefNannySetupContext("augment_dynamics", 1);
-  __Pyx_TraceCall("augment_dynamics (wrapper)", __pyx_f[0], 50, 0, __PYX_ERR(0, 50, __pyx_L1_error));
+  __Pyx_TraceCall("augment_dynamics (wrapper)", __pyx_f[0], 65, 0, __PYX_ERR(0, 65, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_11rhs_aligned_augment_dynamics(__pyx_v_dynamics, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_H, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 50, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8dynamics_11rhs_aligned_augment_dynamics(__pyx_v_dynamics, __pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_H, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 65, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -22595,15 +22611,15 @@
     {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
     {0, 0, 0, 0, 0, 0, 0}
   };
   return __Pyx_InitStrings(__pyx_string_tab);
 }
 /* #### Code section: cached_builtins ### */
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 66, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 88, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(1, 83, __pyx_L1_error)
   __pyx_builtin_OverflowError = __Pyx_GetBuiltinName(__pyx_n_s_OverflowError); if (!__pyx_builtin_OverflowError) __PYX_ERR(1, 83, __pyx_L1_error)
   __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(1, 86, __pyx_L1_error)
   __pyx_builtin_IndexError = __Pyx_GetBuiltinName(__pyx_n_s_IndexError); if (!__pyx_builtin_IndexError) __PYX_ERR(1, 96, __pyx_L1_error)
   __pyx_builtin___import__ = __Pyx_GetBuiltinName(__pyx_n_s_import); if (!__pyx_builtin___import__) __PYX_ERR(1, 100, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(1, 141, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 156, __pyx_L1_error)
@@ -22653,26 +22669,26 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 984, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 990, __pyx_L1_error)
@@ -22776,37 +22792,37 @@
  *     cdef object __pyx_result
  */
   __pyx_tuple__22 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__22);
   __Pyx_GIVEREF(__pyx_tuple__22);
   __pyx_codeobj__23 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__22, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__23)) __PYX_ERR(1, 1, __pyx_L1_error)
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":14
- * cimport numpy as np
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":16
  * 
- * cpdef get_rhs(double t,double[::1] z,Hamiltonian_C H,RadiationReactionForce RR,             # <<<<<<<<<<<<<<
- *     double chi_1,double chi_2,double m_1,double m_2,EOBParams params):
- *     """
+ * 
+ * cpdef get_rhs(             # <<<<<<<<<<<<<<
+ *     double t,
+ *     double[::1] z,
  */
-  __pyx_tuple__24 = PyTuple_Pack(9, __pyx_n_s_t, __pyx_n_s_z, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_params); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 14, __pyx_L1_error)
+  __pyx_tuple__24 = PyTuple_Pack(9, __pyx_n_s_t, __pyx_n_s_z, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_params); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__24);
   __Pyx_GIVEREF(__pyx_tuple__24);
-  __pyx_codeobj__11 = (PyObject*)__Pyx_PyCode_New(9, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_rhs_aligne, __pyx_n_s_get_rhs, 14, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 14, __pyx_L1_error)
+  __pyx_codeobj__11 = (PyObject*)__Pyx_PyCode_New(9, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_rhs_aligne, __pyx_n_s_get_rhs, 16, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 16, __pyx_L1_error)
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":50
- * 
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":65
  * 
- * cpdef augment_dynamics(double[:,:] dynamics, double chi_1, double chi_2, double m_1, double m_2, Hamiltonian_C  H):             # <<<<<<<<<<<<<<
- *     """Compute dynamical quantities we need for the waveform
  * 
+ * cpdef augment_dynamics(             # <<<<<<<<<<<<<<
+ *     double[:, :] dynamics,
+ *     double chi_1,
  */
-  __pyx_tuple__25 = PyTuple_Pack(6, __pyx_n_s_dynamics, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_H); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 50, __pyx_L1_error)
+  __pyx_tuple__25 = PyTuple_Pack(6, __pyx_n_s_dynamics, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_H); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 65, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__25);
   __Pyx_GIVEREF(__pyx_tuple__25);
-  __pyx_codeobj__12 = (PyObject*)__Pyx_PyCode_New(6, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__25, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_rhs_aligne, __pyx_n_s_augment_dynamics, 50, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__12)) __PYX_ERR(0, 50, __pyx_L1_error)
+  __pyx_codeobj__12 = (PyObject*)__Pyx_PyCode_New(6, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__25, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_rhs_aligne, __pyx_n_s_augment_dynamics, 65, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__12)) __PYX_ERR(0, 65, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 /* #### Code section: init_constants ### */
@@ -23056,64 +23072,64 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
-  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 8, __pyx_L1_error)
+  __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(3, 8, __pyx_L1_error)
-  __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(3, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(3, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(3, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(3, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(3, 67, __pyx_L1_error)
+  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_0_10(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
+  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyTypeObject),
+  #elif CYTHON_COMPILING_IN_LIMITED_API
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyTypeObject),
+  #else
+  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyHeapTypeObject),
+  #endif
+  __Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(3, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 10, __pyx_L1_error)
+  __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(4, 10, __pyx_L1_error)
-  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(4, 10, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(4, 14, __pyx_L1_error)
-  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(4, 14, __pyx_L1_error)
+  __pyx_ptype_5numpy_dtype = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArray_Descr),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 202, __pyx_L1_error)
+  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 225, __pyx_L1_error)
+  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayMultiIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 229, __pyx_L1_error)
+  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
+  __pyx_ptype_5numpy_generic = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 809, __pyx_L1_error)
+  __pyx_ptype_5numpy_number = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 811, __pyx_L1_error)
+  __pyx_ptype_5numpy_integer = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 813, __pyx_L1_error)
+  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 815, __pyx_L1_error)
+  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 817, __pyx_L1_error)
+  __pyx_ptype_5numpy_inexact = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 819, __pyx_L1_error)
+  __pyx_ptype_5numpy_floating = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 821, __pyx_L1_error)
+  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 823, __pyx_L1_error)
+  __pyx_ptype_5numpy_flexible = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 825, __pyx_L1_error)
+  __pyx_ptype_5numpy_character = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 827, __pyx_L1_error)
+  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyUFuncObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 866, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(5, 6, __pyx_L1_error)
+  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) __PYX_ERR(5, 6, __pyx_L1_error)
-  __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C)) __PYX_ERR(5, 6, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(4, 8, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(4, 8, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(4, 23, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(4, 26, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(4, 29, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(4, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 9, __pyx_L1_error)
+  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(5, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_0_8(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
-  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
-  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyTypeObject),
-  #elif CYTHON_COMPILING_IN_LIMITED_API
-  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyTypeObject),
-  #else
-  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyHeapTypeObject),
-  #endif
-  __Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(6, 9, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(5, 15, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(5, 15, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(5, 25, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(5, 25, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 202, __pyx_L1_error)
+  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 6, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_5numpy_dtype = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArray_Descr),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 202, __pyx_L1_error)
-  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 225, __pyx_L1_error)
-  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayMultiIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 229, __pyx_L1_error)
-  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
-  __pyx_ptype_5numpy_generic = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 809, __pyx_L1_error)
-  __pyx_ptype_5numpy_number = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 811, __pyx_L1_error)
-  __pyx_ptype_5numpy_integer = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 813, __pyx_L1_error)
-  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 815, __pyx_L1_error)
-  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 817, __pyx_L1_error)
-  __pyx_ptype_5numpy_inexact = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 819, __pyx_L1_error)
-  __pyx_ptype_5numpy_floating = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 821, __pyx_L1_error)
-  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 823, __pyx_L1_error)
-  __pyx_ptype_5numpy_flexible = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 825, __pyx_L1_error)
-  __pyx_ptype_5numpy_character = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 827, __pyx_L1_error)
-  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyUFuncObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 866, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) __PYX_ERR(6, 6, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C)) __PYX_ERR(6, 6, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -23125,30 +23141,18 @@
   /*--- Variable import code ---*/
   __Pyx_RefNannyFinishContext();
   return 0;
 }
 
 static int __Pyx_modinit_function_import_code(void) {
   __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_function_import_code", 0);
   /*--- Function import code ---*/
-  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (!__pyx_t_1) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  if (__Pyx_ImportFunction_3_0_8(__pyx_t_1, "RR_force", (void (**)(void))&__pyx_f_8pyseobnr_3eob_8waveform_8waveform_RR_force, "__pyx_ctuple_double__and_double (__Pyx_memviewslice, __Pyx_memviewslice, double, double, double, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *, int __pyx_skip_dispatch)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_RefNannyFinishContext();
-  return -1;
 }
 
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
 static int __pyx_pymod_exec_rhs_aligned(PyObject* module); /*proto*/
@@ -23422,15 +23426,15 @@
   /*--- Global type/function init code ---*/
   (void)__Pyx_modinit_global_init_code();
   (void)__Pyx_modinit_variable_export_code();
   (void)__Pyx_modinit_function_export_code();
   if (unlikely((__Pyx_modinit_type_init_code() < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
   if (unlikely((__Pyx_modinit_type_import_code() < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
   (void)__Pyx_modinit_variable_import_code();
-  if (unlikely((__Pyx_modinit_function_import_code() < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
+  (void)__Pyx_modinit_function_import_code();
   /*--- Execution code ---*/
   #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
   if (__Pyx_patch_abc() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
   __Pyx_TraceCall("__Pyx_PyMODINIT_FUNC PyInit_rhs_aligned(void)", __pyx_f[0], 1, 0, __PYX_ERR(0, 1, __pyx_L1_error));
 
   /* "carray.from_py":79
@@ -23972,59 +23976,59 @@
  *     cdef object __pyx_result
  */
   __pyx_t_7 = PyCFunction_NewEx(&__pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum, NULL, __pyx_n_s_View_MemoryView); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_Enum, __pyx_t_7) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":11
- * from pyseobnr.eob.waveform.waveform cimport RR_force,  RadiationReactionForce
- * from pyseobnr.eob.hamiltonian.Hamiltonian_C cimport Hamiltonian_C
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":8
+ * """
+ * 
  * import numpy as np             # <<<<<<<<<<<<<<
  * cimport numpy as np
  * 
  */
-  __Pyx_TraceLine(11,0,__PYX_ERR(0, 11, __pyx_L1_error))
-  __pyx_t_7 = __Pyx_ImportDottedModule(__pyx_n_s_numpy, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 11, __pyx_L1_error)
+  __Pyx_TraceLine(8,0,__PYX_ERR(0, 8, __pyx_L1_error))
+  __pyx_t_7 = __Pyx_ImportDottedModule(__pyx_n_s_numpy, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_7) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_7) < 0) __PYX_ERR(0, 8, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":14
- * cimport numpy as np
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":16
  * 
- * cpdef get_rhs(double t,double[::1] z,Hamiltonian_C H,RadiationReactionForce RR,             # <<<<<<<<<<<<<<
- *     double chi_1,double chi_2,double m_1,double m_2,EOBParams params):
- *     """
+ * 
+ * cpdef get_rhs(             # <<<<<<<<<<<<<<
+ *     double t,
+ *     double[::1] z,
  */
-  __Pyx_TraceLine(14,0,__PYX_ERR(0, 14, __pyx_L1_error))
+  __Pyx_TraceLine(16,0,__PYX_ERR(0, 16, __pyx_L1_error))
 
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_11rhs_aligned_1get_rhs, 0, __pyx_n_s_get_rhs, NULL, __pyx_n_s_pyseobnr_eob_dynamics_rhs_aligne_2, __pyx_d, ((PyObject *)__pyx_codeobj__11)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 14, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_11rhs_aligned_1get_rhs, 0, __pyx_n_s_get_rhs, NULL, __pyx_n_s_pyseobnr_eob_dynamics_rhs_aligne_2, __pyx_d, ((PyObject *)__pyx_codeobj__11)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_rhs, __pyx_t_7) < 0) __PYX_ERR(0, 14, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_rhs, __pyx_t_7) < 0) __PYX_ERR(0, 16, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":50
- * 
+  /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":65
  * 
- * cpdef augment_dynamics(double[:,:] dynamics, double chi_1, double chi_2, double m_1, double m_2, Hamiltonian_C  H):             # <<<<<<<<<<<<<<
- *     """Compute dynamical quantities we need for the waveform
  * 
+ * cpdef augment_dynamics(             # <<<<<<<<<<<<<<
+ *     double[:, :] dynamics,
+ *     double chi_1,
  */
-  __Pyx_TraceLine(50,0,__PYX_ERR(0, 50, __pyx_L1_error))
+  __Pyx_TraceLine(65,0,__PYX_ERR(0, 65, __pyx_L1_error))
 
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_11rhs_aligned_3augment_dynamics, 0, __pyx_n_s_augment_dynamics, NULL, __pyx_n_s_pyseobnr_eob_dynamics_rhs_aligne_2, __pyx_d, ((PyObject *)__pyx_codeobj__12)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 50, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_11rhs_aligned_3augment_dynamics, 0, __pyx_n_s_augment_dynamics, NULL, __pyx_n_s_pyseobnr_eob_dynamics_rhs_aligne_2, __pyx_d, ((PyObject *)__pyx_codeobj__12)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 65, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_augment_dynamics, __pyx_t_7) < 0) __PYX_ERR(0, 50, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_augment_dynamics, __pyx_t_7) < 0) __PYX_ERR(0, 65, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
   /* "pyseobnr/eob/dynamics/rhs_aligned.pyx":1
- * # cython: language_level=3, boundscheck=False, cdivision=True, wraparound=False, profile=True, linetrace=True, binding=True,initializedcheck=False             # <<<<<<<<<<<<<<
+ * # cython: language_level=3, boundscheck=False, cdivision=True, wraparound=False,             # <<<<<<<<<<<<<<
+ * # cython: profile=True, linetrace=True, binding=True, initializedcheck=False
  * """
- * Contains the actual RHS of the EOM, wrapped in cython.
  */
   __Pyx_TraceLine(1,0,__PYX_ERR(0, 1, __pyx_L1_error))
   __pyx_t_7 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_7) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_TraceReturn(Py_None, 0);
@@ -27266,18 +27270,18 @@
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
 }
 #endif
 
 /* TypeImport */
-#ifndef __PYX_HAVE_RT_ImportType_3_0_8
-#define __PYX_HAVE_RT_ImportType_3_0_8
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size)
+#ifndef __PYX_HAVE_RT_ImportType_3_0_10
+#define __PYX_HAVE_RT_ImportType_3_0_10
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject *module, const char *module_name, const char *class_name,
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
     Py_ssize_t itemsize;
 #if CYTHON_COMPILING_IN_LIMITED_API
     PyObject *py_basicsize;
@@ -27323,23 +27327,23 @@
     if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize+itemsize);
         goto bad;
     }
-    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_8 &&
+    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_10 &&
             ((size_t)basicsize > size || (size_t)(basicsize + itemsize) < size)) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd-%zd from PyObject",
             module_name, class_name, size, basicsize, basicsize+itemsize);
         goto bad;
     }
-    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_8 && (size_t)basicsize > size) {
+    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_10 && (size_t)basicsize > size) {
         PyOS_snprintf(warning, sizeof(warning),
             "%s.%s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
     }
     return (PyTypeObject *)result;
@@ -28331,15 +28335,15 @@
         break;
     case 0:
         self = ((PyCFunctionObject*)cyfunc)->m_self;
         break;
     default:
         return NULL;
     }
-    return ((_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
+    return ((__Pyx_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
 }
 static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS_METHOD(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
 {
     __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
     PyMethodDef* def = ((PyCFunctionObject*)cyfunc)->m_ml;
     PyTypeObject *cls = (PyTypeObject *) __Pyx_CyFunction_GetClassObj(cyfunc);
 #if CYTHON_BACKPORT_VECTORCALL
@@ -29774,314 +29778,314 @@
     *(double *) itemp = value;
     return 1;
 }
 
 /* Declarations */
   #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
   #ifdef __cplusplus
-    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
-      return ::std::complex< double >(x, y);
+    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
+      return ::std::complex< float >(x, y);
     }
   #else
-    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
-      return x + y*(__pyx_t_double_complex)_Complex_I;
+    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
+      return x + y*(__pyx_t_float_complex)_Complex_I;
     }
   #endif
 #else
-    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
-      __pyx_t_double_complex z;
+    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
+      __pyx_t_float_complex z;
       z.real = x;
       z.imag = y;
       return z;
     }
 #endif
 
 /* Arithmetic */
   #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
 #else
-    static CYTHON_INLINE int __Pyx_c_eq_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+    static CYTHON_INLINE int __Pyx_c_eq_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
        return (a.real == b.real) && (a.imag == b.imag);
     }
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_sum_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-        __pyx_t_double_complex z;
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_sum_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
+        __pyx_t_float_complex z;
         z.real = a.real + b.real;
         z.imag = a.imag + b.imag;
         return z;
     }
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_diff_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-        __pyx_t_double_complex z;
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_diff_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
+        __pyx_t_float_complex z;
         z.real = a.real - b.real;
         z.imag = a.imag - b.imag;
         return z;
     }
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_prod_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-        __pyx_t_double_complex z;
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_prod_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
+        __pyx_t_float_complex z;
         z.real = a.real * b.real - a.imag * b.imag;
         z.imag = a.real * b.imag + a.imag * b.real;
         return z;
     }
     #if 1
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quot_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
         if (b.imag == 0) {
-            return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.real);
-        } else if (fabs(b.real) >= fabs(b.imag)) {
+            return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.real);
+        } else if (fabsf(b.real) >= fabsf(b.imag)) {
             if (b.real == 0 && b.imag == 0) {
-                return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.imag);
+                return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.imag);
             } else {
-                double r = b.imag / b.real;
-                double s = (double)(1.0) / (b.real + b.imag * r);
-                return __pyx_t_double_complex_from_parts(
+                float r = b.imag / b.real;
+                float s = (float)(1.0) / (b.real + b.imag * r);
+                return __pyx_t_float_complex_from_parts(
                     (a.real + a.imag * r) * s, (a.imag - a.real * r) * s);
             }
         } else {
-            double r = b.real / b.imag;
-            double s = (double)(1.0) / (b.imag + b.real * r);
-            return __pyx_t_double_complex_from_parts(
+            float r = b.real / b.imag;
+            float s = (float)(1.0) / (b.imag + b.real * r);
+            return __pyx_t_float_complex_from_parts(
                 (a.real * r + a.imag) * s, (a.imag * r - a.real) * s);
         }
     }
     #else
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quot_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
         if (b.imag == 0) {
-            return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.real);
+            return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.real);
         } else {
-            double denom = b.real * b.real + b.imag * b.imag;
-            return __pyx_t_double_complex_from_parts(
+            float denom = b.real * b.real + b.imag * b.imag;
+            return __pyx_t_float_complex_from_parts(
                 (a.real * b.real + a.imag * b.imag) / denom,
                 (a.imag * b.real - a.real * b.imag) / denom);
         }
     }
     #endif
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_neg_double(__pyx_t_double_complex a) {
-        __pyx_t_double_complex z;
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_neg_float(__pyx_t_float_complex a) {
+        __pyx_t_float_complex z;
         z.real = -a.real;
         z.imag = -a.imag;
         return z;
     }
-    static CYTHON_INLINE int __Pyx_c_is_zero_double(__pyx_t_double_complex a) {
+    static CYTHON_INLINE int __Pyx_c_is_zero_float(__pyx_t_float_complex a) {
        return (a.real == 0) && (a.imag == 0);
     }
-    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj_double(__pyx_t_double_complex a) {
-        __pyx_t_double_complex z;
+    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_conj_float(__pyx_t_float_complex a) {
+        __pyx_t_float_complex z;
         z.real =  a.real;
         z.imag = -a.imag;
         return z;
     }
     #if 1
-        static CYTHON_INLINE double __Pyx_c_abs_double(__pyx_t_double_complex z) {
+        static CYTHON_INLINE float __Pyx_c_abs_float(__pyx_t_float_complex z) {
           #if !defined(HAVE_HYPOT) || defined(_MSC_VER)
-            return sqrt(z.real*z.real + z.imag*z.imag);
+            return sqrtf(z.real*z.real + z.imag*z.imag);
           #else
-            return hypot(z.real, z.imag);
+            return hypotf(z.real, z.imag);
           #endif
         }
-        static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
-            __pyx_t_double_complex z;
-            double r, lnr, theta, z_r, z_theta;
+        static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_pow_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
+            __pyx_t_float_complex z;
+            float r, lnr, theta, z_r, z_theta;
             if (b.imag == 0 && b.real == (int)b.real) {
                 if (b.real < 0) {
-                    double denom = a.real * a.real + a.imag * a.imag;
+                    float denom = a.real * a.real + a.imag * a.imag;
                     a.real = a.real / denom;
                     a.imag = -a.imag / denom;
                     b.real = -b.real;
                 }
                 switch ((int)b.real) {
                     case 0:
                         z.real = 1;
                         z.imag = 0;
                         return z;
                     case 1:
                         return a;
                     case 2:
-                        return __Pyx_c_prod_double(a, a);
+                        return __Pyx_c_prod_float(a, a);
                     case 3:
-                        z = __Pyx_c_prod_double(a, a);
-                        return __Pyx_c_prod_double(z, a);
+                        z = __Pyx_c_prod_float(a, a);
+                        return __Pyx_c_prod_float(z, a);
                     case 4:
-                        z = __Pyx_c_prod_double(a, a);
-                        return __Pyx_c_prod_double(z, z);
+                        z = __Pyx_c_prod_float(a, a);
+                        return __Pyx_c_prod_float(z, z);
                 }
             }
             if (a.imag == 0) {
                 if (a.real == 0) {
                     return a;
                 } else if ((b.imag == 0) && (a.real >= 0)) {
-                    z.real = pow(a.real, b.real);
+                    z.real = powf(a.real, b.real);
                     z.imag = 0;
                     return z;
                 } else if (a.real > 0) {
                     r = a.real;
                     theta = 0;
                 } else {
                     r = -a.real;
-                    theta = atan2(0.0, -1.0);
+                    theta = atan2f(0.0, -1.0);
                 }
             } else {
-                r = __Pyx_c_abs_double(a);
-                theta = atan2(a.imag, a.real);
+                r = __Pyx_c_abs_float(a);
+                theta = atan2f(a.imag, a.real);
             }
-            lnr = log(r);
-            z_r = exp(lnr * b.real - theta * b.imag);
+            lnr = logf(r);
+            z_r = expf(lnr * b.real - theta * b.imag);
             z_theta = theta * b.real + lnr * b.imag;
-            z.real = z_r * cos(z_theta);
-            z.imag = z_r * sin(z_theta);
+            z.real = z_r * cosf(z_theta);
+            z.imag = z_r * sinf(z_theta);
             return z;
         }
     #endif
 #endif
 
 /* Declarations */
   #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
   #ifdef __cplusplus
-    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
-      return ::std::complex< float >(x, y);
+    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
+      return ::std::complex< double >(x, y);
     }
   #else
-    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
-      return x + y*(__pyx_t_float_complex)_Complex_I;
+    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
+      return x + y*(__pyx_t_double_complex)_Complex_I;
     }
   #endif
 #else
-    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
-      __pyx_t_float_complex z;
+    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
+      __pyx_t_double_complex z;
       z.real = x;
       z.imag = y;
       return z;
     }
 #endif
 
 /* Arithmetic */
   #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
 #else
-    static CYTHON_INLINE int __Pyx_c_eq_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
+    static CYTHON_INLINE int __Pyx_c_eq_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        return (a.real == b.real) && (a.imag == b.imag);
     }
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_sum_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
-        __pyx_t_float_complex z;
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_sum_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+        __pyx_t_double_complex z;
         z.real = a.real + b.real;
         z.imag = a.imag + b.imag;
         return z;
     }
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_diff_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
-        __pyx_t_float_complex z;
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_diff_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+        __pyx_t_double_complex z;
         z.real = a.real - b.real;
         z.imag = a.imag - b.imag;
         return z;
     }
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_prod_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
-        __pyx_t_float_complex z;
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_prod_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+        __pyx_t_double_complex z;
         z.real = a.real * b.real - a.imag * b.imag;
         z.imag = a.real * b.imag + a.imag * b.real;
         return z;
     }
     #if 1
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quot_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
         if (b.imag == 0) {
-            return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.real);
-        } else if (fabsf(b.real) >= fabsf(b.imag)) {
+            return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.real);
+        } else if (fabs(b.real) >= fabs(b.imag)) {
             if (b.real == 0 && b.imag == 0) {
-                return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.imag);
+                return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.imag);
             } else {
-                float r = b.imag / b.real;
-                float s = (float)(1.0) / (b.real + b.imag * r);
-                return __pyx_t_float_complex_from_parts(
+                double r = b.imag / b.real;
+                double s = (double)(1.0) / (b.real + b.imag * r);
+                return __pyx_t_double_complex_from_parts(
                     (a.real + a.imag * r) * s, (a.imag - a.real * r) * s);
             }
         } else {
-            float r = b.real / b.imag;
-            float s = (float)(1.0) / (b.imag + b.real * r);
-            return __pyx_t_float_complex_from_parts(
+            double r = b.real / b.imag;
+            double s = (double)(1.0) / (b.imag + b.real * r);
+            return __pyx_t_double_complex_from_parts(
                 (a.real * r + a.imag) * s, (a.imag * r - a.real) * s);
         }
     }
     #else
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quot_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
         if (b.imag == 0) {
-            return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.real);
+            return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.real);
         } else {
-            float denom = b.real * b.real + b.imag * b.imag;
-            return __pyx_t_float_complex_from_parts(
+            double denom = b.real * b.real + b.imag * b.imag;
+            return __pyx_t_double_complex_from_parts(
                 (a.real * b.real + a.imag * b.imag) / denom,
                 (a.imag * b.real - a.real * b.imag) / denom);
         }
     }
     #endif
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_neg_float(__pyx_t_float_complex a) {
-        __pyx_t_float_complex z;
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_neg_double(__pyx_t_double_complex a) {
+        __pyx_t_double_complex z;
         z.real = -a.real;
         z.imag = -a.imag;
         return z;
     }
-    static CYTHON_INLINE int __Pyx_c_is_zero_float(__pyx_t_float_complex a) {
+    static CYTHON_INLINE int __Pyx_c_is_zero_double(__pyx_t_double_complex a) {
        return (a.real == 0) && (a.imag == 0);
     }
-    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_conj_float(__pyx_t_float_complex a) {
-        __pyx_t_float_complex z;
+    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj_double(__pyx_t_double_complex a) {
+        __pyx_t_double_complex z;
         z.real =  a.real;
         z.imag = -a.imag;
         return z;
     }
     #if 1
-        static CYTHON_INLINE float __Pyx_c_abs_float(__pyx_t_float_complex z) {
+        static CYTHON_INLINE double __Pyx_c_abs_double(__pyx_t_double_complex z) {
           #if !defined(HAVE_HYPOT) || defined(_MSC_VER)
-            return sqrtf(z.real*z.real + z.imag*z.imag);
+            return sqrt(z.real*z.real + z.imag*z.imag);
           #else
-            return hypotf(z.real, z.imag);
+            return hypot(z.real, z.imag);
           #endif
         }
-        static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_pow_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
-            __pyx_t_float_complex z;
-            float r, lnr, theta, z_r, z_theta;
+        static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
+            __pyx_t_double_complex z;
+            double r, lnr, theta, z_r, z_theta;
             if (b.imag == 0 && b.real == (int)b.real) {
                 if (b.real < 0) {
-                    float denom = a.real * a.real + a.imag * a.imag;
+                    double denom = a.real * a.real + a.imag * a.imag;
                     a.real = a.real / denom;
                     a.imag = -a.imag / denom;
                     b.real = -b.real;
                 }
                 switch ((int)b.real) {
                     case 0:
                         z.real = 1;
                         z.imag = 0;
                         return z;
                     case 1:
                         return a;
                     case 2:
-                        return __Pyx_c_prod_float(a, a);
+                        return __Pyx_c_prod_double(a, a);
                     case 3:
-                        z = __Pyx_c_prod_float(a, a);
-                        return __Pyx_c_prod_float(z, a);
+                        z = __Pyx_c_prod_double(a, a);
+                        return __Pyx_c_prod_double(z, a);
                     case 4:
-                        z = __Pyx_c_prod_float(a, a);
-                        return __Pyx_c_prod_float(z, z);
+                        z = __Pyx_c_prod_double(a, a);
+                        return __Pyx_c_prod_double(z, z);
                 }
             }
             if (a.imag == 0) {
                 if (a.real == 0) {
                     return a;
                 } else if ((b.imag == 0) && (a.real >= 0)) {
-                    z.real = powf(a.real, b.real);
+                    z.real = pow(a.real, b.real);
                     z.imag = 0;
                     return z;
                 } else if (a.real > 0) {
                     r = a.real;
                     theta = 0;
                 } else {
                     r = -a.real;
-                    theta = atan2f(0.0, -1.0);
+                    theta = atan2(0.0, -1.0);
                 }
             } else {
-                r = __Pyx_c_abs_float(a);
-                theta = atan2f(a.imag, a.real);
+                r = __Pyx_c_abs_double(a);
+                theta = atan2(a.imag, a.real);
             }
-            lnr = logf(r);
-            z_r = expf(lnr * b.real - theta * b.imag);
+            lnr = log(r);
+            z_r = exp(lnr * b.real - theta * b.imag);
             z_theta = theta * b.real + lnr * b.imag;
-            z.real = z_r * cosf(z_theta);
-            z.imag = z_r * sinf(z_theta);
+            z.real = z_r * cos(z_theta);
+            z.imag = z_r * sin(z_theta);
             return z;
         }
     #endif
 #endif
 
 /* MemviewSliceCopyTemplate */
   static __Pyx_memviewslice
@@ -31564,52 +31568,14 @@
                        (allow_newer) ? "was newer than" : "does not match",
                        (int) (rt_version >> 24), (int) ((rt_version >> 16) & 0xFF)
        );
         return PyErr_WarnEx(NULL, message, 1);
     }
 }
 
-/* FunctionImport */
-  #ifndef __PYX_HAVE_RT_ImportFunction_3_0_8
-#define __PYX_HAVE_RT_ImportFunction_3_0_8
-static int __Pyx_ImportFunction_3_0_8(PyObject *module, const char *funcname, void (**f)(void), const char *sig) {
-    PyObject *d = 0;
-    PyObject *cobj = 0;
-    union {
-        void (*fp)(void);
-        void *p;
-    } tmp;
-    d = PyObject_GetAttrString(module, (char *)"__pyx_capi__");
-    if (!d)
-        goto bad;
-    cobj = PyDict_GetItemString(d, funcname);
-    if (!cobj) {
-        PyErr_Format(PyExc_ImportError,
-            "%.200s does not export expected C function %.200s",
-                PyModule_GetName(module), funcname);
-        goto bad;
-    }
-    if (!PyCapsule_IsValid(cobj, sig)) {
-        PyErr_Format(PyExc_TypeError,
-            "C function %.200s.%.200s has wrong signature (expected %.500s, got %.500s)",
-             PyModule_GetName(module), funcname, sig, PyCapsule_GetName(cobj));
-        goto bad;
-    }
-    tmp.p = PyCapsule_GetPointer(cobj, sig);
-    *f = tmp.fp;
-    if (!(*f))
-        goto bad;
-    Py_DECREF(d);
-    return 0;
-bad:
-    Py_XDECREF(d);
-    return -1;
-}
-#endif
-
 /* InitStrings */
   #if PY_MAJOR_VERSION >= 3
 static int __Pyx_InitString(__Pyx_StringTabEntry t, PyObject **str) {
     if (t.is_unicode | t.is_str) {
         if (t.intern) {
             *str = PyUnicode_InternFromString(t.s);
         } else if (t.encoding) {
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/rhs_aligned.pyx` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/rhs_aligned.pyx`

 * *Files 17% similar despite different names*

```diff
@@ -1,39 +1,54 @@
-# cython: language_level=3, boundscheck=False, cdivision=True, wraparound=False, profile=True, linetrace=True, binding=True,initializedcheck=False
+# cython: language_level=3, boundscheck=False, cdivision=True, wraparound=False,
+# cython: profile=True, linetrace=True, binding=True, initializedcheck=False
 """
 Contains the actual RHS of the EOM, wrapped in cython.
 This allows some of the cython functions used in the RHS to be called more efficiently.
 """
 
-cimport cython
-from pyseobnr.eob.utils.containers cimport EOBParams,FluxParams
-from pyseobnr.eob.waveform.waveform cimport RR_force,  RadiationReactionForce
-from pyseobnr.eob.hamiltonian.Hamiltonian_C cimport Hamiltonian_C
 import numpy as np
 cimport numpy as np
 
-cpdef get_rhs(double t,double[::1] z,Hamiltonian_C H,RadiationReactionForce RR,
-    double chi_1,double chi_2,double m_1,double m_2,EOBParams params):
+from pyseobnr.eob.utils.containers cimport EOBParams
+from pyseobnr.eob.waveform.waveform cimport RadiationReactionForce
+from pyseobnr.eob.hamiltonian.Hamiltonian_C cimport Hamiltonian_C
+
+
+cpdef get_rhs(
+    double t,
+    double[::1] z,
+    Hamiltonian_C H,
+    RadiationReactionForce RR,
+    double chi_1,
+    double chi_2,
+    double m_1,
+    double m_2,
+    EOBParams params
+):
     """
     Compute the RHS of the EOB evolution equations.
     In particular this function returns
-    :math:`\\dot{r}`, :math:`\\dot{\phi}` , :math:`\\dot{p}_{r}` and :math:`\\dot{p}_{\\phi}` .
+
+    * :math:`\\dot{r}`,
+    * :math:`\\dot{\\phi}`,
+    * :math:`\\dot{p}_{r}`,
+    * and :math:`\\dot{p}_{\\phi}`.
 
     See for example Eq(2) of [Buades2021]_ .
 
     The Hamiltonian is given by Eq(14) in [SEOBNRv5HM]_ doc
     and explicitly spelled out in Section I.C of [SEOBNRv5HM-theory]_
     and the RR force is described in Eq(43) of [SEOBNRv5HM]_ document, both
     contained in [DCC_T2300060]_ .
 
     """
     cdef double[::1] q = z[:2]
     cdef double[::1] p = z[2:]
 
-    cdef double H_val,omega,omega_circ,xi
+    cdef double H_val, omega, omega_circ, xi
     cdef double dynamics[6]
     dynamics[:] = H.dynamics(q, p, chi_1, chi_2, m_1, m_2)
     H_val = dynamics[4]
     omega = dynamics[3]
     params.dynamics.p_circ[1] = p[1]
 
     omega_circ = H.omega(q, params.dynamics.p_circ, chi_1, chi_2, m_1, m_2)
@@ -43,28 +58,35 @@
     cdef (double, double) RR_f = RR.RR(q, p, omega, omega_circ, H_val, params)
 
     cdef double deriv[4]
     deriv[:] = [xi * dynamics[2], dynamics[3], -dynamics[0] * xi + RR_f[0], -dynamics[1] + RR_f[1]]
     return deriv
 
 
-cpdef augment_dynamics(double[:,:] dynamics, double chi_1, double chi_2, double m_1, double m_2, Hamiltonian_C  H):
+cpdef augment_dynamics(
+    double[:, :] dynamics,
+    double chi_1,
+    double chi_2,
+    double m_1,
+    double m_2,
+    Hamiltonian_C H
+):
     """Compute dynamical quantities we need for the waveform
 
     Args:
         dynamics (np,ndarray): The dynamics array: t,r,phi,pr,pphi
     """
     result = []
     cdef double[:] p_c = np.zeros(2)
-    cdef double H_val,omega,omega_c,xi
+    cdef double H_val, omega, omega_c
     cdef double dyn[6]
     cdef double[:] q
     cdef double[:] p
     cdef double[:] row
-    cdef int i,N
+    cdef int i, N
     N = dynamics.shape[0]
 
     for i in range(N):
         row = dynamics[i]
         q = row[1:3]
         p = row[3:5]
         p_c[1] = p[1]
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/rhs_precessing.c` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/rhs_precessing.c`

 * *Files 1% similar despite different names*

```diff
@@ -1,27 +1,27 @@
-/* Generated by Cython 3.0.8 */
+/* Generated by Cython 3.0.10 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/npy_math.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ufuncobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/npy_math.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include"
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include"
         ],
         "name": "pyseobnr.eob.dynamics.rhs_precessing",
         "sources": [
             "pyseobnr/eob/dynamics/rhs_precessing.pyx"
         ]
     },
     "module_name": "pyseobnr.eob.dynamics.rhs_precessing"
@@ -48,18 +48,18 @@
     #error Cython requires Python 2.7+ or Python 3.3+.
 #else
 #if defined(CYTHON_LIMITED_API) && CYTHON_LIMITED_API
 #define __PYX_EXTRA_ABI_MODULE_NAME "limited"
 #else
 #define __PYX_EXTRA_ABI_MODULE_NAME ""
 #endif
-#define CYTHON_ABI "3_0_8" __PYX_EXTRA_ABI_MODULE_NAME
+#define CYTHON_ABI "3_0_10" __PYX_EXTRA_ABI_MODULE_NAME
 #define __PYX_ABI_MODULE_NAME "_cython_" CYTHON_ABI
 #define __PYX_TYPE_MODULE_PREFIX __PYX_ABI_MODULE_NAME "."
-#define CYTHON_HEX_VERSION 0x030008F0
+#define CYTHON_HEX_VERSION 0x03000AF0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(_WIN32) && !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -143,14 +143,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(PYPY_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #undef CYTHON_USE_TYPE_SLOTS
@@ -204,14 +206,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(CYTHON_LIMITED_API)
   #ifdef Py_LIMITED_API
     #undef __PYX_LIMITED_VERSION_HEX
     #define __PYX_LIMITED_VERSION_HEX Py_LIMITED_API
   #endif
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
@@ -265,60 +269,83 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(Py_GIL_DISABLED) || defined(Py_NOGIL)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_TYPE_SPECS
+    #define CYTHON_USE_TYPE_SPECS 0
+  #endif
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #ifndef CYTHON_USE_ASYNC_SLOTS
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_PYLONG_INTERNALS
+    #define CYTHON_USE_PYLONG_INTERNALS 0
+  #endif
   #undef CYTHON_USE_PYLIST_INTERNALS
   #define CYTHON_USE_PYLIST_INTERNALS 0
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
   #undef CYTHON_USE_UNICODE_WRITER
   #define CYTHON_USE_UNICODE_WRITER 0
-  #undef CYTHON_USE_PYLONG_INTERNALS
-  #define CYTHON_USE_PYLONG_INTERNALS 0
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
   #undef CYTHON_FAST_THREAD_STATE
   #define CYTHON_FAST_THREAD_STATE 0
+  #undef CYTHON_FAST_GIL
+  #define CYTHON_FAST_GIL 0
+  #ifndef CYTHON_METH_FASTCALL
+    #define CYTHON_METH_FASTCALL 1
+  #endif
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
+  #ifndef CYTHON_PEP487_INIT_SUBCLASS
+    #define CYTHON_PEP487_INIT_SUBCLASS 1
+  #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT 1
   #endif
+  #ifndef CYTHON_USE_MODULE_STATE
+    #define CYTHON_USE_MODULE_STATE 0
+  #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE 1
   #endif
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
@@ -401,14 +428,17 @@
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK 1
   #endif
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
   #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if !defined(CYTHON_VECTORCALL)
 #define CYTHON_VECTORCALL  (CYTHON_FAST_PYCCALL && PY_VERSION_HEX >= 0x030800B1)
 #endif
@@ -744,16 +774,21 @@
   #ifndef METH_FASTCALL
      #define METH_FASTCALL 0x80
   #endif
   typedef PyObject *(*__Pyx_PyCFunctionFast) (PyObject *self, PyObject *const *args, Py_ssize_t nargs);
   typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords) (PyObject *self, PyObject *const *args,
                                                           Py_ssize_t nargs, PyObject *kwnames);
 #else
-  #define __Pyx_PyCFunctionFast _PyCFunctionFast
-  #define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #if PY_VERSION_HEX >= 0x030d00A4
+  #  define __Pyx_PyCFunctionFast PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords PyCFunctionFastWithKeywords
+  #else
+  #  define __Pyx_PyCFunctionFast _PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #endif
 #endif
 #if CYTHON_METH_FASTCALL
   #define __Pyx_METH_FASTCALL METH_FASTCALL
   #define __Pyx_PyCFunction_FastCall __Pyx_PyCFunctionFast
   #define __Pyx_PyCFunction_FastCallWithKeywords __Pyx_PyCFunctionFastWithKeywords
 #else
   #define __Pyx_METH_FASTCALL METH_VARARGS
@@ -1097,15 +1132,15 @@
   #define __Pyx_PyList_SET_ITEM(o, i, v) PyList_SetItem(o, i, v)
   #define __Pyx_PyTuple_GET_SIZE(o) PyTuple_Size(o)
   #define __Pyx_PyList_GET_SIZE(o) PyList_Size(o)
   #define __Pyx_PySet_GET_SIZE(o) PySet_Size(o)
   #define __Pyx_PyBytes_GET_SIZE(o) PyBytes_Size(o)
   #define __Pyx_PyByteArray_GET_SIZE(o) PyByteArray_Size(o)
 #endif
-#if PY_VERSION_HEX >= 0x030d00A1
+#if __PYX_LIMITED_VERSION_HEX >= 0x030d00A1
   #define __Pyx_PyImport_AddModuleRef(name) PyImport_AddModuleRef(name)
 #else
   static CYTHON_INLINE PyObject *__Pyx_PyImport_AddModuleRef(const char *name) {
       PyObject *module = PyImport_AddModule(name);
       Py_XINCREF(module);
       return module;
   }
@@ -1184,15 +1219,15 @@
 #if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
 #define __Pyx_truncl trunc
 #else
 #define __Pyx_truncl truncl
 #endif
 
 #define __PYX_MARK_ERR_POS(f_index, lineno) \
-    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__; (void)__pyx_clineno; }
+    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__;  (void)__pyx_clineno; }
 #define __PYX_ERR(f_index, lineno, Ln_error) \
     { __PYX_MARK_ERR_POS(f_index, lineno) goto Ln_error; }
 
 #ifdef CYTHON_EXTERN_C
     #undef __PYX_EXTERN_C
     #define __PYX_EXTERN_C CYTHON_EXTERN_C
 #elif defined(__PYX_EXTERN_C)
@@ -1301,32 +1336,15 @@
 #define __Pyx_PyObject_AsSString(s)    ((const signed char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_AsUString(s)    ((const unsigned char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
 #define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
 #define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
 #define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
 #define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
-#if CYTHON_COMPILING_IN_LIMITED_API
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const wchar_t *u)
-{
-    const wchar_t *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#else
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
-{
-    const Py_UNICODE *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#endif
 #define __Pyx_PyUnicode_FromOrdinal(o)       PyUnicode_FromOrdinal((int)o)
-#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
-#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
 #define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
 #define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
 #define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
 static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
@@ -1661,177 +1679,177 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1886,51 +1904,51 @@
 struct __pyx_memoryviewslice_obj;
 struct __pyx_ctuple_double__and_double;
 typedef struct __pyx_ctuple_double__and_double __pyx_ctuple_double__and_double;
 
 /* "pyseobnr/eob/waveform/waveform.pxd":7
  *     const int ell_max
  * 
- * cpdef (double, double) RR_force(double[::1] q, double[::1] p, double omega, double omega_circ,             # <<<<<<<<<<<<<<
- *     double H, EOBParams eob_pars)
- * 
+ * cpdef (double, double) RR_force(             # <<<<<<<<<<<<<<
+ *     double[::1] q,
+ *     double[::1] p,
  */
 struct __pyx_ctuple_double__and_double {
   double f0;
   double f1;
 };
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -2041,32 +2059,33 @@
   struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *flux_params;
   struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *dynamics;
   PyObject *mode_array;
   int aligned;
 };
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":10
- *     double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":15
+ *     EOBParams eob_pars)
  * 
  * cdef class RadiationReactionForce:             # <<<<<<<<<<<<<<
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,
- *         double omega_circ, double H, EOBParams eob_pars)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce {
   PyObject_HEAD
   struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_vtab;
 };
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":14
- *         double omega_circ, double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":25
+ *         EOBParams eob_pars)
  * 
  * cdef class SEOBNRv5RRForce(RadiationReactionForce):             # <<<<<<<<<<<<<<
- *     cpdef (double,double) RR(self, double[::1] q,double[::1] p,double omega,double omega_circ,double H,EOBParams eob_par)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce {
   struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce __pyx_base;
 };
 
 
 /* "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd":4
@@ -2171,33 +2190,34 @@
 struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams {
   PyObject *(*update_spins)(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *, double, double, int __pyx_skip_dispatch);
   PyObject *(*_compute_derived_quants)(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *);
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":10
- *     double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":15
+ *     EOBParams eob_pars)
  * 
  * cdef class RadiationReactionForce:             # <<<<<<<<<<<<<<
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,
- *         double omega_circ, double H, EOBParams eob_pars)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 
 struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce {
   __pyx_ctuple_double__and_double (*RR)(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *, int __pyx_skip_dispatch);
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":14
- *         double omega_circ, double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":25
+ *         EOBParams eob_pars)
  * 
  * cdef class SEOBNRv5RRForce(RadiationReactionForce):             # <<<<<<<<<<<<<<
- *     cpdef (double,double) RR(self, double[::1] q,double[::1] p,double omega,double omega_circ,double H,EOBParams eob_par)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 
 struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce {
   struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce __pyx_base;
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce *__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce;
 
@@ -3149,30 +3169,30 @@
 
 /* SetupReduce.proto */
 #if !CYTHON_COMPILING_IN_LIMITED_API
 static int __Pyx_setup_reduce(PyObject* type_obj);
 #endif
 
 /* TypeImport.proto */
-#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_8
-#define __PYX_HAVE_RT_ImportType_proto_3_0_8
+#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_10
+#define __PYX_HAVE_RT_ImportType_proto_3_0_10
 #if defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L
 #include <stdalign.h>
 #endif
 #if (defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L) || __cplusplus >= 201103L
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) alignof(s)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) alignof(s)
 #else
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) sizeof(void*)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) sizeof(void*)
 #endif
-enum __Pyx_ImportType_CheckSize_3_0_8 {
-   __Pyx_ImportType_CheckSize_Error_3_0_8 = 0,
-   __Pyx_ImportType_CheckSize_Warn_3_0_8 = 1,
-   __Pyx_ImportType_CheckSize_Ignore_3_0_8 = 2
+enum __Pyx_ImportType_CheckSize_3_0_10 {
+   __Pyx_ImportType_CheckSize_Error_3_0_10 = 0,
+   __Pyx_ImportType_CheckSize_Warn_3_0_10 = 1,
+   __Pyx_ImportType_CheckSize_Ignore_3_0_10 = 2
 };
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size);
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size);
 #endif
 
 /* FetchSharedCythonModule.proto */
 static PyObject *__Pyx_FetchSharedCythonABIModule(void);
 
 /* FetchCommonType.proto */
 #if !CYTHON_USE_TYPE_SPECS
@@ -3561,15 +3581,15 @@
 static unsigned long __Pyx_get_runtime_version(void);
 static int __Pyx_check_binary_version(unsigned long ct_version, unsigned long rt_version, int allow_newer);
 
 /* FunctionExport.proto */
 static int __Pyx_ExportFunction(const char *name, void (*f)(void), const char *sig);
 
 /* FunctionImport.proto */
-static int __Pyx_ImportFunction_3_0_8(PyObject *module, const char *funcname, void (**f)(void), const char *sig);
+static int __Pyx_ImportFunction_3_0_10(PyObject *module, const char *funcname, void (**f)(void), const char *sig);
 
 /* InitStrings.proto */
 static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);
 
 /* #### Code section: module_declarations ### */
 static PyObject *__pyx_array_get_memview(struct __pyx_array_obj *__pyx_v_self); /* proto*/
 static char *__pyx_memoryview_get_item_pointer(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_index); /* proto*/
@@ -3704,15 +3724,14 @@
 static const char __pyx_k__7[] = ")";
 static const char __pyx_k_gc[] = "gc";
 static const char __pyx_k_id[] = "id";
 static const char __pyx_k_np[] = "np";
 static const char __pyx_k__24[] = "?";
 static const char __pyx_k_abc[] = "abc";
 static const char __pyx_k_and[] = " and ";
-static const char __pyx_k_dSO[] = "dSO";
 static const char __pyx_k_got[] = " (got ";
 static const char __pyx_k_m_1[] = "m_1";
 static const char __pyx_k_m_2[] = "m_2";
 static const char __pyx_k_new[] = "__new__";
 static const char __pyx_k_obj[] = "obj";
 static const char __pyx_k_sys[] = "sys";
 static const char __pyx_k_base[] = "base";
@@ -3769,15 +3788,14 @@
 static const char __pyx_k_ValueError[] = "ValueError";
 static const char __pyx_k_pyx_result[] = "__pyx_result";
 static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
 static const char __pyx_k_ImportError[] = "ImportError";
 static const char __pyx_k_MemoryError[] = "MemoryError";
 static const char __pyx_k_PickleError[] = "PickleError";
 static const char __pyx_k_collections[] = "collections";
-static const char __pyx_k_dSO_poly_fit[] = "dSO_poly_fit";
 static const char __pyx_k_get_rhs_prec[] = "get_rhs_prec";
 static const char __pyx_k_initializing[] = "_initializing";
 static const char __pyx_k_is_coroutine[] = "_is_coroutine";
 static const char __pyx_k_pyx_checksum[] = "__pyx_checksum";
 static const char __pyx_k_stringsource[] = "<stringsource>";
 static const char __pyx_k_version_info[] = "version_info";
 static const char __pyx_k_OverflowError[] = "OverflowError";
@@ -3802,15 +3820,15 @@
 static const char __pyx_k_MemoryView_of_r_at_0x_x[] = "<MemoryView of %r at 0x%x>";
 static const char __pyx_k_contiguous_and_indirect[] = "<contiguous and indirect>";
 static const char __pyx_k_Dimension_d_is_not_direct[] = "Dimension %d is not direct";
 static const char __pyx_k_Index_out_of_bounds_axis_d[] = "Index out of bounds (axis %d)";
 static const char __pyx_k_Step_may_not_be_zero_axis_d[] = "Step may not be zero (axis %d)";
 static const char __pyx_k_itemsize_0_for_cython_array[] = "itemsize <= 0 for cython.array";
 static const char __pyx_k_unable_to_allocate_array_data[] = "unable to allocate array data.";
-static const char __pyx_k_Contains_the_actual_RHS_of_the[] = "\nContains the actual RHS of the EOM, wrapped in cython. \nThis allows some of the cython functions used in the RHS to be called more efficiently.\n";
+static const char __pyx_k_Contains_the_actual_RHS_of_the[] = "\nContains the actual RHS of the EOM, wrapped in cython.\nThis allows some of the cython functions used in the RHS to be called more efficiently.\n";
 static const char __pyx_k_strided_and_direct_or_indirect[] = "<strided and direct or indirect>";
 static const char __pyx_k_numpy_core_multiarray_failed_to[] = "numpy.core.multiarray failed to import";
 static const char __pyx_k_All_dimensions_preceding_dimensi[] = "All dimensions preceding dimension %d must be indexed and not sliced";
 static const char __pyx_k_Buffer_view_does_not_expose_stri[] = "Buffer view does not expose strides";
 static const char __pyx_k_Can_only_create_a_buffer_that_is[] = "Can only create a buffer that is contiguous in memory.";
 static const char __pyx_k_Cannot_assign_to_read_only_memor[] = "Cannot assign to read-only memoryview";
 static const char __pyx_k_Cannot_create_writable_memory_vi[] = "Cannot create writable memory view from read-only memoryview";
@@ -3821,15 +3839,14 @@
 static const char __pyx_k_Invalid_mode_expected_c_or_fortr[] = "Invalid mode, expected 'c' or 'fortran', got ";
 static const char __pyx_k_Out_of_bounds_on_buffer_access_a[] = "Out of bounds on buffer access (axis ";
 static const char __pyx_k_Unable_to_convert_item_to_object[] = "Unable to convert item to object";
 static const char __pyx_k_got_differing_extents_in_dimensi[] = "got differing extents in dimension ";
 static const char __pyx_k_no_default___reduce___due_to_non[] = "no default __reduce__ due to non-trivial __cinit__";
 static const char __pyx_k_numpy_core_umath_failed_to_impor[] = "numpy.core.umath failed to import";
 static const char __pyx_k_pyseobnr_eob_dynamics_rhs_preces[] = "pyseobnr/eob/dynamics/rhs_precessing.pyx";
-static const char __pyx_k_pyseobnr_eob_fits_fits_Hamiltoni[] = "pyseobnr.eob.fits.fits_Hamiltonian";
 static const char __pyx_k_unable_to_allocate_shape_and_str[] = "unable to allocate shape and strides.";
 static const char __pyx_k_pyseobnr_eob_dynamics_rhs_preces_2[] = "pyseobnr.eob.dynamics.rhs_precessing";
 /* #### Code section: decls ### */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array___cinit__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_shape, Py_ssize_t __pyx_v_itemsize, PyObject *__pyx_v_format, PyObject *__pyx_v_mode, int __pyx_v_allocate_buffer); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array_2__getbuffer__(struct __pyx_array_obj *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /* proto */
 static void __pyx_array___pyx_pf_15View_dot_MemoryView_5array_4__dealloc__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_5array_7memview___get__(struct __pyx_array_obj *__pyx_v_self); /* proto */
@@ -4018,16 +4035,14 @@
   PyObject *__pyx_n_s_class_getitem;
   PyObject *__pyx_n_s_cline_in_traceback;
   PyObject *__pyx_n_s_collections;
   PyObject *__pyx_kp_s_collections_abc;
   PyObject *__pyx_kp_s_contiguous_and_direct;
   PyObject *__pyx_kp_s_contiguous_and_indirect;
   PyObject *__pyx_n_s_count;
-  PyObject *__pyx_n_s_dSO;
-  PyObject *__pyx_n_s_dSO_poly_fit;
   PyObject *__pyx_n_s_dict;
   PyObject *__pyx_kp_u_disable;
   PyObject *__pyx_n_s_dtype_is_object;
   PyObject *__pyx_kp_u_enable;
   PyObject *__pyx_n_s_encode;
   PyObject *__pyx_n_s_enumerate;
   PyObject *__pyx_n_s_error;
@@ -4065,15 +4080,14 @@
   PyObject *__pyx_kp_u_numpy_core_umath_failed_to_impor;
   PyObject *__pyx_n_s_obj;
   PyObject *__pyx_n_s_pack;
   PyObject *__pyx_n_s_params;
   PyObject *__pyx_n_s_pickle;
   PyObject *__pyx_kp_s_pyseobnr_eob_dynamics_rhs_preces;
   PyObject *__pyx_n_s_pyseobnr_eob_dynamics_rhs_preces_2;
-  PyObject *__pyx_n_s_pyseobnr_eob_fits_fits_Hamiltoni;
   PyObject *__pyx_n_s_pyx_PickleError;
   PyObject *__pyx_n_s_pyx_checksum;
   PyObject *__pyx_n_s_pyx_result;
   PyObject *__pyx_n_s_pyx_state;
   PyObject *__pyx_n_s_pyx_type;
   PyObject *__pyx_n_s_pyx_unpickle_Enum;
   PyObject *__pyx_n_s_pyx_vtable;
@@ -4255,16 +4269,14 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_class_getitem);
   Py_CLEAR(clear_module_state->__pyx_n_s_cline_in_traceback);
   Py_CLEAR(clear_module_state->__pyx_n_s_collections);
   Py_CLEAR(clear_module_state->__pyx_kp_s_collections_abc);
   Py_CLEAR(clear_module_state->__pyx_kp_s_contiguous_and_direct);
   Py_CLEAR(clear_module_state->__pyx_kp_s_contiguous_and_indirect);
   Py_CLEAR(clear_module_state->__pyx_n_s_count);
-  Py_CLEAR(clear_module_state->__pyx_n_s_dSO);
-  Py_CLEAR(clear_module_state->__pyx_n_s_dSO_poly_fit);
   Py_CLEAR(clear_module_state->__pyx_n_s_dict);
   Py_CLEAR(clear_module_state->__pyx_kp_u_disable);
   Py_CLEAR(clear_module_state->__pyx_n_s_dtype_is_object);
   Py_CLEAR(clear_module_state->__pyx_kp_u_enable);
   Py_CLEAR(clear_module_state->__pyx_n_s_encode);
   Py_CLEAR(clear_module_state->__pyx_n_s_enumerate);
   Py_CLEAR(clear_module_state->__pyx_n_s_error);
@@ -4302,15 +4314,14 @@
   Py_CLEAR(clear_module_state->__pyx_kp_u_numpy_core_umath_failed_to_impor);
   Py_CLEAR(clear_module_state->__pyx_n_s_obj);
   Py_CLEAR(clear_module_state->__pyx_n_s_pack);
   Py_CLEAR(clear_module_state->__pyx_n_s_params);
   Py_CLEAR(clear_module_state->__pyx_n_s_pickle);
   Py_CLEAR(clear_module_state->__pyx_kp_s_pyseobnr_eob_dynamics_rhs_preces);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyseobnr_eob_dynamics_rhs_preces_2);
-  Py_CLEAR(clear_module_state->__pyx_n_s_pyseobnr_eob_fits_fits_Hamiltoni);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_PickleError);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_checksum);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_result);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_state);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_type);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_unpickle_Enum);
   Py_CLEAR(clear_module_state->__pyx_n_s_pyx_vtable);
@@ -4470,16 +4481,14 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_class_getitem);
   Py_VISIT(traverse_module_state->__pyx_n_s_cline_in_traceback);
   Py_VISIT(traverse_module_state->__pyx_n_s_collections);
   Py_VISIT(traverse_module_state->__pyx_kp_s_collections_abc);
   Py_VISIT(traverse_module_state->__pyx_kp_s_contiguous_and_direct);
   Py_VISIT(traverse_module_state->__pyx_kp_s_contiguous_and_indirect);
   Py_VISIT(traverse_module_state->__pyx_n_s_count);
-  Py_VISIT(traverse_module_state->__pyx_n_s_dSO);
-  Py_VISIT(traverse_module_state->__pyx_n_s_dSO_poly_fit);
   Py_VISIT(traverse_module_state->__pyx_n_s_dict);
   Py_VISIT(traverse_module_state->__pyx_kp_u_disable);
   Py_VISIT(traverse_module_state->__pyx_n_s_dtype_is_object);
   Py_VISIT(traverse_module_state->__pyx_kp_u_enable);
   Py_VISIT(traverse_module_state->__pyx_n_s_encode);
   Py_VISIT(traverse_module_state->__pyx_n_s_enumerate);
   Py_VISIT(traverse_module_state->__pyx_n_s_error);
@@ -4517,15 +4526,14 @@
   Py_VISIT(traverse_module_state->__pyx_kp_u_numpy_core_umath_failed_to_impor);
   Py_VISIT(traverse_module_state->__pyx_n_s_obj);
   Py_VISIT(traverse_module_state->__pyx_n_s_pack);
   Py_VISIT(traverse_module_state->__pyx_n_s_params);
   Py_VISIT(traverse_module_state->__pyx_n_s_pickle);
   Py_VISIT(traverse_module_state->__pyx_kp_s_pyseobnr_eob_dynamics_rhs_preces);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyseobnr_eob_dynamics_rhs_preces_2);
-  Py_VISIT(traverse_module_state->__pyx_n_s_pyseobnr_eob_fits_fits_Hamiltoni);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_PickleError);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_checksum);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_result);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_state);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_type);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_unpickle_Enum);
   Py_VISIT(traverse_module_state->__pyx_n_s_pyx_vtable);
@@ -4725,16 +4733,14 @@
 #define __pyx_n_s_class_getitem __pyx_mstate_global->__pyx_n_s_class_getitem
 #define __pyx_n_s_cline_in_traceback __pyx_mstate_global->__pyx_n_s_cline_in_traceback
 #define __pyx_n_s_collections __pyx_mstate_global->__pyx_n_s_collections
 #define __pyx_kp_s_collections_abc __pyx_mstate_global->__pyx_kp_s_collections_abc
 #define __pyx_kp_s_contiguous_and_direct __pyx_mstate_global->__pyx_kp_s_contiguous_and_direct
 #define __pyx_kp_s_contiguous_and_indirect __pyx_mstate_global->__pyx_kp_s_contiguous_and_indirect
 #define __pyx_n_s_count __pyx_mstate_global->__pyx_n_s_count
-#define __pyx_n_s_dSO __pyx_mstate_global->__pyx_n_s_dSO
-#define __pyx_n_s_dSO_poly_fit __pyx_mstate_global->__pyx_n_s_dSO_poly_fit
 #define __pyx_n_s_dict __pyx_mstate_global->__pyx_n_s_dict
 #define __pyx_kp_u_disable __pyx_mstate_global->__pyx_kp_u_disable
 #define __pyx_n_s_dtype_is_object __pyx_mstate_global->__pyx_n_s_dtype_is_object
 #define __pyx_kp_u_enable __pyx_mstate_global->__pyx_kp_u_enable
 #define __pyx_n_s_encode __pyx_mstate_global->__pyx_n_s_encode
 #define __pyx_n_s_enumerate __pyx_mstate_global->__pyx_n_s_enumerate
 #define __pyx_n_s_error __pyx_mstate_global->__pyx_n_s_error
@@ -4772,15 +4778,14 @@
 #define __pyx_kp_u_numpy_core_umath_failed_to_impor __pyx_mstate_global->__pyx_kp_u_numpy_core_umath_failed_to_impor
 #define __pyx_n_s_obj __pyx_mstate_global->__pyx_n_s_obj
 #define __pyx_n_s_pack __pyx_mstate_global->__pyx_n_s_pack
 #define __pyx_n_s_params __pyx_mstate_global->__pyx_n_s_params
 #define __pyx_n_s_pickle __pyx_mstate_global->__pyx_n_s_pickle
 #define __pyx_kp_s_pyseobnr_eob_dynamics_rhs_preces __pyx_mstate_global->__pyx_kp_s_pyseobnr_eob_dynamics_rhs_preces
 #define __pyx_n_s_pyseobnr_eob_dynamics_rhs_preces_2 __pyx_mstate_global->__pyx_n_s_pyseobnr_eob_dynamics_rhs_preces_2
-#define __pyx_n_s_pyseobnr_eob_fits_fits_Hamiltoni __pyx_mstate_global->__pyx_n_s_pyseobnr_eob_fits_fits_Hamiltoni
 #define __pyx_n_s_pyx_PickleError __pyx_mstate_global->__pyx_n_s_pyx_PickleError
 #define __pyx_n_s_pyx_checksum __pyx_mstate_global->__pyx_n_s_pyx_checksum
 #define __pyx_n_s_pyx_result __pyx_mstate_global->__pyx_n_s_pyx_result
 #define __pyx_n_s_pyx_state __pyx_mstate_global->__pyx_n_s_pyx_state
 #define __pyx_n_s_pyx_type __pyx_mstate_global->__pyx_n_s_pyx_type
 #define __pyx_n_s_pyx_unpickle_Enum __pyx_mstate_global->__pyx_n_s_pyx_unpickle_Enum
 #define __pyx_n_s_pyx_vtable __pyx_mstate_global->__pyx_n_s_pyx_vtable
@@ -19054,261 +19059,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19317,29 +19322,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19350,15 +19355,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19367,29 +19372,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19400,15 +19405,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19417,29 +19422,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19450,15 +19455,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19467,29 +19472,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19500,15 +19505,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19517,29 +19522,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19550,217 +19555,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":969
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":970
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":970
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 970, __pyx_L1_error)
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":973
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":975
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":975
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":976
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":976
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19776,15 +19781,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -19792,68 +19797,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":982
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":982
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 982, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":983
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":983
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 984, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 984, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19861,15 +19866,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19884,15 +19889,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19908,15 +19913,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19924,68 +19929,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":988
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":988
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 988, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":989
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":989
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 990, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 990, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19993,15 +19998,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20016,15 +20021,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20040,15 +20045,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -20056,68 +20061,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":994
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":994
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 994, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":995
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":995
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":996
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":996
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 996, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 996, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -20125,15 +20130,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20148,170 +20153,170 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1011
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1011
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1026
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1026
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1036
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1036
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1043
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1043
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1050
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1050
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -20319,17 +20324,17 @@
   __pyx_L0:;
   return __pyx_r;
 }
 
 /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":26
  *     bint npy_isnan(double x)
  * 
- * cpdef get_rhs_prec(double t, double[::1] z, Hamiltonian_v5PHM_C H, RadiationReactionForce RR,             # <<<<<<<<<<<<<<
- *     double m_1, double m_2, EOBParams params):
- *     """
+ * cpdef get_rhs_prec(             # <<<<<<<<<<<<<<
+ *     double t,
+ *     double[::1] z,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8dynamics_14rhs_precessing_1get_rhs_prec(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
@@ -20364,22 +20369,22 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__11)
   __Pyx_RefNannySetupContext("get_rhs_prec", 1);
   __Pyx_TraceCall("get_rhs_prec", __pyx_f[1], 26, 0, __PYX_ERR(1, 26, __pyx_L1_error));
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":33
- *     :math:`\\dot{r}`, :math:`\\dot{\\phi}`, :math:`\\dot{p}_{r}`, :math:`\\dot{p}_{\\phi}`.
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":45
+ *     * :math:`\\dot{p}_{\\phi}`.
  *     """
  *     cdef double[::1] q = z[:2]             # <<<<<<<<<<<<<<
  *     cdef double[::1] p = z[2:]
  * 
  */
-  __Pyx_TraceLine(33,0,__PYX_ERR(1, 33, __pyx_L1_error))
+  __Pyx_TraceLine(45,0,__PYX_ERR(1, 45, __pyx_L1_error))
   __pyx_t_1.data = __pyx_v_z.data;
   __pyx_t_1.memview = __pyx_v_z.memview;
   __PYX_INC_MEMVIEW(&__pyx_t_1, 1);
   __pyx_t_2 = -1;
   if (unlikely(__pyx_memoryview_slice_memviewslice(
     &__pyx_t_1,
     __pyx_v_z.shape[0], __pyx_v_z.strides[0], __pyx_v_z.suboffsets[0],
@@ -20390,29 +20395,29 @@
     2,
     0,
     0,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(1, 33, __pyx_L1_error)
+    __PYX_ERR(1, 45, __pyx_L1_error)
 }
 
 __pyx_v_q = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":34
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":46
  *     """
  *     cdef double[::1] q = z[:2]
  *     cdef double[::1] p = z[2:]             # <<<<<<<<<<<<<<
  * 
  *     cdef double chi1_LN = params.p_params.chi_1
  */
-  __Pyx_TraceLine(34,0,__PYX_ERR(1, 34, __pyx_L1_error))
+  __Pyx_TraceLine(46,0,__PYX_ERR(1, 46, __pyx_L1_error))
   __pyx_t_1.data = __pyx_v_z.data;
   __pyx_t_1.memview = __pyx_v_z.memview;
   __PYX_INC_MEMVIEW(&__pyx_t_1, 1);
   __pyx_t_2 = -1;
   if (unlikely(__pyx_memoryview_slice_memviewslice(
     &__pyx_t_1,
     __pyx_v_z.shape[0], __pyx_v_z.strides[0], __pyx_v_z.suboffsets[0],
@@ -20423,207 +20428,208 @@
     0,
     0,
     1,
     0,
     0,
     1) < 0))
 {
-    __PYX_ERR(1, 34, __pyx_L1_error)
+    __PYX_ERR(1, 46, __pyx_L1_error)
 }
 
 __pyx_v_p = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":36
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":48
  *     cdef double[::1] p = z[2:]
  * 
  *     cdef double chi1_LN = params.p_params.chi_1             # <<<<<<<<<<<<<<
  *     cdef double chi2_LN = params.p_params.chi_2
  * 
  */
-  __Pyx_TraceLine(36,0,__PYX_ERR(1, 36, __pyx_L1_error))
+  __Pyx_TraceLine(48,0,__PYX_ERR(1, 48, __pyx_L1_error))
   __pyx_t_3 = __pyx_v_params->p_params->chi_1;
   __pyx_v_chi1_LN = __pyx_t_3;
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":37
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":49
  * 
  *     cdef double chi1_LN = params.p_params.chi_1
  *     cdef double chi2_LN = params.p_params.chi_2             # <<<<<<<<<<<<<<
  * 
  *     cdef double chi1_L = params.p_params.chi1_L
  */
-  __Pyx_TraceLine(37,0,__PYX_ERR(1, 37, __pyx_L1_error))
+  __Pyx_TraceLine(49,0,__PYX_ERR(1, 49, __pyx_L1_error))
   __pyx_t_3 = __pyx_v_params->p_params->chi_2;
   __pyx_v_chi2_LN = __pyx_t_3;
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":39
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":51
  *     cdef double chi2_LN = params.p_params.chi_2
  * 
  *     cdef double chi1_L = params.p_params.chi1_L             # <<<<<<<<<<<<<<
  *     cdef double chi2_L = params.p_params.chi2_L
  * 
  */
-  __Pyx_TraceLine(39,0,__PYX_ERR(1, 39, __pyx_L1_error))
+  __Pyx_TraceLine(51,0,__PYX_ERR(1, 51, __pyx_L1_error))
   __pyx_t_3 = __pyx_v_params->p_params->chi1_L;
   __pyx_v_chi1_L = __pyx_t_3;
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":40
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":52
  * 
  *     cdef double chi1_L = params.p_params.chi1_L
  *     cdef double chi2_L = params.p_params.chi2_L             # <<<<<<<<<<<<<<
  * 
- *     cdef double H_val,omega,omega_circ,xi
+ *     cdef double H_val, omega, omega_circ, xi
  */
-  __Pyx_TraceLine(40,0,__PYX_ERR(1, 40, __pyx_L1_error))
+  __Pyx_TraceLine(52,0,__PYX_ERR(1, 52, __pyx_L1_error))
   __pyx_t_3 = __pyx_v_params->p_params->chi2_L;
   __pyx_v_chi2_L = __pyx_t_3;
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":44
- *     cdef double H_val,omega,omega_circ,xi
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":56
+ *     cdef double H_val, omega, omega_circ, xi
  *     cdef double dynamics[6]
- *     dynamics[:] = H.dynamics(q,             # <<<<<<<<<<<<<<
+ *     dynamics[:] = H.dynamics(             # <<<<<<<<<<<<<<
+ *         q,
  *         p,
- *         params.p_params.chi1_v,
  */
-  __Pyx_TraceLine(44,0,__PYX_ERR(1, 44, __pyx_L1_error))
-  __pyx_t_4 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_H->__pyx_vtab)->dynamics(__pyx_v_H, __pyx_v_q, __pyx_v_p, __pyx_v_params->p_params->chi1_v, __pyx_v_params->p_params->chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi1_LN, __pyx_v_chi2_LN, __pyx_v_chi1_L, __pyx_v_chi2_L, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 44, __pyx_L1_error)
+  __Pyx_TraceLine(56,0,__PYX_ERR(1, 56, __pyx_L1_error))
+  __pyx_t_4 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_H->__pyx_vtab)->dynamics(__pyx_v_H, __pyx_v_q, __pyx_v_p, __pyx_v_params->p_params->chi1_v, __pyx_v_params->p_params->chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi1_LN, __pyx_v_chi2_LN, __pyx_v_chi1_L, __pyx_v_chi2_L, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 56, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (unlikely((__Pyx_carray_from_py_double(__pyx_t_4, __pyx_t_5, 6) < 0))) __PYX_ERR(1, 44, __pyx_L1_error)
+  if (unlikely((__Pyx_carray_from_py_double(__pyx_t_4, __pyx_t_5, 6) < 0))) __PYX_ERR(1, 56, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   memcpy(&(__pyx_v_dynamics[0]), __pyx_t_5, sizeof(__pyx_v_dynamics[0]) * (6));
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":54
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":67
  *         chi1_L,
  *         chi2_L,)
  *     H_val = dynamics[4]             # <<<<<<<<<<<<<<
  *     omega = dynamics[3]
  *     params.dynamics.p_circ[1] = p[1]
  */
-  __Pyx_TraceLine(54,0,__PYX_ERR(1, 54, __pyx_L1_error))
+  __Pyx_TraceLine(67,0,__PYX_ERR(1, 67, __pyx_L1_error))
   __pyx_v_H_val = (__pyx_v_dynamics[4]);
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":55
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":68
  *         chi2_L,)
  *     H_val = dynamics[4]
  *     omega = dynamics[3]             # <<<<<<<<<<<<<<
  *     params.dynamics.p_circ[1] = p[1]
  * 
  */
-  __Pyx_TraceLine(55,0,__PYX_ERR(1, 55, __pyx_L1_error))
+  __Pyx_TraceLine(68,0,__PYX_ERR(1, 68, __pyx_L1_error))
   __pyx_v_omega = (__pyx_v_dynamics[3]);
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":56
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":69
  *     H_val = dynamics[4]
  *     omega = dynamics[3]
  *     params.dynamics.p_circ[1] = p[1]             # <<<<<<<<<<<<<<
  * 
- *     omega_circ = H.omega(q,
+ *     omega_circ = H.omega(
  */
-  __Pyx_TraceLine(56,0,__PYX_ERR(1, 56, __pyx_L1_error))
+  __Pyx_TraceLine(69,0,__PYX_ERR(1, 69, __pyx_L1_error))
   __pyx_t_6 = 1;
   if (__pyx_t_6 < 0) __pyx_t_6 += __pyx_v_p.shape[0];
   __pyx_t_7 = 1;
   if (__pyx_t_7 < 0) __pyx_t_7 += __pyx_v_params->dynamics->p_circ.shape[0];
   *((double *) ( /* dim=0 */ (__pyx_v_params->dynamics->p_circ.data + __pyx_t_7 * __pyx_v_params->dynamics->p_circ.strides[0]) )) = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_p.data) + __pyx_t_6)) )));
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":58
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":71
  *     params.dynamics.p_circ[1] = p[1]
  * 
- *     omega_circ = H.omega(q,             # <<<<<<<<<<<<<<
+ *     omega_circ = H.omega(             # <<<<<<<<<<<<<<
+ *         q,
  *         params.dynamics.p_circ,
- *         params.p_params.chi1_v,
  */
-  __Pyx_TraceLine(58,0,__PYX_ERR(1, 58, __pyx_L1_error))
-  __pyx_t_3 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_H->__pyx_vtab)->omega(__pyx_v_H, __pyx_v_q, __pyx_v_params->dynamics->p_circ, __pyx_v_params->p_params->chi1_v, __pyx_v_params->p_params->chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi1_LN, __pyx_v_chi2_LN, __pyx_v_chi1_L, __pyx_v_chi2_L, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(1, 58, __pyx_L1_error)
+  __Pyx_TraceLine(71,0,__PYX_ERR(1, 71, __pyx_L1_error))
+  __pyx_t_3 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)__pyx_v_H->__pyx_vtab)->omega(__pyx_v_H, __pyx_v_q, __pyx_v_params->dynamics->p_circ, __pyx_v_params->p_params->chi1_v, __pyx_v_params->p_params->chi2_v, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_chi1_LN, __pyx_v_chi2_LN, __pyx_v_chi1_L, __pyx_v_chi2_L, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(1, 71, __pyx_L1_error)
   __pyx_v_omega_circ = __pyx_t_3;
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":69
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":83
  *         chi2_L,)
  * 
  *     xi = dynamics[5]             # <<<<<<<<<<<<<<
  * 
  *     params.p_params.omega_circ = omega_circ
  */
-  __Pyx_TraceLine(69,0,__PYX_ERR(1, 69, __pyx_L1_error))
+  __Pyx_TraceLine(83,0,__PYX_ERR(1, 83, __pyx_L1_error))
   __pyx_v_xi = (__pyx_v_dynamics[5]);
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":71
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":85
  *     xi = dynamics[5]
  * 
  *     params.p_params.omega_circ = omega_circ             # <<<<<<<<<<<<<<
  *     params.p_params.omega = omega
  *     params.p_params.H_val = H_val
  */
-  __Pyx_TraceLine(71,0,__PYX_ERR(1, 71, __pyx_L1_error))
+  __Pyx_TraceLine(85,0,__PYX_ERR(1, 85, __pyx_L1_error))
   __pyx_v_params->p_params->omega_circ = __pyx_v_omega_circ;
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":72
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":86
  * 
  *     params.p_params.omega_circ = omega_circ
  *     params.p_params.omega = omega             # <<<<<<<<<<<<<<
  *     params.p_params.H_val = H_val
  * 
  */
-  __Pyx_TraceLine(72,0,__PYX_ERR(1, 72, __pyx_L1_error))
+  __Pyx_TraceLine(86,0,__PYX_ERR(1, 86, __pyx_L1_error))
   __pyx_v_params->p_params->omega = __pyx_v_omega;
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":73
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":87
  *     params.p_params.omega_circ = omega_circ
  *     params.p_params.omega = omega
  *     params.p_params.H_val = H_val             # <<<<<<<<<<<<<<
  * 
- * 
+ *     cdef (double, double) RR_f = RR.RR(q, p, omega, omega_circ, H_val, params)
  */
-  __Pyx_TraceLine(73,0,__PYX_ERR(1, 73, __pyx_L1_error))
+  __Pyx_TraceLine(87,0,__PYX_ERR(1, 87, __pyx_L1_error))
   __pyx_v_params->p_params->H_val = __pyx_v_H_val;
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":77
- * 
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":89
+ *     params.p_params.H_val = H_val
  * 
  *     cdef (double, double) RR_f = RR.RR(q, p, omega, omega_circ, H_val, params)             # <<<<<<<<<<<<<<
  * 
  *     cdef double deriv[4]
  */
-  __Pyx_TraceLine(77,0,__PYX_ERR(1, 77, __pyx_L1_error))
-  __pyx_t_8 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *)__pyx_v_RR->__pyx_vtab)->RR(__pyx_v_RR, __pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H_val, __pyx_v_params, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(1, 77, __pyx_L1_error)
+  __Pyx_TraceLine(89,0,__PYX_ERR(1, 89, __pyx_L1_error))
+  __pyx_t_8 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *)__pyx_v_RR->__pyx_vtab)->RR(__pyx_v_RR, __pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H_val, __pyx_v_params, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(1, 89, __pyx_L1_error)
   __pyx_v_RR_f = __pyx_t_8;
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":80
- * 
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":93
  *     cdef double deriv[4]
+ * 
  *     deriv[:] = [xi * dynamics[2], dynamics[3], -dynamics[0] * xi + RR_f[0], -dynamics[1] + RR_f[1]]             # <<<<<<<<<<<<<<
+ * 
  *     return deriv
  */
-  __Pyx_TraceLine(80,0,__PYX_ERR(1, 80, __pyx_L1_error))
+  __Pyx_TraceLine(93,0,__PYX_ERR(1, 93, __pyx_L1_error))
   __pyx_t_9[0] = (__pyx_v_xi * (__pyx_v_dynamics[2]));
   __pyx_t_9[1] = (__pyx_v_dynamics[3]);
   __pyx_t_9[2] = (((-(__pyx_v_dynamics[0])) * __pyx_v_xi) + __pyx_v_RR_f.f0);
   __pyx_t_9[3] = ((-(__pyx_v_dynamics[1])) + __pyx_v_RR_f.f1);
   memcpy(&(__pyx_v_deriv[0]), __pyx_t_9, sizeof(__pyx_v_deriv[0]) * (4));
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":81
- *     cdef double deriv[4]
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":95
  *     deriv[:] = [xi * dynamics[2], dynamics[3], -dynamics[0] * xi + RR_f[0], -dynamics[1] + RR_f[1]]
+ * 
  *     return deriv             # <<<<<<<<<<<<<<
  */
-  __Pyx_TraceLine(81,0,__PYX_ERR(1, 81, __pyx_L1_error))
+  __Pyx_TraceLine(95,0,__PYX_ERR(1, 95, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_4 = __Pyx_carray_to_py_double(__pyx_v_deriv, 4); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 81, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_carray_to_py_double(__pyx_v_deriv, 4); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 95, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_r = __pyx_t_4;
   __pyx_t_4 = 0;
   goto __pyx_L0;
 
   /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":26
  *     bint npy_isnan(double x)
  * 
- * cpdef get_rhs_prec(double t, double[::1] z, Hamiltonian_v5PHM_C H, RadiationReactionForce RR,             # <<<<<<<<<<<<<<
- *     double m_1, double m_2, EOBParams params):
- *     """
+ * cpdef get_rhs_prec(             # <<<<<<<<<<<<<<
+ *     double t,
+ *     double[::1] z,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_1, 1);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_AddTraceback("pyseobnr.eob.dynamics.rhs_precessing.get_rhs_prec", __pyx_clineno, __pyx_lineno, __pyx_filename);
@@ -20641,15 +20647,15 @@
 static PyObject *__pyx_pw_8pyseobnr_3eob_8dynamics_14rhs_precessing_1get_rhs_prec(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-PyDoc_STRVAR(__pyx_doc_8pyseobnr_3eob_8dynamics_14rhs_precessing_get_rhs_prec, "\n    Compute the RHS of the EOB evolution equations.\n    In particular this function returns\n    :math:`\\dot{r}`, :math:`\\dot{\\phi}`, :math:`\\dot{p}_{r}`, :math:`\\dot{p}_{\\phi}`.\n    ");
+PyDoc_STRVAR(__pyx_doc_8pyseobnr_3eob_8dynamics_14rhs_precessing_get_rhs_prec, "\n    Compute the RHS of the EOB evolution equations.\n\n    In particular this function returns\n\n    * :math:`\\dot{r}`,\n    * :math:`\\dot{\\phi}`,\n    * :math:`\\dot{p}_{r}`,\n    * :math:`\\dot{p}_{\\phi}`.\n    ");
 static PyMethodDef __pyx_mdef_8pyseobnr_3eob_8dynamics_14rhs_precessing_1get_rhs_prec = {"get_rhs_prec", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8pyseobnr_3eob_8dynamics_14rhs_precessing_1get_rhs_prec, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8pyseobnr_3eob_8dynamics_14rhs_precessing_get_rhs_prec};
 static PyObject *__pyx_pw_8pyseobnr_3eob_8dynamics_14rhs_precessing_1get_rhs_prec(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
@@ -20783,20 +20789,20 @@
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
       values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
       values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
       values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
       values[6] = __Pyx_Arg_FASTCALL(__pyx_args, 6);
     }
-    __pyx_v_t = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_t == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 26, __pyx_L3_error)
-    __pyx_v_z = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_z.memview)) __PYX_ERR(1, 26, __pyx_L3_error)
+    __pyx_v_t = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_t == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 27, __pyx_L3_error)
+    __pyx_v_z = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_z.memview)) __PYX_ERR(1, 28, __pyx_L3_error)
     __pyx_v_H = ((struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *)values[2]);
     __pyx_v_RR = ((struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *)values[3]);
-    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 27, __pyx_L3_error)
-    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 27, __pyx_L3_error)
+    __pyx_v_m_1 = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_m_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 31, __pyx_L3_error)
+    __pyx_v_m_2 = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_m_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(1, 32, __pyx_L3_error)
     __pyx_v_params = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)values[6]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
   __Pyx_RaiseArgtupleInvalid("get_rhs_prec", 1, 7, 7, __pyx_nargs); __PYX_ERR(1, 26, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
@@ -20808,17 +20814,17 @@
     }
   }
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_z, 1);
   __Pyx_AddTraceback("pyseobnr.eob.dynamics.rhs_precessing.get_rhs_prec", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_H), __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, 1, "H", 0))) __PYX_ERR(1, 26, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_RR), __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce, 1, "RR", 0))) __PYX_ERR(1, 26, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_params), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "params", 0))) __PYX_ERR(1, 27, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_H), __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, 1, "H", 0))) __PYX_ERR(1, 29, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_RR), __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce, 1, "RR", 0))) __PYX_ERR(1, 30, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_params), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "params", 0))) __PYX_ERR(1, 33, __pyx_L1_error)
   __pyx_r = __pyx_pf_8pyseobnr_3eob_8dynamics_14rhs_precessing_get_rhs_prec(__pyx_self, __pyx_v_t, __pyx_v_z, __pyx_v_H, __pyx_v_RR, __pyx_v_m_1, __pyx_v_m_2, __pyx_v_params);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -21877,16 +21883,14 @@
     {&__pyx_n_s_class_getitem, __pyx_k_class_getitem, sizeof(__pyx_k_class_getitem), 0, 0, 1, 1},
     {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
     {&__pyx_n_s_collections, __pyx_k_collections, sizeof(__pyx_k_collections), 0, 0, 1, 1},
     {&__pyx_kp_s_collections_abc, __pyx_k_collections_abc, sizeof(__pyx_k_collections_abc), 0, 0, 1, 0},
     {&__pyx_kp_s_contiguous_and_direct, __pyx_k_contiguous_and_direct, sizeof(__pyx_k_contiguous_and_direct), 0, 0, 1, 0},
     {&__pyx_kp_s_contiguous_and_indirect, __pyx_k_contiguous_and_indirect, sizeof(__pyx_k_contiguous_and_indirect), 0, 0, 1, 0},
     {&__pyx_n_s_count, __pyx_k_count, sizeof(__pyx_k_count), 0, 0, 1, 1},
-    {&__pyx_n_s_dSO, __pyx_k_dSO, sizeof(__pyx_k_dSO), 0, 0, 1, 1},
-    {&__pyx_n_s_dSO_poly_fit, __pyx_k_dSO_poly_fit, sizeof(__pyx_k_dSO_poly_fit), 0, 0, 1, 1},
     {&__pyx_n_s_dict, __pyx_k_dict, sizeof(__pyx_k_dict), 0, 0, 1, 1},
     {&__pyx_kp_u_disable, __pyx_k_disable, sizeof(__pyx_k_disable), 0, 1, 0, 0},
     {&__pyx_n_s_dtype_is_object, __pyx_k_dtype_is_object, sizeof(__pyx_k_dtype_is_object), 0, 0, 1, 1},
     {&__pyx_kp_u_enable, __pyx_k_enable, sizeof(__pyx_k_enable), 0, 1, 0, 0},
     {&__pyx_n_s_encode, __pyx_k_encode, sizeof(__pyx_k_encode), 0, 0, 1, 1},
     {&__pyx_n_s_enumerate, __pyx_k_enumerate, sizeof(__pyx_k_enumerate), 0, 0, 1, 1},
     {&__pyx_n_s_error, __pyx_k_error, sizeof(__pyx_k_error), 0, 0, 1, 1},
@@ -21924,15 +21928,14 @@
     {&__pyx_kp_u_numpy_core_umath_failed_to_impor, __pyx_k_numpy_core_umath_failed_to_impor, sizeof(__pyx_k_numpy_core_umath_failed_to_impor), 0, 1, 0, 0},
     {&__pyx_n_s_obj, __pyx_k_obj, sizeof(__pyx_k_obj), 0, 0, 1, 1},
     {&__pyx_n_s_pack, __pyx_k_pack, sizeof(__pyx_k_pack), 0, 0, 1, 1},
     {&__pyx_n_s_params, __pyx_k_params, sizeof(__pyx_k_params), 0, 0, 1, 1},
     {&__pyx_n_s_pickle, __pyx_k_pickle, sizeof(__pyx_k_pickle), 0, 0, 1, 1},
     {&__pyx_kp_s_pyseobnr_eob_dynamics_rhs_preces, __pyx_k_pyseobnr_eob_dynamics_rhs_preces, sizeof(__pyx_k_pyseobnr_eob_dynamics_rhs_preces), 0, 0, 1, 0},
     {&__pyx_n_s_pyseobnr_eob_dynamics_rhs_preces_2, __pyx_k_pyseobnr_eob_dynamics_rhs_preces_2, sizeof(__pyx_k_pyseobnr_eob_dynamics_rhs_preces_2), 0, 0, 1, 1},
-    {&__pyx_n_s_pyseobnr_eob_fits_fits_Hamiltoni, __pyx_k_pyseobnr_eob_fits_fits_Hamiltoni, sizeof(__pyx_k_pyseobnr_eob_fits_fits_Hamiltoni), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_PickleError, __pyx_k_pyx_PickleError, sizeof(__pyx_k_pyx_PickleError), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_checksum, __pyx_k_pyx_checksum, sizeof(__pyx_k_pyx_checksum), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_result, __pyx_k_pyx_result, sizeof(__pyx_k_pyx_result), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_state, __pyx_k_pyx_state, sizeof(__pyx_k_pyx_state), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_type, __pyx_k_pyx_type, sizeof(__pyx_k_pyx_type), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_unpickle_Enum, __pyx_k_pyx_unpickle_Enum, sizeof(__pyx_k_pyx_unpickle_Enum), 0, 0, 1, 1},
     {&__pyx_n_s_pyx_vtable, __pyx_k_pyx_vtable, sizeof(__pyx_k_pyx_vtable), 0, 0, 1, 1},
@@ -22023,26 +22026,26 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 984, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 990, __pyx_L1_error)
@@ -22149,17 +22152,17 @@
   __Pyx_GOTREF(__pyx_tuple__21);
   __Pyx_GIVEREF(__pyx_tuple__21);
   __pyx_codeobj__22 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__21, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__22)) __PYX_ERR(0, 1, __pyx_L1_error)
 
   /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":26
  *     bint npy_isnan(double x)
  * 
- * cpdef get_rhs_prec(double t, double[::1] z, Hamiltonian_v5PHM_C H, RadiationReactionForce RR,             # <<<<<<<<<<<<<<
- *     double m_1, double m_2, EOBParams params):
- *     """
+ * cpdef get_rhs_prec(             # <<<<<<<<<<<<<<
+ *     double t,
+ *     double[::1] z,
  */
   __pyx_tuple__23 = PyTuple_Pack(7, __pyx_n_s_t, __pyx_n_s_z, __pyx_n_s_H, __pyx_n_s_RR, __pyx_n_s_m_1, __pyx_n_s_m_2, __pyx_n_s_params); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(1, 26, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__23);
   __Pyx_GIVEREF(__pyx_tuple__23);
   __pyx_codeobj__11 = (PyObject*)__Pyx_PyCode_New(7, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_dynamics_rhs_preces, __pyx_n_s_get_rhs_prec, 26, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(1, 26, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
@@ -22422,62 +22425,62 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(3, 8, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(3, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(3, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(3, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(3, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(3, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(3, 67, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(3, 23, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(3, 26, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(3, 29, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(3, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 10, __pyx_L1_error)
+  __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(4, 10, __pyx_L1_error)
-  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(4, 10, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(4, 14, __pyx_L1_error)
-  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(4, 14, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "RadiationReactionForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) __PYX_ERR(4, 15, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(4, 15, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.waveform.waveform", "SEOBNRv5RRForce", sizeof(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) __PYX_ERR(4, 25, __pyx_L1_error)
+  __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(4, 25, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(5, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", "Hamiltonian_v5PHM_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) __PYX_ERR(5, 4, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", "Hamiltonian_v5PHM_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) __PYX_ERR(5, 4, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C)) __PYX_ERR(5, 4, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_0_8(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
+  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_0_10(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
   #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
-  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyTypeObject),
   #elif CYTHON_COMPILING_IN_LIMITED_API
-  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyTypeObject),
   #else
-  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyHeapTypeObject),
+  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyHeapTypeObject),
   #endif
-  __Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(6, 9, __pyx_L1_error)
+  __Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(6, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_5numpy_dtype = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArray_Descr),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 202, __pyx_L1_error)
-  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 225, __pyx_L1_error)
-  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayMultiIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 229, __pyx_L1_error)
-  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
-  __pyx_ptype_5numpy_generic = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 809, __pyx_L1_error)
-  __pyx_ptype_5numpy_number = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 811, __pyx_L1_error)
-  __pyx_ptype_5numpy_integer = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 813, __pyx_L1_error)
-  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 815, __pyx_L1_error)
-  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 817, __pyx_L1_error)
-  __pyx_ptype_5numpy_inexact = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 819, __pyx_L1_error)
-  __pyx_ptype_5numpy_floating = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 821, __pyx_L1_error)
-  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 823, __pyx_L1_error)
-  __pyx_ptype_5numpy_flexible = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 825, __pyx_L1_error)
-  __pyx_ptype_5numpy_character = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 827, __pyx_L1_error)
-  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyUFuncObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 866, __pyx_L1_error)
+  __pyx_ptype_5numpy_dtype = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArray_Descr),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 202, __pyx_L1_error)
+  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 225, __pyx_L1_error)
+  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayMultiIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 229, __pyx_L1_error)
+  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
+  __pyx_ptype_5numpy_generic = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 809, __pyx_L1_error)
+  __pyx_ptype_5numpy_number = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 811, __pyx_L1_error)
+  __pyx_ptype_5numpy_integer = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 813, __pyx_L1_error)
+  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 815, __pyx_L1_error)
+  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 817, __pyx_L1_error)
+  __pyx_ptype_5numpy_inexact = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 819, __pyx_L1_error)
+  __pyx_ptype_5numpy_floating = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 821, __pyx_L1_error)
+  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 823, __pyx_L1_error)
+  __pyx_ptype_5numpy_flexible = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 825, __pyx_L1_error)
+  __pyx_ptype_5numpy_character = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 827, __pyx_L1_error)
+  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyUFuncObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 866, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -22497,15 +22500,15 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_function_import_code", 0);
   /*--- Function import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.waveform.waveform"); if (!__pyx_t_1) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (__Pyx_ImportFunction_3_0_8(__pyx_t_1, "RR_force", (void (**)(void))&__pyx_f_8pyseobnr_3eob_8waveform_8waveform_RR_force, "__pyx_ctuple_double__and_double (__Pyx_memviewslice, __Pyx_memviewslice, double, double, double, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *, int __pyx_skip_dispatch)") < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  if (__Pyx_ImportFunction_3_0_10(__pyx_t_1, "RR_force", (void (**)(void))&__pyx_f_8pyseobnr_3eob_8waveform_8waveform_RR_force, "__pyx_ctuple_double__and_double (__Pyx_memviewslice, __Pyx_memviewslice, double, double, double, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *, int __pyx_skip_dispatch)") < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -23336,89 +23339,67 @@
  *     cdef object __pyx_result
  */
   __pyx_t_7 = PyCFunction_NewEx(&__pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum, NULL, __pyx_n_s_View_MemoryView); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_Enum, __pyx_t_7) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":11
- * from pyseobnr.eob.waveform.waveform cimport RR_force,  RadiationReactionForce
- * from pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C cimport Hamiltonian_v5PHM_C
+  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":8
+ * """
+ * 
  * import numpy as np             # <<<<<<<<<<<<<<
  * cimport numpy as np
- * from pyseobnr.eob.fits.fits_Hamiltonian import dSO as dSO_poly_fit
- */
-  __Pyx_TraceLine(11,0,__PYX_ERR(1, 11, __pyx_L1_error))
-  __pyx_t_7 = __Pyx_ImportDottedModule(__pyx_n_s_numpy, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 11, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_7) < 0) __PYX_ERR(1, 11, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-
-  /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":13
- * import numpy as np
- * cimport numpy as np
- * from pyseobnr.eob.fits.fits_Hamiltonian import dSO as dSO_poly_fit             # <<<<<<<<<<<<<<
- * 
  * 
  */
-  __Pyx_TraceLine(13,0,__PYX_ERR(1, 13, __pyx_L1_error))
-  __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 13, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_INCREF(__pyx_n_s_dSO);
-  __Pyx_GIVEREF(__pyx_n_s_dSO);
-  if (__Pyx_PyList_SET_ITEM(__pyx_t_7, 0, __pyx_n_s_dSO)) __PYX_ERR(1, 13, __pyx_L1_error);
-  __pyx_t_4 = __Pyx_Import(__pyx_n_s_pyseobnr_eob_fits_fits_Hamiltoni, __pyx_t_7, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 13, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_ImportFrom(__pyx_t_4, __pyx_n_s_dSO); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 13, __pyx_L1_error)
+  __Pyx_TraceLine(8,0,__PYX_ERR(1, 8, __pyx_L1_error))
+  __pyx_t_7 = __Pyx_ImportDottedModule(__pyx_n_s_numpy, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_dSO_poly_fit, __pyx_t_7) < 0) __PYX_ERR(1, 13, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_7) < 0) __PYX_ERR(1, 8, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
   /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":16
  * 
  * 
  * DTYPE = np.float64             # <<<<<<<<<<<<<<
  * 
  * # "ctypedef" assigns a corresponding compile-time type to DTYPE_t. For
  */
   __Pyx_TraceLine(16,0,__PYX_ERR(1, 16, __pyx_L1_error))
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 16, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 16, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 16, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_7) < 0) __PYX_ERR(1, 16, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 16, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_4) < 0) __PYX_ERR(1, 16, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
   /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":26
  *     bint npy_isnan(double x)
  * 
- * cpdef get_rhs_prec(double t, double[::1] z, Hamiltonian_v5PHM_C H, RadiationReactionForce RR,             # <<<<<<<<<<<<<<
- *     double m_1, double m_2, EOBParams params):
- *     """
+ * cpdef get_rhs_prec(             # <<<<<<<<<<<<<<
+ *     double t,
+ *     double[::1] z,
  */
   __Pyx_TraceLine(26,0,__PYX_ERR(1, 26, __pyx_L1_error))
 
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_14rhs_precessing_1get_rhs_prec, 0, __pyx_n_s_get_rhs_prec, NULL, __pyx_n_s_pyseobnr_eob_dynamics_rhs_preces_2, __pyx_d, ((PyObject *)__pyx_codeobj__11)); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 26, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_rhs_prec, __pyx_t_7) < 0) __PYX_ERR(1, 26, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8dynamics_14rhs_precessing_1get_rhs_prec, 0, __pyx_n_s_get_rhs_prec, NULL, __pyx_n_s_pyseobnr_eob_dynamics_rhs_preces_2, __pyx_d, ((PyObject *)__pyx_codeobj__11)); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 26, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_rhs_prec, __pyx_t_4) < 0) __PYX_ERR(1, 26, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
   /* "pyseobnr/eob/dynamics/rhs_precessing.pyx":1
- * # cython: language_level=3, boundscheck=False, cdivision=True, profile=True, linetrace=True, initializedcheck=False             # <<<<<<<<<<<<<<
+ * # cython: language_level=3, boundscheck=False, cdivision=True, profile=True             # <<<<<<<<<<<<<<
+ * # cython: linetrace=True, initializedcheck=False
  * """
- * Contains the actual RHS of the EOM, wrapped in cython.
  */
   __Pyx_TraceLine(1,0,__PYX_ERR(1, 1, __pyx_L1_error))
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_7) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_4) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_TraceReturn(Py_None, 0);
 
   /*--- Wrapped vars code ---*/
 
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_4);
@@ -26607,18 +26588,18 @@
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
 }
 #endif
 
 /* TypeImport */
-#ifndef __PYX_HAVE_RT_ImportType_3_0_8
-#define __PYX_HAVE_RT_ImportType_3_0_8
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size)
+#ifndef __PYX_HAVE_RT_ImportType_3_0_10
+#define __PYX_HAVE_RT_ImportType_3_0_10
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject *module, const char *module_name, const char *class_name,
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
     Py_ssize_t itemsize;
 #if CYTHON_COMPILING_IN_LIMITED_API
     PyObject *py_basicsize;
@@ -26664,23 +26645,23 @@
     if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize+itemsize);
         goto bad;
     }
-    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_8 &&
+    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_10 &&
             ((size_t)basicsize > size || (size_t)(basicsize + itemsize) < size)) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd-%zd from PyObject",
             module_name, class_name, size, basicsize, basicsize+itemsize);
         goto bad;
     }
-    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_8 && (size_t)basicsize > size) {
+    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_10 && (size_t)basicsize > size) {
         PyOS_snprintf(warning, sizeof(warning),
             "%s.%s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
     }
     return (PyTypeObject *)result;
@@ -27672,15 +27653,15 @@
         break;
     case 0:
         self = ((PyCFunctionObject*)cyfunc)->m_self;
         break;
     default:
         return NULL;
     }
-    return ((_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
+    return ((__Pyx_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
 }
 static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS_METHOD(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
 {
     __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
     PyMethodDef* def = ((PyCFunctionObject*)cyfunc)->m_ml;
     PyTypeObject *cls = (PyTypeObject *) __Pyx_CyFunction_GetClassObj(cyfunc);
 #if CYTHON_BACKPORT_VECTORCALL
@@ -30881,17 +30862,17 @@
 bad:
     Py_XDECREF(cobj);
     Py_XDECREF(d);
     return -1;
 }
 
 /* FunctionImport */
-  #ifndef __PYX_HAVE_RT_ImportFunction_3_0_8
-#define __PYX_HAVE_RT_ImportFunction_3_0_8
-static int __Pyx_ImportFunction_3_0_8(PyObject *module, const char *funcname, void (**f)(void), const char *sig) {
+  #ifndef __PYX_HAVE_RT_ImportFunction_3_0_10
+#define __PYX_HAVE_RT_ImportFunction_3_0_10
+static int __Pyx_ImportFunction_3_0_10(PyObject *module, const char *funcname, void (**f)(void), const char *sig) {
     PyObject *d = 0;
     PyObject *cobj = 0;
     union {
         void (*fp)(void);
         void *p;
     } tmp;
     d = PyObject_GetAttrString(module, (char *)"__pyx_capi__");
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/dynamics/rhs_precessing.pyx` & `pyseobnr-0.2.9/pyseobnr/eob/dynamics/rhs_precessing.pyx`

 * *Files 6% similar despite different names*

```diff
@@ -1,65 +1,79 @@
-# cython: language_level=3, boundscheck=False, cdivision=True, profile=True, linetrace=True, initializedcheck=False
+# cython: language_level=3, boundscheck=False, cdivision=True, profile=True
+# cython: linetrace=True, initializedcheck=False
 """
-Contains the actual RHS of the EOM, wrapped in cython. 
+Contains the actual RHS of the EOM, wrapped in cython.
 This allows some of the cython functions used in the RHS to be called more efficiently.
 """
 
-cimport cython
-from pyseobnr.eob.utils.containers cimport EOBParams,FluxParams
-from pyseobnr.eob.waveform.waveform cimport RR_force,  RadiationReactionForce
-from pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C cimport Hamiltonian_v5PHM_C
 import numpy as np
 cimport numpy as np
-from pyseobnr.eob.fits.fits_Hamiltonian import dSO as dSO_poly_fit
+
+from pyseobnr.eob.utils.containers cimport EOBParams
+from pyseobnr.eob.waveform.waveform cimport RadiationReactionForce
+from pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C cimport Hamiltonian_v5PHM_C
 
 
 DTYPE = np.float64
 
 # "ctypedef" assigns a corresponding compile-time type to DTYPE_t. For
 # every type in the numpy module there's a corresponding compile-time
 # type with a _t-suffix.
 ctypedef np.float64_t DTYPE_t
 
 cdef extern from "numpy/npy_math.h":
     bint npy_isnan(double x)
 
-cpdef get_rhs_prec(double t, double[::1] z, Hamiltonian_v5PHM_C H, RadiationReactionForce RR,
-    double m_1, double m_2, EOBParams params):
+cpdef get_rhs_prec(
+    double t,
+    double[::1] z,
+    Hamiltonian_v5PHM_C H,
+    RadiationReactionForce RR,
+    double m_1,
+    double m_2,
+    EOBParams params
+):
     """
     Compute the RHS of the EOB evolution equations.
+
     In particular this function returns
-    :math:`\\dot{r}`, :math:`\\dot{\\phi}`, :math:`\\dot{p}_{r}`, :math:`\\dot{p}_{\\phi}`.
+
+    * :math:`\\dot{r}`,
+    * :math:`\\dot{\\phi}`,
+    * :math:`\\dot{p}_{r}`,
+    * :math:`\\dot{p}_{\\phi}`.
     """
     cdef double[::1] q = z[:2]
     cdef double[::1] p = z[2:]
 
     cdef double chi1_LN = params.p_params.chi_1
     cdef double chi2_LN = params.p_params.chi_2
 
     cdef double chi1_L = params.p_params.chi1_L
     cdef double chi2_L = params.p_params.chi2_L
 
-    cdef double H_val,omega,omega_circ,xi
+    cdef double H_val, omega, omega_circ, xi
     cdef double dynamics[6]
-    dynamics[:] = H.dynamics(q,
+    dynamics[:] = H.dynamics(
+        q,
         p,
         params.p_params.chi1_v,
         params.p_params.chi2_v,
         m_1,
         m_2,
         chi1_LN,
         chi2_LN,
         chi1_L,
         chi2_L,)
     H_val = dynamics[4]
     omega = dynamics[3]
     params.dynamics.p_circ[1] = p[1]
 
-    omega_circ = H.omega(q,
+    omega_circ = H.omega(
+        q,
         params.dynamics.p_circ,
         params.p_params.chi1_v,
         params.p_params.chi2_v,
         m_1,
         m_2,
         chi1_LN,
         chi2_LN,
@@ -68,14 +82,14 @@
 
     xi = dynamics[5]
 
     params.p_params.omega_circ = omega_circ
     params.p_params.omega = omega
     params.p_params.H_val = H_val
 
-
-
     cdef (double, double) RR_f = RR.RR(q, p, omega, omega_circ, H_val, params)
 
     cdef double deriv[4]
+
     deriv[:] = [xi * dynamics[2], dynamics[3], -dynamics[0] * xi + RR_f[0], -dynamics[1] + RR_f[1]]
+
     return deriv
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/fits/EOB_fits.py` & `pyseobnr-0.2.9/pyseobnr/eob/fits/EOB_fits.py`

 * *Files 2% similar despite different names*

```diff
@@ -8,20 +8,16 @@
 
 import numpy as np
 import qnm
 from scipy.interpolate import InterpolatedUnivariateSpline
 
 # Pre-cache the QNM interpolants
 modes_qnm = [(2, 2), (2, 1), (3, 3), (3, 2), (4, 4), (4, 3), (5, 5)]
-qnm_cache = {}
-qnm_cache_mm = {}
-for mode in modes_qnm:
-    ell, m = mode
-    qnm_cache[ell, m] = qnm.modes_cache(s=-2, l=ell, m=m, n=0)
-    qnm_cache_mm[ell, m] = qnm.modes_cache(s=-2, l=ell, m=-m, n=0)
+_qnm_cache = {}
+_qnm_cache_mm = {}
 
 
 def compute_QNM(ell: int, m: int, n: int, af: float, Mf: float):
     """Return the complex QNM frequencies by interpolating
     existing solutions.
 
     Note that for negative spins we use
@@ -34,18 +30,24 @@
         af (float): final spin of the BH
         Mf (float): final mass of the BH
 
     Returns:
         np.complex128: The complex QNM frequency.
         The frequencies are such that Re(omega)>0 and Im(omega)<0.
     """
+    global _qnm_cache, _qnm_cache_mm
+
     if af > 0:
-        omega, _, _ = qnm_cache[(ell, m)](a=af, interp_only=True)
+        if (ell, m) not in _qnm_cache:
+            _qnm_cache[(ell, m)] = qnm.modes_cache(s=-2, l=ell, m=m, n=0)
+        omega, _, _ = _qnm_cache[(ell, m)](a=af, interp_only=True)
     else:
-        omega, _, _ = qnm_cache_mm[(ell, m)](a=np.abs(af), interp_only=True)
+        if (ell, m) not in _qnm_cache_mm:
+            _qnm_cache_mm[(ell, m)] = qnm.modes_cache(s=-2, l=ell, m=-m, n=0)
+        omega, _, _ = _qnm_cache_mm[(ell, m)](a=np.abs(af), interp_only=True)
     return omega / Mf
 
 
 def EOBCalculateRDAmplitudeConstraintedCoefficient1(
     c1f: float, c2f: float, sigmaR: float, amp: float, damp: float, eta: float
 ):
     """
@@ -226,15 +228,15 @@
     # Solve the equation Q*coeffs = amps
     res = np.linalg.solve(Q, amps)
 
     coeffs["a1"] = res[0]
     coeffs["a2"] = res[1]
     coeffs["a3"] = res[2]
 
-    # Now we (should) have calculated the a values. 
+    # Now we (should) have calculated the a values.
     # We now compute the frequency NQCs (b1,b2) by solving Eq.(11) of T1100433v2
     # Populate the P matrix in LHS of Eq.(11) of T1100433v2
     intrp_p1 = InterpolatedUnivariateSpline(time[left:right], p1[left:right])
     intrp_p2 = InterpolatedUnivariateSpline(time[left:right], p2[left:right])
     P = np.zeros((2, 2))
 
     P[:, 0] = -intrp_p1.derivatives(nrTimePeak)[1:-1]
@@ -276,15 +278,15 @@
         phi (numpy.ndarray): phase along the dynamics
         pr (numpy.ndarray): pr along the dynamics
         omega (numpy.ndarray): omega along the dynamics
         coeffs (dict): dictionary containing the NQC coefficients
 
     Returns:
         numpy.ndarray: the NQC corrections along the dynamics
-        
+
     """
     sqrtR = np.sqrt(r)
     rOmega = r * omega
     rOmegaSq = rOmega * rOmega
     p = pr
     mag = 1.0 + (p * p / rOmegaSq) * (
         coeffs["a1"]
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/fits/GSF_fits.py` & `pyseobnr-0.2.9/pyseobnr/eob/fits/GSF_fits.py`

 * *Files 17% similar despite different names*

```diff
@@ -1,16 +1,17 @@
 """
 This file contains the coefficients of fits of the amplitude
 to 2nd order self-force results
 """
-from typing import Any,Dict
+from typing import Any, Dict
+
 import numpy as np
 
 
-def GSF_amplitude_fits(nu:float)->Dict[str,Any]:
+def GSF_amplitude_fits(nu: float) -> Dict[str, Any]:
     """Return the GSF fit coefficients to the amplitude.
     Based only on non-spinning data.
     Note that these are multiplied by the symmetric
     mass ratio nu
 
     Args:
         nu (float): Symmetric mass ratio
@@ -84,8 +85,8 @@
         "h32_v10": h32_v10,
         "h32_vlog10": h32_vlog10,
         "h43_v4": h43_v4,
         "h43_v6": h43_v6,
         "h43_v8": h43_v8,
         "h43_vlog8": h43_vlog8,
     }
-    return result_dict
+    return result_dict
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/fits/IV_fits.py` & `pyseobnr-0.2.9/pyseobnr/eob/fits/IV_fits.py`

 * *Files 6% similar despite different names*

```diff
@@ -8,24 +8,27 @@
 class InputValueFits:
     """
     Fits for the so-called waveform input values.
 
     These are the amplitude and its derivatives as well as frequency and its derivative.
     These are used in several places in the model, including NQC construction,
     merger-ringdown attachment and special calibration coefficients in some odd-m modes.
-    This class wraps all necessary fits as methods. Each method returns a dict with keys being the desired mode.
+    This class wraps all necessary fits as methods. Each method returns a dict with keys
+    being the desired mode.
+
     See also Appendix A of the [SEOBNRv5HM-notes]_ .
 
     Args:
         m1 (float): mass of the primary
         m2 (float): mass of the secondary
         chi1 (list): dimensionless spin components of the primary
         chi2 (list): dimensionless spin components of the secondary
 
     """
+
     def __init__(self, m1, m2, chi1, chi2):
         self.m1 = m1
         self.m2 = m2
         self.chi1 = chi1
         self.chi2 = chi2
 
         # Variables used in the fits
@@ -44,34 +47,36 @@
         self.nuprime = 0.25 - self.nu
         self.chi33abs = np.abs(self.chi33)
         self.chi21Aabs = np.abs(self.chi21A)
         self.chi44Aabs = np.abs(self.chi44A)
 
     def hsign(self):
         """
-        Fits for the unsigned waveform amplitude at the attachment point. See Appendix A1 of the [SEOBNRv5HM-notes]_ .
-        This enters in the special calibration coefficients for the (2,1), (5,5) and (4,3) modes and is
-        needed to ensure the correct behaviour for cases with a minium in the amplitude close to the attachment point.
+        Fits for the unsigned waveform amplitude at the attachment point.
+        See Appendix A1 of the [SEOBNRv5HM-notes]_ .
+        This enters in the special calibration coefficients for the (2,1), (5,5) and
+        (4,3) modes and is needed to ensure the correct behaviour for cases with a
+        minimum in the amplitude close to the attachment point.
 
         Returns:
             dict: dictionary of hsign values with keys being the desired mode
         """
         h_modes = {}
         h_modes[2, 2] = (
-            71.97969776036882194603 * self.nu ** 4
-            - 13.35761402231352157344 * self.nu ** 3 * self.chi
-            - 46.87585958426210908101 * self.nu ** 3
-            + 0.61988944517825661507 * self.nu ** 2 * self.chi ** 2
-            + 7.19426416189229733789 * self.nu ** 2 * self.chi
-            + 12.44040490932310127903 * self.nu ** 2
-            + 0.43014673069078152023 * self.nu * self.chi ** 3
+            71.97969776036882194603 * self.nu**4
+            - 13.35761402231352157344 * self.nu**3 * self.chi
+            - 46.87585958426210908101 * self.nu**3
+            + 0.61988944517825661507 * self.nu**2 * self.chi**2
+            + 7.19426416189229733789 * self.nu**2 * self.chi
+            + 12.44040490932310127903 * self.nu**2
+            + 0.43014673069078152023 * self.nu * self.chi**3
             - 1.74313546783413597652 * self.nu * self.chi
             - 0.86828935763242798274 * self.nu
-            - 0.08493901280736430859 * self.chi ** 3
-            - 0.02082621429567295401 * self.chi ** 2
+            - 0.08493901280736430859 * self.chi**3
+            - 0.02082621429567295401 * self.chi**2
             + 0.18693991146784910695 * self.chi
             + 1.46709663479911811557
         )
 
         h33_opt = (
             0.099543396526939,
             -0.46670888251595877,
@@ -87,21 +92,21 @@
         a2 = h33_opt[2]
         a3 = h33_opt[3]
         a4 = h33_opt[4]
         a5 = h33_opt[5]
         a6 = h33_opt[6]
         a7 = h33_opt[7]
         h_modes[3, 3] = (
-            a0 + a1 * self.nu + a2 * self.nu ** 2
+            a0 + a1 * self.nu + a2 * self.nu**2
         ) * self.chi33 + self.dm * (
             a3
             + a4 * self.nu
-            + a5 * self.nu ** 2
-            + a6 * self.chi33 ** 2
-            + a7 * self.nu * self.chi33 ** 2
+            + a5 * self.nu**2
+            + a6 * self.chi33**2
+            + a7 * self.nu * self.chi33**2
         )
         h21_opt = (
             -0.43142624218620174,
             0.18934641483478895,
             -1.0679206708714077,
             -0.012705592101243156,
             0.049896513254659894,
@@ -120,28 +125,28 @@
         a7 = h21_opt[7]
         a8 = h21_opt[8]
         h_modes[2, 1] = -(
             self.dm
             * (
                 a0
                 + a1 * self.nu
-                + a2 * self.nu ** 2
+                + a2 * self.nu**2
                 + a3 * self.chi21A
-                + a4 * self.chi21A ** 2
-                + a5 * self.nu * self.chi21A ** 2
+                + a4 * self.chi21A**2
+                + a5 * self.nu * self.chi21A**2
             )
             + self.chi21A * (a6 + a7 * self.nu)
-            + self.dm * a8 * self.chi21A ** 3
+            + self.dm * a8 * self.chi21A**3
         )
         h_modes[4, 4] = (
-            6.23941816830717765896 * self.nu ** 3
-            - 1.94747289640671739086 * self.nu ** 2
+            6.23941816830717765896 * self.nu**3
+            - 1.94747289640671739086 * self.nu**2
             - 0.18016517494646497322 * self.nu * self.chi44A
             - 0.61530743422322586866 * self.nu
-            + 0.0314831492638571811 * self.chi44A ** 2
+            + 0.0314831492638571811 * self.chi44A**2
             + 0.06393079490813786958 * self.chi44A
             + 0.26253324277501910444
         )
 
         h55_opt = (
             0.12546778737729275,
             -0.46214165382986366,
@@ -157,26 +162,26 @@
         a3 = h55_opt[3]
         a4 = h55_opt[4]
         a5 = h55_opt[5]
         a6 = h55_opt[6]
         h_modes[5, 5] = (
             a0 * self.dm
             + a1 * self.dm * self.nu
-            + a2 * self.dm * self.nu ** 2
+            + a2 * self.dm * self.nu**2
             + a3 * self.chi33
             + a4 * self.chi33 * self.nu
-            + a5 * self.chi33 * self.nu ** 2
-            + a6 * self.chi33 * self.nu ** 3
+            + a5 * self.chi33 * self.nu**2
+            + a6 * self.chi33 * self.nu**3
         )
         h_modes[3, 2] = (
-            8.91777113271361798752 * self.nu ** 3
-            - 2.19450590970282899406 * self.nu ** 2
+            8.91777113271361798752 * self.nu**3
+            - 2.19450590970282899406 * self.nu**2
             + 0.30780289195595494922 * self.nu * self.chi
             - 0.38791140278558522425 * self.nu
-            + 0.02259757283590252061 * self.chi ** 2
+            + 0.02259757283590252061 * self.chi**2
             - 0.02077104373158236705 * self.chi
             + 0.15544608707074264453
         )
 
         h43_opt = (
             -0.02008083115201138,
             0.4365758586949771,
@@ -192,45 +197,45 @@
         a2 = h43_opt[2]
         a3 = h43_opt[3]
         a4 = h43_opt[4]
         a5 = h43_opt[5]
         a6 = h43_opt[6]
         a7 = h43_opt[7]
         h_modes[4, 3] = (
-            a0 + a1 * self.nu + a2 * self.nu ** 2
+            a0 + a1 * self.nu + a2 * self.nu**2
         ) * self.chi33 + self.dm * (
             a3
             + a4 * self.nu
-            + a5 * self.nu ** 2
-            + a6 * self.chi33 ** 2
-            + a7 * self.nu * self.chi33 ** 2
+            + a5 * self.nu**2
+            + a6 * self.chi33**2
+            + a7 * self.nu * self.chi33**2
         )
         return h_modes
 
     def habs(self):
         """
         Fits for the waveform amplitude at the attachment point.
         See Appendix A1 of the [SEOBNRv5HM-notes]_ .
 
         Returns:
             dict: dictionary of habs values with keys being the desired mode
         """
         h_modes = {}
         h_modes[2, 2] = np.abs(
-            71.97969776036882194603 * self.nu ** 4
-            - 13.35761402231352157344 * self.nu ** 3 * self.chi
-            - 46.87585958426210908101 * self.nu ** 3
-            + 0.61988944517825661507 * self.nu ** 2 * self.chi ** 2
-            + 7.19426416189229733789 * self.nu ** 2 * self.chi
-            + 12.44040490932310127903 * self.nu ** 2
-            + 0.43014673069078152023 * self.nu * self.chi ** 3
+            71.97969776036882194603 * self.nu**4
+            - 13.35761402231352157344 * self.nu**3 * self.chi
+            - 46.87585958426210908101 * self.nu**3
+            + 0.61988944517825661507 * self.nu**2 * self.chi**2
+            + 7.19426416189229733789 * self.nu**2 * self.chi
+            + 12.44040490932310127903 * self.nu**2
+            + 0.43014673069078152023 * self.nu * self.chi**3
             - 1.74313546783413597652 * self.nu * self.chi
             - 0.86828935763242798274 * self.nu
-            - 0.08493901280736430859 * self.chi ** 3
-            - 0.02082621429567295401 * self.chi ** 2
+            - 0.08493901280736430859 * self.chi**3
+            - 0.02082621429567295401 * self.chi**2
             + 0.18693991146784910695 * self.chi
             + 1.46709663479911811557
         )
 
         h33_opt = (
             0.099543396526939,
             -0.46670888251595877,
@@ -246,22 +251,22 @@
         a2 = h33_opt[2]
         a3 = h33_opt[3]
         a4 = h33_opt[4]
         a5 = h33_opt[5]
         a6 = h33_opt[6]
         a7 = h33_opt[7]
         h_modes[3, 3] = np.abs(
-            (a0 + a1 * self.nu + a2 * self.nu ** 2) * self.chi33
+            (a0 + a1 * self.nu + a2 * self.nu**2) * self.chi33
             + self.dm
             * (
                 a3
                 + a4 * self.nu
-                + a5 * self.nu ** 2
-                + a6 * self.chi33 ** 2
-                + a7 * self.nu * self.chi33 ** 2
+                + a5 * self.nu**2
+                + a6 * self.chi33**2
+                + a7 * self.nu * self.chi33**2
             )
         )
         h21_opt = (
             -0.43142624218620174,
             0.18934641483478895,
             -1.0679206708714077,
             -0.012705592101243156,
@@ -282,29 +287,29 @@
         a8 = h21_opt[8]
         h_modes[2, 1] = np.abs(
             -(
                 self.dm
                 * (
                     a0
                     + a1 * self.nu
-                    + a2 * self.nu ** 2
+                    + a2 * self.nu**2
                     + a3 * self.chi21A
-                    + a4 * self.chi21A ** 2
-                    + a5 * self.nu * self.chi21A ** 2
+                    + a4 * self.chi21A**2
+                    + a5 * self.nu * self.chi21A**2
                 )
                 + self.chi21A * (a6 + a7 * self.nu)
-                + self.dm * a8 * self.chi21A ** 3
+                + self.dm * a8 * self.chi21A**3
             )
         )
         h_modes[4, 4] = np.abs(
-            6.23941816830717765896 * self.nu ** 3
-            - 1.94747289640671739086 * self.nu ** 2
+            6.23941816830717765896 * self.nu**3
+            - 1.94747289640671739086 * self.nu**2
             - 0.18016517494646497322 * self.nu * self.chi44A
             - 0.61530743422322586866 * self.nu
-            + 0.0314831492638571811 * self.chi44A ** 2
+            + 0.0314831492638571811 * self.chi44A**2
             + 0.06393079490813786958 * self.chi44A
             + 0.26253324277501910444
         )
 
         h55_opt = (
             0.12546778737729275,
             -0.46214165382986366,
@@ -320,26 +325,26 @@
         a3 = h55_opt[3]
         a4 = h55_opt[4]
         a5 = h55_opt[5]
         a6 = h55_opt[6]
         h_modes[5, 5] = np.abs(
             a0 * self.dm
             + a1 * self.dm * self.nu
-            + a2 * self.dm * self.nu ** 2
+            + a2 * self.dm * self.nu**2
             + a3 * self.chi33
             + a4 * self.chi33 * self.nu
-            + a5 * self.chi33 * self.nu ** 2
-            + a6 * self.chi33 * self.nu ** 3
+            + a5 * self.chi33 * self.nu**2
+            + a6 * self.chi33 * self.nu**3
         )
         h_modes[3, 2] = np.abs(
-            8.91777113271361798752 * self.nu ** 3
-            - 2.19450590970282899406 * self.nu ** 2
+            8.91777113271361798752 * self.nu**3
+            - 2.19450590970282899406 * self.nu**2
             + 0.30780289195595494922 * self.nu * self.chi
             - 0.38791140278558522425 * self.nu
-            + 0.02259757283590252061 * self.chi ** 2
+            + 0.02259757283590252061 * self.chi**2
             - 0.02077104373158236705 * self.chi
             + 0.15544608707074264453
         )
 
         h43_opt = (
             -0.02008083115201138,
             0.4365758586949771,
@@ -355,22 +360,22 @@
         a2 = h43_opt[2]
         a3 = h43_opt[3]
         a4 = h43_opt[4]
         a5 = h43_opt[5]
         a6 = h43_opt[6]
         a7 = h43_opt[7]
         h_modes[4, 3] = np.abs(
-            (a0 + a1 * self.nu + a2 * self.nu ** 2) * self.chi33
+            (a0 + a1 * self.nu + a2 * self.nu**2) * self.chi33
             + self.dm
             * (
                 a3
                 + a4 * self.nu
-                + a5 * self.nu ** 2
-                + a6 * self.chi33 ** 2
-                + a7 * self.nu * self.chi33 ** 2
+                + a5 * self.nu**2
+                + a6 * self.chi33**2
+                + a7 * self.nu * self.chi33**2
             )
         )
         return h_modes
 
     def hdot(self):
         """
         Fits for the waveform amplitude first derivative at the attachment point.
@@ -395,19 +400,19 @@
         a2 = h33dot_opt[2]
         a3 = h33dot_opt[3]
         a4 = h33dot_opt[4]
         a5 = h33dot_opt[5]
         a6 = h33dot_opt[6]
         hdot_modes[3, 3] = self.dm * (
             a0 + a1 * self.nu
-        ) * self.chi33 ** 2 + a2 * np.sqrt(
+        ) * self.chi33**2 + a2 * np.sqrt(
             np.abs(
-                self.dm ** 2 * (a3 + a4 * self.nu)
+                self.dm**2 * (a3 + a4 * self.nu)
                 + self.dm * (a5 + a6 * self.nu) * self.chi33
-                + self.chi33 ** 2
+                + self.chi33**2
             )
         )
         h21dot_opt = (
             0.006742551578105149,
             -0.029700111038235357,
             0.008255672129873798,
             0.8154821332503585,
@@ -422,26 +427,26 @@
         a3 = h21dot_opt[3]
         a4 = h21dot_opt[4]
         a5 = h21dot_opt[5]
         a6 = h21dot_opt[6]
         a7 = h21dot_opt[7]
         hdot_modes[2, 1] = (
             self.dm * (a0 + a1 * self.nu)
-            + a2 * abs(-self.dm * (a3 + a4 * self.nu + a5 * self.nu ** 2) + self.chi21D)
+            + a2 * abs(-self.dm * (a3 + a4 * self.nu + a5 * self.nu**2) + self.chi21D)
             + self.dm * (a6 + a7 * self.nu) * self.chi21D
         )
         hdot_modes[4, 4] = (
-            1.1346791592322915676 * self.nu ** 3
-            - 0.03430787888412303172 * self.nu ** 2 * self.chi44D
-            - 0.41705646774353932749 * self.nu ** 2
-            + 0.00638741869700277728 * self.nu * self.chi44D ** 2
+            1.1346791592322915676 * self.nu**3
+            - 0.03430787888412303172 * self.nu**2 * self.chi44D
+            - 0.41705646774353932749 * self.nu**2
+            + 0.00638741869700277728 * self.nu * self.chi44D**2
             + 0.01437277008123238192 * self.nu * self.chi44D
             + 0.02400412959637425805 * self.nu
-            - 0.00125090225166799842 * self.chi44D ** 3
-            - 0.00122253007368038871 * self.chi44D ** 2
+            - 0.00125090225166799842 * self.chi44D**3
+            - 0.00122253007368038871 * self.chi44D**2
             - 0.00068144676521733236 * self.chi44D
             + 0.00349811401956392001
         )
 
         h55dot_opt = (
             0.0025632997344277133,
             -0.01089093602552064,
@@ -461,26 +466,26 @@
         a5 = h55dot_opt[5]
         a6 = h55dot_opt[6]
         a7 = h55dot_opt[7]
         a8 = h55dot_opt[8]
         hdot_modes[5, 5] = (
             self.dm * (a0 + a1 * self.nu)
             + self.dm * (a2 + a3 * self.nu) * self.chi33
-            + self.dm * (a4 + a5 * self.nu) * self.chi33 ** 2
+            + self.dm * (a4 + a5 * self.nu) * self.chi33**2
             + a6 * abs(self.dm * (a7 + a8 * self.nu) + self.chi33)
         )
         hdot_modes[3, 2] = (
-            1.69342278665295764561 * self.nu ** 3
-            - 0.14086998486546850606 * self.nu ** 2 * self.chi
-            - 0.51099927320915217166 * self.nu ** 2
-            - 0.01102715670910366617 * self.nu * self.chi ** 2
+            1.69342278665295764561 * self.nu**3
+            - 0.14086998486546850606 * self.nu**2 * self.chi
+            - 0.51099927320915217166 * self.nu**2
+            - 0.01102715670910366617 * self.nu * self.chi**2
             + 0.0632109995418657783 * self.nu * self.chi
             + 0.02060709840137042725 * self.nu
-            - 0.0008056890294201272 * self.chi ** 3
-            + 0.00299932173169469322 * self.chi ** 2
+            - 0.0008056890294201272 * self.chi**3
+            + 0.00299932173169469322 * self.chi**2
             - 0.00678291732776604723 * self.chi
             + 0.0036736025144228808
         )
 
         h43dot_opt = (
             -0.0010672733086415792,
             0.012043361744214906,
@@ -500,33 +505,33 @@
         a5 = h43dot_opt[5]
         a6 = h43dot_opt[6]
         a7 = h43dot_opt[7]
         a8 = h43dot_opt[8]
         hdot_modes[4, 3] = (
             self.dm * (a0 + a1 * self.nu)
             + self.dm * (a2 + a3 * self.nu) * self.chi33
-            + self.dm * (a4 + a5 * self.nu) * self.chi33 ** 2
+            + self.dm * (a4 + a5 * self.nu) * self.chi33**2
             + a6 * abs(self.dm * (a7 + a8 * self.nu) + self.chi33)
         )
         return hdot_modes
 
     def hdotdot(self):
         """
         Fits for the waveform amplitude second derivative at the attachment point.
         See Appendix A3 of the [SEOBNRv5HM-notes]_ .
 
         Returns:
             dict: dictionary of hdotdot values with keys being the desired mode
         """
         hdotdot_modes = {}
         hdotdot_modes[2, 2] = (
-            -0.00335300225882774906 * self.nu ** 2
+            -0.00335300225882774906 * self.nu**2
             + 0.00358851415965951012 * self.nu * self.chi
             - 0.00561520957901851664 * self.nu
-            + 0.00038615328462788281 * self.chi ** 2
+            + 0.00038615328462788281 * self.chi**2
             + 0.00132564277249644174 * self.chi
             - 0.00245697909115198589
         )
 
         h33dotdot_opt = (
             0.0010293550284251136,
             0.0005517266548686501,
@@ -546,17 +551,17 @@
         a6 = h33dotdot_opt[6]
         a7 = h33dotdot_opt[7]
         hdotdot_modes[3, 3] = self.dm * (a0 + a1 * self.nu) * self.chi33 + a2 * abs(
             self.dm
             * (
                 a3
                 + a4 * self.nu
-                + a5 * self.nu ** 2
-                + a6 * self.nu ** 3
-                + a7 * self.nu ** 4
+                + a5 * self.nu**2
+                + a6 * self.nu**3
+                + a7 * self.nu**4
             )
             + self.chi33
         )
         h21dotdot_opt = (
             0.0001502578588400125,
             2.7742970362330567e-05,
             0.0036425847392171514,
@@ -572,25 +577,25 @@
         a3 = h21dotdot_opt[3]
         a4 = h21dotdot_opt[4]
         a5 = h21dotdot_opt[5]
         a6 = h21dotdot_opt[6]
         a7 = h21dotdot_opt[7]
         hdotdot_modes[2, 1] = a0 * self.dm - abs(
             self.dm * (a1 + a2 * self.nu)
-            + self.dm * (a3 + a4 * self.nu + a5 * self.nu ** 2) * self.chi21D ** 2
-            + a6 * self.chi21D ** 3
+            + self.dm * (a3 + a4 * self.nu + a5 * self.nu**2) * self.chi21D**2
+            + a6 * self.chi21D**3
             + a7 * self.dm * self.chi21D
         )
         hdotdot_modes[4, 4] = (
-            0.13849586076262568324 * self.nu ** 3
-            - 0.0470083172660818796 * self.nu ** 2
-            - 0.00059088846952625525 * self.nu * self.chi ** 2
+            0.13849586076262568324 * self.nu**3
+            - 0.0470083172660818796 * self.nu**2
+            - 0.00059088846952625525 * self.nu * self.chi**2
             - 0.00050107688679214724 * self.nu * self.chi
             + 0.00389948502888598026 * self.nu
-            + 0.00017443998182683801 * self.chi ** 2
+            + 0.00017443998182683801 * self.chi**2
             + 0.00031810951384450125 * self.chi
             - 0.00045065044351543849
         )
 
         h55dotdot_opt = (
             0.0001177890815495443,
             -5.931974803382094e-05,
@@ -604,24 +609,24 @@
         a2 = h55dotdot_opt[2]
         a3 = h55dotdot_opt[3]
         a4 = h55dotdot_opt[4]
         a5 = h55dotdot_opt[5]
         hdotdot_modes[5, 5] = (
             self.dm * (a0 + a1 * self.nu)
             + self.dm * (a2 + a3 * self.nu) * self.chi33
-            + (a4 + a5 * self.nu) * self.chi33 ** 2
+            + (a4 + a5 * self.nu) * self.chi33**2
         )
         hdotdot_modes[3, 2] = (
-            0.20836028051484326018 * self.nu ** 3
-            - 0.02746063216748286309 * self.nu ** 2 * self.chi
-            - 0.05319145260701527156 * self.nu ** 2
-            - 0.00288235478694781307 * self.nu * self.chi ** 2
+            0.20836028051484326018 * self.nu**3
+            - 0.02746063216748286309 * self.nu**2 * self.chi
+            - 0.05319145260701527156 * self.nu**2
+            - 0.00288235478694781307 * self.nu * self.chi**2
             + 0.00848086944391238627 * self.nu * self.chi
             + 0.00160402472655379815 * self.nu
-            + 0.00070714933953842658 * self.chi ** 2
+            + 0.00070714933953842658 * self.chi**2
             - 0.0006905793194749726 * self.chi
             - 5.641060229726973e-5
         )
 
         h43dotdot_opt = (
             -0.00034837066035625267,
             0.0029095133385644,
@@ -641,17 +646,17 @@
         a6 = h43dotdot_opt[6]
         a7 = h43dotdot_opt[7]
         hdotdot_modes[4, 3] = self.dm * (a0 + a1 * self.nu) * self.chi33 + a2 * abs(
             self.dm
             * (
                 a3
                 + a4 * self.nu
-                + a5 * self.nu ** 2
-                + a6 * self.nu ** 3
-                + a7 * self.nu ** 4
+                + a5 * self.nu**2
+                + a6 * self.nu**3
+                + a7 * self.nu**4
             )
             + self.chi33
         )
         return hdotdot_modes
 
     def omega(self):
         """
@@ -659,95 +664,95 @@
         See Appendix A4 of the [SEOBNRv5HM-notes]_ .
 
         Returns:
             dict: dictionary of omega values with keys being the desired mode
         """
         omega_modes = {}
         omega_modes[2, 2] = (
-            5.89352329617707670906 * self.nu ** 4
-            + 3.75145580491965446868 * self.nu ** 3 * self.chi
-            - 3.34930536209472551334 * self.nu ** 3
-            - 0.97140932625194231775 * self.nu ** 2 * self.chi ** 2
-            - 1.69734302394369973577 * self.nu ** 2 * self.chi
-            + 0.28539204856044564362 * self.nu ** 2
-            + 0.2419483723662931296 * self.nu * self.chi ** 3
-            + 0.51801427018052081941 * self.nu * self.chi ** 2
+            5.89352329617707670906 * self.nu**4
+            + 3.75145580491965446868 * self.nu**3 * self.chi
+            - 3.34930536209472551334 * self.nu**3
+            - 0.97140932625194231775 * self.nu**2 * self.chi**2
+            - 1.69734302394369973577 * self.nu**2 * self.chi
+            + 0.28539204856044564362 * self.nu**2
+            + 0.2419483723662931296 * self.nu * self.chi**3
+            + 0.51801427018052081941 * self.nu * self.chi**2
             + 0.25096450064948544467 * self.nu * self.chi
             - 0.31709602351033533418 * self.nu
-            - 0.01525897668158244028 * self.chi ** 4
-            - 0.06692658483513916345 * self.chi ** 3
-            - 0.08715176045684569495 * self.chi ** 2
+            - 0.01525897668158244028 * self.chi**4
+            - 0.06692658483513916345 * self.chi**3
+            - 0.08715176045684569495 * self.chi**2
             - 0.09133931944098934441 * self.chi
             - 0.2685414392185025978
         )
         omega_modes[3, 3] = (
-            8.88716288087403682994 * self.nu ** 3
-            - 0.74592378229749944918 * self.nu ** 2 * self.chi
-            - 4.22683134159469808822 * self.nu ** 2
-            + 0.34667482329409210484 * self.nu * self.chi ** 2
+            8.88716288087403682994 * self.nu**3
+            - 0.74592378229749944918 * self.nu**2 * self.chi
+            - 4.22683134159469808822 * self.nu**2
+            + 0.34667482329409210484 * self.nu * self.chi**2
             + 0.4789145868044565324 * self.nu * self.chi
-            - 0.04514088822512542926 * self.chi ** 3
-            - 0.11941861972305316264 * self.chi ** 2
+            - 0.04514088822512542926 * self.chi**3
+            - 0.11941861972305316264 * self.chi**2
             - 0.17467027880037502841 * self.chi
             - 0.42716659841853366064
         )
         omega_modes[2, 1] = (
-            -1.96515745599907942776 * self.nu ** 3
-            - 0.16885361554827885144 * self.nu ** 2 * self.chi
-            + 0.53085041746959926723 * self.nu ** 2
-            + 0.07734281111269736275 * self.nu * self.chi ** 2
+            -1.96515745599907942776 * self.nu**3
+            - 0.16885361554827885144 * self.nu**2 * self.chi
+            + 0.53085041746959926723 * self.nu**2
+            + 0.07734281111269736275 * self.nu * self.chi**2
             + 0.15938183067714695174 * self.nu * self.chi
             - 0.2379037879767669228 * self.nu
-            - 0.01009016749505482584 * self.chi ** 3
-            - 0.02410957086017969861 * self.chi ** 2
+            - 0.01009016749505482584 * self.chi**3
+            - 0.02410957086017969861 * self.chi**2
             - 0.04763491663090872047 * self.chi
             - 0.17652608750683201899
         )
         omega_modes[4, 4] = (
-            13.65133489176671410803 * self.nu ** 3
-            - 0.76871184038256423765 * self.nu ** 2 * self.chi
-            - 5.49032933904132924852 * self.nu ** 2
-            + 0.4158639192986712807 * self.nu * self.chi ** 2
+            13.65133489176671410803 * self.nu**3
+            - 0.76871184038256423765 * self.nu**2 * self.chi
+            - 5.49032933904132924852 * self.nu**2
+            + 0.4158639192986712807 * self.nu * self.chi**2
             + 0.5925675710398274898 * self.nu * self.chi
-            - 0.04252924146785119763 * self.chi ** 3
-            - 0.1552216774031633939 * self.chi ** 2
+            - 0.04252924146785119763 * self.chi**3
+            - 0.1552216774031633939 * self.chi**2
             - 0.24450814728556427569 * self.chi
             - 0.57404100593064200098
         )
         omega_modes[5, 5] = (
-            13.81386002062406426205 * self.nu ** 3
-            - 3.0457597325553762424 * self.nu ** 2 * self.chi
-            - 6.61611019771898423159 * self.nu ** 2
-            + 0.80275927256688528466 * self.nu * self.chi ** 2
+            13.81386002062406426205 * self.nu**3
+            - 3.0457597325553762424 * self.nu**2 * self.chi
+            - 6.61611019771898423159 * self.nu**2
+            + 0.80275927256688528466 * self.nu * self.chi**2
             + 1.43470995594104122617 * self.nu * self.chi
             + 0.47247403131411785937 * self.nu
-            - 0.09162925213075370778 * self.chi ** 3
-            - 0.24664558041625297968 * self.chi ** 2
+            - 0.09162925213075370778 * self.chi**3
+            - 0.24664558041625297968 * self.chi**2
             - 0.32959068465244367729 * self.chi
             - 0.58934113264394660803
         )
         omega_modes[3, 2] = (
-            -2.34602394381327350459 * self.nu ** 3
-            - 2.75863454206899216814 * self.nu ** 2 * self.chi
-            + 1.57985993022275095221 * self.nu ** 2
+            -2.34602394381327350459 * self.nu**3
+            - 2.75863454206899216814 * self.nu**2 * self.chi
+            + 1.57985993022275095221 * self.nu**2
             + 0.81135314747739029073 * self.nu * self.chi
             - 0.31775591479035469877 * self.nu
-            - 0.04564745621234577583 * self.chi ** 2
+            - 0.04564745621234577583 * self.chi**2
             - 0.11247674297883318573 * self.chi
             - 0.33114128825887062524
         )
         omega_modes[4, 3] = (
-            -55.53410548228862353426 * self.nu ** 3
-            - 0.90591912935891649727 * self.nu ** 2 * self.chi
-            + 23.91327719774037419143 * self.nu ** 2
-            + 0.22690304977596567615 * self.nu * self.chi ** 2
+            -55.53410548228862353426 * self.nu**3
+            - 0.90591912935891649727 * self.nu**2 * self.chi
+            + 23.91327719774037419143 * self.nu**2
+            + 0.22690304977596567615 * self.nu * self.chi**2
             + 0.29109174621004529904 * self.nu * self.chi
             - 3.48798589848595197438 * self.nu
-            - 0.0379192517897683698 * self.chi ** 3
-            - 0.0872880306983466886 * self.chi ** 2
+            - 0.0379192517897683698 * self.chi**3
+            - 0.0872880306983466886 * self.chi**2
             - 0.11979971300165934145 * self.chi
             - 0.3430602590276149999
         )
         return omega_modes
 
     def omegadot(self):
         """
@@ -755,90 +760,90 @@
         See Appendix A4 of the [SEOBNRv5HM-notes]_ .
 
         Returns:
             dict: dictionary of omegadot values with keys being the desired mode
         """
         omegadot_modes = {}
         omegadot_modes[2, 2] = (
-            -0.23712612963269574795 * self.nu ** 3
-            + 0.07799016321986182443 * self.nu ** 2 * self.chi
-            + 0.09221479145462828375 * self.nu ** 2
-            - 0.00839285104015016943 * self.nu * self.chi ** 2
+            -0.23712612963269574795 * self.nu**3
+            + 0.07799016321986182443 * self.nu**2 * self.chi
+            + 0.09221479145462828375 * self.nu**2
+            - 0.00839285104015016943 * self.nu * self.chi**2
             - 0.02877175649350346628 * self.nu * self.chi
             - 0.03103970973029888253 * self.nu
-            + 0.00061394267373741083 * self.chi ** 3
-            + 0.0019481328417233967 * self.chi ** 2
+            + 0.00061394267373741083 * self.chi**3
+            + 0.0019481328417233967 * self.chi**2
             + 0.0017051416772119448 * self.chi
             - 0.0054839528158373476
         )
         omegadot_modes[3, 3] = (
-            0.2554015440024767214 * self.nu ** 3
-            + 0.1543776301642514337 * self.nu ** 2 * self.chi
-            - 0.0866295463333640603 * self.nu ** 2
-            - 0.01623076677816887373 * self.nu * self.chi ** 2
+            0.2554015440024767214 * self.nu**3
+            + 0.1543776301642514337 * self.nu**2 * self.chi
+            - 0.0866295463333640603 * self.nu**2
+            - 0.01623076677816887373 * self.nu * self.chi**2
             - 0.05061758919542676954 * self.nu * self.chi
             - 0.02740501185261355263 * self.nu
-            + 0.00169663712021324796 * self.chi ** 3
-            + 0.00398506811959840803 * self.chi ** 2
+            + 0.00169663712021324796 * self.chi**3
+            + 0.00398506811959840803 * self.chi**2
             + 0.00272137645449461703 * self.chi
             - 0.00973636029227470737
         )
         omegadot_modes[2, 1] = (
-            -0.20436806016561828714 * self.nu ** 3
-            + 0.03383058374774079724 * self.nu ** 2 * self.chi
-            + 0.12070472224065939559 * self.nu ** 2
-            - 0.00896529609487783756 * self.nu * self.chi ** 2
+            -0.20436806016561828714 * self.nu**3
+            + 0.03383058374774079724 * self.nu**2 * self.chi
+            + 0.12070472224065939559 * self.nu**2
+            - 0.00896529609487783756 * self.nu * self.chi**2
             - 0.00575216782379691424 * self.nu * self.chi
             - 0.03514372134290563721 * self.nu
-            + 0.0014901043978378613 * self.chi ** 3
-            + 0.00273944957648775004 * self.chi ** 2
+            + 0.0014901043978378613 * self.chi**3
+            + 0.00273944957648775004 * self.chi**2
             + 0.00200277469830409133 * self.chi
             - 0.00657904072987968228
         )
         omegadot_modes[4, 4] = (
-            0.53666427603875110908 * self.nu ** 3
-            + 0.16269258337509870382 * self.nu ** 2 * self.chi
-            - 0.09479659696815241621 * self.nu ** 2
-            - 0.02468745449256098956 * self.nu * self.chi ** 2
+            0.53666427603875110908 * self.nu**3
+            + 0.16269258337509870382 * self.nu**2 * self.chi
+            - 0.09479659696815241621 * self.nu**2
+            - 0.02468745449256098956 * self.nu * self.chi**2
             - 0.06120499833132028722 * self.nu * self.chi
             - 0.04540599000644451183 * self.nu
-            + 0.00181212931541878787 * self.chi ** 3
-            + 0.00568015431535457815 * self.chi ** 2
+            + 0.00181212931541878787 * self.chi**3
+            + 0.00568015431535457815 * self.chi**2
             + 0.00362281246962605202 * self.chi
             - 0.01303752234990177353
         )
         omegadot_modes[5, 5] = (
-            0.04396263632039092845 * self.nu ** 3
-            + 0.16401057342208869017 * self.nu ** 2 * self.chi
-            + 0.0480445690111714549 * self.nu ** 2
-            - 0.01547038929169576409 * self.nu * self.chi ** 2
+            0.04396263632039092845 * self.nu**3
+            + 0.16401057342208869017 * self.nu**2 * self.chi
+            + 0.0480445690111714549 * self.nu**2
+            - 0.01547038929169576409 * self.nu * self.chi**2
             - 0.05651624188739841348 * self.nu * self.chi
             - 0.04519696852035513107 * self.nu
-            + 0.00150884009977045211 * self.chi ** 3
-            + 0.00280221939154576445 * self.chi ** 2
+            + 0.00150884009977045211 * self.chi**3
+            + 0.00280221939154576445 * self.chi**2
             + 0.00207193006850621116 * self.chi
             - 0.00868773813796784242
         )
         omegadot_modes[3, 2] = (
-            -2.49478784743875880991 * self.nu ** 3
-            + 0.09192003793052351546 * self.nu ** 2 * self.chi
-            + 0.99511595542597619524 * self.nu ** 2
-            - 0.03671064886430309981 * self.nu * self.chi ** 2
+            -2.49478784743875880991 * self.nu**3
+            + 0.09192003793052351546 * self.nu**2 * self.chi
+            + 0.99511595542597619524 * self.nu**2
+            - 0.03671064886430309981 * self.nu * self.chi**2
             - 0.03071335466752724355 * self.nu * self.chi
             - 0.10162991709458844836 * self.nu
-            + 0.00553205070234718318 * self.chi ** 2
+            + 0.00553205070234718318 * self.chi**2
             + 0.0059265967880560216 * self.chi
             - 0.0107628728873452352
         )
         omegadot_modes[4, 3] = (
-            -5.16061307106004907297 * self.nu ** 3
-            + 0.1329597836037081926 * self.nu ** 2 * self.chi
-            + 2.18078055419966032602 * self.nu ** 2
-            - 0.00987590957480824309 * self.nu * self.chi ** 2
+            -5.16061307106004907297 * self.nu**3
+            + 0.1329597836037081926 * self.nu**2 * self.chi
+            + 2.18078055419966032602 * self.nu**2
+            - 0.00987590957480824309 * self.nu * self.chi**2
             - 0.06088357656881192986 * self.nu * self.chi
             - 0.29260675353893633721 * self.nu
-            + 0.00053653086065616224 * self.chi ** 3
-            + 0.00327866342069590847 * self.chi ** 2
+            + 0.00053653086065616224 * self.chi**3
+            + 0.00327866342069590847 * self.chi**2
             + 0.00851322039320196768 * self.chi
             - 0.00530816071704910165
         )
         return omegadot_modes
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/fits/fits_Hamiltonian.py` & `pyseobnr-0.2.9/pyseobnr/eob/fits/fits_Hamiltonian.py`

 * *Files 27% similar despite different names*

```diff
@@ -32,16 +32,54 @@
 #
 # [feature_map]
 # x0 = "nu"
 # x1 = "ap"
 # x2 = "am"
 #
 # [feature_array]
-# dSO = [ "1", "x0", "x0*x0", "x0*x0*x0", "x0*x0*x1", "x0*x0*x2", "x0*x1", "x0*x1*x1", "x0*x1*x2", "x0*x2", "x0*x2*x2", "x1", "x1*x1", "x1*x1*x1", "x1*x1*x2", "x1*x2", "x1*x2*x2", "x2", "x2*x2", "x2*x2*x2",]
-# NR_deltaT = [ "x0*x0*x1", "x0*x0*x2", "x0*x1", "x0*x1*x1", "x0*x1*x2", "x0*x2", "x0*x2*x2", "x1", "x1*x1", "x1*x1*x1", "x1*x1*x2", "x1*x2", "x1*x2*x2", "x2", "x2*x2", "x1*x1*x1*x1",]
+# dSO = [
+#     "1",
+#     "x0",
+#     "x0*x0",
+#     "x0*x0*x0",
+#     "x0*x0*x1",
+#     "x0*x0*x2",
+#     "x0*x1",
+#     "x0*x1*x1",
+#     "x0*x1*x2",
+#     "x0*x2",
+#     "x0*x2*x2",
+#     "x1",
+#     "x1*x1",
+#     "x1*x1*x1",
+#     "x1*x1*x2",
+#     "x1*x2",
+#     "x1*x2*x2",
+#     "x2",
+#     "x2*x2",
+#     "x2*x2*x2",
+# ]
+# NR_deltaT = [
+#     "x0*x0*x1",
+#     "x0*x0*x2",
+#     "x0*x1",
+#     "x0*x1*x1",
+#     "x0*x1*x2",
+#     "x0*x2",
+#     "x0*x2*x2",
+#     "x1",
+#     "x1*x1",
+#     "x1*x1*x1",
+#     "x1*x1*x2",
+#     "x1*x2",
+#     "x1*x2*x2",
+#     "x2",
+#     "x2*x2",
+#     "x1*x1*x1*x1",
+# ]
 #
 # [extra_physical_info]
 # TPL = false
 # additional_terms = "spinning_TPL_info"
 # additional_terms_weight = 25.0
 
 
@@ -62,32 +100,32 @@
         am (float): antisymmetric spin combination ap = m1*chi1 - m2*chi2.
 
     Returns:
         float: The value of dSO.
 
     """
     return (
-        -7.71251231383957 * am ** 3
-        - 17.2294679794015 * am ** 2 * ap
-        - 238.430383378296 * am ** 2 * nu
-        + 69.5461667822545 * am ** 2
-        - 10.5225438990315 * am * ap ** 2
+        -7.71251231383957 * am**3
+        - 17.2294679794015 * am**2 * ap
+        - 238.430383378296 * am**2 * nu
+        + 69.5461667822545 * am**2
+        - 10.5225438990315 * am * ap**2
         + 362.767393298729 * am * ap * nu
         - 85.8036338010274 * am * ap
-        - 1254.66845939312 * am * nu ** 2
+        - 1254.66845939312 * am * nu**2
         + 472.431937787377 * am * nu
         - 39.742317057316 * am
-        - 7.58458103577458 * ap ** 3
-        - 42.7601129678844 * ap ** 2 * nu
-        + 18.1783435552183 * ap ** 2
-        - 201.905934468847 * ap * nu ** 2
+        - 7.58458103577458 * ap**3
+        - 42.7601129678844 * ap**2 * nu
+        + 18.1783435552183 * ap**2
+        - 201.905934468847 * ap * nu**2
         - 90.5790079104259 * ap * nu
         + 49.6299175121658 * ap
-        + 478.546231305475 * nu ** 3
-        + 679.521769948995 * nu ** 2
+        + 478.546231305475 * nu**3
+        + 679.521769948995 * nu**2
         - 177.334831768076 * nu
         - 37.6897780220529
     )
 
 
 @jit(nopython=True)
 def NR_deltaT(nu, ap, am):
@@ -103,28 +141,28 @@
         ap (float): symmetric spin combination ap = m1*chi1 + m2*chi2.
         am (float): antisymmetric spin combination ap = m1*chi1 - m2*chi2.
 
     Returns:
         float: The value of NR_deltaT.
     """
     return nu ** (-1.0 / 5 + 0 * nu) * (
-        8.39238879807543 * am ** 2 * ap
-        - 16.9056858928167 * am ** 2 * nu
-        + 7.23410583477034 * am ** 2
-        + 6.38975598319936 * am * ap ** 2
+        8.39238879807543 * am**2 * ap
+        - 16.9056858928167 * am**2 * nu
+        + 7.23410583477034 * am**2
+        + 6.38975598319936 * am * ap**2
         + 179.569824846781 * am * ap * nu
         - 40.6063653476775 * am * ap
-        + 144.253395844761 * am * nu ** 2
+        + 144.253395844761 * am * nu**2
         - 90.1929138487509 * am * nu
         + 14.2203101910927 * am
-        - 6.78913884987037 * ap ** 4
-        + 5.39962303470497 * ap ** 3
-        - 132.224950777226 * ap ** 2 * nu
-        + 49.8016443361381 * ap ** 2
-        + 384.201018794943 * ap * nu ** 2
+        - 6.78913884987037 * ap**4
+        + 5.39962303470497 * ap**3
+        - 132.224950777226 * ap**2 * nu
+        + 49.8016443361381 * ap**2
+        + 384.201018794943 * ap * nu**2
         - 141.253181790353 * ap * nu
         + 17.5710132409988 * ap
     )
 
 
 """
 Non-spinning functions obtained by a least-square fit of the maxL of the calibration posteriors
@@ -143,15 +181,15 @@
 
     Returns:
         float: The value of a6.
     """
     par = np.array(
         [4.17877875e01, -3.02193382e03, 3.34144394e04, -1.69019140e05, 3.29523262e05]
     )
-    return par[0] + par[1] * nu + par[2] * nu ** 2 + par[3] * nu ** 3 + par[4] * nu ** 4
+    return par[0] + par[1] * nu + par[2] * nu**2 + par[3] * nu**3 + par[4] * nu**4
 
 
 @jit(nopython=True)
 def NR_deltaT_NS(nu):
     """
     Fit for the time difference from reference point to the attachment time, no spin part.
 
@@ -165,9 +203,9 @@
     Returns:
         float: The non-spinning value of NR_deltaT.
     """
     par = np.array(
         [1.00513217e01, -5.96231800e01, -1.05687385e03, -9.79317619e03, 5.55652392e04]
     )
     return nu ** (-1.0 / 5 + par[0] * nu) * (
-        par[1] + par[2] * nu + par[3] * nu ** 2 + par[4] * nu ** 3
+        par[1] + par[2] * nu + par[3] * nu**2 + par[4] * nu**3
     )
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.c` & `pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.c`

 * *Files 1% similar despite different names*

```diff
@@ -1,26 +1,26 @@
-/* Generated by Cython 3.0.8 */
+/* Generated by Cython 3.0.10 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ufuncobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include",
             "pyseobnr/eob/hamiltonian"
         ],
         "name": "pyseobnr.eob.hamiltonian.Ham_AvgS2precess_simple_cython_PA_AD",
         "sources": [
             "pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.pyx"
         ]
     },
@@ -48,18 +48,18 @@
     #error Cython requires Python 2.7+ or Python 3.3+.
 #else
 #if defined(CYTHON_LIMITED_API) && CYTHON_LIMITED_API
 #define __PYX_EXTRA_ABI_MODULE_NAME "limited"
 #else
 #define __PYX_EXTRA_ABI_MODULE_NAME ""
 #endif
-#define CYTHON_ABI "3_0_8" __PYX_EXTRA_ABI_MODULE_NAME
+#define CYTHON_ABI "3_0_10" __PYX_EXTRA_ABI_MODULE_NAME
 #define __PYX_ABI_MODULE_NAME "_cython_" CYTHON_ABI
 #define __PYX_TYPE_MODULE_PREFIX __PYX_ABI_MODULE_NAME "."
-#define CYTHON_HEX_VERSION 0x030008F0
+#define CYTHON_HEX_VERSION 0x03000AF0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(_WIN32) && !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -143,14 +143,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(PYPY_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #undef CYTHON_USE_TYPE_SLOTS
@@ -204,14 +206,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(CYTHON_LIMITED_API)
   #ifdef Py_LIMITED_API
     #undef __PYX_LIMITED_VERSION_HEX
     #define __PYX_LIMITED_VERSION_HEX Py_LIMITED_API
   #endif
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
@@ -265,60 +269,83 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(Py_GIL_DISABLED) || defined(Py_NOGIL)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_TYPE_SPECS
+    #define CYTHON_USE_TYPE_SPECS 0
+  #endif
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #ifndef CYTHON_USE_ASYNC_SLOTS
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_PYLONG_INTERNALS
+    #define CYTHON_USE_PYLONG_INTERNALS 0
+  #endif
   #undef CYTHON_USE_PYLIST_INTERNALS
   #define CYTHON_USE_PYLIST_INTERNALS 0
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
   #undef CYTHON_USE_UNICODE_WRITER
   #define CYTHON_USE_UNICODE_WRITER 0
-  #undef CYTHON_USE_PYLONG_INTERNALS
-  #define CYTHON_USE_PYLONG_INTERNALS 0
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
   #undef CYTHON_FAST_THREAD_STATE
   #define CYTHON_FAST_THREAD_STATE 0
+  #undef CYTHON_FAST_GIL
+  #define CYTHON_FAST_GIL 0
+  #ifndef CYTHON_METH_FASTCALL
+    #define CYTHON_METH_FASTCALL 1
+  #endif
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
+  #ifndef CYTHON_PEP487_INIT_SUBCLASS
+    #define CYTHON_PEP487_INIT_SUBCLASS 1
+  #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT 1
   #endif
+  #ifndef CYTHON_USE_MODULE_STATE
+    #define CYTHON_USE_MODULE_STATE 0
+  #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE 1
   #endif
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
@@ -401,14 +428,17 @@
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK 1
   #endif
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
   #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if !defined(CYTHON_VECTORCALL)
 #define CYTHON_VECTORCALL  (CYTHON_FAST_PYCCALL && PY_VERSION_HEX >= 0x030800B1)
 #endif
@@ -744,16 +774,21 @@
   #ifndef METH_FASTCALL
      #define METH_FASTCALL 0x80
   #endif
   typedef PyObject *(*__Pyx_PyCFunctionFast) (PyObject *self, PyObject *const *args, Py_ssize_t nargs);
   typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords) (PyObject *self, PyObject *const *args,
                                                           Py_ssize_t nargs, PyObject *kwnames);
 #else
-  #define __Pyx_PyCFunctionFast _PyCFunctionFast
-  #define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #if PY_VERSION_HEX >= 0x030d00A4
+  #  define __Pyx_PyCFunctionFast PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords PyCFunctionFastWithKeywords
+  #else
+  #  define __Pyx_PyCFunctionFast _PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #endif
 #endif
 #if CYTHON_METH_FASTCALL
   #define __Pyx_METH_FASTCALL METH_FASTCALL
   #define __Pyx_PyCFunction_FastCall __Pyx_PyCFunctionFast
   #define __Pyx_PyCFunction_FastCallWithKeywords __Pyx_PyCFunctionFastWithKeywords
 #else
   #define __Pyx_METH_FASTCALL METH_VARARGS
@@ -1097,15 +1132,15 @@
   #define __Pyx_PyList_SET_ITEM(o, i, v) PyList_SetItem(o, i, v)
   #define __Pyx_PyTuple_GET_SIZE(o) PyTuple_Size(o)
   #define __Pyx_PyList_GET_SIZE(o) PyList_Size(o)
   #define __Pyx_PySet_GET_SIZE(o) PySet_Size(o)
   #define __Pyx_PyBytes_GET_SIZE(o) PyBytes_Size(o)
   #define __Pyx_PyByteArray_GET_SIZE(o) PyByteArray_Size(o)
 #endif
-#if PY_VERSION_HEX >= 0x030d00A1
+#if __PYX_LIMITED_VERSION_HEX >= 0x030d00A1
   #define __Pyx_PyImport_AddModuleRef(name) PyImport_AddModuleRef(name)
 #else
   static CYTHON_INLINE PyObject *__Pyx_PyImport_AddModuleRef(const char *name) {
       PyObject *module = PyImport_AddModule(name);
       Py_XINCREF(module);
       return module;
   }
@@ -1184,15 +1219,15 @@
 #if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
 #define __Pyx_truncl trunc
 #else
 #define __Pyx_truncl truncl
 #endif
 
 #define __PYX_MARK_ERR_POS(f_index, lineno) \
-    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__; (void)__pyx_clineno; }
+    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__;  (void)__pyx_clineno; }
 #define __PYX_ERR(f_index, lineno, Ln_error) \
     { __PYX_MARK_ERR_POS(f_index, lineno) goto Ln_error; }
 
 #ifdef CYTHON_EXTERN_C
     #undef __PYX_EXTERN_C
     #define __PYX_EXTERN_C CYTHON_EXTERN_C
 #elif defined(__PYX_EXTERN_C)
@@ -1301,32 +1336,15 @@
 #define __Pyx_PyObject_AsSString(s)    ((const signed char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_AsUString(s)    ((const unsigned char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
 #define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
 #define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
 #define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
 #define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
-#if CYTHON_COMPILING_IN_LIMITED_API
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const wchar_t *u)
-{
-    const wchar_t *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#else
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
-{
-    const Py_UNICODE *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#endif
 #define __Pyx_PyUnicode_FromOrdinal(o)       PyUnicode_FromOrdinal((int)o)
-#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
-#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
 #define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
 #define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
 #define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
 static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
@@ -1659,177 +1677,177 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1869,42 +1887,42 @@
 struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
 struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD;
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -3075,30 +3093,30 @@
 #if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
 static PyObject* __Pyx_PyObject_GenericGetAttr(PyObject* obj, PyObject* attr_name);
 #else
 #define __Pyx_PyObject_GenericGetAttr PyObject_GenericGetAttr
 #endif
 
 /* TypeImport.proto */
-#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_8
-#define __PYX_HAVE_RT_ImportType_proto_3_0_8
+#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_10
+#define __PYX_HAVE_RT_ImportType_proto_3_0_10
 #if defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L
 #include <stdalign.h>
 #endif
 #if (defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L) || __cplusplus >= 201103L
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) alignof(s)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) alignof(s)
 #else
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) sizeof(void*)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) sizeof(void*)
 #endif
-enum __Pyx_ImportType_CheckSize_3_0_8 {
-   __Pyx_ImportType_CheckSize_Error_3_0_8 = 0,
-   __Pyx_ImportType_CheckSize_Warn_3_0_8 = 1,
-   __Pyx_ImportType_CheckSize_Ignore_3_0_8 = 2
+enum __Pyx_ImportType_CheckSize_3_0_10 {
+   __Pyx_ImportType_CheckSize_Error_3_0_10 = 0,
+   __Pyx_ImportType_CheckSize_Warn_3_0_10 = 1,
+   __Pyx_ImportType_CheckSize_Ignore_3_0_10 = 2
 };
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size);
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size);
 #endif
 
 /* GetVTable.proto */
 static void* __Pyx_GetVtable(PyTypeObject *type);
 
 /* IncludeStructmemberH.proto */
 #include <structmember.h>
@@ -18564,261 +18582,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18827,29 +18845,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18860,15 +18878,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -18877,29 +18895,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -18910,15 +18928,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -18927,29 +18945,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -18960,15 +18978,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -18977,29 +18995,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19010,15 +19028,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19027,29 +19045,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19060,217 +19078,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":969
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":970
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":970
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 970, __pyx_L1_error)
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":973
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":975
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":975
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":976
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":976
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19286,15 +19304,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -19302,68 +19320,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":982
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":982
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 982, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":983
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":983
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 984, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 984, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19371,15 +19389,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19394,15 +19412,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19418,15 +19436,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19434,68 +19452,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":988
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":988
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 988, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":989
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":989
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 990, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 990, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19503,15 +19521,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19526,15 +19544,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19550,15 +19568,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19566,68 +19584,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":994
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":994
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 994, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":995
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":995
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":996
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":996
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 996, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 996, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19635,15 +19653,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19658,170 +19676,170 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1011
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1011
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1026
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1026
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1036
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1036
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1043
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1043
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1050
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1050
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -43422,15 +43440,19 @@
     if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD) {
       if (PyObject_CallFinalizerFromDealloc(o)) return;
     }
   }
   #endif
   PyObject_GC_UnTrack(o);
   Py_CLEAR(p->calibration_coeffs);
-  PyObject_GC_Track(o);
+  #if PY_MAJOR_VERSION < 3
+  if (!(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) || PyType_IS_GC(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C)) PyObject_GC_Track(o);
+  #else
+  if (PyType_IS_GC(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C)) PyObject_GC_Track(o);
+  #endif
   if (likely(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C)) __Pyx_PyType_GetSlot(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C, tp_dealloc, destructor)(o); else __Pyx_call_next_tp_dealloc(o, __pyx_tp_dealloc_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD);
 }
 
 static int __pyx_tp_traverse_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD(PyObject *o, visitproc v, void *a) {
   int e;
   struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD *p = (struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD *)o;
   e = ((likely(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C)) ? ((__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C->tp_traverse) ? __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C->tp_traverse(o, v, a) : 0) : __Pyx_call_next_tp_traverse(o, v, a, __pyx_tp_traverse_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD)); if (e) return e;
@@ -44751,26 +44773,26 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 984, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 990, __pyx_L1_error)
@@ -45066,15 +45088,15 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", "Hamiltonian_v5PHM_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C", "Hamiltonian_v5PHM_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C)) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD = &__pyx_vtable_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD.__pyx_base = *__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD.__pyx_base._call = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_36Ham_AvgS2precess_simple_cython_PA_AD__call;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD.__pyx_base.grad = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_36Ham_AvgS2precess_simple_cython_PA_AD_grad;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD.__pyx_base.hessian = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_36Ham_AvgS2precess_simple_cython_PA_AD_hessian;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_Ham_AvgS2precess_simple_cython_PA_AD.__pyx_base.dynamics = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_19Hamiltonian_v5PHM_C_Hamiltonian_v5PHM_C *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_36Ham_AvgS2precess_simple_cython_PA_AD_36Ham_AvgS2precess_simple_cython_PA_AD_dynamics;
@@ -45269,50 +45291,50 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_0_8(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
+  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_0_10(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
   #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
-  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyTypeObject),
   #elif CYTHON_COMPILING_IN_LIMITED_API
-  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyTypeObject),
   #else
-  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyHeapTypeObject),
+  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyHeapTypeObject),
   #endif
-  __Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(3, 9, __pyx_L1_error)
+  __Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(3, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_5numpy_dtype = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArray_Descr),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 202, __pyx_L1_error)
-  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 225, __pyx_L1_error)
-  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayMultiIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 229, __pyx_L1_error)
-  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
-  __pyx_ptype_5numpy_generic = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 809, __pyx_L1_error)
-  __pyx_ptype_5numpy_number = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 811, __pyx_L1_error)
-  __pyx_ptype_5numpy_integer = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 813, __pyx_L1_error)
-  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 815, __pyx_L1_error)
-  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 817, __pyx_L1_error)
-  __pyx_ptype_5numpy_inexact = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 819, __pyx_L1_error)
-  __pyx_ptype_5numpy_floating = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 821, __pyx_L1_error)
-  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 823, __pyx_L1_error)
-  __pyx_ptype_5numpy_flexible = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 825, __pyx_L1_error)
-  __pyx_ptype_5numpy_character = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 827, __pyx_L1_error)
-  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyUFuncObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 866, __pyx_L1_error)
+  __pyx_ptype_5numpy_dtype = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArray_Descr),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 202, __pyx_L1_error)
+  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 225, __pyx_L1_error)
+  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayMultiIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 229, __pyx_L1_error)
+  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
+  __pyx_ptype_5numpy_generic = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 809, __pyx_L1_error)
+  __pyx_ptype_5numpy_number = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 811, __pyx_L1_error)
+  __pyx_ptype_5numpy_integer = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 813, __pyx_L1_error)
+  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 815, __pyx_L1_error)
+  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 817, __pyx_L1_error)
+  __pyx_ptype_5numpy_inexact = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 819, __pyx_L1_error)
+  __pyx_ptype_5numpy_floating = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 821, __pyx_L1_error)
+  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 823, __pyx_L1_error)
+  __pyx_ptype_5numpy_flexible = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 825, __pyx_L1_error)
+  __pyx_ptype_5numpy_character = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 827, __pyx_L1_error)
+  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyUFuncObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 866, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(4, 8, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(4, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(4, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(4, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(4, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(4, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(4, 67, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(4, 23, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(4, 26, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(4, 29, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(4, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -48969,18 +48991,18 @@
         return PyObject_GenericGetAttr(obj, attr_name);
     }
     return __Pyx_PyObject_GenericGetAttrNoDict(obj, attr_name);
 }
 #endif
 
 /* TypeImport */
-#ifndef __PYX_HAVE_RT_ImportType_3_0_8
-#define __PYX_HAVE_RT_ImportType_3_0_8
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size)
+#ifndef __PYX_HAVE_RT_ImportType_3_0_10
+#define __PYX_HAVE_RT_ImportType_3_0_10
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject *module, const char *module_name, const char *class_name,
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
     Py_ssize_t itemsize;
 #if CYTHON_COMPILING_IN_LIMITED_API
     PyObject *py_basicsize;
@@ -49026,23 +49048,23 @@
     if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize+itemsize);
         goto bad;
     }
-    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_8 &&
+    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_10 &&
             ((size_t)basicsize > size || (size_t)(basicsize + itemsize) < size)) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd-%zd from PyObject",
             module_name, class_name, size, basicsize, basicsize+itemsize);
         goto bad;
     }
-    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_8 && (size_t)basicsize > size) {
+    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_10 && (size_t)basicsize > size) {
         PyOS_snprintf(warning, sizeof(warning),
             "%s.%s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
     }
     return (PyTypeObject *)result;
@@ -50599,15 +50621,15 @@
         break;
     case 0:
         self = ((PyCFunctionObject*)cyfunc)->m_self;
         break;
     default:
         return NULL;
     }
-    return ((_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
+    return ((__Pyx_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
 }
 static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS_METHOD(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
 {
     __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
     PyMethodDef* def = ((PyCFunctionObject*)cyfunc)->m_ml;
     PyTypeObject *cls = (PyTypeObject *) __Pyx_CyFunction_GetClassObj(cyfunc);
 #if CYTHON_BACKPORT_VECTORCALL
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.pyx` & `pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Ham_AvgS2precess_simple_cython_PA_AD.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.c` & `pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.c`

 * *Files 0% similar despite different names*

```diff
@@ -1,32 +1,32 @@
-/* Generated by Cython 3.0.8 */
+/* Generated by Cython 3.0.10 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "define_macros": [
             [
                 "CYTHON_TRACE",
                 "1"
             ]
         ],
         "depends": [
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ufuncobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include"
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include"
         ],
         "name": "pyseobnr.eob.hamiltonian.Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C",
         "sources": [
             "pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.pyx"
         ]
     },
     "module_name": "pyseobnr.eob.hamiltonian.Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C"
@@ -53,18 +53,18 @@
     #error Cython requires Python 2.7+ or Python 3.3+.
 #else
 #if defined(CYTHON_LIMITED_API) && CYTHON_LIMITED_API
 #define __PYX_EXTRA_ABI_MODULE_NAME "limited"
 #else
 #define __PYX_EXTRA_ABI_MODULE_NAME ""
 #endif
-#define CYTHON_ABI "3_0_8" __PYX_EXTRA_ABI_MODULE_NAME
+#define CYTHON_ABI "3_0_10" __PYX_EXTRA_ABI_MODULE_NAME
 #define __PYX_ABI_MODULE_NAME "_cython_" CYTHON_ABI
 #define __PYX_TYPE_MODULE_PREFIX __PYX_ABI_MODULE_NAME "."
-#define CYTHON_HEX_VERSION 0x030008F0
+#define CYTHON_HEX_VERSION 0x03000AF0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(_WIN32) && !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -148,14 +148,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(PYPY_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #undef CYTHON_USE_TYPE_SLOTS
@@ -209,14 +211,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(CYTHON_LIMITED_API)
   #ifdef Py_LIMITED_API
     #undef __PYX_LIMITED_VERSION_HEX
     #define __PYX_LIMITED_VERSION_HEX Py_LIMITED_API
   #endif
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
@@ -270,60 +274,83 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(Py_GIL_DISABLED) || defined(Py_NOGIL)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_TYPE_SPECS
+    #define CYTHON_USE_TYPE_SPECS 0
+  #endif
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #ifndef CYTHON_USE_ASYNC_SLOTS
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_PYLONG_INTERNALS
+    #define CYTHON_USE_PYLONG_INTERNALS 0
+  #endif
   #undef CYTHON_USE_PYLIST_INTERNALS
   #define CYTHON_USE_PYLIST_INTERNALS 0
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
   #undef CYTHON_USE_UNICODE_WRITER
   #define CYTHON_USE_UNICODE_WRITER 0
-  #undef CYTHON_USE_PYLONG_INTERNALS
-  #define CYTHON_USE_PYLONG_INTERNALS 0
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
   #undef CYTHON_FAST_THREAD_STATE
   #define CYTHON_FAST_THREAD_STATE 0
+  #undef CYTHON_FAST_GIL
+  #define CYTHON_FAST_GIL 0
+  #ifndef CYTHON_METH_FASTCALL
+    #define CYTHON_METH_FASTCALL 1
+  #endif
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
+  #ifndef CYTHON_PEP487_INIT_SUBCLASS
+    #define CYTHON_PEP487_INIT_SUBCLASS 1
+  #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT 1
   #endif
+  #ifndef CYTHON_USE_MODULE_STATE
+    #define CYTHON_USE_MODULE_STATE 0
+  #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE 1
   #endif
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
@@ -406,14 +433,17 @@
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK 1
   #endif
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
   #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if !defined(CYTHON_VECTORCALL)
 #define CYTHON_VECTORCALL  (CYTHON_FAST_PYCCALL && PY_VERSION_HEX >= 0x030800B1)
 #endif
@@ -749,16 +779,21 @@
   #ifndef METH_FASTCALL
      #define METH_FASTCALL 0x80
   #endif
   typedef PyObject *(*__Pyx_PyCFunctionFast) (PyObject *self, PyObject *const *args, Py_ssize_t nargs);
   typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords) (PyObject *self, PyObject *const *args,
                                                           Py_ssize_t nargs, PyObject *kwnames);
 #else
-  #define __Pyx_PyCFunctionFast _PyCFunctionFast
-  #define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #if PY_VERSION_HEX >= 0x030d00A4
+  #  define __Pyx_PyCFunctionFast PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords PyCFunctionFastWithKeywords
+  #else
+  #  define __Pyx_PyCFunctionFast _PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #endif
 #endif
 #if CYTHON_METH_FASTCALL
   #define __Pyx_METH_FASTCALL METH_FASTCALL
   #define __Pyx_PyCFunction_FastCall __Pyx_PyCFunctionFast
   #define __Pyx_PyCFunction_FastCallWithKeywords __Pyx_PyCFunctionFastWithKeywords
 #else
   #define __Pyx_METH_FASTCALL METH_VARARGS
@@ -1102,15 +1137,15 @@
   #define __Pyx_PyList_SET_ITEM(o, i, v) PyList_SetItem(o, i, v)
   #define __Pyx_PyTuple_GET_SIZE(o) PyTuple_Size(o)
   #define __Pyx_PyList_GET_SIZE(o) PyList_Size(o)
   #define __Pyx_PySet_GET_SIZE(o) PySet_Size(o)
   #define __Pyx_PyBytes_GET_SIZE(o) PyBytes_Size(o)
   #define __Pyx_PyByteArray_GET_SIZE(o) PyByteArray_Size(o)
 #endif
-#if PY_VERSION_HEX >= 0x030d00A1
+#if __PYX_LIMITED_VERSION_HEX >= 0x030d00A1
   #define __Pyx_PyImport_AddModuleRef(name) PyImport_AddModuleRef(name)
 #else
   static CYTHON_INLINE PyObject *__Pyx_PyImport_AddModuleRef(const char *name) {
       PyObject *module = PyImport_AddModule(name);
       Py_XINCREF(module);
       return module;
   }
@@ -1189,15 +1224,15 @@
 #if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
 #define __Pyx_truncl trunc
 #else
 #define __Pyx_truncl truncl
 #endif
 
 #define __PYX_MARK_ERR_POS(f_index, lineno) \
-    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__; (void)__pyx_clineno; }
+    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__;  (void)__pyx_clineno; }
 #define __PYX_ERR(f_index, lineno, Ln_error) \
     { __PYX_MARK_ERR_POS(f_index, lineno) goto Ln_error; }
 
 #ifdef CYTHON_EXTERN_C
     #undef __PYX_EXTERN_C
     #define __PYX_EXTERN_C CYTHON_EXTERN_C
 #elif defined(__PYX_EXTERN_C)
@@ -1306,32 +1341,15 @@
 #define __Pyx_PyObject_AsSString(s)    ((const signed char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_AsUString(s)    ((const unsigned char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
 #define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
 #define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
 #define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
 #define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
-#if CYTHON_COMPILING_IN_LIMITED_API
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const wchar_t *u)
-{
-    const wchar_t *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#else
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
-{
-    const Py_UNICODE *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#endif
 #define __Pyx_PyUnicode_FromOrdinal(o)       PyUnicode_FromOrdinal((int)o)
-#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
-#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
 #define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
 #define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
 #define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
 static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
@@ -1664,177 +1682,177 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1874,42 +1892,42 @@
 struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
 struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C;
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -3132,30 +3150,30 @@
 #if CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP && PY_VERSION_HEX < 0x03070000
 static PyObject* __Pyx_PyObject_GenericGetAttr(PyObject* obj, PyObject* attr_name);
 #else
 #define __Pyx_PyObject_GenericGetAttr PyObject_GenericGetAttr
 #endif
 
 /* TypeImport.proto */
-#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_8
-#define __PYX_HAVE_RT_ImportType_proto_3_0_8
+#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_10
+#define __PYX_HAVE_RT_ImportType_proto_3_0_10
 #if defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L
 #include <stdalign.h>
 #endif
 #if (defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L) || __cplusplus >= 201103L
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) alignof(s)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) alignof(s)
 #else
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) sizeof(void*)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) sizeof(void*)
 #endif
-enum __Pyx_ImportType_CheckSize_3_0_8 {
-   __Pyx_ImportType_CheckSize_Error_3_0_8 = 0,
-   __Pyx_ImportType_CheckSize_Warn_3_0_8 = 1,
-   __Pyx_ImportType_CheckSize_Ignore_3_0_8 = 2
+enum __Pyx_ImportType_CheckSize_3_0_10 {
+   __Pyx_ImportType_CheckSize_Error_3_0_10 = 0,
+   __Pyx_ImportType_CheckSize_Warn_3_0_10 = 1,
+   __Pyx_ImportType_CheckSize_Ignore_3_0_10 = 2
 };
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size);
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size);
 #endif
 
 /* GetVTable.proto */
 static void* __Pyx_GetVtable(PyTypeObject *type);
 
 /* IncludeStructmemberH.proto */
 #include <structmember.h>
@@ -18881,261 +18899,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19144,29 +19162,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19177,15 +19195,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19194,29 +19212,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -19227,15 +19245,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19244,29 +19262,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -19277,15 +19295,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19294,29 +19312,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -19327,15 +19345,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19344,29 +19362,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -19377,217 +19395,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":969
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":970
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":970
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 970, __pyx_L1_error)
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":973
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":975
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":975
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":976
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":976
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19603,15 +19621,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -19619,68 +19637,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":982
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":982
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 982, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":983
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":983
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 984, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 984, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19688,15 +19706,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19711,15 +19729,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19735,15 +19753,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19751,68 +19769,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":988
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":988
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 988, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":989
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":989
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 990, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 990, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19820,15 +19838,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19843,15 +19861,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19867,15 +19885,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19883,68 +19901,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":994
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":994
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 994, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":995
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":995
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":996
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":996
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 996, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 996, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19952,15 +19970,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19975,170 +19993,170 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1011
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1011
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1026
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1026
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1036
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1036
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1043
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1043
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1050
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1050
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -40314,15 +40332,19 @@
     if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C) {
       if (PyObject_CallFinalizerFromDealloc(o)) return;
     }
   }
   #endif
   PyObject_GC_UnTrack(o);
   Py_CLEAR(p->calibration_coeffs);
-  PyObject_GC_Track(o);
+  #if PY_MAJOR_VERSION < 3
+  if (!(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) || PyType_IS_GC(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C)) PyObject_GC_Track(o);
+  #else
+  if (PyType_IS_GC(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C)) PyObject_GC_Track(o);
+  #endif
   if (likely(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C)) __Pyx_PyType_GetSlot(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C, tp_dealloc, destructor)(o); else __Pyx_call_next_tp_dealloc(o, __pyx_tp_dealloc_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C);
 }
 
 static int __pyx_tp_traverse_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C(PyObject *o, visitproc v, void *a) {
   int e;
   struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C *p = (struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C *)o;
   e = ((likely(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C)) ? ((__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C->tp_traverse) ? __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C->tp_traverse(o, v, a) : 0) : __Pyx_call_next_tp_traverse(o, v, a, __pyx_tp_traverse_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C)); if (e) return e;
@@ -41647,26 +41669,26 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 984, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 990, __pyx_L1_error)
@@ -41980,15 +42002,15 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.hamiltonian.Hamiltonian_C"); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) __PYX_ERR(1, 2, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.hamiltonian.Hamiltonian_C", "Hamiltonian_C", sizeof(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C = (struct __pyx_vtabstruct_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C)) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C = &__pyx_vtable_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.__pyx_base = *__pyx_vtabptr_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.__pyx_base._call = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C__call__pyx_wrap_1;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.__pyx_base.grad = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_grad;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.__pyx_base.hessian = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_hessian;
   __pyx_vtable_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.__pyx_base.dynamics = (PyObject *(*)(struct __pyx_obj_8pyseobnr_3eob_11hamiltonian_13Hamiltonian_C_Hamiltonian_C *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, double, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_11hamiltonian_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_39Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C_dynamics;
@@ -42184,50 +42206,50 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_0_8(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
+  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_0_10(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
   #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
-  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyTypeObject),
   #elif CYTHON_COMPILING_IN_LIMITED_API
-  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyTypeObject),
   #else
-  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyHeapTypeObject),
+  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyHeapTypeObject),
   #endif
-  __Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(3, 9, __pyx_L1_error)
+  __Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(3, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_5numpy_dtype = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArray_Descr),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 202, __pyx_L1_error)
-  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 225, __pyx_L1_error)
-  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayMultiIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 229, __pyx_L1_error)
-  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
-  __pyx_ptype_5numpy_generic = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 809, __pyx_L1_error)
-  __pyx_ptype_5numpy_number = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 811, __pyx_L1_error)
-  __pyx_ptype_5numpy_integer = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 813, __pyx_L1_error)
-  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 815, __pyx_L1_error)
-  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 817, __pyx_L1_error)
-  __pyx_ptype_5numpy_inexact = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 819, __pyx_L1_error)
-  __pyx_ptype_5numpy_floating = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 821, __pyx_L1_error)
-  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 823, __pyx_L1_error)
-  __pyx_ptype_5numpy_flexible = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 825, __pyx_L1_error)
-  __pyx_ptype_5numpy_character = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 827, __pyx_L1_error)
-  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyUFuncObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 866, __pyx_L1_error)
+  __pyx_ptype_5numpy_dtype = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArray_Descr),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 202, __pyx_L1_error)
+  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 225, __pyx_L1_error)
+  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayMultiIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 229, __pyx_L1_error)
+  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
+  __pyx_ptype_5numpy_generic = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 809, __pyx_L1_error)
+  __pyx_ptype_5numpy_number = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 811, __pyx_L1_error)
+  __pyx_ptype_5numpy_integer = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 813, __pyx_L1_error)
+  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 815, __pyx_L1_error)
+  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 817, __pyx_L1_error)
+  __pyx_ptype_5numpy_inexact = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 819, __pyx_L1_error)
+  __pyx_ptype_5numpy_floating = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 821, __pyx_L1_error)
+  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 823, __pyx_L1_error)
+  __pyx_ptype_5numpy_flexible = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 825, __pyx_L1_error)
+  __pyx_ptype_5numpy_character = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 827, __pyx_L1_error)
+  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyUFuncObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 866, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(4, 8, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(4, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(4, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(4, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(4, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(4, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(4, 67, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(4, 23, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(4, 26, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(4, 29, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(4, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -45937,18 +45959,18 @@
         return PyObject_GenericGetAttr(obj, attr_name);
     }
     return __Pyx_PyObject_GenericGetAttrNoDict(obj, attr_name);
 }
 #endif
 
 /* TypeImport */
-#ifndef __PYX_HAVE_RT_ImportType_3_0_8
-#define __PYX_HAVE_RT_ImportType_3_0_8
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size)
+#ifndef __PYX_HAVE_RT_ImportType_3_0_10
+#define __PYX_HAVE_RT_ImportType_3_0_10
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject *module, const char *module_name, const char *class_name,
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
     Py_ssize_t itemsize;
 #if CYTHON_COMPILING_IN_LIMITED_API
     PyObject *py_basicsize;
@@ -45994,23 +46016,23 @@
     if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize+itemsize);
         goto bad;
     }
-    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_8 &&
+    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_10 &&
             ((size_t)basicsize > size || (size_t)(basicsize + itemsize) < size)) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd-%zd from PyObject",
             module_name, class_name, size, basicsize, basicsize+itemsize);
         goto bad;
     }
-    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_8 && (size_t)basicsize > size) {
+    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_10 && (size_t)basicsize > size) {
         PyOS_snprintf(warning, sizeof(warning),
             "%s.%s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
     }
     return (PyTypeObject *)result;
@@ -47567,15 +47589,15 @@
         break;
     case 0:
         self = ((PyCFunctionObject*)cyfunc)->m_self;
         break;
     default:
         return NULL;
     }
-    return ((_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
+    return ((__Pyx_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
 }
 static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS_METHOD(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
 {
     __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
     PyMethodDef* def = ((PyCFunctionObject*)cyfunc)->m_ml;
     PyTypeObject *cls = (PyTypeObject *) __Pyx_CyFunction_GetClassObj(cyfunc);
 #if CYTHON_BACKPORT_VECTORCALL
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.pyx` & `pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Hamiltonian_C.c` & `pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Hamiltonian_C.c`

 * *Files 0% similar despite different names*

```diff
@@ -1,21 +1,21 @@
-/* Generated by Cython 3.0.8 */
+/* Generated by Cython 3.0.10 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-zy1w3hcp/lib/python3.11/site-packages/numpy/core/include"
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include"
         ],
         "name": "pyseobnr.eob.hamiltonian.Hamiltonian_C",
         "sources": [
             "pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx"
         ]
     },
     "module_name": "pyseobnr.eob.hamiltonian.Hamiltonian_C"
@@ -42,18 +42,18 @@
     #error Cython requires Python 2.7+ or Python 3.3+.
 #else
 #if defined(CYTHON_LIMITED_API) && CYTHON_LIMITED_API
 #define __PYX_EXTRA_ABI_MODULE_NAME "limited"
 #else
 #define __PYX_EXTRA_ABI_MODULE_NAME ""
 #endif
-#define CYTHON_ABI "3_0_8" __PYX_EXTRA_ABI_MODULE_NAME
+#define CYTHON_ABI "3_0_10" __PYX_EXTRA_ABI_MODULE_NAME
 #define __PYX_ABI_MODULE_NAME "_cython_" CYTHON_ABI
 #define __PYX_TYPE_MODULE_PREFIX __PYX_ABI_MODULE_NAME "."
-#define CYTHON_HEX_VERSION 0x030008F0
+#define CYTHON_HEX_VERSION 0x03000AF0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(_WIN32) && !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -137,14 +137,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(PYPY_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #undef CYTHON_USE_TYPE_SLOTS
@@ -198,14 +200,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(CYTHON_LIMITED_API)
   #ifdef Py_LIMITED_API
     #undef __PYX_LIMITED_VERSION_HEX
     #define __PYX_LIMITED_VERSION_HEX Py_LIMITED_API
   #endif
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
@@ -259,60 +263,83 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(Py_GIL_DISABLED) || defined(Py_NOGIL)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_TYPE_SPECS
+    #define CYTHON_USE_TYPE_SPECS 0
+  #endif
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #ifndef CYTHON_USE_ASYNC_SLOTS
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_PYLONG_INTERNALS
+    #define CYTHON_USE_PYLONG_INTERNALS 0
+  #endif
   #undef CYTHON_USE_PYLIST_INTERNALS
   #define CYTHON_USE_PYLIST_INTERNALS 0
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
   #undef CYTHON_USE_UNICODE_WRITER
   #define CYTHON_USE_UNICODE_WRITER 0
-  #undef CYTHON_USE_PYLONG_INTERNALS
-  #define CYTHON_USE_PYLONG_INTERNALS 0
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
   #undef CYTHON_FAST_THREAD_STATE
   #define CYTHON_FAST_THREAD_STATE 0
+  #undef CYTHON_FAST_GIL
+  #define CYTHON_FAST_GIL 0
+  #ifndef CYTHON_METH_FASTCALL
+    #define CYTHON_METH_FASTCALL 1
+  #endif
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
+  #ifndef CYTHON_PEP487_INIT_SUBCLASS
+    #define CYTHON_PEP487_INIT_SUBCLASS 1
+  #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT 1
   #endif
+  #ifndef CYTHON_USE_MODULE_STATE
+    #define CYTHON_USE_MODULE_STATE 0
+  #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE 1
   #endif
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
@@ -395,14 +422,17 @@
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK 1
   #endif
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
   #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if !defined(CYTHON_VECTORCALL)
 #define CYTHON_VECTORCALL  (CYTHON_FAST_PYCCALL && PY_VERSION_HEX >= 0x030800B1)
 #endif
@@ -738,16 +768,21 @@
   #ifndef METH_FASTCALL
      #define METH_FASTCALL 0x80
   #endif
   typedef PyObject *(*__Pyx_PyCFunctionFast) (PyObject *self, PyObject *const *args, Py_ssize_t nargs);
   typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords) (PyObject *self, PyObject *const *args,
                                                           Py_ssize_t nargs, PyObject *kwnames);
 #else
-  #define __Pyx_PyCFunctionFast _PyCFunctionFast
-  #define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #if PY_VERSION_HEX >= 0x030d00A4
+  #  define __Pyx_PyCFunctionFast PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords PyCFunctionFastWithKeywords
+  #else
+  #  define __Pyx_PyCFunctionFast _PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #endif
 #endif
 #if CYTHON_METH_FASTCALL
   #define __Pyx_METH_FASTCALL METH_FASTCALL
   #define __Pyx_PyCFunction_FastCall __Pyx_PyCFunctionFast
   #define __Pyx_PyCFunction_FastCallWithKeywords __Pyx_PyCFunctionFastWithKeywords
 #else
   #define __Pyx_METH_FASTCALL METH_VARARGS
@@ -1091,15 +1126,15 @@
   #define __Pyx_PyList_SET_ITEM(o, i, v) PyList_SetItem(o, i, v)
   #define __Pyx_PyTuple_GET_SIZE(o) PyTuple_Size(o)
   #define __Pyx_PyList_GET_SIZE(o) PyList_Size(o)
   #define __Pyx_PySet_GET_SIZE(o) PySet_Size(o)
   #define __Pyx_PyBytes_GET_SIZE(o) PyBytes_Size(o)
   #define __Pyx_PyByteArray_GET_SIZE(o) PyByteArray_Size(o)
 #endif
-#if PY_VERSION_HEX >= 0x030d00A1
+#if __PYX_LIMITED_VERSION_HEX >= 0x030d00A1
   #define __Pyx_PyImport_AddModuleRef(name) PyImport_AddModuleRef(name)
 #else
   static CYTHON_INLINE PyObject *__Pyx_PyImport_AddModuleRef(const char *name) {
       PyObject *module = PyImport_AddModule(name);
       Py_XINCREF(module);
       return module;
   }
@@ -1178,15 +1213,15 @@
 #if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
 #define __Pyx_truncl trunc
 #else
 #define __Pyx_truncl truncl
 #endif
 
 #define __PYX_MARK_ERR_POS(f_index, lineno) \
-    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__; (void)__pyx_clineno; }
+    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__;  (void)__pyx_clineno; }
 #define __PYX_ERR(f_index, lineno, Ln_error) \
     { __PYX_MARK_ERR_POS(f_index, lineno) goto Ln_error; }
 
 #ifdef CYTHON_EXTERN_C
     #undef __PYX_EXTERN_C
     #define __PYX_EXTERN_C CYTHON_EXTERN_C
 #elif defined(__PYX_EXTERN_C)
@@ -1285,32 +1320,15 @@
 #define __Pyx_PyObject_AsSString(s)    ((const signed char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_AsUString(s)    ((const unsigned char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
 #define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
 #define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
 #define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
 #define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
-#if CYTHON_COMPILING_IN_LIMITED_API
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const wchar_t *u)
-{
-    const wchar_t *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#else
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
-{
-    const Py_UNICODE *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#endif
 #define __Pyx_PyUnicode_FromOrdinal(o)       PyUnicode_FromOrdinal((int)o)
-#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
-#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
 #define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
 #define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
 #define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
 static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
@@ -2597,30 +2615,30 @@
 
 /* SetupReduce.proto */
 #if !CYTHON_COMPILING_IN_LIMITED_API
 static int __Pyx_setup_reduce(PyObject* type_obj);
 #endif
 
 /* TypeImport.proto */
-#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_8
-#define __PYX_HAVE_RT_ImportType_proto_3_0_8
+#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_10
+#define __PYX_HAVE_RT_ImportType_proto_3_0_10
 #if defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L
 #include <stdalign.h>
 #endif
 #if (defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L) || __cplusplus >= 201103L
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) alignof(s)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) alignof(s)
 #else
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) sizeof(void*)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) sizeof(void*)
 #endif
-enum __Pyx_ImportType_CheckSize_3_0_8 {
-   __Pyx_ImportType_CheckSize_Error_3_0_8 = 0,
-   __Pyx_ImportType_CheckSize_Warn_3_0_8 = 1,
-   __Pyx_ImportType_CheckSize_Ignore_3_0_8 = 2
+enum __Pyx_ImportType_CheckSize_3_0_10 {
+   __Pyx_ImportType_CheckSize_Error_3_0_10 = 0,
+   __Pyx_ImportType_CheckSize_Warn_3_0_10 = 1,
+   __Pyx_ImportType_CheckSize_Ignore_3_0_10 = 2
 };
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size);
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size);
 #endif
 
 /* FetchSharedCythonModule.proto */
 static PyObject *__Pyx_FetchSharedCythonABIModule(void);
 
 /* FetchCommonType.proto */
 #if !CYTHON_USE_TYPE_SPECS
@@ -22473,20 +22491,20 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(3, 8, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(3, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(3, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(3, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(3, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(3, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(3, 67, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(3, 23, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(3, 26, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(3, 29, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(3, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -26526,18 +26544,18 @@
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
 }
 #endif
 
 /* TypeImport */
-#ifndef __PYX_HAVE_RT_ImportType_3_0_8
-#define __PYX_HAVE_RT_ImportType_3_0_8
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size)
+#ifndef __PYX_HAVE_RT_ImportType_3_0_10
+#define __PYX_HAVE_RT_ImportType_3_0_10
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject *module, const char *module_name, const char *class_name,
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
     Py_ssize_t itemsize;
 #if CYTHON_COMPILING_IN_LIMITED_API
     PyObject *py_basicsize;
@@ -26583,23 +26601,23 @@
     if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize+itemsize);
         goto bad;
     }
-    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_8 &&
+    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_10 &&
             ((size_t)basicsize > size || (size_t)(basicsize + itemsize) < size)) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd-%zd from PyObject",
             module_name, class_name, size, basicsize, basicsize+itemsize);
         goto bad;
     }
-    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_8 && (size_t)basicsize > size) {
+    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_10 && (size_t)basicsize > size) {
         PyOS_snprintf(warning, sizeof(warning),
             "%s.%s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
     }
     return (PyTypeObject *)result;
@@ -27591,15 +27609,15 @@
         break;
     case 0:
         self = ((PyCFunctionObject*)cyfunc)->m_self;
         break;
     default:
         return NULL;
     }
-    return ((_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
+    return ((__Pyx_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
 }
 static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS_METHOD(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
 {
     __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
     PyMethodDef* def = ((PyCFunctionObject*)cyfunc)->m_ml;
     PyTypeObject *cls = (PyTypeObject *) __Pyx_CyFunction_GetClassObj(cyfunc);
 #if CYTHON_BACKPORT_VECTORCALL
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd` & `pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Hamiltonian_C.pxd`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx` & `pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Hamiltonian_C.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.c` & `pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.c`

 * *Files 0% similar despite different names*

```diff
@@ -1,21 +1,21 @@
-/* Generated by Cython 3.0.8 */
+/* Generated by Cython 3.0.10 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-zy1w3hcp/lib/python3.11/site-packages/numpy/core/include",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include",
             "pyseobnr/eob/hamiltonian"
         ],
         "name": "pyseobnr.eob.hamiltonian.Hamiltonian_v5PHM_C",
         "sources": [
             "pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx"
         ]
     },
@@ -43,18 +43,18 @@
     #error Cython requires Python 2.7+ or Python 3.3+.
 #else
 #if defined(CYTHON_LIMITED_API) && CYTHON_LIMITED_API
 #define __PYX_EXTRA_ABI_MODULE_NAME "limited"
 #else
 #define __PYX_EXTRA_ABI_MODULE_NAME ""
 #endif
-#define CYTHON_ABI "3_0_8" __PYX_EXTRA_ABI_MODULE_NAME
+#define CYTHON_ABI "3_0_10" __PYX_EXTRA_ABI_MODULE_NAME
 #define __PYX_ABI_MODULE_NAME "_cython_" CYTHON_ABI
 #define __PYX_TYPE_MODULE_PREFIX __PYX_ABI_MODULE_NAME "."
-#define CYTHON_HEX_VERSION 0x030008F0
+#define CYTHON_HEX_VERSION 0x03000AF0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(_WIN32) && !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -138,14 +138,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(PYPY_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #undef CYTHON_USE_TYPE_SLOTS
@@ -199,14 +201,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(CYTHON_LIMITED_API)
   #ifdef Py_LIMITED_API
     #undef __PYX_LIMITED_VERSION_HEX
     #define __PYX_LIMITED_VERSION_HEX Py_LIMITED_API
   #endif
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
@@ -260,60 +264,83 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(Py_GIL_DISABLED) || defined(Py_NOGIL)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_TYPE_SPECS
+    #define CYTHON_USE_TYPE_SPECS 0
+  #endif
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #ifndef CYTHON_USE_ASYNC_SLOTS
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_PYLONG_INTERNALS
+    #define CYTHON_USE_PYLONG_INTERNALS 0
+  #endif
   #undef CYTHON_USE_PYLIST_INTERNALS
   #define CYTHON_USE_PYLIST_INTERNALS 0
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
   #undef CYTHON_USE_UNICODE_WRITER
   #define CYTHON_USE_UNICODE_WRITER 0
-  #undef CYTHON_USE_PYLONG_INTERNALS
-  #define CYTHON_USE_PYLONG_INTERNALS 0
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
   #undef CYTHON_FAST_THREAD_STATE
   #define CYTHON_FAST_THREAD_STATE 0
+  #undef CYTHON_FAST_GIL
+  #define CYTHON_FAST_GIL 0
+  #ifndef CYTHON_METH_FASTCALL
+    #define CYTHON_METH_FASTCALL 1
+  #endif
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
+  #ifndef CYTHON_PEP487_INIT_SUBCLASS
+    #define CYTHON_PEP487_INIT_SUBCLASS 1
+  #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT 1
   #endif
+  #ifndef CYTHON_USE_MODULE_STATE
+    #define CYTHON_USE_MODULE_STATE 0
+  #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE 1
   #endif
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
@@ -396,14 +423,17 @@
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK 1
   #endif
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
   #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if !defined(CYTHON_VECTORCALL)
 #define CYTHON_VECTORCALL  (CYTHON_FAST_PYCCALL && PY_VERSION_HEX >= 0x030800B1)
 #endif
@@ -739,16 +769,21 @@
   #ifndef METH_FASTCALL
      #define METH_FASTCALL 0x80
   #endif
   typedef PyObject *(*__Pyx_PyCFunctionFast) (PyObject *self, PyObject *const *args, Py_ssize_t nargs);
   typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords) (PyObject *self, PyObject *const *args,
                                                           Py_ssize_t nargs, PyObject *kwnames);
 #else
-  #define __Pyx_PyCFunctionFast _PyCFunctionFast
-  #define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #if PY_VERSION_HEX >= 0x030d00A4
+  #  define __Pyx_PyCFunctionFast PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords PyCFunctionFastWithKeywords
+  #else
+  #  define __Pyx_PyCFunctionFast _PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #endif
 #endif
 #if CYTHON_METH_FASTCALL
   #define __Pyx_METH_FASTCALL METH_FASTCALL
   #define __Pyx_PyCFunction_FastCall __Pyx_PyCFunctionFast
   #define __Pyx_PyCFunction_FastCallWithKeywords __Pyx_PyCFunctionFastWithKeywords
 #else
   #define __Pyx_METH_FASTCALL METH_VARARGS
@@ -1092,15 +1127,15 @@
   #define __Pyx_PyList_SET_ITEM(o, i, v) PyList_SetItem(o, i, v)
   #define __Pyx_PyTuple_GET_SIZE(o) PyTuple_Size(o)
   #define __Pyx_PyList_GET_SIZE(o) PyList_Size(o)
   #define __Pyx_PySet_GET_SIZE(o) PySet_Size(o)
   #define __Pyx_PyBytes_GET_SIZE(o) PyBytes_Size(o)
   #define __Pyx_PyByteArray_GET_SIZE(o) PyByteArray_Size(o)
 #endif
-#if PY_VERSION_HEX >= 0x030d00A1
+#if __PYX_LIMITED_VERSION_HEX >= 0x030d00A1
   #define __Pyx_PyImport_AddModuleRef(name) PyImport_AddModuleRef(name)
 #else
   static CYTHON_INLINE PyObject *__Pyx_PyImport_AddModuleRef(const char *name) {
       PyObject *module = PyImport_AddModule(name);
       Py_XINCREF(module);
       return module;
   }
@@ -1179,15 +1214,15 @@
 #if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
 #define __Pyx_truncl trunc
 #else
 #define __Pyx_truncl truncl
 #endif
 
 #define __PYX_MARK_ERR_POS(f_index, lineno) \
-    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__; (void)__pyx_clineno; }
+    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__;  (void)__pyx_clineno; }
 #define __PYX_ERR(f_index, lineno, Ln_error) \
     { __PYX_MARK_ERR_POS(f_index, lineno) goto Ln_error; }
 
 #ifdef CYTHON_EXTERN_C
     #undef __PYX_EXTERN_C
     #define __PYX_EXTERN_C CYTHON_EXTERN_C
 #elif defined(__PYX_EXTERN_C)
@@ -1286,32 +1321,15 @@
 #define __Pyx_PyObject_AsSString(s)    ((const signed char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_AsUString(s)    ((const unsigned char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
 #define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
 #define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
 #define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
 #define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
-#if CYTHON_COMPILING_IN_LIMITED_API
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const wchar_t *u)
-{
-    const wchar_t *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#else
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
-{
-    const Py_UNICODE *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#endif
 #define __Pyx_PyUnicode_FromOrdinal(o)       PyUnicode_FromOrdinal((int)o)
-#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
-#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
 #define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
 #define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
 #define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
 static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
@@ -2598,30 +2616,30 @@
 
 /* SetupReduce.proto */
 #if !CYTHON_COMPILING_IN_LIMITED_API
 static int __Pyx_setup_reduce(PyObject* type_obj);
 #endif
 
 /* TypeImport.proto */
-#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_8
-#define __PYX_HAVE_RT_ImportType_proto_3_0_8
+#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_10
+#define __PYX_HAVE_RT_ImportType_proto_3_0_10
 #if defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L
 #include <stdalign.h>
 #endif
 #if (defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L) || __cplusplus >= 201103L
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) alignof(s)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) alignof(s)
 #else
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) sizeof(void*)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) sizeof(void*)
 #endif
-enum __Pyx_ImportType_CheckSize_3_0_8 {
-   __Pyx_ImportType_CheckSize_Error_3_0_8 = 0,
-   __Pyx_ImportType_CheckSize_Warn_3_0_8 = 1,
-   __Pyx_ImportType_CheckSize_Ignore_3_0_8 = 2
+enum __Pyx_ImportType_CheckSize_3_0_10 {
+   __Pyx_ImportType_CheckSize_Error_3_0_10 = 0,
+   __Pyx_ImportType_CheckSize_Warn_3_0_10 = 1,
+   __Pyx_ImportType_CheckSize_Ignore_3_0_10 = 2
 };
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size);
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size);
 #endif
 
 /* FetchSharedCythonModule.proto */
 static PyObject *__Pyx_FetchSharedCythonABIModule(void);
 
 /* FetchCommonType.proto */
 #if !CYTHON_USE_TYPE_SPECS
@@ -23114,20 +23132,20 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(3, 8, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(3, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(3, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(3, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(3, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(3, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(3, 67, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(3, 23, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(3, 26, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(3, 29, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(3, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -27167,18 +27185,18 @@
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
 }
 #endif
 
 /* TypeImport */
-#ifndef __PYX_HAVE_RT_ImportType_3_0_8
-#define __PYX_HAVE_RT_ImportType_3_0_8
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size)
+#ifndef __PYX_HAVE_RT_ImportType_3_0_10
+#define __PYX_HAVE_RT_ImportType_3_0_10
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject *module, const char *module_name, const char *class_name,
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
     Py_ssize_t itemsize;
 #if CYTHON_COMPILING_IN_LIMITED_API
     PyObject *py_basicsize;
@@ -27224,23 +27242,23 @@
     if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize+itemsize);
         goto bad;
     }
-    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_8 &&
+    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_10 &&
             ((size_t)basicsize > size || (size_t)(basicsize + itemsize) < size)) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd-%zd from PyObject",
             module_name, class_name, size, basicsize, basicsize+itemsize);
         goto bad;
     }
-    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_8 && (size_t)basicsize > size) {
+    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_10 && (size_t)basicsize > size) {
         PyOS_snprintf(warning, sizeof(warning),
             "%s.%s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
     }
     return (PyTypeObject *)result;
@@ -28232,15 +28250,15 @@
         break;
     case 0:
         self = ((PyCFunctionObject*)cyfunc)->m_self;
         break;
     default:
         return NULL;
     }
-    return ((_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
+    return ((__Pyx_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
 }
 static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS_METHOD(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
 {
     __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
     PyMethodDef* def = ((PyCFunctionObject*)cyfunc)->m_ml;
     PyTypeObject *cls = (PyTypeObject *) __Pyx_CyFunction_GetClassObj(cyfunc);
 #if CYTHON_BACKPORT_VECTORCALL
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd` & `pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pxd`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx` & `pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/Hamiltonian_v5PHM_C.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/hamiltonian/hamiltonian.py` & `pyseobnr-0.2.9/pyseobnr/eob/hamiltonian/hamiltonian.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/utils/containers.c` & `pyseobnr-0.2.9/pyseobnr/eob/utils/containers.c`

 * *Files 1% similar despite different names*

```diff
@@ -1,23 +1,23 @@
-/* Generated by Cython 3.0.8 */
+/* Generated by Cython 3.0.10 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ufuncobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include"
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include"
         ],
         "name": "pyseobnr.eob.utils.containers",
         "sources": [
             "pyseobnr/eob/utils/containers.pyx"
         ]
     },
     "module_name": "pyseobnr.eob.utils.containers"
@@ -44,18 +44,18 @@
     #error Cython requires Python 2.7+ or Python 3.3+.
 #else
 #if defined(CYTHON_LIMITED_API) && CYTHON_LIMITED_API
 #define __PYX_EXTRA_ABI_MODULE_NAME "limited"
 #else
 #define __PYX_EXTRA_ABI_MODULE_NAME ""
 #endif
-#define CYTHON_ABI "3_0_8" __PYX_EXTRA_ABI_MODULE_NAME
+#define CYTHON_ABI "3_0_10" __PYX_EXTRA_ABI_MODULE_NAME
 #define __PYX_ABI_MODULE_NAME "_cython_" CYTHON_ABI
 #define __PYX_TYPE_MODULE_PREFIX __PYX_ABI_MODULE_NAME "."
-#define CYTHON_HEX_VERSION 0x030008F0
+#define CYTHON_HEX_VERSION 0x03000AF0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(_WIN32) && !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -139,14 +139,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(PYPY_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #undef CYTHON_USE_TYPE_SLOTS
@@ -200,14 +202,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(CYTHON_LIMITED_API)
   #ifdef Py_LIMITED_API
     #undef __PYX_LIMITED_VERSION_HEX
     #define __PYX_LIMITED_VERSION_HEX Py_LIMITED_API
   #endif
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
@@ -261,60 +265,83 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(Py_GIL_DISABLED) || defined(Py_NOGIL)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_TYPE_SPECS
+    #define CYTHON_USE_TYPE_SPECS 0
+  #endif
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #ifndef CYTHON_USE_ASYNC_SLOTS
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_PYLONG_INTERNALS
+    #define CYTHON_USE_PYLONG_INTERNALS 0
+  #endif
   #undef CYTHON_USE_PYLIST_INTERNALS
   #define CYTHON_USE_PYLIST_INTERNALS 0
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
   #undef CYTHON_USE_UNICODE_WRITER
   #define CYTHON_USE_UNICODE_WRITER 0
-  #undef CYTHON_USE_PYLONG_INTERNALS
-  #define CYTHON_USE_PYLONG_INTERNALS 0
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
   #undef CYTHON_FAST_THREAD_STATE
   #define CYTHON_FAST_THREAD_STATE 0
+  #undef CYTHON_FAST_GIL
+  #define CYTHON_FAST_GIL 0
+  #ifndef CYTHON_METH_FASTCALL
+    #define CYTHON_METH_FASTCALL 1
+  #endif
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
+  #ifndef CYTHON_PEP487_INIT_SUBCLASS
+    #define CYTHON_PEP487_INIT_SUBCLASS 1
+  #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT 1
   #endif
+  #ifndef CYTHON_USE_MODULE_STATE
+    #define CYTHON_USE_MODULE_STATE 0
+  #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE 1
   #endif
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
@@ -397,14 +424,17 @@
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK 1
   #endif
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
   #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if !defined(CYTHON_VECTORCALL)
 #define CYTHON_VECTORCALL  (CYTHON_FAST_PYCCALL && PY_VERSION_HEX >= 0x030800B1)
 #endif
@@ -740,16 +770,21 @@
   #ifndef METH_FASTCALL
      #define METH_FASTCALL 0x80
   #endif
   typedef PyObject *(*__Pyx_PyCFunctionFast) (PyObject *self, PyObject *const *args, Py_ssize_t nargs);
   typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords) (PyObject *self, PyObject *const *args,
                                                           Py_ssize_t nargs, PyObject *kwnames);
 #else
-  #define __Pyx_PyCFunctionFast _PyCFunctionFast
-  #define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #if PY_VERSION_HEX >= 0x030d00A4
+  #  define __Pyx_PyCFunctionFast PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords PyCFunctionFastWithKeywords
+  #else
+  #  define __Pyx_PyCFunctionFast _PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #endif
 #endif
 #if CYTHON_METH_FASTCALL
   #define __Pyx_METH_FASTCALL METH_FASTCALL
   #define __Pyx_PyCFunction_FastCall __Pyx_PyCFunctionFast
   #define __Pyx_PyCFunction_FastCallWithKeywords __Pyx_PyCFunctionFastWithKeywords
 #else
   #define __Pyx_METH_FASTCALL METH_VARARGS
@@ -1093,15 +1128,15 @@
   #define __Pyx_PyList_SET_ITEM(o, i, v) PyList_SetItem(o, i, v)
   #define __Pyx_PyTuple_GET_SIZE(o) PyTuple_Size(o)
   #define __Pyx_PyList_GET_SIZE(o) PyList_Size(o)
   #define __Pyx_PySet_GET_SIZE(o) PySet_Size(o)
   #define __Pyx_PyBytes_GET_SIZE(o) PyBytes_Size(o)
   #define __Pyx_PyByteArray_GET_SIZE(o) PyByteArray_Size(o)
 #endif
-#if PY_VERSION_HEX >= 0x030d00A1
+#if __PYX_LIMITED_VERSION_HEX >= 0x030d00A1
   #define __Pyx_PyImport_AddModuleRef(name) PyImport_AddModuleRef(name)
 #else
   static CYTHON_INLINE PyObject *__Pyx_PyImport_AddModuleRef(const char *name) {
       PyObject *module = PyImport_AddModule(name);
       Py_XINCREF(module);
       return module;
   }
@@ -1180,15 +1215,15 @@
 #if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
 #define __Pyx_truncl trunc
 #else
 #define __Pyx_truncl truncl
 #endif
 
 #define __PYX_MARK_ERR_POS(f_index, lineno) \
-    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__; (void)__pyx_clineno; }
+    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__;  (void)__pyx_clineno; }
 #define __PYX_ERR(f_index, lineno, Ln_error) \
     { __PYX_MARK_ERR_POS(f_index, lineno) goto Ln_error; }
 
 #ifdef CYTHON_EXTERN_C
     #undef __PYX_EXTERN_C
     #define __PYX_EXTERN_C CYTHON_EXTERN_C
 #elif defined(__PYX_EXTERN_C)
@@ -1296,32 +1331,15 @@
 #define __Pyx_PyObject_AsSString(s)    ((const signed char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_AsUString(s)    ((const unsigned char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
 #define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
 #define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
 #define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
 #define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
-#if CYTHON_COMPILING_IN_LIMITED_API
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const wchar_t *u)
-{
-    const wchar_t *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#else
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
-{
-    const Py_UNICODE *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#endif
 #define __Pyx_PyUnicode_FromOrdinal(o)       PyUnicode_FromOrdinal((int)o)
-#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
-#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
 #define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
 #define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
 #define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
 static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
@@ -1654,177 +1672,177 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1862,42 +1880,42 @@
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams;
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams;
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":767
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":767
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":768
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":768
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":769
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":769
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":771
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":771
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -2804,30 +2822,30 @@
 
 /* SetupReduce.proto */
 #if !CYTHON_COMPILING_IN_LIMITED_API
 static int __Pyx_setup_reduce(PyObject* type_obj);
 #endif
 
 /* TypeImport.proto */
-#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_8
-#define __PYX_HAVE_RT_ImportType_proto_3_0_8
+#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_10
+#define __PYX_HAVE_RT_ImportType_proto_3_0_10
 #if defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L
 #include <stdalign.h>
 #endif
 #if (defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L) || __cplusplus >= 201103L
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) alignof(s)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) alignof(s)
 #else
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) sizeof(void*)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) sizeof(void*)
 #endif
-enum __Pyx_ImportType_CheckSize_3_0_8 {
-   __Pyx_ImportType_CheckSize_Error_3_0_8 = 0,
-   __Pyx_ImportType_CheckSize_Warn_3_0_8 = 1,
-   __Pyx_ImportType_CheckSize_Ignore_3_0_8 = 2
+enum __Pyx_ImportType_CheckSize_3_0_10 {
+   __Pyx_ImportType_CheckSize_Error_3_0_10 = 0,
+   __Pyx_ImportType_CheckSize_Warn_3_0_10 = 1,
+   __Pyx_ImportType_CheckSize_Ignore_3_0_10 = 2
 };
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size);
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size);
 #endif
 
 /* FetchSharedCythonModule.proto */
 static PyObject *__Pyx_FetchSharedCythonABIModule(void);
 
 /* FetchCommonType.proto */
 #if !CYTHON_USE_TYPE_SPECS
@@ -18490,261 +18508,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18753,29 +18771,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -18786,15 +18804,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -18803,29 +18821,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -18836,15 +18854,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -18853,29 +18871,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -18886,15 +18904,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -18903,29 +18921,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -18936,15 +18954,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -18953,29 +18971,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -18986,217 +19004,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":969
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":970
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":970
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 970, __pyx_L1_error)
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":973
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":975
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":975
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":976
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":976
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19212,15 +19230,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -19228,68 +19246,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":982
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":982
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 982, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":983
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":983
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 984, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 984, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19297,15 +19315,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -19320,15 +19338,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19344,15 +19362,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19360,68 +19378,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":988
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":988
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 988, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":989
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":989
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 990, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 990, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19429,15 +19447,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19452,15 +19470,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19476,15 +19494,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -19492,68 +19510,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":994
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":994
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 994, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":995
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":995
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":996
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":996
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 996, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 996, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -19561,15 +19579,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -19584,170 +19602,170 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1011
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1011
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1026
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1026
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1036
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1036
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1043
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1043
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1050
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1050
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -30433,26 +30451,26 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 984, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 990, __pyx_L1_error)
@@ -31068,41 +31086,41 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_0_8(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
+  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_0_10(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
   #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
-  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyTypeObject),
   #elif CYTHON_COMPILING_IN_LIMITED_API
-  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyTypeObject),
   #else
-  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyHeapTypeObject),
+  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyHeapTypeObject),
   #endif
-  __Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(4, 9, __pyx_L1_error)
+  __Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(4, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_5numpy_dtype = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArray_Descr),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 202, __pyx_L1_error)
-  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 225, __pyx_L1_error)
-  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayMultiIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 229, __pyx_L1_error)
-  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
-  __pyx_ptype_5numpy_generic = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 809, __pyx_L1_error)
-  __pyx_ptype_5numpy_number = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 811, __pyx_L1_error)
-  __pyx_ptype_5numpy_integer = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 813, __pyx_L1_error)
-  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 815, __pyx_L1_error)
-  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 817, __pyx_L1_error)
-  __pyx_ptype_5numpy_inexact = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 819, __pyx_L1_error)
-  __pyx_ptype_5numpy_floating = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 821, __pyx_L1_error)
-  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 823, __pyx_L1_error)
-  __pyx_ptype_5numpy_flexible = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 825, __pyx_L1_error)
-  __pyx_ptype_5numpy_character = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 827, __pyx_L1_error)
-  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyUFuncObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 866, __pyx_L1_error)
+  __pyx_ptype_5numpy_dtype = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArray_Descr),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 202, __pyx_L1_error)
+  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 225, __pyx_L1_error)
+  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayMultiIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 229, __pyx_L1_error)
+  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
+  __pyx_ptype_5numpy_generic = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 809, __pyx_L1_error)
+  __pyx_ptype_5numpy_number = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 811, __pyx_L1_error)
+  __pyx_ptype_5numpy_integer = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 813, __pyx_L1_error)
+  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 815, __pyx_L1_error)
+  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 817, __pyx_L1_error)
+  __pyx_ptype_5numpy_inexact = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 819, __pyx_L1_error)
+  __pyx_ptype_5numpy_floating = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 821, __pyx_L1_error)
+  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 823, __pyx_L1_error)
+  __pyx_ptype_5numpy_flexible = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 825, __pyx_L1_error)
+  __pyx_ptype_5numpy_character = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 827, __pyx_L1_error)
+  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyUFuncObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 866, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -35298,18 +35316,18 @@
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
 }
 #endif
 
 /* TypeImport */
-#ifndef __PYX_HAVE_RT_ImportType_3_0_8
-#define __PYX_HAVE_RT_ImportType_3_0_8
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size)
+#ifndef __PYX_HAVE_RT_ImportType_3_0_10
+#define __PYX_HAVE_RT_ImportType_3_0_10
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject *module, const char *module_name, const char *class_name,
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
     Py_ssize_t itemsize;
 #if CYTHON_COMPILING_IN_LIMITED_API
     PyObject *py_basicsize;
@@ -35355,23 +35373,23 @@
     if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize+itemsize);
         goto bad;
     }
-    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_8 &&
+    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_10 &&
             ((size_t)basicsize > size || (size_t)(basicsize + itemsize) < size)) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd-%zd from PyObject",
             module_name, class_name, size, basicsize, basicsize+itemsize);
         goto bad;
     }
-    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_8 && (size_t)basicsize > size) {
+    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_10 && (size_t)basicsize > size) {
         PyOS_snprintf(warning, sizeof(warning),
             "%s.%s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
     }
     return (PyTypeObject *)result;
@@ -36363,15 +36381,15 @@
         break;
     case 0:
         self = ((PyCFunctionObject*)cyfunc)->m_self;
         break;
     default:
         return NULL;
     }
-    return ((_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
+    return ((__Pyx_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
 }
 static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS_METHOD(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
 {
     __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
     PyMethodDef* def = ((PyCFunctionObject*)cyfunc)->m_ml;
     PyTypeObject *cls = (PyTypeObject *) __Pyx_CyFunction_GetClassObj(cyfunc);
 #if CYTHON_BACKPORT_VECTORCALL
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/utils/containers.pxd` & `pyseobnr-0.2.9/pyseobnr/eob/utils/containers.pxd`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/utils/containers.pyx` & `pyseobnr-0.2.9/pyseobnr/eob/utils/containers.pyx`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/utils/math_ops_opt.py` & `pyseobnr-0.2.9/pyseobnr/eob/utils/math_ops_opt.py`

 * *Files 23% similar despite different names*

```diff
@@ -1,18 +1,19 @@
 """
-Contains hand-written vector operations wrapped in numba for speed. 
-For small operations, i.e. involving just 2 vectors these are faster 
+Contains hand-written vector operations wrapped in numba for speed.
+For small operations, i.e. involving just 2 vectors these are faster
 than NumPy since they do not incur overheads.
 """
 
-import numpy as np
-from numba import jit
-from numba import float64
 from math import sqrt
 
+import numpy as np
+from numba import float64, jit
+
+
 @jit(float64[:](float64[:], float64[:]), cache=True, nopython=True)
 def my_cross(a, b):
     """
     Function to compute the cross product between two 3D arrays
 
     Args:
         a (np.ndarray): Array a
@@ -39,26 +40,26 @@
 
     Returns:
         (float): Dot product a.b
     """
 
     return a[0] * b[0] + a[1] * b[1] + a[2] * b[2]
 
+
 @jit(
-   float64(float64[:]),
-   cache=True,
-   nopython=True,
+    float64(float64[:]),
+    cache=True,
+    nopython=True,
 )
 def my_norm(a):
-
     """
     Function to compute the norm of a 3D array
 
     Args:
         a (np.ndarray): Array a
 
     Returns:
         (float): L2-norm of a
     """
-    norm = sqrt(a[0]*a[0] +  a[1]*a[1] +  a[2]*a[2])
+    norm = sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2])
 
-    return  norm
+    return norm
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/utils/utils_precession_opt.py` & `pyseobnr-0.2.9/pyseobnr/eob/utils/utils_precession_opt.py`

 * *Files 8% similar despite different names*

```diff
@@ -29,14 +29,15 @@
 def SEOBBuildJframeVectors(Jhat_final: np.ndarray):
     """
     This function computes the Jframe unit vectors, with e3J along Jhat.
     Convention: if (ex, ey, ez) is the initial I-frame, e1J chosen such that ex
     is in the plane (e1J, e3J) and ex.e1J>0.
     In the case where e3J and x happen to be close to aligned, we continuously
     switch to another prescription with y playing the role of x.
+
     Same operation as in SEOBBuildJframeVectors in
     https://git.ligo.org/lscsoft/lalsuite/-/blob/master/lalsimulation/lib/LALSimIMRSpinPrecEOBv4P.c#L2833
     LALSimIMRSpinPrecEOBv4P.c.
     See Appendix A of https://arxiv.org/abs/1607.05661v1
     and Sec. III B of https://arxiv.org/pdf/2004.09442v1.pdf for details.
 
     Args:
@@ -60,15 +61,14 @@
         print("Problem: lambda=1-|e3J.ex|=%f, should be in [0,1]" % lambda_fac)
 
     elif lambda_fac > 1e-4:
         normfacx = 1.0 / sqrt(1.0 - exdote3J * exdote3J)
 
         e1J = (exvec - exdote3J * e3J) / normfacx
     elif lambda_fac < 1e-5:
-
         normfacy = 1.0 / sqrt(1.0 - eydote3J * eydote3J)
         e1J = (eyvec - eydote3J * e3J) / normfacy
     else:
         weightx = (lambda_fac - 1e-5) / (1e-4 - 1e-5)
         weighty = 1.0 - weightx
         normfacx = 1.0 / sqrt(1.0 - exdote3J * exdote3J)
         normfacy = 1.0 / sqrt(1.0 - eydote3J * eydote3J)
@@ -86,15 +86,15 @@
     e1Jnorm = my_norm(e1J)
     e2Jnorm = my_norm(e2J)
     e3Jnorm = my_norm(e3J)
 
     e1J /= e1Jnorm
     e2J /= e2Jnorm
     e3J /= e3Jnorm
-    #print(f"e1J:{e1J},e2J:{e2J},e3J:{e3J}")
+    # print(f"e1J:{e1J},e2J:{e2J},e3J:{e3J}")
     return e1J, e2J, e3J
 
 
 def SEOBEulerJ2PFromDynamics(
     t: np.ndarray,
     omega: np.ndarray,
     LNhat: np.ndarray,
@@ -134,28 +134,27 @@
         # Still, check if LN is degenerate with x axis of the J frame
         dtprd2 = np.einsum("ij,j->i", LNhat, np.array([1, 0, 0.0]))
         if np.amin(np.abs(np.abs(dtprd2) - 1)) < 1e-3:
             # If not x, then y
             aux = quaternion.quaternion(0.0, 0.0, 1.0, 0.0)
     else:
         aux = None
-    
+
     # Note that because we are working in the J frame the final spin
     # direction is just along z axis, by definition.
     quatJ2P = minimal_quat(quaternion.z, LN_in_J_quat, aux, t, omega)
 
     return quatJ2P
 
 
 def SEOBRotatehIlmFromhJlm_opt_v1(
     w_hJlm: WaveformModes,
     modes_lmax: int,
     quatI2J: quaternion,
 ) -> WaveformModes:
-
     """
      This function computes the hIlm Re/Im timeseries (fixed sampling) from hJlm
      Re/Im timeseries (same sampling). This is a simple rotation,
      sample-by-sample, with constant Wigner coefficients.
 
      Args:
         w_hJlm (WaveformModes): WaveformModes object from the scri python package. It contains waveform modes in the final J-frame
@@ -189,15 +188,16 @@
      lowest overtone of the (2,2) and (2,1) QNM frequencies.
 
      Args:
         t_full (np.ndarray): Time array of the waveform modes.
         precRate (float): Precessing rate,  differences between the lowest overtone of the
                           (2,2) and (2,1) QNM frequencies. See Eq. (3.4) of 2004.09442.
         euler_angles_attach (np.ndarray): Euler angles (alpha,beta,gamma) at the attachment time.
-        euler_angles_derivative_attach (np.ndarray): Time derivative of the Euler angles (alpha,beta,gamma) at the attachment time.
+        euler_angles_derivative_attach (np.ndarray): Time derivative of the Euler angles (alpha,beta,gamma) at the
+            attachment time.
         t_attach (float): Attachment time of the dynamics and the ringdown
         idx (int): Index at which the attachment of the ringdown is performed
         rd_approx (bool): If True apply the approximation of the Euler angles, if False use constant angles
         rd_smoothing (bool): If True apply smoothing of the Euler angles, if False do not apply the smoothing
         beta_approx (int): If 0 use constant beta angle, otherwise use small opening angle approximation
 
     Returns:
@@ -205,56 +205,98 @@
     """
     alphaAttach, betaAttach, gammaAttach = euler_angles_attach
     t_RD = t_full[idx[-1] + 1 :]
 
     # Approximate the Euler angles assuming simple precession
     if rd_approx:
         if rd_smoothing:
+            # Smoothing: dalpha/dt and dgamma/dt are windowed with a Tanh function. The expressions for alpha and gamma
+            # are the integral of the windowed derivative
+            idx_smoothing = (
+                60  # The window is expensive so only applied on a subset of points
+            )
 
-            # Smoothing: dalpha/dt and dgamma/dt are windowed with a Tanh function. The expressions for alpha and gamma are the integral of the windowed derivative
-            idx_smoothing = 60 # The window is expensive so only applied on a subset of points
-
-            t_smooth = (t_full[idx[-1] + 1 : idx[-1] + 1 + idx_smoothing] - t_attach)
+            t_smooth = t_full[idx[-1] + 1 : idx[-1] + 1 + idx_smoothing] - t_attach
 
             # Parameters needed for the window
             dalphaAttach, dbetaAttach, dgammaAttach = euler_angles_derivative_attach
             dalphaRD = precRate
-            dgammaRD = -cos(betaAttach)*precRate
+            dgammaRD = -cos(betaAttach) * precRate
             sigma = 2.5
-            ti = 2.
+            ti = 2.0
 
             # Offsets to ensure continuity
-            t_offset = 0.0#t_smooth[0]
-            alpha_smooth_offset = 0.5*dalphaAttach*t_offset + 0.5*dalphaRD*t_offset + (-0.125*dalphaAttach*sigma + 0.125*dalphaRD*sigma)*np.log(np.cosh((4.*(t_offset - 1.*ti))/sigma))
-            gamma_smooth_offset = 0.5*dgammaAttach*t_offset + 0.5*dgammaRD*t_offset + (-0.125*dgammaAttach*sigma + 0.125*dgammaRD*sigma)*np.log(np.cosh((4.*(t_offset - 1.*ti))/sigma))
+            t_offset = 0.0  # t_smooth[0]
+            alpha_smooth_offset = (
+                0.5 * dalphaAttach * t_offset
+                + 0.5 * dalphaRD * t_offset
+                + (-0.125 * dalphaAttach * sigma + 0.125 * dalphaRD * sigma)
+                * np.log(np.cosh((4.0 * (t_offset - 1.0 * ti)) / sigma))
+            )
+            gamma_smooth_offset = (
+                0.5 * dgammaAttach * t_offset
+                + 0.5 * dgammaRD * t_offset
+                + (-0.125 * dgammaAttach * sigma + 0.125 * dgammaRD * sigma)
+                * np.log(np.cosh((4.0 * (t_offset - 1.0 * ti)) / sigma))
+            )
 
             # alpha and gamma smoothened
-            alphaJ2P = alphaAttach - alpha_smooth_offset + 0.5*dalphaAttach*t_smooth + 0.5*dalphaRD*t_smooth + (-0.125*dalphaAttach*sigma + 0.125*dalphaRD*sigma)*np.log(np.cosh((4.*(t_smooth - 1.*ti))/sigma))
-            gammaJ2P = gammaAttach - gamma_smooth_offset + 0.5*dgammaAttach*t_smooth + 0.5*dgammaRD*t_smooth + (-0.125*dgammaAttach*sigma + 0.125*dgammaRD*sigma)*np.log(np.cosh((4.*(t_smooth - 1.*ti))/sigma))
+            alphaJ2P = (
+                alphaAttach
+                - alpha_smooth_offset
+                + 0.5 * dalphaAttach * t_smooth
+                + 0.5 * dalphaRD * t_smooth
+                + (-0.125 * dalphaAttach * sigma + 0.125 * dalphaRD * sigma)
+                * np.log(np.cosh((4.0 * (t_smooth - 1.0 * ti)) / sigma))
+            )
+            gammaJ2P = (
+                gammaAttach
+                - gamma_smooth_offset
+                + 0.5 * dgammaAttach * t_smooth
+                + 0.5 * dgammaRD * t_smooth
+                + (-0.125 * dgammaAttach * sigma + 0.125 * dgammaRD * sigma)
+                * np.log(np.cosh((4.0 * (t_smooth - 1.0 * ti)) / sigma))
+            )
 
             # Time array for evaluating the unwindowed RD approximation
-            t_RD = t_full[idx[-1] +idx_smoothing + 1 : ]
+            t_RD = t_full[idx[-1] + idx_smoothing + 1 :]
 
             # Ensure continuity between windowed and unwindowed regions
             t_attach_2 = t_RD[0] - t_attach
-            alphaAttach2 = alphaAttach - alpha_smooth_offset + 0.5*dalphaAttach*t_attach_2 + 0.5*dalphaRD*t_attach_2 + (-0.125*dalphaAttach*sigma + 0.125*dalphaRD*sigma)*np.log(np.cosh((4.*(t_attach_2 - 1.*ti))/sigma))
-            gammaAttach2 = gammaAttach - gamma_smooth_offset + 0.5*dgammaAttach*t_attach_2 + 0.5*dgammaRD*t_attach_2 + (-0.125*dgammaAttach*sigma + 0.125*dgammaRD*sigma)*np.log(np.cosh((4.*(t_attach_2 - 1.*ti))/sigma))
+            alphaAttach2 = (
+                alphaAttach
+                - alpha_smooth_offset
+                + 0.5 * dalphaAttach * t_attach_2
+                + 0.5 * dalphaRD * t_attach_2
+                + (-0.125 * dalphaAttach * sigma + 0.125 * dalphaRD * sigma)
+                * np.log(np.cosh((4.0 * (t_attach_2 - 1.0 * ti)) / sigma))
+            )
+            gammaAttach2 = (
+                gammaAttach
+                - gamma_smooth_offset
+                + 0.5 * dgammaAttach * t_attach_2
+                + 0.5 * dgammaRD * t_attach_2
+                + (-0.125 * dgammaAttach * sigma + 0.125 * dgammaRD * sigma)
+                * np.log(np.cosh((4.0 * (t_attach_2 - 1.0 * ti)) / sigma))
+            )
 
-            #Evaluate unwindowed ringdown approximation
+            # Evaluate unwindowed ringdown approximation
             t_attach_RD = t_RD[0]
             t_full += t_full[0]
 
             cosbetaAttach = cos(betaAttach)
             tmp = (t_RD - t_attach_RD) * precRate
-            alphaJ2P = np.append(alphaJ2P,alphaAttach2 + tmp)
+            alphaJ2P = np.append(alphaJ2P, alphaAttach2 + tmp)
 
-            betaJ2P = np.ones(len(t_smooth)+len(t_RD)) *betaAttach
-            #betaJ2P = betaAttach + (t_full[idx[-1] + 1 :] - t_attach) * dbetaAttach
+            betaJ2P = np.ones(len(t_smooth) + len(t_RD)) * betaAttach
+            # betaJ2P = betaAttach + (t_full[idx[-1] + 1 :] - t_attach) * dbetaAttach
 
-            gammaJ2P = np.append(gammaJ2P,gammaAttach2 - cosbetaAttach * (t_RD - t_attach_RD) * precRate)
+            gammaJ2P = np.append(
+                gammaJ2P, gammaAttach2 - cosbetaAttach * (t_RD - t_attach_RD) * precRate
+            )
 
         else:
             t_RD = t_full[idx[-1] + 1 :]
             t_full += t_full[0]
 
             cosbetaAttach = cos(betaAttach)
             tmp = (t_RD - t_attach) * precRate
@@ -269,15 +311,14 @@
             gammaJ2P = gammaAttach - cosbetaAttach * (t_RD - t_attach) * precRate
 
         alphaJ2P = np.unwrap(alphaJ2P)
         betaJ2P = np.unwrap(betaJ2P)
         gammaJ2P = np.unwrap(gammaJ2P)
 
     else:
-
         t_RD = t_full[idx[-1] + 1 :]
         alphaJ2P = np.ones(len(t_RD)) * alphaAttach
         betaJ2P = np.ones(len(t_RD)) * betaAttach
         gammaJ2P = np.ones(len(t_RD)) * gammaAttach
 
     euler_angles_v1 = np.transpose([alphaJ2P, betaJ2P, gammaJ2P])
     quat_postMerger = quaternion.from_euler_angles(
@@ -286,18 +327,18 @@
 
     return quat_postMerger
 
 
 def minimal_rotation_mine(
     R: quaternion.quaternion,
     t: quaternion.quaternion,
-    v:quaternion.quaternion,
+    v: quaternion.quaternion,
     omega: np.ndarray,
     domega: np.ndarray,
-    iterations: int=2
+    iterations: int = 2,
 ):
     """
     Adjust frame so that there is no rotation about z' axis.
     The output of this function is a frame that rotates the z axis onto the same z' axis as the
     input frame, but with minimal rotation about that axis.  This is done by pre-composing the input
     rotation with a rotation about the z axis through an angle gamma, where
         dgamma/dt = 2*(dR/dt * z * R.conjugate()).w
@@ -343,15 +384,15 @@
 
 
 def minimal_quat(
     v_final: quaternion.quaternion,
     V: quaternion.quaternion,
     aux: quaternion.quaternion,
     t_dyn: np.ndarray,
-    omega: np.ndarray
+    omega: np.ndarray,
 ):
     """
     Compute the rotation that aligns V with v_final
     and obeys the minimal rotation condition.
 
     Args:
         v_final (quaternion.quaternion): z-axis quaternion of the final spin frame.
@@ -428,44 +469,42 @@
     rotJ_matrix = np.vstack([e1J, e2J, e3J]).T
     quatI2J = quaternion.from_rotation_matrix(rotJ_matrix)
 
     # The inverse transformation, J->I
     quatJ2I = quatI2J.conjugate()
     alpha_J2I, beta_J2I, gamma_J2I = quaternion.as_euler_angles(quatJ2I)
 
-
-
     quatJ2P_dyn = SEOBEulerJ2PFromDynamics(t_dynamics, omega_dynamics, LN_in_J)
     # Compute Euler angles from the quaternions
-    #eAngles_min = quaternion.as_euler_angles(quatJ2P_dyn).T
+    # eAngles_min = quaternion.as_euler_angles(quatJ2P_dyn).T
 
-    #gammaJ2P_dyn = np.unwrap(eAngles_min[2])
+    # gammaJ2P_dyn = np.unwrap(eAngles_min[2])
 
     # We still have the residual freedom from minimal rotation condition to perform a
     # global rotation around the J_f . We fix this freedom by demanding that
     # at the reference time, the *I2P* map is the identity, i.e. the
     # inertial frame and co-precessing frame are the same. To do so,
     # we only need to ensure that at t_ref, gammaJ2P is the same as
     # gamma_J2I.
     # NB: due to quaternions being a double cover of SO(3), q and -q
     # are the same rotation.
 
     if t_ref is None:
-        #gamma_ref = gammaJ2P_dyn[0]
+        # gamma_ref = gammaJ2P_dyn[0]
         q2JP_ref = quatJ2P_dyn[0]
     else:
-        #igammaJ2P_dyn = CubicSpline(t_dynamics, gammaJ2P_dyn)
-        #gamma_ref = igammaJ2P_dyn(t_ref)
-        q2JP_ref = quaternion.squad(quatJ2P_dyn,t_dynamics,t_ref)
+        # igammaJ2P_dyn = CubicSpline(t_dynamics, gammaJ2P_dyn)
+        # gamma_ref = igammaJ2P_dyn(t_ref)
+        q2JP_ref = quaternion.squad(quatJ2P_dyn, t_dynamics, t_ref)
 
     # We need to shift things so that gamma_J2P = gamma_J2I at reference time
     # The following is a rotation around final J
-    #quatJ2P_dyn2 = quatJ2P_dyn*np.exp((-gamma_ref / 2 + gamma_J2I / 2) * quaternion.z)
+    # quatJ2P_dyn2 = quatJ2P_dyn*np.exp((-gamma_ref / 2 + gamma_J2I / 2) * quaternion.z)
 
-    shift = q2JP_ref.conjugate()*quatJ2I
+    shift = q2JP_ref.conjugate() * quatJ2I
     quatJ2P_dyn *= shift
 
     eAngles_min = quaternion.as_euler_angles(quatJ2P_dyn).T
     alphaJ2P_dyn = np.unwrap(eAngles_min[0])
     betaJ2P_dyn = np.unwrap(eAngles_min[1])
     gammaJ2P_dyn = np.unwrap(eAngles_min[2])
 
@@ -474,25 +513,35 @@
     igammaJ2P_dyn = CubicSpline(t_dynamics, gammaJ2P_dyn)
 
     alpha_attach = ialphaJ2P_dyn(t_attach)
     beta_attach = ibetaJ2P_dyn(t_attach)
     gamma_attach = igammaJ2P_dyn(t_attach)
 
     euler_angles_attach = [alpha_attach, beta_attach, gamma_attach]
-    euler_angles_derivative_attach = [ialphaJ2P_dyn.derivative()(t_attach), ibetaJ2P_dyn.derivative()(t_attach), igammaJ2P_dyn.derivative()(t_attach)]
-
+    euler_angles_derivative_attach = [
+        ialphaJ2P_dyn.derivative()(t_attach),
+        ibetaJ2P_dyn.derivative()(t_attach),
+        igammaJ2P_dyn.derivative()(t_attach),
+    ]
 
     # Compute sign from the angle between the final total and orbital angular momenta to check if we
     # are in the prograde or retrograde case
     cos_angle = my_dot(Jf_hat_v5, Lf_hat_v5)
     flip = 1
     if cos_angle < 0:
         flip = -1
 
-    return t_dynamics, quatJ2P_dyn, quatI2J, euler_angles_attach,euler_angles_derivative_attach,flip
+    return (
+        t_dynamics,
+        quatJ2P_dyn,
+        quatI2J,
+        euler_angles_attach,
+        euler_angles_derivative_attach,
+        flip,
+    )
 
 
 def compute_omegalm_P_frame(omegalm: complex, m: int, rotation_term: float):
     """
     Function to compute the co-precessing frame QNM frequencies
     from the J-frame QNMs as described in arXiv:2301.06558.
 
@@ -589,15 +638,18 @@
         sBH7 = sBH6 * sBH
         expGamma5 = expGamma4 * expGamma
         swsh[5, 5] = -np.sqrt(330.0 / np.pi) * cBH7 * sBH3 * expGamma5
         swsh[5, -5] = np.sqrt(330.0 / np.pi) * sBH7 * cBH3 / expGamma5
 
     return swsh
 
-def interpolate_quats(quat: quaternion.quaternion, t_intrp: np.ndarray, t_full: np.ndarray):
+
+def interpolate_quats(
+    quat: quaternion.quaternion, t_intrp: np.ndarray, t_full: np.ndarray
+):
     """
     Function to interpolate the quaternions from the co-precessing frame to the final
     J-frame into the equal-spacing and finer time grid of the waveform modes
 
     Args:
         quat (quaternion): Quaternion from the co-precessing frame to the final J-frame
         t_intrp (np.ndarray): Time array of the EOB dynamics
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/waveform/compute_MR.py` & `pyseobnr-0.2.9/pyseobnr/eob/waveform/compute_MR.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/waveform/compute_hlms.py` & `pyseobnr-0.2.9/pyseobnr/eob/waveform/compute_hlms.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,28 +1,36 @@
 """
 Contains functions associated with waveform construction, mostly for merger-ringdown.
 """
 
 from copy import deepcopy
 from typing import Any, Dict
 
-import numpy as jnp
+import numpy as np
 from lalinference.imrtgr import nrutils
 from pygsl_lite import spline
-from pyseobnr.auxiliary.mode_mixing.auxiliary_functions_modemixing import *
-from scipy.interpolate import CubicSpline, InterpolatedUnivariateSpline
-from scipy.optimize import root_scalar
-from scipy.signal import argrelmax, argrelmin
+from scipy.interpolate import InterpolatedUnivariateSpline
 
-from ..fits.EOB_fits import *
+from ...auxiliary.mode_mixing.auxiliary_functions_modemixing import (
+    h_ellm0_nu,
+    hdot_ellm0_nu,
+    mu,
+    omega_ellm0,
+    phi_ellm0,
+)
+from ..fits.EOB_fits import (
+    EOBCalculateNQCCoefficients_freeattach,
+    EOBNonQCCorrection,
+    compute_QNM,
+)
 from ..fits.IV_fits import InputValueFits
 from ..fits.MR_fits import MergerRingdownFits
-from ..waveform.waveform import *
-from .compute_MR import compute_MR_mode_free
 from ..utils.utils_precession_opt import compute_omegalm_P_frame
+from .compute_MR import compute_MR_mode_free
+from .waveform import compute_factors, unrotate_leading_pn
 
 
 def concatenate_modes(hlms_1: Dict[Any, Any], hlms_2: Dict[Any, Any]) -> Dict[Any, Any]:
     """Concatenate 2 dictionaries of waveform modes
 
     This is used to put together the low and fine sampling waveform modes.
 
@@ -124,15 +132,16 @@
         chi2 (float): z-component of the secondary dimensionless spin
         t_attach (float): Attachment time
         f_nyquist (float): Nyquist frequency, needed for checking that RD frequency is resolved
         lmax_nyquist (int): Determines for which modes the nyquist test is applied for
         mixed_modes (List): List of mixed modes to consider. Defaults to [(3,2),(4,3)]
         final_state (List): Final mass and spin of the remnant. Default to None. If None,
                             compute internally.
-        qnm_rotation (float): Factor rotating the QNM mode frequency in the co-precessing frame (Eq. 33 of Hamilton et al.)
+        qnm_rotation (float): Factor rotating the QNM mode frequency in the co-precessing frame
+                            (Eq. 33 of Hamilton et al.)
 
     Returns:
         dict: Dictionary containing the waveform modes
     """
 
     # We want to attach the ringdown always at the same time,
     # regardless of the sampling rate, i.e. all the functions
@@ -145,40 +154,39 @@
 
     # First find the closest point on the time grid which is
     # *before* the attachment time. We do this twice,
     # because for the (5,5) mode the attachment time is
     # different from other modes
 
     # All modes except (5,5)
-    idx = jnp.argmin(jnp.abs(t - t_attach))
+    idx = np.argmin(np.abs(t - t_attach))
     if t[idx] > t_attach:
         idx -= 1
 
     # Time at the grid-point just before the attachment point
     t_match = t[idx]
 
     # (5,5) mode
-    idx_55 = jnp.argmin(jnp.abs(t - (t_attach - 10)))
+    idx_55 = np.argmin(np.abs(t - (t_attach - 10)))
     if t[idx_55] > t_attach - 10:
         idx_55 -= 1
     t_match_55 = t[idx_55]
 
     # The time spacing. This assumes that we have already
     # interpolated the modes to equal spacing
     dt = np.diff(t)[0]
-    N = int(10 / dt) + 1
+    # N = int(10 / dt) + 1
 
     # Figure out the duration of the ringdown. Taken to be 30
     # times the damping time of the (2,2) mode
     # To compute QNM, get the final mass and spin
 
     if final_state:
         final_mass, final_spin = final_state
     else:
-
         final_mass = nrutils.bbh_final_mass_non_precessing_UIB2016(m1, m2, chi1, chi2)
         final_spin = nrutils.bbh_final_spin_non_precessing_HBR2016(
             m1, m2, chi1, chi2, version="M3J4"
         )
 
     omega_complex = compute_QNM(2, 2, 0, final_spin, final_mass).conjugate()
 
@@ -190,16 +198,16 @@
 
     # Construct the array on which the ringdown signal is computed
     # Note: since we are attaching at the *actual* attachment point
     # which will fall *between* grid points we need to add an offset
     # to the ringdown time-series so that ansatze in the ringdown is
     # correctly evaluated.
 
-    t_ringdown = jnp.arange(0, ringdown_time, dt) + (t_match + dt - t_attach)
-    t_ringdown_55 = jnp.arange(0, ringdown_time, dt) + (
+    t_ringdown = np.arange(0, ringdown_time, dt) + (t_match + dt - t_attach)
+    t_ringdown_55 = np.arange(0, ringdown_time, dt) + (
         t_match_55 + dt - (t_attach - 10)
     )
 
     # Get the fits for the MR ansatze
     MR_fits = MergerRingdownFits(m1, m2, [0.0, 0.0, chi1], [0.0, 0.0, chi2])
     fits_dict = dict(
         c1f=MR_fits.c1f(), c2f=MR_fits.c2f(), d1f=MR_fits.d1f(), d2f=MR_fits.d2f()
@@ -216,16 +224,16 @@
             t_ring = t_ringdown_55
         else:
             t_a = 1 * t_attach
             idx_end = idx
             t_ring = t_ringdown
         ell, m = ell_m
 
-        amp = jnp.abs(mode)
-        phase = jnp.unwrap(jnp.angle(mode))
+        amp = np.abs(mode)
+        phase = np.unwrap(np.angle(mode))
 
         idx_interp = np.argmin(np.abs(t_for_compute - t_a))
         left = np.max((0, idx_interp - N_interp))
         right = np.min((idx_interp + N_interp, len(t_for_compute)))
 
         intrp_amp = InterpolatedUnivariateSpline(
             t_for_compute[left:right], amp[left:right]
@@ -349,15 +357,16 @@
         final_mass (float): mass of the remnant
         final_spin (float): dimensionless spin of the remnant
         t_match (float): inspiral time at which the merger-ringdown waveform is attached
         t_ringdown (np.ndarray): ringdown time array
         fits_dict (dict): dictionary of fit coefficients in the ringdown anzatz
         f_nyquist (float): Nyquist frequency, needed for checking that RD frequency is resolved
         lmax_nyquist (int): Determines for which modes the nyquist test is applied for
-        qnm_rotation (float): Factor rotating the QNM mode frequency in the co-precessing frame (Eq. 33 of Hamilton et al.)
+        qnm_rotation (float): Factor rotating the QNM mode frequency in the co-precessing
+                              frame (Eq. 33 of Hamilton et al.)
 
 
     Returns:
         np.ndarray: the merger-ringdown waveform for the mixed modes
 
     """
     # Get spheroidal input values
@@ -381,26 +390,26 @@
     # to NQC input values
 
     # First the (ell,m) mode
     idx_match = np.argmin(np.abs(t - t_match))
     N = 5
     left = np.max((0, idx_match - N))
     right = np.min((idx_match + N, len(t)))
-    amp = jnp.abs(mode_lm)
-    phase = jnp.unwrap(jnp.angle(mode_lm))
+    amp = np.abs(mode_lm)
+    phase = np.unwrap(np.angle(mode_lm))
     intrp_amp = InterpolatedUnivariateSpline(t[left:right], amp[left:right])
     intrp_phase = InterpolatedUnivariateSpline(t[left:right], phase[left:right])
     h = intrp_amp(t_match)
     hd = intrp_amp.derivative()(t_match)
     phi_lm = intrp_phase(t_match)
     om = intrp_phase.derivative()(t_match)
 
     # Now the (m,m) mode
-    amp = jnp.abs(mode_mm)
-    phase = jnp.unwrap(jnp.angle(mode_mm))
+    amp = np.abs(mode_mm)
+    phase = np.unwrap(np.angle(mode_mm))
     intrp_amp = InterpolatedUnivariateSpline(t[left:right], amp[left:right])
     intrp_phase = InterpolatedUnivariateSpline(t[left:right], phase[left:right])
     h_mm = intrp_amp(t_match)
     hd_mm = intrp_amp.derivative()(t_match)
     phi_mm = intrp_phase(t_match)
     om_mm = intrp_phase.derivative()(t_match)
 
@@ -562,26 +571,27 @@
         phase = np.unwrap(np.angle(mode))
         ell, m = ell_m
         if ell == 5 and m == 5:
             # (5,5) mode is special
             extra = -10
         else:
             extra = 0
-        # NQC_coeffs = EOBCalculateNQCCoefficientsV4(amp,phase,r,pr,omega_orb,ell,m,t_peak,t_modes,m1,m2,chi1,chi2)
+        # NQC_coeffs = EOBCalculateNQCCoefficientsV4(
+        #     amp, phase, r, pr, omega_orb, ell, m, t_peak, t_modes, m1, m2, chi1, chi2
+        # )
         # For equal mass, non-spinning cases odd m modes vanish, so don't try to compute NQCs
         if (
             m % 2
             and np.abs(m_1 - m_2) < 1e-4
             and np.abs(chi_1) < 1e-4
             and np.abs(chi_2) < 1e-4
         ) or (m % 2 and np.abs(m_1 - m_2) < 1e-4 and np.abs(chi_1 - chi_2) < 1e-4):
             continue
 
         else:
-
             # Compute the NQC coeffs
             NQC_coeffs = EOBCalculateNQCCoefficients_freeattach(
                 amp,
                 phase,
                 r,
                 pr,
                 omega_orb,
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/waveform/waveform.c` & `pyseobnr-0.2.9/pyseobnr/eob/waveform/waveform.c`

 * *Files 1% similar despite different names*

```diff
@@ -1,26 +1,26 @@
-/* Generated by Cython 3.0.8 */
+/* Generated by Cython 3.0.10 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/arrayobject.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/arrayscalars.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ndarrayobject.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ndarraytypes.h",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include/numpy/ufuncobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/arrayobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/arrayscalars.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ndarrayobject.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ndarraytypes.h",
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include/numpy/ufuncobject.h",
             "pyseobnr/eob/utils/eob_parameters.h"
         ],
         "extra_compile_args": [
             "-O3"
         ],
         "include_dirs": [
             "pyseobnr/eob/utils",
-            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/core/include"
+            "/private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/core/include"
         ],
         "name": "pyseobnr.eob.waveform.waveform",
         "sources": [
             "pyseobnr/eob/waveform/waveform.pyx"
         ]
     },
     "module_name": "pyseobnr.eob.waveform.waveform"
@@ -47,18 +47,18 @@
     #error Cython requires Python 2.7+ or Python 3.3+.
 #else
 #if defined(CYTHON_LIMITED_API) && CYTHON_LIMITED_API
 #define __PYX_EXTRA_ABI_MODULE_NAME "limited"
 #else
 #define __PYX_EXTRA_ABI_MODULE_NAME ""
 #endif
-#define CYTHON_ABI "3_0_8" __PYX_EXTRA_ABI_MODULE_NAME
+#define CYTHON_ABI "3_0_10" __PYX_EXTRA_ABI_MODULE_NAME
 #define __PYX_ABI_MODULE_NAME "_cython_" CYTHON_ABI
 #define __PYX_TYPE_MODULE_PREFIX __PYX_ABI_MODULE_NAME "."
-#define CYTHON_HEX_VERSION 0x030008F0
+#define CYTHON_HEX_VERSION 0x03000AF0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(_WIN32) && !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -142,14 +142,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(PYPY_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #undef CYTHON_USE_TYPE_SLOTS
@@ -203,14 +205,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(CYTHON_LIMITED_API)
   #ifdef Py_LIMITED_API
     #undef __PYX_LIMITED_VERSION_HEX
     #define __PYX_LIMITED_VERSION_HEX Py_LIMITED_API
   #endif
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
@@ -264,60 +268,83 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(Py_GIL_DISABLED) || defined(Py_NOGIL)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_TYPE_SPECS
+    #define CYTHON_USE_TYPE_SPECS 0
+  #endif
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #ifndef CYTHON_USE_ASYNC_SLOTS
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_PYLONG_INTERNALS
+    #define CYTHON_USE_PYLONG_INTERNALS 0
+  #endif
   #undef CYTHON_USE_PYLIST_INTERNALS
   #define CYTHON_USE_PYLIST_INTERNALS 0
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
   #undef CYTHON_USE_UNICODE_WRITER
   #define CYTHON_USE_UNICODE_WRITER 0
-  #undef CYTHON_USE_PYLONG_INTERNALS
-  #define CYTHON_USE_PYLONG_INTERNALS 0
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
   #undef CYTHON_FAST_THREAD_STATE
   #define CYTHON_FAST_THREAD_STATE 0
+  #undef CYTHON_FAST_GIL
+  #define CYTHON_FAST_GIL 0
+  #ifndef CYTHON_METH_FASTCALL
+    #define CYTHON_METH_FASTCALL 1
+  #endif
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
+  #ifndef CYTHON_PEP487_INIT_SUBCLASS
+    #define CYTHON_PEP487_INIT_SUBCLASS 1
+  #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT 1
   #endif
+  #ifndef CYTHON_USE_MODULE_STATE
+    #define CYTHON_USE_MODULE_STATE 0
+  #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE 1
   #endif
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
@@ -400,14 +427,17 @@
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK 1
   #endif
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
   #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if !defined(CYTHON_VECTORCALL)
 #define CYTHON_VECTORCALL  (CYTHON_FAST_PYCCALL && PY_VERSION_HEX >= 0x030800B1)
 #endif
@@ -743,16 +773,21 @@
   #ifndef METH_FASTCALL
      #define METH_FASTCALL 0x80
   #endif
   typedef PyObject *(*__Pyx_PyCFunctionFast) (PyObject *self, PyObject *const *args, Py_ssize_t nargs);
   typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords) (PyObject *self, PyObject *const *args,
                                                           Py_ssize_t nargs, PyObject *kwnames);
 #else
-  #define __Pyx_PyCFunctionFast _PyCFunctionFast
-  #define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #if PY_VERSION_HEX >= 0x030d00A4
+  #  define __Pyx_PyCFunctionFast PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords PyCFunctionFastWithKeywords
+  #else
+  #  define __Pyx_PyCFunctionFast _PyCFunctionFast
+  #  define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
+  #endif
 #endif
 #if CYTHON_METH_FASTCALL
   #define __Pyx_METH_FASTCALL METH_FASTCALL
   #define __Pyx_PyCFunction_FastCall __Pyx_PyCFunctionFast
   #define __Pyx_PyCFunction_FastCallWithKeywords __Pyx_PyCFunctionFastWithKeywords
 #else
   #define __Pyx_METH_FASTCALL METH_VARARGS
@@ -1096,15 +1131,15 @@
   #define __Pyx_PyList_SET_ITEM(o, i, v) PyList_SetItem(o, i, v)
   #define __Pyx_PyTuple_GET_SIZE(o) PyTuple_Size(o)
   #define __Pyx_PyList_GET_SIZE(o) PyList_Size(o)
   #define __Pyx_PySet_GET_SIZE(o) PySet_Size(o)
   #define __Pyx_PyBytes_GET_SIZE(o) PyBytes_Size(o)
   #define __Pyx_PyByteArray_GET_SIZE(o) PyByteArray_Size(o)
 #endif
-#if PY_VERSION_HEX >= 0x030d00A1
+#if __PYX_LIMITED_VERSION_HEX >= 0x030d00A1
   #define __Pyx_PyImport_AddModuleRef(name) PyImport_AddModuleRef(name)
 #else
   static CYTHON_INLINE PyObject *__Pyx_PyImport_AddModuleRef(const char *name) {
       PyObject *module = PyImport_AddModule(name);
       Py_XINCREF(module);
       return module;
   }
@@ -1183,15 +1218,15 @@
 #if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
 #define __Pyx_truncl trunc
 #else
 #define __Pyx_truncl truncl
 #endif
 
 #define __PYX_MARK_ERR_POS(f_index, lineno) \
-    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__; (void)__pyx_clineno; }
+    { __pyx_filename = __pyx_f[f_index]; (void)__pyx_filename; __pyx_lineno = lineno; (void)__pyx_lineno; __pyx_clineno = __LINE__;  (void)__pyx_clineno; }
 #define __PYX_ERR(f_index, lineno, Ln_error) \
     { __PYX_MARK_ERR_POS(f_index, lineno) goto Ln_error; }
 
 #ifdef CYTHON_EXTERN_C
     #undef __PYX_EXTERN_C
     #define __PYX_EXTERN_C CYTHON_EXTERN_C
 #elif defined(__PYX_EXTERN_C)
@@ -1301,32 +1336,15 @@
 #define __Pyx_PyObject_AsSString(s)    ((const signed char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_AsUString(s)    ((const unsigned char*) __Pyx_PyObject_AsString(s))
 #define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
 #define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
 #define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
 #define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
 #define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
-#if CYTHON_COMPILING_IN_LIMITED_API
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const wchar_t *u)
-{
-    const wchar_t *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#else
-static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
-{
-    const Py_UNICODE *u_end = u;
-    while (*u_end++) ;
-    return (size_t)(u_end - u - 1);
-}
-#endif
 #define __Pyx_PyUnicode_FromOrdinal(o)       PyUnicode_FromOrdinal((int)o)
-#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
-#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
 #define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
 #define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
 #define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
 static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
@@ -1659,204 +1677,186 @@
   Py_ssize_t strides[8];
   Py_ssize_t suboffsets[8];
 } __Pyx_memviewslice;
 #define __Pyx_MemoryView_Len(m)  (m.shape[0])
 
 /* #### Code section: numeric_typedefs ### */
 
-/* "scipy/linalg/cython_blas.pxd":15
- * # The original libraries should be linked directly.
- * 
- * ctypedef float s             # <<<<<<<<<<<<<<
- * ctypedef double d
- * ctypedef float complex c
- */
-typedef float __pyx_t_5scipy_6linalg_11cython_blas_s;
-
-/* "scipy/linalg/cython_blas.pxd":16
- * 
- * ctypedef float s
- * ctypedef double d             # <<<<<<<<<<<<<<
- * ctypedef float complex c
- * ctypedef double complex z
- */
-typedef double __pyx_t_5scipy_6linalg_11cython_blas_d;
-
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":730
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":730
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":731
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":731
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":732
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":732
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":733
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":733
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":737
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":737
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":738
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":738
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":739
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":739
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":740
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":740
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":744
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":744
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":745
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":745
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":754
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":754
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":755
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":755
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":757
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":757
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":758
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":758
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":760
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":760
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":761
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":761
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":763
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":763
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":764
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":764
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":765
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":765
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
 
-/* "pyseobnr/eob/waveform/waveform.pyx":100
+/* "pyseobnr/eob/waveform/waveform.pyx":107
  * 
  * DTYPE = np.float64
  * ctypedef np.float64_t DTYPE_T             # <<<<<<<<<<<<<<
  * 
  * DTYPE_c = np.complex128
  */
 typedef __pyx_t_5numpy_float64_t __pyx_t_8pyseobnr_3eob_8waveform_8waveform_DTYPE_T;
@@ -1895,14 +1895,50 @@
 struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams;
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce;
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
+
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":767
+ * ctypedef npy_longdouble longdouble_t
+ * 
+ * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_cdouble     cdouble_t
+ * ctypedef npy_clongdouble clongdouble_t
+ */
+typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
+
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":768
+ * 
+ * ctypedef npy_cfloat      cfloat_t
+ * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
+ * ctypedef npy_clongdouble clongdouble_t
+ * 
+ */
+typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
+
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":769
+ * ctypedef npy_cfloat      cfloat_t
+ * ctypedef npy_cdouble     cdouble_t
+ * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
+ * 
+ * ctypedef npy_cdouble     complex_t
+ */
+typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
+
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":771
+ * ctypedef npy_clongdouble clongdouble_t
+ * 
+ * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
+ * 
+ * cdef inline object PyArray_MultiIterNew1(a):
+ */
+typedef npy_cdouble __pyx_t_5numpy_complex_t;
 struct __pyx_fuse_0__pyx_opt_args_5scipy_7special_14cython_special_spherical_jn;
 struct __pyx_fuse_1__pyx_opt_args_5scipy_7special_14cython_special_spherical_jn;
 struct __pyx_fuse_0__pyx_opt_args_5scipy_7special_14cython_special_spherical_yn;
 struct __pyx_fuse_1__pyx_opt_args_5scipy_7special_14cython_special_spherical_yn;
 struct __pyx_fuse_0__pyx_opt_args_5scipy_7special_14cython_special_spherical_in;
 struct __pyx_fuse_1__pyx_opt_args_5scipy_7special_14cython_special_spherical_in;
 struct __pyx_fuse_0__pyx_opt_args_5scipy_7special_14cython_special_spherical_kn;
@@ -1967,84 +2003,48 @@
   int __pyx_n;
   int derivative;
 };
 struct __pyx_fuse_1__pyx_opt_args_5scipy_7special_14cython_special_spherical_kn {
   int __pyx_n;
   int derivative;
 };
-
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":767
- * ctypedef npy_longdouble longdouble_t
- * 
- * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
- * ctypedef npy_cdouble     cdouble_t
- * ctypedef npy_clongdouble clongdouble_t
- */
-typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
-
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":768
- * 
- * ctypedef npy_cfloat      cfloat_t
- * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
- * ctypedef npy_clongdouble clongdouble_t
- * 
- */
-typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
-
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":769
- * ctypedef npy_cfloat      cfloat_t
- * ctypedef npy_cdouble     cdouble_t
- * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
- * 
- * ctypedef npy_cdouble     complex_t
- */
-typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
-
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":771
- * ctypedef npy_clongdouble clongdouble_t
- * 
- * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
- * 
- * cdef inline object PyArray_MultiIterNew1(a):
- */
-typedef npy_cdouble __pyx_t_5numpy_complex_t;
 struct __pyx_ctuple_double__and_double;
 typedef struct __pyx_ctuple_double__and_double __pyx_ctuple_double__and_double;
 struct __pyx_opt_args_8pyseobnr_3eob_8waveform_8waveform_compute_special_coeffs;
 struct __pyx_ctuple_int__and_int;
 typedef struct __pyx_ctuple_int__and_int __pyx_ctuple_int__and_int;
 
 /* "pyseobnr/eob/waveform/waveform.pxd":7
  *     const int ell_max
  * 
- * cpdef (double, double) RR_force(double[::1] q, double[::1] p, double omega, double omega_circ,             # <<<<<<<<<<<<<<
- *     double H, EOBParams eob_pars)
- * 
+ * cpdef (double, double) RR_force(             # <<<<<<<<<<<<<<
+ *     double[::1] q,
+ *     double[::1] p,
  */
 struct __pyx_ctuple_double__and_double {
   double f0;
   double f1;
 };
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2353
+/* "pyseobnr/eob/waveform/waveform.pyx":2532
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef compute_special_coeffs(double[:,:] dynamics, double t_attach, EOBParams eob_pars,             # <<<<<<<<<<<<<<
- *     dict amp_fits, dict amp_thresholds, dict modes={(2,1):7,(4,3):7,(5,5):5}):
- *     """
+ * cpdef compute_special_coeffs(             # <<<<<<<<<<<<<<
+ *     double[:, :] dynamics,
+ *     double t_attach,
  */
 struct __pyx_opt_args_8pyseobnr_3eob_8waveform_8waveform_compute_special_coeffs {
   int __pyx_n;
   PyObject *modes;
 };
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2256
+/* "pyseobnr/eob/waveform/waveform.pyx":2403
  *     cdef double source1
  *     cdef double source2
- *     cdef (int,int) ell_m             # <<<<<<<<<<<<<<
+ *     cdef (int, int) ell_m             # <<<<<<<<<<<<<<
  *     cdef double nu = eob_pars.p_params.nu
  *     cdef double complex tmp
  */
 struct __pyx_ctuple_int__and_int {
   int f0;
   int f1;
 };
@@ -2155,32 +2155,33 @@
   struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *flux_params;
   struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics *dynamics;
   PyObject *mode_array;
   int aligned;
 };
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":10
- *     double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":15
+ *     EOBParams eob_pars)
  * 
  * cdef class RadiationReactionForce:             # <<<<<<<<<<<<<<
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,
- *         double omega_circ, double H, EOBParams eob_pars)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce {
   PyObject_HEAD
   struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_vtab;
 };
 
 
-/* "pyseobnr/eob/waveform/waveform.pxd":14
- *         double omega_circ, double H, EOBParams eob_pars)
+/* "pyseobnr/eob/waveform/waveform.pxd":25
+ *         EOBParams eob_pars)
  * 
  * cdef class SEOBNRv5RRForce(RadiationReactionForce):             # <<<<<<<<<<<<<<
- *     cpdef (double,double) RR(self, double[::1] q,double[::1] p,double omega,double omega_circ,double H,EOBParams eob_par)
+ *     cpdef (double, double) RR(
+ *         self,
  */
 struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce {
   struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce __pyx_base;
 };
 
 
 /* "View.MemoryView":114
@@ -2271,29 +2272,29 @@
 struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams {
   PyObject *(*update_spins)(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *, double, double, int __pyx_skip_dispatch);
   PyObject *(*_compute_derived_quants)(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams *);
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams *__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams;
 
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2130
+/* "pyseobnr/eob/waveform/waveform.pyx":2249
  * 
  * 
  * cdef class RadiationReactionForce:             # <<<<<<<<<<<<<<
  *     """
  *     Convenience wrappers around the RR_force function to enable typed calls
  */
 
 struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce {
   __pyx_ctuple_double__and_double (*RR)(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *, int __pyx_skip_dispatch);
 };
 static struct __pyx_vtabstruct_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
 
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2141
+/* "pyseobnr/eob/waveform/waveform.pyx":2268
  * 
  * 
  * cdef class SEOBNRv5RRForce(RadiationReactionForce):             # <<<<<<<<<<<<<<
  *     """
  *     Convenience wrappers around the RR_force function to enable typed calls
  */
 
@@ -3315,30 +3316,30 @@
 
 /* SetupReduce.proto */
 #if !CYTHON_COMPILING_IN_LIMITED_API
 static int __Pyx_setup_reduce(PyObject* type_obj);
 #endif
 
 /* TypeImport.proto */
-#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_8
-#define __PYX_HAVE_RT_ImportType_proto_3_0_8
+#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_10
+#define __PYX_HAVE_RT_ImportType_proto_3_0_10
 #if defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L
 #include <stdalign.h>
 #endif
 #if (defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L) || __cplusplus >= 201103L
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) alignof(s)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) alignof(s)
 #else
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_8(s) sizeof(void*)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) sizeof(void*)
 #endif
-enum __Pyx_ImportType_CheckSize_3_0_8 {
-   __Pyx_ImportType_CheckSize_Error_3_0_8 = 0,
-   __Pyx_ImportType_CheckSize_Warn_3_0_8 = 1,
-   __Pyx_ImportType_CheckSize_Ignore_3_0_8 = 2
+enum __Pyx_ImportType_CheckSize_3_0_10 {
+   __Pyx_ImportType_CheckSize_Error_3_0_10 = 0,
+   __Pyx_ImportType_CheckSize_Warn_3_0_10 = 1,
+   __Pyx_ImportType_CheckSize_Ignore_3_0_10 = 2
 };
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size);
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size);
 #endif
 
 /* FetchSharedCythonModule.proto */
 static PyObject *__Pyx_FetchSharedCythonABIModule(void);
 
 /* FetchCommonType.proto */
 #if !CYTHON_USE_TYPE_SPECS
@@ -3764,15 +3765,15 @@
 static unsigned long __Pyx_get_runtime_version(void);
 static int __Pyx_check_binary_version(unsigned long ct_version, unsigned long rt_version, int allow_newer);
 
 /* FunctionExport.proto */
 static int __Pyx_ExportFunction(const char *name, void (*f)(void), const char *sig);
 
 /* FunctionImport.proto */
-static int __Pyx_ImportFunction_3_0_8(PyObject *module, const char *funcname, void (**f)(void), const char *sig);
+static int __Pyx_ImportFunction_3_0_10(PyObject *module, const char *funcname, void (**f)(void), const char *sig);
 
 /* InitStrings.proto */
 static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);
 
 /* #### Code section: module_declarations ### */
 static PyObject *__pyx_array_get_memview(struct __pyx_array_obj *__pyx_v_self); /* proto*/
 static char *__pyx_memoryview_get_item_pointer(struct __pyx_memoryview_obj *__pyx_v_self, PyObject *__pyx_v_index); /* proto*/
@@ -3802,22 +3803,14 @@
 
 /* Module declarations from "cython.dataclasses" */
 
 /* Module declarations from "cython" */
 
 /* Module declarations from "libc.math" */
 
-/* Module declarations from "scipy.special.cython_special" */
-static __pyx_t_double_complex (*__pyx_fuse_0__pyx_f_5scipy_7special_14cython_special_loggamma)(__pyx_t_double_complex, int __pyx_skip_dispatch); /*proto*/
-static double (*__pyx_fuse_1__pyx_f_5scipy_7special_14cython_special_loggamma)(double, int __pyx_skip_dispatch); /*proto*/
-static __pyx_t_double_complex (*__pyx_fuse_0__pyx_f_5scipy_7special_14cython_special_sph_harm)(double, double, double, double, int __pyx_skip_dispatch); /*proto*/
-static __pyx_t_double_complex (*__pyx_fuse_1__pyx_f_5scipy_7special_14cython_special_sph_harm)(long, long, double, double, int __pyx_skip_dispatch); /*proto*/
-
-/* Module declarations from "scipy.linalg.cython_blas" */
-
 /* Module declarations from "libc.string" */
 
 /* Module declarations from "libc.stdio" */
 
 /* Module declarations from "__builtin__" */
 
 /* Module declarations from "cpython.type" */
@@ -3828,14 +3821,20 @@
 
 /* Module declarations from "cpython.ref" */
 
 /* Module declarations from "numpy" */
 
 /* Module declarations from "numpy" */
 
+/* Module declarations from "scipy.special.cython_special" */
+static __pyx_t_double_complex (*__pyx_fuse_0__pyx_f_5scipy_7special_14cython_special_loggamma)(__pyx_t_double_complex, int __pyx_skip_dispatch); /*proto*/
+static double (*__pyx_fuse_1__pyx_f_5scipy_7special_14cython_special_loggamma)(double, int __pyx_skip_dispatch); /*proto*/
+static __pyx_t_double_complex (*__pyx_fuse_0__pyx_f_5scipy_7special_14cython_special_sph_harm)(double, double, double, double, int __pyx_skip_dispatch); /*proto*/
+static __pyx_t_double_complex (*__pyx_fuse_1__pyx_f_5scipy_7special_14cython_special_sph_harm)(long, long, double, double, int __pyx_skip_dispatch); /*proto*/
+
 /* Module declarations from "pyseobnr.eob.waveform.waveform" */
 static double __pyx_v_8pyseobnr_3eob_8waveform_8waveform_ylms[9][9];
 static double __pyx_v_8pyseobnr_3eob_8waveform_8waveform_LOOKUP_TABLE[21];
 static PyObject *__pyx_collections_abc_Sequence = 0;
 static PyObject *generic = 0;
 static PyObject *strided = 0;
 static PyObject *indirect = 0;
@@ -4105,15 +4104,14 @@
 static const char __pyx_k_compute_newtonian_prefixes[] = "compute_newtonian_prefixes";
 static const char __pyx_k_Step_may_not_be_zero_axis_d[] = "Step may not be zero (axis %d)";
 static const char __pyx_k_itemsize_0_for_cython_array[] = "itemsize <= 0 for cython.array";
 static const char __pyx_k_evaluate_nqc_correction_flux[] = "evaluate_nqc_correction_flux";
 static const char __pyx_k_unable_to_allocate_array_data[] = "unable to allocate array data.";
 static const char __pyx_k_pyseobnr_eob_waveform_waveform[] = "pyseobnr.eob.waveform.waveform";
 static const char __pyx_k_strided_and_direct_or_indirect[] = "<strided and direct or indirect>";
-static const char __pyx_k_Optimized_functions_for_wavefor[] = "\nOptimized functions for waveform generation.\n";
 static const char __pyx_k_RadiationReactionForce___reduce[] = "RadiationReactionForce.__reduce_cython__";
 static const char __pyx_k_SEOBNRv5RRForce___reduce_cython[] = "SEOBNRv5RRForce.__reduce_cython__";
 static const char __pyx_k_numpy_core_multiarray_failed_to[] = "numpy.core.multiarray failed to import";
 static const char __pyx_k_All_dimensions_preceding_dimensi[] = "All dimensions preceding dimension %d must be indexed and not sliced";
 static const char __pyx_k_Buffer_view_does_not_expose_stri[] = "Buffer view does not expose strides";
 static const char __pyx_k_Can_only_create_a_buffer_that_is[] = "Can only create a buffer that is contiguous in memory.";
 static const char __pyx_k_Cannot_assign_to_read_only_memor[] = "Cannot assign to read-only memoryview";
@@ -4249,18 +4247,14 @@
   #endif
   #if CYTHON_USE_MODULE_STATE
   #endif
   #if CYTHON_USE_MODULE_STATE
   #endif
   #if CYTHON_USE_MODULE_STATE
   #endif
-  #if CYTHON_USE_MODULE_STATE
-  #endif
-  #if CYTHON_USE_MODULE_STATE
-  #endif
   PyTypeObject *__pyx_ptype_7cpython_4type_type;
   #if CYTHON_USE_MODULE_STATE
   #endif
   #if CYTHON_USE_MODULE_STATE
   #endif
   #if CYTHON_USE_MODULE_STATE
   #endif
@@ -4280,14 +4274,16 @@
   PyTypeObject *__pyx_ptype_5numpy_inexact;
   PyTypeObject *__pyx_ptype_5numpy_floating;
   PyTypeObject *__pyx_ptype_5numpy_complexfloating;
   PyTypeObject *__pyx_ptype_5numpy_flexible;
   PyTypeObject *__pyx_ptype_5numpy_character;
   PyTypeObject *__pyx_ptype_5numpy_ufunc;
   #if CYTHON_USE_MODULE_STATE
+  #endif
+  #if CYTHON_USE_MODULE_STATE
   PyObject *__pyx_type_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
   PyObject *__pyx_type_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce;
   PyObject *__pyx_type___pyx_array;
   PyObject *__pyx_type___pyx_MemviewEnum;
   PyObject *__pyx_type___pyx_memoryview;
   PyObject *__pyx_type___pyx_memoryviewslice;
   #endif
@@ -5315,18 +5311,14 @@
 #endif
 #if CYTHON_USE_MODULE_STATE
 #endif
 #if CYTHON_USE_MODULE_STATE
 #endif
 #if CYTHON_USE_MODULE_STATE
 #endif
-#if CYTHON_USE_MODULE_STATE
-#endif
-#if CYTHON_USE_MODULE_STATE
-#endif
 #define __pyx_ptype_7cpython_4type_type __pyx_mstate_global->__pyx_ptype_7cpython_4type_type
 #if CYTHON_USE_MODULE_STATE
 #endif
 #if CYTHON_USE_MODULE_STATE
 #endif
 #if CYTHON_USE_MODULE_STATE
 #endif
@@ -5346,14 +5338,16 @@
 #define __pyx_ptype_5numpy_inexact __pyx_mstate_global->__pyx_ptype_5numpy_inexact
 #define __pyx_ptype_5numpy_floating __pyx_mstate_global->__pyx_ptype_5numpy_floating
 #define __pyx_ptype_5numpy_complexfloating __pyx_mstate_global->__pyx_ptype_5numpy_complexfloating
 #define __pyx_ptype_5numpy_flexible __pyx_mstate_global->__pyx_ptype_5numpy_flexible
 #define __pyx_ptype_5numpy_character __pyx_mstate_global->__pyx_ptype_5numpy_character
 #define __pyx_ptype_5numpy_ufunc __pyx_mstate_global->__pyx_ptype_5numpy_ufunc
 #if CYTHON_USE_MODULE_STATE
+#endif
+#if CYTHON_USE_MODULE_STATE
 #define __pyx_type_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce __pyx_mstate_global->__pyx_type_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce
 #define __pyx_type_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce __pyx_mstate_global->__pyx_type_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce
 #define __pyx_type___pyx_array __pyx_mstate_global->__pyx_type___pyx_array
 #define __pyx_type___pyx_MemviewEnum __pyx_mstate_global->__pyx_type___pyx_MemviewEnum
 #define __pyx_type___pyx_memoryview __pyx_mstate_global->__pyx_type___pyx_memoryview
 #define __pyx_type___pyx_memoryviewslice __pyx_mstate_global->__pyx_type___pyx_memoryviewslice
 #endif
@@ -19706,261 +19700,261 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
   PyObject *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":248
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":248
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_BASE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":245
  * 
  *         @property
  *         cdef inline PyObject* base(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a borrowed reference to the object owning the data/memory.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
 static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
   PyArray_Descr *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyArray_Descr *__pyx_t_1;
   __Pyx_RefNannySetupContext("descr", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":254
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":254
  *             """Returns an owned reference to the dtype of the array.
  *             """
  *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
   __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
   __pyx_r = ((PyArray_Descr *)__pyx_t_1);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":251
  * 
  *         @property
  *         cdef inline dtype descr(self):             # <<<<<<<<<<<<<<
  *             """Returns an owned reference to the dtype of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":260
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":260
  *             """Returns the number of dimensions in the array.
  *             """
  *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_NDIM(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":257
  * 
  *         @property
  *         cdef inline int ndim(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the number of dimensions in the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":268
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":268
  *             Can return NULL for 0-dimensional arrays.
  *             """
  *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_DIMS(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":263
  * 
  *         @property
  *         cdef inline npy_intp *shape(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the dimensions/shape of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
 static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
   npy_intp *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":275
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":275
  *             The number of elements matches the number of dimensions of the array (ndim).
  *             """
  *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_STRIDES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":271
  * 
  *         @property
  *         cdef inline npy_intp *strides(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns a pointer to the strides of the array.
  *             The number of elements matches the number of dimensions of the array (ndim).
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
 static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
   npy_intp __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":281
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":281
  *             """Returns the total size (in number of elements) of the array.
  *             """
  *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = PyArray_SIZE(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":278
  * 
  *         @property
  *         cdef inline npy_intp size(self) nogil:             # <<<<<<<<<<<<<<
  *             """Returns the total size (in number of elements) of the array.
  *             """
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
 static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
   char *__pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":290
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":290
  *             of `PyArray_DATA()` instead, which returns a 'void*'.
  *             """
  *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
  * 
  *     ctypedef unsigned char      npy_bool
  */
   __pyx_r = PyArray_BYTES(__pyx_v_self);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":284
  * 
  *         @property
  *         cdef inline char* data(self) nogil:             # <<<<<<<<<<<<<<
  *             """The pointer to the data buffer as a char*.
  *             This is provided for legacy reasons to avoid direct struct field access.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -19969,29 +19963,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":774
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":774
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":773
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -20002,15 +19996,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -20019,29 +20013,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":777
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":777
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":776
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -20052,15 +20046,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -20069,29 +20063,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":780
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":780
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":779
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -20102,15 +20096,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -20119,29 +20113,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":783
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":783
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":782
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -20152,15 +20146,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -20169,29 +20163,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":786
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":786
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":785
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -20202,217 +20196,217 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
   if (__pyx_t_1) {
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":790
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":790
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":789
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":792
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":792
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":788
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   int __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":969
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":969
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":970
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":970
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(2, 970, __pyx_L1_error)
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":968
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":973
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":973
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = (__pyx_v_base == NULL);
   if (__pyx_t_1) {
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":975
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":975
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":974
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":976
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":976
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":972
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -20428,15 +20422,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -20444,68 +20438,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":982
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":982
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 982, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":983
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":983
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 983, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 984, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 984, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":981
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -20513,15 +20507,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":980
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -20536,15 +20530,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20560,15 +20554,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -20576,68 +20570,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":988
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":988
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 988, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":989
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":989
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 989, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 990, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 990, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":987
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -20645,15 +20639,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":986
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20668,15 +20662,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20692,15 +20686,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 1);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -20708,68 +20702,68 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":994
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":994
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(2, 994, __pyx_L3_error)
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":995
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":995
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(2, 995, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":996
+      /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":996
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(2, 996, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(2, 996, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
 
-    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
+    /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":993
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __pyx_L5_except_error:;
@@ -20777,15 +20771,15 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":992
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -20800,183 +20794,183 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1011
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1011
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":999
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1026
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1026
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1014
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1036
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1036
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1029
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1043
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1043
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1039
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
+/* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1050
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1050
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":1046
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":140
+/* "pyseobnr/eob/waveform/waveform.pyx":144
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double complex calculate_multipole_prefix(double m1, double m2, int l, int m):             # <<<<<<<<<<<<<<
  *     """
  *     Calculates the Newtonian multipole prefactors, see Eq. 25-27 in
  */
 
@@ -21015,361 +21009,361 @@
   int __pyx_t_11;
   long __pyx_t_12;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__11)
   __Pyx_RefNannySetupContext("calculate_multipole_prefix", 1);
-  __Pyx_TraceCall("calculate_multipole_prefix", __pyx_f[0], 140, 0, __PYX_ERR(0, 140, __pyx_L1_error));
+  __Pyx_TraceCall("calculate_multipole_prefix", __pyx_f[0], 144, 0, __PYX_ERR(0, 144, __pyx_L1_error));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":146
+  /* "pyseobnr/eob/waveform/waveform.pyx":150
  *     See also Sec. 2A of [Damour2009]_.
  *     """
  *     cdef double complex n = 0.0             # <<<<<<<<<<<<<<
  *     cdef double complex prefix
  * 
  */
-  __Pyx_TraceLine(146,0,__PYX_ERR(0, 146, __pyx_L1_error))
+  __Pyx_TraceLine(150,0,__PYX_ERR(0, 150, __pyx_L1_error))
   __pyx_v_n = __pyx_t_double_complex_from_parts(0.0, 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":149
+  /* "pyseobnr/eob/waveform/waveform.pyx":153
  *     cdef double complex prefix
  * 
  *     cdef double totalMass = m1 + m2             # <<<<<<<<<<<<<<
  * 
  *     cdef double epsilon = (l + m) % 2
  */
-  __Pyx_TraceLine(149,0,__PYX_ERR(0, 149, __pyx_L1_error))
+  __Pyx_TraceLine(153,0,__PYX_ERR(0, 153, __pyx_L1_error))
   __pyx_v_totalMass = (__pyx_v_m1 + __pyx_v_m2);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":151
+  /* "pyseobnr/eob/waveform/waveform.pyx":155
  *     cdef double totalMass = m1 + m2
  * 
  *     cdef double epsilon = (l + m) % 2             # <<<<<<<<<<<<<<
  * 
  *     cdef double x1 = m1 / totalMass
  */
-  __Pyx_TraceLine(151,0,__PYX_ERR(0, 151, __pyx_L1_error))
+  __Pyx_TraceLine(155,0,__PYX_ERR(0, 155, __pyx_L1_error))
   __pyx_v_epsilon = __Pyx_mod_long((__pyx_v_l + __pyx_v_m), 2);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":153
+  /* "pyseobnr/eob/waveform/waveform.pyx":157
  *     cdef double epsilon = (l + m) % 2
  * 
  *     cdef double x1 = m1 / totalMass             # <<<<<<<<<<<<<<
  *     cdef double x2 = m2 / totalMass
  * 
  */
-  __Pyx_TraceLine(153,0,__PYX_ERR(0, 153, __pyx_L1_error))
+  __Pyx_TraceLine(157,0,__PYX_ERR(0, 157, __pyx_L1_error))
   if (unlikely(__pyx_v_totalMass == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 153, __pyx_L1_error)
+    __PYX_ERR(0, 157, __pyx_L1_error)
   }
   __pyx_v_x1 = (__pyx_v_m1 / __pyx_v_totalMass);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":154
+  /* "pyseobnr/eob/waveform/waveform.pyx":158
  * 
  *     cdef double x1 = m1 / totalMass
  *     cdef double x2 = m2 / totalMass             # <<<<<<<<<<<<<<
  * 
  *     cdef double eta = m1 * m2 / (totalMass * totalMass)
  */
-  __Pyx_TraceLine(154,0,__PYX_ERR(0, 154, __pyx_L1_error))
+  __Pyx_TraceLine(158,0,__PYX_ERR(0, 158, __pyx_L1_error))
   if (unlikely(__pyx_v_totalMass == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 154, __pyx_L1_error)
+    __PYX_ERR(0, 158, __pyx_L1_error)
   }
   __pyx_v_x2 = (__pyx_v_m2 / __pyx_v_totalMass);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":156
+  /* "pyseobnr/eob/waveform/waveform.pyx":160
  *     cdef double x2 = m2 / totalMass
  * 
  *     cdef double eta = m1 * m2 / (totalMass * totalMass)             # <<<<<<<<<<<<<<
  * 
  *     cdef int sign
  */
-  __Pyx_TraceLine(156,0,__PYX_ERR(0, 156, __pyx_L1_error))
+  __Pyx_TraceLine(160,0,__PYX_ERR(0, 160, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_m1 * __pyx_v_m2);
   __pyx_t_2 = (__pyx_v_totalMass * __pyx_v_totalMass);
   if (unlikely(__pyx_t_2 == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 156, __pyx_L1_error)
+    __PYX_ERR(0, 160, __pyx_L1_error)
   }
   __pyx_v_eta = (__pyx_t_1 / __pyx_t_2);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":159
+  /* "pyseobnr/eob/waveform/waveform.pyx":163
  * 
  *     cdef int sign
  *     if abs(m % 2) == 0:             # <<<<<<<<<<<<<<
  *         sign = 1
  *     else:
  */
-  __Pyx_TraceLine(159,0,__PYX_ERR(0, 159, __pyx_L1_error))
-  __pyx_t_3 = labs(__Pyx_mod_long(__pyx_v_m, 2)); if (unlikely(__pyx_t_3 == ((long)-1))) __PYX_ERR(0, 159, __pyx_L1_error)
+  __Pyx_TraceLine(163,0,__PYX_ERR(0, 163, __pyx_L1_error))
+  __pyx_t_3 = labs(__Pyx_mod_long(__pyx_v_m, 2)); if (unlikely(__pyx_t_3 == ((long)-1))) __PYX_ERR(0, 163, __pyx_L1_error)
   __pyx_t_4 = (__pyx_t_3 == 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":160
+    /* "pyseobnr/eob/waveform/waveform.pyx":164
  *     cdef int sign
  *     if abs(m % 2) == 0:
  *         sign = 1             # <<<<<<<<<<<<<<
  *     else:
  *         sign = -1
  */
-    __Pyx_TraceLine(160,0,__PYX_ERR(0, 160, __pyx_L1_error))
+    __Pyx_TraceLine(164,0,__PYX_ERR(0, 164, __pyx_L1_error))
     __pyx_v_sign = 1;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":159
+    /* "pyseobnr/eob/waveform/waveform.pyx":163
  * 
  *     cdef int sign
  *     if abs(m % 2) == 0:             # <<<<<<<<<<<<<<
  *         sign = 1
  *     else:
  */
     goto __pyx_L3;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":162
+  /* "pyseobnr/eob/waveform/waveform.pyx":166
  *         sign = 1
  *     else:
  *         sign = -1             # <<<<<<<<<<<<<<
  * 
  *     #
  */
-  __Pyx_TraceLine(162,0,__PYX_ERR(0, 162, __pyx_L1_error))
+  __Pyx_TraceLine(166,0,__PYX_ERR(0, 166, __pyx_L1_error))
   /*else*/ {
     __pyx_v_sign = -1;
   }
   __pyx_L3:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":176
- *     # are added to modes above l=5 this will need to be revisited.
- *     cdef double c,mult1,mult2
+  /* "pyseobnr/eob/waveform/waveform.pyx":183
+ *     # If new spinning terms are added to modes above l=5 this will need to be revisited.
+ *     cdef double c, mult1, mult2
  *     if m1 != m2 or sign == 1:             # <<<<<<<<<<<<<<
  *         c = pow(x2, l + epsilon - 1) + sign * pow(x1, l + epsilon - 1)
  * 
  */
-  __Pyx_TraceLine(176,0,__PYX_ERR(0, 176, __pyx_L1_error))
+  __Pyx_TraceLine(183,0,__PYX_ERR(0, 183, __pyx_L1_error))
   __pyx_t_5 = (__pyx_v_m1 != __pyx_v_m2);
   if (!__pyx_t_5) {
   } else {
     __pyx_t_4 = __pyx_t_5;
     goto __pyx_L5_bool_binop_done;
   }
   __pyx_t_5 = (__pyx_v_sign == 1);
   __pyx_t_4 = __pyx_t_5;
   __pyx_L5_bool_binop_done:;
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":177
- *     cdef double c,mult1,mult2
+    /* "pyseobnr/eob/waveform/waveform.pyx":184
+ *     cdef double c, mult1, mult2
  *     if m1 != m2 or sign == 1:
  *         c = pow(x2, l + epsilon - 1) + sign * pow(x1, l + epsilon - 1)             # <<<<<<<<<<<<<<
  * 
  *     else:
  */
-    __Pyx_TraceLine(177,0,__PYX_ERR(0, 177, __pyx_L1_error))
-    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_x2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 177, __pyx_L1_error)
+    __Pyx_TraceLine(184,0,__PYX_ERR(0, 184, __pyx_L1_error))
+    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_x2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 184, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = PyFloat_FromDouble(((__pyx_v_l + __pyx_v_epsilon) - 1.0)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 177, __pyx_L1_error)
+    __pyx_t_7 = PyFloat_FromDouble(((__pyx_v_l + __pyx_v_epsilon) - 1.0)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 184, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyNumber_Power2(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 177, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyNumber_Power2(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 184, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_sign); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 177, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_sign); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 184, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_x1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 177, __pyx_L1_error)
+    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_x1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 184, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_9 = PyFloat_FromDouble(((__pyx_v_l + __pyx_v_epsilon) - 1.0)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 177, __pyx_L1_error)
+    __pyx_t_9 = PyFloat_FromDouble(((__pyx_v_l + __pyx_v_epsilon) - 1.0)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 184, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_10 = __Pyx_PyNumber_Power2(__pyx_t_6, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 177, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyNumber_Power2(__pyx_t_6, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 184, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Multiply(__pyx_t_7, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 177, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_t_7, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 184, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = PyNumber_Add(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 177, __pyx_L1_error)
+    __pyx_t_10 = PyNumber_Add(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 184, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_10); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 177, __pyx_L1_error)
+    __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_10); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 184, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_v_c = __pyx_t_2;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":176
- *     # are added to modes above l=5 this will need to be revisited.
- *     cdef double c,mult1,mult2
+    /* "pyseobnr/eob/waveform/waveform.pyx":183
+ *     # If new spinning terms are added to modes above l=5 this will need to be revisited.
+ *     cdef double c, mult1, mult2
  *     if m1 != m2 or sign == 1:             # <<<<<<<<<<<<<<
  *         c = pow(x2, l + epsilon - 1) + sign * pow(x1, l + epsilon - 1)
  * 
  */
     goto __pyx_L4;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":180
+  /* "pyseobnr/eob/waveform/waveform.pyx":187
  * 
  *     else:
  *         if l == 2:             # <<<<<<<<<<<<<<
  *             c = -1.0
  *         elif l == 3:
  */
-  __Pyx_TraceLine(180,0,__PYX_ERR(0, 180, __pyx_L1_error))
+  __Pyx_TraceLine(187,0,__PYX_ERR(0, 187, __pyx_L1_error))
   /*else*/ {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":186
+    /* "pyseobnr/eob/waveform/waveform.pyx":193
  *         elif l == 4:
  *             c = -0.5
  *         elif l == 5:             # <<<<<<<<<<<<<<
  *             c = -0.5
  *         else:
  */
-    __Pyx_TraceLine(186,0,__PYX_ERR(0, 186, __pyx_L1_error))
+    __Pyx_TraceLine(193,0,__PYX_ERR(0, 193, __pyx_L1_error))
     switch (__pyx_v_l) {
       case 2:
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":181
+      /* "pyseobnr/eob/waveform/waveform.pyx":188
  *     else:
  *         if l == 2:
  *             c = -1.0             # <<<<<<<<<<<<<<
  *         elif l == 3:
  *             c = -1.0
  */
-      __Pyx_TraceLine(181,0,__PYX_ERR(0, 181, __pyx_L1_error))
+      __Pyx_TraceLine(188,0,__PYX_ERR(0, 188, __pyx_L1_error))
       __pyx_v_c = -1.0;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":180
+      /* "pyseobnr/eob/waveform/waveform.pyx":187
  * 
  *     else:
  *         if l == 2:             # <<<<<<<<<<<<<<
  *             c = -1.0
  *         elif l == 3:
  */
       break;
       case 3:
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":183
+      /* "pyseobnr/eob/waveform/waveform.pyx":190
  *             c = -1.0
  *         elif l == 3:
  *             c = -1.0             # <<<<<<<<<<<<<<
  *         elif l == 4:
  *             c = -0.5
  */
-      __Pyx_TraceLine(183,0,__PYX_ERR(0, 183, __pyx_L1_error))
+      __Pyx_TraceLine(190,0,__PYX_ERR(0, 190, __pyx_L1_error))
       __pyx_v_c = -1.0;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":182
+      /* "pyseobnr/eob/waveform/waveform.pyx":189
  *         if l == 2:
  *             c = -1.0
  *         elif l == 3:             # <<<<<<<<<<<<<<
  *             c = -1.0
  *         elif l == 4:
  */
       break;
       case 4:
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":185
+      /* "pyseobnr/eob/waveform/waveform.pyx":192
  *             c = -1.0
  *         elif l == 4:
  *             c = -0.5             # <<<<<<<<<<<<<<
  *         elif l == 5:
  *             c = -0.5
  */
-      __Pyx_TraceLine(185,0,__PYX_ERR(0, 185, __pyx_L1_error))
+      __Pyx_TraceLine(192,0,__PYX_ERR(0, 192, __pyx_L1_error))
       __pyx_v_c = -0.5;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":184
+      /* "pyseobnr/eob/waveform/waveform.pyx":191
  *         elif l == 3:
  *             c = -1.0
  *         elif l == 4:             # <<<<<<<<<<<<<<
  *             c = -0.5
  *         elif l == 5:
  */
       break;
       case 5:
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":187
+      /* "pyseobnr/eob/waveform/waveform.pyx":194
  *             c = -0.5
  *         elif l == 5:
  *             c = -0.5             # <<<<<<<<<<<<<<
  *         else:
  *             c = 0.0
  */
-      __Pyx_TraceLine(187,0,__PYX_ERR(0, 187, __pyx_L1_error))
+      __Pyx_TraceLine(194,0,__PYX_ERR(0, 194, __pyx_L1_error))
       __pyx_v_c = -0.5;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":186
+      /* "pyseobnr/eob/waveform/waveform.pyx":193
  *         elif l == 4:
  *             c = -0.5
  *         elif l == 5:             # <<<<<<<<<<<<<<
  *             c = -0.5
  *         else:
  */
       break;
       default:
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":189
+      /* "pyseobnr/eob/waveform/waveform.pyx":196
  *             c = -0.5
  *         else:
  *             c = 0.0             # <<<<<<<<<<<<<<
  * 
  *     # Eqs 5 and 6. Dependent on the value of epsilon (parity), we get different n
  */
-      __Pyx_TraceLine(189,0,__PYX_ERR(0, 189, __pyx_L1_error))
+      __Pyx_TraceLine(196,0,__PYX_ERR(0, 196, __pyx_L1_error))
       __pyx_v_c = 0.0;
       break;
     }
   }
   __pyx_L4:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":192
+  /* "pyseobnr/eob/waveform/waveform.pyx":199
  * 
  *     # Eqs 5 and 6. Dependent on the value of epsilon (parity), we get different n
  *     if epsilon == 0:             # <<<<<<<<<<<<<<
  *         n = 1j * m
  *         n = n ** l
  */
-  __Pyx_TraceLine(192,0,__PYX_ERR(0, 192, __pyx_L1_error))
+  __Pyx_TraceLine(199,0,__PYX_ERR(0, 199, __pyx_L1_error))
   __pyx_t_4 = (__pyx_v_epsilon == 0.0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":193
+    /* "pyseobnr/eob/waveform/waveform.pyx":200
  *     # Eqs 5 and 6. Dependent on the value of epsilon (parity), we get different n
  *     if epsilon == 0:
  *         n = 1j * m             # <<<<<<<<<<<<<<
  *         n = n ** l
  * 
  */
-    __Pyx_TraceLine(193,0,__PYX_ERR(0, 193, __pyx_L1_error))
+    __Pyx_TraceLine(200,0,__PYX_ERR(0, 200, __pyx_L1_error))
     __pyx_v_n = __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0, 1.0), __pyx_t_double_complex_from_parts(__pyx_v_m, 0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":194
+    /* "pyseobnr/eob/waveform/waveform.pyx":201
  *     if epsilon == 0:
  *         n = 1j * m
  *         n = n ** l             # <<<<<<<<<<<<<<
  * 
  *         mult1 = 8.0 * pi / factorial2(2 * l + 1)
  */
-    __Pyx_TraceLine(194,0,__PYX_ERR(0, 194, __pyx_L1_error))
+    __Pyx_TraceLine(201,0,__PYX_ERR(0, 201, __pyx_L1_error))
     __pyx_v_n = __Pyx_c_pow_double(__pyx_v_n, __pyx_t_double_complex_from_parts(__pyx_v_l, 0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":196
+    /* "pyseobnr/eob/waveform/waveform.pyx":203
  *         n = n ** l
  * 
  *         mult1 = 8.0 * pi / factorial2(2 * l + 1)             # <<<<<<<<<<<<<<
  *         mult2 = ((l + 1) * (l + 2)) / (l * (l - 1))
  *         mult2 = sqrt(mult2)
  */
-    __Pyx_TraceLine(196,0,__PYX_ERR(0, 196, __pyx_L1_error))
-    __pyx_t_10 = PyFloat_FromDouble((8.0 * M_PI)); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 196, __pyx_L1_error)
+    __Pyx_TraceLine(203,0,__PYX_ERR(0, 203, __pyx_L1_error))
+    __pyx_t_10 = PyFloat_FromDouble((8.0 * M_PI)); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 203, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_factorial2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 196, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_factorial2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 203, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_7 = __Pyx_PyInt_From_long(((2 * __pyx_v_l) + 1)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 196, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_long(((2 * __pyx_v_l) + 1)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 203, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_6 = NULL;
     __pyx_t_11 = 0;
     #if CYTHON_UNPACK_METHODS
     if (unlikely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_8);
       if (likely(__pyx_t_6)) {
@@ -21382,136 +21376,136 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_7};
       __pyx_t_9 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 196, __pyx_L1_error)
+      if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 203, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     }
-    __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_t_10, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 196, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_t_10, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 203, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 196, __pyx_L1_error)
+    __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 203, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __pyx_v_mult1 = __pyx_t_2;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":197
+    /* "pyseobnr/eob/waveform/waveform.pyx":204
  * 
  *         mult1 = 8.0 * pi / factorial2(2 * l + 1)
  *         mult2 = ((l + 1) * (l + 2)) / (l * (l - 1))             # <<<<<<<<<<<<<<
  *         mult2 = sqrt(mult2)
  * 
  */
-    __Pyx_TraceLine(197,0,__PYX_ERR(0, 197, __pyx_L1_error))
+    __Pyx_TraceLine(204,0,__PYX_ERR(0, 204, __pyx_L1_error))
     __pyx_t_3 = ((__pyx_v_l + 1) * (__pyx_v_l + 2));
     __pyx_t_12 = (__pyx_v_l * (__pyx_v_l - 1));
     if (unlikely(__pyx_t_12 == 0)) {
       PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-      __PYX_ERR(0, 197, __pyx_L1_error)
+      __PYX_ERR(0, 204, __pyx_L1_error)
     }
     __pyx_v_mult2 = (((double)__pyx_t_3) / ((double)__pyx_t_12));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":198
+    /* "pyseobnr/eob/waveform/waveform.pyx":205
  *         mult1 = 8.0 * pi / factorial2(2 * l + 1)
  *         mult2 = ((l + 1) * (l + 2)) / (l * (l - 1))
  *         mult2 = sqrt(mult2)             # <<<<<<<<<<<<<<
  * 
  *         n *= mult1
  */
-    __Pyx_TraceLine(198,0,__PYX_ERR(0, 198, __pyx_L1_error))
+    __Pyx_TraceLine(205,0,__PYX_ERR(0, 205, __pyx_L1_error))
     __pyx_v_mult2 = sqrt(__pyx_v_mult2);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":200
+    /* "pyseobnr/eob/waveform/waveform.pyx":207
  *         mult2 = sqrt(mult2)
  * 
  *         n *= mult1             # <<<<<<<<<<<<<<
  *         n *= mult2
  * 
  */
-    __Pyx_TraceLine(200,0,__PYX_ERR(0, 200, __pyx_L1_error))
+    __Pyx_TraceLine(207,0,__PYX_ERR(0, 207, __pyx_L1_error))
     __pyx_v_n = __Pyx_c_prod_double(__pyx_v_n, __pyx_t_double_complex_from_parts(__pyx_v_mult1, 0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":201
+    /* "pyseobnr/eob/waveform/waveform.pyx":208
  * 
  *         n *= mult1
  *         n *= mult2             # <<<<<<<<<<<<<<
  * 
  *     elif epsilon == 1:
  */
-    __Pyx_TraceLine(201,0,__PYX_ERR(0, 201, __pyx_L1_error))
+    __Pyx_TraceLine(208,0,__PYX_ERR(0, 208, __pyx_L1_error))
     __pyx_v_n = __Pyx_c_prod_double(__pyx_v_n, __pyx_t_double_complex_from_parts(__pyx_v_mult2, 0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":192
+    /* "pyseobnr/eob/waveform/waveform.pyx":199
  * 
  *     # Eqs 5 and 6. Dependent on the value of epsilon (parity), we get different n
  *     if epsilon == 0:             # <<<<<<<<<<<<<<
  *         n = 1j * m
  *         n = n ** l
  */
     goto __pyx_L7;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":203
+  /* "pyseobnr/eob/waveform/waveform.pyx":210
  *         n *= mult2
  * 
  *     elif epsilon == 1:             # <<<<<<<<<<<<<<
  * 
  *         n = 1j * m
  */
-  __Pyx_TraceLine(203,0,__PYX_ERR(0, 203, __pyx_L1_error))
+  __Pyx_TraceLine(210,0,__PYX_ERR(0, 210, __pyx_L1_error))
   __pyx_t_4 = (__pyx_v_epsilon == 1.0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":205
+    /* "pyseobnr/eob/waveform/waveform.pyx":212
  *     elif epsilon == 1:
  * 
  *         n = 1j * m             # <<<<<<<<<<<<<<
  *         n = n ** l
  *         n = -n
  */
-    __Pyx_TraceLine(205,0,__PYX_ERR(0, 205, __pyx_L1_error))
+    __Pyx_TraceLine(212,0,__PYX_ERR(0, 212, __pyx_L1_error))
     __pyx_v_n = __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0, 1.0), __pyx_t_double_complex_from_parts(__pyx_v_m, 0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":206
+    /* "pyseobnr/eob/waveform/waveform.pyx":213
  * 
  *         n = 1j * m
  *         n = n ** l             # <<<<<<<<<<<<<<
  *         n = -n
  * 
  */
-    __Pyx_TraceLine(206,0,__PYX_ERR(0, 206, __pyx_L1_error))
+    __Pyx_TraceLine(213,0,__PYX_ERR(0, 213, __pyx_L1_error))
     __pyx_v_n = __Pyx_c_pow_double(__pyx_v_n, __pyx_t_double_complex_from_parts(__pyx_v_l, 0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":207
+    /* "pyseobnr/eob/waveform/waveform.pyx":214
  *         n = 1j * m
  *         n = n ** l
  *         n = -n             # <<<<<<<<<<<<<<
  * 
  *         mult1 = 16.0 * pi / factorial2(2 * l + 1)
  */
-    __Pyx_TraceLine(207,0,__PYX_ERR(0, 207, __pyx_L1_error))
+    __Pyx_TraceLine(214,0,__PYX_ERR(0, 214, __pyx_L1_error))
     __pyx_v_n = __Pyx_c_neg_double(__pyx_v_n);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":209
+    /* "pyseobnr/eob/waveform/waveform.pyx":216
  *         n = -n
  * 
  *         mult1 = 16.0 * pi / factorial2(2 * l + 1)             # <<<<<<<<<<<<<<
  * 
  *         mult2 = (2 * l + 1) * (l + 2) * (l * l - m * m)
  */
-    __Pyx_TraceLine(209,0,__PYX_ERR(0, 209, __pyx_L1_error))
-    __pyx_t_8 = PyFloat_FromDouble((16.0 * M_PI)); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 209, __pyx_L1_error)
+    __Pyx_TraceLine(216,0,__PYX_ERR(0, 216, __pyx_L1_error))
+    __pyx_t_8 = PyFloat_FromDouble((16.0 * M_PI)); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 216, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_factorial2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 209, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_factorial2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 216, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_7 = __Pyx_PyInt_From_long(((2 * __pyx_v_l) + 1)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 209, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_long(((2 * __pyx_v_l) + 1)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 216, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_6 = NULL;
     __pyx_t_11 = 0;
     #if CYTHON_UNPACK_METHODS
     if (unlikely(PyMethod_Check(__pyx_t_10))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_10);
       if (likely(__pyx_t_6)) {
@@ -21524,113 +21518,113 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_7};
       __pyx_t_9 = __Pyx_PyObject_FastCall(__pyx_t_10, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 209, __pyx_L1_error)
+      if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 216, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     }
-    __pyx_t_10 = __Pyx_PyNumber_Divide(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 209, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyNumber_Divide(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 216, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_10); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 209, __pyx_L1_error)
+    __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_t_10); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 216, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_v_mult1 = __pyx_t_2;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":211
+    /* "pyseobnr/eob/waveform/waveform.pyx":218
  *         mult1 = 16.0 * pi / factorial2(2 * l + 1)
  * 
  *         mult2 = (2 * l + 1) * (l + 2) * (l * l - m * m)             # <<<<<<<<<<<<<<
  *         mult2 /= (2 * l - 1) * (l + 1) * l * (l - 1)
  *         mult2 = sqrt(mult2)
  */
-    __Pyx_TraceLine(211,0,__PYX_ERR(0, 211, __pyx_L1_error))
+    __Pyx_TraceLine(218,0,__PYX_ERR(0, 218, __pyx_L1_error))
     __pyx_v_mult2 = ((((2 * __pyx_v_l) + 1) * (__pyx_v_l + 2)) * ((__pyx_v_l * __pyx_v_l) - (__pyx_v_m * __pyx_v_m)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":212
+    /* "pyseobnr/eob/waveform/waveform.pyx":219
  * 
  *         mult2 = (2 * l + 1) * (l + 2) * (l * l - m * m)
  *         mult2 /= (2 * l - 1) * (l + 1) * l * (l - 1)             # <<<<<<<<<<<<<<
  *         mult2 = sqrt(mult2)
  * 
  */
-    __Pyx_TraceLine(212,0,__PYX_ERR(0, 212, __pyx_L1_error))
+    __Pyx_TraceLine(219,0,__PYX_ERR(0, 219, __pyx_L1_error))
     __pyx_t_12 = (((((2 * __pyx_v_l) - 1) * (__pyx_v_l + 1)) * __pyx_v_l) * (__pyx_v_l - 1));
     if (unlikely(__pyx_t_12 == 0)) {
       PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-      __PYX_ERR(0, 212, __pyx_L1_error)
+      __PYX_ERR(0, 219, __pyx_L1_error)
     }
     __pyx_v_mult2 = (__pyx_v_mult2 / __pyx_t_12);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":213
+    /* "pyseobnr/eob/waveform/waveform.pyx":220
  *         mult2 = (2 * l + 1) * (l + 2) * (l * l - m * m)
  *         mult2 /= (2 * l - 1) * (l + 1) * l * (l - 1)
  *         mult2 = sqrt(mult2)             # <<<<<<<<<<<<<<
  * 
  *         n *= 1j * mult1
  */
-    __Pyx_TraceLine(213,0,__PYX_ERR(0, 213, __pyx_L1_error))
+    __Pyx_TraceLine(220,0,__PYX_ERR(0, 220, __pyx_L1_error))
     __pyx_v_mult2 = sqrt(__pyx_v_mult2);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":215
+    /* "pyseobnr/eob/waveform/waveform.pyx":222
  *         mult2 = sqrt(mult2)
  * 
  *         n *= 1j * mult1             # <<<<<<<<<<<<<<
  *         n *= mult2
  * 
  */
-    __Pyx_TraceLine(215,0,__PYX_ERR(0, 215, __pyx_L1_error))
+    __Pyx_TraceLine(222,0,__PYX_ERR(0, 222, __pyx_L1_error))
     __pyx_v_n = __Pyx_c_prod_double(__pyx_v_n, __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(0, 1.0), __pyx_t_double_complex_from_parts(__pyx_v_mult1, 0)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":216
+    /* "pyseobnr/eob/waveform/waveform.pyx":223
  * 
  *         n *= 1j * mult1
  *         n *= mult2             # <<<<<<<<<<<<<<
  * 
  *     prefix = n * eta * c
  */
-    __Pyx_TraceLine(216,0,__PYX_ERR(0, 216, __pyx_L1_error))
+    __Pyx_TraceLine(223,0,__PYX_ERR(0, 223, __pyx_L1_error))
     __pyx_v_n = __Pyx_c_prod_double(__pyx_v_n, __pyx_t_double_complex_from_parts(__pyx_v_mult2, 0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":203
+    /* "pyseobnr/eob/waveform/waveform.pyx":210
  *         n *= mult2
  * 
  *     elif epsilon == 1:             # <<<<<<<<<<<<<<
  * 
  *         n = 1j * m
  */
   }
   __pyx_L7:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":218
+  /* "pyseobnr/eob/waveform/waveform.pyx":225
  *         n *= mult2
  * 
  *     prefix = n * eta * c             # <<<<<<<<<<<<<<
  *     return prefix
  * 
  */
-  __Pyx_TraceLine(218,0,__PYX_ERR(0, 218, __pyx_L1_error))
+  __Pyx_TraceLine(225,0,__PYX_ERR(0, 225, __pyx_L1_error))
   __pyx_v_prefix = __Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_v_n, __pyx_t_double_complex_from_parts(__pyx_v_eta, 0)), __pyx_t_double_complex_from_parts(__pyx_v_c, 0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":219
+  /* "pyseobnr/eob/waveform/waveform.pyx":226
  * 
  *     prefix = n * eta * c
  *     return prefix             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_TraceLine(219,0,__PYX_ERR(0, 219, __pyx_L1_error))
+  __Pyx_TraceLine(226,0,__PYX_ERR(0, 226, __pyx_L1_error))
   __pyx_r = __pyx_v_prefix;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":140
+  /* "pyseobnr/eob/waveform/waveform.pyx":144
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double complex calculate_multipole_prefix(double m1, double m2, int l, int m):             # <<<<<<<<<<<<<<
  *     """
  *     Calculates the Newtonian multipole prefactors, see Eq. 25-27 in
  */
 
@@ -21708,67 +21702,67 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_m1)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 140, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 144, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_m2)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 140, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 144, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate_multipole_prefix", 1, 4, 4, 1); __PYX_ERR(0, 140, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate_multipole_prefix", 1, 4, 4, 1); __PYX_ERR(0, 144, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_l)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 140, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 144, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate_multipole_prefix", 1, 4, 4, 2); __PYX_ERR(0, 140, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate_multipole_prefix", 1, 4, 4, 2); __PYX_ERR(0, 144, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_m)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 140, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 144, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("calculate_multipole_prefix", 1, 4, 4, 3); __PYX_ERR(0, 140, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("calculate_multipole_prefix", 1, 4, 4, 3); __PYX_ERR(0, 144, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate_multipole_prefix") < 0)) __PYX_ERR(0, 140, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate_multipole_prefix") < 0)) __PYX_ERR(0, 144, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 4)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
       values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
     }
-    __pyx_v_m1 = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_m1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 140, __pyx_L3_error)
-    __pyx_v_m2 = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_m2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 140, __pyx_L3_error)
-    __pyx_v_l = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_l == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 140, __pyx_L3_error)
-    __pyx_v_m = __Pyx_PyInt_As_int(values[3]); if (unlikely((__pyx_v_m == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 140, __pyx_L3_error)
+    __pyx_v_m1 = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_m1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 144, __pyx_L3_error)
+    __pyx_v_m2 = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_m2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 144, __pyx_L3_error)
+    __pyx_v_l = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_l == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 144, __pyx_L3_error)
+    __pyx_v_m = __Pyx_PyInt_As_int(values[3]); if (unlikely((__pyx_v_m == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 144, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("calculate_multipole_prefix", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 140, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("calculate_multipole_prefix", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 144, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -21798,18 +21792,18 @@
   __pyx_t_double_complex __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__11)
   __Pyx_RefNannySetupContext("calculate_multipole_prefix", 1);
-  __Pyx_TraceCall("calculate_multipole_prefix (wrapper)", __pyx_f[0], 140, 0, __PYX_ERR(0, 140, __pyx_L1_error));
+  __Pyx_TraceCall("calculate_multipole_prefix (wrapper)", __pyx_f[0], 144, 0, __PYX_ERR(0, 144, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_calculate_multipole_prefix(__pyx_v_m1, __pyx_v_m2, __pyx_v_l, __pyx_v_m, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 140, __pyx_L1_error)
-  __pyx_t_2 = __pyx_PyComplex_FromComplex(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 140, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_calculate_multipole_prefix(__pyx_v_m1, __pyx_v_m2, __pyx_v_l, __pyx_v_m, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 144, __pyx_L1_error)
+  __pyx_t_2 = __pyx_PyComplex_FromComplex(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 144, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -21819,15 +21813,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":225
+/* "pyseobnr/eob/waveform/waveform.pyx":232
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * cpdef compute_newtonian_prefixes(double m1, double m2):             # <<<<<<<<<<<<<<
  *     """
  *     Loop to set the Newtonian multipole prefactors.
  */
 
@@ -21861,246 +21855,246 @@
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("compute_newtonian_prefixes", 1);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":232
+  /* "pyseobnr/eob/waveform/waveform.pyx":239
  *     """
  *     cdef double complex prefixes[9][9]
  *     for i in range(9):             # <<<<<<<<<<<<<<
  *         for j in range(9):
  *             prefixes[i][j]=0.0
  */
   for (__pyx_t_1 = 0; __pyx_t_1 < 9; __pyx_t_1+=1) {
     __pyx_v_i = __pyx_t_1;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":233
+    /* "pyseobnr/eob/waveform/waveform.pyx":240
  *     cdef double complex prefixes[9][9]
  *     for i in range(9):
  *         for j in range(9):             # <<<<<<<<<<<<<<
  *             prefixes[i][j]=0.0
  * 
  */
     for (__pyx_t_2 = 0; __pyx_t_2 < 9; __pyx_t_2+=1) {
       __pyx_v_j = __pyx_t_2;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":234
+      /* "pyseobnr/eob/waveform/waveform.pyx":241
  *     for i in range(9):
  *         for j in range(9):
  *             prefixes[i][j]=0.0             # <<<<<<<<<<<<<<
  * 
  *     for l in range(2, ell_max + 1):
  */
       ((__pyx_v_prefixes[__pyx_v_i])[__pyx_v_j]) = __pyx_t_double_complex_from_parts(0.0, 0);
     }
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":236
+  /* "pyseobnr/eob/waveform/waveform.pyx":243
  *             prefixes[i][j]=0.0
  * 
  *     for l in range(2, ell_max + 1):             # <<<<<<<<<<<<<<
  *         for m in range(1, l + 1):
  *             prefixes[l][m] = calculate_multipole_prefix(m1, m2, l, m)
  */
-  __pyx_t_3 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 236, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_long((ell_max + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 243, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 236, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 243, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_int_2)) __PYX_ERR(0, 236, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_int_2)) __PYX_ERR(0, 243, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_3);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3)) __PYX_ERR(0, 236, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3)) __PYX_ERR(0, 243, __pyx_L1_error);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 236, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 243, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
     __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4);
     __pyx_t_5 = 0;
     __pyx_t_6 = NULL;
   } else {
-    __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 236, __pyx_L1_error)
+    __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 243, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 236, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 243, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   for (;;) {
     if (likely(!__pyx_t_6)) {
       if (likely(PyList_CheckExact(__pyx_t_4))) {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_4);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 236, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 243, __pyx_L1_error)
           #endif
           if (__pyx_t_5 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 236, __pyx_L1_error)
+        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 243, __pyx_L1_error)
         #else
-        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 236, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 243, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       } else {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_4);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 236, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 243, __pyx_L1_error)
           #endif
           if (__pyx_t_5 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 236, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 243, __pyx_L1_error)
         #else
-        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 236, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 243, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       }
     } else {
       __pyx_t_3 = __pyx_t_6(__pyx_t_4);
       if (unlikely(!__pyx_t_3)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 236, __pyx_L1_error)
+          else __PYX_ERR(0, 243, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_3);
     }
     __Pyx_XDECREF_SET(__pyx_v_l, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":237
+    /* "pyseobnr/eob/waveform/waveform.pyx":244
  * 
  *     for l in range(2, ell_max + 1):
  *         for m in range(1, l + 1):             # <<<<<<<<<<<<<<
  *             prefixes[l][m] = calculate_multipole_prefix(m1, m2, l, m)
  *     return prefixes
  */
-    __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_l, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 244, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 237, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 244, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_int_1)) __PYX_ERR(0, 237, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_int_1)) __PYX_ERR(0, 244, __pyx_L1_error);
     __Pyx_GIVEREF(__pyx_t_3);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_3)) __PYX_ERR(0, 244, __pyx_L1_error);
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 244, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
       __pyx_t_7 = __pyx_t_3; __Pyx_INCREF(__pyx_t_7);
       __pyx_t_8 = 0;
       __pyx_t_9 = NULL;
     } else {
-      __pyx_t_8 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 237, __pyx_L1_error)
+      __pyx_t_8 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 244, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_9 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 237, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 244, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     for (;;) {
       if (likely(!__pyx_t_9)) {
         if (likely(PyList_CheckExact(__pyx_t_7))) {
           {
             Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_7);
             #if !CYTHON_ASSUME_SAFE_MACROS
-            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 237, __pyx_L1_error)
+            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 244, __pyx_L1_error)
             #endif
             if (__pyx_t_8 >= __pyx_temp) break;
           }
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely((0 < 0))) __PYX_ERR(0, 237, __pyx_L1_error)
+          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely((0 < 0))) __PYX_ERR(0, 244, __pyx_L1_error)
           #else
-          __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_7, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_7, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 244, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           #endif
         } else {
           {
             Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_7);
             #if !CYTHON_ASSUME_SAFE_MACROS
-            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 237, __pyx_L1_error)
+            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 244, __pyx_L1_error)
             #endif
             if (__pyx_t_8 >= __pyx_temp) break;
           }
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely((0 < 0))) __PYX_ERR(0, 237, __pyx_L1_error)
+          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely((0 < 0))) __PYX_ERR(0, 244, __pyx_L1_error)
           #else
-          __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_7, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_7, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 244, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           #endif
         }
       } else {
         __pyx_t_3 = __pyx_t_9(__pyx_t_7);
         if (unlikely(!__pyx_t_3)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 237, __pyx_L1_error)
+            else __PYX_ERR(0, 244, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_3);
       }
       __Pyx_XDECREF_SET(__pyx_v_m, __pyx_t_3);
       __pyx_t_3 = 0;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":238
+      /* "pyseobnr/eob/waveform/waveform.pyx":245
  *     for l in range(2, ell_max + 1):
  *         for m in range(1, l + 1):
  *             prefixes[l][m] = calculate_multipole_prefix(m1, m2, l, m)             # <<<<<<<<<<<<<<
  *     return prefixes
  * 
  */
-      __pyx_t_10 = __Pyx_PyInt_As_int(__pyx_v_l); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 238, __pyx_L1_error)
-      __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_v_m); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 238, __pyx_L1_error)
-      __pyx_t_12 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_calculate_multipole_prefix(__pyx_v_m1, __pyx_v_m2, __pyx_t_10, __pyx_t_11, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 238, __pyx_L1_error)
-      __pyx_t_13 = __Pyx_PyIndex_AsSsize_t(__pyx_v_l); if (unlikely((__pyx_t_13 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 238, __pyx_L1_error)
-      __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_v_m); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 238, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyInt_As_int(__pyx_v_l); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 245, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_v_m); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 245, __pyx_L1_error)
+      __pyx_t_12 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_calculate_multipole_prefix(__pyx_v_m1, __pyx_v_m2, __pyx_t_10, __pyx_t_11, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 245, __pyx_L1_error)
+      __pyx_t_13 = __Pyx_PyIndex_AsSsize_t(__pyx_v_l); if (unlikely((__pyx_t_13 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 245, __pyx_L1_error)
+      __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_v_m); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 245, __pyx_L1_error)
       ((__pyx_v_prefixes[__pyx_t_13])[__pyx_t_14]) = __pyx_t_12;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":237
+      /* "pyseobnr/eob/waveform/waveform.pyx":244
  * 
  *     for l in range(2, ell_max + 1):
  *         for m in range(1, l + 1):             # <<<<<<<<<<<<<<
  *             prefixes[l][m] = calculate_multipole_prefix(m1, m2, l, m)
  *     return prefixes
  */
     }
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":236
+    /* "pyseobnr/eob/waveform/waveform.pyx":243
  *             prefixes[i][j]=0.0
  * 
  *     for l in range(2, ell_max + 1):             # <<<<<<<<<<<<<<
  *         for m in range(1, l + 1):
  *             prefixes[l][m] = calculate_multipole_prefix(m1, m2, l, m)
  */
   }
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":239
+  /* "pyseobnr/eob/waveform/waveform.pyx":246
  *         for m in range(1, l + 1):
  *             prefixes[l][m] = calculate_multipole_prefix(m1, m2, l, m)
  *     return prefixes             # <<<<<<<<<<<<<<
  * 
- * @cython.cpow(True)
+ * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_4 = __Pyx_carray_to_py___pyx_t_double_complex___5b_9_5d_(__pyx_v_prefixes, 9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 239, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_carray_to_py___pyx_t_double_complex___5b_9_5d_(__pyx_v_prefixes, 9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 246, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_r = __pyx_t_4;
   __pyx_t_4 = 0;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":225
+  /* "pyseobnr/eob/waveform/waveform.pyx":232
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * cpdef compute_newtonian_prefixes(double m1, double m2):             # <<<<<<<<<<<<<<
  *     """
  *     Loop to set the Newtonian multipole prefactors.
  */
 
@@ -22172,43 +22166,43 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_m1)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 225, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 232, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_m2)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 225, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 232, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_newtonian_prefixes", 1, 2, 2, 1); __PYX_ERR(0, 225, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_newtonian_prefixes", 1, 2, 2, 1); __PYX_ERR(0, 232, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_newtonian_prefixes") < 0)) __PYX_ERR(0, 225, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_newtonian_prefixes") < 0)) __PYX_ERR(0, 232, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 2)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
     }
-    __pyx_v_m1 = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_m1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 225, __pyx_L3_error)
-    __pyx_v_m2 = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_m2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 225, __pyx_L3_error)
+    __pyx_v_m1 = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_m1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 232, __pyx_L3_error)
+    __pyx_v_m2 = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_m2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 232, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("compute_newtonian_prefixes", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 225, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("compute_newtonian_prefixes", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 232, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -22236,15 +22230,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("compute_newtonian_prefixes", 1);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_newtonian_prefixes(__pyx_v_m1, __pyx_v_m2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_newtonian_prefixes(__pyx_v_m1, __pyx_v_m2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 232, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -22253,20 +22247,20 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":245
+/* "pyseobnr/eob/waveform/waveform.pyx":253
  * @cython.wraparound(False)
  * @cython.cdivision(True)
- * cpdef double evaluate_nqc_correction_flux(double r, double pr,  double omega, double[:] coeffs):             # <<<<<<<<<<<<<<
- *     """
- *     Calculate the NQC amplitude correction.
+ * cpdef double evaluate_nqc_correction_flux(             # <<<<<<<<<<<<<<
+ *     double r,
+ *     double pr,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_5evaluate_nqc_correction_flux(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
@@ -22279,102 +22273,102 @@
   double __pyx_v_p;
   double __pyx_v_mag;
   double __pyx_r;
   Py_ssize_t __pyx_t_1;
   Py_ssize_t __pyx_t_2;
   Py_ssize_t __pyx_t_3;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":251
+  /* "pyseobnr/eob/waveform/waveform.pyx":264
  *     See Eq. 35 in [SEOBNRv5HM-notes]_.
  *     """
  *     cdef double sqrtR = sqrt(r)             # <<<<<<<<<<<<<<
  *     cdef double rOmega = r * omega
  *     cdef double rOmegaSq = rOmega * rOmega
  */
   __pyx_v_sqrtR = sqrt(__pyx_v_r);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":252
+  /* "pyseobnr/eob/waveform/waveform.pyx":265
  *     """
  *     cdef double sqrtR = sqrt(r)
  *     cdef double rOmega = r * omega             # <<<<<<<<<<<<<<
  *     cdef double rOmegaSq = rOmega * rOmega
  *     cdef double p = pr
  */
   __pyx_v_rOmega = (__pyx_v_r * __pyx_v_omega);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":253
+  /* "pyseobnr/eob/waveform/waveform.pyx":266
  *     cdef double sqrtR = sqrt(r)
  *     cdef double rOmega = r * omega
  *     cdef double rOmegaSq = rOmega * rOmega             # <<<<<<<<<<<<<<
  *     cdef double p = pr
  *     cdef double mag = 1.0 + (p * p / rOmegaSq) * (
  */
   __pyx_v_rOmegaSq = (__pyx_v_rOmega * __pyx_v_rOmega);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":254
+  /* "pyseobnr/eob/waveform/waveform.pyx":267
  *     cdef double rOmega = r * omega
  *     cdef double rOmegaSq = rOmega * rOmega
  *     cdef double p = pr             # <<<<<<<<<<<<<<
  *     cdef double mag = 1.0 + (p * p / rOmegaSq) * (
  *         coeffs[0]
  */
   __pyx_v_p = __pyx_v_pr;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":256
+  /* "pyseobnr/eob/waveform/waveform.pyx":269
  *     cdef double p = pr
  *     cdef double mag = 1.0 + (p * p / rOmegaSq) * (
  *         coeffs[0]             # <<<<<<<<<<<<<<
  *         + coeffs[1] / r
- *         + coeffs[2]  / (r * sqrtR)
+ *         + coeffs[2] / (r * sqrtR)
  */
   __pyx_t_1 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":257
+  /* "pyseobnr/eob/waveform/waveform.pyx":270
  *     cdef double mag = 1.0 + (p * p / rOmegaSq) * (
  *         coeffs[0]
  *         + coeffs[1] / r             # <<<<<<<<<<<<<<
- *         + coeffs[2]  / (r * sqrtR)
+ *         + coeffs[2] / (r * sqrtR)
  *     )
  */
   __pyx_t_2 = 1;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":258
+  /* "pyseobnr/eob/waveform/waveform.pyx":271
  *         coeffs[0]
  *         + coeffs[1] / r
- *         + coeffs[2]  / (r * sqrtR)             # <<<<<<<<<<<<<<
+ *         + coeffs[2] / (r * sqrtR)             # <<<<<<<<<<<<<<
  *     )
  *     return mag
  */
   __pyx_t_3 = 2;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":255
+  /* "pyseobnr/eob/waveform/waveform.pyx":268
  *     cdef double rOmegaSq = rOmega * rOmega
  *     cdef double p = pr
  *     cdef double mag = 1.0 + (p * p / rOmegaSq) * (             # <<<<<<<<<<<<<<
  *         coeffs[0]
  *         + coeffs[1] / r
  */
   __pyx_v_mag = (1.0 + (((__pyx_v_p * __pyx_v_p) / __pyx_v_rOmegaSq) * (((*((double *) ( /* dim=0 */ (__pyx_v_coeffs.data + __pyx_t_1 * __pyx_v_coeffs.strides[0]) ))) + ((*((double *) ( /* dim=0 */ (__pyx_v_coeffs.data + __pyx_t_2 * __pyx_v_coeffs.strides[0]) ))) / __pyx_v_r)) + ((*((double *) ( /* dim=0 */ (__pyx_v_coeffs.data + __pyx_t_3 * __pyx_v_coeffs.strides[0]) ))) / (__pyx_v_r * __pyx_v_sqrtR)))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":260
- *         + coeffs[2]  / (r * sqrtR)
+  /* "pyseobnr/eob/waveform/waveform.pyx":273
+ *         + coeffs[2] / (r * sqrtR)
  *     )
  *     return mag             # <<<<<<<<<<<<<<
  * 
- * @cython.cpow(True)
+ * 
  */
   __pyx_r = __pyx_v_mag;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":245
+  /* "pyseobnr/eob/waveform/waveform.pyx":253
  * @cython.wraparound(False)
  * @cython.cdivision(True)
- * cpdef double evaluate_nqc_correction_flux(double r, double pr,  double omega, double[:] coeffs):             # <<<<<<<<<<<<<<
- *     """
- *     Calculate the NQC amplitude correction.
+ * cpdef double evaluate_nqc_correction_flux(             # <<<<<<<<<<<<<<
+ *     double r,
+ *     double pr,
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
@@ -22437,67 +22431,67 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_r)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 245, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 253, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_pr)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 245, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 253, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("evaluate_nqc_correction_flux", 1, 4, 4, 1); __PYX_ERR(0, 245, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("evaluate_nqc_correction_flux", 1, 4, 4, 1); __PYX_ERR(0, 253, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_omega)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 245, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 253, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("evaluate_nqc_correction_flux", 1, 4, 4, 2); __PYX_ERR(0, 245, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("evaluate_nqc_correction_flux", 1, 4, 4, 2); __PYX_ERR(0, 253, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coeffs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 245, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 253, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("evaluate_nqc_correction_flux", 1, 4, 4, 3); __PYX_ERR(0, 245, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("evaluate_nqc_correction_flux", 1, 4, 4, 3); __PYX_ERR(0, 253, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "evaluate_nqc_correction_flux") < 0)) __PYX_ERR(0, 245, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "evaluate_nqc_correction_flux") < 0)) __PYX_ERR(0, 253, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 4)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
       values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
     }
-    __pyx_v_r = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_r == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 245, __pyx_L3_error)
-    __pyx_v_pr = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_pr == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 245, __pyx_L3_error)
-    __pyx_v_omega = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_omega == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 245, __pyx_L3_error)
-    __pyx_v_coeffs = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_coeffs.memview)) __PYX_ERR(0, 245, __pyx_L3_error)
+    __pyx_v_r = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_r == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 254, __pyx_L3_error)
+    __pyx_v_pr = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_pr == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 255, __pyx_L3_error)
+    __pyx_v_omega = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_omega == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 256, __pyx_L3_error)
+    __pyx_v_coeffs = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_coeffs.memview)) __PYX_ERR(0, 257, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("evaluate_nqc_correction_flux", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 245, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("evaluate_nqc_correction_flux", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 253, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -22528,17 +22522,17 @@
   double __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("evaluate_nqc_correction_flux", 1);
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_coeffs.memview)) { __Pyx_RaiseUnboundLocalError("coeffs"); __PYX_ERR(0, 245, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_evaluate_nqc_correction_flux(__pyx_v_r, __pyx_v_pr, __pyx_v_omega, __pyx_v_coeffs, 0); if (unlikely(__pyx_t_1 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 245, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 245, __pyx_L1_error)
+  if (unlikely(!__pyx_v_coeffs.memview)) { __Pyx_RaiseUnboundLocalError("coeffs"); __PYX_ERR(0, 253, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_evaluate_nqc_correction_flux(__pyx_v_r, __pyx_v_pr, __pyx_v_omega, __pyx_v_coeffs, 0); if (unlikely(__pyx_t_1 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 253, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 253, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -22547,20 +22541,20 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":266
+/* "pyseobnr/eob/waveform/waveform.pyx":280
  * @cython.wraparound(False)
  * @cython.cdivision(True)
- * cpdef compute_tail(double omega, double H, double[:,:] Tlm):             # <<<<<<<<<<<<<<
- *     """
- *     Calculate the resummed Tail effects.
+ * cpdef compute_tail(             # <<<<<<<<<<<<<<
+ *     double omega,
+ *     double H,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_7compute_tail(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
@@ -22585,167 +22579,167 @@
   long __pyx_t_5;
   int __pyx_t_6;
   int __pyx_t_7;
   Py_ssize_t __pyx_t_8;
   Py_ssize_t __pyx_t_9;
   __Pyx_RefNannySetupContext("compute_tail", 1);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":278
- *     cdef int m,j
- *     cdef double k, hathatk,hathatksq4,hathatk4pi,z2
+  /* "pyseobnr/eob/waveform/waveform.pyx":296
+ *     cdef int m, j
+ *     cdef double k, hathatk, hathatksq4, hathatk4pi, z2
  *     cdef double tlmprod_fac = 1.0             # <<<<<<<<<<<<<<
  *     cdef double tlmprefac
  * 
  */
   __pyx_v_tlmprod_fac = 1.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":281
+  /* "pyseobnr/eob/waveform/waveform.pyx":299
  *     cdef double tlmprefac
  * 
- *     for m in range(1,ell_max+1):             # <<<<<<<<<<<<<<
+ *     for m in range(1, ell_max+1):             # <<<<<<<<<<<<<<
  *         k = m*omega
  *         hathatk = H*k
  */
   __pyx_t_1 = (ell_max + 1);
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 1; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_m = __pyx_t_3;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":282
+    /* "pyseobnr/eob/waveform/waveform.pyx":300
  * 
- *     for m in range(1,ell_max+1):
+ *     for m in range(1, ell_max+1):
  *         k = m*omega             # <<<<<<<<<<<<<<
  *         hathatk = H*k
  *         hathatksq4 = 4.0 * hathatk * hathatk
  */
     __pyx_v_k = (__pyx_v_m * __pyx_v_omega);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":283
- *     for m in range(1,ell_max+1):
+    /* "pyseobnr/eob/waveform/waveform.pyx":301
+ *     for m in range(1, ell_max+1):
  *         k = m*omega
  *         hathatk = H*k             # <<<<<<<<<<<<<<
  *         hathatksq4 = 4.0 * hathatk * hathatk
  *         hathatk4pi = 4.0 * pi * hathatk
  */
     __pyx_v_hathatk = (__pyx_v_H * __pyx_v_k);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":284
+    /* "pyseobnr/eob/waveform/waveform.pyx":302
  *         k = m*omega
  *         hathatk = H*k
  *         hathatksq4 = 4.0 * hathatk * hathatk             # <<<<<<<<<<<<<<
  *         hathatk4pi = 4.0 * pi * hathatk
  *         tlmprod_fac = 1.0
  */
     __pyx_v_hathatksq4 = ((4.0 * __pyx_v_hathatk) * __pyx_v_hathatk);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":285
+    /* "pyseobnr/eob/waveform/waveform.pyx":303
  *         hathatk = H*k
  *         hathatksq4 = 4.0 * hathatk * hathatk
  *         hathatk4pi = 4.0 * pi * hathatk             # <<<<<<<<<<<<<<
  *         tlmprod_fac = 1.0
  *         tlmprefac = sqrt(hathatk4pi / (1.0 - exp(-hathatk4pi)))
  */
     __pyx_v_hathatk4pi = ((4.0 * M_PI) * __pyx_v_hathatk);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":286
+    /* "pyseobnr/eob/waveform/waveform.pyx":304
  *         hathatksq4 = 4.0 * hathatk * hathatk
  *         hathatk4pi = 4.0 * pi * hathatk
  *         tlmprod_fac = 1.0             # <<<<<<<<<<<<<<
  *         tlmprefac = sqrt(hathatk4pi / (1.0 - exp(-hathatk4pi)))
  * 
  */
     __pyx_v_tlmprod_fac = 1.0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":287
+    /* "pyseobnr/eob/waveform/waveform.pyx":305
  *         hathatk4pi = 4.0 * pi * hathatk
  *         tlmprod_fac = 1.0
  *         tlmprefac = sqrt(hathatk4pi / (1.0 - exp(-hathatk4pi)))             # <<<<<<<<<<<<<<
  * 
- *         for j in range(1,ell_max+1):
+ *         for j in range(1, ell_max+1):
  */
     __pyx_v_tlmprefac = sqrt((__pyx_v_hathatk4pi / (1.0 - exp((-__pyx_v_hathatk4pi)))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":289
+    /* "pyseobnr/eob/waveform/waveform.pyx":307
  *         tlmprefac = sqrt(hathatk4pi / (1.0 - exp(-hathatk4pi)))
  * 
- *         for j in range(1,ell_max+1):             # <<<<<<<<<<<<<<
+ *         for j in range(1, ell_max+1):             # <<<<<<<<<<<<<<
  *             z2 = LOOKUP_TABLE[j]
  *             tlmprod_fac*= hathatksq4 + j**2
  */
     __pyx_t_4 = (ell_max + 1);
     __pyx_t_5 = __pyx_t_4;
     for (__pyx_t_6 = 1; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
       __pyx_v_j = __pyx_t_6;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":290
+      /* "pyseobnr/eob/waveform/waveform.pyx":308
  * 
- *         for j in range(1,ell_max+1):
+ *         for j in range(1, ell_max+1):
  *             z2 = LOOKUP_TABLE[j]             # <<<<<<<<<<<<<<
  *             tlmprod_fac*= hathatksq4 + j**2
  *             if m>j:
  */
       __pyx_v_z2 = (__pyx_v_8pyseobnr_3eob_8waveform_8waveform_LOOKUP_TABLE[__pyx_v_j]);
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":291
- *         for j in range(1,ell_max+1):
+      /* "pyseobnr/eob/waveform/waveform.pyx":309
+ *         for j in range(1, ell_max+1):
  *             z2 = LOOKUP_TABLE[j]
  *             tlmprod_fac*= hathatksq4 + j**2             # <<<<<<<<<<<<<<
  *             if m>j:
  *                 continue
  */
       __pyx_v_tlmprod_fac = (__pyx_v_tlmprod_fac * (__pyx_v_hathatksq4 + __Pyx_pow_long(((long)__pyx_v_j), 2)));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":292
+      /* "pyseobnr/eob/waveform/waveform.pyx":310
  *             z2 = LOOKUP_TABLE[j]
  *             tlmprod_fac*= hathatksq4 + j**2
  *             if m>j:             # <<<<<<<<<<<<<<
  *                 continue
  *             Tlm[j][m] = tlmprefac*sqrt(tlmprod_fac)/z2
  */
       __pyx_t_7 = (__pyx_v_m > __pyx_v_j);
       if (__pyx_t_7) {
 
-        /* "pyseobnr/eob/waveform/waveform.pyx":293
+        /* "pyseobnr/eob/waveform/waveform.pyx":311
  *             tlmprod_fac*= hathatksq4 + j**2
  *             if m>j:
  *                 continue             # <<<<<<<<<<<<<<
  *             Tlm[j][m] = tlmprefac*sqrt(tlmprod_fac)/z2
  * 
  */
         goto __pyx_L5_continue;
 
-        /* "pyseobnr/eob/waveform/waveform.pyx":292
+        /* "pyseobnr/eob/waveform/waveform.pyx":310
  *             z2 = LOOKUP_TABLE[j]
  *             tlmprod_fac*= hathatksq4 + j**2
  *             if m>j:             # <<<<<<<<<<<<<<
  *                 continue
  *             Tlm[j][m] = tlmprefac*sqrt(tlmprod_fac)/z2
  */
       }
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":294
+      /* "pyseobnr/eob/waveform/waveform.pyx":312
  *             if m>j:
  *                 continue
  *             Tlm[j][m] = tlmprefac*sqrt(tlmprod_fac)/z2             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_8 = __pyx_v_j;
       __pyx_t_9 = __pyx_v_m;
       *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Tlm.data + __pyx_t_8 * __pyx_v_Tlm.strides[0]) ) + __pyx_t_9 * __pyx_v_Tlm.strides[1]) )) = ((__pyx_v_tlmprefac * sqrt(__pyx_v_tlmprod_fac)) / __pyx_v_z2);
       __pyx_L5_continue:;
     }
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":266
+  /* "pyseobnr/eob/waveform/waveform.pyx":280
  * @cython.wraparound(False)
  * @cython.cdivision(True)
- * cpdef compute_tail(double omega, double H, double[:,:] Tlm):             # <<<<<<<<<<<<<<
- *     """
- *     Calculate the resummed Tail effects.
+ * cpdef compute_tail(             # <<<<<<<<<<<<<<
+ *     double omega,
+ *     double H,
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
@@ -22807,55 +22801,55 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_omega)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 266, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 280, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_H)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 266, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 280, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_tail", 1, 3, 3, 1); __PYX_ERR(0, 266, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_tail", 1, 3, 3, 1); __PYX_ERR(0, 280, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_Tlm)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 266, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 280, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_tail", 1, 3, 3, 2); __PYX_ERR(0, 266, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_tail", 1, 3, 3, 2); __PYX_ERR(0, 280, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_tail") < 0)) __PYX_ERR(0, 266, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_tail") < 0)) __PYX_ERR(0, 280, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 3)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
     }
-    __pyx_v_omega = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_omega == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 266, __pyx_L3_error)
-    __pyx_v_H = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_H == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 266, __pyx_L3_error)
-    __pyx_v_Tlm = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_Tlm.memview)) __PYX_ERR(0, 266, __pyx_L3_error)
+    __pyx_v_omega = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_omega == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 281, __pyx_L3_error)
+    __pyx_v_H = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_H == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 282, __pyx_L3_error)
+    __pyx_v_Tlm = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_Tlm.memview)) __PYX_ERR(0, 283, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("compute_tail", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 266, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("compute_tail", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 280, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -22885,16 +22879,16 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("compute_tail", 1);
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_Tlm.memview)) { __Pyx_RaiseUnboundLocalError("Tlm"); __PYX_ERR(0, 266, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_tail(__pyx_v_omega, __pyx_v_H, __pyx_v_Tlm, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 266, __pyx_L1_error)
+  if (unlikely(!__pyx_v_Tlm.memview)) { __Pyx_RaiseUnboundLocalError("Tlm"); __PYX_ERR(0, 280, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_tail(__pyx_v_omega, __pyx_v_H, __pyx_v_Tlm, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 280, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -22903,20 +22897,20 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":304
+/* "pyseobnr/eob/waveform/waveform.pyx":321
  * @cython.nonecheck(False)
  * @cython.initializedcheck(False)
- * cpdef void compute_rho_coeffs(double nu,double dm, double a,double chiS,double chiA,             # <<<<<<<<<<<<<<
- *     double[:,:,:] rho_coeffs,double[:,:,:] rho_coeffs_log, double[:,:,:] f_coeffs,
- *     double complex[:,:,:] f_coeffs_vh, bint extra_PN_terms):
+ * cpdef void compute_rho_coeffs(             # <<<<<<<<<<<<<<
+ *     double nu,
+ *     double dm,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_9compute_rho_coeffs(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
@@ -22937,2770 +22931,2770 @@
   double __pyx_v_m1Plus3nu2;
   double __pyx_v_m1Plus3nu3;
   Py_ssize_t __pyx_t_1;
   Py_ssize_t __pyx_t_2;
   Py_ssize_t __pyx_t_3;
   int __pyx_t_4;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":324
+  /* "pyseobnr/eob/waveform/waveform.pyx":350
  *     """
  * 
  *     cdef double nu2 = nu*nu             # <<<<<<<<<<<<<<
  *     cdef double nu3 = nu*nu2
  * 
  */
   __pyx_v_nu2 = (__pyx_v_nu * __pyx_v_nu);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":325
+  /* "pyseobnr/eob/waveform/waveform.pyx":351
  * 
  *     cdef double nu2 = nu*nu
  *     cdef double nu3 = nu*nu2             # <<<<<<<<<<<<<<
  * 
  *     cdef double a2 = a*a
  */
   __pyx_v_nu3 = (__pyx_v_nu * __pyx_v_nu2);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":327
+  /* "pyseobnr/eob/waveform/waveform.pyx":353
  *     cdef double nu3 = nu*nu2
  * 
  *     cdef double a2 = a*a             # <<<<<<<<<<<<<<
  *     cdef double a3 = a*a2
  *     cdef double dm2 = dm*dm
  */
   __pyx_v_a2 = (__pyx_v_a * __pyx_v_a);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":328
+  /* "pyseobnr/eob/waveform/waveform.pyx":354
  * 
  *     cdef double a2 = a*a
  *     cdef double a3 = a*a2             # <<<<<<<<<<<<<<
  *     cdef double dm2 = dm*dm
  *     cdef double atemp = a
  */
   __pyx_v_a3 = (__pyx_v_a * __pyx_v_a2);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":329
+  /* "pyseobnr/eob/waveform/waveform.pyx":355
  *     cdef double a2 = a*a
  *     cdef double a3 = a*a2
  *     cdef double dm2 = dm*dm             # <<<<<<<<<<<<<<
  *     cdef double atemp = a
  * 
  */
   __pyx_v_dm2 = (__pyx_v_dm * __pyx_v_dm);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":330
+  /* "pyseobnr/eob/waveform/waveform.pyx":356
  *     cdef double a3 = a*a2
  *     cdef double dm2 = dm*dm
  *     cdef double atemp = a             # <<<<<<<<<<<<<<
  * 
  *     cdef double chiA2 = chiA * chiA
  */
   __pyx_v_atemp = __pyx_v_a;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":332
+  /* "pyseobnr/eob/waveform/waveform.pyx":358
  *     cdef double atemp = a
  * 
  *     cdef double chiA2 = chiA * chiA             # <<<<<<<<<<<<<<
  *     cdef double chiS2 = chiS * chiS
  *     cdef double chiA3 = chiA2 * chiA
  */
   __pyx_v_chiA2 = (__pyx_v_chiA * __pyx_v_chiA);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":333
+  /* "pyseobnr/eob/waveform/waveform.pyx":359
  * 
  *     cdef double chiA2 = chiA * chiA
  *     cdef double chiS2 = chiS * chiS             # <<<<<<<<<<<<<<
  *     cdef double chiA3 = chiA2 * chiA
  *     cdef double chiS3 = chiS2 * chiS
  */
   __pyx_v_chiS2 = (__pyx_v_chiS * __pyx_v_chiS);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":334
+  /* "pyseobnr/eob/waveform/waveform.pyx":360
  *     cdef double chiA2 = chiA * chiA
  *     cdef double chiS2 = chiS * chiS
  *     cdef double chiA3 = chiA2 * chiA             # <<<<<<<<<<<<<<
  *     cdef double chiS3 = chiS2 * chiS
  * 
  */
   __pyx_v_chiA3 = (__pyx_v_chiA2 * __pyx_v_chiA);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":335
+  /* "pyseobnr/eob/waveform/waveform.pyx":361
  *     cdef double chiS2 = chiS * chiS
  *     cdef double chiA3 = chiA2 * chiA
  *     cdef double chiS3 = chiS2 * chiS             # <<<<<<<<<<<<<<
  * 
  *     cdef double m1Plus3nu = -1.0 + 3.0 * nu
  */
   __pyx_v_chiS3 = (__pyx_v_chiS2 * __pyx_v_chiS);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":337
+  /* "pyseobnr/eob/waveform/waveform.pyx":363
  *     cdef double chiS3 = chiS2 * chiS
  * 
  *     cdef double m1Plus3nu = -1.0 + 3.0 * nu             # <<<<<<<<<<<<<<
  *     cdef double m1Plus3nu2 = m1Plus3nu * m1Plus3nu
  *     cdef double m1Plus3nu3 = m1Plus3nu * m1Plus3nu2
  */
   __pyx_v_m1Plus3nu = (-1.0 + (3.0 * __pyx_v_nu));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":338
+  /* "pyseobnr/eob/waveform/waveform.pyx":364
  * 
  *     cdef double m1Plus3nu = -1.0 + 3.0 * nu
  *     cdef double m1Plus3nu2 = m1Plus3nu * m1Plus3nu             # <<<<<<<<<<<<<<
  *     cdef double m1Plus3nu3 = m1Plus3nu * m1Plus3nu2
  * 
  */
   __pyx_v_m1Plus3nu2 = (__pyx_v_m1Plus3nu * __pyx_v_m1Plus3nu);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":339
+  /* "pyseobnr/eob/waveform/waveform.pyx":365
  *     cdef double m1Plus3nu = -1.0 + 3.0 * nu
  *     cdef double m1Plus3nu2 = m1Plus3nu * m1Plus3nu
  *     cdef double m1Plus3nu3 = m1Plus3nu * m1Plus3nu2             # <<<<<<<<<<<<<<
  * 
  *     # (2,2) mode begins
  */
   __pyx_v_m1Plus3nu3 = (__pyx_v_m1Plus3nu * __pyx_v_m1Plus3nu2);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":342
+  /* "pyseobnr/eob/waveform/waveform.pyx":368
  * 
  *     # (2,2) mode begins
- *     rho_coeffs[2,2][2] = -43.0 / 42.0 + (55.0 * nu) / 84.0             # <<<<<<<<<<<<<<
- *     rho_coeffs[2,2][3]  = (-2.0 * (chiS + chiA * dm - chiS * nu)) / 3.0
+ *     rho_coeffs[2, 2][2] = -43.0 / 42.0 + (55.0 * nu) / 84.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[2, 2][3] = (-2.0 * (chiS + chiA * dm - chiS * nu)) / 3.0
  * 
  */
   __pyx_t_1 = 2;
   __pyx_t_2 = 2;
   __pyx_t_3 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-43.0 / 42.0) + ((55.0 * __pyx_v_nu) / 84.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":343
+  /* "pyseobnr/eob/waveform/waveform.pyx":369
  *     # (2,2) mode begins
- *     rho_coeffs[2,2][2] = -43.0 / 42.0 + (55.0 * nu) / 84.0
- *     rho_coeffs[2,2][3]  = (-2.0 * (chiS + chiA * dm - chiS * nu)) / 3.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[2, 2][2] = -43.0 / 42.0 + (55.0 * nu) / 84.0
+ *     rho_coeffs[2, 2][3] = (-2.0 * (chiS + chiA * dm - chiS * nu)) / 3.0             # <<<<<<<<<<<<<<
  * 
- *     rho_coeffs[2,2][4]  = (
+ *     rho_coeffs[2, 2][4] = (
  */
   __pyx_t_3 = 2;
   __pyx_t_2 = 2;
   __pyx_t_1 = 3;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * ((__pyx_v_chiS + (__pyx_v_chiA * __pyx_v_dm)) - (__pyx_v_chiS * __pyx_v_nu))) / 3.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":345
- *     rho_coeffs[2,2][3]  = (-2.0 * (chiS + chiA * dm - chiS * nu)) / 3.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":371
+ *     rho_coeffs[2, 2][3] = (-2.0 * (chiS + chiA * dm - chiS * nu)) / 3.0
  * 
- *     rho_coeffs[2,2][4]  = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[2, 2][4] = (             # <<<<<<<<<<<<<<
  *         -20555.0 / 10584.0
  *         + 0.5 * (chiS + chiA * dm) * (chiS + chiA * dm)
  */
   __pyx_t_1 = 2;
   __pyx_t_2 = 2;
   __pyx_t_3 = 4;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-20555.0 / 10584.0) + ((0.5 * (__pyx_v_chiS + (__pyx_v_chiA * __pyx_v_dm))) * (__pyx_v_chiS + (__pyx_v_chiA * __pyx_v_dm)))) - ((33025.0 * __pyx_v_nu) / 21168.0)) + ((19583.0 * __pyx_v_nu2) / 42336.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":352
+  /* "pyseobnr/eob/waveform/waveform.pyx":378
  *     )
  * 
- *     rho_coeffs[2,2][5]  = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[2, 2][5] = (             # <<<<<<<<<<<<<<
  *         -34.0 / 21.0 + 49.0 * nu / 18.0 + 209.0 * nu2 / 126.0
  *     ) * chiS + (-34.0 / 21.0 - 19.0 * nu / 42.0) * dm * chiA
  */
   __pyx_t_3 = 2;
   __pyx_t_2 = 2;
   __pyx_t_1 = 5;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (((((-34.0 / 21.0) + ((49.0 * __pyx_v_nu) / 18.0)) + ((209.0 * __pyx_v_nu2) / 126.0)) * __pyx_v_chiS) + ((((-34.0 / 21.0) - ((19.0 * __pyx_v_nu) / 42.0)) * __pyx_v_dm) * __pyx_v_chiA));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":356
+  /* "pyseobnr/eob/waveform/waveform.pyx":382
  *     ) * chiS + (-34.0 / 21.0 - 19.0 * nu / 42.0) * dm * chiA
  * 
- *     rho_coeffs[2,2][6]  = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[2, 2][6] = (             # <<<<<<<<<<<<<<
  *         1556919113.0 / 122245200.0
  *         + (89.0 * a2) / 252.0
  */
   __pyx_t_1 = 2;
   __pyx_t_2 = 2;
   __pyx_t_3 = 6;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((((((1556919113.0 / 122245200.0) + ((89.0 * __pyx_v_a2) / 252.0)) - ((48993925.0 * __pyx_v_nu) / 9779616.0)) - ((6292061.0 * __pyx_v_nu2) / 3259872.0)) + ((10620745.0 * __pyx_v_nu3) / 39118464.0)) + ((((41.0 * __pyx_v_nu) * M_PI) * M_PI) / 192.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":364
+  /* "pyseobnr/eob/waveform/waveform.pyx":390
  *         + (41.0 * nu * pi * pi) / 192.0
  *     )
- *     rho_coeffs_log[2,2][6] = -428.0 / 105.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs_log[2, 2][6] = -428.0 / 105.0             # <<<<<<<<<<<<<<
  * 
  *     # See https://dcc.ligo.org/T1600383
  */
   __pyx_t_3 = 2;
   __pyx_t_2 = 2;
   __pyx_t_1 = 6;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[2]) )) = (-428.0 / 105.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":367
+  /* "pyseobnr/eob/waveform/waveform.pyx":393
  * 
  *     # See https://dcc.ligo.org/T1600383
- *     rho_coeffs[2,2][7]  = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[2, 2][7] = (             # <<<<<<<<<<<<<<
  *         a3 / 3.0
  *         + chiA
  */
   __pyx_t_1 = 2;
   __pyx_t_2 = 2;
   __pyx_t_3 = 7;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((__pyx_v_a3 / 3.0) + ((__pyx_v_chiA * __pyx_v_dm) * (((18733.0 / 15876.0) + ((50140.0 * __pyx_v_nu) / 3969.0)) + ((97865.0 * __pyx_v_nu2) / 63504.0)))) + (__pyx_v_chiS * ((((18733.0 / 15876.0) + ((74749.0 * __pyx_v_nu) / 5292.0)) - ((245717.0 * __pyx_v_nu2) / 63504.0)) + ((50803.0 * __pyx_v_nu3) / 63504.0))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":381
+  /* "pyseobnr/eob/waveform/waveform.pyx":407
  *     )
  * 
- *     rho_coeffs[2,2][8]  = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[2, 2][8] = (             # <<<<<<<<<<<<<<
  *         -387216563023.0 / 160190110080.0 +
- *             (18353.0 * a2) / 21168.0 - a2 * a2 / 8.0
+ *         (18353.0 * a2) / 21168.0 - a2 * a2 / 8.0
  */
   __pyx_t_3 = 2;
   __pyx_t_2 = 2;
   __pyx_t_1 = 8;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (((-387216563023.0 / 160190110080.0) + ((18353.0 * __pyx_v_a2) / 21168.0)) - ((__pyx_v_a2 * __pyx_v_a2) / 8.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":386
+  /* "pyseobnr/eob/waveform/waveform.pyx":412
  *     )
  * 
- *     rho_coeffs_log[2,2][8] = 9202.0 / 2205.0             # <<<<<<<<<<<<<<
- *     rho_coeffs[2,2][10]  = -16094530514677.0 / 533967033600.0
- *     rho_coeffs_log[2,2][10] = 439877.0 / 55566.0
+ *     rho_coeffs_log[2, 2][8] = 9202.0 / 2205.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[2, 2][10] = -16094530514677.0 / 533967033600.0
+ *     rho_coeffs_log[2, 2][10] = 439877.0 / 55566.0
  */
   __pyx_t_1 = 2;
   __pyx_t_2 = 2;
   __pyx_t_3 = 8;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[2]) )) = (9202.0 / 2205.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":387
+  /* "pyseobnr/eob/waveform/waveform.pyx":413
  * 
- *     rho_coeffs_log[2,2][8] = 9202.0 / 2205.0
- *     rho_coeffs[2,2][10]  = -16094530514677.0 / 533967033600.0             # <<<<<<<<<<<<<<
- *     rho_coeffs_log[2,2][10] = 439877.0 / 55566.0
+ *     rho_coeffs_log[2, 2][8] = 9202.0 / 2205.0
+ *     rho_coeffs[2, 2][10] = -16094530514677.0 / 533967033600.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs_log[2, 2][10] = 439877.0 / 55566.0
  *     # (2,2) mode ends
  */
   __pyx_t_3 = 2;
   __pyx_t_2 = 2;
   __pyx_t_1 = 10;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (-16094530514677.0 / 533967033600.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":388
- *     rho_coeffs_log[2,2][8] = 9202.0 / 2205.0
- *     rho_coeffs[2,2][10]  = -16094530514677.0 / 533967033600.0
- *     rho_coeffs_log[2,2][10] = 439877.0 / 55566.0             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":414
+ *     rho_coeffs_log[2, 2][8] = 9202.0 / 2205.0
+ *     rho_coeffs[2, 2][10] = -16094530514677.0 / 533967033600.0
+ *     rho_coeffs_log[2, 2][10] = 439877.0 / 55566.0             # <<<<<<<<<<<<<<
  *     # (2,2) mode ends
  * 
  */
   __pyx_t_1 = 2;
   __pyx_t_2 = 2;
   __pyx_t_3 = 10;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[2]) )) = (439877.0 / 55566.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":393
+  /* "pyseobnr/eob/waveform/waveform.pyx":419
  *     # We set test-spin terms to 0 (as in SEOBNRv4HM)
  *     # as no major improvement was found when trying to include them
  *     a = 0.0             # <<<<<<<<<<<<<<
  *     a2 = 0.0
  *     a3 = 0.0
  */
   __pyx_v_a = 0.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":394
+  /* "pyseobnr/eob/waveform/waveform.pyx":420
  *     # as no major improvement was found when trying to include them
  *     a = 0.0
  *     a2 = 0.0             # <<<<<<<<<<<<<<
  *     a3 = 0.0
  *     # (2,1) mode begins
  */
   __pyx_v_a2 = 0.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":395
+  /* "pyseobnr/eob/waveform/waveform.pyx":421
  *     a = 0.0
  *     a2 = 0.0
  *     a3 = 0.0             # <<<<<<<<<<<<<<
  *     # (2,1) mode begins
  *     if dm2:
  */
   __pyx_v_a3 = 0.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":397
+  /* "pyseobnr/eob/waveform/waveform.pyx":423
  *     a3 = 0.0
  *     # (2,1) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[2,1][1] = 0.0
- *         rho_coeffs[2,1][2] = -59.0 / 56 + (23.0 * nu) / 84.0
+ *         rho_coeffs[2, 1][1] = 0.0
+ *         rho_coeffs[2, 1][2] = -59.0 / 56 + (23.0 * nu) / 84.0
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":398
+    /* "pyseobnr/eob/waveform/waveform.pyx":424
  *     # (2,1) mode begins
  *     if dm2:
- *         rho_coeffs[2,1][1] = 0.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[2,1][2] = -59.0 / 56 + (23.0 * nu) / 84.0
- *         rho_coeffs[2,1][3] = 0.0
+ *         rho_coeffs[2, 1][1] = 0.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[2, 1][2] = -59.0 / 56 + (23.0 * nu) / 84.0
+ *         rho_coeffs[2, 1][3] = 0.0
  */
     __pyx_t_3 = 2;
     __pyx_t_2 = 1;
     __pyx_t_1 = 1;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = 0.0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":399
+    /* "pyseobnr/eob/waveform/waveform.pyx":425
  *     if dm2:
- *         rho_coeffs[2,1][1] = 0.0
- *         rho_coeffs[2,1][2] = -59.0 / 56 + (23.0 * nu) / 84.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[2,1][3] = 0.0
+ *         rho_coeffs[2, 1][1] = 0.0
+ *         rho_coeffs[2, 1][2] = -59.0 / 56 + (23.0 * nu) / 84.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[2, 1][3] = 0.0
  * 
  */
     __pyx_t_1 = 2;
     __pyx_t_2 = 1;
     __pyx_t_3 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-59.0 / 56.0) + ((23.0 * __pyx_v_nu) / 84.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":400
- *         rho_coeffs[2,1][1] = 0.0
- *         rho_coeffs[2,1][2] = -59.0 / 56 + (23.0 * nu) / 84.0
- *         rho_coeffs[2,1][3] = 0.0             # <<<<<<<<<<<<<<
+    /* "pyseobnr/eob/waveform/waveform.pyx":426
+ *         rho_coeffs[2, 1][1] = 0.0
+ *         rho_coeffs[2, 1][2] = -59.0 / 56 + (23.0 * nu) / 84.0
+ *         rho_coeffs[2, 1][3] = 0.0             # <<<<<<<<<<<<<<
  * 
- *         rho_coeffs[2,1][4] = (
+ *         rho_coeffs[2, 1][4] = (
  */
     __pyx_t_3 = 2;
     __pyx_t_2 = 1;
     __pyx_t_1 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = 0.0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":402
- *         rho_coeffs[2,1][3] = 0.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":428
+ *         rho_coeffs[2, 1][3] = 0.0
  * 
- *         rho_coeffs[2,1][4] = (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[2, 1][4] = (             # <<<<<<<<<<<<<<
  *             -47009.0 / 56448.0
  *             - (865.0 * a2) / 1792.0
  */
     __pyx_t_1 = 2;
     __pyx_t_2 = 1;
     __pyx_t_3 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((((-47009.0 / 56448.0) - ((865.0 * __pyx_v_a2) / 1792.0)) - (((405.0 * __pyx_v_a2) * __pyx_v_a2) / 2048.0)) - ((10993.0 * __pyx_v_nu) / 14112.0)) + ((617.0 * __pyx_v_nu2) / 4704.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":409
+    /* "pyseobnr/eob/waveform/waveform.pyx":435
  *             + (617.0 * nu2) / 4704.0
  *         )
- *         rho_coeffs[2,1][5] = (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[2, 1][5] = (             # <<<<<<<<<<<<<<
  *             (-98635.0 * a) / 75264.0
  *             + (2031.0 * a * a2) / 7168.0
  */
     __pyx_t_3 = 2;
     __pyx_t_2 = 1;
     __pyx_t_1 = 5;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-98635.0 * __pyx_v_a) / 75264.0) + (((2031.0 * __pyx_v_a) * __pyx_v_a2) / 7168.0)) - (((1701.0 * __pyx_v_a2) * __pyx_v_a3) / 8192.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":414
+    /* "pyseobnr/eob/waveform/waveform.pyx":440
  *             - (1701.0 * a2 * a3) / 8192.0
  *         )
- *         rho_coeffs[2,1][6] = (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[2, 1][6] = (             # <<<<<<<<<<<<<<
  *             7613184941.0 / 2607897600.0
  *             + (9032393.0 * a2) / 1806336.0
  */
     __pyx_t_1 = 2;
     __pyx_t_2 = 1;
     __pyx_t_3 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((((7613184941.0 / 2607897600.0) + ((9032393.0 * __pyx_v_a2) / 1806336.0)) + (((3897.0 * __pyx_v_a2) * __pyx_v_a2) / 16384.0)) - (((15309.0 * __pyx_v_a3) * __pyx_v_a3) / 65536.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":420
+    /* "pyseobnr/eob/waveform/waveform.pyx":446
  *             - (15309.0 * a3 * a3) / 65536.0
  *         )
- *         rho_coeffs_log[2,1][6] = -107.0 / 105.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[2,1][7] = (
+ *         rho_coeffs_log[2, 1][6] = -107.0 / 105.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[2, 1][7] = (
  *             (-3859374457.0 * a) / 1159065600.0
  */
     __pyx_t_3 = 2;
     __pyx_t_2 = 1;
     __pyx_t_1 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[2]) )) = (-107.0 / 105.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":421
+    /* "pyseobnr/eob/waveform/waveform.pyx":447
  *         )
- *         rho_coeffs_log[2,1][6] = -107.0 / 105.0
- *         rho_coeffs[2,1][7] = (             # <<<<<<<<<<<<<<
+ *         rho_coeffs_log[2, 1][6] = -107.0 / 105.0
+ *         rho_coeffs[2, 1][7] = (             # <<<<<<<<<<<<<<
  *             (-3859374457.0 * a) / 1159065600.0
  *             - (55169.0 * a3) / 16384.0
  */
     __pyx_t_1 = 2;
     __pyx_t_2 = 1;
     __pyx_t_3 = 7;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((((-3859374457.0 * __pyx_v_a) / 1159065600.0) - ((55169.0 * __pyx_v_a3) / 16384.0)) + (((18603.0 * __pyx_v_a2) * __pyx_v_a3) / 65536.0)) - ((((72171.0 * __pyx_v_a2) * __pyx_v_a2) * __pyx_v_a3) / 262144.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":427
+    /* "pyseobnr/eob/waveform/waveform.pyx":453
  *             - (72171.0 * a2 * a2 * a3) / 262144.0
  *         )
- *         rho_coeffs_log[2,1][7] = 107.0 * a / 140.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[2,1][8] = -1168617463883.0 / 911303737344.0
- *         rho_coeffs_log[2,1][8] = 6313.0 / 5880.0
+ *         rho_coeffs_log[2, 1][7] = 107.0 * a / 140.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[2, 1][8] = -1168617463883.0 / 911303737344.0
+ *         rho_coeffs_log[2, 1][8] = 6313.0 / 5880.0
  */
     __pyx_t_3 = 2;
     __pyx_t_2 = 1;
     __pyx_t_1 = 7;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[2]) )) = ((107.0 * __pyx_v_a) / 140.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":428
+    /* "pyseobnr/eob/waveform/waveform.pyx":454
  *         )
- *         rho_coeffs_log[2,1][7] = 107.0 * a / 140.0
- *         rho_coeffs[2,1][8] = -1168617463883.0 / 911303737344.0             # <<<<<<<<<<<<<<
- *         rho_coeffs_log[2,1][8] = 6313.0 / 5880.0
- *         rho_coeffs[2,1][10] = -63735873771463.0 / 16569158860800.0
+ *         rho_coeffs_log[2, 1][7] = 107.0 * a / 140.0
+ *         rho_coeffs[2, 1][8] = -1168617463883.0 / 911303737344.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs_log[2, 1][8] = 6313.0 / 5880.0
+ *         rho_coeffs[2, 1][10] = -63735873771463.0 / 16569158860800.0
  */
     __pyx_t_1 = 2;
     __pyx_t_2 = 1;
     __pyx_t_3 = 8;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (-1168617463883.0 / 911303737344.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":429
- *         rho_coeffs_log[2,1][7] = 107.0 * a / 140.0
- *         rho_coeffs[2,1][8] = -1168617463883.0 / 911303737344.0
- *         rho_coeffs_log[2,1][8] = 6313.0 / 5880.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[2,1][10] = -63735873771463.0 / 16569158860800.0
- *         rho_coeffs_log[2,1][10] = 5029963.0 / 5927040.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":455
+ *         rho_coeffs_log[2, 1][7] = 107.0 * a / 140.0
+ *         rho_coeffs[2, 1][8] = -1168617463883.0 / 911303737344.0
+ *         rho_coeffs_log[2, 1][8] = 6313.0 / 5880.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[2, 1][10] = -63735873771463.0 / 16569158860800.0
+ *         rho_coeffs_log[2, 1][10] = 5029963.0 / 5927040.0
  */
     __pyx_t_3 = 2;
     __pyx_t_2 = 1;
     __pyx_t_1 = 8;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[2]) )) = (6313.0 / 5880.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":430
- *         rho_coeffs[2,1][8] = -1168617463883.0 / 911303737344.0
- *         rho_coeffs_log[2,1][8] = 6313.0 / 5880.0
- *         rho_coeffs[2,1][10] = -63735873771463.0 / 16569158860800.0             # <<<<<<<<<<<<<<
- *         rho_coeffs_log[2,1][10] = 5029963.0 / 5927040.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":456
+ *         rho_coeffs[2, 1][8] = -1168617463883.0 / 911303737344.0
+ *         rho_coeffs_log[2, 1][8] = 6313.0 / 5880.0
+ *         rho_coeffs[2, 1][10] = -63735873771463.0 / 16569158860800.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs_log[2, 1][10] = 5029963.0 / 5927040.0
  * 
  */
     __pyx_t_1 = 2;
     __pyx_t_2 = 1;
     __pyx_t_3 = 10;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (-63735873771463.0 / 16569158860800.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":431
- *         rho_coeffs_log[2,1][8] = 6313.0 / 5880.0
- *         rho_coeffs[2,1][10] = -63735873771463.0 / 16569158860800.0
- *         rho_coeffs_log[2,1][10] = 5029963.0 / 5927040.0             # <<<<<<<<<<<<<<
+    /* "pyseobnr/eob/waveform/waveform.pyx":457
+ *         rho_coeffs_log[2, 1][8] = 6313.0 / 5880.0
+ *         rho_coeffs[2, 1][10] = -63735873771463.0 / 16569158860800.0
+ *         rho_coeffs_log[2, 1][10] = 5029963.0 / 5927040.0             # <<<<<<<<<<<<<<
  * 
- *         f_coeffs[2,1][1] = (-3.0 * (chiS + chiA / dm)) / (2.0)
+ *         f_coeffs[2, 1][1] = (-3.0 * (chiS + chiA / dm)) / (2.0)
  */
     __pyx_t_3 = 2;
     __pyx_t_2 = 1;
     __pyx_t_1 = 10;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[2]) )) = (5029963.0 / 5927040.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":433
- *         rho_coeffs_log[2,1][10] = 5029963.0 / 5927040.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":459
+ *         rho_coeffs_log[2, 1][10] = 5029963.0 / 5927040.0
  * 
- *         f_coeffs[2,1][1] = (-3.0 * (chiS + chiA / dm)) / (2.0)             # <<<<<<<<<<<<<<
+ *         f_coeffs[2, 1][1] = (-3.0 * (chiS + chiA / dm)) / (2.0)             # <<<<<<<<<<<<<<
  * 
- *         f_coeffs[2,1][3] = (
+ *         f_coeffs[2, 1][3] = (
  */
     __pyx_t_1 = 2;
     __pyx_t_2 = 1;
     __pyx_t_3 = 1;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = ((-3.0 * (__pyx_v_chiS + (__pyx_v_chiA / __pyx_v_dm))) / 2.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":435
- *         f_coeffs[2,1][1] = (-3.0 * (chiS + chiA / dm)) / (2.0)
+    /* "pyseobnr/eob/waveform/waveform.pyx":461
+ *         f_coeffs[2, 1][1] = (-3.0 * (chiS + chiA / dm)) / (2.0)
  * 
- *         f_coeffs[2,1][3] = (             # <<<<<<<<<<<<<<
+ *         f_coeffs[2, 1][3] = (             # <<<<<<<<<<<<<<
  *             (
  *                 chiS * dm * (427.0 + 79.0 * nu)
  */
     __pyx_t_3 = 2;
     __pyx_t_2 = 1;
     __pyx_t_1 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = (((((__pyx_v_chiS * __pyx_v_dm) * (427.0 + (79.0 * __pyx_v_nu))) + (__pyx_v_chiA * ((147.0 + ((280.0 * __pyx_v_dm) * __pyx_v_dm)) + (1251.0 * __pyx_v_nu)))) / 84.0) / __pyx_v_dm);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":447
+    /* "pyseobnr/eob/waveform/waveform.pyx":472
  * 
  *         # RC: This terms are in Eq.A11 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
- *         f_coeffs[2,1][4] = (             # <<<<<<<<<<<<<<
+ *         f_coeffs[2, 1][4] = (             # <<<<<<<<<<<<<<
  *             (-3.0 - 2.0 * nu) * chiA2
  *             + (-3.0 + nu / 2.0) * chiS2
  */
     __pyx_t_1 = 2;
     __pyx_t_2 = 1;
     __pyx_t_3 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = ((((-3.0 - (2.0 * __pyx_v_nu)) * __pyx_v_chiA2) + ((-3.0 + (__pyx_v_nu / 2.0)) * __pyx_v_chiS2)) + ((((-6.0 + ((21.0 * __pyx_v_nu) / 2.0)) * __pyx_v_chiS) * __pyx_v_chiA) / __pyx_v_dm));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":452
+    /* "pyseobnr/eob/waveform/waveform.pyx":477
  *             + (-6.0 + 21.0 * nu / 2.0) * chiS * chiA / dm
  *         )
- *         f_coeffs[2,1][5] = (             # <<<<<<<<<<<<<<
+ *         f_coeffs[2, 1][5] = (             # <<<<<<<<<<<<<<
  *             (3.0 / 4.0 - 3.0 * nu) * chiA3 / dm
  *             + (
  */
     __pyx_t_3 = 2;
     __pyx_t_2 = 1;
     __pyx_t_1 = 5;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = (((((((3.0 / 4.0) - (3.0 * __pyx_v_nu)) * __pyx_v_chiA3) / __pyx_v_dm) + (((((-81.0 / 16.0) + ((1709.0 * __pyx_v_nu) / 1008.0)) + ((613.0 * __pyx_v_nu2) / 1008.0)) + (((9.0 / 4.0) - (3.0 * __pyx_v_nu)) * __pyx_v_chiA2)) * __pyx_v_chiS)) + ((3.0 / 4.0) * __pyx_v_chiS3)) + ((((((-81.0 / 16.0) - ((703.0 * __pyx_v_nu2) / 112.0)) + ((8797.0 * __pyx_v_nu) / 1008.0)) + (((9.0 / 4.0) - (6.0 * __pyx_v_nu)) * __pyx_v_chiS2)) * __pyx_v_chiA) / __pyx_v_dm));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":484
- *         )
- *         '''
- *         f_coeffs[2,1][6] = (((16652 - 9287*nu + 720*nu**2)*chiA**2)/1008 +             # <<<<<<<<<<<<<<
- *                             ((16652 - 39264*nu + 9487*nu**2)*chiA*chiS)/(504*dm) +
- *                             ((16652 - 2633*nu + 1946*nu**2)*chiS**2)/1008)
+    /* "pyseobnr/eob/waveform/waveform.pyx":509
+ *         # )
+ * 
+ *         f_coeffs[2, 1][6] = (((16652 - 9287*nu + 720*nu**2)*chiA**2)/1008 +             # <<<<<<<<<<<<<<
+ *                              ((16652 - 39264*nu + 9487*nu**2)*chiA*chiS)/(504*dm) +
+ *                              ((16652 - 2633*nu + 1946*nu**2)*chiS**2)/1008)
  */
     __pyx_t_1 = 2;
     __pyx_t_2 = 1;
     __pyx_t_3 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = ((((((16652.0 - (9287.0 * __pyx_v_nu)) + (720.0 * pow(__pyx_v_nu, 2.0))) * pow(__pyx_v_chiA, 2.0)) / 1008.0) + (((((16652.0 - (39264.0 * __pyx_v_nu)) + (9487.0 * pow(__pyx_v_nu, 2.0))) * __pyx_v_chiA) * __pyx_v_chiS) / (504.0 * __pyx_v_dm))) + ((((16652.0 - (2633.0 * __pyx_v_nu)) + (1946.0 * pow(__pyx_v_nu, 2.0))) * pow(__pyx_v_chiS, 2.0)) / 1008.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":397
+    /* "pyseobnr/eob/waveform/waveform.pyx":423
  *     a3 = 0.0
  *     # (2,1) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[2,1][1] = 0.0
- *         rho_coeffs[2,1][2] = -59.0 / 56 + (23.0 * nu) / 84.0
+ *         rho_coeffs[2, 1][1] = 0.0
+ *         rho_coeffs[2, 1][2] = -59.0 / 56 + (23.0 * nu) / 84.0
  */
     goto __pyx_L3;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":488
- *                             ((16652 - 2633*nu + 1946*nu**2)*chiS**2)/1008)
+  /* "pyseobnr/eob/waveform/waveform.pyx":513
+ *                              ((16652 - 2633*nu + 1946*nu**2)*chiS**2)/1008)
  *     else:
- *         f_coeffs[2,1][1] = -3.0 * chiA / 2.0             # <<<<<<<<<<<<<<
- *         f_coeffs[2,1][3] = (
+ *         f_coeffs[2, 1][1] = -3.0 * chiA / 2.0             # <<<<<<<<<<<<<<
+ *         f_coeffs[2, 1][3] = (
  *             chiS * dm * (427.0 + 79.0 * nu)
  */
   /*else*/ {
     __pyx_t_3 = 2;
     __pyx_t_2 = 1;
     __pyx_t_1 = 1;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = ((-3.0 * __pyx_v_chiA) / 2.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":489
+    /* "pyseobnr/eob/waveform/waveform.pyx":514
  *     else:
- *         f_coeffs[2,1][1] = -3.0 * chiA / 2.0
- *         f_coeffs[2,1][3] = (             # <<<<<<<<<<<<<<
+ *         f_coeffs[2, 1][1] = -3.0 * chiA / 2.0
+ *         f_coeffs[2, 1][3] = (             # <<<<<<<<<<<<<<
  *             chiS * dm * (427.0 + 79.0 * nu)
  *             + chiA * (147.0 + 280.0 * dm * dm + 1251.0 * nu)
  */
     __pyx_t_1 = 2;
     __pyx_t_2 = 1;
     __pyx_t_3 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = ((((__pyx_v_chiS * __pyx_v_dm) * (427.0 + (79.0 * __pyx_v_nu))) + (__pyx_v_chiA * ((147.0 + ((280.0 * __pyx_v_dm) * __pyx_v_dm)) + (1251.0 * __pyx_v_nu)))) / 84.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":496
+    /* "pyseobnr/eob/waveform/waveform.pyx":521
  * 
  *         # RC: This terms are in Eq.A11 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
- *         f_coeffs[2,1][4] = (-6 + 21 * nu / 2.0) * chiS * chiA             # <<<<<<<<<<<<<<
- *         f_coeffs[2,1][5] = (3.0 / 4.0 - 3.0 * nu) * chiA3 + (
+ *         f_coeffs[2, 1][4] = (-6 + 21 * nu / 2.0) * chiS * chiA             # <<<<<<<<<<<<<<
+ *         f_coeffs[2, 1][5] = (3.0 / 4.0 - 3.0 * nu) * chiA3 + (
  *             -81.0 / 16.0
  */
     __pyx_t_3 = 2;
     __pyx_t_2 = 1;
     __pyx_t_1 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = (((-6.0 + ((21.0 * __pyx_v_nu) / 2.0)) * __pyx_v_chiS) * __pyx_v_chiA);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":497
+    /* "pyseobnr/eob/waveform/waveform.pyx":522
  *         # RC: This terms are in Eq.A11 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
- *         f_coeffs[2,1][4] = (-6 + 21 * nu / 2.0) * chiS * chiA
- *         f_coeffs[2,1][5] = (3.0 / 4.0 - 3.0 * nu) * chiA3 + (             # <<<<<<<<<<<<<<
+ *         f_coeffs[2, 1][4] = (-6 + 21 * nu / 2.0) * chiS * chiA
+ *         f_coeffs[2, 1][5] = (3.0 / 4.0 - 3.0 * nu) * chiA3 + (             # <<<<<<<<<<<<<<
  *             -81.0 / 16.0
  *             - 703.0 * nu2 / 112.0
  */
     __pyx_t_1 = 2;
     __pyx_t_2 = 1;
     __pyx_t_3 = 5;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = ((((3.0 / 4.0) - (3.0 * __pyx_v_nu)) * __pyx_v_chiA3) + (((((-81.0 / 16.0) - ((703.0 * __pyx_v_nu2) / 112.0)) + ((8797.0 * __pyx_v_nu) / 1008.0)) + (((9.0 / 4.0) - (6.0 * __pyx_v_nu)) * __pyx_v_chiS2)) * __pyx_v_chiA));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":511
- *         )
- *         '''
- *         f_coeffs[2,1][6] = ((16652 - 39264*nu + 9487*nu**2)*chiA*chiS)/504             # <<<<<<<<<<<<<<
+    /* "pyseobnr/eob/waveform/waveform.pyx":535
+ *         #     * chiA
+ *         # )
+ *         f_coeffs[2, 1][6] = ((16652 - 39264*nu + 9487*nu**2)*chiA*chiS)/504             # <<<<<<<<<<<<<<
  * 
  *     # (2,1) mode ends
  */
     __pyx_t_3 = 2;
     __pyx_t_2 = 1;
     __pyx_t_1 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = (((((16652.0 - (39264.0 * __pyx_v_nu)) + (9487.0 * pow(__pyx_v_nu, 2.0))) * __pyx_v_chiA) * __pyx_v_chiS) / 504.0);
   }
   __pyx_L3:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":517
+  /* "pyseobnr/eob/waveform/waveform.pyx":541
  *     # (3,3) mode begins
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[3,3][2] = -7.0 / 6.0 + (2.0 * nu) / 3.0
- *         rho_coeffs[3,3][3] = 0.0
+ *         rho_coeffs[3, 3][2] = -7.0 / 6.0 + (2.0 * nu) / 3.0
+ *         rho_coeffs[3, 3][3] = 0.0
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":518
+    /* "pyseobnr/eob/waveform/waveform.pyx":542
  * 
  *     if dm2:
- *         rho_coeffs[3,3][2] = -7.0 / 6.0 + (2.0 * nu) / 3.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[3,3][3] = 0.0
- *         rho_coeffs[3,3][4] = (
+ *         rho_coeffs[3, 3][2] = -7.0 / 6.0 + (2.0 * nu) / 3.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[3, 3][3] = 0.0
+ *         rho_coeffs[3, 3][4] = (
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 3;
     __pyx_t_3 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-7.0 / 6.0) + ((2.0 * __pyx_v_nu) / 3.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":519
+    /* "pyseobnr/eob/waveform/waveform.pyx":543
  *     if dm2:
- *         rho_coeffs[3,3][2] = -7.0 / 6.0 + (2.0 * nu) / 3.0
- *         rho_coeffs[3,3][3] = 0.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[3,3][4] = (
+ *         rho_coeffs[3, 3][2] = -7.0 / 6.0 + (2.0 * nu) / 3.0
+ *         rho_coeffs[3, 3][3] = 0.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[3, 3][4] = (
  *             -6719.0 / 3960.0
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 3;
     __pyx_t_1 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = 0.0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":520
- *         rho_coeffs[3,3][2] = -7.0 / 6.0 + (2.0 * nu) / 3.0
- *         rho_coeffs[3,3][3] = 0.0
- *         rho_coeffs[3,3][4] = (             # <<<<<<<<<<<<<<
+    /* "pyseobnr/eob/waveform/waveform.pyx":544
+ *         rho_coeffs[3, 3][2] = -7.0 / 6.0 + (2.0 * nu) / 3.0
+ *         rho_coeffs[3, 3][3] = 0.0
+ *         rho_coeffs[3, 3][4] = (             # <<<<<<<<<<<<<<
  *             -6719.0 / 3960.0
  *             + a2 / 2.0
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 3;
     __pyx_t_3 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-6719.0 / 3960.0) + (__pyx_v_a2 / 2.0)) - ((1861.0 * __pyx_v_nu) / 990.0)) + ((149.0 * __pyx_v_nu2) / 330.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":526
+    /* "pyseobnr/eob/waveform/waveform.pyx":550
  *             + (149.0 * nu2) / 330.0
  *         )
- *         rho_coeffs[3,3][5] = (-4.0 * a) / 3.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[3,3][6] = (
+ *         rho_coeffs[3, 3][5] = (-4.0 * a) / 3.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[3, 3][6] = (
  *                 3203101567.0 / 227026800.0
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 3;
     __pyx_t_1 = 5;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-4.0 * __pyx_v_a) / 3.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":527
+    /* "pyseobnr/eob/waveform/waveform.pyx":551
  *         )
- *         rho_coeffs[3,3][5] = (-4.0 * a) / 3.0
- *         rho_coeffs[3,3][6] = (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[3, 3][5] = (-4.0 * a) / 3.0
+ *         rho_coeffs[3, 3][6] = (             # <<<<<<<<<<<<<<
  *                 3203101567.0 / 227026800.0
  *                 + (5.0 * a2) / 36.0
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 3;
     __pyx_t_3 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((((3203101567.0 / 227026800.0) + ((5.0 * __pyx_v_a2) / 36.0)) + (((-129509.0 / 25740.0) + (((41.0 / 192.0) * M_PI) * M_PI)) * __pyx_v_nu)) - ((274621.0 / 154440.0) * __pyx_v_nu2)) + ((12011.0 / 46332.0) * __pyx_v_nu3));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":534
+    /* "pyseobnr/eob/waveform/waveform.pyx":558
  *                 + 12011.0 / 46332.0 * nu3
  *             )
- *         rho_coeffs_log[3,3][6] = -26.0 / 7.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[3,3][7] = (5297.0 * a) / 2970.0 + a * a2 / 3.0
- *         rho_coeffs[3,3][8] = -57566572157.0 / 8562153600.0
+ *         rho_coeffs_log[3, 3][6] = -26.0 / 7.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[3, 3][7] = (5297.0 * a) / 2970.0 + a * a2 / 3.0
+ *         rho_coeffs[3, 3][8] = -57566572157.0 / 8562153600.0
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 3;
     __pyx_t_1 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[2]) )) = (-26.0 / 7.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":535
+    /* "pyseobnr/eob/waveform/waveform.pyx":559
  *             )
- *         rho_coeffs_log[3,3][6] = -26.0 / 7.0
- *         rho_coeffs[3,3][7] = (5297.0 * a) / 2970.0 + a * a2 / 3.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[3,3][8] = -57566572157.0 / 8562153600.0
- *         rho_coeffs_log[3,3][8] = 13.0 / 3.0
+ *         rho_coeffs_log[3, 3][6] = -26.0 / 7.0
+ *         rho_coeffs[3, 3][7] = (5297.0 * a) / 2970.0 + a * a2 / 3.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[3, 3][8] = -57566572157.0 / 8562153600.0
+ *         rho_coeffs_log[3, 3][8] = 13.0 / 3.0
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 3;
     __pyx_t_3 = 7;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((5297.0 * __pyx_v_a) / 2970.0) + ((__pyx_v_a * __pyx_v_a2) / 3.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":536
- *         rho_coeffs_log[3,3][6] = -26.0 / 7.0
- *         rho_coeffs[3,3][7] = (5297.0 * a) / 2970.0 + a * a2 / 3.0
- *         rho_coeffs[3,3][8] = -57566572157.0 / 8562153600.0             # <<<<<<<<<<<<<<
- *         rho_coeffs_log[3,3][8] = 13.0 / 3.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":560
+ *         rho_coeffs_log[3, 3][6] = -26.0 / 7.0
+ *         rho_coeffs[3, 3][7] = (5297.0 * a) / 2970.0 + a * a2 / 3.0
+ *         rho_coeffs[3, 3][8] = -57566572157.0 / 8562153600.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs_log[3, 3][8] = 13.0 / 3.0
  * 
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 3;
     __pyx_t_1 = 8;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (-57566572157.0 / 8562153600.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":537
- *         rho_coeffs[3,3][7] = (5297.0 * a) / 2970.0 + a * a2 / 3.0
- *         rho_coeffs[3,3][8] = -57566572157.0 / 8562153600.0
- *         rho_coeffs_log[3,3][8] = 13.0 / 3.0             # <<<<<<<<<<<<<<
- * 
+    /* "pyseobnr/eob/waveform/waveform.pyx":561
+ *         rho_coeffs[3, 3][7] = (5297.0 * a) / 2970.0 + a * a2 / 3.0
+ *         rho_coeffs[3, 3][8] = -57566572157.0 / 8562153600.0
+ *         rho_coeffs_log[3, 3][8] = 13.0 / 3.0             # <<<<<<<<<<<<<<
  * 
+ *         rho_coeffs[3, 3][10] = -903823148417327.0 / 30566888352000.0
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 3;
     __pyx_t_3 = 8;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[2]) )) = (13.0 / 3.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":540
- * 
+    /* "pyseobnr/eob/waveform/waveform.pyx":563
+ *         rho_coeffs_log[3, 3][8] = 13.0 / 3.0
  * 
- *         rho_coeffs[3,3][10] = -903823148417327.0 / 30566888352000.0             # <<<<<<<<<<<<<<
- *         rho_coeffs_log[3,3][10] = 87347.0 / 13860.0
+ *         rho_coeffs[3, 3][10] = -903823148417327.0 / 30566888352000.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs_log[3, 3][10] = 87347.0 / 13860.0
  * 
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 3;
     __pyx_t_1 = 10;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (-903823148417327.0 / 30566888352000.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":541
+    /* "pyseobnr/eob/waveform/waveform.pyx":564
  * 
- *         rho_coeffs[3,3][10] = -903823148417327.0 / 30566888352000.0
- *         rho_coeffs_log[3,3][10] = 87347.0 / 13860.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[3, 3][10] = -903823148417327.0 / 30566888352000.0
+ *         rho_coeffs_log[3, 3][10] = 87347.0 / 13860.0             # <<<<<<<<<<<<<<
  * 
- *         f_coeffs[3,3][3]= (
+ *         f_coeffs[3, 3][3]= (
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 3;
     __pyx_t_3 = 10;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[2]) )) = (87347.0 / 13860.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":543
- *         rho_coeffs_log[3,3][10] = 87347.0 / 13860.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":566
+ *         rho_coeffs_log[3, 3][10] = 87347.0 / 13860.0
  * 
- *         f_coeffs[3,3][3]= (             # <<<<<<<<<<<<<<
+ *         f_coeffs[3, 3][3]= (             # <<<<<<<<<<<<<<
  *             chiS * dm * (-4.0 + 5.0 * nu) + chiA * (-4.0 + 19.0 * nu)
  *         ) / (2.0 * dm)
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 3;
     __pyx_t_1 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = ((((__pyx_v_chiS * __pyx_v_dm) * (-4.0 + (5.0 * __pyx_v_nu))) + (__pyx_v_chiA * (-4.0 + (19.0 * __pyx_v_nu)))) / (2.0 * __pyx_v_dm));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":547
+    /* "pyseobnr/eob/waveform/waveform.pyx":570
  *         ) / (2.0 * dm)
  * 
- *         f_coeffs[3,3][4]= (             # <<<<<<<<<<<<<<
+ *         f_coeffs[3, 3][4]= (             # <<<<<<<<<<<<<<
  *             3.0 / 2.0 * chiS2 * dm
  *             + (3.0 - 12 * nu) * chiA * chiS
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 3;
     __pyx_t_3 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = ((((((3.0 / 2.0) * __pyx_v_chiS2) * __pyx_v_dm) + (((3.0 - (12.0 * __pyx_v_nu)) * __pyx_v_chiA) * __pyx_v_chiS)) + ((__pyx_v_dm * ((3.0 / 2.0) - (6.0 * __pyx_v_nu))) * __pyx_v_chiA2)) / __pyx_v_dm);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":552
+    /* "pyseobnr/eob/waveform/waveform.pyx":575
  *             + dm * (3.0 / 2.0 - 6.0 * nu) * chiA2
  *         ) / (dm)
- *         f_coeffs[3,3][5] = (             # <<<<<<<<<<<<<<
+ *         f_coeffs[3, 3][5] = (             # <<<<<<<<<<<<<<
  *             dm * (241.0 / 30.0 * nu2 + 11.0 /
- *                     20.0 * nu + 2.0 / 3.0) * chiS
+ *                   20.0 * nu + 2.0 / 3.0) * chiS
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 3;
     __pyx_t_1 = 5;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = ((((__pyx_v_dm * ((((241.0 / 30.0) * __pyx_v_nu2) + ((11.0 / 20.0) * __pyx_v_nu)) + (2.0 / 3.0))) * __pyx_v_chiS) + (((((407.0 / 30.0) * __pyx_v_nu2) - ((593.0 / 60.0) * __pyx_v_nu)) + (2.0 / 3.0)) * __pyx_v_chiA)) / __pyx_v_dm);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":557
+    /* "pyseobnr/eob/waveform/waveform.pyx":580
  *             + (407.0 / 30.0 * nu2 - 593.0 / 60.0 * nu + 2.0 / 3.0) * chiA
  *         ) / (dm)
- *         f_coeffs[3,3][6] = (             # <<<<<<<<<<<<<<
+ *         f_coeffs[3, 3][6] = (             # <<<<<<<<<<<<<<
  *             dm * (6.0 * nu2 - 27.0 / 2.0 * nu - 7.0 / 4.0) * chiS2
  *             + (44.0 * nu2 - 1.0 * nu - 7.0 / 2.0) * chiA * chiS
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 3;
     __pyx_t_3 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = (((((__pyx_v_dm * (((6.0 * __pyx_v_nu2) - ((27.0 / 2.0) * __pyx_v_nu)) - (7.0 / 4.0))) * __pyx_v_chiS2) + (((((44.0 * __pyx_v_nu2) - (1.0 * __pyx_v_nu)) - (7.0 / 2.0)) * __pyx_v_chiA) * __pyx_v_chiS)) + ((__pyx_v_dm * (((-12.0 * __pyx_v_nu2) + ((11.0 / 2.0) * __pyx_v_nu)) - (7.0 / 4.0))) * __pyx_v_chiA2)) / __pyx_v_dm);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":562
+    /* "pyseobnr/eob/waveform/waveform.pyx":585
  *             + dm * (-12 * nu2 + 11.0 / 2.0 * nu - 7.0 / 4.0) * chiA2
  *         ) / dm
- *         f_coeffs_vh[3,3][6] =  (             # <<<<<<<<<<<<<<
+ *         f_coeffs_vh[3, 3][6] = (             # <<<<<<<<<<<<<<
  *                 dm * (593.0 / 108.0 * nu - 81.0 / 20.0) * chiS
  *                 + (7339.0 / 540.0 * nu - 81.0 / 20.0) * chiA
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 3;
     __pyx_t_1 = 6;
     *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs_vh.data + __pyx_t_3 * __pyx_v_f_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((((__pyx_v_dm * (((593.0 / 108.0) * __pyx_v_nu) - (81.0 / 20.0))) * __pyx_v_chiS) + ((((7339.0 / 540.0) * __pyx_v_nu) - (81.0 / 20.0)) * __pyx_v_chiA)) / __pyx_v_dm), 0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":517
+    /* "pyseobnr/eob/waveform/waveform.pyx":541
  *     # (3,3) mode begins
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[3,3][2] = -7.0 / 6.0 + (2.0 * nu) / 3.0
- *         rho_coeffs[3,3][3] = 0.0
+ *         rho_coeffs[3, 3][2] = -7.0 / 6.0 + (2.0 * nu) / 3.0
+ *         rho_coeffs[3, 3][3] = 0.0
  */
     goto __pyx_L4;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":568
+  /* "pyseobnr/eob/waveform/waveform.pyx":591
  * 
  *     else:
- *         f_coeffs[3,3][3] = chiA * 3.0 / 8.0             # <<<<<<<<<<<<<<
+ *         f_coeffs[3, 3][3] = chiA * 3.0 / 8.0             # <<<<<<<<<<<<<<
  * 
  *         # RC: This terms are in Eq.A10 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
  */
   /*else*/ {
     __pyx_t_1 = 3;
     __pyx_t_2 = 3;
     __pyx_t_3 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = ((__pyx_v_chiA * 3.0) / 8.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":571
+    /* "pyseobnr/eob/waveform/waveform.pyx":594
  * 
  *         # RC: This terms are in Eq.A10 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
- *         f_coeffs[3,3][4] = (3.0 - 12 * nu) * chiA * chiS             # <<<<<<<<<<<<<<
- *         f_coeffs[3,3][5] = (
+ *         f_coeffs[3, 3][4] = (3.0 - 12 * nu) * chiA * chiS             # <<<<<<<<<<<<<<
+ *         f_coeffs[3, 3][5] = (
  *             407.0 / 30.0 * nu2 - 593.0 / 60.0 * nu + 2.0 / 3.0
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 3;
     __pyx_t_1 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = (((3.0 - (12.0 * __pyx_v_nu)) * __pyx_v_chiA) * __pyx_v_chiS);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":572
+    /* "pyseobnr/eob/waveform/waveform.pyx":595
  *         # RC: This terms are in Eq.A10 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
- *         f_coeffs[3,3][4] = (3.0 - 12 * nu) * chiA * chiS
- *         f_coeffs[3,3][5] = (             # <<<<<<<<<<<<<<
+ *         f_coeffs[3, 3][4] = (3.0 - 12 * nu) * chiA * chiS
+ *         f_coeffs[3, 3][5] = (             # <<<<<<<<<<<<<<
  *             407.0 / 30.0 * nu2 - 593.0 / 60.0 * nu + 2.0 / 3.0
  *         ) * chiA
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 3;
     __pyx_t_3 = 5;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = (((((407.0 / 30.0) * __pyx_v_nu2) - ((593.0 / 60.0) * __pyx_v_nu)) + (2.0 / 3.0)) * __pyx_v_chiA);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":575
+    /* "pyseobnr/eob/waveform/waveform.pyx":598
  *             407.0 / 30.0 * nu2 - 593.0 / 60.0 * nu + 2.0 / 3.0
  *         ) * chiA
- *         f_coeffs[3,3][6] = (44.0 * nu2 - 1.0 * nu - 7.0 / 2.0) * chiA * chiS             # <<<<<<<<<<<<<<
- *         f_coeffs_vh[3,3][6] = (7339.0 / 540.0 * nu - 81.0 / 20.0) * chiA
+ *         f_coeffs[3, 3][6] = (44.0 * nu2 - 1.0 * nu - 7.0 / 2.0) * chiA * chiS             # <<<<<<<<<<<<<<
+ *         f_coeffs_vh[3, 3][6] = (7339.0 / 540.0 * nu - 81.0 / 20.0) * chiA
  * 
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 3;
     __pyx_t_1 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = (((((44.0 * __pyx_v_nu2) - (1.0 * __pyx_v_nu)) - (7.0 / 2.0)) * __pyx_v_chiA) * __pyx_v_chiS);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":576
+    /* "pyseobnr/eob/waveform/waveform.pyx":599
  *         ) * chiA
- *         f_coeffs[3,3][6] = (44.0 * nu2 - 1.0 * nu - 7.0 / 2.0) * chiA * chiS
- *         f_coeffs_vh[3,3][6] = (7339.0 / 540.0 * nu - 81.0 / 20.0) * chiA             # <<<<<<<<<<<<<<
+ *         f_coeffs[3, 3][6] = (44.0 * nu2 - 1.0 * nu - 7.0 / 2.0) * chiA * chiS
+ *         f_coeffs_vh[3, 3][6] = (7339.0 / 540.0 * nu - 81.0 / 20.0) * chiA             # <<<<<<<<<<<<<<
  * 
  *     # (3,3) mode ends
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 3;
     __pyx_t_3 = 6;
     *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs_vh.data + __pyx_t_1 * __pyx_v_f_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((((7339.0 / 540.0) * __pyx_v_nu) - (81.0 / 20.0)) * __pyx_v_chiA), 0);
   }
   __pyx_L4:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":581
+  /* "pyseobnr/eob/waveform/waveform.pyx":604
  * 
  *     # (3,2) mode begins
- *     rho_coeffs[3,2][1] = (4.0 * chiS * nu) / (-3.0 * m1Plus3nu)             # <<<<<<<<<<<<<<
- *     rho_coeffs[3,2][2] = (328.0 - 1115.0 * nu + 320.0 *
- *                       nu2) / (270.0 * m1Plus3nu)
+ *     rho_coeffs[3, 2][1] = (4.0 * chiS * nu) / (-3.0 * m1Plus3nu)             # <<<<<<<<<<<<<<
+ *     rho_coeffs[3, 2][2] = (328.0 - 1115.0 * nu + 320.0 *
+ *                            nu2) / (270.0 * m1Plus3nu)
  */
   __pyx_t_3 = 3;
   __pyx_t_2 = 2;
   __pyx_t_1 = 1;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (((4.0 * __pyx_v_chiS) * __pyx_v_nu) / (-3.0 * __pyx_v_m1Plus3nu));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":582
+  /* "pyseobnr/eob/waveform/waveform.pyx":605
  *     # (3,2) mode begins
- *     rho_coeffs[3,2][1] = (4.0 * chiS * nu) / (-3.0 * m1Plus3nu)
- *     rho_coeffs[3,2][2] = (328.0 - 1115.0 * nu + 320.0 *             # <<<<<<<<<<<<<<
- *                       nu2) / (270.0 * m1Plus3nu)
+ *     rho_coeffs[3, 2][1] = (4.0 * chiS * nu) / (-3.0 * m1Plus3nu)
+ *     rho_coeffs[3, 2][2] = (328.0 - 1115.0 * nu + 320.0 *             # <<<<<<<<<<<<<<
+ *                            nu2) / (270.0 * m1Plus3nu)
  * 
  */
   __pyx_t_1 = 3;
   __pyx_t_2 = 2;
   __pyx_t_3 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((328.0 - (1115.0 * __pyx_v_nu)) + (320.0 * __pyx_v_nu2)) / (270.0 * __pyx_v_m1Plus3nu));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":585
- *                       nu2) / (270.0 * m1Plus3nu)
+  /* "pyseobnr/eob/waveform/waveform.pyx":608
+ *                            nu2) / (270.0 * m1Plus3nu)
  * 
- *     rho_coeffs[3,2][3] = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[3, 2][3] = (             # <<<<<<<<<<<<<<
  *         2.0
  *         * (
  */
   __pyx_t_3 = 3;
   __pyx_t_2 = 2;
   __pyx_t_1 = 3;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((2.0 * (((45.0 * __pyx_v_a) * __pyx_v_m1Plus3nu3) - ((__pyx_v_a * __pyx_v_nu) * (((328.0 - (2099.0 * __pyx_v_nu)) + ((5.0 * (733.0 + (20.0 * __pyx_v_a2))) * __pyx_v_nu2)) - (960.0 * __pyx_v_nu3))))) / (405.0 * __pyx_v_m1Plus3nu3));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":595
+  /* "pyseobnr/eob/waveform/waveform.pyx":618
  *     ) / (405.0 * m1Plus3nu3)
  * 
- *     rho_coeffs[3,2][4] = a2 / 3.0 + (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[3, 2][4] = a2 / 3.0 + (             # <<<<<<<<<<<<<<
  *         -1444528.0
  *         + 8050045.0 * nu
  */
   __pyx_t_1 = 3;
   __pyx_t_2 = 2;
   __pyx_t_3 = 4;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((__pyx_v_a2 / 3.0) + (((((-1444528.0 + (8050045.0 * __pyx_v_nu)) - (4725605.0 * __pyx_v_nu2)) - (20338960.0 * __pyx_v_nu3)) + ((3085640.0 * __pyx_v_nu2) * __pyx_v_nu2)) / (1603800.0 * __pyx_v_m1Plus3nu2)));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":602
+  /* "pyseobnr/eob/waveform/waveform.pyx":625
  *         + 3085640.0 * nu2 * nu2
  *     ) / (1603800.0 * m1Plus3nu2)
- *     rho_coeffs[3,2][5] = (-2788.0 * a) / 1215.0             # <<<<<<<<<<<<<<
- *     rho_coeffs[3,2][6] = 5849948554.0 / 940355325.0 + (488.0 * a2) / 405.0
- *     rho_coeffs_log[3,2][6] = -104.0 / 63.0
+ *     rho_coeffs[3, 2][5] = (-2788.0 * a) / 1215.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[3, 2][6] = 5849948554.0 / 940355325.0 + (488.0 * a2) / 405.0
+ *     rho_coeffs_log[3, 2][6] = -104.0 / 63.0
  */
   __pyx_t_3 = 3;
   __pyx_t_2 = 2;
   __pyx_t_1 = 5;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2788.0 * __pyx_v_a) / 1215.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":603
+  /* "pyseobnr/eob/waveform/waveform.pyx":626
  *     ) / (1603800.0 * m1Plus3nu2)
- *     rho_coeffs[3,2][5] = (-2788.0 * a) / 1215.0
- *     rho_coeffs[3,2][6] = 5849948554.0 / 940355325.0 + (488.0 * a2) / 405.0             # <<<<<<<<<<<<<<
- *     rho_coeffs_log[3,2][6] = -104.0 / 63.0
- *     rho_coeffs[3,2][8] = -10607269449358.0 / 3072140846775.0
+ *     rho_coeffs[3, 2][5] = (-2788.0 * a) / 1215.0
+ *     rho_coeffs[3, 2][6] = 5849948554.0 / 940355325.0 + (488.0 * a2) / 405.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs_log[3, 2][6] = -104.0 / 63.0
+ *     rho_coeffs[3, 2][8] = -10607269449358.0 / 3072140846775.0
  */
   __pyx_t_1 = 3;
   __pyx_t_2 = 2;
   __pyx_t_3 = 6;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((5849948554.0 / 940355325.0) + ((488.0 * __pyx_v_a2) / 405.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":604
- *     rho_coeffs[3,2][5] = (-2788.0 * a) / 1215.0
- *     rho_coeffs[3,2][6] = 5849948554.0 / 940355325.0 + (488.0 * a2) / 405.0
- *     rho_coeffs_log[3,2][6] = -104.0 / 63.0             # <<<<<<<<<<<<<<
- *     rho_coeffs[3,2][8] = -10607269449358.0 / 3072140846775.0
- *     rho_coeffs_log[3,2][8] = 17056.0 / 8505.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":627
+ *     rho_coeffs[3, 2][5] = (-2788.0 * a) / 1215.0
+ *     rho_coeffs[3, 2][6] = 5849948554.0 / 940355325.0 + (488.0 * a2) / 405.0
+ *     rho_coeffs_log[3, 2][6] = -104.0 / 63.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[3, 2][8] = -10607269449358.0 / 3072140846775.0
+ *     rho_coeffs_log[3, 2][8] = 17056.0 / 8505.0
  */
   __pyx_t_3 = 3;
   __pyx_t_2 = 2;
   __pyx_t_1 = 6;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[2]) )) = (-104.0 / 63.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":605
- *     rho_coeffs[3,2][6] = 5849948554.0 / 940355325.0 + (488.0 * a2) / 405.0
- *     rho_coeffs_log[3,2][6] = -104.0 / 63.0
- *     rho_coeffs[3,2][8] = -10607269449358.0 / 3072140846775.0             # <<<<<<<<<<<<<<
- *     rho_coeffs_log[3,2][8] = 17056.0 / 8505.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":628
+ *     rho_coeffs[3, 2][6] = 5849948554.0 / 940355325.0 + (488.0 * a2) / 405.0
+ *     rho_coeffs_log[3, 2][6] = -104.0 / 63.0
+ *     rho_coeffs[3, 2][8] = -10607269449358.0 / 3072140846775.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs_log[3, 2][8] = 17056.0 / 8505.0
  *     # (3,2) mode ends
  */
   __pyx_t_1 = 3;
   __pyx_t_2 = 2;
   __pyx_t_3 = 8;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (-10607269449358.0 / 3072140846775.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":606
- *     rho_coeffs_log[3,2][6] = -104.0 / 63.0
- *     rho_coeffs[3,2][8] = -10607269449358.0 / 3072140846775.0
- *     rho_coeffs_log[3,2][8] = 17056.0 / 8505.0             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":629
+ *     rho_coeffs_log[3, 2][6] = -104.0 / 63.0
+ *     rho_coeffs[3, 2][8] = -10607269449358.0 / 3072140846775.0
+ *     rho_coeffs_log[3, 2][8] = 17056.0 / 8505.0             # <<<<<<<<<<<<<<
  *     # (3,2) mode ends
  * 
  */
   __pyx_t_3 = 3;
   __pyx_t_2 = 2;
   __pyx_t_1 = 8;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[2]) )) = (17056.0 / 8505.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":610
+  /* "pyseobnr/eob/waveform/waveform.pyx":633
  * 
  *     # (3,1) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
  * 
- *         rho_coeffs[3,1][2] = -13.0 / 18.0 - (2.0 * nu) / 9.0
+ *         rho_coeffs[3, 1][2] = -13.0 / 18.0 - (2.0 * nu) / 9.0
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":612
+    /* "pyseobnr/eob/waveform/waveform.pyx":635
  *     if dm2:
  * 
- *         rho_coeffs[3,1][2] = -13.0 / 18.0 - (2.0 * nu) / 9.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[3,1][3] = 0.0
- *         rho_coeffs[3,1][4] = (
+ *         rho_coeffs[3, 1][2] = -13.0 / 18.0 - (2.0 * nu) / 9.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[3, 1][3] = 0.0
+ *         rho_coeffs[3, 1][4] = (
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 1;
     __pyx_t_3 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-13.0 / 18.0) - ((2.0 * __pyx_v_nu) / 9.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":613
+    /* "pyseobnr/eob/waveform/waveform.pyx":636
  * 
- *         rho_coeffs[3,1][2] = -13.0 / 18.0 - (2.0 * nu) / 9.0
- *         rho_coeffs[3,1][3] = 0.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[3,1][4] = (
+ *         rho_coeffs[3, 1][2] = -13.0 / 18.0 - (2.0 * nu) / 9.0
+ *         rho_coeffs[3, 1][3] = 0.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[3, 1][4] = (
  *             101.0 / 7128.0
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 1;
     __pyx_t_1 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = 0.0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":614
- *         rho_coeffs[3,1][2] = -13.0 / 18.0 - (2.0 * nu) / 9.0
- *         rho_coeffs[3,1][3] = 0.0
- *         rho_coeffs[3,1][4] = (             # <<<<<<<<<<<<<<
+    /* "pyseobnr/eob/waveform/waveform.pyx":637
+ *         rho_coeffs[3, 1][2] = -13.0 / 18.0 - (2.0 * nu) / 9.0
+ *         rho_coeffs[3, 1][3] = 0.0
+ *         rho_coeffs[3, 1][4] = (             # <<<<<<<<<<<<<<
  *             101.0 / 7128.0
  *             - (5.0 * a2) / 6.0
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 1;
     __pyx_t_3 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((((101.0 / 7128.0) - ((5.0 * __pyx_v_a2) / 6.0)) - ((1685.0 * __pyx_v_nu) / 1782.0)) - ((829.0 * __pyx_v_nu2) / 1782.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":620
+    /* "pyseobnr/eob/waveform/waveform.pyx":643
  *             - (829.0 * nu2) / 1782.0
  *         )
- *         rho_coeffs[3,1][5] = (4.0 * a) / 9.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[3,1][6] = 11706720301.0 / 6129723600.0 - (49.0 * a2) / 108.0
- *         rho_coeffs_log[3,1][6] = -26.0 / 63.0
+ *         rho_coeffs[3, 1][5] = (4.0 * a) / 9.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[3, 1][6] = 11706720301.0 / 6129723600.0 - (49.0 * a2) / 108.0
+ *         rho_coeffs_log[3, 1][6] = -26.0 / 63.0
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 1;
     __pyx_t_1 = 5;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((4.0 * __pyx_v_a) / 9.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":621
+    /* "pyseobnr/eob/waveform/waveform.pyx":644
  *         )
- *         rho_coeffs[3,1][5] = (4.0 * a) / 9.0
- *         rho_coeffs[3,1][6] = 11706720301.0 / 6129723600.0 - (49.0 * a2) / 108.0             # <<<<<<<<<<<<<<
- *         rho_coeffs_log[3,1][6] = -26.0 / 63.0
- *         rho_coeffs[3,1][7] = (-2579.0 * a) / 5346.0 + a * a2 / 9.0
+ *         rho_coeffs[3, 1][5] = (4.0 * a) / 9.0
+ *         rho_coeffs[3, 1][6] = 11706720301.0 / 6129723600.0 - (49.0 * a2) / 108.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs_log[3, 1][6] = -26.0 / 63.0
+ *         rho_coeffs[3, 1][7] = (-2579.0 * a) / 5346.0 + a * a2 / 9.0
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 1;
     __pyx_t_3 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((11706720301.0 / 6129723600.0) - ((49.0 * __pyx_v_a2) / 108.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":622
- *         rho_coeffs[3,1][5] = (4.0 * a) / 9.0
- *         rho_coeffs[3,1][6] = 11706720301.0 / 6129723600.0 - (49.0 * a2) / 108.0
- *         rho_coeffs_log[3,1][6] = -26.0 / 63.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[3,1][7] = (-2579.0 * a) / 5346.0 + a * a2 / 9.0
- *         rho_coeffs[3,1][8] = 2606097992581.0 / 4854741091200.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":645
+ *         rho_coeffs[3, 1][5] = (4.0 * a) / 9.0
+ *         rho_coeffs[3, 1][6] = 11706720301.0 / 6129723600.0 - (49.0 * a2) / 108.0
+ *         rho_coeffs_log[3, 1][6] = -26.0 / 63.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[3, 1][7] = (-2579.0 * a) / 5346.0 + a * a2 / 9.0
+ *         rho_coeffs[3, 1][8] = 2606097992581.0 / 4854741091200.0
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 1;
     __pyx_t_1 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[2]) )) = (-26.0 / 63.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":623
- *         rho_coeffs[3,1][6] = 11706720301.0 / 6129723600.0 - (49.0 * a2) / 108.0
- *         rho_coeffs_log[3,1][6] = -26.0 / 63.0
- *         rho_coeffs[3,1][7] = (-2579.0 * a) / 5346.0 + a * a2 / 9.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[3,1][8] = 2606097992581.0 / 4854741091200.0
- *         rho_coeffs_log[3,1][8] = 169.0 / 567.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":646
+ *         rho_coeffs[3, 1][6] = 11706720301.0 / 6129723600.0 - (49.0 * a2) / 108.0
+ *         rho_coeffs_log[3, 1][6] = -26.0 / 63.0
+ *         rho_coeffs[3, 1][7] = (-2579.0 * a) / 5346.0 + a * a2 / 9.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[3, 1][8] = 2606097992581.0 / 4854741091200.0
+ *         rho_coeffs_log[3, 1][8] = 169.0 / 567.0
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 1;
     __pyx_t_3 = 7;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((-2579.0 * __pyx_v_a) / 5346.0) + ((__pyx_v_a * __pyx_v_a2) / 9.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":624
- *         rho_coeffs_log[3,1][6] = -26.0 / 63.0
- *         rho_coeffs[3,1][7] = (-2579.0 * a) / 5346.0 + a * a2 / 9.0
- *         rho_coeffs[3,1][8] = 2606097992581.0 / 4854741091200.0             # <<<<<<<<<<<<<<
- *         rho_coeffs_log[3,1][8] = 169.0 / 567.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":647
+ *         rho_coeffs_log[3, 1][6] = -26.0 / 63.0
+ *         rho_coeffs[3, 1][7] = (-2579.0 * a) / 5346.0 + a * a2 / 9.0
+ *         rho_coeffs[3, 1][8] = 2606097992581.0 / 4854741091200.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs_log[3, 1][8] = 169.0 / 567.0
  * 
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 1;
     __pyx_t_1 = 8;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (2606097992581.0 / 4854741091200.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":625
- *         rho_coeffs[3,1][7] = (-2579.0 * a) / 5346.0 + a * a2 / 9.0
- *         rho_coeffs[3,1][8] = 2606097992581.0 / 4854741091200.0
- *         rho_coeffs_log[3,1][8] = 169.0 / 567.0             # <<<<<<<<<<<<<<
+    /* "pyseobnr/eob/waveform/waveform.pyx":648
+ *         rho_coeffs[3, 1][7] = (-2579.0 * a) / 5346.0 + a * a2 / 9.0
+ *         rho_coeffs[3, 1][8] = 2606097992581.0 / 4854741091200.0
+ *         rho_coeffs_log[3, 1][8] = 169.0 / 567.0             # <<<<<<<<<<<<<<
  * 
- *         f_coeffs[3,1][3] = (
+ *         f_coeffs[3, 1][3] = (
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 1;
     __pyx_t_3 = 8;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[2]) )) = (169.0 / 567.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":627
- *         rho_coeffs_log[3,1][8] = 169.0 / 567.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":650
+ *         rho_coeffs_log[3, 1][8] = 169.0 / 567.0
  * 
- *         f_coeffs[3,1][3] = (             # <<<<<<<<<<<<<<
+ *         f_coeffs[3, 1][3] = (             # <<<<<<<<<<<<<<
  *             chiA * (-4.0 + 11.0 * nu) + chiS * dm * (-4.0 + 13.0 * nu)
  *         ) / (2.0 * dm)
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 1;
     __pyx_t_1 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = (((__pyx_v_chiA * (-4.0 + (11.0 * __pyx_v_nu))) + ((__pyx_v_chiS * __pyx_v_dm) * (-4.0 + (13.0 * __pyx_v_nu)))) / (2.0 * __pyx_v_dm));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":610
+    /* "pyseobnr/eob/waveform/waveform.pyx":633
  * 
  *     # (3,1) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
  * 
- *         rho_coeffs[3,1][2] = -13.0 / 18.0 - (2.0 * nu) / 9.0
+ *         rho_coeffs[3, 1][2] = -13.0 / 18.0 - (2.0 * nu) / 9.0
  */
     goto __pyx_L5;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":632
+  /* "pyseobnr/eob/waveform/waveform.pyx":655
  * 
  *     else:
- *         f_coeffs[3,1][3]= -chiA * 5.0 / 8.0             # <<<<<<<<<<<<<<
+ *         f_coeffs[3, 1][3]= -chiA * 5.0 / 8.0             # <<<<<<<<<<<<<<
  *     # (3,1) mode ends
  * 
  */
   /*else*/ {
     __pyx_t_1 = 3;
     __pyx_t_2 = 1;
     __pyx_t_3 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = (((-__pyx_v_chiA) * 5.0) / 8.0);
   }
   __pyx_L5:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":636
+  /* "pyseobnr/eob/waveform/waveform.pyx":659
  * 
  *     # (4,4) mode begins
- *     rho_coeffs[4,4][2] = (1614.0 - 5870.0 * nu + 2625.0 *             # <<<<<<<<<<<<<<
- *                       nu2) / (1320.0 * m1Plus3nu)
- *     rho_coeffs[4,4][3] = (
+ *     rho_coeffs[4, 4][2] = (1614.0 - 5870.0 * nu + 2625.0 * nu2) / (1320.0 * m1Plus3nu)             # <<<<<<<<<<<<<<
+ *     rho_coeffs[4, 4][3] = (
+ *         chiA * (10.0 - 39.0 * nu) * dm
  */
   __pyx_t_3 = 4;
   __pyx_t_2 = 4;
   __pyx_t_1 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (((1614.0 - (5870.0 * __pyx_v_nu)) + (2625.0 * __pyx_v_nu2)) / (1320.0 * __pyx_v_m1Plus3nu));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":638
- *     rho_coeffs[4,4][2] = (1614.0 - 5870.0 * nu + 2625.0 *
- *                       nu2) / (1320.0 * m1Plus3nu)
- *     rho_coeffs[4,4][3] = (             # <<<<<<<<<<<<<<
- *         chiA * (10.0 - 39.0 * nu) * dm + chiS *
- *                 (10.0 - 41.0 * nu + 42.0 * nu2)
+  /* "pyseobnr/eob/waveform/waveform.pyx":660
+ *     # (4,4) mode begins
+ *     rho_coeffs[4, 4][2] = (1614.0 - 5870.0 * nu + 2625.0 * nu2) / (1320.0 * m1Plus3nu)
+ *     rho_coeffs[4, 4][3] = (             # <<<<<<<<<<<<<<
+ *         chiA * (10.0 - 39.0 * nu) * dm
+ *         + chiS * (10.0 - 41.0 * nu + 42.0 * nu2)
  */
   __pyx_t_1 = 4;
   __pyx_t_2 = 4;
   __pyx_t_3 = 3;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((((__pyx_v_chiA * (10.0 - (39.0 * __pyx_v_nu))) * __pyx_v_dm) + (__pyx_v_chiS * ((10.0 - (41.0 * __pyx_v_nu)) + (42.0 * __pyx_v_nu2)))) / (15.0 * __pyx_v_m1Plus3nu));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":644
+  /* "pyseobnr/eob/waveform/waveform.pyx":666
  * 
  *     # RC: This terms are in Eq.A8 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
- *     rho_coeffs[4,4][4] = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[4, 4][4] = (             # <<<<<<<<<<<<<<
  *         (
  *             -511573572.0
  */
   __pyx_t_3 = 4;
   __pyx_t_2 = 4;
   __pyx_t_1 = 4;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((((((((-511573572.0 + (2338945704.0 * __pyx_v_nu)) - (313857376.0 * __pyx_v_nu2)) - (6733146000.0 * __pyx_v_nu3)) + ((1252563795.0 * __pyx_v_nu2) * __pyx_v_nu2)) / (317116800.0 * __pyx_v_m1Plus3nu2)) + (__pyx_v_chiS2 / 2.0)) + ((__pyx_v_dm * __pyx_v_chiS) * __pyx_v_chiA)) + ((__pyx_v_dm2 * __pyx_v_chiA2) / 2.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":657
+  /* "pyseobnr/eob/waveform/waveform.pyx":679
  *         + dm2 * chiA2 / 2.0
  *     )
- *     rho_coeffs[4,4][5] = chiA * dm * (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[4, 4][5] = chiA * dm * (             # <<<<<<<<<<<<<<
  *         -8280.0 + 42716.0 * nu - 57990.0 * nu2 + 8955 * nu3
  *     ) / (6600.0 * m1Plus3nu2) + chiS * (
  */
   __pyx_t_1 = 4;
   __pyx_t_2 = 4;
   __pyx_t_3 = 5;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((((__pyx_v_chiA * __pyx_v_dm) * (((-8280.0 + (42716.0 * __pyx_v_nu)) - (57990.0 * __pyx_v_nu2)) + (8955.0 * __pyx_v_nu3))) / (6600.0 * __pyx_v_m1Plus3nu2)) + ((__pyx_v_chiS * ((((-8280.0 + (66284.0 * __pyx_v_nu)) - (176418.0 * __pyx_v_nu2)) + (128085.0 * __pyx_v_nu3)) + ((88650.0 * __pyx_v_nu2) * __pyx_v_nu2))) / (6600.0 * __pyx_v_m1Plus3nu2)));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":668
+  /* "pyseobnr/eob/waveform/waveform.pyx":690
  *         6600.0 * m1Plus3nu2
  *     )
- *     rho_coeffs[4,4][8] = -172066910136202271.0 / 19426955708160000.0             # <<<<<<<<<<<<<<
- *     rho_coeffs_log[4,4][8] = 845198.0 / 190575.0
- *     rho_coeffs[4,4][10] = -17154485653213713419357.0 / 568432724020761600000.0
+ *     rho_coeffs[4, 4][8] = -172066910136202271.0 / 19426955708160000.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs_log[4, 4][8] = 845198.0 / 190575.0
+ *     rho_coeffs[4, 4][10] = -17154485653213713419357.0 / 568432724020761600000.0
  */
   __pyx_t_3 = 4;
   __pyx_t_2 = 4;
   __pyx_t_1 = 8;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (-172066910136202271.0 / 19426955708160000.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":669
+  /* "pyseobnr/eob/waveform/waveform.pyx":691
  *     )
- *     rho_coeffs[4,4][8] = -172066910136202271.0 / 19426955708160000.0
- *     rho_coeffs_log[4,4][8] = 845198.0 / 190575.0             # <<<<<<<<<<<<<<
- *     rho_coeffs[4,4][10] = -17154485653213713419357.0 / 568432724020761600000.0
- *     rho_coeffs_log[4,4][10] = 22324502267.0 / 3815311500.0
+ *     rho_coeffs[4, 4][8] = -172066910136202271.0 / 19426955708160000.0
+ *     rho_coeffs_log[4, 4][8] = 845198.0 / 190575.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[4, 4][10] = -17154485653213713419357.0 / 568432724020761600000.0
+ *     rho_coeffs_log[4, 4][10] = 22324502267.0 / 3815311500.0
  */
   __pyx_t_1 = 4;
   __pyx_t_2 = 4;
   __pyx_t_3 = 8;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[2]) )) = (845198.0 / 190575.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":670
- *     rho_coeffs[4,4][8] = -172066910136202271.0 / 19426955708160000.0
- *     rho_coeffs_log[4,4][8] = 845198.0 / 190575.0
- *     rho_coeffs[4,4][10] = -17154485653213713419357.0 / 568432724020761600000.0             # <<<<<<<<<<<<<<
- *     rho_coeffs_log[4,4][10] = 22324502267.0 / 3815311500.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":692
+ *     rho_coeffs[4, 4][8] = -172066910136202271.0 / 19426955708160000.0
+ *     rho_coeffs_log[4, 4][8] = 845198.0 / 190575.0
+ *     rho_coeffs[4, 4][10] = -17154485653213713419357.0 / 568432724020761600000.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs_log[4, 4][10] = 22324502267.0 / 3815311500.0
  * 
  */
   __pyx_t_3 = 4;
   __pyx_t_2 = 4;
   __pyx_t_1 = 10;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (-17154485653213713419357.0 / 568432724020761600000.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":671
- *     rho_coeffs_log[4,4][8] = 845198.0 / 190575.0
- *     rho_coeffs[4,4][10] = -17154485653213713419357.0 / 568432724020761600000.0
- *     rho_coeffs_log[4,4][10] = 22324502267.0 / 3815311500.0             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":693
+ *     rho_coeffs_log[4, 4][8] = 845198.0 / 190575.0
+ *     rho_coeffs[4, 4][10] = -17154485653213713419357.0 / 568432724020761600000.0
+ *     rho_coeffs_log[4, 4][10] = 22324502267.0 / 3815311500.0             # <<<<<<<<<<<<<<
  * 
- *     rho_coeffs[4,4][6] = 16600939332793.0 / 1098809712000.0 + (217.0 * a2) / 3960.0
+ *     rho_coeffs[4, 4][6] = 16600939332793.0 / 1098809712000.0 + (217.0 * a2) / 3960.0
  */
   __pyx_t_1 = 4;
   __pyx_t_2 = 4;
   __pyx_t_3 = 10;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[2]) )) = (22324502267.0 / 3815311500.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":673
- *     rho_coeffs_log[4,4][10] = 22324502267.0 / 3815311500.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":695
+ *     rho_coeffs_log[4, 4][10] = 22324502267.0 / 3815311500.0
  * 
- *     rho_coeffs[4,4][6] = 16600939332793.0 / 1098809712000.0 + (217.0 * a2) / 3960.0             # <<<<<<<<<<<<<<
- *     rho_coeffs_log[4,4][6] = -12568.0 / 3465.0
+ *     rho_coeffs[4, 4][6] = 16600939332793.0 / 1098809712000.0 + (217.0 * a2) / 3960.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs_log[4, 4][6] = -12568.0 / 3465.0
  *     # (4,4) mode ends
  */
   __pyx_t_3 = 4;
   __pyx_t_2 = 4;
   __pyx_t_1 = 6;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((16600939332793.0 / 1098809712000.0) + ((217.0 * __pyx_v_a2) / 3960.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":674
+  /* "pyseobnr/eob/waveform/waveform.pyx":696
  * 
- *     rho_coeffs[4,4][6] = 16600939332793.0 / 1098809712000.0 + (217.0 * a2) / 3960.0
- *     rho_coeffs_log[4,4][6] = -12568.0 / 3465.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[4, 4][6] = 16600939332793.0 / 1098809712000.0 + (217.0 * a2) / 3960.0
+ *     rho_coeffs_log[4, 4][6] = -12568.0 / 3465.0             # <<<<<<<<<<<<<<
  *     # (4,4) mode ends
  *     # (4,3) mode begins
  */
   __pyx_t_1 = 4;
   __pyx_t_2 = 4;
   __pyx_t_3 = 6;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[2]) )) = (-12568.0 / 3465.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":677
+  /* "pyseobnr/eob/waveform/waveform.pyx":699
  *     # (4,4) mode ends
  *     # (4,3) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[4,3][1] = 0.0
- *         rho_coeffs[4,3][2] = (222.0 - 547.0 * nu + 160.0 * nu2) / (
+ *         rho_coeffs[4, 3][1] = 0.0
+ *         rho_coeffs[4, 3][2] = (222.0 - 547.0 * nu + 160.0 * nu2) / (
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":678
+    /* "pyseobnr/eob/waveform/waveform.pyx":700
  *     # (4,3) mode begins
  *     if dm2:
- *         rho_coeffs[4,3][1] = 0.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[4,3][2] = (222.0 - 547.0 * nu + 160.0 * nu2) / (
+ *         rho_coeffs[4, 3][1] = 0.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[4, 3][2] = (222.0 - 547.0 * nu + 160.0 * nu2) / (
  *             176.0 * (-1.0 + 2.0 * nu)
  */
     __pyx_t_3 = 4;
     __pyx_t_2 = 3;
     __pyx_t_1 = 1;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = 0.0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":679
+    /* "pyseobnr/eob/waveform/waveform.pyx":701
  *     if dm2:
- *         rho_coeffs[4,3][1] = 0.0
- *         rho_coeffs[4,3][2] = (222.0 - 547.0 * nu + 160.0 * nu2) / (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[4, 3][1] = 0.0
+ *         rho_coeffs[4, 3][2] = (222.0 - 547.0 * nu + 160.0 * nu2) / (             # <<<<<<<<<<<<<<
  *             176.0 * (-1.0 + 2.0 * nu)
  *         )
  */
     __pyx_t_1 = 4;
     __pyx_t_2 = 3;
     __pyx_t_3 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((222.0 - (547.0 * __pyx_v_nu)) + (160.0 * __pyx_v_nu2)) / (176.0 * (-1.0 + (2.0 * __pyx_v_nu))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":682
+    /* "pyseobnr/eob/waveform/waveform.pyx":704
  *             176.0 * (-1.0 + 2.0 * nu)
  *         )
- *         rho_coeffs[4,3][4] = -6894273.0 / 7047040.0 + (3.0 * a2) / 8.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[4,3][5] = (-12113.0 * a) / 6160.0
- *         rho_coeffs[4,3][6] = 1664224207351.0 / 195343948800.0
+ *         rho_coeffs[4, 3][4] = -6894273.0 / 7047040.0 + (3.0 * a2) / 8.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[4, 3][5] = (-12113.0 * a) / 6160.0
+ *         rho_coeffs[4, 3][6] = 1664224207351.0 / 195343948800.0
  */
     __pyx_t_3 = 4;
     __pyx_t_2 = 3;
     __pyx_t_1 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-6894273.0 / 7047040.0) + ((3.0 * __pyx_v_a2) / 8.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":683
+    /* "pyseobnr/eob/waveform/waveform.pyx":705
  *         )
- *         rho_coeffs[4,3][4] = -6894273.0 / 7047040.0 + (3.0 * a2) / 8.0
- *         rho_coeffs[4,3][5] = (-12113.0 * a) / 6160.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[4,3][6] = 1664224207351.0 / 195343948800.0
- *         rho_coeffs_log[4,3][6] = -1571.0 / 770.0
+ *         rho_coeffs[4, 3][4] = -6894273.0 / 7047040.0 + (3.0 * a2) / 8.0
+ *         rho_coeffs[4, 3][5] = (-12113.0 * a) / 6160.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[4, 3][6] = 1664224207351.0 / 195343948800.0
+ *         rho_coeffs_log[4, 3][6] = -1571.0 / 770.0
  */
     __pyx_t_1 = 4;
     __pyx_t_2 = 3;
     __pyx_t_3 = 5;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-12113.0 * __pyx_v_a) / 6160.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":684
- *         rho_coeffs[4,3][4] = -6894273.0 / 7047040.0 + (3.0 * a2) / 8.0
- *         rho_coeffs[4,3][5] = (-12113.0 * a) / 6160.0
- *         rho_coeffs[4,3][6] = 1664224207351.0 / 195343948800.0             # <<<<<<<<<<<<<<
- *         rho_coeffs_log[4,3][6] = -1571.0 / 770.0
- *         f_coeffs[4,3][1] = (5.0 * (chiA - chiS * dm) * nu) / (
+    /* "pyseobnr/eob/waveform/waveform.pyx":706
+ *         rho_coeffs[4, 3][4] = -6894273.0 / 7047040.0 + (3.0 * a2) / 8.0
+ *         rho_coeffs[4, 3][5] = (-12113.0 * a) / 6160.0
+ *         rho_coeffs[4, 3][6] = 1664224207351.0 / 195343948800.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs_log[4, 3][6] = -1571.0 / 770.0
+ *         f_coeffs[4, 3][1] = (5.0 * (chiA - chiS * dm) * nu) / (
  */
     __pyx_t_3 = 4;
     __pyx_t_2 = 3;
     __pyx_t_1 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (1664224207351.0 / 195343948800.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":685
- *         rho_coeffs[4,3][5] = (-12113.0 * a) / 6160.0
- *         rho_coeffs[4,3][6] = 1664224207351.0 / 195343948800.0
- *         rho_coeffs_log[4,3][6] = -1571.0 / 770.0             # <<<<<<<<<<<<<<
- *         f_coeffs[4,3][1] = (5.0 * (chiA - chiS * dm) * nu) / (
+    /* "pyseobnr/eob/waveform/waveform.pyx":707
+ *         rho_coeffs[4, 3][5] = (-12113.0 * a) / 6160.0
+ *         rho_coeffs[4, 3][6] = 1664224207351.0 / 195343948800.0
+ *         rho_coeffs_log[4, 3][6] = -1571.0 / 770.0             # <<<<<<<<<<<<<<
+ *         f_coeffs[4, 3][1] = (5.0 * (chiA - chiS * dm) * nu) / (
  *             2.0 * dm * (-1.0 + 2.0 * nu)
  */
     __pyx_t_1 = 4;
     __pyx_t_2 = 3;
     __pyx_t_3 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[2]) )) = (-1571.0 / 770.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":686
- *         rho_coeffs[4,3][6] = 1664224207351.0 / 195343948800.0
- *         rho_coeffs_log[4,3][6] = -1571.0 / 770.0
- *         f_coeffs[4,3][1] = (5.0 * (chiA - chiS * dm) * nu) / (             # <<<<<<<<<<<<<<
+    /* "pyseobnr/eob/waveform/waveform.pyx":708
+ *         rho_coeffs[4, 3][6] = 1664224207351.0 / 195343948800.0
+ *         rho_coeffs_log[4, 3][6] = -1571.0 / 770.0
+ *         f_coeffs[4, 3][1] = (5.0 * (chiA - chiS * dm) * nu) / (             # <<<<<<<<<<<<<<
  *             2.0 * dm * (-1.0 + 2.0 * nu)
  *         )
  */
     __pyx_t_3 = 4;
     __pyx_t_2 = 3;
     __pyx_t_1 = 1;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = (((5.0 * (__pyx_v_chiA - (__pyx_v_chiS * __pyx_v_dm))) * __pyx_v_nu) / ((2.0 * __pyx_v_dm) * (-1.0 + (2.0 * __pyx_v_nu))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":677
+    /* "pyseobnr/eob/waveform/waveform.pyx":699
  *     # (4,4) mode ends
  *     # (4,3) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[4,3][1] = 0.0
- *         rho_coeffs[4,3][2] = (222.0 - 547.0 * nu + 160.0 * nu2) / (
+ *         rho_coeffs[4, 3][1] = 0.0
+ *         rho_coeffs[4, 3][2] = (222.0 - 547.0 * nu + 160.0 * nu2) / (
  */
     goto __pyx_L6;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":691
+  /* "pyseobnr/eob/waveform/waveform.pyx":713
  * 
  *     else:
- *         f_coeffs[4,3][1] = -5.0 * chiA / 4.0             # <<<<<<<<<<<<<<
+ *         f_coeffs[4, 3][1] = -5.0 * chiA / 4.0             # <<<<<<<<<<<<<<
  *     # (4,3) mode ends
  * 
  */
   /*else*/ {
     __pyx_t_1 = 4;
     __pyx_t_2 = 3;
     __pyx_t_3 = 1;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = ((-5.0 * __pyx_v_chiA) / 4.0);
   }
   __pyx_L6:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":695
+  /* "pyseobnr/eob/waveform/waveform.pyx":717
  * 
  *     # (4,2) mode begins
- *     rho_coeffs[4,2][2] = (1146.0 - 3530.0 * nu + 285.0 *             # <<<<<<<<<<<<<<
- *                       nu2) / (1320.0 * m1Plus3nu)
- *     rho_coeffs[4,2][3] = (
+ *     rho_coeffs[4, 2][2] = (1146.0 - 3530.0 * nu + 285.0 * nu2) / (1320.0 * m1Plus3nu)             # <<<<<<<<<<<<<<
+ *     rho_coeffs[4, 2][3] = (
+ *         chiA * (10.0 - 21.0 * nu) * dm
  */
   __pyx_t_3 = 4;
   __pyx_t_2 = 2;
   __pyx_t_1 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (((1146.0 - (3530.0 * __pyx_v_nu)) + (285.0 * __pyx_v_nu2)) / (1320.0 * __pyx_v_m1Plus3nu));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":697
- *     rho_coeffs[4,2][2] = (1146.0 - 3530.0 * nu + 285.0 *
- *                       nu2) / (1320.0 * m1Plus3nu)
- *     rho_coeffs[4,2][3] = (             # <<<<<<<<<<<<<<
- *         chiA * (10.0 - 21.0 * nu) * dm + chiS *
- *                 (10.0 - 59.0 * nu + 78.0 * nu2)
+  /* "pyseobnr/eob/waveform/waveform.pyx":718
+ *     # (4,2) mode begins
+ *     rho_coeffs[4, 2][2] = (1146.0 - 3530.0 * nu + 285.0 * nu2) / (1320.0 * m1Plus3nu)
+ *     rho_coeffs[4, 2][3] = (             # <<<<<<<<<<<<<<
+ *         chiA * (10.0 - 21.0 * nu) * dm
+ *         + chiS * (10.0 - 59.0 * nu + 78.0 * nu2)
  */
   __pyx_t_1 = 4;
   __pyx_t_2 = 2;
   __pyx_t_3 = 3;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((((__pyx_v_chiA * (10.0 - (21.0 * __pyx_v_nu))) * __pyx_v_dm) + (__pyx_v_chiS * ((10.0 - (59.0 * __pyx_v_nu)) + (78.0 * __pyx_v_nu2)))) / (15.0 * __pyx_v_m1Plus3nu));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":701
- *                 (10.0 - 59.0 * nu + 78.0 * nu2)
+  /* "pyseobnr/eob/waveform/waveform.pyx":722
+ *         + chiS * (10.0 - 59.0 * nu + 78.0 * nu2)
  *     ) / (15.0 * m1Plus3nu)
- *     rho_coeffs[4,2][4] = a2 / 2.0 + (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[4, 2][4] = a2 / 2.0 + (             # <<<<<<<<<<<<<<
  *         -114859044.0
  *         + 295834536.0 * nu
  */
   __pyx_t_3 = 4;
   __pyx_t_2 = 2;
   __pyx_t_1 = 4;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((__pyx_v_a2 / 2.0) + (((((-114859044.0 + (295834536.0 * __pyx_v_nu)) + (1204388696.0 * __pyx_v_nu2)) - (3047981160.0 * __pyx_v_nu3)) - ((379526805.0 * __pyx_v_nu2) * __pyx_v_nu2)) / (317116800.0 * __pyx_v_m1Plus3nu2)));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":708
+  /* "pyseobnr/eob/waveform/waveform.pyx":729
  *         - 379526805.0 * nu2 * nu2
  *     ) / (317116800.0 * m1Plus3nu2)
- *     rho_coeffs[4,2][5] = (-7.0 * a) / 110.0             # <<<<<<<<<<<<<<
- *     rho_coeffs[4,2][6] = 848238724511.0 / 219761942400.0 + (2323.0 * a2) / 3960.0
- *     rho_coeffs_log[4,2][6] = -3142.0 / 3465.0
+ *     rho_coeffs[4, 2][5] = (-7.0 * a) / 110.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[4, 2][6] = 848238724511.0 / 219761942400.0 + (2323.0 * a2) / 3960.0
+ *     rho_coeffs_log[4, 2][6] = -3142.0 / 3465.0
  */
   __pyx_t_1 = 4;
   __pyx_t_2 = 2;
   __pyx_t_3 = 5;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-7.0 * __pyx_v_a) / 110.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":709
+  /* "pyseobnr/eob/waveform/waveform.pyx":730
  *     ) / (317116800.0 * m1Plus3nu2)
- *     rho_coeffs[4,2][5] = (-7.0 * a) / 110.0
- *     rho_coeffs[4,2][6] = 848238724511.0 / 219761942400.0 + (2323.0 * a2) / 3960.0             # <<<<<<<<<<<<<<
- *     rho_coeffs_log[4,2][6] = -3142.0 / 3465.0
+ *     rho_coeffs[4, 2][5] = (-7.0 * a) / 110.0
+ *     rho_coeffs[4, 2][6] = 848238724511.0 / 219761942400.0 + (2323.0 * a2) / 3960.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs_log[4, 2][6] = -3142.0 / 3465.0
  *     # (4,2) mode ends
  */
   __pyx_t_3 = 4;
   __pyx_t_2 = 2;
   __pyx_t_1 = 6;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((848238724511.0 / 219761942400.0) + ((2323.0 * __pyx_v_a2) / 3960.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":710
- *     rho_coeffs[4,2][5] = (-7.0 * a) / 110.0
- *     rho_coeffs[4,2][6] = 848238724511.0 / 219761942400.0 + (2323.0 * a2) / 3960.0
- *     rho_coeffs_log[4,2][6] = -3142.0 / 3465.0             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":731
+ *     rho_coeffs[4, 2][5] = (-7.0 * a) / 110.0
+ *     rho_coeffs[4, 2][6] = 848238724511.0 / 219761942400.0 + (2323.0 * a2) / 3960.0
+ *     rho_coeffs_log[4, 2][6] = -3142.0 / 3465.0             # <<<<<<<<<<<<<<
  *     # (4,2) mode ends
  * 
  */
   __pyx_t_1 = 4;
   __pyx_t_2 = 2;
   __pyx_t_3 = 6;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[2]) )) = (-3142.0 / 3465.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":714
+  /* "pyseobnr/eob/waveform/waveform.pyx":735
  * 
  *     # (4,1) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
  * 
- *         rho_coeffs[4,1][1] = 0.0
+ *         rho_coeffs[4, 1][1] = 0.0
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":716
+    /* "pyseobnr/eob/waveform/waveform.pyx":737
  *     if dm2:
  * 
- *         rho_coeffs[4,1][1] = 0.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[4,1][2] = (602.0 - 1385.0 * nu + 288.0 * nu2) / (
+ *         rho_coeffs[4, 1][1] = 0.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[4, 1][2] = (602.0 - 1385.0 * nu + 288.0 * nu2) / (
  *             528.0 * (-1.0 + 2.0 * nu)
  */
     __pyx_t_3 = 4;
     __pyx_t_2 = 1;
     __pyx_t_1 = 1;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = 0.0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":717
+    /* "pyseobnr/eob/waveform/waveform.pyx":738
  * 
- *         rho_coeffs[4,1][1] = 0.0
- *         rho_coeffs[4,1][2] = (602.0 - 1385.0 * nu + 288.0 * nu2) / (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[4, 1][1] = 0.0
+ *         rho_coeffs[4, 1][2] = (602.0 - 1385.0 * nu + 288.0 * nu2) / (             # <<<<<<<<<<<<<<
  *             528.0 * (-1.0 + 2.0 * nu)
  *         )
  */
     __pyx_t_1 = 4;
     __pyx_t_2 = 1;
     __pyx_t_3 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((602.0 - (1385.0 * __pyx_v_nu)) + (288.0 * __pyx_v_nu2)) / (528.0 * (-1.0 + (2.0 * __pyx_v_nu))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":720
+    /* "pyseobnr/eob/waveform/waveform.pyx":741
  *             528.0 * (-1.0 + 2.0 * nu)
  *         )
- *         rho_coeffs[4,1][4] = -7775491.0 / 21141120.0 + (3.0 * a2) / 8.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[4,1][5] = (-20033.0 * a) / 55440.0 - (5 * a * a2) / 6.0
- *         rho_coeffs[4,1][6] = 1227423222031.0 / 1758095539200.0
+ *         rho_coeffs[4, 1][4] = -7775491.0 / 21141120.0 + (3.0 * a2) / 8.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[4, 1][5] = (-20033.0 * a) / 55440.0 - (5 * a * a2) / 6.0
+ *         rho_coeffs[4, 1][6] = 1227423222031.0 / 1758095539200.0
  */
     __pyx_t_3 = 4;
     __pyx_t_2 = 1;
     __pyx_t_1 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-7775491.0 / 21141120.0) + ((3.0 * __pyx_v_a2) / 8.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":721
+    /* "pyseobnr/eob/waveform/waveform.pyx":742
  *         )
- *         rho_coeffs[4,1][4] = -7775491.0 / 21141120.0 + (3.0 * a2) / 8.0
- *         rho_coeffs[4,1][5] = (-20033.0 * a) / 55440.0 - (5 * a * a2) / 6.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[4,1][6] = 1227423222031.0 / 1758095539200.0
- *         rho_coeffs_log[4,1][6] = -1571.0 / 6930.0
+ *         rho_coeffs[4, 1][4] = -7775491.0 / 21141120.0 + (3.0 * a2) / 8.0
+ *         rho_coeffs[4, 1][5] = (-20033.0 * a) / 55440.0 - (5 * a * a2) / 6.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[4, 1][6] = 1227423222031.0 / 1758095539200.0
+ *         rho_coeffs_log[4, 1][6] = -1571.0 / 6930.0
  */
     __pyx_t_1 = 4;
     __pyx_t_2 = 1;
     __pyx_t_3 = 5;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((-20033.0 * __pyx_v_a) / 55440.0) - (((5.0 * __pyx_v_a) * __pyx_v_a2) / 6.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":722
- *         rho_coeffs[4,1][4] = -7775491.0 / 21141120.0 + (3.0 * a2) / 8.0
- *         rho_coeffs[4,1][5] = (-20033.0 * a) / 55440.0 - (5 * a * a2) / 6.0
- *         rho_coeffs[4,1][6] = 1227423222031.0 / 1758095539200.0             # <<<<<<<<<<<<<<
- *         rho_coeffs_log[4,1][6] = -1571.0 / 6930.0
- *         f_coeffs[4,1][1] = (5.0 * (chiA - chiS * dm) * nu) / (
+    /* "pyseobnr/eob/waveform/waveform.pyx":743
+ *         rho_coeffs[4, 1][4] = -7775491.0 / 21141120.0 + (3.0 * a2) / 8.0
+ *         rho_coeffs[4, 1][5] = (-20033.0 * a) / 55440.0 - (5 * a * a2) / 6.0
+ *         rho_coeffs[4, 1][6] = 1227423222031.0 / 1758095539200.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs_log[4, 1][6] = -1571.0 / 6930.0
+ *         f_coeffs[4, 1][1] = (5.0 * (chiA - chiS * dm) * nu) / (
  */
     __pyx_t_3 = 4;
     __pyx_t_2 = 1;
     __pyx_t_1 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (1227423222031.0 / 1758095539200.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":723
- *         rho_coeffs[4,1][5] = (-20033.0 * a) / 55440.0 - (5 * a * a2) / 6.0
- *         rho_coeffs[4,1][6] = 1227423222031.0 / 1758095539200.0
- *         rho_coeffs_log[4,1][6] = -1571.0 / 6930.0             # <<<<<<<<<<<<<<
- *         f_coeffs[4,1][1] = (5.0 * (chiA - chiS * dm) * nu) / (
+    /* "pyseobnr/eob/waveform/waveform.pyx":744
+ *         rho_coeffs[4, 1][5] = (-20033.0 * a) / 55440.0 - (5 * a * a2) / 6.0
+ *         rho_coeffs[4, 1][6] = 1227423222031.0 / 1758095539200.0
+ *         rho_coeffs_log[4, 1][6] = -1571.0 / 6930.0             # <<<<<<<<<<<<<<
+ *         f_coeffs[4, 1][1] = (5.0 * (chiA - chiS * dm) * nu) / (
  *             2.0 * dm * (-1.0 + 2.0 * nu)
  */
     __pyx_t_1 = 4;
     __pyx_t_2 = 1;
     __pyx_t_3 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[2]) )) = (-1571.0 / 6930.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":724
- *         rho_coeffs[4,1][6] = 1227423222031.0 / 1758095539200.0
- *         rho_coeffs_log[4,1][6] = -1571.0 / 6930.0
- *         f_coeffs[4,1][1] = (5.0 * (chiA - chiS * dm) * nu) / (             # <<<<<<<<<<<<<<
+    /* "pyseobnr/eob/waveform/waveform.pyx":745
+ *         rho_coeffs[4, 1][6] = 1227423222031.0 / 1758095539200.0
+ *         rho_coeffs_log[4, 1][6] = -1571.0 / 6930.0
+ *         f_coeffs[4, 1][1] = (5.0 * (chiA - chiS * dm) * nu) / (             # <<<<<<<<<<<<<<
  *             2.0 * dm * (-1.0 + 2.0 * nu)
  *         )
  */
     __pyx_t_3 = 4;
     __pyx_t_2 = 1;
     __pyx_t_1 = 1;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = (((5.0 * (__pyx_v_chiA - (__pyx_v_chiS * __pyx_v_dm))) * __pyx_v_nu) / ((2.0 * __pyx_v_dm) * (-1.0 + (2.0 * __pyx_v_nu))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":714
+    /* "pyseobnr/eob/waveform/waveform.pyx":735
  * 
  *     # (4,1) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
  * 
- *         rho_coeffs[4,1][1] = 0.0
+ *         rho_coeffs[4, 1][1] = 0.0
  */
     goto __pyx_L7;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":729
+  /* "pyseobnr/eob/waveform/waveform.pyx":750
  * 
  *     else:
- *         f_coeffs[4,1][1] = -5.0 * chiA / 4.0             # <<<<<<<<<<<<<<
+ *         f_coeffs[4, 1][1] = -5.0 * chiA / 4.0             # <<<<<<<<<<<<<<
  * 
  *     # (4,1) mode ends
  */
   /*else*/ {
     __pyx_t_1 = 4;
     __pyx_t_2 = 1;
     __pyx_t_3 = 1;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = ((-5.0 * __pyx_v_chiA) / 4.0);
   }
   __pyx_L7:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":734
+  /* "pyseobnr/eob/waveform/waveform.pyx":755
  * 
  *     # (5,5) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
  * 
- *         rho_coeffs[5,5][2] = (487.0 - 1298.0 * nu + 512.0 * nu2) / (
+ *         rho_coeffs[5, 5][2] = (487.0 - 1298.0 * nu + 512.0 * nu2) / (
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":736
+    /* "pyseobnr/eob/waveform/waveform.pyx":757
  *     if dm2:
  * 
- *         rho_coeffs[5,5][2] = (487.0 - 1298.0 * nu + 512.0 * nu2) / (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[5, 5][2] = (487.0 - 1298.0 * nu + 512.0 * nu2) / (             # <<<<<<<<<<<<<<
  *             390.0 * (-1.0 + 2.0 * nu)
  *         )
  */
     __pyx_t_3 = 5;
     __pyx_t_2 = 5;
     __pyx_t_1 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (((487.0 - (1298.0 * __pyx_v_nu)) + (512.0 * __pyx_v_nu2)) / (390.0 * (-1.0 + (2.0 * __pyx_v_nu))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":739
+    /* "pyseobnr/eob/waveform/waveform.pyx":760
  *             390.0 * (-1.0 + 2.0 * nu)
  *         )
- *         rho_coeffs[5,5][3] = (-2.0 * a) / 3.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[5,5][4] = -3353747.0 / 2129400.0 + a2 / 2.0
- *         rho_coeffs[5,5][5] = -241.0 * a / 195.0
+ *         rho_coeffs[5, 5][3] = (-2.0 * a) / 3.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[5, 5][4] = -3353747.0 / 2129400.0 + a2 / 2.0
+ *         rho_coeffs[5, 5][5] = -241.0 * a / 195.0
  */
     __pyx_t_1 = 5;
     __pyx_t_2 = 5;
     __pyx_t_3 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 3.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":740
+    /* "pyseobnr/eob/waveform/waveform.pyx":761
  *         )
- *         rho_coeffs[5,5][3] = (-2.0 * a) / 3.0
- *         rho_coeffs[5,5][4] = -3353747.0 / 2129400.0 + a2 / 2.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[5,5][5] = -241.0 * a / 195.0
+ *         rho_coeffs[5, 5][3] = (-2.0 * a) / 3.0
+ *         rho_coeffs[5, 5][4] = -3353747.0 / 2129400.0 + a2 / 2.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[5, 5][5] = -241.0 * a / 195.0
  * 
  */
     __pyx_t_3 = 5;
     __pyx_t_2 = 5;
     __pyx_t_1 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-3353747.0 / 2129400.0) + (__pyx_v_a2 / 2.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":741
- *         rho_coeffs[5,5][3] = (-2.0 * a) / 3.0
- *         rho_coeffs[5,5][4] = -3353747.0 / 2129400.0 + a2 / 2.0
- *         rho_coeffs[5,5][5] = -241.0 * a / 195.0             # <<<<<<<<<<<<<<
- * 
+    /* "pyseobnr/eob/waveform/waveform.pyx":762
+ *         rho_coeffs[5, 5][3] = (-2.0 * a) / 3.0
+ *         rho_coeffs[5, 5][4] = -3353747.0 / 2129400.0 + a2 / 2.0
+ *         rho_coeffs[5, 5][5] = -241.0 * a / 195.0             # <<<<<<<<<<<<<<
  * 
+ *         # RC: This terms are in Eq.A9 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
  */
     __pyx_t_1 = 5;
     __pyx_t_2 = 5;
     __pyx_t_3 = 5;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-241.0 * __pyx_v_a) / 195.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":746
+    /* "pyseobnr/eob/waveform/waveform.pyx":765
  * 
  *         # RC: This terms are in Eq.A9 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
- *         rho_coeffs[5,5][6] = 190606537999247.0 / 11957879934000.0             # <<<<<<<<<<<<<<
- *         rho_coeffs_log[5,5][6] = -1546.0 / 429.0
- *         rho_coeffs[5,5][8] = -1213641959949291437.0 / 118143853747920000.0
+ *         rho_coeffs[5, 5][6] = 190606537999247.0 / 11957879934000.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs_log[5, 5][6] = -1546.0 / 429.0
+ *         rho_coeffs[5, 5][8] = -1213641959949291437.0 / 118143853747920000.0
  */
     __pyx_t_3 = 5;
     __pyx_t_2 = 5;
     __pyx_t_1 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (190606537999247.0 / 11957879934000.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":747
+    /* "pyseobnr/eob/waveform/waveform.pyx":766
  *         # RC: This terms are in Eq.A9 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
- *         rho_coeffs[5,5][6] = 190606537999247.0 / 11957879934000.0
- *         rho_coeffs_log[5,5][6] = -1546.0 / 429.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[5,5][8] = -1213641959949291437.0 / 118143853747920000.0
- *         rho_coeffs_log[5,5][8] = 376451.0 / 83655.0
+ *         rho_coeffs[5, 5][6] = 190606537999247.0 / 11957879934000.0
+ *         rho_coeffs_log[5, 5][6] = -1546.0 / 429.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[5, 5][8] = -1213641959949291437.0 / 118143853747920000.0
+ *         rho_coeffs_log[5, 5][8] = 376451.0 / 83655.0
  */
     __pyx_t_1 = 5;
     __pyx_t_2 = 5;
     __pyx_t_3 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[2]) )) = (-1546.0 / 429.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":748
- *         rho_coeffs[5,5][6] = 190606537999247.0 / 11957879934000.0
- *         rho_coeffs_log[5,5][6] = -1546.0 / 429.0
- *         rho_coeffs[5,5][8] = -1213641959949291437.0 / 118143853747920000.0             # <<<<<<<<<<<<<<
- *         rho_coeffs_log[5,5][8] = 376451.0 / 83655.0
- *         rho_coeffs[5,5][10] = -150082616449726042201261.0 / 4837990810977324000000.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":767
+ *         rho_coeffs[5, 5][6] = 190606537999247.0 / 11957879934000.0
+ *         rho_coeffs_log[5, 5][6] = -1546.0 / 429.0
+ *         rho_coeffs[5, 5][8] = -1213641959949291437.0 / 118143853747920000.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs_log[5, 5][8] = 376451.0 / 83655.0
+ *         rho_coeffs[5, 5][10] = -150082616449726042201261.0 / 4837990810977324000000.0
  */
     __pyx_t_3 = 5;
     __pyx_t_2 = 5;
     __pyx_t_1 = 8;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (-1213641959949291437.0 / 118143853747920000.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":749
- *         rho_coeffs_log[5,5][6] = -1546.0 / 429.0
- *         rho_coeffs[5,5][8] = -1213641959949291437.0 / 118143853747920000.0
- *         rho_coeffs_log[5,5][8] = 376451.0 / 83655.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[5,5][10] = -150082616449726042201261.0 / 4837990810977324000000.0
- *         rho_coeffs_log[5,5][10] = 2592446431.0 / 456756300.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":768
+ *         rho_coeffs_log[5, 5][6] = -1546.0 / 429.0
+ *         rho_coeffs[5, 5][8] = -1213641959949291437.0 / 118143853747920000.0
+ *         rho_coeffs_log[5, 5][8] = 376451.0 / 83655.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[5, 5][10] = -150082616449726042201261.0 / 4837990810977324000000.0
+ *         rho_coeffs_log[5, 5][10] = 2592446431.0 / 456756300.0
  */
     __pyx_t_1 = 5;
     __pyx_t_2 = 5;
     __pyx_t_3 = 8;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[2]) )) = (376451.0 / 83655.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":750
- *         rho_coeffs[5,5][8] = -1213641959949291437.0 / 118143853747920000.0
- *         rho_coeffs_log[5,5][8] = 376451.0 / 83655.0
- *         rho_coeffs[5,5][10] = -150082616449726042201261.0 / 4837990810977324000000.0             # <<<<<<<<<<<<<<
- *         rho_coeffs_log[5,5][10] = 2592446431.0 / 456756300.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":769
+ *         rho_coeffs[5, 5][8] = -1213641959949291437.0 / 118143853747920000.0
+ *         rho_coeffs_log[5, 5][8] = 376451.0 / 83655.0
+ *         rho_coeffs[5, 5][10] = -150082616449726042201261.0 / 4837990810977324000000.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs_log[5, 5][10] = 2592446431.0 / 456756300.0
  * 
  */
     __pyx_t_3 = 5;
     __pyx_t_2 = 5;
     __pyx_t_1 = 10;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (-150082616449726042201261.0 / 4837990810977324000000.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":751
- *         rho_coeffs_log[5,5][8] = 376451.0 / 83655.0
- *         rho_coeffs[5,5][10] = -150082616449726042201261.0 / 4837990810977324000000.0
- *         rho_coeffs_log[5,5][10] = 2592446431.0 / 456756300.0             # <<<<<<<<<<<<<<
+    /* "pyseobnr/eob/waveform/waveform.pyx":770
+ *         rho_coeffs_log[5, 5][8] = 376451.0 / 83655.0
+ *         rho_coeffs[5, 5][10] = -150082616449726042201261.0 / 4837990810977324000000.0
+ *         rho_coeffs_log[5, 5][10] = 2592446431.0 / 456756300.0             # <<<<<<<<<<<<<<
  * 
- *         f_coeffs[5,5][3] = chiA / dm * (
+ *         f_coeffs[5, 5][3] = chiA / dm * (
  */
     __pyx_t_1 = 5;
     __pyx_t_2 = 5;
     __pyx_t_3 = 10;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs_log.data + __pyx_t_1 * __pyx_v_rho_coeffs_log.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs_log.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs_log.strides[2]) )) = (2592446431.0 / 456756300.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":753
- *         rho_coeffs_log[5,5][10] = 2592446431.0 / 456756300.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":772
+ *         rho_coeffs_log[5, 5][10] = 2592446431.0 / 456756300.0
  * 
- *         f_coeffs[5,5][3] = chiA / dm * (             # <<<<<<<<<<<<<<
+ *         f_coeffs[5, 5][3] = chiA / dm * (             # <<<<<<<<<<<<<<
  *             10.0 / (3.0 * (-1.0 + 2.0 * nu))
  *             - 70.0 * nu / (3.0 * (-1.0 + 2.0 * nu))
  */
     __pyx_t_3 = 5;
     __pyx_t_2 = 5;
     __pyx_t_1 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = (((__pyx_v_chiA / __pyx_v_dm) * (((10.0 / (3.0 * (-1.0 + (2.0 * __pyx_v_nu)))) - ((70.0 * __pyx_v_nu) / (3.0 * (-1.0 + (2.0 * __pyx_v_nu))))) + ((110.0 * __pyx_v_nu2) / (3.0 * (-1.0 + (2.0 * __pyx_v_nu)))))) + (__pyx_v_chiS * (((10.0 / (3.0 * (-1.0 + (2.0 * __pyx_v_nu)))) - ((10.0 * __pyx_v_nu) / (-1.0 + (2.0 * __pyx_v_nu)))) + ((10.0 * __pyx_v_nu2) / (-1.0 + (2.0 * __pyx_v_nu))))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":762
+    /* "pyseobnr/eob/waveform/waveform.pyx":781
  *             + 10 * nu2 / (-1.0 + 2.0 * nu)
  *         )
- *         f_coeffs[5,5][4] = (             # <<<<<<<<<<<<<<
+ *         f_coeffs[5, 5][4] = (             # <<<<<<<<<<<<<<
  *             chiS2
  *             * (-5.0 / (2.0 * (-1.0 + 2.0 * nu)) + 5.0 * nu / (-1.0 + 2.0 * nu))
  */
     __pyx_t_1 = 5;
     __pyx_t_2 = 5;
     __pyx_t_3 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = (((__pyx_v_chiS2 * ((-5.0 / (2.0 * (-1.0 + (2.0 * __pyx_v_nu)))) + ((5.0 * __pyx_v_nu) / (-1.0 + (2.0 * __pyx_v_nu))))) + (((__pyx_v_chiA * __pyx_v_chiS) / __pyx_v_dm) * (((-5.0 / (-1.0 + (2.0 * __pyx_v_nu))) + ((30.0 * __pyx_v_nu) / (-1.0 + (2.0 * __pyx_v_nu)))) - ((40.0 * __pyx_v_nu2) / (-1.0 + (2.0 * __pyx_v_nu)))))) + (__pyx_v_chiA2 * (((-5.0 / (2.0 * (-1.0 + (2.0 * __pyx_v_nu)))) + ((15.0 * __pyx_v_nu) / (-1.0 + (2.0 * __pyx_v_nu)))) - ((20.0 * __pyx_v_nu2) / (-1.0 + (2.0 * __pyx_v_nu))))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":734
+    /* "pyseobnr/eob/waveform/waveform.pyx":755
  * 
  *     # (5,5) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
  * 
- *         rho_coeffs[5,5][2] = (487.0 - 1298.0 * nu + 512.0 * nu2) / (
+ *         rho_coeffs[5, 5][2] = (487.0 - 1298.0 * nu + 512.0 * nu2) / (
  */
     goto __pyx_L8;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":784
+  /* "pyseobnr/eob/waveform/waveform.pyx":803
  * 
  *         # RC: This terms are in Eq.A12 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
- *         f_coeffs[5,5][3] = chiA * (             # <<<<<<<<<<<<<<
+ *         f_coeffs[5, 5][3] = chiA * (             # <<<<<<<<<<<<<<
  *             10.0 / (3.0 * (-1.0 + 2.0 * nu))
  *             - 70.0 * nu / (3.0 * (-1.0 + 2.0 * nu))
  */
   /*else*/ {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":787
+    /* "pyseobnr/eob/waveform/waveform.pyx":806
  *             10.0 / (3.0 * (-1.0 + 2.0 * nu))
  *             - 70.0 * nu / (3.0 * (-1.0 + 2.0 * nu))
  *             + 110.0 * nu2 / (3.0 * (-1.0 + 2.0 * nu))             # <<<<<<<<<<<<<<
  *         )
- *         f_coeffs[5,5][4] = (
+ *         f_coeffs[5, 5][4] = (
  */
     __pyx_t_3 = 5;
     __pyx_t_2 = 5;
     __pyx_t_1 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = (__pyx_v_chiA * (((10.0 / (3.0 * (-1.0 + (2.0 * __pyx_v_nu)))) - ((70.0 * __pyx_v_nu) / (3.0 * (-1.0 + (2.0 * __pyx_v_nu))))) + ((110.0 * __pyx_v_nu2) / (3.0 * (-1.0 + (2.0 * __pyx_v_nu))))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":789
+    /* "pyseobnr/eob/waveform/waveform.pyx":808
  *             + 110.0 * nu2 / (3.0 * (-1.0 + 2.0 * nu))
  *         )
- *         f_coeffs[5,5][4] = (             # <<<<<<<<<<<<<<
+ *         f_coeffs[5, 5][4] = (             # <<<<<<<<<<<<<<
  *             chiA
  *             * chiS
  */
     __pyx_t_1 = 5;
     __pyx_t_2 = 5;
     __pyx_t_3 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = ((__pyx_v_chiA * __pyx_v_chiS) * (((-5.0 / (-1.0 + (2.0 * __pyx_v_nu))) + ((30.0 * __pyx_v_nu) / (-1.0 + (2.0 * __pyx_v_nu)))) - ((40.0 * __pyx_v_nu2) / (-1.0 + (2.0 * __pyx_v_nu)))));
   }
   __pyx_L8:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":801
+  /* "pyseobnr/eob/waveform/waveform.pyx":820
  * 
  *     # (5,4) mode begins
- *     rho_coeffs[5,4][2] = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[5, 4][2] = (             # <<<<<<<<<<<<<<
  *         -17448.0 + 96019.0 * nu - 127610.0 * nu2 + 33320.0 * nu3
  *     ) / (13650.0 * (1.0 - 5.0 * nu + 5.0 * nu2))
  */
   __pyx_t_3 = 5;
   __pyx_t_2 = 4;
   __pyx_t_1 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-17448.0 + (96019.0 * __pyx_v_nu)) - (127610.0 * __pyx_v_nu2)) + (33320.0 * __pyx_v_nu3)) / (13650.0 * ((1.0 - (5.0 * __pyx_v_nu)) + (5.0 * __pyx_v_nu2))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":804
+  /* "pyseobnr/eob/waveform/waveform.pyx":823
  *         -17448.0 + 96019.0 * nu - 127610.0 * nu2 + 33320.0 * nu3
  *     ) / (13650.0 * (1.0 - 5.0 * nu + 5.0 * nu2))
- *     rho_coeffs[5,4][3] = (-2.0 * a) / 15.0             # <<<<<<<<<<<<<<
- *     rho_coeffs[5,4][4] = -16213384.0 / 15526875.0 + (2.0 * a2) / 5.0
+ *     rho_coeffs[5, 4][3] = (-2.0 * a) / 15.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[5, 4][4] = -16213384.0 / 15526875.0 + (2.0 * a2) / 5.0
  *     # (5,4) mode ends
  */
   __pyx_t_1 = 5;
   __pyx_t_2 = 4;
   __pyx_t_3 = 3;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 15.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":805
+  /* "pyseobnr/eob/waveform/waveform.pyx":824
  *     ) / (13650.0 * (1.0 - 5.0 * nu + 5.0 * nu2))
- *     rho_coeffs[5,4][3] = (-2.0 * a) / 15.0
- *     rho_coeffs[5,4][4] = -16213384.0 / 15526875.0 + (2.0 * a2) / 5.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[5, 4][3] = (-2.0 * a) / 15.0
+ *     rho_coeffs[5, 4][4] = -16213384.0 / 15526875.0 + (2.0 * a2) / 5.0             # <<<<<<<<<<<<<<
  *     # (5,4) mode ends
  * 
  */
   __pyx_t_3 = 5;
   __pyx_t_2 = 4;
   __pyx_t_1 = 4;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-16213384.0 / 15526875.0) + ((2.0 * __pyx_v_a2) / 5.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":809
+  /* "pyseobnr/eob/waveform/waveform.pyx":828
  * 
  *     # (5,3)  mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
  * 
- *         rho_coeffs[5,3][2] = (375.0 - 850.0 * nu + 176.0 * nu2) / (
+ *         rho_coeffs[5, 3][2] = (375.0 - 850.0 * nu + 176.0 * nu2) / (
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":811
+    /* "pyseobnr/eob/waveform/waveform.pyx":830
  *     if dm2:
  * 
- *         rho_coeffs[5,3][2] = (375.0 - 850.0 * nu + 176.0 * nu2) / (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[5, 3][2] = (375.0 - 850.0 * nu + 176.0 * nu2) / (             # <<<<<<<<<<<<<<
  *             390.0 * (-1.0 + 2.0 * nu)
  *         )
  */
     __pyx_t_1 = 5;
     __pyx_t_2 = 3;
     __pyx_t_3 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((375.0 - (850.0 * __pyx_v_nu)) + (176.0 * __pyx_v_nu2)) / (390.0 * (-1.0 + (2.0 * __pyx_v_nu))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":814
+    /* "pyseobnr/eob/waveform/waveform.pyx":833
  *             390.0 * (-1.0 + 2.0 * nu)
  *         )
- *         rho_coeffs[5,3][3] = (-2.0 * a) / 3.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[5,3][4] = -410833.0 / 709800.0 + a2 / 2.0
- *         rho_coeffs[5,3][5] = -103.0 * a / 325.0
+ *         rho_coeffs[5, 3][3] = (-2.0 * a) / 3.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[5, 3][4] = -410833.0 / 709800.0 + a2 / 2.0
+ *         rho_coeffs[5, 3][5] = -103.0 * a / 325.0
  */
     __pyx_t_3 = 5;
     __pyx_t_2 = 3;
     __pyx_t_1 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 3.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":815
+    /* "pyseobnr/eob/waveform/waveform.pyx":834
  *         )
- *         rho_coeffs[5,3][3] = (-2.0 * a) / 3.0
- *         rho_coeffs[5,3][4] = -410833.0 / 709800.0 + a2 / 2.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[5,3][5] = -103.0 * a / 325.0
+ *         rho_coeffs[5, 3][3] = (-2.0 * a) / 3.0
+ *         rho_coeffs[5, 3][4] = -410833.0 / 709800.0 + a2 / 2.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[5, 3][5] = -103.0 * a / 325.0
  *     # (5,3) mode ends
  */
     __pyx_t_1 = 5;
     __pyx_t_2 = 3;
     __pyx_t_3 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-410833.0 / 709800.0) + (__pyx_v_a2 / 2.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":816
- *         rho_coeffs[5,3][3] = (-2.0 * a) / 3.0
- *         rho_coeffs[5,3][4] = -410833.0 / 709800.0 + a2 / 2.0
- *         rho_coeffs[5,3][5] = -103.0 * a / 325.0             # <<<<<<<<<<<<<<
+    /* "pyseobnr/eob/waveform/waveform.pyx":835
+ *         rho_coeffs[5, 3][3] = (-2.0 * a) / 3.0
+ *         rho_coeffs[5, 3][4] = -410833.0 / 709800.0 + a2 / 2.0
+ *         rho_coeffs[5, 3][5] = -103.0 * a / 325.0             # <<<<<<<<<<<<<<
  *     # (5,3) mode ends
  * 
  */
     __pyx_t_3 = 5;
     __pyx_t_2 = 3;
     __pyx_t_1 = 5;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-103.0 * __pyx_v_a) / 325.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":809
+    /* "pyseobnr/eob/waveform/waveform.pyx":828
  * 
  *     # (5,3)  mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
  * 
- *         rho_coeffs[5,3][2] = (375.0 - 850.0 * nu + 176.0 * nu2) / (
+ *         rho_coeffs[5, 3][2] = (375.0 - 850.0 * nu + 176.0 * nu2) / (
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":820
+  /* "pyseobnr/eob/waveform/waveform.pyx":839
  * 
  *     # (5,2) mode begins
- *     rho_coeffs[5,2][2] = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[5, 2][2] = (             # <<<<<<<<<<<<<<
  *         -15828.0 + 84679.0 * nu - 104930.0 * nu2 + 21980.0 * nu3
  *     ) / (13650.0 * (1.0 - 5.0 * nu + 5.0 * nu2))
  */
   __pyx_t_1 = 5;
   __pyx_t_2 = 2;
   __pyx_t_3 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-15828.0 + (84679.0 * __pyx_v_nu)) - (104930.0 * __pyx_v_nu2)) + (21980.0 * __pyx_v_nu3)) / (13650.0 * ((1.0 - (5.0 * __pyx_v_nu)) + (5.0 * __pyx_v_nu2))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":823
+  /* "pyseobnr/eob/waveform/waveform.pyx":842
  *         -15828.0 + 84679.0 * nu - 104930.0 * nu2 + 21980.0 * nu3
  *     ) / (13650.0 * (1.0 - 5.0 * nu + 5.0 * nu2))
- *     rho_coeffs[5,2][3] = (-2.0 * a) / 15.0             # <<<<<<<<<<<<<<
- *     rho_coeffs[5,2][4] = -7187914.0 / 15526875.0 + (2.0 * a2) / 5.0
+ *     rho_coeffs[5, 2][3] = (-2.0 * a) / 15.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[5, 2][4] = -7187914.0 / 15526875.0 + (2.0 * a2) / 5.0
  *     # (5,2) mode ends
  */
   __pyx_t_3 = 5;
   __pyx_t_2 = 2;
   __pyx_t_1 = 3;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 15.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":824
+  /* "pyseobnr/eob/waveform/waveform.pyx":843
  *     ) / (13650.0 * (1.0 - 5.0 * nu + 5.0 * nu2))
- *     rho_coeffs[5,2][3] = (-2.0 * a) / 15.0
- *     rho_coeffs[5,2][4] = -7187914.0 / 15526875.0 + (2.0 * a2) / 5.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[5, 2][3] = (-2.0 * a) / 15.0
+ *     rho_coeffs[5, 2][4] = -7187914.0 / 15526875.0 + (2.0 * a2) / 5.0             # <<<<<<<<<<<<<<
  *     # (5,2) mode ends
  * 
  */
   __pyx_t_1 = 5;
   __pyx_t_2 = 2;
   __pyx_t_3 = 4;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-7187914.0 / 15526875.0) + ((2.0 * __pyx_v_a2) / 5.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":828
+  /* "pyseobnr/eob/waveform/waveform.pyx":847
  * 
  *     # (5,1) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[5,1][2] = (319.0 - 626.0 * nu + 8.0 * nu2) / (
+ *         rho_coeffs[5, 1][2] = (319.0 - 626.0 * nu + 8.0 * nu2) / (
  *             390.0 * (-1.0 + 2.0 * nu)
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":829
+    /* "pyseobnr/eob/waveform/waveform.pyx":848
  *     # (5,1) mode begins
  *     if dm2:
- *         rho_coeffs[5,1][2] = (319.0 - 626.0 * nu + 8.0 * nu2) / (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[5, 1][2] = (319.0 - 626.0 * nu + 8.0 * nu2) / (             # <<<<<<<<<<<<<<
  *             390.0 * (-1.0 + 2.0 * nu)
  *         )
  */
     __pyx_t_3 = 5;
     __pyx_t_2 = 1;
     __pyx_t_1 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (((319.0 - (626.0 * __pyx_v_nu)) + (8.0 * __pyx_v_nu2)) / (390.0 * (-1.0 + (2.0 * __pyx_v_nu))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":832
+    /* "pyseobnr/eob/waveform/waveform.pyx":851
  *             390.0 * (-1.0 + 2.0 * nu)
  *         )
- *         rho_coeffs[5,1][3] = (-2.0 * a) / 3.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[5,1][4] = -31877.0 / 304200.0 + a2 / 2.0
- *         rho_coeffs[5,1][5] = 139.0 * a / 975.0
+ *         rho_coeffs[5, 1][3] = (-2.0 * a) / 3.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[5, 1][4] = -31877.0 / 304200.0 + a2 / 2.0
+ *         rho_coeffs[5, 1][5] = 139.0 * a / 975.0
  */
     __pyx_t_1 = 5;
     __pyx_t_2 = 1;
     __pyx_t_3 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 3.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":833
+    /* "pyseobnr/eob/waveform/waveform.pyx":852
  *         )
- *         rho_coeffs[5,1][3] = (-2.0 * a) / 3.0
- *         rho_coeffs[5,1][4] = -31877.0 / 304200.0 + a2 / 2.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[5,1][5] = 139.0 * a / 975.0
+ *         rho_coeffs[5, 1][3] = (-2.0 * a) / 3.0
+ *         rho_coeffs[5, 1][4] = -31877.0 / 304200.0 + a2 / 2.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[5, 1][5] = 139.0 * a / 975.0
  *     # (5,1) mode ends
  */
     __pyx_t_3 = 5;
     __pyx_t_2 = 1;
     __pyx_t_1 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-31877.0 / 304200.0) + (__pyx_v_a2 / 2.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":834
- *         rho_coeffs[5,1][3] = (-2.0 * a) / 3.0
- *         rho_coeffs[5,1][4] = -31877.0 / 304200.0 + a2 / 2.0
- *         rho_coeffs[5,1][5] = 139.0 * a / 975.0             # <<<<<<<<<<<<<<
+    /* "pyseobnr/eob/waveform/waveform.pyx":853
+ *         rho_coeffs[5, 1][3] = (-2.0 * a) / 3.0
+ *         rho_coeffs[5, 1][4] = -31877.0 / 304200.0 + a2 / 2.0
+ *         rho_coeffs[5, 1][5] = 139.0 * a / 975.0             # <<<<<<<<<<<<<<
  *     # (5,1) mode ends
  * 
  */
     __pyx_t_1 = 5;
     __pyx_t_2 = 1;
     __pyx_t_3 = 5;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((139.0 * __pyx_v_a) / 975.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":828
+    /* "pyseobnr/eob/waveform/waveform.pyx":847
  * 
  *     # (5,1) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[5,1][2] = (319.0 - 626.0 * nu + 8.0 * nu2) / (
+ *         rho_coeffs[5, 1][2] = (319.0 - 626.0 * nu + 8.0 * nu2) / (
  *             390.0 * (-1.0 + 2.0 * nu)
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":838
+  /* "pyseobnr/eob/waveform/waveform.pyx":857
  * 
  *     # (6,6) mode begins
- *     rho_coeffs[6,6][2] = (-106.0 + 602.0 * nu - 861.0 * nu2 + 273.0 * nu3) / (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[6, 6][2] = (-106.0 + 602.0 * nu - 861.0 * nu2 + 273.0 * nu3) / (             # <<<<<<<<<<<<<<
  *         84.0 * (1.0 - 5.0 * nu + 5.0 * nu2)
  *     )
  */
   __pyx_t_3 = 6;
   __pyx_t_2 = 6;
   __pyx_t_1 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-106.0 + (602.0 * __pyx_v_nu)) - (861.0 * __pyx_v_nu2)) + (273.0 * __pyx_v_nu3)) / (84.0 * ((1.0 - (5.0 * __pyx_v_nu)) + (5.0 * __pyx_v_nu2))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":841
+  /* "pyseobnr/eob/waveform/waveform.pyx":860
  *         84.0 * (1.0 - 5.0 * nu + 5.0 * nu2)
  *     )
- *     rho_coeffs[6,6][3] = (-2.0 * a) / 3.0             # <<<<<<<<<<<<<<
- *     rho_coeffs[6,6][4] = -1025435.0 / 659736.0 + a2 / 2.0
+ *     rho_coeffs[6, 6][3] = (-2.0 * a) / 3.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[6, 6][4] = -1025435.0 / 659736.0 + a2 / 2.0
  *     # (6,6) mode ends
  */
   __pyx_t_1 = 6;
   __pyx_t_2 = 6;
   __pyx_t_3 = 3;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 3.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":842
+  /* "pyseobnr/eob/waveform/waveform.pyx":861
  *     )
- *     rho_coeffs[6,6][3] = (-2.0 * a) / 3.0
- *     rho_coeffs[6,6][4] = -1025435.0 / 659736.0 + a2 / 2.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[6, 6][3] = (-2.0 * a) / 3.0
+ *     rho_coeffs[6, 6][4] = -1025435.0 / 659736.0 + a2 / 2.0             # <<<<<<<<<<<<<<
  *     # (6,6) mode ends
  * 
  */
   __pyx_t_3 = 6;
   __pyx_t_2 = 6;
   __pyx_t_1 = 4;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-1025435.0 / 659736.0) + (__pyx_v_a2 / 2.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":846
+  /* "pyseobnr/eob/waveform/waveform.pyx":865
  * 
  *     # (6,5) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[6,5][2] = (-185.0 + 838.0 * nu - 910.0 * nu2 + 220.0 * nu3) / (
+ *         rho_coeffs[6, 5][2] = (-185.0 + 838.0 * nu - 910.0 * nu2 + 220.0 * nu3) / (
  *             144.0 * (dm2 + 3.0 * nu2)
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":847
+    /* "pyseobnr/eob/waveform/waveform.pyx":866
  *     # (6,5) mode begins
  *     if dm2:
- *         rho_coeffs[6,5][2] = (-185.0 + 838.0 * nu - 910.0 * nu2 + 220.0 * nu3) / (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[6, 5][2] = (-185.0 + 838.0 * nu - 910.0 * nu2 + 220.0 * nu3) / (             # <<<<<<<<<<<<<<
  *             144.0 * (dm2 + 3.0 * nu2)
  *         )
  */
     __pyx_t_1 = 6;
     __pyx_t_2 = 5;
     __pyx_t_3 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-185.0 + (838.0 * __pyx_v_nu)) - (910.0 * __pyx_v_nu2)) + (220.0 * __pyx_v_nu3)) / (144.0 * (__pyx_v_dm2 + (3.0 * __pyx_v_nu2))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":850
+    /* "pyseobnr/eob/waveform/waveform.pyx":869
  *             144.0 * (dm2 + 3.0 * nu2)
  *         )
- *         rho_coeffs[6,5][3] = -2.0 * a / 9.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[6, 5][3] = -2.0 * a / 9.0             # <<<<<<<<<<<<<<
  *     # (6,5) mode ends
  * 
  */
     __pyx_t_3 = 6;
     __pyx_t_2 = 5;
     __pyx_t_1 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 9.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":846
+    /* "pyseobnr/eob/waveform/waveform.pyx":865
  * 
  *     # (6,5) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[6,5][2] = (-185.0 + 838.0 * nu - 910.0 * nu2 + 220.0 * nu3) / (
+ *         rho_coeffs[6, 5][2] = (-185.0 + 838.0 * nu - 910.0 * nu2 + 220.0 * nu3) / (
  *             144.0 * (dm2 + 3.0 * nu2)
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":854
+  /* "pyseobnr/eob/waveform/waveform.pyx":873
  * 
  *     # (6,4) mode begins
- *     rho_coeffs[6,4][2] = (-86.0 + 462.0 * nu - 581.0 * nu2 + 133.0 * nu3) / (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[6, 4][2] = (-86.0 + 462.0 * nu - 581.0 * nu2 + 133.0 * nu3) / (             # <<<<<<<<<<<<<<
  *         84.0 * (1.0 - 5.0 * nu + 5.0 * nu2)
  *     )
  */
   __pyx_t_1 = 6;
   __pyx_t_2 = 4;
   __pyx_t_3 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-86.0 + (462.0 * __pyx_v_nu)) - (581.0 * __pyx_v_nu2)) + (133.0 * __pyx_v_nu3)) / (84.0 * ((1.0 - (5.0 * __pyx_v_nu)) + (5.0 * __pyx_v_nu2))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":857
+  /* "pyseobnr/eob/waveform/waveform.pyx":876
  *         84.0 * (1.0 - 5.0 * nu + 5.0 * nu2)
  *     )
- *     rho_coeffs[6,4][3] = (-2.0 * a) / 3.0             # <<<<<<<<<<<<<<
- *     rho_coeffs[6,4][4] = -476887.0 / 659736.0 + a2 / 2.0
+ *     rho_coeffs[6, 4][3] = (-2.0 * a) / 3.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[6, 4][4] = -476887.0 / 659736.0 + a2 / 2.0
  *     # (6,4) mode ends
  */
   __pyx_t_3 = 6;
   __pyx_t_2 = 4;
   __pyx_t_1 = 3;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 3.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":858
+  /* "pyseobnr/eob/waveform/waveform.pyx":877
  *     )
- *     rho_coeffs[6,4][3] = (-2.0 * a) / 3.0
- *     rho_coeffs[6,4][4] = -476887.0 / 659736.0 + a2 / 2.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[6, 4][3] = (-2.0 * a) / 3.0
+ *     rho_coeffs[6, 4][4] = -476887.0 / 659736.0 + a2 / 2.0             # <<<<<<<<<<<<<<
  *     # (6,4) mode ends
  * 
  */
   __pyx_t_1 = 6;
   __pyx_t_2 = 4;
   __pyx_t_3 = 4;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-476887.0 / 659736.0) + (__pyx_v_a2 / 2.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":862
+  /* "pyseobnr/eob/waveform/waveform.pyx":881
  * 
  *     # (6,3) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[6,3][2] = (-169.0 + 742.0 * nu - 750.0 * nu2 + 156.0 * nu3) / (
+ *         rho_coeffs[6, 3][2] = (-169.0 + 742.0 * nu - 750.0 * nu2 + 156.0 * nu3) / (
  *             144.0 * (dm2 + 3.0 * nu2)
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":863
+    /* "pyseobnr/eob/waveform/waveform.pyx":882
  *     # (6,3) mode begins
  *     if dm2:
- *         rho_coeffs[6,3][2] = (-169.0 + 742.0 * nu - 750.0 * nu2 + 156.0 * nu3) / (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[6, 3][2] = (-169.0 + 742.0 * nu - 750.0 * nu2 + 156.0 * nu3) / (             # <<<<<<<<<<<<<<
  *             144.0 * (dm2 + 3.0 * nu2)
  *         )
  */
     __pyx_t_3 = 6;
     __pyx_t_2 = 3;
     __pyx_t_1 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-169.0 + (742.0 * __pyx_v_nu)) - (750.0 * __pyx_v_nu2)) + (156.0 * __pyx_v_nu3)) / (144.0 * (__pyx_v_dm2 + (3.0 * __pyx_v_nu2))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":866
+    /* "pyseobnr/eob/waveform/waveform.pyx":885
  *             144.0 * (dm2 + 3.0 * nu2)
  *         )
- *         rho_coeffs[6,3][3] = -2.0 * a / 9.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[6, 3][3] = -2.0 * a / 9.0             # <<<<<<<<<<<<<<
  *     # (6,3) mode ends
  * 
  */
     __pyx_t_1 = 6;
     __pyx_t_2 = 3;
     __pyx_t_3 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 9.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":862
+    /* "pyseobnr/eob/waveform/waveform.pyx":881
  * 
  *     # (6,3) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[6,3][2] = (-169.0 + 742.0 * nu - 750.0 * nu2 + 156.0 * nu3) / (
+ *         rho_coeffs[6, 3][2] = (-169.0 + 742.0 * nu - 750.0 * nu2 + 156.0 * nu3) / (
  *             144.0 * (dm2 + 3.0 * nu2)
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":870
+  /* "pyseobnr/eob/waveform/waveform.pyx":889
  * 
  *     # (6,2) mode begins
- *     rho_coeffs[6,2][2] = (-74.0 + 378.0 * nu - 413.0 * nu2 + 49.0 * nu3) / (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[6, 2][2] = (-74.0 + 378.0 * nu - 413.0 * nu2 + 49.0 * nu3) / (             # <<<<<<<<<<<<<<
  *         84.0 * (1.0 - 5.0 * nu + 5.0 * nu2)
  *     )
  */
   __pyx_t_3 = 6;
   __pyx_t_2 = 2;
   __pyx_t_1 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-74.0 + (378.0 * __pyx_v_nu)) - (413.0 * __pyx_v_nu2)) + (49.0 * __pyx_v_nu3)) / (84.0 * ((1.0 - (5.0 * __pyx_v_nu)) + (5.0 * __pyx_v_nu2))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":873
+  /* "pyseobnr/eob/waveform/waveform.pyx":892
  *         84.0 * (1.0 - 5.0 * nu + 5.0 * nu2)
  *     )
- *     rho_coeffs[6,2][3] = (-2.0 * a) / 3.0             # <<<<<<<<<<<<<<
- *     rho_coeffs[6,2][4] = -817991.0 / 3298680.0 + a2 / 2.0
+ *     rho_coeffs[6, 2][3] = (-2.0 * a) / 3.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[6, 2][4] = -817991.0 / 3298680.0 + a2 / 2.0
  *     # (6,2) mode ends
  */
   __pyx_t_1 = 6;
   __pyx_t_2 = 2;
   __pyx_t_3 = 3;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 3.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":874
+  /* "pyseobnr/eob/waveform/waveform.pyx":893
  *     )
- *     rho_coeffs[6,2][3] = (-2.0 * a) / 3.0
- *     rho_coeffs[6,2][4] = -817991.0 / 3298680.0 + a2 / 2.0             # <<<<<<<<<<<<<<
+ *     rho_coeffs[6, 2][3] = (-2.0 * a) / 3.0
+ *     rho_coeffs[6, 2][4] = -817991.0 / 3298680.0 + a2 / 2.0             # <<<<<<<<<<<<<<
  *     # (6,2) mode ends
  * 
  */
   __pyx_t_3 = 6;
   __pyx_t_2 = 2;
   __pyx_t_1 = 4;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-817991.0 / 3298680.0) + (__pyx_v_a2 / 2.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":878
+  /* "pyseobnr/eob/waveform/waveform.pyx":897
  * 
  *     # (6,1) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[6,1][2] = (-161.0 + 694.0 * nu - 670.0 * nu2 + 124.0 * nu3) / (
+ *         rho_coeffs[6, 1][2] = (-161.0 + 694.0 * nu - 670.0 * nu2 + 124.0 * nu3) / (
  *             144.0 * (dm2 + 3.0 * nu2)
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":879
+    /* "pyseobnr/eob/waveform/waveform.pyx":898
  *     # (6,1) mode begins
  *     if dm2:
- *         rho_coeffs[6,1][2] = (-161.0 + 694.0 * nu - 670.0 * nu2 + 124.0 * nu3) / (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[6, 1][2] = (-161.0 + 694.0 * nu - 670.0 * nu2 + 124.0 * nu3) / (             # <<<<<<<<<<<<<<
  *             144.0 * (dm2 + 3.0 * nu2)
  *         )
  */
     __pyx_t_1 = 6;
     __pyx_t_2 = 1;
     __pyx_t_3 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-161.0 + (694.0 * __pyx_v_nu)) - (670.0 * __pyx_v_nu2)) + (124.0 * __pyx_v_nu3)) / (144.0 * (__pyx_v_dm2 + (3.0 * __pyx_v_nu2))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":882
+    /* "pyseobnr/eob/waveform/waveform.pyx":901
  *             144.0 * (dm2 + 3.0 * nu2)
  *         )
- *         rho_coeffs[6,1][3] = -2.0 * a / 9.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[6, 1][3] = -2.0 * a / 9.0             # <<<<<<<<<<<<<<
  *     # (6,1) mode ends
  * 
  */
     __pyx_t_3 = 6;
     __pyx_t_2 = 1;
     __pyx_t_1 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 9.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":878
+    /* "pyseobnr/eob/waveform/waveform.pyx":897
  * 
  *     # (6,1) mode begins
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[6,1][2] = (-161.0 + 694.0 * nu - 670.0 * nu2 + 124.0 * nu3) / (
+ *         rho_coeffs[6, 1][2] = (-161.0 + 694.0 * nu - 670.0 * nu2 + 124.0 * nu3) / (
  *             144.0 * (dm2 + 3.0 * nu2)
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":886
+  /* "pyseobnr/eob/waveform/waveform.pyx":905
  * 
  *     # l=7 modes begin
  *     if dm2:             # <<<<<<<<<<<<<<
  * 
- *         rho_coeffs[7,7][2] = (-906.0 + 4246.0 * nu - 4963.0 * nu2 + 1380.0 * nu3) / (
+ *         rho_coeffs[7, 7][2] = (-906.0 + 4246.0 * nu - 4963.0 * nu2 + 1380.0 * nu3) / (
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":888
+    /* "pyseobnr/eob/waveform/waveform.pyx":907
  *     if dm2:
  * 
- *         rho_coeffs[7,7][2] = (-906.0 + 4246.0 * nu - 4963.0 * nu2 + 1380.0 * nu3) / (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[7, 7][2] = (-906.0 + 4246.0 * nu - 4963.0 * nu2 + 1380.0 * nu3) / (             # <<<<<<<<<<<<<<
  *             714.0 * (dm2 + 3.0 * nu2)
  *         )
  */
     __pyx_t_1 = 7;
     __pyx_t_2 = 7;
     __pyx_t_3 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-906.0 + (4246.0 * __pyx_v_nu)) - (4963.0 * __pyx_v_nu2)) + (1380.0 * __pyx_v_nu3)) / (714.0 * (__pyx_v_dm2 + (3.0 * __pyx_v_nu2))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":891
+    /* "pyseobnr/eob/waveform/waveform.pyx":910
  *             714.0 * (dm2 + 3.0 * nu2)
  *         )
- *         rho_coeffs[7,7][3] = -2.0 * a / 3.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[7, 7][3] = -2.0 * a / 3.0             # <<<<<<<<<<<<<<
  * 
- *     rho_coeffs[7,6][2] = (
+ *     rho_coeffs[7, 6][2] = (
  */
     __pyx_t_3 = 7;
     __pyx_t_2 = 7;
     __pyx_t_1 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 3.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":886
+    /* "pyseobnr/eob/waveform/waveform.pyx":905
  * 
  *     # l=7 modes begin
  *     if dm2:             # <<<<<<<<<<<<<<
  * 
- *         rho_coeffs[7,7][2] = (-906.0 + 4246.0 * nu - 4963.0 * nu2 + 1380.0 * nu3) / (
+ *         rho_coeffs[7, 7][2] = (-906.0 + 4246.0 * nu - 4963.0 * nu2 + 1380.0 * nu3) / (
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":893
- *         rho_coeffs[7,7][3] = -2.0 * a / 3.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":912
+ *         rho_coeffs[7, 7][3] = -2.0 * a / 3.0
  * 
- *     rho_coeffs[7,6][2] = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[7, 6][2] = (             # <<<<<<<<<<<<<<
  *         2144.0 - 16185.0 * nu + 37828.0 * nu2 - 29351.0 * nu3 + 6104.0 * nu2 * nu2
  *     ) / (1666.0 * (-1 + 7 * nu - 14 * nu2 + 7 * nu3))
  */
   __pyx_t_1 = 7;
   __pyx_t_2 = 6;
   __pyx_t_3 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((((2144.0 - (16185.0 * __pyx_v_nu)) + (37828.0 * __pyx_v_nu2)) - (29351.0 * __pyx_v_nu3)) + ((6104.0 * __pyx_v_nu2) * __pyx_v_nu2)) / (1666.0 * (((-1.0 + (7.0 * __pyx_v_nu)) - (14.0 * __pyx_v_nu2)) + (7.0 * __pyx_v_nu3))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":897
+  /* "pyseobnr/eob/waveform/waveform.pyx":916
  *     ) / (1666.0 * (-1 + 7 * nu - 14 * nu2 + 7 * nu3))
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[7,5][2] = (-762.0 + 3382.0 * nu - 3523.0 * nu2 + 804.0 * nu3) / (
+ *         rho_coeffs[7, 5][2] = (-762.0 + 3382.0 * nu - 3523.0 * nu2 + 804.0 * nu3) / (
  *             714.0 * (dm2 + 3.0 * nu2)
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":898
+    /* "pyseobnr/eob/waveform/waveform.pyx":917
  * 
  *     if dm2:
- *         rho_coeffs[7,5][2] = (-762.0 + 3382.0 * nu - 3523.0 * nu2 + 804.0 * nu3) / (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[7, 5][2] = (-762.0 + 3382.0 * nu - 3523.0 * nu2 + 804.0 * nu3) / (             # <<<<<<<<<<<<<<
  *             714.0 * (dm2 + 3.0 * nu2)
  *         )
  */
     __pyx_t_3 = 7;
     __pyx_t_2 = 5;
     __pyx_t_1 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-762.0 + (3382.0 * __pyx_v_nu)) - (3523.0 * __pyx_v_nu2)) + (804.0 * __pyx_v_nu3)) / (714.0 * (__pyx_v_dm2 + (3.0 * __pyx_v_nu2))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":901
+    /* "pyseobnr/eob/waveform/waveform.pyx":920
  *             714.0 * (dm2 + 3.0 * nu2)
  *         )
- *         rho_coeffs[7,5][3] = -2.0 * a / 3.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[7, 5][3] = -2.0 * a / 3.0             # <<<<<<<<<<<<<<
  * 
- *     rho_coeffs[7,4][2] = (
+ *     rho_coeffs[7, 4][2] = (
  */
     __pyx_t_1 = 7;
     __pyx_t_2 = 5;
     __pyx_t_3 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 3.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":897
+    /* "pyseobnr/eob/waveform/waveform.pyx":916
  *     ) / (1666.0 * (-1 + 7 * nu - 14 * nu2 + 7 * nu3))
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[7,5][2] = (-762.0 + 3382.0 * nu - 3523.0 * nu2 + 804.0 * nu3) / (
+ *         rho_coeffs[7, 5][2] = (-762.0 + 3382.0 * nu - 3523.0 * nu2 + 804.0 * nu3) / (
  *             714.0 * (dm2 + 3.0 * nu2)
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":903
- *         rho_coeffs[7,5][3] = -2.0 * a / 3.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":922
+ *         rho_coeffs[7, 5][3] = -2.0 * a / 3.0
  * 
- *     rho_coeffs[7,4][2] = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[7, 4][2] = (             # <<<<<<<<<<<<<<
  *         17756.0
  *         - 131805.0 * nu
  */
   __pyx_t_3 = 7;
   __pyx_t_2 = 4;
   __pyx_t_1 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (((((17756.0 - (131805.0 * __pyx_v_nu)) + (298872.0 * __pyx_v_nu2)) - (217959.0 * __pyx_v_nu3)) + ((41076.0 * __pyx_v_nu2) * __pyx_v_nu2)) / (14994.0 * (((-1.0 + (7.0 * __pyx_v_nu)) - (14.0 * __pyx_v_nu2)) + (7.0 * __pyx_v_nu3))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":911
+  /* "pyseobnr/eob/waveform/waveform.pyx":930
  *     ) / (14994.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[7,3][2] = (-666.0 + 2806.0 * nu - 2563.0 * nu2 + 420.0 * nu3) / (
+ *         rho_coeffs[7, 3][2] = (-666.0 + 2806.0 * nu - 2563.0 * nu2 + 420.0 * nu3) / (
  *             714.0 * (dm2 + 3.0 * nu2)
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":912
+    /* "pyseobnr/eob/waveform/waveform.pyx":931
  * 
  *     if dm2:
- *         rho_coeffs[7,3][2] = (-666.0 + 2806.0 * nu - 2563.0 * nu2 + 420.0 * nu3) / (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[7, 3][2] = (-666.0 + 2806.0 * nu - 2563.0 * nu2 + 420.0 * nu3) / (             # <<<<<<<<<<<<<<
  *             714.0 * (dm2 + 3.0 * nu2)
  *         )
  */
     __pyx_t_1 = 7;
     __pyx_t_2 = 3;
     __pyx_t_3 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-666.0 + (2806.0 * __pyx_v_nu)) - (2563.0 * __pyx_v_nu2)) + (420.0 * __pyx_v_nu3)) / (714.0 * (__pyx_v_dm2 + (3.0 * __pyx_v_nu2))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":915
+    /* "pyseobnr/eob/waveform/waveform.pyx":934
  *             714.0 * (dm2 + 3.0 * nu2)
  *         )
- *         rho_coeffs[7,3][3] = -2.0 * a / 3.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[7, 3][3] = -2.0 * a / 3.0             # <<<<<<<<<<<<<<
  * 
- *     rho_coeffs[7,2][2] = (
+ *     rho_coeffs[7, 2][2] = (
  */
     __pyx_t_3 = 7;
     __pyx_t_2 = 3;
     __pyx_t_1 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 3.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":911
+    /* "pyseobnr/eob/waveform/waveform.pyx":930
  *     ) / (14994.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[7,3][2] = (-666.0 + 2806.0 * nu - 2563.0 * nu2 + 420.0 * nu3) / (
+ *         rho_coeffs[7, 3][2] = (-666.0 + 2806.0 * nu - 2563.0 * nu2 + 420.0 * nu3) / (
  *             714.0 * (dm2 + 3.0 * nu2)
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":917
- *         rho_coeffs[7,3][3] = -2.0 * a / 3.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":936
+ *         rho_coeffs[7, 3][3] = -2.0 * a / 3.0
  * 
- *     rho_coeffs[7,2][2] = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[7, 2][2] = (             # <<<<<<<<<<<<<<
  *         16832.0
  *         - 123489.0 * nu
  */
   __pyx_t_1 = 7;
   __pyx_t_2 = 2;
   __pyx_t_3 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((((16832.0 - (123489.0 * __pyx_v_nu)) + (273924.0 * __pyx_v_nu2)) - (190239.0 * __pyx_v_nu3)) + ((32760.0 * __pyx_v_nu2) * __pyx_v_nu2)) / (14994.0 * (((-1.0 + (7.0 * __pyx_v_nu)) - (14.0 * __pyx_v_nu2)) + (7.0 * __pyx_v_nu3))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":925
+  /* "pyseobnr/eob/waveform/waveform.pyx":944
  *     ) / (14994.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[7,1][2] = (-618.0 + 2518.0 * nu - 2083.0 * nu2 + 228.0 * nu3) / (
+ *         rho_coeffs[7, 1][2] = (-618.0 + 2518.0 * nu - 2083.0 * nu2 + 228.0 * nu3) / (
  *             714.0 * (dm2 + 3.0 * nu2)
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":926
+    /* "pyseobnr/eob/waveform/waveform.pyx":945
  * 
  *     if dm2:
- *         rho_coeffs[7,1][2] = (-618.0 + 2518.0 * nu - 2083.0 * nu2 + 228.0 * nu3) / (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[7, 1][2] = (-618.0 + 2518.0 * nu - 2083.0 * nu2 + 228.0 * nu3) / (             # <<<<<<<<<<<<<<
  *             714.0 * (dm2 + 3.0 * nu2)
  *         )
  */
     __pyx_t_3 = 7;
     __pyx_t_2 = 1;
     __pyx_t_1 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = ((((-618.0 + (2518.0 * __pyx_v_nu)) - (2083.0 * __pyx_v_nu2)) + (228.0 * __pyx_v_nu3)) / (714.0 * (__pyx_v_dm2 + (3.0 * __pyx_v_nu2))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":929
+    /* "pyseobnr/eob/waveform/waveform.pyx":948
  *             714.0 * (dm2 + 3.0 * nu2)
  *         )
- *         rho_coeffs[7,1][3] = -2.0 * a / 3.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[7, 1][3] = -2.0 * a / 3.0             # <<<<<<<<<<<<<<
  * 
  *     # l =7 modes end
  */
     __pyx_t_1 = 7;
     __pyx_t_2 = 1;
     __pyx_t_3 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = ((-2.0 * __pyx_v_a) / 3.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":925
+    /* "pyseobnr/eob/waveform/waveform.pyx":944
  *     ) / (14994.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[7,1][2] = (-618.0 + 2518.0 * nu - 2083.0 * nu2 + 228.0 * nu3) / (
+ *         rho_coeffs[7, 1][2] = (-618.0 + 2518.0 * nu - 2083.0 * nu2 + 228.0 * nu3) / (
  *             714.0 * (dm2 + 3.0 * nu2)
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":934
+  /* "pyseobnr/eob/waveform/waveform.pyx":953
  * 
  *     # l=8 modes begin
- *     rho_coeffs[8,8][2] = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[8, 8][2] = (             # <<<<<<<<<<<<<<
  *         3482.0 - 26778.0 * nu + 64659.0 * nu2 -
- *             53445.0 * nu3 + 12243.0 * nu2 * nu2
+ *         53445.0 * nu3 + 12243.0 * nu2 * nu2
  */
   __pyx_t_3 = 8;
   __pyx_t_2 = 8;
   __pyx_t_1 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (((((3482.0 - (26778.0 * __pyx_v_nu)) + (64659.0 * __pyx_v_nu2)) - (53445.0 * __pyx_v_nu3)) + ((12243.0 * __pyx_v_nu2) * __pyx_v_nu2)) / (2736.0 * (((-1.0 + (7.0 * __pyx_v_nu)) - (14.0 * __pyx_v_nu2)) + (7.0 * __pyx_v_nu3))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":939
+  /* "pyseobnr/eob/waveform/waveform.pyx":958
  *     ) / (2736.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[8,7][2] = (
+ *         rho_coeffs[8, 7][2] = (
  *             23478.0
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":940
+    /* "pyseobnr/eob/waveform/waveform.pyx":959
  * 
  *     if dm2:
- *         rho_coeffs[8,7][2] = (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[8, 7][2] = (             # <<<<<<<<<<<<<<
  *             23478.0
  *             - 154099.0 * nu
  */
     __pyx_t_1 = 8;
     __pyx_t_2 = 7;
     __pyx_t_3 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((((23478.0 - (154099.0 * __pyx_v_nu)) + (309498.0 * __pyx_v_nu2)) - (207550.0 * __pyx_v_nu3)) + ((38920.0 * __pyx_v_nu2) * __pyx_v_nu2)) / (18240.0 * (((-1.0 + (6.0 * __pyx_v_nu)) - (10.0 * __pyx_v_nu2)) + (4.0 * __pyx_v_nu3))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":939
+    /* "pyseobnr/eob/waveform/waveform.pyx":958
  *     ) / (2736.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[8,7][2] = (
+ *         rho_coeffs[8, 7][2] = (
  *             23478.0
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":948
+  /* "pyseobnr/eob/waveform/waveform.pyx":967
  *         ) / (18240.0 * (-1 + 6 * nu - 10 * nu2 + 4 * nu3))
  * 
- *     rho_coeffs[8,6][2] = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[8, 6][2] = (             # <<<<<<<<<<<<<<
  *         1002.0 - 7498.0 * nu + 17269.0 * nu2 - 13055.0 * nu3 + 2653.0 * nu2 * nu2
  *     ) / (912.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  */
   __pyx_t_3 = 8;
   __pyx_t_2 = 6;
   __pyx_t_1 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (((((1002.0 - (7498.0 * __pyx_v_nu)) + (17269.0 * __pyx_v_nu2)) - (13055.0 * __pyx_v_nu3)) + ((2653.0 * __pyx_v_nu2) * __pyx_v_nu2)) / (912.0 * (((-1.0 + (7.0 * __pyx_v_nu)) - (14.0 * __pyx_v_nu2)) + (7.0 * __pyx_v_nu3))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":952
+  /* "pyseobnr/eob/waveform/waveform.pyx":971
  *     ) / (912.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[8,5][2] = (
+ *         rho_coeffs[8, 5][2] = (
  *             4350.0
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":953
+    /* "pyseobnr/eob/waveform/waveform.pyx":972
  * 
  *     if dm2:
- *         rho_coeffs[8,5][2] = (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[8, 5][2] = (             # <<<<<<<<<<<<<<
  *             4350.0
  *             - 28055.0 * nu
  */
     __pyx_t_1 = 8;
     __pyx_t_2 = 5;
     __pyx_t_3 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((((4350.0 - (28055.0 * __pyx_v_nu)) + (54642.0 * __pyx_v_nu2)) - (34598.0 * __pyx_v_nu3)) + ((6056.0 * __pyx_v_nu2) * __pyx_v_nu2)) / (3648.0 * (((-1.0 + (6.0 * __pyx_v_nu)) - (10.0 * __pyx_v_nu2)) + (4.0 * __pyx_v_nu3))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":952
+    /* "pyseobnr/eob/waveform/waveform.pyx":971
  *     ) / (912.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[8,5][2] = (
+ *         rho_coeffs[8, 5][2] = (
  *             4350.0
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":961
+  /* "pyseobnr/eob/waveform/waveform.pyx":980
  *         ) / (3648.0 * (-1.0 + 6.0 * nu - 10.0 * nu2 + 4.0 * nu3))
  * 
- *     rho_coeffs[8,4][2] = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[8, 4][2] = (             # <<<<<<<<<<<<<<
  *         2666.0 - 19434.0 * nu + 42627.0 * nu2 - 28965.0 * nu3 + 4899.0 * nu2 * nu2
  *     ) / (2736.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  */
   __pyx_t_3 = 8;
   __pyx_t_2 = 4;
   __pyx_t_1 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (((((2666.0 - (19434.0 * __pyx_v_nu)) + (42627.0 * __pyx_v_nu2)) - (28965.0 * __pyx_v_nu3)) + ((4899.0 * __pyx_v_nu2) * __pyx_v_nu2)) / (2736.0 * (((-1.0 + (7.0 * __pyx_v_nu)) - (14.0 * __pyx_v_nu2)) + (7.0 * __pyx_v_nu3))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":965
+  /* "pyseobnr/eob/waveform/waveform.pyx":984
  *     ) / (2736.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[8,3][2] = (
+ *         rho_coeffs[8, 3][2] = (
  *             20598.0
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":966
+    /* "pyseobnr/eob/waveform/waveform.pyx":985
  * 
  *     if dm2:
- *         rho_coeffs[8,3][2] = (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[8, 3][2] = (             # <<<<<<<<<<<<<<
  *             20598.0
  *             - 131059.0 * nu
  */
     __pyx_t_1 = 8;
     __pyx_t_2 = 3;
     __pyx_t_3 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((((20598.0 - (131059.0 * __pyx_v_nu)) + (249018.0 * __pyx_v_nu2)) - (149950.0 * __pyx_v_nu3)) + ((24520.0 * __pyx_v_nu2) * __pyx_v_nu2)) / (18240.0 * (((-1.0 + (6.0 * __pyx_v_nu)) - (10.0 * __pyx_v_nu2)) + (4.0 * __pyx_v_nu3))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":965
+    /* "pyseobnr/eob/waveform/waveform.pyx":984
  *     ) / (2736.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[8,3][2] = (
+ *         rho_coeffs[8, 3][2] = (
  *             20598.0
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":974
+  /* "pyseobnr/eob/waveform/waveform.pyx":993
  *         ) / (18240.0 * (-1.0 + 6.0 * nu - 10.0 * nu2 + 4.0 * nu3))
  * 
- *     rho_coeffs[8,2][2] = (             # <<<<<<<<<<<<<<
+ *     rho_coeffs[8, 2][2] = (             # <<<<<<<<<<<<<<
  *         2462.0 - 17598.0 * nu + 37119.0 * nu2 - 22845.0 * nu3 + 3063.0 * nu2 * nu2
  *     ) / (2736.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  */
   __pyx_t_3 = 8;
   __pyx_t_2 = 2;
   __pyx_t_1 = 2;
   *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) = (((((2462.0 - (17598.0 * __pyx_v_nu)) + (37119.0 * __pyx_v_nu2)) - (22845.0 * __pyx_v_nu3)) + ((3063.0 * __pyx_v_nu2) * __pyx_v_nu2)) / (2736.0 * (((-1.0 + (7.0 * __pyx_v_nu)) - (14.0 * __pyx_v_nu2)) + (7.0 * __pyx_v_nu3))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":978
+  /* "pyseobnr/eob/waveform/waveform.pyx":997
  *     ) / (2736.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[8,1][2] = (
+ *         rho_coeffs[8, 1][2] = (
  *             20022.0
  */
   __pyx_t_4 = (__pyx_v_dm2 != 0);
   if (__pyx_t_4) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":979
+    /* "pyseobnr/eob/waveform/waveform.pyx":998
  * 
  *     if dm2:
- *         rho_coeffs[8,1][2] = (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[8, 1][2] = (             # <<<<<<<<<<<<<<
  *             20022.0
  *             - 126451.0 * nu
  */
     __pyx_t_1 = 8;
     __pyx_t_2 = 1;
     __pyx_t_3 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) = (((((20022.0 - (126451.0 * __pyx_v_nu)) + (236922.0 * __pyx_v_nu2)) - (138430.0 * __pyx_v_nu3)) + ((21640.0 * __pyx_v_nu2) * __pyx_v_nu2)) / (18240.0 * (((-1.0 + (6.0 * __pyx_v_nu)) - (10.0 * __pyx_v_nu2)) + (4.0 * __pyx_v_nu3))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":978
+    /* "pyseobnr/eob/waveform/waveform.pyx":997
  *     ) / (2736.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
  * 
  *     if dm2:             # <<<<<<<<<<<<<<
- *         rho_coeffs[8,1][2] = (
+ *         rho_coeffs[8, 1][2] = (
  *             20022.0
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":987
+  /* "pyseobnr/eob/waveform/waveform.pyx":1006
  *         ) / (18240.0 * (-1.0 + 6.0 * nu - 10.0 * nu2 + 4.0 * nu3))
  * 
  *     if extra_PN_terms:             # <<<<<<<<<<<<<<
  *         # NB: One needs to be careful when adding new terms here.
  *         # If terms at the given order already exist then it may be
  */
   if (__pyx_v_extra_PN_terms) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":997
+    /* "pyseobnr/eob/waveform/waveform.pyx":1016
  *         # Add the NLO  spin-squared term at 3PN
  *         # We need to get rid of the test-spin term
- *         rho_coeffs[2,2][6] -=(89.0 * atemp*atemp) / 252.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[2,2][6] += (
+ *         rho_coeffs[2, 2][6] -=(89.0 * atemp*atemp) / 252.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[2, 2][6] += (
  *             ((178. - 457.*nu- 972.*nu**2)*chiA**2)/504. +
  */
     __pyx_t_3 = 2;
     __pyx_t_2 = 2;
     __pyx_t_1 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) -= (((89.0 * __pyx_v_atemp) * __pyx_v_atemp) / 252.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":998
+    /* "pyseobnr/eob/waveform/waveform.pyx":1017
  *         # We need to get rid of the test-spin term
- *         rho_coeffs[2,2][6] -=(89.0 * atemp*atemp) / 252.0
- *         rho_coeffs[2,2][6] += (             # <<<<<<<<<<<<<<
+ *         rho_coeffs[2, 2][6] -=(89.0 * atemp*atemp) / 252.0
+ *         rho_coeffs[2, 2][6] += (             # <<<<<<<<<<<<<<
  *             ((178. - 457.*nu- 972.*nu**2)*chiA**2)/504. +
  *             (dm*(178. - 781.*nu)*chiA*chiS)/252. +
  */
     __pyx_t_1 = 2;
     __pyx_t_2 = 2;
     __pyx_t_3 = 6;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) += ((((((178. - (457. * __pyx_v_nu)) - (972. * pow(__pyx_v_nu, 2.0))) * pow(__pyx_v_chiA, 2.0)) / 504.) + ((((__pyx_v_dm * (178. - (781. * __pyx_v_nu))) * __pyx_v_chiA) * __pyx_v_chiS) / 252.)) + ((((178. - (1817. * __pyx_v_nu)) + (560. * pow(__pyx_v_nu, 2.0))) * pow(__pyx_v_chiS, 2.0)) / 504.));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1005
+    /* "pyseobnr/eob/waveform/waveform.pyx":1024
  *         # We need to get rid of the test-spin term
  *         # We need atemp because we have set a to zero afer the (2,2) mode
- *         rho_coeffs[2,2][7] -= atemp**3/3.0             # <<<<<<<<<<<<<<
- *         rho_coeffs[2,2][7] += (((dm - 4.*dm*nu)*chiA**3)/3. +
- *                 (1. - 3.*nu - 4.*nu**2)*chiA**2*chiS +
+ *         rho_coeffs[2, 2][7] -= atemp**3/3.0             # <<<<<<<<<<<<<<
+ *         rho_coeffs[2, 2][7] += (
+ *             ((dm - 4.*dm*nu)*chiA**3)/3.
  */
     __pyx_t_3 = 2;
     __pyx_t_2 = 2;
     __pyx_t_1 = 7;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) -= (pow(__pyx_v_atemp, 3.0) / 3.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1006
+    /* "pyseobnr/eob/waveform/waveform.pyx":1025
  *         # We need atemp because we have set a to zero afer the (2,2) mode
- *         rho_coeffs[2,2][7] -= atemp**3/3.0
- *         rho_coeffs[2,2][7] += (((dm - 4.*dm*nu)*chiA**3)/3. +             # <<<<<<<<<<<<<<
- *                 (1. - 3.*nu - 4.*nu**2)*chiA**2*chiS +
- *                 ( dm + 2.*dm*nu)*chiA*chiS**2 +
+ *         rho_coeffs[2, 2][7] -= atemp**3/3.0
+ *         rho_coeffs[2, 2][7] += (             # <<<<<<<<<<<<<<
+ *             ((dm - 4.*dm*nu)*chiA**3)/3.
+ *             + (1. - 3.*nu - 4.*nu**2)*chiA**2*chiS
  */
     __pyx_t_1 = 2;
     __pyx_t_2 = 2;
     __pyx_t_3 = 7;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) += ((((((__pyx_v_dm - ((4. * __pyx_v_dm) * __pyx_v_nu)) * pow(__pyx_v_chiA, 3.0)) / 3.) + ((((1. - (3. * __pyx_v_nu)) - (4. * pow(__pyx_v_nu, 2.0))) * pow(__pyx_v_chiA, 2.0)) * __pyx_v_chiS)) + (((__pyx_v_dm + ((2. * __pyx_v_dm) * __pyx_v_nu)) * __pyx_v_chiA) * pow(__pyx_v_chiS, 2.0))) + (((1. / 3.) + __pyx_v_nu) * pow(__pyx_v_chiS, 3.0)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1015
+    /* "pyseobnr/eob/waveform/waveform.pyx":1036
  * 
  *         # All the known spin terms in (3,2)
- *         rho_coeffs[3,2][2] +=  -(16.*nu**2*chiS**2)/(9.*(1. - 3.*nu)**2)             # <<<<<<<<<<<<<<
- *         rho_coeffs[3,2][3] += ((dm*(2. + 13.*nu)*chiA)/(9. - 27.*nu) +
- *                                 ((90. - 1478.*nu + 2515.*nu**2 + 3035.*nu**3)*chiS)/
+ *         rho_coeffs[3, 2][2] += -(16.*nu**2*chiS**2)/(9.*(1. - 3.*nu)**2)             # <<<<<<<<<<<<<<
+ *         rho_coeffs[3, 2][3] += (
+ *             (dm*(2. + 13.*nu)*chiA)/(9. - 27.*nu)
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 2;
     __pyx_t_1 = 2;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) += ((-((16. * pow(__pyx_v_nu, 2.0)) * pow(__pyx_v_chiS, 2.0))) / (9. * pow((1. - (3. * __pyx_v_nu)), 2.0)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1016
+    /* "pyseobnr/eob/waveform/waveform.pyx":1037
  *         # All the known spin terms in (3,2)
- *         rho_coeffs[3,2][2] +=  -(16.*nu**2*chiS**2)/(9.*(1. - 3.*nu)**2)
- *         rho_coeffs[3,2][3] += ((dm*(2. + 13.*nu)*chiA)/(9. - 27.*nu) +             # <<<<<<<<<<<<<<
- *                                 ((90. - 1478.*nu + 2515.*nu**2 + 3035.*nu**3)*chiS)/
- *                                 (405.*(1. - 3.*nu)**2) - (320.*nu**3*chiS**3)/
+ *         rho_coeffs[3, 2][2] += -(16.*nu**2*chiS**2)/(9.*(1. - 3.*nu)**2)
+ *         rho_coeffs[3, 2][3] += (             # <<<<<<<<<<<<<<
+ *             (dm*(2. + 13.*nu)*chiA)/(9. - 27.*nu)
+ *             + ((90. - 1478.*nu + 2515.*nu**2 + 3035.*nu**3)*chiS)/(405.*(1. - 3.*nu)**2)
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 2;
     __pyx_t_3 = 3;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) += (((((__pyx_v_dm * (2. + (13. * __pyx_v_nu))) * __pyx_v_chiA) / (9. - (27. * __pyx_v_nu))) + (((((90. - (1478. * __pyx_v_nu)) + (2515. * pow(__pyx_v_nu, 2.0))) + (3035. * pow(__pyx_v_nu, 3.0))) * __pyx_v_chiS) / (405. * pow((1. - (3. * __pyx_v_nu)), 2.0)))) - (((320. * pow(__pyx_v_nu, 3.0)) * pow(__pyx_v_chiS, 3.0)) / (81. * pow((-1. + (3. * __pyx_v_nu)), 3.0))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1020
- *                                 (405.*(1. - 3.*nu)**2) - (320.*nu**3*chiS**3)/
- *                                 (81.*(-1. + 3.*nu)**3))
- *         rho_coeffs[3,2][4] +=  (((1. - 9.*nu + 12.*nu**2)*chiA**2)/(3. - 9.*nu) -             # <<<<<<<<<<<<<<
- *                                 (2.*dm*(-9. + 44.*nu + 25.*nu**2)*chiA*chiS)/
- *                                 (27.*(1. - 3.*nu)**2) + ((-81. + 387.*nu - 1435.*nu**2 +
+    /* "pyseobnr/eob/waveform/waveform.pyx":1042
+ *             - (320.*nu**3*chiS**3)/(81.*(-1. + 3.*nu)**3)
+ *         )
+ *         rho_coeffs[3, 2][4] += (             # <<<<<<<<<<<<<<
+ *             ((1. - 9.*nu + 12.*nu**2)*chiA**2)/(3. - 9.*nu)
+ *             - (2.*dm*(-9. + 44.*nu + 25.*nu**2)*chiA*chiS)/(27.*(1. - 3.*nu)**2)
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = 2;
     __pyx_t_1 = 4;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_3 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_rho_coeffs.strides[2]) )) += ((((((1. - (9. * __pyx_v_nu)) + (12. * pow(__pyx_v_nu, 2.0))) * pow(__pyx_v_chiA, 2.0)) / (3. - (9. * __pyx_v_nu))) - (((((2. * __pyx_v_dm) * ((-9. + (44. * __pyx_v_nu)) + (25. * pow(__pyx_v_nu, 2.0)))) * __pyx_v_chiA) * __pyx_v_chiS) / (27. * pow((1. - (3. * __pyx_v_nu)), 2.0)))) + ((((((-81. + (387. * __pyx_v_nu)) - (1435. * pow(__pyx_v_nu, 2.0))) + (1997. * pow(__pyx_v_nu, 3.0))) + (2452. * pow(__pyx_v_nu, 4.0))) * pow(__pyx_v_chiS, 2.0)) / (243. * pow((-1.0 + (3. * __pyx_v_nu)), 3.0))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1024
- *                                 (27.*(1. - 3.*nu)**2) + ((-81. + 387.*nu - 1435.*nu**2 +
- *                                 1997.*nu**3 + 2452.*nu**4)*chiS**2)/(243.*(-1 + 3.*nu)**3))
- *         rho_coeffs[3,2][5] += ((dm*(-245344. + 1128531.*nu - 1514740.*nu**2 +889673.*nu**3)*chiA)/(106920.*(1 - 3*nu)**2) +             # <<<<<<<<<<<<<<
- *                             ((2208096. - 20471053.*nu + 70519165.*nu**2 - 101706029.*nu**3 +40204523.*nu**4 + 11842250.*nu**5)*chiS)/
- *                             (962280.*(-1. + 3.*nu)**3) - (8.*nu*(1. - 9.*nu + 12.*nu**2)*chiA**2*chiS)/(9.*(1. - 3.*nu)**2) -
+    /* "pyseobnr/eob/waveform/waveform.pyx":1047
+ *             + ((-81. + 387.*nu - 1435.*nu**2 + 1997.*nu**3 + 2452.*nu**4)*chiS**2)/(243.*(-1 + 3.*nu)**3)
+ *         )
+ *         rho_coeffs[3, 2][5] += (             # <<<<<<<<<<<<<<
+ *             (dm*(-245344. + 1128531.*nu - 1514740.*nu**2 + 889673.*nu**3)*chiA)/(106920.*(1 - 3*nu)**2)
+ *             + ((2208096.
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = 2;
     __pyx_t_3 = 5;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_1 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_rho_coeffs.strides[2]) )) += (((((((__pyx_v_dm * (((-245344. + (1128531. * __pyx_v_nu)) - (1514740. * pow(__pyx_v_nu, 2.0))) + (889673. * pow(__pyx_v_nu, 3.0)))) * __pyx_v_chiA) / (106920. * pow((1.0 - (3.0 * __pyx_v_nu)), 2.0))) + (((((((2208096. - (20471053. * __pyx_v_nu)) + (70519165. * pow(__pyx_v_nu, 2.0))) - (101706029. * pow(__pyx_v_nu, 3.0))) + (40204523. * pow(__pyx_v_nu, 4.0))) + (11842250. * pow(__pyx_v_nu, 5.0))) * __pyx_v_chiS) / (962280. * pow((-1. + (3. * __pyx_v_nu)), 3.0)))) - (((((8. * __pyx_v_nu) * ((1. - (9. * __pyx_v_nu)) + (12. * pow(__pyx_v_nu, 2.0)))) * pow(__pyx_v_chiA, 2.0)) * __pyx_v_chiS) / (9. * pow((1. - (3. * __pyx_v_nu)), 2.0)))) - ((((((16. * __pyx_v_dm) * __pyx_v_nu) * ((-9. + (46. * __pyx_v_nu)) + (38. * pow(__pyx_v_nu, 2.0)))) * __pyx_v_chiA) * pow(__pyx_v_chiS, 2.0)) / (81. * pow((-1. + (3. * __pyx_v_nu)), 3.0)))) + ((((8. * __pyx_v_nu) * ((((-243. + (1269. * __pyx_v_nu)) - (5029. * pow(__pyx_v_nu, 2.0))) + (5441. * pow(__pyx_v_nu, 3.0))) + (12022. * pow(__pyx_v_nu, 4.0)))) * pow(__pyx_v_chiS, 3.0)) / (2187. * pow((1. - (3. * __pyx_v_nu)), 4.0))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1033
+    /* "pyseobnr/eob/waveform/waveform.pyx":1069
  *         # NB: odd m so these are f-coeffs and we must treat the dm->0 issue as always
  * 
  *         if dm2:             # <<<<<<<<<<<<<<
- * 
- *             f_coeffs[4,3][3] = ((nu*(-2661. + 3143.*nu)*chiA)/(132.*dm*(-1. + 2.*nu)) +
+ *             f_coeffs[4, 3][3] = (
+ *                 (nu*(-2661. + 3143.*nu)*chiA)/(132.*dm*(-1. + 2.*nu))
  */
     __pyx_t_4 = (__pyx_v_dm2 != 0);
     if (__pyx_t_4) {
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1035
- *         if dm2:
- * 
- *             f_coeffs[4,3][3] = ((nu*(-2661. + 3143.*nu)*chiA)/(132.*dm*(-1. + 2.*nu)) +             # <<<<<<<<<<<<<<
- *                             (23.*nu*(87. + 23.*nu)*chiS)/(132.*(-1. + 2.*nu)))
+      /* "pyseobnr/eob/waveform/waveform.pyx":1070
  * 
+ *         if dm2:
+ *             f_coeffs[4, 3][3] = (             # <<<<<<<<<<<<<<
+ *                 (nu*(-2661. + 3143.*nu)*chiA)/(132.*dm*(-1. + 2.*nu))
+ *                 + (23.*nu*(87. + 23.*nu)*chiS)/(132.*(-1. + 2.*nu))
  */
       __pyx_t_3 = 4;
       __pyx_t_2 = 3;
       __pyx_t_1 = 3;
       *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = ((((__pyx_v_nu * (-2661. + (3143. * __pyx_v_nu))) * __pyx_v_chiA) / ((132. * __pyx_v_dm) * (-1. + (2. * __pyx_v_nu)))) + ((((23. * __pyx_v_nu) * (87. + (23. * __pyx_v_nu))) * __pyx_v_chiS) / (132. * (-1. + (2. * __pyx_v_nu)))));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1039
- * 
+      /* "pyseobnr/eob/waveform/waveform.pyx":1075
+ *             )
  * 
- *             f_coeffs[4,3][4] = (((9. - 74.*nu + 72.*nu**2)*chiA**2)/(6. - 12.*nu) +             # <<<<<<<<<<<<<<
- *                             ((18. - 108.*nu + 137.*nu**2)*chiA*chiS)/(6.*dm - 12.*dm*nu) + ((9. + 2.*nu + 35.*nu**2)*
- *                             chiS**2)/(6. - 12.*nu))
+ *             f_coeffs[4, 3][4] = (             # <<<<<<<<<<<<<<
+ *                 ((9. - 74.*nu + 72.*nu**2)*chiA**2)/(6. - 12.*nu)
+ *                 + ((18. - 108.*nu + 137.*nu**2)*chiA*chiS)/(6.*dm - 12.*dm*nu)
  */
       __pyx_t_1 = 4;
       __pyx_t_2 = 3;
       __pyx_t_3 = 4;
       *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = ((((((9. - (74. * __pyx_v_nu)) + (72. * pow(__pyx_v_nu, 2.0))) * pow(__pyx_v_chiA, 2.0)) / (6. - (12. * __pyx_v_nu))) + (((((18. - (108. * __pyx_v_nu)) + (137. * pow(__pyx_v_nu, 2.0))) * __pyx_v_chiA) * __pyx_v_chiS) / ((6. * __pyx_v_dm) - ((12. * __pyx_v_dm) * __pyx_v_nu)))) + ((((9. + (2. * __pyx_v_nu)) + (35. * pow(__pyx_v_nu, 2.0))) * pow(__pyx_v_chiS, 2.0)) / (6. - (12. * __pyx_v_nu))));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1033
+      /* "pyseobnr/eob/waveform/waveform.pyx":1069
  *         # NB: odd m so these are f-coeffs and we must treat the dm->0 issue as always
  * 
  *         if dm2:             # <<<<<<<<<<<<<<
- * 
- *             f_coeffs[4,3][3] = ((nu*(-2661. + 3143.*nu)*chiA)/(132.*dm*(-1. + 2.*nu)) +
+ *             f_coeffs[4, 3][3] = (
+ *                 (nu*(-2661. + 3143.*nu)*chiA)/(132.*dm*(-1. + 2.*nu))
  */
       goto __pyx_L23;
     }
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1045
- * 
+    /* "pyseobnr/eob/waveform/waveform.pyx":1081
+ *             )
  *         else:
- *             f_coeffs[4,3][3] = ((nu*(-2661. + 3143.*nu)*chiA)/(132.*(-1. + 2.*nu)))             # <<<<<<<<<<<<<<
- *             f_coeffs[4,3][4] = ((18. - 108.*nu + 137.*nu**2)*chiA*chiS)/(6. - 12.*nu)
+ *             f_coeffs[4, 3][3] = (nu*(-2661. + 3143.*nu)*chiA)/(132.*(-1. + 2.*nu))             # <<<<<<<<<<<<<<
+ *             f_coeffs[4, 3][4] = ((18. - 108.*nu + 137.*nu**2)*chiA*chiS)/(6. - 12.*nu)
  * 
  */
     /*else*/ {
       __pyx_t_3 = 4;
       __pyx_t_2 = 3;
       __pyx_t_1 = 3;
       *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_3 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_f_coeffs.strides[2]) )) = (((__pyx_v_nu * (-2661. + (3143. * __pyx_v_nu))) * __pyx_v_chiA) / (132. * (-1. + (2. * __pyx_v_nu))));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1046
+      /* "pyseobnr/eob/waveform/waveform.pyx":1082
  *         else:
- *             f_coeffs[4,3][3] = ((nu*(-2661. + 3143.*nu)*chiA)/(132.*(-1. + 2.*nu)))
- *             f_coeffs[4,3][4] = ((18. - 108.*nu + 137.*nu**2)*chiA*chiS)/(6. - 12.*nu)             # <<<<<<<<<<<<<<
+ *             f_coeffs[4, 3][3] = (nu*(-2661. + 3143.*nu)*chiA)/(132.*(-1. + 2.*nu))
+ *             f_coeffs[4, 3][4] = ((18. - 108.*nu + 137.*nu**2)*chiA*chiS)/(6. - 12.*nu)             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_1 = 4;
       __pyx_t_2 = 3;
       __pyx_t_3 = 4;
       *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_f_coeffs.data + __pyx_t_1 * __pyx_v_f_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_f_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_f_coeffs.strides[2]) )) = (((((18. - (108. * __pyx_v_nu)) + (137. * pow(__pyx_v_nu, 2.0))) * __pyx_v_chiA) * __pyx_v_chiS) / (6. - (12. * __pyx_v_nu)));
     }
     __pyx_L23:;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":987
+    /* "pyseobnr/eob/waveform/waveform.pyx":1006
  *         ) / (18240.0 * (-1.0 + 6.0 * nu - 10.0 * nu2 + 4.0 * nu3))
  * 
  *     if extra_PN_terms:             # <<<<<<<<<<<<<<
  *         # NB: One needs to be careful when adding new terms here.
  *         # If terms at the given order already exist then it may be
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":304
+  /* "pyseobnr/eob/waveform/waveform.pyx":321
  * @cython.nonecheck(False)
  * @cython.initializedcheck(False)
- * cpdef void compute_rho_coeffs(double nu,double dm, double a,double chiS,double chiA,             # <<<<<<<<<<<<<<
- *     double[:,:,:] rho_coeffs,double[:,:,:] rho_coeffs_log, double[:,:,:] f_coeffs,
- *     double complex[:,:,:] f_coeffs_vh, bint extra_PN_terms):
+ * cpdef void compute_rho_coeffs(             # <<<<<<<<<<<<<<
+ *     double nu,
+ *     double dm,
  */
 
   /* function exit code */
 }
 
 /* Python wrapper */
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_9compute_rho_coeffs(PyObject *__pyx_self, 
@@ -25779,110 +25773,110 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_nu)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 321, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dm)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 321, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 1); __PYX_ERR(0, 304, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 1); __PYX_ERR(0, 321, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 321, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 2); __PYX_ERR(0, 304, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 2); __PYX_ERR(0, 321, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_chiS)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 321, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 3); __PYX_ERR(0, 304, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 3); __PYX_ERR(0, 321, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_chiA)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 321, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 4); __PYX_ERR(0, 304, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 4); __PYX_ERR(0, 321, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rho_coeffs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[5]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 321, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 5); __PYX_ERR(0, 304, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 5); __PYX_ERR(0, 321, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rho_coeffs_log)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[6]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 321, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 6); __PYX_ERR(0, 304, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 6); __PYX_ERR(0, 321, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_f_coeffs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[7]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 321, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 7); __PYX_ERR(0, 304, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 7); __PYX_ERR(0, 321, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
         if (likely((values[8] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_f_coeffs_vh)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[8]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 321, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 8); __PYX_ERR(0, 304, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 8); __PYX_ERR(0, 321, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  9:
         if (likely((values[9] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_extra_PN_terms)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[9]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 321, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 9); __PYX_ERR(0, 304, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, 9); __PYX_ERR(0, 321, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_rho_coeffs") < 0)) __PYX_ERR(0, 304, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_rho_coeffs") < 0)) __PYX_ERR(0, 321, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 10)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
@@ -25890,28 +25884,28 @@
       values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
       values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
       values[6] = __Pyx_Arg_FASTCALL(__pyx_args, 6);
       values[7] = __Pyx_Arg_FASTCALL(__pyx_args, 7);
       values[8] = __Pyx_Arg_FASTCALL(__pyx_args, 8);
       values[9] = __Pyx_Arg_FASTCALL(__pyx_args, 9);
     }
-    __pyx_v_nu = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_nu == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
-    __pyx_v_dm = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_dm == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
-    __pyx_v_a = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_a == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
-    __pyx_v_chiS = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chiS == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
-    __pyx_v_chiA = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_chiA == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L3_error)
-    __pyx_v_rho_coeffs = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(values[5], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rho_coeffs.memview)) __PYX_ERR(0, 305, __pyx_L3_error)
-    __pyx_v_rho_coeffs_log = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(values[6], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rho_coeffs_log.memview)) __PYX_ERR(0, 305, __pyx_L3_error)
-    __pyx_v_f_coeffs = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(values[7], PyBUF_WRITABLE); if (unlikely(!__pyx_v_f_coeffs.memview)) __PYX_ERR(0, 305, __pyx_L3_error)
-    __pyx_v_f_coeffs_vh = __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex(values[8], PyBUF_WRITABLE); if (unlikely(!__pyx_v_f_coeffs_vh.memview)) __PYX_ERR(0, 306, __pyx_L3_error)
-    __pyx_v_extra_PN_terms = __Pyx_PyObject_IsTrue(values[9]); if (unlikely((__pyx_v_extra_PN_terms == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 306, __pyx_L3_error)
+    __pyx_v_nu = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_nu == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 322, __pyx_L3_error)
+    __pyx_v_dm = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_dm == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 323, __pyx_L3_error)
+    __pyx_v_a = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_a == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 324, __pyx_L3_error)
+    __pyx_v_chiS = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_chiS == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 325, __pyx_L3_error)
+    __pyx_v_chiA = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_chiA == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 326, __pyx_L3_error)
+    __pyx_v_rho_coeffs = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(values[5], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rho_coeffs.memview)) __PYX_ERR(0, 327, __pyx_L3_error)
+    __pyx_v_rho_coeffs_log = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(values[6], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rho_coeffs_log.memview)) __PYX_ERR(0, 328, __pyx_L3_error)
+    __pyx_v_f_coeffs = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(values[7], PyBUF_WRITABLE); if (unlikely(!__pyx_v_f_coeffs.memview)) __PYX_ERR(0, 329, __pyx_L3_error)
+    __pyx_v_f_coeffs_vh = __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex(values[8], PyBUF_WRITABLE); if (unlikely(!__pyx_v_f_coeffs_vh.memview)) __PYX_ERR(0, 330, __pyx_L3_error)
+    __pyx_v_extra_PN_terms = __Pyx_PyObject_IsTrue(values[9]); if (unlikely((__pyx_v_extra_PN_terms == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 331, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, __pyx_nargs); __PYX_ERR(0, 304, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("compute_rho_coeffs", 1, 10, 10, __pyx_nargs); __PYX_ERR(0, 321, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -25947,16 +25941,16 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("compute_rho_coeffs", 1);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rho_coeffs(__pyx_v_nu, __pyx_v_dm, __pyx_v_a, __pyx_v_chiS, __pyx_v_chiA, __pyx_v_rho_coeffs, __pyx_v_rho_coeffs_log, __pyx_v_f_coeffs, __pyx_v_f_coeffs_vh, __pyx_v_extra_PN_terms, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_void_to_None(NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 304, __pyx_L1_error)
+  __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rho_coeffs(__pyx_v_nu, __pyx_v_dm, __pyx_v_a, __pyx_v_chiS, __pyx_v_chiA, __pyx_v_rho_coeffs, __pyx_v_rho_coeffs_log, __pyx_v_f_coeffs, __pyx_v_f_coeffs_vh, __pyx_v_extra_PN_terms, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 321, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_void_to_None(NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -25965,20 +25959,20 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":1057
+/* "pyseobnr/eob/waveform/waveform.pyx":1093
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef public void compute_delta_coeffs(double nu,double dm, double a,double chiS,double chiA,             # <<<<<<<<<<<<<<
- *     double complex[:,:,:] delta_coeffs, double complex[:,:,:] delta_coeffs_vh):
- * 
+ * cdef public void compute_delta_coeffs(             # <<<<<<<<<<<<<<
+ *     double nu,
+ *     double dm,
  */
 
 void compute_delta_coeffs(double __pyx_v_nu, double __pyx_v_dm, double __pyx_v_a, double __pyx_v_chiS, double __pyx_v_chiA, __Pyx_memviewslice __pyx_v_delta_coeffs, __Pyx_memviewslice __pyx_v_delta_coeffs_vh) {
   double __pyx_v_nu2;
   CYTHON_UNUSED double __pyx_v_nu3;
   double __pyx_v_a2;
   CYTHON_UNUSED double __pyx_v_a3;
@@ -25994,870 +25988,870 @@
   __Pyx_TraceDeclarations
   Py_ssize_t __pyx_t_1;
   Py_ssize_t __pyx_t_2;
   Py_ssize_t __pyx_t_3;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceCall("compute_delta_coeffs", __pyx_f[0], 1057, 0, __PYX_ERR(0, 1057, __pyx_L1_error));
+  __Pyx_TraceCall("compute_delta_coeffs", __pyx_f[0], 1093, 0, __PYX_ERR(0, 1093, __pyx_L1_error));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1075
+  /* "pyseobnr/eob/waveform/waveform.pyx":1117
  *     """
  * 
  *     cdef double nu2 = nu*nu             # <<<<<<<<<<<<<<
  *     cdef double nu3 = nu*nu2
  * 
  */
-  __Pyx_TraceLine(1075,0,__PYX_ERR(0, 1075, __pyx_L1_error))
+  __Pyx_TraceLine(1117,0,__PYX_ERR(0, 1117, __pyx_L1_error))
   __pyx_v_nu2 = (__pyx_v_nu * __pyx_v_nu);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1076
+  /* "pyseobnr/eob/waveform/waveform.pyx":1118
  * 
  *     cdef double nu2 = nu*nu
  *     cdef double nu3 = nu*nu2             # <<<<<<<<<<<<<<
  * 
  *     cdef double a2 = a*a
  */
-  __Pyx_TraceLine(1076,0,__PYX_ERR(0, 1076, __pyx_L1_error))
+  __Pyx_TraceLine(1118,0,__PYX_ERR(0, 1118, __pyx_L1_error))
   __pyx_v_nu3 = (__pyx_v_nu * __pyx_v_nu2);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1078
+  /* "pyseobnr/eob/waveform/waveform.pyx":1120
  *     cdef double nu3 = nu*nu2
  * 
  *     cdef double a2 = a*a             # <<<<<<<<<<<<<<
  *     cdef double a3 = a*a2
  *     cdef double dm2 = dm*dm
  */
-  __Pyx_TraceLine(1078,0,__PYX_ERR(0, 1078, __pyx_L1_error))
+  __Pyx_TraceLine(1120,0,__PYX_ERR(0, 1120, __pyx_L1_error))
   __pyx_v_a2 = (__pyx_v_a * __pyx_v_a);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1079
+  /* "pyseobnr/eob/waveform/waveform.pyx":1121
  * 
  *     cdef double a2 = a*a
  *     cdef double a3 = a*a2             # <<<<<<<<<<<<<<
  *     cdef double dm2 = dm*dm
  * 
  */
-  __Pyx_TraceLine(1079,0,__PYX_ERR(0, 1079, __pyx_L1_error))
+  __Pyx_TraceLine(1121,0,__PYX_ERR(0, 1121, __pyx_L1_error))
   __pyx_v_a3 = (__pyx_v_a * __pyx_v_a2);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1080
+  /* "pyseobnr/eob/waveform/waveform.pyx":1122
  *     cdef double a2 = a*a
  *     cdef double a3 = a*a2
  *     cdef double dm2 = dm*dm             # <<<<<<<<<<<<<<
  * 
  *     cdef double chiA2 = chiA * chiA
  */
-  __Pyx_TraceLine(1080,0,__PYX_ERR(0, 1080, __pyx_L1_error))
+  __Pyx_TraceLine(1122,0,__PYX_ERR(0, 1122, __pyx_L1_error))
   __pyx_v_dm2 = (__pyx_v_dm * __pyx_v_dm);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1082
+  /* "pyseobnr/eob/waveform/waveform.pyx":1124
  *     cdef double dm2 = dm*dm
  * 
  *     cdef double chiA2 = chiA * chiA             # <<<<<<<<<<<<<<
  *     cdef double chiS2 = chiS * chiS
  *     cdef double chiA3 = chiA2 * chiA
  */
-  __Pyx_TraceLine(1082,0,__PYX_ERR(0, 1082, __pyx_L1_error))
+  __Pyx_TraceLine(1124,0,__PYX_ERR(0, 1124, __pyx_L1_error))
   __pyx_v_chiA2 = (__pyx_v_chiA * __pyx_v_chiA);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1083
+  /* "pyseobnr/eob/waveform/waveform.pyx":1125
  * 
  *     cdef double chiA2 = chiA * chiA
  *     cdef double chiS2 = chiS * chiS             # <<<<<<<<<<<<<<
  *     cdef double chiA3 = chiA2 * chiA
  *     cdef double chiS3 = chiS2 * chiS
  */
-  __Pyx_TraceLine(1083,0,__PYX_ERR(0, 1083, __pyx_L1_error))
+  __Pyx_TraceLine(1125,0,__PYX_ERR(0, 1125, __pyx_L1_error))
   __pyx_v_chiS2 = (__pyx_v_chiS * __pyx_v_chiS);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1084
+  /* "pyseobnr/eob/waveform/waveform.pyx":1126
  *     cdef double chiA2 = chiA * chiA
  *     cdef double chiS2 = chiS * chiS
  *     cdef double chiA3 = chiA2 * chiA             # <<<<<<<<<<<<<<
  *     cdef double chiS3 = chiS2 * chiS
  * 
  */
-  __Pyx_TraceLine(1084,0,__PYX_ERR(0, 1084, __pyx_L1_error))
+  __Pyx_TraceLine(1126,0,__PYX_ERR(0, 1126, __pyx_L1_error))
   __pyx_v_chiA3 = (__pyx_v_chiA2 * __pyx_v_chiA);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1085
+  /* "pyseobnr/eob/waveform/waveform.pyx":1127
  *     cdef double chiS2 = chiS * chiS
  *     cdef double chiA3 = chiA2 * chiA
  *     cdef double chiS3 = chiS2 * chiS             # <<<<<<<<<<<<<<
  * 
  *     cdef double m1Plus3nu = -1.0 + 3.0 * nu
  */
-  __Pyx_TraceLine(1085,0,__PYX_ERR(0, 1085, __pyx_L1_error))
+  __Pyx_TraceLine(1127,0,__PYX_ERR(0, 1127, __pyx_L1_error))
   __pyx_v_chiS3 = (__pyx_v_chiS2 * __pyx_v_chiS);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1087
+  /* "pyseobnr/eob/waveform/waveform.pyx":1129
  *     cdef double chiS3 = chiS2 * chiS
  * 
  *     cdef double m1Plus3nu = -1.0 + 3.0 * nu             # <<<<<<<<<<<<<<
  *     cdef double m1Plus3nu2 = m1Plus3nu * m1Plus3nu
  *     cdef double m1Plus3nu3 = m1Plus3nu * m1Plus3nu2
  */
-  __Pyx_TraceLine(1087,0,__PYX_ERR(0, 1087, __pyx_L1_error))
+  __Pyx_TraceLine(1129,0,__PYX_ERR(0, 1129, __pyx_L1_error))
   __pyx_v_m1Plus3nu = (-1.0 + (3.0 * __pyx_v_nu));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1088
+  /* "pyseobnr/eob/waveform/waveform.pyx":1130
  * 
  *     cdef double m1Plus3nu = -1.0 + 3.0 * nu
  *     cdef double m1Plus3nu2 = m1Plus3nu * m1Plus3nu             # <<<<<<<<<<<<<<
  *     cdef double m1Plus3nu3 = m1Plus3nu * m1Plus3nu2
  * 
  */
-  __Pyx_TraceLine(1088,0,__PYX_ERR(0, 1088, __pyx_L1_error))
+  __Pyx_TraceLine(1130,0,__PYX_ERR(0, 1130, __pyx_L1_error))
   __pyx_v_m1Plus3nu2 = (__pyx_v_m1Plus3nu * __pyx_v_m1Plus3nu);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1089
+  /* "pyseobnr/eob/waveform/waveform.pyx":1131
  *     cdef double m1Plus3nu = -1.0 + 3.0 * nu
  *     cdef double m1Plus3nu2 = m1Plus3nu * m1Plus3nu
  *     cdef double m1Plus3nu3 = m1Plus3nu * m1Plus3nu2             # <<<<<<<<<<<<<<
  * 
  *     cdef double aDelta = 0.0
  */
-  __Pyx_TraceLine(1089,0,__PYX_ERR(0, 1089, __pyx_L1_error))
+  __Pyx_TraceLine(1131,0,__PYX_ERR(0, 1131, __pyx_L1_error))
   __pyx_v_m1Plus3nu3 = (__pyx_v_m1Plus3nu * __pyx_v_m1Plus3nu2);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1091
+  /* "pyseobnr/eob/waveform/waveform.pyx":1133
  *     cdef double m1Plus3nu3 = m1Plus3nu * m1Plus3nu2
  * 
  *     cdef double aDelta = 0.0             # <<<<<<<<<<<<<<
  * 
- *     #(2,2) mode begins
+ *     # (2,2) mode begins
  */
-  __Pyx_TraceLine(1091,0,__PYX_ERR(0, 1091, __pyx_L1_error))
+  __Pyx_TraceLine(1133,0,__PYX_ERR(0, 1133, __pyx_L1_error))
   __pyx_v_aDelta = 0.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1094
+  /* "pyseobnr/eob/waveform/waveform.pyx":1136
  * 
- *     #(2,2) mode begins
- *     delta_coeffs_vh[2,2][3] = 7.0 / 3.0             # <<<<<<<<<<<<<<
+ *     # (2,2) mode begins
+ *     delta_coeffs_vh[2, 2][3] = 7.0 / 3.0             # <<<<<<<<<<<<<<
  *     # See https://dcc.ligo.org/T1600383
  * 
  */
-  __Pyx_TraceLine(1094,0,__PYX_ERR(0, 1094, __pyx_L1_error))
+  __Pyx_TraceLine(1136,0,__PYX_ERR(0, 1136, __pyx_L1_error))
   __pyx_t_1 = 2;
   __pyx_t_2 = 2;
   __pyx_t_3 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((7.0 / 3.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1097
+  /* "pyseobnr/eob/waveform/waveform.pyx":1139
  *     # See https://dcc.ligo.org/T1600383
  * 
- *     delta_coeffs_vh[2,2][6] = (             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[2, 2][6] = (             # <<<<<<<<<<<<<<
  *         -4.0 / 3.0 * (dm * chiA + chiS * (1 - 2 * nu)) + (428.0 * pi) / 105.0
  *     )
  */
-  __Pyx_TraceLine(1097,0,__PYX_ERR(0, 1097, __pyx_L1_error))
+  __Pyx_TraceLine(1139,0,__PYX_ERR(0, 1139, __pyx_L1_error))
   __pyx_t_3 = 2;
   __pyx_t_2 = 2;
   __pyx_t_1 = 6;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((((-4.0 / 3.0) * ((__pyx_v_dm * __pyx_v_chiA) + (__pyx_v_chiS * (1.0 - (2.0 * __pyx_v_nu))))) + ((428.0 * M_PI) / 105.0)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1101
+  /* "pyseobnr/eob/waveform/waveform.pyx":1143
  *     )
  * 
- *     delta_coeffs[2,2][8] = (20.0 * aDelta) / 63.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[2,2][9] = -2203.0 / 81.0 + (1712.0 * pi * pi) / 315.0
- *     delta_coeffs[2,2][5] = -24.0 * nu
+ *     delta_coeffs[2, 2][8] = (20.0 * aDelta) / 63.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[2, 2][9] = -2203.0 / 81.0 + (1712.0 * pi * pi) / 315.0
+ *     delta_coeffs[2, 2][5] = -24.0 * nu
  */
-  __Pyx_TraceLine(1101,0,__PYX_ERR(0, 1101, __pyx_L1_error))
+  __Pyx_TraceLine(1143,0,__PYX_ERR(0, 1143, __pyx_L1_error))
   __pyx_t_1 = 2;
   __pyx_t_2 = 2;
   __pyx_t_3 = 8;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs.data + __pyx_t_1 * __pyx_v_delta_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs.strides[2]) )) = __pyx_t_double_complex_from_parts(((20.0 * __pyx_v_aDelta) / 63.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1102
+  /* "pyseobnr/eob/waveform/waveform.pyx":1144
  * 
- *     delta_coeffs[2,2][8] = (20.0 * aDelta) / 63.0
- *     delta_coeffs_vh[2,2][9] = -2203.0 / 81.0 + (1712.0 * pi * pi) / 315.0             # <<<<<<<<<<<<<<
- *     delta_coeffs[2,2][5] = -24.0 * nu
- *     delta_coeffs[2,2][6] = 0.0
+ *     delta_coeffs[2, 2][8] = (20.0 * aDelta) / 63.0
+ *     delta_coeffs_vh[2, 2][9] = -2203.0 / 81.0 + (1712.0 * pi * pi) / 315.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs[2, 2][5] = -24.0 * nu
+ *     delta_coeffs[2, 2][6] = 0.0
  */
-  __Pyx_TraceLine(1102,0,__PYX_ERR(0, 1102, __pyx_L1_error))
+  __Pyx_TraceLine(1144,0,__PYX_ERR(0, 1144, __pyx_L1_error))
   __pyx_t_3 = 2;
   __pyx_t_2 = 2;
   __pyx_t_1 = 9;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((-2203.0 / 81.0) + (((1712.0 * M_PI) * M_PI) / 315.0)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1103
- *     delta_coeffs[2,2][8] = (20.0 * aDelta) / 63.0
- *     delta_coeffs_vh[2,2][9] = -2203.0 / 81.0 + (1712.0 * pi * pi) / 315.0
- *     delta_coeffs[2,2][5] = -24.0 * nu             # <<<<<<<<<<<<<<
- *     delta_coeffs[2,2][6] = 0.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":1145
+ *     delta_coeffs[2, 2][8] = (20.0 * aDelta) / 63.0
+ *     delta_coeffs_vh[2, 2][9] = -2203.0 / 81.0 + (1712.0 * pi * pi) / 315.0
+ *     delta_coeffs[2, 2][5] = -24.0 * nu             # <<<<<<<<<<<<<<
+ *     delta_coeffs[2, 2][6] = 0.0
  * 
  */
-  __Pyx_TraceLine(1103,0,__PYX_ERR(0, 1103, __pyx_L1_error))
+  __Pyx_TraceLine(1145,0,__PYX_ERR(0, 1145, __pyx_L1_error))
   __pyx_t_1 = 2;
   __pyx_t_2 = 2;
   __pyx_t_3 = 5;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs.data + __pyx_t_1 * __pyx_v_delta_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs.strides[2]) )) = __pyx_t_double_complex_from_parts((-24.0 * __pyx_v_nu), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1104
- *     delta_coeffs_vh[2,2][9] = -2203.0 / 81.0 + (1712.0 * pi * pi) / 315.0
- *     delta_coeffs[2,2][5] = -24.0 * nu
- *     delta_coeffs[2,2][6] = 0.0             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":1146
+ *     delta_coeffs_vh[2, 2][9] = -2203.0 / 81.0 + (1712.0 * pi * pi) / 315.0
+ *     delta_coeffs[2, 2][5] = -24.0 * nu
+ *     delta_coeffs[2, 2][6] = 0.0             # <<<<<<<<<<<<<<
  * 
  *     # (2,2) mode ends
  */
-  __Pyx_TraceLine(1104,0,__PYX_ERR(0, 1104, __pyx_L1_error))
+  __Pyx_TraceLine(1146,0,__PYX_ERR(0, 1146, __pyx_L1_error))
   __pyx_t_3 = 2;
   __pyx_t_2 = 2;
   __pyx_t_1 = 6;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs.data + __pyx_t_3 * __pyx_v_delta_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs.strides[2]) )) = __pyx_t_double_complex_from_parts(0.0, 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1110
+  /* "pyseobnr/eob/waveform/waveform.pyx":1152
  *     # (2,1) mode begins
  * 
- *     delta_coeffs_vh[2,1][3] = 2.0 / 3.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[2,1][6] = (-17.0 * aDelta) / 35.0 + (107.0 * pi) / 105.0
- *     delta_coeffs_vh[2,1][7] = (3.0 * aDelta * aDelta) / 140.0
+ *     delta_coeffs_vh[2, 1][3] = 2.0 / 3.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[2, 1][6] = (-17.0 * aDelta) / 35.0 + (107.0 * pi) / 105.0
+ *     delta_coeffs_vh[2, 1][7] = (3.0 * aDelta * aDelta) / 140.0
  */
-  __Pyx_TraceLine(1110,0,__PYX_ERR(0, 1110, __pyx_L1_error))
+  __Pyx_TraceLine(1152,0,__PYX_ERR(0, 1152, __pyx_L1_error))
   __pyx_t_1 = 2;
   __pyx_t_2 = 1;
   __pyx_t_3 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((2.0 / 3.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1111
+  /* "pyseobnr/eob/waveform/waveform.pyx":1153
  * 
- *     delta_coeffs_vh[2,1][3] = 2.0 / 3.0
- *     delta_coeffs_vh[2,1][6] = (-17.0 * aDelta) / 35.0 + (107.0 * pi) / 105.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[2,1][7] = (3.0 * aDelta * aDelta) / 140.0
- *     delta_coeffs_vh[2,1][9] = -272.0 / 81.0 + (214.0 * pi * pi) / 315.0
+ *     delta_coeffs_vh[2, 1][3] = 2.0 / 3.0
+ *     delta_coeffs_vh[2, 1][6] = (-17.0 * aDelta) / 35.0 + (107.0 * pi) / 105.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[2, 1][7] = (3.0 * aDelta * aDelta) / 140.0
+ *     delta_coeffs_vh[2, 1][9] = -272.0 / 81.0 + (214.0 * pi * pi) / 315.0
  */
-  __Pyx_TraceLine(1111,0,__PYX_ERR(0, 1111, __pyx_L1_error))
+  __Pyx_TraceLine(1153,0,__PYX_ERR(0, 1153, __pyx_L1_error))
   __pyx_t_3 = 2;
   __pyx_t_2 = 1;
   __pyx_t_1 = 6;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((((-17.0 * __pyx_v_aDelta) / 35.0) + ((107.0 * M_PI) / 105.0)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1112
- *     delta_coeffs_vh[2,1][3] = 2.0 / 3.0
- *     delta_coeffs_vh[2,1][6] = (-17.0 * aDelta) / 35.0 + (107.0 * pi) / 105.0
- *     delta_coeffs_vh[2,1][7] = (3.0 * aDelta * aDelta) / 140.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[2,1][9] = -272.0 / 81.0 + (214.0 * pi * pi) / 315.0
- *     """
+  /* "pyseobnr/eob/waveform/waveform.pyx":1154
+ *     delta_coeffs_vh[2, 1][3] = 2.0 / 3.0
+ *     delta_coeffs_vh[2, 1][6] = (-17.0 * aDelta) / 35.0 + (107.0 * pi) / 105.0
+ *     delta_coeffs_vh[2, 1][7] = (3.0 * aDelta * aDelta) / 140.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[2, 1][9] = -272.0 / 81.0 + (214.0 * pi * pi) / 315.0
+ * 
  */
-  __Pyx_TraceLine(1112,0,__PYX_ERR(0, 1112, __pyx_L1_error))
+  __Pyx_TraceLine(1154,0,__PYX_ERR(0, 1154, __pyx_L1_error))
   __pyx_t_1 = 2;
   __pyx_t_2 = 1;
   __pyx_t_3 = 7;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((((3.0 * __pyx_v_aDelta) * __pyx_v_aDelta) / 140.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1113
- *     delta_coeffs_vh[2,1][6] = (-17.0 * aDelta) / 35.0 + (107.0 * pi) / 105.0
- *     delta_coeffs_vh[2,1][7] = (3.0 * aDelta * aDelta) / 140.0
- *     delta_coeffs_vh[2,1][9] = -272.0 / 81.0 + (214.0 * pi * pi) / 315.0             # <<<<<<<<<<<<<<
- *     """
- *     This was in SEOBNRv4HM
+  /* "pyseobnr/eob/waveform/waveform.pyx":1155
+ *     delta_coeffs_vh[2, 1][6] = (-17.0 * aDelta) / 35.0 + (107.0 * pi) / 105.0
+ *     delta_coeffs_vh[2, 1][7] = (3.0 * aDelta * aDelta) / 140.0
+ *     delta_coeffs_vh[2, 1][9] = -272.0 / 81.0 + (214.0 * pi * pi) / 315.0             # <<<<<<<<<<<<<<
+ * 
+ *     # This was in SEOBNRv4HM
  */
-  __Pyx_TraceLine(1113,0,__PYX_ERR(0, 1113, __pyx_L1_error))
+  __Pyx_TraceLine(1155,0,__PYX_ERR(0, 1155, __pyx_L1_error))
   __pyx_t_3 = 2;
   __pyx_t_2 = 1;
   __pyx_t_1 = 9;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((-272.0 / 81.0) + (((214.0 * M_PI) * M_PI) / 315.0)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1118
- *     delta_coeffs[2,1][5] = -493.0 * nu / 42.0
- *     """
- *     delta_coeffs[2,1][5] = -25.0 * nu /2             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":1159
+ *     # This was in SEOBNRv4HM
+ *     # delta_coeffs[2,1][5] = -493.0 * nu / 42.0
+ *     delta_coeffs[2, 1][5] = -25.0 * nu /2             # <<<<<<<<<<<<<<
  * 
  *     # (2,1) mode ends
  */
-  __Pyx_TraceLine(1118,0,__PYX_ERR(0, 1118, __pyx_L1_error))
+  __Pyx_TraceLine(1159,0,__PYX_ERR(0, 1159, __pyx_L1_error))
   __pyx_t_1 = 2;
   __pyx_t_2 = 1;
   __pyx_t_3 = 5;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs.data + __pyx_t_1 * __pyx_v_delta_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs.strides[2]) )) = __pyx_t_double_complex_from_parts(((-25.0 * __pyx_v_nu) / 2.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1125
+  /* "pyseobnr/eob/waveform/waveform.pyx":1166
  *     # l = 3, Eqs. A9a - A9c for rho, Eqs. A15b and A15c for f,
  *     # Eqs. 22 - 24 of DIN and Eqs. 27c - 27e of PBFRT for delta
- *     delta_coeffs_vh[3,3][3] = 13.0 / 10.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[3,3][6] = (-81.0 * aDelta) / 20.0 + (39.0 * pi) / 7.0
- *     delta_coeffs_vh[3,3][9] = -227827.0 / 3000.0 + (78.0 * pi * pi) / 7.0
+ *     delta_coeffs_vh[3, 3][3] = 13.0 / 10.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[3, 3][6] = (-81.0 * aDelta) / 20.0 + (39.0 * pi) / 7.0
+ *     delta_coeffs_vh[3, 3][9] = -227827.0 / 3000.0 + (78.0 * pi * pi) / 7.0
  */
-  __Pyx_TraceLine(1125,0,__PYX_ERR(0, 1125, __pyx_L1_error))
+  __Pyx_TraceLine(1166,0,__PYX_ERR(0, 1166, __pyx_L1_error))
   __pyx_t_3 = 3;
   __pyx_t_2 = 3;
   __pyx_t_1 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((13.0 / 10.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1126
+  /* "pyseobnr/eob/waveform/waveform.pyx":1167
  *     # Eqs. 22 - 24 of DIN and Eqs. 27c - 27e of PBFRT for delta
- *     delta_coeffs_vh[3,3][3] = 13.0 / 10.0
- *     delta_coeffs_vh[3,3][6] = (-81.0 * aDelta) / 20.0 + (39.0 * pi) / 7.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[3,3][9] = -227827.0 / 3000.0 + (78.0 * pi * pi) / 7.0
- *     delta_coeffs[3,3][5] = -80897.0 * nu / 2430.0
+ *     delta_coeffs_vh[3, 3][3] = 13.0 / 10.0
+ *     delta_coeffs_vh[3, 3][6] = (-81.0 * aDelta) / 20.0 + (39.0 * pi) / 7.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[3, 3][9] = -227827.0 / 3000.0 + (78.0 * pi * pi) / 7.0
+ *     delta_coeffs[3, 3][5] = -80897.0 * nu / 2430.0
  */
-  __Pyx_TraceLine(1126,0,__PYX_ERR(0, 1126, __pyx_L1_error))
+  __Pyx_TraceLine(1167,0,__PYX_ERR(0, 1167, __pyx_L1_error))
   __pyx_t_1 = 3;
   __pyx_t_2 = 3;
   __pyx_t_3 = 6;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((((-81.0 * __pyx_v_aDelta) / 20.0) + ((39.0 * M_PI) / 7.0)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1127
- *     delta_coeffs_vh[3,3][3] = 13.0 / 10.0
- *     delta_coeffs_vh[3,3][6] = (-81.0 * aDelta) / 20.0 + (39.0 * pi) / 7.0
- *     delta_coeffs_vh[3,3][9] = -227827.0 / 3000.0 + (78.0 * pi * pi) / 7.0             # <<<<<<<<<<<<<<
- *     delta_coeffs[3,3][5] = -80897.0 * nu / 2430.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":1168
+ *     delta_coeffs_vh[3, 3][3] = 13.0 / 10.0
+ *     delta_coeffs_vh[3, 3][6] = (-81.0 * aDelta) / 20.0 + (39.0 * pi) / 7.0
+ *     delta_coeffs_vh[3, 3][9] = -227827.0 / 3000.0 + (78.0 * pi * pi) / 7.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs[3, 3][5] = -80897.0 * nu / 2430.0
  *     # (3,3) mode ends
  */
-  __Pyx_TraceLine(1127,0,__PYX_ERR(0, 1127, __pyx_L1_error))
+  __Pyx_TraceLine(1168,0,__PYX_ERR(0, 1168, __pyx_L1_error))
   __pyx_t_3 = 3;
   __pyx_t_2 = 3;
   __pyx_t_1 = 9;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((-227827.0 / 3000.0) + (((78.0 * M_PI) * M_PI) / 7.0)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1128
- *     delta_coeffs_vh[3,3][6] = (-81.0 * aDelta) / 20.0 + (39.0 * pi) / 7.0
- *     delta_coeffs_vh[3,3][9] = -227827.0 / 3000.0 + (78.0 * pi * pi) / 7.0
- *     delta_coeffs[3,3][5] = -80897.0 * nu / 2430.0             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":1169
+ *     delta_coeffs_vh[3, 3][6] = (-81.0 * aDelta) / 20.0 + (39.0 * pi) / 7.0
+ *     delta_coeffs_vh[3, 3][9] = -227827.0 / 3000.0 + (78.0 * pi * pi) / 7.0
+ *     delta_coeffs[3, 3][5] = -80897.0 * nu / 2430.0             # <<<<<<<<<<<<<<
  *     # (3,3) mode ends
  * 
  */
-  __Pyx_TraceLine(1128,0,__PYX_ERR(0, 1128, __pyx_L1_error))
+  __Pyx_TraceLine(1169,0,__PYX_ERR(0, 1169, __pyx_L1_error))
   __pyx_t_1 = 3;
   __pyx_t_2 = 3;
   __pyx_t_3 = 5;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs.data + __pyx_t_1 * __pyx_v_delta_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs.strides[2]) )) = __pyx_t_double_complex_from_parts(((-80897.0 * __pyx_v_nu) / 2430.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1132
+  /* "pyseobnr/eob/waveform/waveform.pyx":1173
  * 
  *     # (3,2) mode begins
- *     delta_coeffs_vh[3,2][3] = (10.0 + 33.0 * nu) / (-15.0 * m1Plus3nu)             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[3,2][4] = 4.0 * aDelta
- *     delta_coeffs_vh[3,2][6] = (-136.0 * aDelta) / 45.0 + (52.0 * pi) / 21.0
+ *     delta_coeffs_vh[3, 2][3] = (10.0 + 33.0 * nu) / (-15.0 * m1Plus3nu)             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[3, 2][4] = 4.0 * aDelta
+ *     delta_coeffs_vh[3, 2][6] = (-136.0 * aDelta) / 45.0 + (52.0 * pi) / 21.0
  */
-  __Pyx_TraceLine(1132,0,__PYX_ERR(0, 1132, __pyx_L1_error))
+  __Pyx_TraceLine(1173,0,__PYX_ERR(0, 1173, __pyx_L1_error))
   __pyx_t_3 = 3;
   __pyx_t_2 = 2;
   __pyx_t_1 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((10.0 + (33.0 * __pyx_v_nu)) / (-15.0 * __pyx_v_m1Plus3nu)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1133
+  /* "pyseobnr/eob/waveform/waveform.pyx":1174
  *     # (3,2) mode begins
- *     delta_coeffs_vh[3,2][3] = (10.0 + 33.0 * nu) / (-15.0 * m1Plus3nu)
- *     delta_coeffs_vh[3,2][4] = 4.0 * aDelta             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[3,2][6] = (-136.0 * aDelta) / 45.0 + (52.0 * pi) / 21.0
- *     delta_coeffs_vh[3,2][9] = -9112.0 / 405.0 + (208.0 * pi * pi) / 63.0
+ *     delta_coeffs_vh[3, 2][3] = (10.0 + 33.0 * nu) / (-15.0 * m1Plus3nu)
+ *     delta_coeffs_vh[3, 2][4] = 4.0 * aDelta             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[3, 2][6] = (-136.0 * aDelta) / 45.0 + (52.0 * pi) / 21.0
+ *     delta_coeffs_vh[3, 2][9] = -9112.0 / 405.0 + (208.0 * pi * pi) / 63.0
  */
-  __Pyx_TraceLine(1133,0,__PYX_ERR(0, 1133, __pyx_L1_error))
+  __Pyx_TraceLine(1174,0,__PYX_ERR(0, 1174, __pyx_L1_error))
   __pyx_t_1 = 3;
   __pyx_t_2 = 2;
   __pyx_t_3 = 4;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((4.0 * __pyx_v_aDelta), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1134
- *     delta_coeffs_vh[3,2][3] = (10.0 + 33.0 * nu) / (-15.0 * m1Plus3nu)
- *     delta_coeffs_vh[3,2][4] = 4.0 * aDelta
- *     delta_coeffs_vh[3,2][6] = (-136.0 * aDelta) / 45.0 + (52.0 * pi) / 21.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[3,2][9] = -9112.0 / 405.0 + (208.0 * pi * pi) / 63.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":1175
+ *     delta_coeffs_vh[3, 2][3] = (10.0 + 33.0 * nu) / (-15.0 * m1Plus3nu)
+ *     delta_coeffs_vh[3, 2][4] = 4.0 * aDelta
+ *     delta_coeffs_vh[3, 2][6] = (-136.0 * aDelta) / 45.0 + (52.0 * pi) / 21.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[3, 2][9] = -9112.0 / 405.0 + (208.0 * pi * pi) / 63.0
  *     # (3,2) mode ends
  */
-  __Pyx_TraceLine(1134,0,__PYX_ERR(0, 1134, __pyx_L1_error))
+  __Pyx_TraceLine(1175,0,__PYX_ERR(0, 1175, __pyx_L1_error))
   __pyx_t_3 = 3;
   __pyx_t_2 = 2;
   __pyx_t_1 = 6;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((((-136.0 * __pyx_v_aDelta) / 45.0) + ((52.0 * M_PI) / 21.0)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1135
- *     delta_coeffs_vh[3,2][4] = 4.0 * aDelta
- *     delta_coeffs_vh[3,2][6] = (-136.0 * aDelta) / 45.0 + (52.0 * pi) / 21.0
- *     delta_coeffs_vh[3,2][9] = -9112.0 / 405.0 + (208.0 * pi * pi) / 63.0             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":1176
+ *     delta_coeffs_vh[3, 2][4] = 4.0 * aDelta
+ *     delta_coeffs_vh[3, 2][6] = (-136.0 * aDelta) / 45.0 + (52.0 * pi) / 21.0
+ *     delta_coeffs_vh[3, 2][9] = -9112.0 / 405.0 + (208.0 * pi * pi) / 63.0             # <<<<<<<<<<<<<<
  *     # (3,2) mode ends
  * 
  */
-  __Pyx_TraceLine(1135,0,__PYX_ERR(0, 1135, __pyx_L1_error))
+  __Pyx_TraceLine(1176,0,__PYX_ERR(0, 1176, __pyx_L1_error))
   __pyx_t_1 = 3;
   __pyx_t_2 = 2;
   __pyx_t_3 = 9;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((-9112.0 / 405.0) + (((208.0 * M_PI) * M_PI) / 63.0)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1139
+  /* "pyseobnr/eob/waveform/waveform.pyx":1180
  * 
  *     # (3,1) mode begins
- *     delta_coeffs_vh[3,1][3] = 13.0 / 30.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[3,1][6] = (61.0 * aDelta) / 20.0 + (13.0 * pi) / 21.0
- *     delta_coeffs_vh[3,1][7] = (-24.0 * aDelta * aDelta) / 5.0
+ *     delta_coeffs_vh[3, 1][3] = 13.0 / 30.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[3, 1][6] = (61.0 * aDelta) / 20.0 + (13.0 * pi) / 21.0
+ *     delta_coeffs_vh[3, 1][7] = (-24.0 * aDelta * aDelta) / 5.0
  */
-  __Pyx_TraceLine(1139,0,__PYX_ERR(0, 1139, __pyx_L1_error))
+  __Pyx_TraceLine(1180,0,__PYX_ERR(0, 1180, __pyx_L1_error))
   __pyx_t_3 = 3;
   __pyx_t_2 = 1;
   __pyx_t_1 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((13.0 / 30.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1140
+  /* "pyseobnr/eob/waveform/waveform.pyx":1181
  *     # (3,1) mode begins
- *     delta_coeffs_vh[3,1][3] = 13.0 / 30.0
- *     delta_coeffs_vh[3,1][6] = (61.0 * aDelta) / 20.0 + (13.0 * pi) / 21.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[3,1][7] = (-24.0 * aDelta * aDelta) / 5.0
- *     delta_coeffs_vh[3,1][9] = -227827.0 / 81000.0 + (26.0 * pi * pi) / 63.0
+ *     delta_coeffs_vh[3, 1][3] = 13.0 / 30.0
+ *     delta_coeffs_vh[3, 1][6] = (61.0 * aDelta) / 20.0 + (13.0 * pi) / 21.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[3, 1][7] = (-24.0 * aDelta * aDelta) / 5.0
+ *     delta_coeffs_vh[3, 1][9] = -227827.0 / 81000.0 + (26.0 * pi * pi) / 63.0
  */
-  __Pyx_TraceLine(1140,0,__PYX_ERR(0, 1140, __pyx_L1_error))
+  __Pyx_TraceLine(1181,0,__PYX_ERR(0, 1181, __pyx_L1_error))
   __pyx_t_1 = 3;
   __pyx_t_2 = 1;
   __pyx_t_3 = 6;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((((61.0 * __pyx_v_aDelta) / 20.0) + ((13.0 * M_PI) / 21.0)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1141
- *     delta_coeffs_vh[3,1][3] = 13.0 / 30.0
- *     delta_coeffs_vh[3,1][6] = (61.0 * aDelta) / 20.0 + (13.0 * pi) / 21.0
- *     delta_coeffs_vh[3,1][7] = (-24.0 * aDelta * aDelta) / 5.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[3,1][9] = -227827.0 / 81000.0 + (26.0 * pi * pi) / 63.0
- *     delta_coeffs[3,1][5] = -17.0 * nu / 10.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":1182
+ *     delta_coeffs_vh[3, 1][3] = 13.0 / 30.0
+ *     delta_coeffs_vh[3, 1][6] = (61.0 * aDelta) / 20.0 + (13.0 * pi) / 21.0
+ *     delta_coeffs_vh[3, 1][7] = (-24.0 * aDelta * aDelta) / 5.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[3, 1][9] = -227827.0 / 81000.0 + (26.0 * pi * pi) / 63.0
+ *     delta_coeffs[3, 1][5] = -17.0 * nu / 10.0
  */
-  __Pyx_TraceLine(1141,0,__PYX_ERR(0, 1141, __pyx_L1_error))
+  __Pyx_TraceLine(1182,0,__PYX_ERR(0, 1182, __pyx_L1_error))
   __pyx_t_3 = 3;
   __pyx_t_2 = 1;
   __pyx_t_1 = 7;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((((-24.0 * __pyx_v_aDelta) * __pyx_v_aDelta) / 5.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1142
- *     delta_coeffs_vh[3,1][6] = (61.0 * aDelta) / 20.0 + (13.0 * pi) / 21.0
- *     delta_coeffs_vh[3,1][7] = (-24.0 * aDelta * aDelta) / 5.0
- *     delta_coeffs_vh[3,1][9] = -227827.0 / 81000.0 + (26.0 * pi * pi) / 63.0             # <<<<<<<<<<<<<<
- *     delta_coeffs[3,1][5] = -17.0 * nu / 10.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":1183
+ *     delta_coeffs_vh[3, 1][6] = (61.0 * aDelta) / 20.0 + (13.0 * pi) / 21.0
+ *     delta_coeffs_vh[3, 1][7] = (-24.0 * aDelta * aDelta) / 5.0
+ *     delta_coeffs_vh[3, 1][9] = -227827.0 / 81000.0 + (26.0 * pi * pi) / 63.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs[3, 1][5] = -17.0 * nu / 10.0
  *     # (3,1) mode ends
  */
-  __Pyx_TraceLine(1142,0,__PYX_ERR(0, 1142, __pyx_L1_error))
+  __Pyx_TraceLine(1183,0,__PYX_ERR(0, 1183, __pyx_L1_error))
   __pyx_t_1 = 3;
   __pyx_t_2 = 1;
   __pyx_t_3 = 9;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((-227827.0 / 81000.0) + (((26.0 * M_PI) * M_PI) / 63.0)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1143
- *     delta_coeffs_vh[3,1][7] = (-24.0 * aDelta * aDelta) / 5.0
- *     delta_coeffs_vh[3,1][9] = -227827.0 / 81000.0 + (26.0 * pi * pi) / 63.0
- *     delta_coeffs[3,1][5] = -17.0 * nu / 10.0             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":1184
+ *     delta_coeffs_vh[3, 1][7] = (-24.0 * aDelta * aDelta) / 5.0
+ *     delta_coeffs_vh[3, 1][9] = -227827.0 / 81000.0 + (26.0 * pi * pi) / 63.0
+ *     delta_coeffs[3, 1][5] = -17.0 * nu / 10.0             # <<<<<<<<<<<<<<
  *     # (3,1) mode ends
  * 
  */
-  __Pyx_TraceLine(1143,0,__PYX_ERR(0, 1143, __pyx_L1_error))
+  __Pyx_TraceLine(1184,0,__PYX_ERR(0, 1184, __pyx_L1_error))
   __pyx_t_3 = 3;
   __pyx_t_2 = 1;
   __pyx_t_1 = 5;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs.data + __pyx_t_3 * __pyx_v_delta_coeffs.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs.strides[2]) )) = __pyx_t_double_complex_from_parts(((-17.0 * __pyx_v_nu) / 10.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1147
+  /* "pyseobnr/eob/waveform/waveform.pyx":1188
  * 
  *     # (4,4) mode begins
- *     delta_coeffs_vh[4,4][3] = (112.0 + 219.0 * nu) / (-120.0 * m1Plus3nu)             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[4,4][6] = (-464.0 * aDelta) / 75.0 + (25136.0 * pi) / 3465.0
+ *     delta_coeffs_vh[4, 4][3] = (112.0 + 219.0 * nu) / (-120.0 * m1Plus3nu)             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[4, 4][6] = (-464.0 * aDelta) / 75.0 + (25136.0 * pi) / 3465.0
  * 
  */
-  __Pyx_TraceLine(1147,0,__PYX_ERR(0, 1147, __pyx_L1_error))
+  __Pyx_TraceLine(1188,0,__PYX_ERR(0, 1188, __pyx_L1_error))
   __pyx_t_1 = 4;
   __pyx_t_2 = 4;
   __pyx_t_3 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((112.0 + (219.0 * __pyx_v_nu)) / (-120.0 * __pyx_v_m1Plus3nu)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1148
+  /* "pyseobnr/eob/waveform/waveform.pyx":1189
  *     # (4,4) mode begins
- *     delta_coeffs_vh[4,4][3] = (112.0 + 219.0 * nu) / (-120.0 * m1Plus3nu)
- *     delta_coeffs_vh[4,4][6] = (-464.0 * aDelta) / 75.0 + (25136.0 * pi) / 3465.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[4, 4][3] = (112.0 + 219.0 * nu) / (-120.0 * m1Plus3nu)
+ *     delta_coeffs_vh[4, 4][6] = (-464.0 * aDelta) / 75.0 + (25136.0 * pi) / 3465.0             # <<<<<<<<<<<<<<
  * 
  *     # RC: This terms are in Eq.A15 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
  */
-  __Pyx_TraceLine(1148,0,__PYX_ERR(0, 1148, __pyx_L1_error))
+  __Pyx_TraceLine(1189,0,__PYX_ERR(0, 1189, __pyx_L1_error))
   __pyx_t_3 = 4;
   __pyx_t_2 = 4;
   __pyx_t_1 = 6;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((((-464.0 * __pyx_v_aDelta) / 75.0) + ((25136.0 * M_PI) / 3465.0)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1151
+  /* "pyseobnr/eob/waveform/waveform.pyx":1192
  * 
  *     # RC: This terms are in Eq.A15 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
- *     delta_coeffs_vh[4,4][9] = -55144.0 / 375.0 + 201088.0 * pi * pi / 10395.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[4, 4][9] = -55144.0 / 375.0 + 201088.0 * pi * pi / 10395.0             # <<<<<<<<<<<<<<
  * 
  *     # SO: what is going on with delta44v5: it's declared but never set in the LAL code!
  */
-  __Pyx_TraceLine(1151,0,__PYX_ERR(0, 1151, __pyx_L1_error))
+  __Pyx_TraceLine(1192,0,__PYX_ERR(0, 1192, __pyx_L1_error))
   __pyx_t_1 = 4;
   __pyx_t_2 = 4;
   __pyx_t_3 = 9;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((-55144.0 / 375.0) + (((201088.0 * M_PI) * M_PI) / 10395.0)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1158
+  /* "pyseobnr/eob/waveform/waveform.pyx":1199
  * 
  *     # (4,3) mode begins
- *     delta_coeffs_vh[4,3][3] = (486.0 + 4961.0 * nu) / (810.0 * (1.0 - 2.0 * nu))             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[4,3][4] = (11.0 * aDelta) / 4.0
- *     delta_coeffs_vh[4,3][6] = 1571.0 * pi / 385.0
+ *     delta_coeffs_vh[4, 3][3] = (486.0 + 4961.0 * nu) / (810.0 * (1.0 - 2.0 * nu))             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[4, 3][4] = (11.0 * aDelta) / 4.0
+ *     delta_coeffs_vh[4, 3][6] = 1571.0 * pi / 385.0
  */
-  __Pyx_TraceLine(1158,0,__PYX_ERR(0, 1158, __pyx_L1_error))
+  __Pyx_TraceLine(1199,0,__PYX_ERR(0, 1199, __pyx_L1_error))
   __pyx_t_3 = 4;
   __pyx_t_2 = 3;
   __pyx_t_1 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((486.0 + (4961.0 * __pyx_v_nu)) / (810.0 * (1.0 - (2.0 * __pyx_v_nu)))), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1159
+  /* "pyseobnr/eob/waveform/waveform.pyx":1200
  *     # (4,3) mode begins
- *     delta_coeffs_vh[4,3][3] = (486.0 + 4961.0 * nu) / (810.0 * (1.0 - 2.0 * nu))
- *     delta_coeffs_vh[4,3][4] = (11.0 * aDelta) / 4.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[4,3][6] = 1571.0 * pi / 385.0
+ *     delta_coeffs_vh[4, 3][3] = (486.0 + 4961.0 * nu) / (810.0 * (1.0 - 2.0 * nu))
+ *     delta_coeffs_vh[4, 3][4] = (11.0 * aDelta) / 4.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[4, 3][6] = 1571.0 * pi / 385.0
  *     # (4,3) mode ends
  */
-  __Pyx_TraceLine(1159,0,__PYX_ERR(0, 1159, __pyx_L1_error))
+  __Pyx_TraceLine(1200,0,__PYX_ERR(0, 1200, __pyx_L1_error))
   __pyx_t_1 = 4;
   __pyx_t_2 = 3;
   __pyx_t_3 = 4;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((11.0 * __pyx_v_aDelta) / 4.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1160
- *     delta_coeffs_vh[4,3][3] = (486.0 + 4961.0 * nu) / (810.0 * (1.0 - 2.0 * nu))
- *     delta_coeffs_vh[4,3][4] = (11.0 * aDelta) / 4.0
- *     delta_coeffs_vh[4,3][6] = 1571.0 * pi / 385.0             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":1201
+ *     delta_coeffs_vh[4, 3][3] = (486.0 + 4961.0 * nu) / (810.0 * (1.0 - 2.0 * nu))
+ *     delta_coeffs_vh[4, 3][4] = (11.0 * aDelta) / 4.0
+ *     delta_coeffs_vh[4, 3][6] = 1571.0 * pi / 385.0             # <<<<<<<<<<<<<<
  *     # (4,3) mode ends
  * 
  */
-  __Pyx_TraceLine(1160,0,__PYX_ERR(0, 1160, __pyx_L1_error))
+  __Pyx_TraceLine(1201,0,__PYX_ERR(0, 1201, __pyx_L1_error))
   __pyx_t_3 = 4;
   __pyx_t_2 = 3;
   __pyx_t_1 = 6;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((1571.0 * M_PI) / 385.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1164
+  /* "pyseobnr/eob/waveform/waveform.pyx":1205
  * 
  *     # (4,2) mode begins
- *     delta_coeffs_vh[4,2][3] = (7.0 * (1.0 + 6.0 * nu)) / (-15.0 * m1Plus3nu)             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[4,2][6] = (212.0 * aDelta) / 75.0 + (6284.0 * pi) / 3465.0
+ *     delta_coeffs_vh[4, 2][3] = (7.0 * (1.0 + 6.0 * nu)) / (-15.0 * m1Plus3nu)             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[4, 2][6] = (212.0 * aDelta) / 75.0 + (6284.0 * pi) / 3465.0
  *     # (4,2) mode ends
  */
-  __Pyx_TraceLine(1164,0,__PYX_ERR(0, 1164, __pyx_L1_error))
+  __Pyx_TraceLine(1205,0,__PYX_ERR(0, 1205, __pyx_L1_error))
   __pyx_t_1 = 4;
   __pyx_t_2 = 2;
   __pyx_t_3 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((7.0 * (1.0 + (6.0 * __pyx_v_nu))) / (-15.0 * __pyx_v_m1Plus3nu)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1165
+  /* "pyseobnr/eob/waveform/waveform.pyx":1206
  *     # (4,2) mode begins
- *     delta_coeffs_vh[4,2][3] = (7.0 * (1.0 + 6.0 * nu)) / (-15.0 * m1Plus3nu)
- *     delta_coeffs_vh[4,2][6] = (212.0 * aDelta) / 75.0 + (6284.0 * pi) / 3465.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[4, 2][3] = (7.0 * (1.0 + 6.0 * nu)) / (-15.0 * m1Plus3nu)
+ *     delta_coeffs_vh[4, 2][6] = (212.0 * aDelta) / 75.0 + (6284.0 * pi) / 3465.0             # <<<<<<<<<<<<<<
  *     # (4,2) mode ends
  * 
  */
-  __Pyx_TraceLine(1165,0,__PYX_ERR(0, 1165, __pyx_L1_error))
+  __Pyx_TraceLine(1206,0,__PYX_ERR(0, 1206, __pyx_L1_error))
   __pyx_t_3 = 4;
   __pyx_t_2 = 2;
   __pyx_t_1 = 6;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((((212.0 * __pyx_v_aDelta) / 75.0) + ((6284.0 * M_PI) / 3465.0)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1169
+  /* "pyseobnr/eob/waveform/waveform.pyx":1210
  * 
  *     # (4,1) mode begins
- *     delta_coeffs_vh[4,1][3] = (2.0 + 507.0 * nu) / (10.0 * (1.0 - 2.0 * nu))             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[4,1][4] = (11.0 * aDelta) / 12.0
- *     delta_coeffs_vh[4,1][6] = 1571.0 * pi / 3465.0
+ *     delta_coeffs_vh[4, 1][3] = (2.0 + 507.0 * nu) / (10.0 * (1.0 - 2.0 * nu))             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[4, 1][4] = (11.0 * aDelta) / 12.0
+ *     delta_coeffs_vh[4, 1][6] = 1571.0 * pi / 3465.0
  */
-  __Pyx_TraceLine(1169,0,__PYX_ERR(0, 1169, __pyx_L1_error))
+  __Pyx_TraceLine(1210,0,__PYX_ERR(0, 1210, __pyx_L1_error))
   __pyx_t_1 = 4;
   __pyx_t_2 = 1;
   __pyx_t_3 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((2.0 + (507.0 * __pyx_v_nu)) / (10.0 * (1.0 - (2.0 * __pyx_v_nu)))), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1170
+  /* "pyseobnr/eob/waveform/waveform.pyx":1211
  *     # (4,1) mode begins
- *     delta_coeffs_vh[4,1][3] = (2.0 + 507.0 * nu) / (10.0 * (1.0 - 2.0 * nu))
- *     delta_coeffs_vh[4,1][4] = (11.0 * aDelta) / 12.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[4,1][6] = 1571.0 * pi / 3465.0
+ *     delta_coeffs_vh[4, 1][3] = (2.0 + 507.0 * nu) / (10.0 * (1.0 - 2.0 * nu))
+ *     delta_coeffs_vh[4, 1][4] = (11.0 * aDelta) / 12.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[4, 1][6] = 1571.0 * pi / 3465.0
  *     # (4,1) mode ends
  */
-  __Pyx_TraceLine(1170,0,__PYX_ERR(0, 1170, __pyx_L1_error))
+  __Pyx_TraceLine(1211,0,__PYX_ERR(0, 1211, __pyx_L1_error))
   __pyx_t_3 = 4;
   __pyx_t_2 = 1;
   __pyx_t_1 = 4;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((11.0 * __pyx_v_aDelta) / 12.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1171
- *     delta_coeffs_vh[4,1][3] = (2.0 + 507.0 * nu) / (10.0 * (1.0 - 2.0 * nu))
- *     delta_coeffs_vh[4,1][4] = (11.0 * aDelta) / 12.0
- *     delta_coeffs_vh[4,1][6] = 1571.0 * pi / 3465.0             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":1212
+ *     delta_coeffs_vh[4, 1][3] = (2.0 + 507.0 * nu) / (10.0 * (1.0 - 2.0 * nu))
+ *     delta_coeffs_vh[4, 1][4] = (11.0 * aDelta) / 12.0
+ *     delta_coeffs_vh[4, 1][6] = 1571.0 * pi / 3465.0             # <<<<<<<<<<<<<<
  *     # (4,1) mode ends
  * 
  */
-  __Pyx_TraceLine(1171,0,__PYX_ERR(0, 1171, __pyx_L1_error))
+  __Pyx_TraceLine(1212,0,__PYX_ERR(0, 1212, __pyx_L1_error))
   __pyx_t_1 = 4;
   __pyx_t_2 = 1;
   __pyx_t_3 = 6;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((1571.0 * M_PI) / 3465.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1175
+  /* "pyseobnr/eob/waveform/waveform.pyx":1216
  * 
  *     # l=5 modes begin
- *     delta_coeffs_vh[5,5][3] = (96875.0 + 857528.0 * nu) / (131250.0 * (1 - 2 * nu))             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[5, 5][3] = (96875.0 + 857528.0 * nu) / (131250.0 * (1 - 2 * nu))             # <<<<<<<<<<<<<<
  * 
  *     # RC: This terms are in Eq.A16 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
  */
-  __Pyx_TraceLine(1175,0,__PYX_ERR(0, 1175, __pyx_L1_error))
+  __Pyx_TraceLine(1216,0,__PYX_ERR(0, 1216, __pyx_L1_error))
   __pyx_t_3 = 5;
   __pyx_t_2 = 5;
   __pyx_t_1 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((96875.0 + (857528.0 * __pyx_v_nu)) / (131250.0 * (1.0 - (2.0 * __pyx_v_nu)))), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1178
+  /* "pyseobnr/eob/waveform/waveform.pyx":1219
  * 
  *     # RC: This terms are in Eq.A16 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
- *     delta_coeffs_vh[5,5][6] = 3865.0 / 429.0 * pi             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[5,5][9] = (
+ *     delta_coeffs_vh[5, 5][6] = 3865.0 / 429.0 * pi             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[5, 5][9] = (
  *         -7686949127.0 + 954500400.0 * pi * pi
  */
-  __Pyx_TraceLine(1178,0,__PYX_ERR(0, 1178, __pyx_L1_error))
+  __Pyx_TraceLine(1219,0,__PYX_ERR(0, 1219, __pyx_L1_error))
   __pyx_t_1 = 5;
   __pyx_t_2 = 5;
   __pyx_t_3 = 6;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((3865.0 / 429.0) * M_PI), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1179
+  /* "pyseobnr/eob/waveform/waveform.pyx":1220
  *     # RC: This terms are in Eq.A16 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
- *     delta_coeffs_vh[5,5][6] = 3865.0 / 429.0 * pi
- *     delta_coeffs_vh[5,5][9] = (             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[5, 5][6] = 3865.0 / 429.0 * pi
+ *     delta_coeffs_vh[5, 5][9] = (             # <<<<<<<<<<<<<<
  *         -7686949127.0 + 954500400.0 * pi * pi
  *     ) / 31783752.0
  */
-  __Pyx_TraceLine(1179,0,__PYX_ERR(0, 1179, __pyx_L1_error))
+  __Pyx_TraceLine(1220,0,__PYX_ERR(0, 1220, __pyx_L1_error))
   __pyx_t_3 = 5;
   __pyx_t_2 = 5;
   __pyx_t_1 = 9;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((-7686949127.0 + ((954500400.0 * M_PI) * M_PI)) / 31783752.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1183
+  /* "pyseobnr/eob/waveform/waveform.pyx":1224
  *     ) / 31783752.0
  * 
- *     delta_coeffs_vh[5,4][3] = 8.0 / 15.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[5,4][4] = 12.0 * aDelta / 5.0
+ *     delta_coeffs_vh[5, 4][3] = 8.0 / 15.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[5, 4][4] = 12.0 * aDelta / 5.0
  * 
  */
-  __Pyx_TraceLine(1183,0,__PYX_ERR(0, 1183, __pyx_L1_error))
+  __Pyx_TraceLine(1224,0,__PYX_ERR(0, 1224, __pyx_L1_error))
   __pyx_t_1 = 5;
   __pyx_t_2 = 4;
   __pyx_t_3 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((8.0 / 15.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1184
+  /* "pyseobnr/eob/waveform/waveform.pyx":1225
  * 
- *     delta_coeffs_vh[5,4][3] = 8.0 / 15.0
- *     delta_coeffs_vh[5,4][4] = 12.0 * aDelta / 5.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[5, 4][3] = 8.0 / 15.0
+ *     delta_coeffs_vh[5, 4][4] = 12.0 * aDelta / 5.0             # <<<<<<<<<<<<<<
  * 
- *     delta_coeffs_vh[5,3][3] = 31.0 / 70.0
+ *     delta_coeffs_vh[5, 3][3] = 31.0 / 70.0
  */
-  __Pyx_TraceLine(1184,0,__PYX_ERR(0, 1184, __pyx_L1_error))
+  __Pyx_TraceLine(1225,0,__PYX_ERR(0, 1225, __pyx_L1_error))
   __pyx_t_3 = 5;
   __pyx_t_2 = 4;
   __pyx_t_1 = 4;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((12.0 * __pyx_v_aDelta) / 5.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1186
- *     delta_coeffs_vh[5,4][4] = 12.0 * aDelta / 5.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":1227
+ *     delta_coeffs_vh[5, 4][4] = 12.0 * aDelta / 5.0
  * 
- *     delta_coeffs_vh[5,3][3] = 31.0 / 70.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[5, 3][3] = 31.0 / 70.0             # <<<<<<<<<<<<<<
  * 
- *     delta_coeffs_vh[5,2][3] = 4.0 / 15.0
+ *     delta_coeffs_vh[5, 2][3] = 4.0 / 15.0
  */
-  __Pyx_TraceLine(1186,0,__PYX_ERR(0, 1186, __pyx_L1_error))
+  __Pyx_TraceLine(1227,0,__PYX_ERR(0, 1227, __pyx_L1_error))
   __pyx_t_1 = 5;
   __pyx_t_2 = 3;
   __pyx_t_3 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((31.0 / 70.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1188
- *     delta_coeffs_vh[5,3][3] = 31.0 / 70.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":1229
+ *     delta_coeffs_vh[5, 3][3] = 31.0 / 70.0
  * 
- *     delta_coeffs_vh[5,2][3] = 4.0 / 15.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[5,2][4] = 6.0 * aDelta / 5.0
+ *     delta_coeffs_vh[5, 2][3] = 4.0 / 15.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[5, 2][4] = 6.0 * aDelta / 5.0
  * 
  */
-  __Pyx_TraceLine(1188,0,__PYX_ERR(0, 1188, __pyx_L1_error))
+  __Pyx_TraceLine(1229,0,__PYX_ERR(0, 1229, __pyx_L1_error))
   __pyx_t_3 = 5;
   __pyx_t_2 = 2;
   __pyx_t_1 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((4.0 / 15.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1189
+  /* "pyseobnr/eob/waveform/waveform.pyx":1230
  * 
- *     delta_coeffs_vh[5,2][3] = 4.0 / 15.0
- *     delta_coeffs_vh[5,2][4] = 6.0 * aDelta / 5.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[5, 2][3] = 4.0 / 15.0
+ *     delta_coeffs_vh[5, 2][4] = 6.0 * aDelta / 5.0             # <<<<<<<<<<<<<<
  * 
- *     delta_coeffs_vh[5,1][3] = 31.0 / 210.0
+ *     delta_coeffs_vh[5, 1][3] = 31.0 / 210.0
  */
-  __Pyx_TraceLine(1189,0,__PYX_ERR(0, 1189, __pyx_L1_error))
+  __Pyx_TraceLine(1230,0,__PYX_ERR(0, 1230, __pyx_L1_error))
   __pyx_t_1 = 5;
   __pyx_t_2 = 2;
   __pyx_t_3 = 4;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts(((6.0 * __pyx_v_aDelta) / 5.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1191
- *     delta_coeffs_vh[5,2][4] = 6.0 * aDelta / 5.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":1232
+ *     delta_coeffs_vh[5, 2][4] = 6.0 * aDelta / 5.0
  * 
- *     delta_coeffs_vh[5,1][3] = 31.0 / 210.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[5, 1][3] = 31.0 / 210.0             # <<<<<<<<<<<<<<
  *     # ell = 5 modes end
  * 
  */
-  __Pyx_TraceLine(1191,0,__PYX_ERR(0, 1191, __pyx_L1_error))
+  __Pyx_TraceLine(1232,0,__PYX_ERR(0, 1232, __pyx_L1_error))
   __pyx_t_3 = 5;
   __pyx_t_2 = 1;
   __pyx_t_1 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((31.0 / 210.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1195
+  /* "pyseobnr/eob/waveform/waveform.pyx":1236
  * 
  *     # l=6 modes begin
- *     delta_coeffs_vh[6,6][3] = 43.0 / 70.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[6,5][3] = 10.0 / 21.0
- *     delta_coeffs_vh[6,4][3] = 43.0 / 105.0
+ *     delta_coeffs_vh[6, 6][3] = 43.0 / 70.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[6, 5][3] = 10.0 / 21.0
+ *     delta_coeffs_vh[6, 4][3] = 43.0 / 105.0
  */
-  __Pyx_TraceLine(1195,0,__PYX_ERR(0, 1195, __pyx_L1_error))
+  __Pyx_TraceLine(1236,0,__PYX_ERR(0, 1236, __pyx_L1_error))
   __pyx_t_1 = 6;
   __pyx_t_2 = 6;
   __pyx_t_3 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((43.0 / 70.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1196
+  /* "pyseobnr/eob/waveform/waveform.pyx":1237
  *     # l=6 modes begin
- *     delta_coeffs_vh[6,6][3] = 43.0 / 70.0
- *     delta_coeffs_vh[6,5][3] = 10.0 / 21.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[6,4][3] = 43.0 / 105.0
- *     delta_coeffs_vh[6,3][3] = 2.0 / 7.0
+ *     delta_coeffs_vh[6, 6][3] = 43.0 / 70.0
+ *     delta_coeffs_vh[6, 5][3] = 10.0 / 21.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[6, 4][3] = 43.0 / 105.0
+ *     delta_coeffs_vh[6, 3][3] = 2.0 / 7.0
  */
-  __Pyx_TraceLine(1196,0,__PYX_ERR(0, 1196, __pyx_L1_error))
+  __Pyx_TraceLine(1237,0,__PYX_ERR(0, 1237, __pyx_L1_error))
   __pyx_t_3 = 6;
   __pyx_t_2 = 5;
   __pyx_t_1 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((10.0 / 21.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1197
- *     delta_coeffs_vh[6,6][3] = 43.0 / 70.0
- *     delta_coeffs_vh[6,5][3] = 10.0 / 21.0
- *     delta_coeffs_vh[6,4][3] = 43.0 / 105.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[6,3][3] = 2.0 / 7.0
- *     delta_coeffs_vh[6,2][3] = 43.0 / 210.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":1238
+ *     delta_coeffs_vh[6, 6][3] = 43.0 / 70.0
+ *     delta_coeffs_vh[6, 5][3] = 10.0 / 21.0
+ *     delta_coeffs_vh[6, 4][3] = 43.0 / 105.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[6, 3][3] = 2.0 / 7.0
+ *     delta_coeffs_vh[6, 2][3] = 43.0 / 210.0
  */
-  __Pyx_TraceLine(1197,0,__PYX_ERR(0, 1197, __pyx_L1_error))
+  __Pyx_TraceLine(1238,0,__PYX_ERR(0, 1238, __pyx_L1_error))
   __pyx_t_1 = 6;
   __pyx_t_2 = 4;
   __pyx_t_3 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((43.0 / 105.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1198
- *     delta_coeffs_vh[6,5][3] = 10.0 / 21.0
- *     delta_coeffs_vh[6,4][3] = 43.0 / 105.0
- *     delta_coeffs_vh[6,3][3] = 2.0 / 7.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[6,2][3] = 43.0 / 210.0
- *     delta_coeffs_vh[6,1][3] = 2.0 / 21.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":1239
+ *     delta_coeffs_vh[6, 5][3] = 10.0 / 21.0
+ *     delta_coeffs_vh[6, 4][3] = 43.0 / 105.0
+ *     delta_coeffs_vh[6, 3][3] = 2.0 / 7.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[6, 2][3] = 43.0 / 210.0
+ *     delta_coeffs_vh[6, 1][3] = 2.0 / 21.0
  */
-  __Pyx_TraceLine(1198,0,__PYX_ERR(0, 1198, __pyx_L1_error))
+  __Pyx_TraceLine(1239,0,__PYX_ERR(0, 1239, __pyx_L1_error))
   __pyx_t_3 = 6;
   __pyx_t_2 = 3;
   __pyx_t_1 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((2.0 / 7.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1199
- *     delta_coeffs_vh[6,4][3] = 43.0 / 105.0
- *     delta_coeffs_vh[6,3][3] = 2.0 / 7.0
- *     delta_coeffs_vh[6,2][3] = 43.0 / 210.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[6,1][3] = 2.0 / 21.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":1240
+ *     delta_coeffs_vh[6, 4][3] = 43.0 / 105.0
+ *     delta_coeffs_vh[6, 3][3] = 2.0 / 7.0
+ *     delta_coeffs_vh[6, 2][3] = 43.0 / 210.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[6, 1][3] = 2.0 / 21.0
  *     # l=6 modes end
  */
-  __Pyx_TraceLine(1199,0,__PYX_ERR(0, 1199, __pyx_L1_error))
+  __Pyx_TraceLine(1240,0,__PYX_ERR(0, 1240, __pyx_L1_error))
   __pyx_t_1 = 6;
   __pyx_t_2 = 2;
   __pyx_t_3 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((43.0 / 210.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1200
- *     delta_coeffs_vh[6,3][3] = 2.0 / 7.0
- *     delta_coeffs_vh[6,2][3] = 43.0 / 210.0
- *     delta_coeffs_vh[6,1][3] = 2.0 / 21.0             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":1241
+ *     delta_coeffs_vh[6, 3][3] = 2.0 / 7.0
+ *     delta_coeffs_vh[6, 2][3] = 43.0 / 210.0
+ *     delta_coeffs_vh[6, 1][3] = 2.0 / 21.0             # <<<<<<<<<<<<<<
  *     # l=6 modes end
  * 
  */
-  __Pyx_TraceLine(1200,0,__PYX_ERR(0, 1200, __pyx_L1_error))
+  __Pyx_TraceLine(1241,0,__PYX_ERR(0, 1241, __pyx_L1_error))
   __pyx_t_3 = 6;
   __pyx_t_2 = 1;
   __pyx_t_1 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((2.0 / 21.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1204
+  /* "pyseobnr/eob/waveform/waveform.pyx":1245
  * 
  *     # l=7 modes begin
- *     delta_coeffs_vh[7,7][3] = 19.0 / 36.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[7,5][3] = 95.0 / 252.0
- *     delta_coeffs_vh[7,3][3] = 19.0 / 84.0
+ *     delta_coeffs_vh[7, 7][3] = 19.0 / 36.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[7, 5][3] = 95.0 / 252.0
+ *     delta_coeffs_vh[7, 3][3] = 19.0 / 84.0
  */
-  __Pyx_TraceLine(1204,0,__PYX_ERR(0, 1204, __pyx_L1_error))
+  __Pyx_TraceLine(1245,0,__PYX_ERR(0, 1245, __pyx_L1_error))
   __pyx_t_1 = 7;
   __pyx_t_2 = 7;
   __pyx_t_3 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((19.0 / 36.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1205
+  /* "pyseobnr/eob/waveform/waveform.pyx":1246
  *     # l=7 modes begin
- *     delta_coeffs_vh[7,7][3] = 19.0 / 36.0
- *     delta_coeffs_vh[7,5][3] = 95.0 / 252.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[7,3][3] = 19.0 / 84.0
- *     delta_coeffs_vh[7,1][3] = 19.0 / 252.0
+ *     delta_coeffs_vh[7, 7][3] = 19.0 / 36.0
+ *     delta_coeffs_vh[7, 5][3] = 95.0 / 252.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[7, 3][3] = 19.0 / 84.0
+ *     delta_coeffs_vh[7, 1][3] = 19.0 / 252.0
  */
-  __Pyx_TraceLine(1205,0,__PYX_ERR(0, 1205, __pyx_L1_error))
+  __Pyx_TraceLine(1246,0,__PYX_ERR(0, 1246, __pyx_L1_error))
   __pyx_t_3 = 7;
   __pyx_t_2 = 5;
   __pyx_t_1 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((95.0 / 252.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1206
- *     delta_coeffs_vh[7,7][3] = 19.0 / 36.0
- *     delta_coeffs_vh[7,5][3] = 95.0 / 252.0
- *     delta_coeffs_vh[7,3][3] = 19.0 / 84.0             # <<<<<<<<<<<<<<
- *     delta_coeffs_vh[7,1][3] = 19.0 / 252.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":1247
+ *     delta_coeffs_vh[7, 7][3] = 19.0 / 36.0
+ *     delta_coeffs_vh[7, 5][3] = 95.0 / 252.0
+ *     delta_coeffs_vh[7, 3][3] = 19.0 / 84.0             # <<<<<<<<<<<<<<
+ *     delta_coeffs_vh[7, 1][3] = 19.0 / 252.0
  *     # l=7 modes end
  */
-  __Pyx_TraceLine(1206,0,__PYX_ERR(0, 1206, __pyx_L1_error))
+  __Pyx_TraceLine(1247,0,__PYX_ERR(0, 1247, __pyx_L1_error))
   __pyx_t_1 = 7;
   __pyx_t_2 = 3;
   __pyx_t_3 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((19.0 / 84.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1207
- *     delta_coeffs_vh[7,5][3] = 95.0 / 252.0
- *     delta_coeffs_vh[7,3][3] = 19.0 / 84.0
- *     delta_coeffs_vh[7,1][3] = 19.0 / 252.0             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":1248
+ *     delta_coeffs_vh[7, 5][3] = 95.0 / 252.0
+ *     delta_coeffs_vh[7, 3][3] = 19.0 / 84.0
+ *     delta_coeffs_vh[7, 1][3] = 19.0 / 252.0             # <<<<<<<<<<<<<<
  *     # l=7 modes end
  * 
  */
-  __Pyx_TraceLine(1207,0,__PYX_ERR(0, 1207, __pyx_L1_error))
+  __Pyx_TraceLine(1248,0,__PYX_ERR(0, 1248, __pyx_L1_error))
   __pyx_t_3 = 7;
   __pyx_t_2 = 1;
   __pyx_t_1 = 3;
   *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_coeffs_vh.data + __pyx_t_3 * __pyx_v_delta_coeffs_vh.strides[0]) ) + __pyx_t_2 * __pyx_v_delta_coeffs_vh.strides[1]) ) + __pyx_t_1 * __pyx_v_delta_coeffs_vh.strides[2]) )) = __pyx_t_double_complex_from_parts((19.0 / 252.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1057
+  /* "pyseobnr/eob/waveform/waveform.pyx":1093
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef public void compute_delta_coeffs(double nu,double dm, double a,double chiS,double chiA,             # <<<<<<<<<<<<<<
- *     double complex[:,:,:] delta_coeffs, double complex[:,:,:] delta_coeffs_vh):
- * 
+ * cdef public void compute_delta_coeffs(             # <<<<<<<<<<<<<<
+ *     double nu,
+ *     double dm,
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.compute_delta_coeffs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":1217
+/* "pyseobnr/eob/waveform/waveform.pyx":1258
  * @cython.nonecheck(False)
  * @cython.initializedcheck(False)
- * cdef double complex compute_deltalm_single(double[] vs, double[] vhs,int l, int m, FluxParams fl):             # <<<<<<<<<<<<<<
- *     """
- *     Compute the  full :math:`\\delta_{\\ell m}` contribution for a given mode
+ * cdef double complex compute_deltalm_single(             # <<<<<<<<<<<<<<
+ *     double[] vs,
+ *     double[] vhs,
  */
 
 static __pyx_t_double_complex __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_deltalm_single(double *__pyx_v_vs, double *__pyx_v_vhs, int __pyx_v_l, int __pyx_v_m, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *__pyx_v_fl) {
   int __pyx_v_j;
   __pyx_t_double_complex __pyx_v_delta;
   __pyx_t_double_complex __pyx_r;
   int __pyx_t_1;
@@ -26866,80 +26860,80 @@
   Py_ssize_t __pyx_t_4;
   Py_ssize_t __pyx_t_5;
   Py_ssize_t __pyx_t_6;
   Py_ssize_t __pyx_t_7;
   Py_ssize_t __pyx_t_8;
   Py_ssize_t __pyx_t_9;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1222
+  /* "pyseobnr/eob/waveform/waveform.pyx":1269
  *     """
  *     cdef int j
  *     cdef double complex delta = 0.0             # <<<<<<<<<<<<<<
  *     for j in range(PN_limit):
- *         delta += fl.delta_coeffs[l,m,j]*vs[j] + fl.delta_coeffs_vh[l,m,j]*vhs[j]
+ *         delta += fl.delta_coeffs[l, m, j]*vs[j] + fl.delta_coeffs_vh[l, m, j]*vhs[j]
  */
   __pyx_v_delta = __pyx_t_double_complex_from_parts(0.0, 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1223
+  /* "pyseobnr/eob/waveform/waveform.pyx":1270
  *     cdef int j
  *     cdef double complex delta = 0.0
  *     for j in range(PN_limit):             # <<<<<<<<<<<<<<
- *         delta += fl.delta_coeffs[l,m,j]*vs[j] + fl.delta_coeffs_vh[l,m,j]*vhs[j]
+ *         delta += fl.delta_coeffs[l, m, j]*vs[j] + fl.delta_coeffs_vh[l, m, j]*vhs[j]
  *     return delta
  */
   __pyx_t_1 = PN_limit;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_j = __pyx_t_3;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1224
+    /* "pyseobnr/eob/waveform/waveform.pyx":1271
  *     cdef double complex delta = 0.0
  *     for j in range(PN_limit):
- *         delta += fl.delta_coeffs[l,m,j]*vs[j] + fl.delta_coeffs_vh[l,m,j]*vhs[j]             # <<<<<<<<<<<<<<
+ *         delta += fl.delta_coeffs[l, m, j]*vs[j] + fl.delta_coeffs_vh[l, m, j]*vhs[j]             # <<<<<<<<<<<<<<
  *     return delta
  * 
  */
     __pyx_t_4 = __pyx_v_l;
     __pyx_t_5 = __pyx_v_m;
     __pyx_t_6 = __pyx_v_j;
     __pyx_t_7 = __pyx_v_l;
     __pyx_t_8 = __pyx_v_m;
     __pyx_t_9 = __pyx_v_j;
     __pyx_v_delta = __Pyx_c_sum_double(__pyx_v_delta, __Pyx_c_sum_double(__Pyx_c_prod_double((*((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_fl->delta_coeffs.data + __pyx_t_4 * __pyx_v_fl->delta_coeffs.strides[0]) ) + __pyx_t_5 * __pyx_v_fl->delta_coeffs.strides[1]) ) + __pyx_t_6 * __pyx_v_fl->delta_coeffs.strides[2]) ))), __pyx_t_double_complex_from_parts((__pyx_v_vs[__pyx_v_j]), 0)), __Pyx_c_prod_double((*((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_fl->delta_coeffs_vh.data + __pyx_t_7 * __pyx_v_fl->delta_coeffs_vh.strides[0]) ) + __pyx_t_8 * __pyx_v_fl->delta_coeffs_vh.strides[1]) ) + __pyx_t_9 * __pyx_v_fl->delta_coeffs_vh.strides[2]) ))), __pyx_t_double_complex_from_parts((__pyx_v_vhs[__pyx_v_j]), 0))));
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1225
+  /* "pyseobnr/eob/waveform/waveform.pyx":1272
  *     for j in range(PN_limit):
- *         delta += fl.delta_coeffs[l,m,j]*vs[j] + fl.delta_coeffs_vh[l,m,j]*vhs[j]
+ *         delta += fl.delta_coeffs[l, m, j]*vs[j] + fl.delta_coeffs_vh[l, m, j]*vhs[j]
  *     return delta             # <<<<<<<<<<<<<<
  * 
- * @cython.cpow(True)
+ * 
  */
   __pyx_r = __pyx_v_delta;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1217
+  /* "pyseobnr/eob/waveform/waveform.pyx":1258
  * @cython.nonecheck(False)
  * @cython.initializedcheck(False)
- * cdef double complex compute_deltalm_single(double[] vs, double[] vhs,int l, int m, FluxParams fl):             # <<<<<<<<<<<<<<
- *     """
- *     Compute the  full :math:`\\delta_{\\ell m}` contribution for a given mode
+ * cdef double complex compute_deltalm_single(             # <<<<<<<<<<<<<<
+ *     double[] vs,
+ *     double[] vhs,
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":1235
+/* "pyseobnr/eob/waveform/waveform.pyx":1283
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef void compute_delta(double v,double vh,double nu, EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     """
- *     Compute the  full :math:`\\delta_{\\ell m}` contribution for all modes
+ * cdef void compute_delta(             # <<<<<<<<<<<<<<
+ *     double v,
+ *     double vh,
  */
 
 static void __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_delta(double __pyx_v_v, double __pyx_v_vh, CYTHON_UNUSED double __pyx_v_nu, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_eob_pars) {
   int __pyx_v_i;
   int __pyx_v_l;
   int __pyx_v_m;
   double __pyx_v_vs[PN_limit];
@@ -26959,137 +26953,137 @@
   __pyx_t_double_complex __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("compute_delta", 1);
-  __Pyx_TraceCall("compute_delta", __pyx_f[0], 1235, 0, __PYX_ERR(0, 1235, __pyx_L1_error));
+  __Pyx_TraceCall("compute_delta", __pyx_f[0], 1283, 0, __PYX_ERR(0, 1283, __pyx_L1_error));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1242
+  /* "pyseobnr/eob/waveform/waveform.pyx":1295
  *     cdef double vs[PN_limit]
  *     cdef double vhs[PN_limit]
- *     cdef double complex delta  = 0.0             # <<<<<<<<<<<<<<
+ *     cdef double complex delta = 0.0             # <<<<<<<<<<<<<<
  *     for i in range(PN_limit):
  *         vs[i] = v**i
  */
-  __Pyx_TraceLine(1242,0,__PYX_ERR(0, 1242, __pyx_L1_error))
+  __Pyx_TraceLine(1295,0,__PYX_ERR(0, 1295, __pyx_L1_error))
   __pyx_v_delta = __pyx_t_double_complex_from_parts(0.0, 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1243
+  /* "pyseobnr/eob/waveform/waveform.pyx":1296
  *     cdef double vhs[PN_limit]
- *     cdef double complex delta  = 0.0
+ *     cdef double complex delta = 0.0
  *     for i in range(PN_limit):             # <<<<<<<<<<<<<<
  *         vs[i] = v**i
  *         vhs[i] = vh**i
  */
-  __Pyx_TraceLine(1243,0,__PYX_ERR(0, 1243, __pyx_L1_error))
+  __Pyx_TraceLine(1296,0,__PYX_ERR(0, 1296, __pyx_L1_error))
   __pyx_t_1 = PN_limit;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1244
- *     cdef double complex delta  = 0.0
+    /* "pyseobnr/eob/waveform/waveform.pyx":1297
+ *     cdef double complex delta = 0.0
  *     for i in range(PN_limit):
  *         vs[i] = v**i             # <<<<<<<<<<<<<<
  *         vhs[i] = vh**i
  *     cdef FluxParams fl = eob_pars.flux_params
  */
-    __Pyx_TraceLine(1244,0,__PYX_ERR(0, 1244, __pyx_L1_error))
+    __Pyx_TraceLine(1297,0,__PYX_ERR(0, 1297, __pyx_L1_error))
     (__pyx_v_vs[__pyx_v_i]) = pow(__pyx_v_v, ((double)__pyx_v_i));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1245
+    /* "pyseobnr/eob/waveform/waveform.pyx":1298
  *     for i in range(PN_limit):
  *         vs[i] = v**i
  *         vhs[i] = vh**i             # <<<<<<<<<<<<<<
  *     cdef FluxParams fl = eob_pars.flux_params
- *     for l in range(2,ell_max+1):
+ *     for l in range(2, ell_max+1):
  */
-    __Pyx_TraceLine(1245,0,__PYX_ERR(0, 1245, __pyx_L1_error))
+    __Pyx_TraceLine(1298,0,__PYX_ERR(0, 1298, __pyx_L1_error))
     (__pyx_v_vhs[__pyx_v_i]) = pow(__pyx_v_vh, ((double)__pyx_v_i));
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1246
+  /* "pyseobnr/eob/waveform/waveform.pyx":1299
  *         vs[i] = v**i
  *         vhs[i] = vh**i
  *     cdef FluxParams fl = eob_pars.flux_params             # <<<<<<<<<<<<<<
- *     for l in range(2,ell_max+1):
- *         for m in range(1,l+1):
+ *     for l in range(2, ell_max+1):
+ *         for m in range(1, l+1):
  */
-  __Pyx_TraceLine(1246,0,__PYX_ERR(0, 1246, __pyx_L1_error))
+  __Pyx_TraceLine(1299,0,__PYX_ERR(0, 1299, __pyx_L1_error))
   __pyx_t_4 = ((PyObject *)__pyx_v_eob_pars->flux_params);
   __Pyx_INCREF(__pyx_t_4);
   __pyx_v_fl = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1247
+  /* "pyseobnr/eob/waveform/waveform.pyx":1300
  *         vhs[i] = vh**i
  *     cdef FluxParams fl = eob_pars.flux_params
- *     for l in range(2,ell_max+1):             # <<<<<<<<<<<<<<
- *         for m in range(1,l+1):
- *             fl.deltalm[l,m] = compute_deltalm_single(vs,vhs,l,m,fl)
+ *     for l in range(2, ell_max+1):             # <<<<<<<<<<<<<<
+ *         for m in range(1, l+1):
+ *             fl.deltalm[l, m] = compute_deltalm_single(vs, vhs, l, m, fl)
  */
-  __Pyx_TraceLine(1247,0,__PYX_ERR(0, 1247, __pyx_L1_error))
+  __Pyx_TraceLine(1300,0,__PYX_ERR(0, 1300, __pyx_L1_error))
   __pyx_t_5 = (ell_max + 1);
   __pyx_t_6 = __pyx_t_5;
   for (__pyx_t_1 = 2; __pyx_t_1 < __pyx_t_6; __pyx_t_1+=1) {
     __pyx_v_l = __pyx_t_1;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1248
+    /* "pyseobnr/eob/waveform/waveform.pyx":1301
  *     cdef FluxParams fl = eob_pars.flux_params
- *     for l in range(2,ell_max+1):
- *         for m in range(1,l+1):             # <<<<<<<<<<<<<<
- *             fl.deltalm[l,m] = compute_deltalm_single(vs,vhs,l,m,fl)
+ *     for l in range(2, ell_max+1):
+ *         for m in range(1, l+1):             # <<<<<<<<<<<<<<
+ *             fl.deltalm[l, m] = compute_deltalm_single(vs, vhs, l, m, fl)
  * 
  */
-    __Pyx_TraceLine(1248,0,__PYX_ERR(0, 1248, __pyx_L1_error))
+    __Pyx_TraceLine(1301,0,__PYX_ERR(0, 1301, __pyx_L1_error))
     __pyx_t_7 = (__pyx_v_l + 1);
     __pyx_t_8 = __pyx_t_7;
     for (__pyx_t_2 = 1; __pyx_t_2 < __pyx_t_8; __pyx_t_2+=1) {
       __pyx_v_m = __pyx_t_2;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1249
- *     for l in range(2,ell_max+1):
- *         for m in range(1,l+1):
- *             fl.deltalm[l,m] = compute_deltalm_single(vs,vhs,l,m,fl)             # <<<<<<<<<<<<<<
+      /* "pyseobnr/eob/waveform/waveform.pyx":1302
+ *     for l in range(2, ell_max+1):
+ *         for m in range(1, l+1):
+ *             fl.deltalm[l, m] = compute_deltalm_single(vs, vhs, l, m, fl)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-      __Pyx_TraceLine(1249,0,__PYX_ERR(0, 1249, __pyx_L1_error))
-      __pyx_t_9 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_deltalm_single(__pyx_v_vs, __pyx_v_vhs, __pyx_v_l, __pyx_v_m, __pyx_v_fl); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1249, __pyx_L1_error)
+      __Pyx_TraceLine(1302,0,__PYX_ERR(0, 1302, __pyx_L1_error))
+      __pyx_t_9 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_deltalm_single(__pyx_v_vs, __pyx_v_vhs, __pyx_v_l, __pyx_v_m, __pyx_v_fl); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1302, __pyx_L1_error)
       __pyx_t_10 = __pyx_v_l;
       __pyx_t_11 = __pyx_v_m;
       *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_fl->deltalm.data + __pyx_t_10 * __pyx_v_fl->deltalm.strides[0]) ) + __pyx_t_11 * __pyx_v_fl->deltalm.strides[1]) )) = __pyx_t_9;
     }
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1235
+  /* "pyseobnr/eob/waveform/waveform.pyx":1283
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef void compute_delta(double v,double vh,double nu, EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     """
- *     Compute the  full :math:`\\delta_{\\ell m}` contribution for all modes
+ * cdef void compute_delta(             # <<<<<<<<<<<<<<
+ *     double v,
+ *     double vh,
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.compute_delta", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_fl);
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":1259
+/* "pyseobnr/eob/waveform/waveform.pyx":1311
  * @cython.nonecheck(False)
  * @cython.initializedcheck(False)
- * cpdef double complex compute_extra_flm_terms(int l,int m,double vh,EOBParams eob_pars):             # <<<<<<<<<<<<<<
+ * cpdef double complex compute_extra_flm_terms(int l, int m, double vh, EOBParams eob_pars):             # <<<<<<<<<<<<<<
  *     """
  *     Compute the complex term in :math:`f_{33}`.
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_11compute_extra_flm_terms(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
@@ -27103,85 +27097,85 @@
   __pyx_t_double_complex __pyx_r;
   int __pyx_t_1;
   int __pyx_t_2;
   Py_ssize_t __pyx_t_3;
   Py_ssize_t __pyx_t_4;
   Py_ssize_t __pyx_t_5;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1265
+  /* "pyseobnr/eob/waveform/waveform.pyx":1317
  *     See last term in Eq(A10) of [Cotesta2022]_
  *     """
  *     cdef double vh3 = vh**3             # <<<<<<<<<<<<<<
  *     cdef double complex extra_term = 0.0
  *     if l==3 and m==3:
  */
   __pyx_v_vh3 = pow(__pyx_v_vh, 3.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1266
+  /* "pyseobnr/eob/waveform/waveform.pyx":1318
  *     """
  *     cdef double vh3 = vh**3
  *     cdef double complex extra_term = 0.0             # <<<<<<<<<<<<<<
  *     if l==3 and m==3:
- *         extra_term = I*vh3 * vh3 * eob_pars.flux_params.f_coeffs_vh[3,3][6]
+ *         extra_term = I*vh3 * vh3 * eob_pars.flux_params.f_coeffs_vh[3, 3][6]
  */
   __pyx_v_extra_term = __pyx_t_double_complex_from_parts(0.0, 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1267
+  /* "pyseobnr/eob/waveform/waveform.pyx":1319
  *     cdef double vh3 = vh**3
  *     cdef double complex extra_term = 0.0
  *     if l==3 and m==3:             # <<<<<<<<<<<<<<
- *         extra_term = I*vh3 * vh3 * eob_pars.flux_params.f_coeffs_vh[3,3][6]
+ *         extra_term = I*vh3 * vh3 * eob_pars.flux_params.f_coeffs_vh[3, 3][6]
  *     return extra_term
  */
   __pyx_t_2 = (__pyx_v_l == 3);
   if (__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L4_bool_binop_done;
   }
   __pyx_t_2 = (__pyx_v_m == 3);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1268
+    /* "pyseobnr/eob/waveform/waveform.pyx":1320
  *     cdef double complex extra_term = 0.0
  *     if l==3 and m==3:
- *         extra_term = I*vh3 * vh3 * eob_pars.flux_params.f_coeffs_vh[3,3][6]             # <<<<<<<<<<<<<<
+ *         extra_term = I*vh3 * vh3 * eob_pars.flux_params.f_coeffs_vh[3, 3][6]             # <<<<<<<<<<<<<<
  *     return extra_term
  * 
  */
     __pyx_t_3 = 3;
     __pyx_t_4 = 3;
     __pyx_t_5 = 6;
     __pyx_v_extra_term = __Pyx_c_prod_double(__Pyx_c_prod_double(__Pyx_c_prod_double(I, __pyx_t_double_complex_from_parts(__pyx_v_vh3, 0)), __pyx_t_double_complex_from_parts(__pyx_v_vh3, 0)), (*((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eob_pars->flux_params->f_coeffs_vh.data + __pyx_t_3 * __pyx_v_eob_pars->flux_params->f_coeffs_vh.strides[0]) ) + __pyx_t_4 * __pyx_v_eob_pars->flux_params->f_coeffs_vh.strides[1]) ) + __pyx_t_5 * __pyx_v_eob_pars->flux_params->f_coeffs_vh.strides[2]) ))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1267
+    /* "pyseobnr/eob/waveform/waveform.pyx":1319
  *     cdef double vh3 = vh**3
  *     cdef double complex extra_term = 0.0
  *     if l==3 and m==3:             # <<<<<<<<<<<<<<
- *         extra_term = I*vh3 * vh3 * eob_pars.flux_params.f_coeffs_vh[3,3][6]
+ *         extra_term = I*vh3 * vh3 * eob_pars.flux_params.f_coeffs_vh[3, 3][6]
  *     return extra_term
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1269
+  /* "pyseobnr/eob/waveform/waveform.pyx":1321
  *     if l==3 and m==3:
- *         extra_term = I*vh3 * vh3 * eob_pars.flux_params.f_coeffs_vh[3,3][6]
+ *         extra_term = I*vh3 * vh3 * eob_pars.flux_params.f_coeffs_vh[3, 3][6]
  *     return extra_term             # <<<<<<<<<<<<<<
  * 
- * @cython.cpow(True)
+ * 
  */
   __pyx_r = __pyx_v_extra_term;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1259
+  /* "pyseobnr/eob/waveform/waveform.pyx":1311
  * @cython.nonecheck(False)
  * @cython.initializedcheck(False)
- * cpdef double complex compute_extra_flm_terms(int l,int m,double vh,EOBParams eob_pars):             # <<<<<<<<<<<<<<
+ * cpdef double complex compute_extra_flm_terms(int l, int m, double vh, EOBParams eob_pars):             # <<<<<<<<<<<<<<
  *     """
  *     Compute the complex term in :math:`f_{33}`.
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
@@ -27246,81 +27240,81 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_l)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1259, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1311, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_m)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1259, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1311, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_extra_flm_terms", 1, 4, 4, 1); __PYX_ERR(0, 1259, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_extra_flm_terms", 1, 4, 4, 1); __PYX_ERR(0, 1311, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vh)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1259, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1311, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_extra_flm_terms", 1, 4, 4, 2); __PYX_ERR(0, 1259, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_extra_flm_terms", 1, 4, 4, 2); __PYX_ERR(0, 1311, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_eob_pars)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1259, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1311, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_extra_flm_terms", 1, 4, 4, 3); __PYX_ERR(0, 1259, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_extra_flm_terms", 1, 4, 4, 3); __PYX_ERR(0, 1311, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_extra_flm_terms") < 0)) __PYX_ERR(0, 1259, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_extra_flm_terms") < 0)) __PYX_ERR(0, 1311, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 4)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
       values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
     }
-    __pyx_v_l = __Pyx_PyInt_As_int(values[0]); if (unlikely((__pyx_v_l == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1259, __pyx_L3_error)
-    __pyx_v_m = __Pyx_PyInt_As_int(values[1]); if (unlikely((__pyx_v_m == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1259, __pyx_L3_error)
-    __pyx_v_vh = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_vh == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1259, __pyx_L3_error)
+    __pyx_v_l = __Pyx_PyInt_As_int(values[0]); if (unlikely((__pyx_v_l == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1311, __pyx_L3_error)
+    __pyx_v_m = __Pyx_PyInt_As_int(values[1]); if (unlikely((__pyx_v_m == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1311, __pyx_L3_error)
+    __pyx_v_vh = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_vh == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1311, __pyx_L3_error)
     __pyx_v_eob_pars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)values[3]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("compute_extra_flm_terms", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 1259, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("compute_extra_flm_terms", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 1311, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.compute_extra_flm_terms", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_eob_pars), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "eob_pars", 0))) __PYX_ERR(0, 1259, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_eob_pars), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "eob_pars", 0))) __PYX_ERR(0, 1311, __pyx_L1_error)
   __pyx_r = __pyx_pf_8pyseobnr_3eob_8waveform_8waveform_10compute_extra_flm_terms(__pyx_self, __pyx_v_l, __pyx_v_m, __pyx_v_vh, __pyx_v_eob_pars);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -27340,16 +27334,16 @@
   __pyx_t_double_complex __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("compute_extra_flm_terms", 1);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_extra_flm_terms(__pyx_v_l, __pyx_v_m, __pyx_v_vh, __pyx_v_eob_pars, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1259, __pyx_L1_error)
-  __pyx_t_2 = __pyx_PyComplex_FromComplex(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1259, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_extra_flm_terms(__pyx_v_l, __pyx_v_m, __pyx_v_vh, __pyx_v_eob_pars, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1311, __pyx_L1_error)
+  __pyx_t_2 = __pyx_PyComplex_FromComplex(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1311, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -27358,20 +27352,20 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":1277
+/* "pyseobnr/eob/waveform/waveform.pyx":1330
  * @cython.nonecheck(False)
  * @cython.initializedcheck(False)
- * cdef double complex compute_rholm_single(double[] vs,double vh, int l, int m, EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     """
- *     Compute the full :math:`\\rho_{\\ell m}` contribution for a given mode
+ * cdef double complex compute_rholm_single(             # <<<<<<<<<<<<<<
+ *     double[] vs,
+ *     double vh,
  */
 
 static __pyx_t_double_complex __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rholm_single(double *__pyx_v_vs, double __pyx_v_vh, int __pyx_v_l, int __pyx_v_m, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_eob_pars) {
   int __pyx_v_j;
   double __pyx_v_v;
   double __pyx_v_nu;
   __pyx_t_double_complex __pyx_v_rho_final;
@@ -27401,334 +27395,398 @@
   Py_ssize_t __pyx_t_17;
   int __pyx_t_18;
   __pyx_t_double_complex __pyx_t_19;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1282
+  /* "pyseobnr/eob/waveform/waveform.pyx":1341
  *     """
  *     cdef int j
  *     cdef double v = vs[1]             # <<<<<<<<<<<<<<
  *     cdef double nu = eob_pars.p_params.nu
- *     cdef double complex rho_final  = 0.0
+ *     cdef double complex rho_final = 0.0
  */
   __pyx_v_v = (__pyx_v_vs[1]);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1283
+  /* "pyseobnr/eob/waveform/waveform.pyx":1342
  *     cdef int j
  *     cdef double v = vs[1]
  *     cdef double nu = eob_pars.p_params.nu             # <<<<<<<<<<<<<<
- *     cdef double complex rho_final  = 0.0
- *     cdef double rho  = 1.0
+ *     cdef double complex rho_final = 0.0
+ *     cdef double rho = 1.0
  */
   __pyx_t_1 = __pyx_v_eob_pars->p_params->nu;
   __pyx_v_nu = __pyx_t_1;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1284
+  /* "pyseobnr/eob/waveform/waveform.pyx":1343
  *     cdef double v = vs[1]
  *     cdef double nu = eob_pars.p_params.nu
- *     cdef double complex rho_final  = 0.0             # <<<<<<<<<<<<<<
- *     cdef double rho  = 1.0
+ *     cdef double complex rho_final = 0.0             # <<<<<<<<<<<<<<
+ *     cdef double rho = 1.0
  * 
  */
   __pyx_v_rho_final = __pyx_t_double_complex_from_parts(0.0, 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1285
+  /* "pyseobnr/eob/waveform/waveform.pyx":1344
  *     cdef double nu = eob_pars.p_params.nu
- *     cdef double complex rho_final  = 0.0
- *     cdef double rho  = 1.0             # <<<<<<<<<<<<<<
+ *     cdef double complex rho_final = 0.0
+ *     cdef double rho = 1.0             # <<<<<<<<<<<<<<
  * 
  *     cdef double rho_log = 0.0
  */
   __pyx_v_rho = 1.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1287
- *     cdef double rho  = 1.0
+  /* "pyseobnr/eob/waveform/waveform.pyx":1346
+ *     cdef double rho = 1.0
  * 
  *     cdef double rho_log = 0.0             # <<<<<<<<<<<<<<
  *     cdef double f = 0.0
  *     cdef double complex f_final = 0.0
  */
   __pyx_v_rho_log = 0.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1288
+  /* "pyseobnr/eob/waveform/waveform.pyx":1347
  * 
  *     cdef double rho_log = 0.0
  *     cdef double f = 0.0             # <<<<<<<<<<<<<<
  *     cdef double complex f_final = 0.0
- *     cdef double eulerlogxabs =  euler_gamma + log(2.0 * m * v)
+ *     cdef double eulerlogxabs = euler_gamma + log(2.0 * m * v)
  */
   __pyx_v_f = 0.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1289
+  /* "pyseobnr/eob/waveform/waveform.pyx":1348
  *     cdef double rho_log = 0.0
  *     cdef double f = 0.0
  *     cdef double complex f_final = 0.0             # <<<<<<<<<<<<<<
- *     cdef double eulerlogxabs =  euler_gamma + log(2.0 * m * v)
+ *     cdef double eulerlogxabs = euler_gamma + log(2.0 * m * v)
  *     cdef double complex extra_flm_term
  */
   __pyx_v_f_final = __pyx_t_double_complex_from_parts(0.0, 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1290
+  /* "pyseobnr/eob/waveform/waveform.pyx":1349
  *     cdef double f = 0.0
  *     cdef double complex f_final = 0.0
- *     cdef double eulerlogxabs =  euler_gamma + log(2.0 * m * v)             # <<<<<<<<<<<<<<
+ *     cdef double eulerlogxabs = euler_gamma + log(2.0 * m * v)             # <<<<<<<<<<<<<<
  *     cdef double complex extra_flm_term
  *     # This is just computing rho_coeffs \dot v
  */
   __pyx_v_eulerlogxabs = (0.5772156649015329 + log(((2.0 * __pyx_v_m) * __pyx_v_v)));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1294
+  /* "pyseobnr/eob/waveform/waveform.pyx":1353
  *     # This is just computing rho_coeffs \dot v
  * 
- *     if m%2:             # <<<<<<<<<<<<<<
+ *     if m % 2:             # <<<<<<<<<<<<<<
  *         # For odd m modes we need to compute f
- *         for j in range(1,PN_limit):
+ *         for j in range(1, PN_limit):
  */
   __pyx_t_2 = ((__pyx_v_m % 2) != 0);
   if (__pyx_t_2) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1296
- *     if m%2:
+    /* "pyseobnr/eob/waveform/waveform.pyx":1355
+ *     if m % 2:
  *         # For odd m modes we need to compute f
- *         for j in range(1,PN_limit):             # <<<<<<<<<<<<<<
- *             rho+= (eob_pars.flux_params.rho_coeffs[l,m,j]+eob_pars.flux_params.extra_coeffs[l,m,j]+ (eob_pars.flux_params.rho_coeffs_log[l,m,j]+eob_pars.flux_params.extra_coeffs_log[l,m,j])*eulerlogxabs)*vs[j]
- *             f += eob_pars.flux_params.f_coeffs[l,m,j]*vs[j]
+ *         for j in range(1, PN_limit):             # <<<<<<<<<<<<<<
+ *             rho+= (
+ *                 eob_pars.flux_params.rho_coeffs[l, m, j]
  */
     __pyx_t_3 = PN_limit;
     __pyx_t_4 = __pyx_t_3;
     for (__pyx_t_5 = 1; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
       __pyx_v_j = __pyx_t_5;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1297
- *         # For odd m modes we need to compute f
- *         for j in range(1,PN_limit):
- *             rho+= (eob_pars.flux_params.rho_coeffs[l,m,j]+eob_pars.flux_params.extra_coeffs[l,m,j]+ (eob_pars.flux_params.rho_coeffs_log[l,m,j]+eob_pars.flux_params.extra_coeffs_log[l,m,j])*eulerlogxabs)*vs[j]             # <<<<<<<<<<<<<<
- *             f += eob_pars.flux_params.f_coeffs[l,m,j]*vs[j]
- *     else:
+      /* "pyseobnr/eob/waveform/waveform.pyx":1357
+ *         for j in range(1, PN_limit):
+ *             rho+= (
+ *                 eob_pars.flux_params.rho_coeffs[l, m, j]             # <<<<<<<<<<<<<<
+ *                 + eob_pars.flux_params.extra_coeffs[l, m, j]
+ *                 + (eob_pars.flux_params.rho_coeffs_log[l, m, j]
  */
       __pyx_t_6 = __pyx_v_l;
       __pyx_t_7 = __pyx_v_m;
       __pyx_t_8 = __pyx_v_j;
+
+      /* "pyseobnr/eob/waveform/waveform.pyx":1358
+ *             rho+= (
+ *                 eob_pars.flux_params.rho_coeffs[l, m, j]
+ *                 + eob_pars.flux_params.extra_coeffs[l, m, j]             # <<<<<<<<<<<<<<
+ *                 + (eob_pars.flux_params.rho_coeffs_log[l, m, j]
+ *                    + eob_pars.flux_params.extra_coeffs_log[l, m, j]
+ */
       __pyx_t_9 = __pyx_v_l;
       __pyx_t_10 = __pyx_v_m;
       __pyx_t_11 = __pyx_v_j;
+
+      /* "pyseobnr/eob/waveform/waveform.pyx":1359
+ *                 eob_pars.flux_params.rho_coeffs[l, m, j]
+ *                 + eob_pars.flux_params.extra_coeffs[l, m, j]
+ *                 + (eob_pars.flux_params.rho_coeffs_log[l, m, j]             # <<<<<<<<<<<<<<
+ *                    + eob_pars.flux_params.extra_coeffs_log[l, m, j]
+ *                    )*eulerlogxabs
+ */
       __pyx_t_12 = __pyx_v_l;
       __pyx_t_13 = __pyx_v_m;
       __pyx_t_14 = __pyx_v_j;
+
+      /* "pyseobnr/eob/waveform/waveform.pyx":1360
+ *                 + eob_pars.flux_params.extra_coeffs[l, m, j]
+ *                 + (eob_pars.flux_params.rho_coeffs_log[l, m, j]
+ *                    + eob_pars.flux_params.extra_coeffs_log[l, m, j]             # <<<<<<<<<<<<<<
+ *                    )*eulerlogxabs
+ *                 )*vs[j]
+ */
       __pyx_t_15 = __pyx_v_l;
       __pyx_t_16 = __pyx_v_m;
       __pyx_t_17 = __pyx_v_j;
+
+      /* "pyseobnr/eob/waveform/waveform.pyx":1356
+ *         # For odd m modes we need to compute f
+ *         for j in range(1, PN_limit):
+ *             rho+= (             # <<<<<<<<<<<<<<
+ *                 eob_pars.flux_params.rho_coeffs[l, m, j]
+ *                 + eob_pars.flux_params.extra_coeffs[l, m, j]
+ */
       __pyx_v_rho = (__pyx_v_rho + ((((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eob_pars->flux_params->rho_coeffs.data + __pyx_t_6 * __pyx_v_eob_pars->flux_params->rho_coeffs.strides[0]) ) + __pyx_t_7 * __pyx_v_eob_pars->flux_params->rho_coeffs.strides[1]) ) + __pyx_t_8 * __pyx_v_eob_pars->flux_params->rho_coeffs.strides[2]) ))) + (*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eob_pars->flux_params->extra_coeffs.data + __pyx_t_9 * __pyx_v_eob_pars->flux_params->extra_coeffs.strides[0]) ) + __pyx_t_10 * __pyx_v_eob_pars->flux_params->extra_coeffs.strides[1]) ) + __pyx_t_11 * __pyx_v_eob_pars->flux_params->extra_coeffs.strides[2]) )))) + (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eob_pars->flux_params->rho_coeffs_log.data + __pyx_t_12 * __pyx_v_eob_pars->flux_params->rho_coeffs_log.strides[0]) ) + __pyx_t_13 * __pyx_v_eob_pars->flux_params->rho_coeffs_log.strides[1]) ) + __pyx_t_14 * __pyx_v_eob_pars->flux_params->rho_coeffs_log.strides[2]) ))) + (*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eob_pars->flux_params->extra_coeffs_log.data + __pyx_t_15 * __pyx_v_eob_pars->flux_params->extra_coeffs_log.strides[0]) ) + __pyx_t_16 * __pyx_v_eob_pars->flux_params->extra_coeffs_log.strides[1]) ) + __pyx_t_17 * __pyx_v_eob_pars->flux_params->extra_coeffs_log.strides[2]) )))) * __pyx_v_eulerlogxabs)) * (__pyx_v_vs[__pyx_v_j])));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1298
- *         for j in range(1,PN_limit):
- *             rho+= (eob_pars.flux_params.rho_coeffs[l,m,j]+eob_pars.flux_params.extra_coeffs[l,m,j]+ (eob_pars.flux_params.rho_coeffs_log[l,m,j]+eob_pars.flux_params.extra_coeffs_log[l,m,j])*eulerlogxabs)*vs[j]
- *             f += eob_pars.flux_params.f_coeffs[l,m,j]*vs[j]             # <<<<<<<<<<<<<<
+      /* "pyseobnr/eob/waveform/waveform.pyx":1363
+ *                    )*eulerlogxabs
+ *                 )*vs[j]
+ *             f += eob_pars.flux_params.f_coeffs[l, m, j]*vs[j]             # <<<<<<<<<<<<<<
  *     else:
  *         # For even m modes we only need rho
  */
       __pyx_t_17 = __pyx_v_l;
       __pyx_t_16 = __pyx_v_m;
       __pyx_t_15 = __pyx_v_j;
       __pyx_v_f = (__pyx_v_f + ((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eob_pars->flux_params->f_coeffs.data + __pyx_t_17 * __pyx_v_eob_pars->flux_params->f_coeffs.strides[0]) ) + __pyx_t_16 * __pyx_v_eob_pars->flux_params->f_coeffs.strides[1]) ) + __pyx_t_15 * __pyx_v_eob_pars->flux_params->f_coeffs.strides[2]) ))) * (__pyx_v_vs[__pyx_v_j])));
     }
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1294
+    /* "pyseobnr/eob/waveform/waveform.pyx":1353
  *     # This is just computing rho_coeffs \dot v
  * 
- *     if m%2:             # <<<<<<<<<<<<<<
+ *     if m % 2:             # <<<<<<<<<<<<<<
  *         # For odd m modes we need to compute f
- *         for j in range(1,PN_limit):
+ *         for j in range(1, PN_limit):
  */
     goto __pyx_L3;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1301
+  /* "pyseobnr/eob/waveform/waveform.pyx":1366
  *     else:
  *         # For even m modes we only need rho
- *         for j in range(1,PN_limit):             # <<<<<<<<<<<<<<
- *             rho+= (eob_pars.flux_params.rho_coeffs[l,m,j]+eob_pars.flux_params.extra_coeffs[l,m,j]+(eob_pars.flux_params.rho_coeffs_log[l,m,j]+eob_pars.flux_params.extra_coeffs_log[l,m,j])*eulerlogxabs)*vs[j]
- * 
+ *         for j in range(1, PN_limit):             # <<<<<<<<<<<<<<
+ *             rho+= (eob_pars.flux_params.rho_coeffs[l, m, j]
+ *                    + eob_pars.flux_params.extra_coeffs[l, m, j]
  */
   /*else*/ {
     __pyx_t_3 = PN_limit;
     __pyx_t_4 = __pyx_t_3;
     for (__pyx_t_5 = 1; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
       __pyx_v_j = __pyx_t_5;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1302
+      /* "pyseobnr/eob/waveform/waveform.pyx":1367
  *         # For even m modes we only need rho
- *         for j in range(1,PN_limit):
- *             rho+= (eob_pars.flux_params.rho_coeffs[l,m,j]+eob_pars.flux_params.extra_coeffs[l,m,j]+(eob_pars.flux_params.rho_coeffs_log[l,m,j]+eob_pars.flux_params.extra_coeffs_log[l,m,j])*eulerlogxabs)*vs[j]             # <<<<<<<<<<<<<<
- * 
- *     # Deal with the complex amplitude term
+ *         for j in range(1, PN_limit):
+ *             rho+= (eob_pars.flux_params.rho_coeffs[l, m, j]             # <<<<<<<<<<<<<<
+ *                    + eob_pars.flux_params.extra_coeffs[l, m, j]
+ *                    + (eob_pars.flux_params.rho_coeffs_log[l, m, j]
  */
       __pyx_t_15 = __pyx_v_l;
       __pyx_t_16 = __pyx_v_m;
       __pyx_t_17 = __pyx_v_j;
+
+      /* "pyseobnr/eob/waveform/waveform.pyx":1368
+ *         for j in range(1, PN_limit):
+ *             rho+= (eob_pars.flux_params.rho_coeffs[l, m, j]
+ *                    + eob_pars.flux_params.extra_coeffs[l, m, j]             # <<<<<<<<<<<<<<
+ *                    + (eob_pars.flux_params.rho_coeffs_log[l, m, j]
+ *                       + eob_pars.flux_params.extra_coeffs_log[l, m, j]
+ */
       __pyx_t_14 = __pyx_v_l;
       __pyx_t_13 = __pyx_v_m;
       __pyx_t_12 = __pyx_v_j;
+
+      /* "pyseobnr/eob/waveform/waveform.pyx":1369
+ *             rho+= (eob_pars.flux_params.rho_coeffs[l, m, j]
+ *                    + eob_pars.flux_params.extra_coeffs[l, m, j]
+ *                    + (eob_pars.flux_params.rho_coeffs_log[l, m, j]             # <<<<<<<<<<<<<<
+ *                       + eob_pars.flux_params.extra_coeffs_log[l, m, j]
+ *                       )*eulerlogxabs
+ */
       __pyx_t_11 = __pyx_v_l;
       __pyx_t_10 = __pyx_v_m;
       __pyx_t_9 = __pyx_v_j;
+
+      /* "pyseobnr/eob/waveform/waveform.pyx":1370
+ *                    + eob_pars.flux_params.extra_coeffs[l, m, j]
+ *                    + (eob_pars.flux_params.rho_coeffs_log[l, m, j]
+ *                       + eob_pars.flux_params.extra_coeffs_log[l, m, j]             # <<<<<<<<<<<<<<
+ *                       )*eulerlogxabs
+ *                    )*vs[j]
+ */
       __pyx_t_8 = __pyx_v_l;
       __pyx_t_7 = __pyx_v_m;
       __pyx_t_6 = __pyx_v_j;
+
+      /* "pyseobnr/eob/waveform/waveform.pyx":1367
+ *         # For even m modes we only need rho
+ *         for j in range(1, PN_limit):
+ *             rho+= (eob_pars.flux_params.rho_coeffs[l, m, j]             # <<<<<<<<<<<<<<
+ *                    + eob_pars.flux_params.extra_coeffs[l, m, j]
+ *                    + (eob_pars.flux_params.rho_coeffs_log[l, m, j]
+ */
       __pyx_v_rho = (__pyx_v_rho + ((((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eob_pars->flux_params->rho_coeffs.data + __pyx_t_15 * __pyx_v_eob_pars->flux_params->rho_coeffs.strides[0]) ) + __pyx_t_16 * __pyx_v_eob_pars->flux_params->rho_coeffs.strides[1]) ) + __pyx_t_17 * __pyx_v_eob_pars->flux_params->rho_coeffs.strides[2]) ))) + (*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eob_pars->flux_params->extra_coeffs.data + __pyx_t_14 * __pyx_v_eob_pars->flux_params->extra_coeffs.strides[0]) ) + __pyx_t_13 * __pyx_v_eob_pars->flux_params->extra_coeffs.strides[1]) ) + __pyx_t_12 * __pyx_v_eob_pars->flux_params->extra_coeffs.strides[2]) )))) + (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eob_pars->flux_params->rho_coeffs_log.data + __pyx_t_11 * __pyx_v_eob_pars->flux_params->rho_coeffs_log.strides[0]) ) + __pyx_t_10 * __pyx_v_eob_pars->flux_params->rho_coeffs_log.strides[1]) ) + __pyx_t_9 * __pyx_v_eob_pars->flux_params->rho_coeffs_log.strides[2]) ))) + (*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eob_pars->flux_params->extra_coeffs_log.data + __pyx_t_8 * __pyx_v_eob_pars->flux_params->extra_coeffs_log.strides[0]) ) + __pyx_t_7 * __pyx_v_eob_pars->flux_params->extra_coeffs_log.strides[1]) ) + __pyx_t_6 * __pyx_v_eob_pars->flux_params->extra_coeffs_log.strides[2]) )))) * __pyx_v_eulerlogxabs)) * (__pyx_v_vs[__pyx_v_j])));
     }
   }
   __pyx_L3:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1305
+  /* "pyseobnr/eob/waveform/waveform.pyx":1375
  * 
  *     # Deal with the complex amplitude term
  *     f_final = f             # <<<<<<<<<<<<<<
  *     if l==3 and m==3:
- *         extra_flm_term = compute_extra_flm_terms(l,m,vh,eob_pars)
+ *         extra_flm_term = compute_extra_flm_terms(l, m, vh, eob_pars)
  */
   __pyx_v_f_final = __pyx_t_double_complex_from_parts(__pyx_v_f, 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1306
+  /* "pyseobnr/eob/waveform/waveform.pyx":1376
  *     # Deal with the complex amplitude term
  *     f_final = f
  *     if l==3 and m==3:             # <<<<<<<<<<<<<<
- *         extra_flm_term = compute_extra_flm_terms(l,m,vh,eob_pars)
+ *         extra_flm_term = compute_extra_flm_terms(l, m, vh, eob_pars)
  *         f_final += extra_flm_term
  */
   __pyx_t_18 = (__pyx_v_l == 3);
   if (__pyx_t_18) {
   } else {
     __pyx_t_2 = __pyx_t_18;
     goto __pyx_L9_bool_binop_done;
   }
   __pyx_t_18 = (__pyx_v_m == 3);
   __pyx_t_2 = __pyx_t_18;
   __pyx_L9_bool_binop_done:;
   if (__pyx_t_2) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1307
+    /* "pyseobnr/eob/waveform/waveform.pyx":1377
  *     f_final = f
  *     if l==3 and m==3:
- *         extra_flm_term = compute_extra_flm_terms(l,m,vh,eob_pars)             # <<<<<<<<<<<<<<
+ *         extra_flm_term = compute_extra_flm_terms(l, m, vh, eob_pars)             # <<<<<<<<<<<<<<
  *         f_final += extra_flm_term
  * 
  */
-    __pyx_t_19 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_extra_flm_terms(__pyx_v_l, __pyx_v_m, __pyx_v_vh, __pyx_v_eob_pars, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1307, __pyx_L1_error)
+    __pyx_t_19 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_extra_flm_terms(__pyx_v_l, __pyx_v_m, __pyx_v_vh, __pyx_v_eob_pars, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1377, __pyx_L1_error)
     __pyx_v_extra_flm_term = __pyx_t_19;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1308
+    /* "pyseobnr/eob/waveform/waveform.pyx":1378
  *     if l==3 and m==3:
- *         extra_flm_term = compute_extra_flm_terms(l,m,vh,eob_pars)
+ *         extra_flm_term = compute_extra_flm_terms(l, m, vh, eob_pars)
  *         f_final += extra_flm_term             # <<<<<<<<<<<<<<
  * 
- * 
+ *     rho_final = rho**l
  */
     __pyx_v_f_final = __Pyx_c_sum_double(__pyx_v_f_final, __pyx_v_extra_flm_term);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1306
+    /* "pyseobnr/eob/waveform/waveform.pyx":1376
  *     # Deal with the complex amplitude term
  *     f_final = f
  *     if l==3 and m==3:             # <<<<<<<<<<<<<<
- *         extra_flm_term = compute_extra_flm_terms(l,m,vh,eob_pars)
+ *         extra_flm_term = compute_extra_flm_terms(l, m, vh, eob_pars)
  *         f_final += extra_flm_term
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1311
- * 
+  /* "pyseobnr/eob/waveform/waveform.pyx":1380
+ *         f_final += extra_flm_term
  * 
  *     rho_final = rho**l             # <<<<<<<<<<<<<<
- *     if fabs(nu-0.25)<1e-14 and m%2:
+ *     if fabs(nu-0.25)<1e-14 and m % 2:
  *         rho_final = f_final
  */
   __pyx_v_rho_final = __pyx_t_double_complex_from_parts(pow(__pyx_v_rho, ((double)__pyx_v_l)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1312
+  /* "pyseobnr/eob/waveform/waveform.pyx":1381
  * 
  *     rho_final = rho**l
- *     if fabs(nu-0.25)<1e-14 and m%2:             # <<<<<<<<<<<<<<
+ *     if fabs(nu-0.25)<1e-14 and m % 2:             # <<<<<<<<<<<<<<
  *         rho_final = f_final
  *     else:
  */
   __pyx_t_18 = (fabs((__pyx_v_nu - 0.25)) < 1e-14);
   if (__pyx_t_18) {
   } else {
     __pyx_t_2 = __pyx_t_18;
     goto __pyx_L12_bool_binop_done;
   }
   __pyx_t_18 = ((__pyx_v_m % 2) != 0);
   __pyx_t_2 = __pyx_t_18;
   __pyx_L12_bool_binop_done:;
   if (__pyx_t_2) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1313
+    /* "pyseobnr/eob/waveform/waveform.pyx":1382
  *     rho_final = rho**l
- *     if fabs(nu-0.25)<1e-14 and m%2:
+ *     if fabs(nu-0.25)<1e-14 and m % 2:
  *         rho_final = f_final             # <<<<<<<<<<<<<<
  *     else:
  *         rho_final += f_final
  */
     __pyx_v_rho_final = __pyx_v_f_final;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1312
+    /* "pyseobnr/eob/waveform/waveform.pyx":1381
  * 
  *     rho_final = rho**l
- *     if fabs(nu-0.25)<1e-14 and m%2:             # <<<<<<<<<<<<<<
+ *     if fabs(nu-0.25)<1e-14 and m % 2:             # <<<<<<<<<<<<<<
  *         rho_final = f_final
  *     else:
  */
     goto __pyx_L11;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1315
+  /* "pyseobnr/eob/waveform/waveform.pyx":1384
  *         rho_final = f_final
  *     else:
  *         rho_final += f_final             # <<<<<<<<<<<<<<
  *     return rho_final
  * 
  */
   /*else*/ {
     __pyx_v_rho_final = __Pyx_c_sum_double(__pyx_v_rho_final, __pyx_v_f_final);
   }
   __pyx_L11:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1316
+  /* "pyseobnr/eob/waveform/waveform.pyx":1385
  *     else:
  *         rho_final += f_final
  *     return rho_final             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = __pyx_v_rho_final;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1277
+  /* "pyseobnr/eob/waveform/waveform.pyx":1330
  * @cython.nonecheck(False)
  * @cython.initializedcheck(False)
- * cdef double complex compute_rholm_single(double[] vs,double vh, int l, int m, EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     """
- *     Compute the full :math:`\\rho_{\\ell m}` contribution for a given mode
+ * cdef double complex compute_rholm_single(             # <<<<<<<<<<<<<<
+ *     double[] vs,
+ *     double vh,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.compute_rholm_single", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = __pyx_t_double_complex_from_parts(0, 0);
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":1350
+/* "pyseobnr/eob/waveform/waveform.pyx":1418
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef void compute_rholm(double v,double vh,double nu, EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     cdef int i,l,m
+ * cdef void compute_rholm(double v, double vh, double nu, EOBParams eob_pars):             # <<<<<<<<<<<<<<
+ *     cdef int i, l, m
  *     cdef double vs[PN_limit]
  */
 
 static void __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rholm(double __pyx_v_v, double __pyx_v_vh, CYTHON_UNUSED double __pyx_v_nu, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_eob_pars) {
   int __pyx_v_i;
   int __pyx_v_l;
   int __pyx_v_m;
@@ -27743,123 +27801,123 @@
   long __pyx_t_7;
   __pyx_t_double_complex __pyx_t_8;
   Py_ssize_t __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceCall("compute_rholm", __pyx_f[0], 1350, 0, __PYX_ERR(0, 1350, __pyx_L1_error));
+  __Pyx_TraceCall("compute_rholm", __pyx_f[0], 1418, 0, __PYX_ERR(0, 1418, __pyx_L1_error));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1353
- *     cdef int i,l,m
+  /* "pyseobnr/eob/waveform/waveform.pyx":1422
  *     cdef double vs[PN_limit]
+ * 
  *     vs[0] = 0             # <<<<<<<<<<<<<<
  *     vs[1] = v
- *     for i in range(2,PN_limit):
+ * 
  */
-  __Pyx_TraceLine(1353,0,__PYX_ERR(0, 1353, __pyx_L1_error))
+  __Pyx_TraceLine(1422,0,__PYX_ERR(0, 1422, __pyx_L1_error))
   (__pyx_v_vs[0]) = 0.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1354
- *     cdef double vs[PN_limit]
+  /* "pyseobnr/eob/waveform/waveform.pyx":1423
+ * 
  *     vs[0] = 0
  *     vs[1] = v             # <<<<<<<<<<<<<<
- *     for i in range(2,PN_limit):
- *         vs[i] = v*vs[i-1]
+ * 
+ *     for i in range(2, PN_limit):
  */
-  __Pyx_TraceLine(1354,0,__PYX_ERR(0, 1354, __pyx_L1_error))
+  __Pyx_TraceLine(1423,0,__PYX_ERR(0, 1423, __pyx_L1_error))
   (__pyx_v_vs[1]) = __pyx_v_v;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1355
- *     vs[0] = 0
+  /* "pyseobnr/eob/waveform/waveform.pyx":1425
  *     vs[1] = v
- *     for i in range(2,PN_limit):             # <<<<<<<<<<<<<<
+ * 
+ *     for i in range(2, PN_limit):             # <<<<<<<<<<<<<<
  *         vs[i] = v*vs[i-1]
  * 
  */
-  __Pyx_TraceLine(1355,0,__PYX_ERR(0, 1355, __pyx_L1_error))
+  __Pyx_TraceLine(1425,0,__PYX_ERR(0, 1425, __pyx_L1_error))
   __pyx_t_1 = PN_limit;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 2; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1356
- *     vs[1] = v
- *     for i in range(2,PN_limit):
+    /* "pyseobnr/eob/waveform/waveform.pyx":1426
+ * 
+ *     for i in range(2, PN_limit):
  *         vs[i] = v*vs[i-1]             # <<<<<<<<<<<<<<
  * 
- *     for l in range(2,ell_max+1):
+ *     for l in range(2, ell_max+1):
  */
-    __Pyx_TraceLine(1356,0,__PYX_ERR(0, 1356, __pyx_L1_error))
+    __Pyx_TraceLine(1426,0,__PYX_ERR(0, 1426, __pyx_L1_error))
     (__pyx_v_vs[__pyx_v_i]) = (__pyx_v_v * (__pyx_v_vs[(__pyx_v_i - 1)]));
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1358
+  /* "pyseobnr/eob/waveform/waveform.pyx":1428
  *         vs[i] = v*vs[i-1]
  * 
- *     for l in range(2,ell_max+1):             # <<<<<<<<<<<<<<
- *         for m in range(1,l+1):
- *             eob_pars.flux_params.rholm[l,m] = compute_rholm_single(vs,vh,l,m,eob_pars)
+ *     for l in range(2, ell_max+1):             # <<<<<<<<<<<<<<
+ *         for m in range(1, l+1):
+ *             eob_pars.flux_params.rholm[l, m] = compute_rholm_single(vs, vh, l, m, eob_pars)
  */
-  __Pyx_TraceLine(1358,0,__PYX_ERR(0, 1358, __pyx_L1_error))
+  __Pyx_TraceLine(1428,0,__PYX_ERR(0, 1428, __pyx_L1_error))
   __pyx_t_4 = (ell_max + 1);
   __pyx_t_5 = __pyx_t_4;
   for (__pyx_t_1 = 2; __pyx_t_1 < __pyx_t_5; __pyx_t_1+=1) {
     __pyx_v_l = __pyx_t_1;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1359
+    /* "pyseobnr/eob/waveform/waveform.pyx":1429
  * 
- *     for l in range(2,ell_max+1):
- *         for m in range(1,l+1):             # <<<<<<<<<<<<<<
- *             eob_pars.flux_params.rholm[l,m] = compute_rholm_single(vs,vh,l,m,eob_pars)
+ *     for l in range(2, ell_max+1):
+ *         for m in range(1, l+1):             # <<<<<<<<<<<<<<
+ *             eob_pars.flux_params.rholm[l, m] = compute_rholm_single(vs, vh, l, m, eob_pars)
  * 
  */
-    __Pyx_TraceLine(1359,0,__PYX_ERR(0, 1359, __pyx_L1_error))
+    __Pyx_TraceLine(1429,0,__PYX_ERR(0, 1429, __pyx_L1_error))
     __pyx_t_6 = (__pyx_v_l + 1);
     __pyx_t_7 = __pyx_t_6;
     for (__pyx_t_2 = 1; __pyx_t_2 < __pyx_t_7; __pyx_t_2+=1) {
       __pyx_v_m = __pyx_t_2;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1360
- *     for l in range(2,ell_max+1):
- *         for m in range(1,l+1):
- *             eob_pars.flux_params.rholm[l,m] = compute_rholm_single(vs,vh,l,m,eob_pars)             # <<<<<<<<<<<<<<
+      /* "pyseobnr/eob/waveform/waveform.pyx":1430
+ *     for l in range(2, ell_max+1):
+ *         for m in range(1, l+1):
+ *             eob_pars.flux_params.rholm[l, m] = compute_rholm_single(vs, vh, l, m, eob_pars)             # <<<<<<<<<<<<<<
+ * 
  * 
- * @cython.cpow(True)
  */
-      __Pyx_TraceLine(1360,0,__PYX_ERR(0, 1360, __pyx_L1_error))
-      __pyx_t_8 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rholm_single(__pyx_v_vs, __pyx_v_vh, __pyx_v_l, __pyx_v_m, __pyx_v_eob_pars); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1360, __pyx_L1_error)
+      __Pyx_TraceLine(1430,0,__PYX_ERR(0, 1430, __pyx_L1_error))
+      __pyx_t_8 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rholm_single(__pyx_v_vs, __pyx_v_vh, __pyx_v_l, __pyx_v_m, __pyx_v_eob_pars); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1430, __pyx_L1_error)
       __pyx_t_9 = __pyx_v_l;
       __pyx_t_10 = __pyx_v_m;
       *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eob_pars->flux_params->rholm.data + __pyx_t_9 * __pyx_v_eob_pars->flux_params->rholm.strides[0]) ) + __pyx_t_10 * __pyx_v_eob_pars->flux_params->rholm.strides[1]) )) = __pyx_t_8;
     }
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1350
+  /* "pyseobnr/eob/waveform/waveform.pyx":1418
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef void compute_rholm(double v,double vh,double nu, EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     cdef int i,l,m
+ * cdef void compute_rholm(double v, double vh, double nu, EOBParams eob_pars):             # <<<<<<<<<<<<<<
+ *     cdef int i, l, m
  *     cdef double vs[PN_limit]
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.compute_rholm", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":1369
+/* "pyseobnr/eob/waveform/waveform.pyx":1440
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double  EOBFluxCalculateNewtonianMultipoleAbs(             # <<<<<<<<<<<<<<
- *     double x, double phi, int l, int m, double [:,:] params
- * ):
+ *     double x,
+ *     double phi,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_13EOBFluxCalculateNewtonianMultipoleAbs(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
@@ -27874,85 +27932,85 @@
   __Pyx_TraceDeclarations
   Py_ssize_t __pyx_t_1;
   Py_ssize_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__12)
-  __Pyx_TraceCall("EOBFluxCalculateNewtonianMultipoleAbs", __pyx_f[0], 1369, 0, __PYX_ERR(0, 1369, __pyx_L1_error));
+  __Pyx_TraceCall("EOBFluxCalculateNewtonianMultipoleAbs", __pyx_f[0], 1440, 0, __PYX_ERR(0, 1440, __pyx_L1_error));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1375
+  /* "pyseobnr/eob/waveform/waveform.pyx":1450
  *     Compute the Newtonian multipole (optimised for the flux calculation).
  *     """
- *     cdef double param = params[l,m]             # <<<<<<<<<<<<<<
+ *     cdef double param = params[l, m]             # <<<<<<<<<<<<<<
  *     cdef int epsilon = (l + m) % 2
  * 
  */
-  __Pyx_TraceLine(1375,0,__PYX_ERR(0, 1375, __pyx_L1_error))
+  __Pyx_TraceLine(1450,0,__PYX_ERR(0, 1450, __pyx_L1_error))
   __pyx_t_1 = __pyx_v_l;
   __pyx_t_2 = __pyx_v_m;
   __pyx_v_param = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_params.data + __pyx_t_1 * __pyx_v_params.strides[0]) ) + __pyx_t_2 * __pyx_v_params.strides[1]) )));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1376
+  /* "pyseobnr/eob/waveform/waveform.pyx":1451
  *     """
- *     cdef double param = params[l,m]
+ *     cdef double param = params[l, m]
  *     cdef int epsilon = (l + m) % 2             # <<<<<<<<<<<<<<
  * 
- * 
+ *     cdef double y = ylms[m][l-epsilon]
  */
-  __Pyx_TraceLine(1376,0,__PYX_ERR(0, 1376, __pyx_L1_error))
+  __Pyx_TraceLine(1451,0,__PYX_ERR(0, 1451, __pyx_L1_error))
   __pyx_v_epsilon = ((__pyx_v_l + __pyx_v_m) % 2);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1379
- * 
+  /* "pyseobnr/eob/waveform/waveform.pyx":1453
+ *     cdef int epsilon = (l + m) % 2
  * 
  *     cdef double y = ylms[m][l-epsilon]             # <<<<<<<<<<<<<<
  *     cdef double multipole = param * x ** ((l + epsilon) / 2.0)
  *     multipole *= y
  */
-  __Pyx_TraceLine(1379,0,__PYX_ERR(0, 1379, __pyx_L1_error))
+  __Pyx_TraceLine(1453,0,__PYX_ERR(0, 1453, __pyx_L1_error))
   __pyx_v_y = ((__pyx_v_8pyseobnr_3eob_8waveform_8waveform_ylms[__pyx_v_m])[(__pyx_v_l - __pyx_v_epsilon)]);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1380
+  /* "pyseobnr/eob/waveform/waveform.pyx":1454
  * 
  *     cdef double y = ylms[m][l-epsilon]
  *     cdef double multipole = param * x ** ((l + epsilon) / 2.0)             # <<<<<<<<<<<<<<
  *     multipole *= y
  *     return multipole
  */
-  __Pyx_TraceLine(1380,0,__PYX_ERR(0, 1380, __pyx_L1_error))
+  __Pyx_TraceLine(1454,0,__PYX_ERR(0, 1454, __pyx_L1_error))
   __pyx_v_multipole = (__pyx_v_param * pow(__pyx_v_x, (((double)(__pyx_v_l + __pyx_v_epsilon)) / 2.0)));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1381
+  /* "pyseobnr/eob/waveform/waveform.pyx":1455
  *     cdef double y = ylms[m][l-epsilon]
  *     cdef double multipole = param * x ** ((l + epsilon) / 2.0)
  *     multipole *= y             # <<<<<<<<<<<<<<
  *     return multipole
  * 
  */
-  __Pyx_TraceLine(1381,0,__PYX_ERR(0, 1381, __pyx_L1_error))
+  __Pyx_TraceLine(1455,0,__PYX_ERR(0, 1455, __pyx_L1_error))
   __pyx_v_multipole = (__pyx_v_multipole * __pyx_v_y);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1382
+  /* "pyseobnr/eob/waveform/waveform.pyx":1456
  *     cdef double multipole = param * x ** ((l + epsilon) / 2.0)
  *     multipole *= y
  *     return multipole             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_TraceLine(1382,0,__PYX_ERR(0, 1382, __pyx_L1_error))
+  __Pyx_TraceLine(1456,0,__PYX_ERR(0, 1456, __pyx_L1_error))
   __pyx_r = __pyx_v_multipole;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1369
+  /* "pyseobnr/eob/waveform/waveform.pyx":1440
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double  EOBFluxCalculateNewtonianMultipoleAbs(             # <<<<<<<<<<<<<<
- *     double x, double phi, int l, int m, double [:,:] params
- * ):
+ *     double x,
+ *     double phi,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.EOBFluxCalculateNewtonianMultipoleAbs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
@@ -28022,79 +28080,79 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1369, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1440, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_phi)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1369, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1440, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("EOBFluxCalculateNewtonianMultipoleAbs", 1, 5, 5, 1); __PYX_ERR(0, 1369, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("EOBFluxCalculateNewtonianMultipoleAbs", 1, 5, 5, 1); __PYX_ERR(0, 1440, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_l)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1369, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1440, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("EOBFluxCalculateNewtonianMultipoleAbs", 1, 5, 5, 2); __PYX_ERR(0, 1369, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("EOBFluxCalculateNewtonianMultipoleAbs", 1, 5, 5, 2); __PYX_ERR(0, 1440, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_m)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1369, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1440, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("EOBFluxCalculateNewtonianMultipoleAbs", 1, 5, 5, 3); __PYX_ERR(0, 1369, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("EOBFluxCalculateNewtonianMultipoleAbs", 1, 5, 5, 3); __PYX_ERR(0, 1440, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_params)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1369, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1440, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("EOBFluxCalculateNewtonianMultipoleAbs", 1, 5, 5, 4); __PYX_ERR(0, 1369, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("EOBFluxCalculateNewtonianMultipoleAbs", 1, 5, 5, 4); __PYX_ERR(0, 1440, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "EOBFluxCalculateNewtonianMultipoleAbs") < 0)) __PYX_ERR(0, 1369, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "EOBFluxCalculateNewtonianMultipoleAbs") < 0)) __PYX_ERR(0, 1440, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 5)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
       values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
       values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
     }
-    __pyx_v_x = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_x == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1370, __pyx_L3_error)
-    __pyx_v_phi = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_phi == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1370, __pyx_L3_error)
-    __pyx_v_l = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_l == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1370, __pyx_L3_error)
-    __pyx_v_m = __Pyx_PyInt_As_int(values[3]); if (unlikely((__pyx_v_m == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1370, __pyx_L3_error)
-    __pyx_v_params = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(values[4], PyBUF_WRITABLE); if (unlikely(!__pyx_v_params.memview)) __PYX_ERR(0, 1370, __pyx_L3_error)
+    __pyx_v_x = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_x == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1441, __pyx_L3_error)
+    __pyx_v_phi = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_phi == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1442, __pyx_L3_error)
+    __pyx_v_l = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_l == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1443, __pyx_L3_error)
+    __pyx_v_m = __Pyx_PyInt_As_int(values[3]); if (unlikely((__pyx_v_m == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1444, __pyx_L3_error)
+    __pyx_v_params = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(values[4], PyBUF_WRITABLE); if (unlikely(!__pyx_v_params.memview)) __PYX_ERR(0, 1445, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("EOBFluxCalculateNewtonianMultipoleAbs", 1, 5, 5, __pyx_nargs); __PYX_ERR(0, 1369, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("EOBFluxCalculateNewtonianMultipoleAbs", 1, 5, 5, __pyx_nargs); __PYX_ERR(0, 1440, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -28126,19 +28184,19 @@
   double __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__12)
   __Pyx_RefNannySetupContext("EOBFluxCalculateNewtonianMultipoleAbs", 1);
-  __Pyx_TraceCall("EOBFluxCalculateNewtonianMultipoleAbs (wrapper)", __pyx_f[0], 1369, 0, __PYX_ERR(0, 1369, __pyx_L1_error));
+  __Pyx_TraceCall("EOBFluxCalculateNewtonianMultipoleAbs (wrapper)", __pyx_f[0], 1440, 0, __PYX_ERR(0, 1440, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_params.memview)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 1369, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_EOBFluxCalculateNewtonianMultipoleAbs(__pyx_v_x, __pyx_v_phi, __pyx_v_l, __pyx_v_m, __pyx_v_params, 0); if (unlikely(__pyx_t_1 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1369, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1369, __pyx_L1_error)
+  if (unlikely(!__pyx_v_params.memview)) { __Pyx_RaiseUnboundLocalError("params"); __PYX_ERR(0, 1440, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_EOBFluxCalculateNewtonianMultipoleAbs(__pyx_v_x, __pyx_v_phi, __pyx_v_l, __pyx_v_m, __pyx_v_params, 0); if (unlikely(__pyx_t_1 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1440, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -28148,19 +28206,19 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":1393
+/* "pyseobnr/eob/waveform/waveform.pyx":1467
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef void update_rho_coeffs(double[:,:,:] rho_coeffs, double[:,:,:] extra_coeffs):             # <<<<<<<<<<<<<<
- *     cdef int l,m,i
+ * cdef void update_rho_coeffs(double[:, :, :] rho_coeffs, double[:, :, :] extra_coeffs):             # <<<<<<<<<<<<<<
+ *     cdef int l, m, i
  *     cdef double temp = 0.0
  */
 
 static void __pyx_f_8pyseobnr_3eob_8waveform_8waveform_update_rho_coeffs(__Pyx_memviewslice __pyx_v_rho_coeffs, __Pyx_memviewslice __pyx_v_extra_coeffs) {
   int __pyx_v_l;
   int __pyx_v_m;
   int __pyx_v_i;
@@ -28178,136 +28236,136 @@
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   int __pyx_t_13;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceCall("update_rho_coeffs", __pyx_f[0], 1393, 0, __PYX_ERR(0, 1393, __pyx_L1_error));
+  __Pyx_TraceCall("update_rho_coeffs", __pyx_f[0], 1467, 0, __PYX_ERR(0, 1467, __pyx_L1_error));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1395
- * cdef void update_rho_coeffs(double[:,:,:] rho_coeffs, double[:,:,:] extra_coeffs):
- *     cdef int l,m,i
+  /* "pyseobnr/eob/waveform/waveform.pyx":1469
+ * cdef void update_rho_coeffs(double[:, :, :] rho_coeffs, double[:, :, :] extra_coeffs):
+ *     cdef int l, m, i
  *     cdef double temp = 0.0             # <<<<<<<<<<<<<<
- *     for l in range(2,ell_max+1):
- *         for m in range(1,l+1):
+ *     for l in range(2, ell_max+1):
+ *         for m in range(1, l+1):
  */
-  __Pyx_TraceLine(1395,0,__PYX_ERR(0, 1395, __pyx_L1_error))
+  __Pyx_TraceLine(1469,0,__PYX_ERR(0, 1469, __pyx_L1_error))
   __pyx_v_temp = 0.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1396
- *     cdef int l,m,i
+  /* "pyseobnr/eob/waveform/waveform.pyx":1470
+ *     cdef int l, m, i
  *     cdef double temp = 0.0
- *     for l in range(2,ell_max+1):             # <<<<<<<<<<<<<<
- *         for m in range(1,l+1):
+ *     for l in range(2, ell_max+1):             # <<<<<<<<<<<<<<
+ *         for m in range(1, l+1):
  *             for i in range(PN_limit):
  */
-  __Pyx_TraceLine(1396,0,__PYX_ERR(0, 1396, __pyx_L1_error))
+  __Pyx_TraceLine(1470,0,__PYX_ERR(0, 1470, __pyx_L1_error))
   __pyx_t_1 = (ell_max + 1);
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 2; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_l = __pyx_t_3;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1397
+    /* "pyseobnr/eob/waveform/waveform.pyx":1471
  *     cdef double temp = 0.0
- *     for l in range(2,ell_max+1):
- *         for m in range(1,l+1):             # <<<<<<<<<<<<<<
+ *     for l in range(2, ell_max+1):
+ *         for m in range(1, l+1):             # <<<<<<<<<<<<<<
  *             for i in range(PN_limit):
- *                 temp = extra_coeffs[l,m,i]
+ *                 temp = extra_coeffs[l, m, i]
  */
-    __Pyx_TraceLine(1397,0,__PYX_ERR(0, 1397, __pyx_L1_error))
+    __Pyx_TraceLine(1471,0,__PYX_ERR(0, 1471, __pyx_L1_error))
     __pyx_t_4 = (__pyx_v_l + 1);
     __pyx_t_5 = __pyx_t_4;
     for (__pyx_t_6 = 1; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
       __pyx_v_m = __pyx_t_6;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1398
- *     for l in range(2,ell_max+1):
- *         for m in range(1,l+1):
+      /* "pyseobnr/eob/waveform/waveform.pyx":1472
+ *     for l in range(2, ell_max+1):
+ *         for m in range(1, l+1):
  *             for i in range(PN_limit):             # <<<<<<<<<<<<<<
- *                 temp = extra_coeffs[l,m,i]
+ *                 temp = extra_coeffs[l, m, i]
  *                 if fabs(temp)>1e-15:
  */
-      __Pyx_TraceLine(1398,0,__PYX_ERR(0, 1398, __pyx_L1_error))
+      __Pyx_TraceLine(1472,0,__PYX_ERR(0, 1472, __pyx_L1_error))
       __pyx_t_7 = PN_limit;
       __pyx_t_8 = __pyx_t_7;
       for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
         __pyx_v_i = __pyx_t_9;
 
-        /* "pyseobnr/eob/waveform/waveform.pyx":1399
- *         for m in range(1,l+1):
+        /* "pyseobnr/eob/waveform/waveform.pyx":1473
+ *         for m in range(1, l+1):
  *             for i in range(PN_limit):
- *                 temp = extra_coeffs[l,m,i]             # <<<<<<<<<<<<<<
+ *                 temp = extra_coeffs[l, m, i]             # <<<<<<<<<<<<<<
  *                 if fabs(temp)>1e-15:
- *                     rho_coeffs[l,m,i] += temp
+ *                     rho_coeffs[l, m, i] += temp
  */
-        __Pyx_TraceLine(1399,0,__PYX_ERR(0, 1399, __pyx_L1_error))
+        __Pyx_TraceLine(1473,0,__PYX_ERR(0, 1473, __pyx_L1_error))
         __pyx_t_10 = __pyx_v_l;
         __pyx_t_11 = __pyx_v_m;
         __pyx_t_12 = __pyx_v_i;
         __pyx_v_temp = (*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_extra_coeffs.data + __pyx_t_10 * __pyx_v_extra_coeffs.strides[0]) ) + __pyx_t_11 * __pyx_v_extra_coeffs.strides[1]) ) + __pyx_t_12 * __pyx_v_extra_coeffs.strides[2]) )));
 
-        /* "pyseobnr/eob/waveform/waveform.pyx":1400
+        /* "pyseobnr/eob/waveform/waveform.pyx":1474
  *             for i in range(PN_limit):
- *                 temp = extra_coeffs[l,m,i]
+ *                 temp = extra_coeffs[l, m, i]
  *                 if fabs(temp)>1e-15:             # <<<<<<<<<<<<<<
- *                     rho_coeffs[l,m,i] += temp
+ *                     rho_coeffs[l, m, i] += temp
  * 
  */
-        __Pyx_TraceLine(1400,0,__PYX_ERR(0, 1400, __pyx_L1_error))
+        __Pyx_TraceLine(1474,0,__PYX_ERR(0, 1474, __pyx_L1_error))
         __pyx_t_13 = (fabs(__pyx_v_temp) > 1e-15);
         if (__pyx_t_13) {
 
-          /* "pyseobnr/eob/waveform/waveform.pyx":1401
- *                 temp = extra_coeffs[l,m,i]
+          /* "pyseobnr/eob/waveform/waveform.pyx":1475
+ *                 temp = extra_coeffs[l, m, i]
  *                 if fabs(temp)>1e-15:
- *                     rho_coeffs[l,m,i] += temp             # <<<<<<<<<<<<<<
+ *                     rho_coeffs[l, m, i] += temp             # <<<<<<<<<<<<<<
+ * 
  * 
- * @cython.cpow(True)
  */
-          __Pyx_TraceLine(1401,0,__PYX_ERR(0, 1401, __pyx_L1_error))
+          __Pyx_TraceLine(1475,0,__PYX_ERR(0, 1475, __pyx_L1_error))
           __pyx_t_12 = __pyx_v_l;
           __pyx_t_11 = __pyx_v_m;
           __pyx_t_10 = __pyx_v_i;
           *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rho_coeffs.data + __pyx_t_12 * __pyx_v_rho_coeffs.strides[0]) ) + __pyx_t_11 * __pyx_v_rho_coeffs.strides[1]) ) + __pyx_t_10 * __pyx_v_rho_coeffs.strides[2]) )) += __pyx_v_temp;
 
-          /* "pyseobnr/eob/waveform/waveform.pyx":1400
+          /* "pyseobnr/eob/waveform/waveform.pyx":1474
  *             for i in range(PN_limit):
- *                 temp = extra_coeffs[l,m,i]
+ *                 temp = extra_coeffs[l, m, i]
  *                 if fabs(temp)>1e-15:             # <<<<<<<<<<<<<<
- *                     rho_coeffs[l,m,i] += temp
+ *                     rho_coeffs[l, m, i] += temp
  * 
  */
         }
       }
     }
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1393
+  /* "pyseobnr/eob/waveform/waveform.pyx":1467
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef void update_rho_coeffs(double[:,:,:] rho_coeffs, double[:,:,:] extra_coeffs):             # <<<<<<<<<<<<<<
- *     cdef int l,m,i
+ * cdef void update_rho_coeffs(double[:, :, :] rho_coeffs, double[:, :, :] extra_coeffs):             # <<<<<<<<<<<<<<
+ *     cdef int l, m, i
  *     cdef double temp = 0.0
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.update_rho_coeffs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":1411
+/* "pyseobnr/eob/waveform/waveform.pyx":1486
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef double compute_flux(double r,double phi,double pr,double pphi,double omega,double omega_circ,double H,EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     """
- *     Compute the full flux.
+ * cpdef double compute_flux(             # <<<<<<<<<<<<<<
+ *     double r,
+ *     double phi,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_15compute_flux(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
@@ -28350,351 +28408,351 @@
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__13)
   __Pyx_RefNannySetupContext("compute_flux", 1);
-  __Pyx_TraceCall("compute_flux", __pyx_f[0], 1411, 0, __PYX_ERR(0, 1411, __pyx_L1_error));
+  __Pyx_TraceCall("compute_flux", __pyx_f[0], 1486, 0, __PYX_ERR(0, 1486, __pyx_L1_error));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1418
+  /* "pyseobnr/eob/waveform/waveform.pyx":1502
  *     """
- *     cdef int l,m
- *     cdef double[:,:] Tlm = eob_pars.flux_params.Tlm             # <<<<<<<<<<<<<<
+ *     cdef int l, m
+ *     cdef double[:, :] Tlm = eob_pars.flux_params.Tlm             # <<<<<<<<<<<<<<
  *     # Note the "abs" in the prefixes.
- *     cdef double[:,:] prefixes = eob_pars.flux_params.prefixes_abs
+ *     cdef double[:, :] prefixes = eob_pars.flux_params.prefixes_abs
  */
-  __Pyx_TraceLine(1418,0,__PYX_ERR(0, 1418, __pyx_L1_error))
+  __Pyx_TraceLine(1502,0,__PYX_ERR(0, 1502, __pyx_L1_error))
   __pyx_t_1 = __pyx_v_eob_pars->flux_params->Tlm;
   __PYX_INC_MEMVIEW(&__pyx_t_1, 1);
   __pyx_v_Tlm = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1420
- *     cdef double[:,:] Tlm = eob_pars.flux_params.Tlm
+  /* "pyseobnr/eob/waveform/waveform.pyx":1504
+ *     cdef double[:, :] Tlm = eob_pars.flux_params.Tlm
  *     # Note the "abs" in the prefixes.
- *     cdef double[:,:] prefixes = eob_pars.flux_params.prefixes_abs             # <<<<<<<<<<<<<<
+ *     cdef double[:, :] prefixes = eob_pars.flux_params.prefixes_abs             # <<<<<<<<<<<<<<
  *     cdef double v = omega**(1./3)
  *     cdef double vh3 = H*omega
  */
-  __Pyx_TraceLine(1420,0,__PYX_ERR(0, 1420, __pyx_L1_error))
+  __Pyx_TraceLine(1504,0,__PYX_ERR(0, 1504, __pyx_L1_error))
   __pyx_t_1 = __pyx_v_eob_pars->flux_params->prefixes_abs;
   __PYX_INC_MEMVIEW(&__pyx_t_1, 1);
   __pyx_v_prefixes = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1421
+  /* "pyseobnr/eob/waveform/waveform.pyx":1505
  *     # Note the "abs" in the prefixes.
- *     cdef double[:,:] prefixes = eob_pars.flux_params.prefixes_abs
+ *     cdef double[:, :] prefixes = eob_pars.flux_params.prefixes_abs
  *     cdef double v = omega**(1./3)             # <<<<<<<<<<<<<<
  *     cdef double vh3 = H*omega
  *     cdef double vh = vh3**(1./3)
  */
-  __Pyx_TraceLine(1421,0,__PYX_ERR(0, 1421, __pyx_L1_error))
+  __Pyx_TraceLine(1505,0,__PYX_ERR(0, 1505, __pyx_L1_error))
   __pyx_v_v = pow(__pyx_v_omega, (1. / 3.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1422
- *     cdef double[:,:] prefixes = eob_pars.flux_params.prefixes_abs
+  /* "pyseobnr/eob/waveform/waveform.pyx":1506
+ *     cdef double[:, :] prefixes = eob_pars.flux_params.prefixes_abs
  *     cdef double v = omega**(1./3)
  *     cdef double vh3 = H*omega             # <<<<<<<<<<<<<<
  *     cdef double vh = vh3**(1./3)
  *     cdef double omega2 = omega*omega
  */
-  __Pyx_TraceLine(1422,0,__PYX_ERR(0, 1422, __pyx_L1_error))
+  __Pyx_TraceLine(1506,0,__PYX_ERR(0, 1506, __pyx_L1_error))
   __pyx_v_vh3 = (__pyx_v_H * __pyx_v_omega);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1423
+  /* "pyseobnr/eob/waveform/waveform.pyx":1507
  *     cdef double v = omega**(1./3)
  *     cdef double vh3 = H*omega
  *     cdef double vh = vh3**(1./3)             # <<<<<<<<<<<<<<
  *     cdef double omega2 = omega*omega
  *     cdef double nu = eob_pars.p_params.nu
  */
-  __Pyx_TraceLine(1423,0,__PYX_ERR(0, 1423, __pyx_L1_error))
+  __Pyx_TraceLine(1507,0,__PYX_ERR(0, 1507, __pyx_L1_error))
   __pyx_v_vh = pow(__pyx_v_vh3, (1. / 3.0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1424
+  /* "pyseobnr/eob/waveform/waveform.pyx":1508
  *     cdef double vh3 = H*omega
  *     cdef double vh = vh3**(1./3)
  *     cdef double omega2 = omega*omega             # <<<<<<<<<<<<<<
  *     cdef double nu = eob_pars.p_params.nu
  *     cdef double flux = 0.0
  */
-  __Pyx_TraceLine(1424,0,__PYX_ERR(0, 1424, __pyx_L1_error))
+  __Pyx_TraceLine(1508,0,__PYX_ERR(0, 1508, __pyx_L1_error))
   __pyx_v_omega2 = (__pyx_v_omega * __pyx_v_omega);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1425
+  /* "pyseobnr/eob/waveform/waveform.pyx":1509
  *     cdef double vh = vh3**(1./3)
  *     cdef double omega2 = omega*omega
  *     cdef double nu = eob_pars.p_params.nu             # <<<<<<<<<<<<<<
  *     cdef double flux = 0.0
  *     cdef double hNewton
  */
-  __Pyx_TraceLine(1425,0,__PYX_ERR(0, 1425, __pyx_L1_error))
+  __Pyx_TraceLine(1509,0,__PYX_ERR(0, 1509, __pyx_L1_error))
   __pyx_t_2 = __pyx_v_eob_pars->p_params->nu;
   __pyx_v_nu = __pyx_t_2;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1426
+  /* "pyseobnr/eob/waveform/waveform.pyx":1510
  *     cdef double omega2 = omega*omega
  *     cdef double nu = eob_pars.p_params.nu
  *     cdef double flux = 0.0             # <<<<<<<<<<<<<<
  *     cdef double hNewton
  * 
  */
-  __Pyx_TraceLine(1426,0,__PYX_ERR(0, 1426, __pyx_L1_error))
+  __Pyx_TraceLine(1510,0,__PYX_ERR(0, 1510, __pyx_L1_error))
   __pyx_v_flux = 0.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1430
+  /* "pyseobnr/eob/waveform/waveform.pyx":1514
  * 
  *     # Precompute the tail
  *     compute_tail(omega, H, Tlm)             # <<<<<<<<<<<<<<
  *     cdef double tail
  * 
  */
-  __Pyx_TraceLine(1430,0,__PYX_ERR(0, 1430, __pyx_L1_error))
-  __pyx_t_3 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_tail(__pyx_v_omega, __pyx_v_H, __pyx_v_Tlm, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1430, __pyx_L1_error)
+  __Pyx_TraceLine(1514,0,__PYX_ERR(0, 1514, __pyx_L1_error))
+  __pyx_t_3 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_tail(__pyx_v_omega, __pyx_v_H, __pyx_v_Tlm, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1514, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1434
+  /* "pyseobnr/eob/waveform/waveform.pyx":1518
  * 
  *     # Precompute the source term
  *     cdef double Slm = 0.0             # <<<<<<<<<<<<<<
- *     cdef double source1 = (H * H - 1.0) / (2.0 * nu) + 1.0 # H_eff
+ *     cdef double source1 = (H * H - 1.0) / (2.0 * nu) + 1.0  # H_eff
  *     cdef double source2 = v*pphi
  */
-  __Pyx_TraceLine(1434,0,__PYX_ERR(0, 1434, __pyx_L1_error))
+  __Pyx_TraceLine(1518,0,__PYX_ERR(0, 1518, __pyx_L1_error))
   __pyx_v_Slm = 0.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1435
+  /* "pyseobnr/eob/waveform/waveform.pyx":1519
  *     # Precompute the source term
  *     cdef double Slm = 0.0
- *     cdef double source1 = (H * H - 1.0) / (2.0 * nu) + 1.0 # H_eff             # <<<<<<<<<<<<<<
+ *     cdef double source1 = (H * H - 1.0) / (2.0 * nu) + 1.0  # H_eff             # <<<<<<<<<<<<<<
  *     cdef double source2 = v*pphi
  *     cdef double v_phi = omega/omega_circ**(2./3)
  */
-  __Pyx_TraceLine(1435,0,__PYX_ERR(0, 1435, __pyx_L1_error))
+  __Pyx_TraceLine(1519,0,__PYX_ERR(0, 1519, __pyx_L1_error))
   __pyx_v_source1 = ((((__pyx_v_H * __pyx_v_H) - 1.0) / (2.0 * __pyx_v_nu)) + 1.0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1436
+  /* "pyseobnr/eob/waveform/waveform.pyx":1520
  *     cdef double Slm = 0.0
- *     cdef double source1 = (H * H - 1.0) / (2.0 * nu) + 1.0 # H_eff
+ *     cdef double source1 = (H * H - 1.0) / (2.0 * nu) + 1.0  # H_eff
  *     cdef double source2 = v*pphi             # <<<<<<<<<<<<<<
  *     cdef double v_phi = omega/omega_circ**(2./3)
  *     cdef double v_phi2 = v_phi*v_phi
  */
-  __Pyx_TraceLine(1436,0,__PYX_ERR(0, 1436, __pyx_L1_error))
+  __Pyx_TraceLine(1520,0,__PYX_ERR(0, 1520, __pyx_L1_error))
   __pyx_v_source2 = (__pyx_v_v * __pyx_v_pphi);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1437
- *     cdef double source1 = (H * H - 1.0) / (2.0 * nu) + 1.0 # H_eff
+  /* "pyseobnr/eob/waveform/waveform.pyx":1521
+ *     cdef double source1 = (H * H - 1.0) / (2.0 * nu) + 1.0  # H_eff
  *     cdef double source2 = v*pphi
  *     cdef double v_phi = omega/omega_circ**(2./3)             # <<<<<<<<<<<<<<
  *     cdef double v_phi2 = v_phi*v_phi
  * 
  */
-  __Pyx_TraceLine(1437,0,__PYX_ERR(0, 1437, __pyx_L1_error))
+  __Pyx_TraceLine(1521,0,__PYX_ERR(0, 1521, __pyx_L1_error))
   __pyx_v_v_phi = (__pyx_v_omega / pow(__pyx_v_omega_circ, (2. / 3.0)));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1438
+  /* "pyseobnr/eob/waveform/waveform.pyx":1522
  *     cdef double source2 = v*pphi
  *     cdef double v_phi = omega/omega_circ**(2./3)
  *     cdef double v_phi2 = v_phi*v_phi             # <<<<<<<<<<<<<<
  * 
- *     cdef double complex rholmPwrl  = 1.0
+ *     cdef double complex rholmPwrl = 1.0
  */
-  __Pyx_TraceLine(1438,0,__PYX_ERR(0, 1438, __pyx_L1_error))
+  __Pyx_TraceLine(1522,0,__PYX_ERR(0, 1522, __pyx_L1_error))
   __pyx_v_v_phi2 = (__pyx_v_v_phi * __pyx_v_v_phi);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1440
+  /* "pyseobnr/eob/waveform/waveform.pyx":1524
  *     cdef double v_phi2 = v_phi*v_phi
  * 
- *     cdef double complex rholmPwrl  = 1.0             # <<<<<<<<<<<<<<
+ *     cdef double complex rholmPwrl = 1.0             # <<<<<<<<<<<<<<
  * 
  *     # Assume that the spin params have already been updated appropriately
  */
-  __Pyx_TraceLine(1440,0,__PYX_ERR(0, 1440, __pyx_L1_error))
+  __Pyx_TraceLine(1524,0,__PYX_ERR(0, 1524, __pyx_L1_error))
   __pyx_v_rholmPwrl = __pyx_t_double_complex_from_parts(1.0, 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1443
+  /* "pyseobnr/eob/waveform/waveform.pyx":1527
  * 
  *     # Assume that the spin params have already been updated appropriately
- *     compute_rho_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,             # <<<<<<<<<<<<<<
- *     eob_pars.p_params.chi_A, eob_pars.flux_params.rho_coeffs,eob_pars.flux_params.rho_coeffs_log,
- *     eob_pars.flux_params.f_coeffs,eob_pars.flux_params.f_coeffs_vh, eob_pars.flux_params.extra_PN_terms)
+ *     compute_rho_coeffs(             # <<<<<<<<<<<<<<
+ *         eob_pars.p_params.nu,
+ *         eob_pars.p_params.delta,
  */
-  __Pyx_TraceLine(1443,0,__PYX_ERR(0, 1443, __pyx_L1_error))
-  __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rho_coeffs(__pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars->p_params->delta, __pyx_v_eob_pars->p_params->a, __pyx_v_eob_pars->p_params->chi_S, __pyx_v_eob_pars->p_params->chi_A, __pyx_v_eob_pars->flux_params->rho_coeffs, __pyx_v_eob_pars->flux_params->rho_coeffs_log, __pyx_v_eob_pars->flux_params->f_coeffs, __pyx_v_eob_pars->flux_params->f_coeffs_vh, __pyx_v_eob_pars->flux_params->extra_PN_terms, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1443, __pyx_L1_error)
+  __Pyx_TraceLine(1527,0,__PYX_ERR(0, 1527, __pyx_L1_error))
+  __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rho_coeffs(__pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars->p_params->delta, __pyx_v_eob_pars->p_params->a, __pyx_v_eob_pars->p_params->chi_S, __pyx_v_eob_pars->p_params->chi_A, __pyx_v_eob_pars->flux_params->rho_coeffs, __pyx_v_eob_pars->flux_params->rho_coeffs_log, __pyx_v_eob_pars->flux_params->f_coeffs, __pyx_v_eob_pars->flux_params->f_coeffs_vh, __pyx_v_eob_pars->flux_params->extra_PN_terms, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1527, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1449
+  /* "pyseobnr/eob/waveform/waveform.pyx":1539
+ *         eob_pars.flux_params.extra_PN_terms)
  * 
+ *     compute_rholm(v, vh, eob_pars.p_params.nu, eob_pars)             # <<<<<<<<<<<<<<
  * 
- *     compute_rholm(v,vh,eob_pars.p_params.nu,eob_pars)             # <<<<<<<<<<<<<<
  *     cdef double complex hlm
- * 
  */
-  __Pyx_TraceLine(1449,0,__PYX_ERR(0, 1449, __pyx_L1_error))
-  __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rholm(__pyx_v_v, __pyx_v_vh, __pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1449, __pyx_L1_error)
+  __Pyx_TraceLine(1539,0,__PYX_ERR(0, 1539, __pyx_L1_error))
+  __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rholm(__pyx_v_v, __pyx_v_vh, __pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1539, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1454
+  /* "pyseobnr/eob/waveform/waveform.pyx":1545
  *     # Deal with NQCs
  *     cdef double[:] nqc_coeffs
  *     cdef double correction = 1.0             # <<<<<<<<<<<<<<
  * 
- *     for l in range(2,ell_max+1):
+ *     for l in range(2, ell_max+1):
  */
-  __Pyx_TraceLine(1454,0,__PYX_ERR(0, 1454, __pyx_L1_error))
+  __Pyx_TraceLine(1545,0,__PYX_ERR(0, 1545, __pyx_L1_error))
   __pyx_v_correction = 1.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1456
+  /* "pyseobnr/eob/waveform/waveform.pyx":1547
  *     cdef double correction = 1.0
  * 
- *     for l in range(2,ell_max+1):             # <<<<<<<<<<<<<<
- *         for m in range(1,l+1):
+ *     for l in range(2, ell_max+1):             # <<<<<<<<<<<<<<
+ *         for m in range(1, l+1):
  *             # Assemble the waveform
  */
-  __Pyx_TraceLine(1456,0,__PYX_ERR(0, 1456, __pyx_L1_error))
+  __Pyx_TraceLine(1547,0,__PYX_ERR(0, 1547, __pyx_L1_error))
   __pyx_t_4 = (ell_max + 1);
   __pyx_t_5 = __pyx_t_4;
   for (__pyx_t_6 = 2; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
     __pyx_v_l = __pyx_t_6;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1457
+    /* "pyseobnr/eob/waveform/waveform.pyx":1548
  * 
- *     for l in range(2,ell_max+1):
- *         for m in range(1,l+1):             # <<<<<<<<<<<<<<
+ *     for l in range(2, ell_max+1):
+ *         for m in range(1, l+1):             # <<<<<<<<<<<<<<
  *             # Assemble the waveform
- * 
+ *             hNewton = EOBFluxCalculateNewtonianMultipoleAbs(
  */
-    __Pyx_TraceLine(1457,0,__PYX_ERR(0, 1457, __pyx_L1_error))
+    __Pyx_TraceLine(1548,0,__PYX_ERR(0, 1548, __pyx_L1_error))
     __pyx_t_7 = (__pyx_v_l + 1);
     __pyx_t_8 = __pyx_t_7;
     for (__pyx_t_9 = 1; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
       __pyx_v_m = __pyx_t_9;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1460
+      /* "pyseobnr/eob/waveform/waveform.pyx":1550
+ *         for m in range(1, l+1):
  *             # Assemble the waveform
- * 
  *             hNewton = EOBFluxCalculateNewtonianMultipoleAbs(             # <<<<<<<<<<<<<<
  *                 v_phi2, M_PI_2, l, m, prefixes
  *             )
  */
-      __Pyx_TraceLine(1460,0,__PYX_ERR(0, 1460, __pyx_L1_error))
-      __pyx_t_2 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_EOBFluxCalculateNewtonianMultipoleAbs(__pyx_v_v_phi2, M_PI_2, __pyx_v_l, __pyx_v_m, __pyx_v_prefixes, 0); if (unlikely(__pyx_t_2 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1460, __pyx_L1_error)
+      __Pyx_TraceLine(1550,0,__PYX_ERR(0, 1550, __pyx_L1_error))
+      __pyx_t_2 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_EOBFluxCalculateNewtonianMultipoleAbs(__pyx_v_v_phi2, M_PI_2, __pyx_v_l, __pyx_v_m, __pyx_v_prefixes, 0); if (unlikely(__pyx_t_2 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1550, __pyx_L1_error)
       __pyx_v_hNewton = __pyx_t_2;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1463
- *                 v_phi2, M_PI_2, l, m, prefixes
+      /* "pyseobnr/eob/waveform/waveform.pyx":1554
  *             )
+ * 
  *             if ((l + m) % 2) == 0:             # <<<<<<<<<<<<<<
  *                 Slm = source1
- * 
+ *             else:
  */
-      __Pyx_TraceLine(1463,0,__PYX_ERR(0, 1463, __pyx_L1_error))
+      __Pyx_TraceLine(1554,0,__PYX_ERR(0, 1554, __pyx_L1_error))
       __pyx_t_10 = (((__pyx_v_l + __pyx_v_m) % 2) == 0);
       if (__pyx_t_10) {
 
-        /* "pyseobnr/eob/waveform/waveform.pyx":1464
- *             )
+        /* "pyseobnr/eob/waveform/waveform.pyx":1555
+ * 
  *             if ((l + m) % 2) == 0:
  *                 Slm = source1             # <<<<<<<<<<<<<<
- * 
  *             else:
+ *                 Slm = source2
  */
-        __Pyx_TraceLine(1464,0,__PYX_ERR(0, 1464, __pyx_L1_error))
+        __Pyx_TraceLine(1555,0,__PYX_ERR(0, 1555, __pyx_L1_error))
         __pyx_v_Slm = __pyx_v_source1;
 
-        /* "pyseobnr/eob/waveform/waveform.pyx":1463
- *                 v_phi2, M_PI_2, l, m, prefixes
+        /* "pyseobnr/eob/waveform/waveform.pyx":1554
  *             )
+ * 
  *             if ((l + m) % 2) == 0:             # <<<<<<<<<<<<<<
  *                 Slm = source1
- * 
+ *             else:
  */
         goto __pyx_L7;
       }
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1467
- * 
+      /* "pyseobnr/eob/waveform/waveform.pyx":1557
+ *                 Slm = source1
  *             else:
  *                 Slm = source2             # <<<<<<<<<<<<<<
  * 
- *             tail = Tlm[l,m]
+ *             tail = Tlm[l, m]
  */
-      __Pyx_TraceLine(1467,0,__PYX_ERR(0, 1467, __pyx_L1_error))
+      __Pyx_TraceLine(1557,0,__PYX_ERR(0, 1557, __pyx_L1_error))
       /*else*/ {
         __pyx_v_Slm = __pyx_v_source2;
       }
       __pyx_L7:;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1469
+      /* "pyseobnr/eob/waveform/waveform.pyx":1559
  *                 Slm = source2
  * 
- *             tail = Tlm[l,m]             # <<<<<<<<<<<<<<
- *             rholmPwrl = eob_pars.flux_params.rholm[l,m]
+ *             tail = Tlm[l, m]             # <<<<<<<<<<<<<<
+ *             rholmPwrl = eob_pars.flux_params.rholm[l, m]
  *             hlm = tail*Slm*hNewton*rholmPwrl
  */
-      __Pyx_TraceLine(1469,0,__PYX_ERR(0, 1469, __pyx_L1_error))
+      __Pyx_TraceLine(1559,0,__PYX_ERR(0, 1559, __pyx_L1_error))
       __pyx_t_11 = __pyx_v_l;
       __pyx_t_12 = __pyx_v_m;
       __pyx_v_tail = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Tlm.data + __pyx_t_11 * __pyx_v_Tlm.strides[0]) ) + __pyx_t_12 * __pyx_v_Tlm.strides[1]) )));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1470
+      /* "pyseobnr/eob/waveform/waveform.pyx":1560
  * 
- *             tail = Tlm[l,m]
- *             rholmPwrl = eob_pars.flux_params.rholm[l,m]             # <<<<<<<<<<<<<<
+ *             tail = Tlm[l, m]
+ *             rholmPwrl = eob_pars.flux_params.rholm[l, m]             # <<<<<<<<<<<<<<
  *             hlm = tail*Slm*hNewton*rholmPwrl
  * 
  */
-      __Pyx_TraceLine(1470,0,__PYX_ERR(0, 1470, __pyx_L1_error))
+      __Pyx_TraceLine(1560,0,__PYX_ERR(0, 1560, __pyx_L1_error))
       __pyx_t_12 = __pyx_v_l;
       __pyx_t_11 = __pyx_v_m;
       __pyx_v_rholmPwrl = (*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eob_pars->flux_params->rholm.data + __pyx_t_12 * __pyx_v_eob_pars->flux_params->rholm.strides[0]) ) + __pyx_t_11 * __pyx_v_eob_pars->flux_params->rholm.strides[1]) )));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1471
- *             tail = Tlm[l,m]
- *             rholmPwrl = eob_pars.flux_params.rholm[l,m]
+      /* "pyseobnr/eob/waveform/waveform.pyx":1561
+ *             tail = Tlm[l, m]
+ *             rholmPwrl = eob_pars.flux_params.rholm[l, m]
  *             hlm = tail*Slm*hNewton*rholmPwrl             # <<<<<<<<<<<<<<
  * 
  *             flux += m*m*omega2*cabs(hlm)**2
  */
-      __Pyx_TraceLine(1471,0,__PYX_ERR(0, 1471, __pyx_L1_error))
+      __Pyx_TraceLine(1561,0,__PYX_ERR(0, 1561, __pyx_L1_error))
       __pyx_v_hlm = __Pyx_c_prod_double(__pyx_t_double_complex_from_parts(((__pyx_v_tail * __pyx_v_Slm) * __pyx_v_hNewton), 0), __pyx_v_rholmPwrl);
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1473
+      /* "pyseobnr/eob/waveform/waveform.pyx":1563
  *             hlm = tail*Slm*hNewton*rholmPwrl
  * 
  *             flux += m*m*omega2*cabs(hlm)**2             # <<<<<<<<<<<<<<
- *     return flux/(8*pi)
  * 
+ *     return flux/(8*pi)
  */
-      __Pyx_TraceLine(1473,0,__PYX_ERR(0, 1473, __pyx_L1_error))
+      __Pyx_TraceLine(1563,0,__PYX_ERR(0, 1563, __pyx_L1_error))
       __pyx_v_flux = (__pyx_v_flux + (((__pyx_v_m * __pyx_v_m) * __pyx_v_omega2) * pow(cabs(__pyx_v_hlm), 2.0)));
     }
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1474
- * 
+  /* "pyseobnr/eob/waveform/waveform.pyx":1565
  *             flux += m*m*omega2*cabs(hlm)**2
+ * 
  *     return flux/(8*pi)             # <<<<<<<<<<<<<<
  * 
- * @cython.cpow(True)
+ * 
  */
-  __Pyx_TraceLine(1474,0,__PYX_ERR(0, 1474, __pyx_L1_error))
+  __Pyx_TraceLine(1565,0,__PYX_ERR(0, 1565, __pyx_L1_error))
   __pyx_r = (__pyx_v_flux / (8.0 * M_PI));
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1411
+  /* "pyseobnr/eob/waveform/waveform.pyx":1486
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef double compute_flux(double r,double phi,double pr,double pphi,double omega,double omega_circ,double H,EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     """
- *     Compute the full flux.
+ * cpdef double compute_flux(             # <<<<<<<<<<<<<<
+ *     double r,
+ *     double phi,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_1, 1);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.compute_flux", __pyx_clineno, __pyx_lineno, __pyx_filename);
@@ -28778,129 +28836,129 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_r)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1486, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_phi)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1486, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, 1); __PYX_ERR(0, 1411, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, 1); __PYX_ERR(0, 1486, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_pr)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1486, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, 2); __PYX_ERR(0, 1411, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, 2); __PYX_ERR(0, 1486, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_pphi)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1486, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, 3); __PYX_ERR(0, 1411, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, 3); __PYX_ERR(0, 1486, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_omega)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1486, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, 4); __PYX_ERR(0, 1411, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, 4); __PYX_ERR(0, 1486, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_omega_circ)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[5]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1486, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, 5); __PYX_ERR(0, 1411, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, 5); __PYX_ERR(0, 1486, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_H)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[6]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1486, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, 6); __PYX_ERR(0, 1411, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, 6); __PYX_ERR(0, 1486, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_eob_pars)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[7]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1486, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, 7); __PYX_ERR(0, 1411, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, 7); __PYX_ERR(0, 1486, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_flux") < 0)) __PYX_ERR(0, 1411, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_flux") < 0)) __PYX_ERR(0, 1486, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 8)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
       values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
       values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
       values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
       values[6] = __Pyx_Arg_FASTCALL(__pyx_args, 6);
       values[7] = __Pyx_Arg_FASTCALL(__pyx_args, 7);
     }
-    __pyx_v_r = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_r == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
-    __pyx_v_phi = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_phi == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
-    __pyx_v_pr = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_pr == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
-    __pyx_v_pphi = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_pphi == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
-    __pyx_v_omega = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_omega == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
-    __pyx_v_omega_circ = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_omega_circ == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
-    __pyx_v_H = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_H == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L3_error)
+    __pyx_v_r = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_r == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1487, __pyx_L3_error)
+    __pyx_v_phi = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_phi == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1488, __pyx_L3_error)
+    __pyx_v_pr = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_pr == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1489, __pyx_L3_error)
+    __pyx_v_pphi = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_pphi == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1490, __pyx_L3_error)
+    __pyx_v_omega = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_omega == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1491, __pyx_L3_error)
+    __pyx_v_omega_circ = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_omega_circ == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1492, __pyx_L3_error)
+    __pyx_v_H = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_H == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1493, __pyx_L3_error)
     __pyx_v_eob_pars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)values[7]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, __pyx_nargs); __PYX_ERR(0, 1411, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("compute_flux", 1, 8, 8, __pyx_nargs); __PYX_ERR(0, 1486, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.compute_flux", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_eob_pars), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "eob_pars", 0))) __PYX_ERR(0, 1411, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_eob_pars), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "eob_pars", 0))) __PYX_ERR(0, 1494, __pyx_L1_error)
   __pyx_r = __pyx_pf_8pyseobnr_3eob_8waveform_8waveform_14compute_flux(__pyx_self, __pyx_v_r, __pyx_v_phi, __pyx_v_pr, __pyx_v_pphi, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H, __pyx_v_eob_pars);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -28921,18 +28979,18 @@
   double __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__13)
   __Pyx_RefNannySetupContext("compute_flux", 1);
-  __Pyx_TraceCall("compute_flux (wrapper)", __pyx_f[0], 1411, 0, __PYX_ERR(0, 1411, __pyx_L1_error));
+  __Pyx_TraceCall("compute_flux (wrapper)", __pyx_f[0], 1486, 0, __PYX_ERR(0, 1486, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_flux(__pyx_v_r, __pyx_v_phi, __pyx_v_pr, __pyx_v_pphi, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H, __pyx_v_eob_pars, 0); if (unlikely(__pyx_t_1 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1411, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1411, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_flux(__pyx_v_r, __pyx_v_phi, __pyx_v_pr, __pyx_v_pphi, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H, __pyx_v_eob_pars, 0); if (unlikely(__pyx_t_1 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1486, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1486, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -28942,15 +29000,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":1484
+/* "pyseobnr/eob/waveform/waveform.pyx":1576
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double compute_refactorized_flux(             # <<<<<<<<<<<<<<
  *     double chi_1,
  *     double chi_2,
  */
 
@@ -29011,125 +29069,125 @@
   int __pyx_t_7;
   double __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__14)
   __Pyx_RefNannySetupContext("compute_refactorized_flux", 1);
-  __Pyx_TraceCall("compute_refactorized_flux", __pyx_f[0], 1484, 0, __PYX_ERR(0, 1484, __pyx_L1_error));
+  __Pyx_TraceCall("compute_refactorized_flux", __pyx_f[0], 1576, 0, __PYX_ERR(0, 1576, __pyx_L1_error));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1497
+  /* "pyseobnr/eob/waveform/waveform.pyx":1589
  *     bint quasi_circ,
  * ):
  *     cdef double CES21 = 1.             # <<<<<<<<<<<<<<
  *     cdef double CES22 = 1.
  *     cdef double CES31 = 1.
  */
-  __Pyx_TraceLine(1497,0,__PYX_ERR(0, 1497, __pyx_L1_error))
+  __Pyx_TraceLine(1589,0,__PYX_ERR(0, 1589, __pyx_L1_error))
   __pyx_v_CES21 = 1.;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1498
+  /* "pyseobnr/eob/waveform/waveform.pyx":1590
  * ):
  *     cdef double CES21 = 1.
  *     cdef double CES22 = 1.             # <<<<<<<<<<<<<<
  *     cdef double CES31 = 1.
  *     cdef double CES32 = 1.
  */
-  __Pyx_TraceLine(1498,0,__PYX_ERR(0, 1498, __pyx_L1_error))
+  __Pyx_TraceLine(1590,0,__PYX_ERR(0, 1590, __pyx_L1_error))
   __pyx_v_CES22 = 1.;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1499
+  /* "pyseobnr/eob/waveform/waveform.pyx":1591
  *     cdef double CES21 = 1.
  *     cdef double CES22 = 1.
  *     cdef double CES31 = 1.             # <<<<<<<<<<<<<<
  *     cdef double CES32 = 1.
  * 
  */
-  __Pyx_TraceLine(1499,0,__PYX_ERR(0, 1499, __pyx_L1_error))
+  __Pyx_TraceLine(1591,0,__PYX_ERR(0, 1591, __pyx_L1_error))
   __pyx_v_CES31 = 1.;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1500
+  /* "pyseobnr/eob/waveform/waveform.pyx":1592
  *     cdef double CES22 = 1.
  *     cdef double CES31 = 1.
  *     cdef double CES32 = 1.             # <<<<<<<<<<<<<<
  * 
  *     # cdef double x
  */
-  __Pyx_TraceLine(1500,0,__PYX_ERR(0, 1500, __pyx_L1_error))
+  __Pyx_TraceLine(1592,0,__PYX_ERR(0, 1592, __pyx_L1_error))
   __pyx_v_CES32 = 1.;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1541
+  /* "pyseobnr/eob/waveform/waveform.pyx":1633
  *     cdef double beta112
  * 
  *     if quasi_circ == 1:             # <<<<<<<<<<<<<<
  *         h_Newt_22 = 6.341323676169617 * x_phi
  *     else:
  */
-  __Pyx_TraceLine(1541,0,__PYX_ERR(0, 1541, __pyx_L1_error))
+  __Pyx_TraceLine(1633,0,__PYX_ERR(0, 1633, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_quasi_circ == 1);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1542
+    /* "pyseobnr/eob/waveform/waveform.pyx":1634
  * 
  *     if quasi_circ == 1:
  *         h_Newt_22 = 6.341323676169617 * x_phi             # <<<<<<<<<<<<<<
  *     else:
  *         h_Newt_22 = 6.341323676169617 * x
  */
-    __Pyx_TraceLine(1542,0,__PYX_ERR(0, 1542, __pyx_L1_error))
+    __Pyx_TraceLine(1634,0,__PYX_ERR(0, 1634, __pyx_L1_error))
     __pyx_v_h_Newt_22 = (6.341323676169617 * __pyx_v_x_phi);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1541
+    /* "pyseobnr/eob/waveform/waveform.pyx":1633
  *     cdef double beta112
  * 
  *     if quasi_circ == 1:             # <<<<<<<<<<<<<<
  *         h_Newt_22 = 6.341323676169617 * x_phi
  *     else:
  */
     goto __pyx_L3;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1544
+  /* "pyseobnr/eob/waveform/waveform.pyx":1636
  *         h_Newt_22 = 6.341323676169617 * x_phi
  *     else:
  *         h_Newt_22 = 6.341323676169617 * x             # <<<<<<<<<<<<<<
  * 
  *     T_22 = sqrt(
  */
-  __Pyx_TraceLine(1544,0,__PYX_ERR(0, 1544, __pyx_L1_error))
+  __Pyx_TraceLine(1636,0,__PYX_ERR(0, 1636, __pyx_L1_error))
   /*else*/ {
     __pyx_v_h_Newt_22 = (6.341323676169617 * __pyx_v_x);
   }
   __pyx_L3:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1548
+  /* "pyseobnr/eob/waveform/waveform.pyx":1640
  *     T_22 = sqrt(
  *         6.283185307179586 * H * x**(3./2)
  *         * (1. + 16. * H**2. * x**3.) * (4. + 16. * H**2. * x**3.)             # <<<<<<<<<<<<<<
  *         / (1. - np.exp(- 25.132741228718345 * H * x**(3./2)))
  *     )
  */
-  __Pyx_TraceLine(1548,0,__PYX_ERR(0, 1548, __pyx_L1_error))
-  __pyx_t_2 = PyFloat_FromDouble(((((6.283185307179586 * __pyx_v_H) * pow(__pyx_v_x, (3. / 2.0))) * (1. + ((16. * pow(__pyx_v_H, 2.)) * pow(__pyx_v_x, 3.)))) * (4. + ((16. * pow(__pyx_v_H, 2.)) * pow(__pyx_v_x, 3.))))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1548, __pyx_L1_error)
+  __Pyx_TraceLine(1640,0,__PYX_ERR(0, 1640, __pyx_L1_error))
+  __pyx_t_2 = PyFloat_FromDouble(((((6.283185307179586 * __pyx_v_H) * pow(__pyx_v_x, (3. / 2.0))) * (1. + ((16. * pow(__pyx_v_H, 2.)) * pow(__pyx_v_x, 3.)))) * (4. + ((16. * pow(__pyx_v_H, 2.)) * pow(__pyx_v_x, 3.))))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1640, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1549
+  /* "pyseobnr/eob/waveform/waveform.pyx":1641
  *         6.283185307179586 * H * x**(3./2)
  *         * (1. + 16. * H**2. * x**3.) * (4. + 16. * H**2. * x**3.)
  *         / (1. - np.exp(- 25.132741228718345 * H * x**(3./2)))             # <<<<<<<<<<<<<<
  *     )
  * 
  */
-  __Pyx_TraceLine(1549,0,__PYX_ERR(0, 1549, __pyx_L1_error))
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1549, __pyx_L1_error)
+  __Pyx_TraceLine(1641,0,__PYX_ERR(0, 1641, __pyx_L1_error))
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1641, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_exp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1549, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_exp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1641, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble(((-25.132741228718345 * __pyx_v_H) * pow(__pyx_v_x, (3. / 2.0)))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1549, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(((-25.132741228718345 * __pyx_v_H) * pow(__pyx_v_x, (3. / 2.0)))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1641, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_6 = NULL;
   __pyx_t_7 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
@@ -29142,985 +29200,985 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_4};
     __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1549, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1641, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
-  __pyx_t_5 = __Pyx_PyFloat_SubtractCObj(__pyx_float_1_, __pyx_t_3, 1., 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1549, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyFloat_SubtractCObj(__pyx_float_1_, __pyx_t_3, 1., 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1641, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1549, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1641, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_8 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1549, __pyx_L1_error)
+  __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_8 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1641, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1546
+  /* "pyseobnr/eob/waveform/waveform.pyx":1638
  *         h_Newt_22 = 6.341323676169617 * x
  * 
  *     T_22 = sqrt(             # <<<<<<<<<<<<<<
  *         6.283185307179586 * H * x**(3./2)
  *         * (1. + 16. * H**2. * x**3.) * (4. + 16. * H**2. * x**3.)
  */
-  __Pyx_TraceLine(1546,0,__PYX_ERR(0, 1546, __pyx_L1_error))
+  __Pyx_TraceLine(1638,0,__PYX_ERR(0, 1638, __pyx_L1_error))
   __pyx_v_T_22 = sqrt(__pyx_t_8);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1552
+  /* "pyseobnr/eob/waveform/waveform.pyx":1644
  *     )
  * 
  *     Heff = (H * H - 1.) / (2. * nu) + 1.             # <<<<<<<<<<<<<<
  * 
  *     expr1 = sqrt(1. - 4. * nu)
  */
-  __Pyx_TraceLine(1552,0,__PYX_ERR(0, 1552, __pyx_L1_error))
+  __Pyx_TraceLine(1644,0,__PYX_ERR(0, 1644, __pyx_L1_error))
   __pyx_v_Heff = ((((__pyx_v_H * __pyx_v_H) - 1.) / (2. * __pyx_v_nu)) + 1.);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1554
+  /* "pyseobnr/eob/waveform/waveform.pyx":1646
  *     Heff = (H * H - 1.) / (2. * nu) + 1.
  * 
  *     expr1 = sqrt(1. - 4. * nu)             # <<<<<<<<<<<<<<
  *     expr2 = chi_1 + chi_2
  * 
  */
-  __Pyx_TraceLine(1554,0,__PYX_ERR(0, 1554, __pyx_L1_error))
+  __Pyx_TraceLine(1646,0,__PYX_ERR(0, 1646, __pyx_L1_error))
   __pyx_v_expr1 = sqrt((1. - (4. * __pyx_v_nu)));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1555
+  /* "pyseobnr/eob/waveform/waveform.pyx":1647
  * 
  *     expr1 = sqrt(1. - 4. * nu)
  *     expr2 = chi_1 + chi_2             # <<<<<<<<<<<<<<
  * 
  *     a = (
  */
-  __Pyx_TraceLine(1555,0,__PYX_ERR(0, 1555, __pyx_L1_error))
+  __Pyx_TraceLine(1647,0,__PYX_ERR(0, 1647, __pyx_L1_error))
   __pyx_v_expr2 = (__pyx_v_chi_1 + __pyx_v_chi_2);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1559
+  /* "pyseobnr/eob/waveform/waveform.pyx":1651
  *     a = (
  *         (1. - 2. * nu) * expr2 / 2.
  *         + expr1 * (chi_1 - chi_2) / 2.             # <<<<<<<<<<<<<<
  *     )
  * 
  */
-  __Pyx_TraceLine(1559,0,__PYX_ERR(0, 1559, __pyx_L1_error))
+  __Pyx_TraceLine(1651,0,__PYX_ERR(0, 1651, __pyx_L1_error))
   __pyx_v_a = ((((1. - (2. * __pyx_v_nu)) * __pyx_v_expr2) / 2.) + ((__pyx_v_expr1 * (__pyx_v_chi_1 - __pyx_v_chi_2)) / 2.));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1562
+  /* "pyseobnr/eob/waveform/waveform.pyx":1654
  *     )
  * 
  *     expr3 = sqrt(1. - a**2)             # <<<<<<<<<<<<<<
  * 
  *     rho_22 = (
  */
-  __Pyx_TraceLine(1562,0,__PYX_ERR(0, 1562, __pyx_L1_error))
+  __Pyx_TraceLine(1654,0,__PYX_ERR(0, 1654, __pyx_L1_error))
   __pyx_v_expr3 = sqrt((1. - pow(__pyx_v_a, 2.0)));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1594
+  /* "pyseobnr/eob/waveform/waveform.pyx":1686
  *             + 4.173242630385488 * (1.9635100260214235 + 0.5 * log(x))
  *         ) * x**4
  *         + (             # <<<<<<<<<<<<<<
  *             -30.14143102836864
  *             + 7.916297736025627 * (1.9635100260214235 + 0.5 * log(x))
  */
-  __Pyx_TraceLine(1594,0,__PYX_ERR(0, 1594, __pyx_L1_error))
+  __Pyx_TraceLine(1686,0,__PYX_ERR(0, 1686, __pyx_L1_error))
   __pyx_v_rho_22 = ((((((((1. + ((-1.0238095238095237 + (0.6547619047619048 * __pyx_v_nu)) * __pyx_v_x)) - ((0.6666666666666666 * (((0.5 * __pyx_v_expr2) + ((0.5 * (__pyx_v_chi_1 - __pyx_v_chi_2)) * __pyx_v_expr1)) - ((0.5 * __pyx_v_expr2) * __pyx_v_nu))) * pow(__pyx_v_x, (3. / 2.0)))) + ((((-1.94208238851096 + (0.5 * (((0.25 * pow(__pyx_v_expr2, 2.0)) + (((0.5 * (__pyx_v_chi_1 - __pyx_v_chi_2)) * __pyx_v_expr2) * __pyx_v_expr1)) + ((0.25 * pow((__pyx_v_chi_1 - __pyx_v_chi_2), 2.0)) * (1. - (4. * __pyx_v_nu)))))) - (1.5601379440665155 * __pyx_v_nu)) + (0.4625614134542706 * pow(__pyx_v_nu, 2.0))) * pow(__pyx_v_x, 2.0))) - ((1.619047619047619 * __pyx_v_a) * pow(__pyx_v_x, (5. / 2.0)))) + (((1.1799571680524061 * __pyx_v_a) + (0.3333333333333333 * pow(__pyx_v_a, 3.0))) * pow(__pyx_v_x, (7. / 2.0)))) + ((((((12.736034731834051 + (0.3531746031746032 * pow(__pyx_v_a, 2.0))) - (2.902228713904598 * __pyx_v_nu)) - (1.9301558466099282 * pow(__pyx_v_nu, 2.0))) + (0.2715020968103451 * pow(__pyx_v_nu, 3.0))) - (4.076190476190476 * (1.9635100260214235 + (0.5 * log(__pyx_v_x))))) * pow(__pyx_v_x, 3.0))) + ((((-2.4172313935587004 + (0.8670162509448224 * pow(__pyx_v_a, 2.0))) - (0.125 * pow(__pyx_v_a, 4.0))) + (4.173242630385488 * (1.9635100260214235 + (0.5 * log(__pyx_v_x))))) * pow(__pyx_v_x, 4.0))) + ((-30.14143102836864 + (7.916297736025627 * (1.9635100260214235 + (0.5 * log(__pyx_v_x))))) * pow(__pyx_v_x, 5.0)));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1602
+  /* "pyseobnr/eob/waveform/waveform.pyx":1694
  *     dE_dt_22 = (
  *         nu**2. * x**3. * h_Newt_22**2. * Heff**2. * T_22**2. * rho_22**4.
  *         / 6.283185307179586             # <<<<<<<<<<<<<<
  *     )
  * 
  */
-  __Pyx_TraceLine(1602,0,__PYX_ERR(0, 1602, __pyx_L1_error))
+  __Pyx_TraceLine(1694,0,__PYX_ERR(0, 1694, __pyx_L1_error))
   __pyx_v_dE_dt_22 = ((((((pow(__pyx_v_nu, 2.) * pow(__pyx_v_x, 3.)) * pow(__pyx_v_h_Newt_22, 2.)) * pow(__pyx_v_Heff, 2.)) * pow(__pyx_v_T_22, 2.)) * pow(__pyx_v_rho_22, 4.)) / 6.283185307179586);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1607
+  /* "pyseobnr/eob/waveform/waveform.pyx":1699
  *     alpha52 = (
  *         -0.25 - 0.75 * a**2
  *         + expr3 * (-0.25 - 0.75 * a**2)             # <<<<<<<<<<<<<<
  *     )
  * 
  */
-  __Pyx_TraceLine(1607,0,__PYX_ERR(0, 1607, __pyx_L1_error))
+  __Pyx_TraceLine(1699,0,__PYX_ERR(0, 1699, __pyx_L1_error))
   __pyx_v_alpha52 = ((-0.25 - (0.75 * pow(__pyx_v_a, 2.0))) + (__pyx_v_expr3 * (-0.25 - (0.75 * pow(__pyx_v_a, 2.0)))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1610
+  /* "pyseobnr/eob/waveform/waveform.pyx":1702
  *     )
  * 
  *     alpha3 = 0.             # <<<<<<<<<<<<<<
  * 
  *     if beaming == 1:
  */
-  __Pyx_TraceLine(1610,0,__PYX_ERR(0, 1610, __pyx_L1_error))
+  __Pyx_TraceLine(1702,0,__PYX_ERR(0, 1702, __pyx_L1_error))
   __pyx_v_alpha3 = 0.;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1612
+  /* "pyseobnr/eob/waveform/waveform.pyx":1704
  *     alpha3 = 0.
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         alpha72 = (
  *             (-2.052827380952381 - 5.220982142857142 * a**2) * (1 + expr3)
  */
-  __Pyx_TraceLine(1612,0,__PYX_ERR(0, 1612, __pyx_L1_error))
+  __Pyx_TraceLine(1704,0,__PYX_ERR(0, 1704, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_beaming == 1);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1614
+    /* "pyseobnr/eob/waveform/waveform.pyx":1706
  *     if beaming == 1:
  *         alpha72 = (
  *             (-2.052827380952381 - 5.220982142857142 * a**2) * (1 + expr3)             # <<<<<<<<<<<<<<
  *         )
  *     else:
  */
-    __Pyx_TraceLine(1614,0,__PYX_ERR(0, 1614, __pyx_L1_error))
+    __Pyx_TraceLine(1706,0,__PYX_ERR(0, 1706, __pyx_L1_error))
     __pyx_v_alpha72 = ((-2.052827380952381 - (5.220982142857142 * pow(__pyx_v_a, 2.0))) * (1.0 + __pyx_v_expr3));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1612
+    /* "pyseobnr/eob/waveform/waveform.pyx":1704
  *     alpha3 = 0.
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         alpha72 = (
  *             (-2.052827380952381 - 5.220982142857142 * a**2) * (1 + expr3)
  */
     goto __pyx_L4;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1618
+  /* "pyseobnr/eob/waveform/waveform.pyx":1710
  *     else:
  *         alpha72 = (
  *             (-1.927827380952381 - 4.845982142857142 * a**2) * (1 + expr3)             # <<<<<<<<<<<<<<
  *         )
  * 
  */
-  __Pyx_TraceLine(1618,0,__PYX_ERR(0, 1618, __pyx_L1_error))
+  __Pyx_TraceLine(1710,0,__PYX_ERR(0, 1710, __pyx_L1_error))
   /*else*/ {
     __pyx_v_alpha72 = ((-1.927827380952381 - (4.845982142857142 * pow(__pyx_v_a, 2.0))) * (1.0 + __pyx_v_expr3));
   }
   __pyx_L4:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1621
+  /* "pyseobnr/eob/waveform/waveform.pyx":1713
  *         )
  * 
  *     tanh_2pia = tanh(6.283185307179586 * a / expr3)             # <<<<<<<<<<<<<<
  * 
  *     if a != 0:
  */
-  __Pyx_TraceLine(1621,0,__PYX_ERR(0, 1621, __pyx_L1_error))
+  __Pyx_TraceLine(1713,0,__PYX_ERR(0, 1713, __pyx_L1_error))
   __pyx_v_tanh_2pia = tanh(((6.283185307179586 * __pyx_v_a) / __pyx_v_expr3));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1623
+  /* "pyseobnr/eob/waveform/waveform.pyx":1715
  *     tanh_2pia = tanh(6.283185307179586 * a / expr3)
  * 
  *     if a != 0:             # <<<<<<<<<<<<<<
  *         alpha4 = (
  *             3.141592653589793 - 0.5 / a
  */
-  __Pyx_TraceLine(1623,0,__PYX_ERR(0, 1623, __pyx_L1_error))
+  __Pyx_TraceLine(1715,0,__PYX_ERR(0, 1715, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_a != 0.0);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1631
+    /* "pyseobnr/eob/waveform/waveform.pyx":1723
  *                 9.42477796076938 + 9.42477796076938 / tanh_2pia
  *             ) * a**2
  *             + expr3 * (             # <<<<<<<<<<<<<<
  *                 3.141592653589793 - 0.5 / a
  *                 + 2.145833333333333 * a - 2.3125 * a**3
  */
-    __Pyx_TraceLine(1631,0,__PYX_ERR(0, 1631, __pyx_L1_error))
+    __Pyx_TraceLine(1723,0,__PYX_ERR(0, 1723, __pyx_L1_error))
     __pyx_v_alpha4 = ((((((3.141592653589793 - (0.5 / __pyx_v_a)) + (2.645833333333333 * __pyx_v_a)) - (0.8125 * pow(__pyx_v_a, 3.0))) + (3.141592653589793 / __pyx_v_tanh_2pia)) + ((9.42477796076938 + (9.42477796076938 / __pyx_v_tanh_2pia)) * pow(__pyx_v_a, 2.0))) + (__pyx_v_expr3 * (((((3.141592653589793 - (0.5 / __pyx_v_a)) + (2.145833333333333 * __pyx_v_a)) - (2.3125 * pow(__pyx_v_a, 3.0))) + (3.141592653589793 / __pyx_v_tanh_2pia)) + (pow(__pyx_v_a, 2.0) * (9.42477796076938 + (9.42477796076938 / __pyx_v_tanh_2pia))))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1623
+    /* "pyseobnr/eob/waveform/waveform.pyx":1715
  *     tanh_2pia = tanh(6.283185307179586 * a / expr3)
  * 
  *     if a != 0:             # <<<<<<<<<<<<<<
  *         alpha4 = (
  *             3.141592653589793 - 0.5 / a
  */
     goto __pyx_L5;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1642
+  /* "pyseobnr/eob/waveform/waveform.pyx":1734
  *         )
  *     else:
  *         alpha4 = 6.283185307179586             # <<<<<<<<<<<<<<
  * 
  *     if beaming == 1:
  */
-  __Pyx_TraceLine(1642,0,__PYX_ERR(0, 1642, __pyx_L1_error))
+  __Pyx_TraceLine(1734,0,__PYX_ERR(0, 1734, __pyx_L1_error))
   /*else*/ {
     __pyx_v_alpha4 = 6.283185307179586;
   }
   __pyx_L5:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1644
+  /* "pyseobnr/eob/waveform/waveform.pyx":1736
  *         alpha4 = 6.283185307179586
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         alpha92 = (
  *             -15.47802525234631 - 37.38403855465798 * a**2
  */
-  __Pyx_TraceLine(1644,0,__PYX_ERR(0, 1644, __pyx_L1_error))
+  __Pyx_TraceLine(1736,0,__PYX_ERR(0, 1736, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_beaming == 1);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1648
+    /* "pyseobnr/eob/waveform/waveform.pyx":1740
  *             -15.47802525234631 - 37.38403855465798 * a**2
  *             + 1.2433035714285716 * a**4
  *         ) * (1 + expr3)             # <<<<<<<<<<<<<<
  *     else:
  *         alpha92 = (
  */
-    __Pyx_TraceLine(1648,0,__PYX_ERR(0, 1648, __pyx_L1_error))
+    __Pyx_TraceLine(1740,0,__PYX_ERR(0, 1740, __pyx_L1_error))
     __pyx_v_alpha92 = (((-15.47802525234631 - (37.38403855465798 * pow(__pyx_v_a, 2.0))) + (1.2433035714285716 * pow(__pyx_v_a, 4.0))) * (1.0 + __pyx_v_expr3));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1644
+    /* "pyseobnr/eob/waveform/waveform.pyx":1736
  *         alpha4 = 6.283185307179586
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         alpha92 = (
  *             -15.47802525234631 - 37.38403855465798 * a**2
  */
     goto __pyx_L6;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1653
+  /* "pyseobnr/eob/waveform/waveform.pyx":1745
  *             -14.52973656187012 - 35.00792248322941 * a**2
  *             + 1.2433035714285716 * a**4
  *         ) * (1 + expr3)             # <<<<<<<<<<<<<<
  * 
  *     if beaming == 1:
  */
-  __Pyx_TraceLine(1653,0,__PYX_ERR(0, 1653, __pyx_L1_error))
+  __Pyx_TraceLine(1745,0,__PYX_ERR(0, 1745, __pyx_L1_error))
   /*else*/ {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1652
+    /* "pyseobnr/eob/waveform/waveform.pyx":1744
  *         alpha92 = (
  *             -14.52973656187012 - 35.00792248322941 * a**2
  *             + 1.2433035714285716 * a**4             # <<<<<<<<<<<<<<
  *         ) * (1 + expr3)
  * 
  */
-    __Pyx_TraceLine(1652,0,__PYX_ERR(0, 1652, __pyx_L1_error))
+    __Pyx_TraceLine(1744,0,__PYX_ERR(0, 1744, __pyx_L1_error))
     __pyx_v_alpha92 = (((-14.52973656187012 - (35.00792248322941 * pow(__pyx_v_a, 2.0))) + (1.2433035714285716 * pow(__pyx_v_a, 4.0))) * (1.0 + __pyx_v_expr3));
   }
   __pyx_L6:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1655
+  /* "pyseobnr/eob/waveform/waveform.pyx":1747
  *         ) * (1 + expr3)
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         if a != 0:
  *             tanh_pia = tanh(3.141592653589793 * a / expr3)
  */
-  __Pyx_TraceLine(1655,0,__PYX_ERR(0, 1655, __pyx_L1_error))
+  __Pyx_TraceLine(1747,0,__PYX_ERR(0, 1747, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_beaming == 1);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1656
+    /* "pyseobnr/eob/waveform/waveform.pyx":1748
  * 
  *     if beaming == 1:
  *         if a != 0:             # <<<<<<<<<<<<<<
  *             tanh_pia = tanh(3.141592653589793 * a / expr3)
  * 
  */
-    __Pyx_TraceLine(1656,0,__PYX_ERR(0, 1656, __pyx_L1_error))
+    __Pyx_TraceLine(1748,0,__PYX_ERR(0, 1748, __pyx_L1_error))
     __pyx_t_1 = (__pyx_v_a != 0.0);
     if (__pyx_t_1) {
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1657
+      /* "pyseobnr/eob/waveform/waveform.pyx":1749
  *     if beaming == 1:
  *         if a != 0:
  *             tanh_pia = tanh(3.141592653589793 * a / expr3)             # <<<<<<<<<<<<<<
  * 
  *             alpha5 = (
  */
-      __Pyx_TraceLine(1657,0,__PYX_ERR(0, 1657, __pyx_L1_error))
+      __Pyx_TraceLine(1749,0,__PYX_ERR(0, 1749, __pyx_L1_error))
       __pyx_v_tanh_pia = tanh(((3.141592653589793 * __pyx_v_a) / __pyx_v_expr3));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1670
+      /* "pyseobnr/eob/waveform/waveform.pyx":1762
  *                     + 274034.84398733045 * tanh_pia
  *                 )
  *                 + expr3 * (             # <<<<<<<<<<<<<<
  *                     -4.105654761904762 / a + 12.271701388888888 * a
  *                     - 30.7890625 * a**3
  */
-      __Pyx_TraceLine(1670,0,__PYX_ERR(0, 1670, __pyx_L1_error))
+      __Pyx_TraceLine(1762,0,__PYX_ERR(0, 1762, __pyx_L1_error))
       __pyx_v_alpha5 = ((((((-4.105654761904762 / __pyx_v_a) + (16.37735615079365 * __pyx_v_a)) - (20.34709821428571 * pow(__pyx_v_a, 3.0))) + (0.0001240079365079365 * ((224846.92781007508 + (104011.84957505087 / __pyx_v_tanh_pia)) + (91344.94799577682 * __pyx_v_tanh_pia)))) + ((0.0001240079365079365 * pow(__pyx_v_a, 2.0)) * ((579539.02158567 + (264534.66780287493 / __pyx_v_tanh_pia)) + (274034.84398733045 * __pyx_v_tanh_pia)))) + (__pyx_v_expr3 * (((((-4.105654761904762 / __pyx_v_a) + (12.271701388888888 * __pyx_v_a)) - (30.7890625 * pow(__pyx_v_a, 3.0))) + (0.0001240079365079365 * ((224846.92781007508 + (104011.84957505087 / __pyx_v_tanh_pia)) + (91344.94799577682 * __pyx_v_tanh_pia)))) + ((0.0001240079365079365 * pow(__pyx_v_a, 2.0)) * ((579539.02158567 + (264534.66780287493 / __pyx_v_tanh_pia)) + (274034.84398733045 * __pyx_v_tanh_pia))))));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1656
+      /* "pyseobnr/eob/waveform/waveform.pyx":1748
  * 
  *     if beaming == 1:
  *         if a != 0:             # <<<<<<<<<<<<<<
  *             tanh_pia = tanh(3.141592653589793 * a / expr3)
  * 
  */
       goto __pyx_L8;
     }
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1684
+    /* "pyseobnr/eob/waveform/waveform.pyx":1776
  *             )
  *         else:
  *             alpha5 = 55.7656070957528             # <<<<<<<<<<<<<<
  *     else:
  *         if a != 0:
  */
-    __Pyx_TraceLine(1684,0,__PYX_ERR(0, 1684, __pyx_L1_error))
+    __Pyx_TraceLine(1776,0,__PYX_ERR(0, 1776, __pyx_L1_error))
     /*else*/ {
       __pyx_v_alpha5 = 55.7656070957528;
     }
     __pyx_L8:;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1655
+    /* "pyseobnr/eob/waveform/waveform.pyx":1747
  *         ) * (1 + expr3)
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         if a != 0:
  *             tanh_pia = tanh(3.141592653589793 * a / expr3)
  */
     goto __pyx_L7;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1686
+  /* "pyseobnr/eob/waveform/waveform.pyx":1778
  *             alpha5 = 55.7656070957528
  *     else:
  *         if a != 0:             # <<<<<<<<<<<<<<
  *             sinh_2pia = sinh(6.283185307179586 * a / expr3)
  * 
  */
-  __Pyx_TraceLine(1686,0,__PYX_ERR(0, 1686, __pyx_L1_error))
+  __Pyx_TraceLine(1778,0,__PYX_ERR(0, 1778, __pyx_L1_error))
   /*else*/ {
     __pyx_t_1 = (__pyx_v_a != 0.0);
     if (__pyx_t_1) {
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1687
+      /* "pyseobnr/eob/waveform/waveform.pyx":1779
  *     else:
  *         if a != 0:
  *             sinh_2pia = sinh(6.283185307179586 * a / expr3)             # <<<<<<<<<<<<<<
  * 
  *             alpha5 = (
  */
-      __Pyx_TraceLine(1687,0,__PYX_ERR(0, 1687, __pyx_L1_error))
+      __Pyx_TraceLine(1779,0,__PYX_ERR(0, 1779, __pyx_L1_error))
       __pyx_v_sinh_2pia = sinh(((6.283185307179586 * __pyx_v_a) / __pyx_v_expr3));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1700
+      /* "pyseobnr/eob/waveform/waveform.pyx":1792
  *                     + 12666.901579274047 / sinh_2pia
  *                 )
  *                 + expr3 * (             # <<<<<<<<<<<<<<
  *                     - 3.855654761904762 / a + 11.532118055555555 * a
  *                     - 28.6328125 * a**3
  */
-      __Pyx_TraceLine(1700,0,__PYX_ERR(0, 1700, __pyx_L1_error))
+      __Pyx_TraceLine(1792,0,__PYX_ERR(0, 1792, __pyx_L1_error))
       __pyx_v_alpha5 = ((((((-3.855654761904762 / __pyx_v_a) + (15.387772817460316 * __pyx_v_a)) - (18.94084821428571 * pow(__pyx_v_a, 3.0))) + ((0.0001240079365079365 * pow(__pyx_v_a, 2.0)) * ((541538.3168478478 + (500568.80705238326 / __pyx_v_tanh_2pia)) - (9500.176184455535 / __pyx_v_sinh_2pia)))) + (0.0001240079365079365 * ((212180.02623080104 + (182689.89599155364 / __pyx_v_tanh_2pia)) + (12666.901579274047 / __pyx_v_sinh_2pia)))) + (__pyx_v_expr3 * (((((-3.855654761904762 / __pyx_v_a) + (11.532118055555555 * __pyx_v_a)) - (28.6328125 * pow(__pyx_v_a, 3.0))) + ((0.0001240079365079365 * pow(__pyx_v_a, 2.0)) * ((541538.3168478478 + (500568.80705238326 / __pyx_v_tanh_2pia)) - (9500.176184455535 / __pyx_v_sinh_2pia)))) + (0.0001240079365079365 * ((212180.02623080104 + (182689.89599155364 / __pyx_v_tanh_2pia)) + (12666.901579274047 / __pyx_v_sinh_2pia))))));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":1686
+      /* "pyseobnr/eob/waveform/waveform.pyx":1778
  *             alpha5 = 55.7656070957528
  *     else:
  *         if a != 0:             # <<<<<<<<<<<<<<
  *             sinh_2pia = sinh(6.283185307179586 * a / expr3)
  * 
  */
       goto __pyx_L9;
     }
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1714
+    /* "pyseobnr/eob/waveform/waveform.pyx":1806
  *             )
  *         else:
  *             alpha5 = 52.6240144421630             # <<<<<<<<<<<<<<
  * 
- *     #alpha = 1. + (a / (1. + expr3) - 2. * x**(3./2)) * (
+ *     # alpha = 1. + (a / (1. + expr3) - 2. * x**(3./2)) * (
  */
-    __Pyx_TraceLine(1714,0,__PYX_ERR(0, 1714, __pyx_L1_error))
+    __Pyx_TraceLine(1806,0,__PYX_ERR(0, 1806, __pyx_L1_error))
     /*else*/ {
       __pyx_v_alpha5 = 52.6240144421630;
     }
     __pyx_L9:;
   }
   __pyx_L7:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1725
- *     #)
+  /* "pyseobnr/eob/waveform/waveform.pyx":1817
+ *     # )
  * 
  *     alpha = 1.             # <<<<<<<<<<<<<<
  * 
  *     beta12 = 0.
  */
-  __Pyx_TraceLine(1725,0,__PYX_ERR(0, 1725, __pyx_L1_error))
+  __Pyx_TraceLine(1817,0,__PYX_ERR(0, 1817, __pyx_L1_error))
   __pyx_v_alpha = 1.;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1727
+  /* "pyseobnr/eob/waveform/waveform.pyx":1819
  *     alpha = 1.
  * 
  *     beta12 = 0.             # <<<<<<<<<<<<<<
  * 
  *     if beaming == 1:
  */
-  __Pyx_TraceLine(1727,0,__PYX_ERR(0, 1727, __pyx_L1_error))
+  __Pyx_TraceLine(1819,0,__PYX_ERR(0, 1819, __pyx_L1_error))
   __pyx_v_beta12 = 0.;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1729
+  /* "pyseobnr/eob/waveform/waveform.pyx":1821
  *     beta12 = 0.
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta1 = 0.47098214285714285 - 1.3839285714285714 * nu
  *     else:
  */
-  __Pyx_TraceLine(1729,0,__PYX_ERR(0, 1729, __pyx_L1_error))
+  __Pyx_TraceLine(1821,0,__PYX_ERR(0, 1821, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_beaming == 1);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1730
+    /* "pyseobnr/eob/waveform/waveform.pyx":1822
  * 
  *     if beaming == 1:
  *         beta1 = 0.47098214285714285 - 1.3839285714285714 * nu             # <<<<<<<<<<<<<<
  *     else:
  *         beta1 = 0.34598214285714285 - 1.3839285714285714 * nu
  */
-    __Pyx_TraceLine(1730,0,__PYX_ERR(0, 1730, __pyx_L1_error))
+    __Pyx_TraceLine(1822,0,__PYX_ERR(0, 1822, __pyx_L1_error))
     __pyx_v_beta1 = (0.47098214285714285 - (1.3839285714285714 * __pyx_v_nu));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1729
+    /* "pyseobnr/eob/waveform/waveform.pyx":1821
  *     beta12 = 0.
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta1 = 0.47098214285714285 - 1.3839285714285714 * nu
  *     else:
  */
     goto __pyx_L10;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1732
+  /* "pyseobnr/eob/waveform/waveform.pyx":1824
  *         beta1 = 0.47098214285714285 - 1.3839285714285714 * nu
  *     else:
  *         beta1 = 0.34598214285714285 - 1.3839285714285714 * nu             # <<<<<<<<<<<<<<
  * 
  *     beta32 = (
  */
-  __Pyx_TraceLine(1732,0,__PYX_ERR(0, 1732, __pyx_L1_error))
+  __Pyx_TraceLine(1824,0,__PYX_ERR(0, 1824, __pyx_L1_error))
   /*else*/ {
     __pyx_v_beta1 = (0.34598214285714285 - (1.3839285714285714 * __pyx_v_nu));
   }
   __pyx_L10:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1737
+  /* "pyseobnr/eob/waveform/waveform.pyx":1829
  *         - 0.010416666666666666 * (chi_1 + chi_2)
  *         - 0.010416666666666666 * (chi_1 - chi_2) * expr1
  *         + 0.041666666666666664 * (chi_1 + chi_2) * nu             # <<<<<<<<<<<<<<
  *     )
  * 
  */
-  __Pyx_TraceLine(1737,0,__PYX_ERR(0, 1737, __pyx_L1_error))
+  __Pyx_TraceLine(1829,0,__PYX_ERR(0, 1829, __pyx_L1_error))
   __pyx_v_beta32 = (((-0.010416666666666666 * (__pyx_v_chi_1 + __pyx_v_chi_2)) - ((0.010416666666666666 * (__pyx_v_chi_1 - __pyx_v_chi_2)) * __pyx_v_expr1)) + ((0.041666666666666664 * (__pyx_v_chi_1 + __pyx_v_chi_2)) * __pyx_v_nu));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1740
+  /* "pyseobnr/eob/waveform/waveform.pyx":1832
  *     )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta2 = (
  *             -0.5486301490358875
  */
-  __Pyx_TraceLine(1740,0,__PYX_ERR(0, 1740, __pyx_L1_error))
+  __Pyx_TraceLine(1832,0,__PYX_ERR(0, 1832, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_beaming == 1);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1755
+    /* "pyseobnr/eob/waveform/waveform.pyx":1847
  *                 + 0.484375 * chi_2**2 - 0.5 * CES22 * chi_2**2
  *             ) * nu
  *             + 0.5488340301398337 * nu**2             # <<<<<<<<<<<<<<
  *         )
  *     else:
  */
-    __Pyx_TraceLine(1755,0,__PYX_ERR(0, 1755, __pyx_L1_error))
+    __Pyx_TraceLine(1847,0,__PYX_ERR(0, 1847, __pyx_L1_error))
     __pyx_v_beta2 = ((((((((((-0.5486301490358875 - (0.2421875 * pow(__pyx_v_chi_1, 2.0))) + ((0.25 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0))) - (0.2421875 * pow(__pyx_v_chi_2, 2.0))) + ((0.25 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0))) - ((0.2421875 * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_expr1)) + (((0.25 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_expr1)) + ((0.2421875 * pow(__pyx_v_chi_2, 2.0)) * __pyx_v_expr1)) - (((0.25 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0)) * __pyx_v_expr1)) + ((((((2.005527949026833 + (0.484375 * pow(__pyx_v_chi_1, 2.0))) - ((0.5 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0))) - ((0.03125 * __pyx_v_chi_1) * __pyx_v_chi_2)) + (0.484375 * pow(__pyx_v_chi_2, 2.0))) - ((0.5 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0))) * __pyx_v_nu)) + (0.5488340301398337 * pow(__pyx_v_nu, 2.0)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1740
+    /* "pyseobnr/eob/waveform/waveform.pyx":1832
  *     )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta2 = (
  *             -0.5486301490358875
  */
     goto __pyx_L11;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1772
+  /* "pyseobnr/eob/waveform/waveform.pyx":1864
  *                 + 0.484375 * chi_2**2 - 0.5 * CES22 * chi_2**2
  *             ) * nu
  *             + 0.5488340301398338 * nu**2             # <<<<<<<<<<<<<<
  *         )
  * 
  */
-  __Pyx_TraceLine(1772,0,__PYX_ERR(0, 1772, __pyx_L1_error))
+  __Pyx_TraceLine(1864,0,__PYX_ERR(0, 1864, __pyx_L1_error))
   /*else*/ {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1766
+    /* "pyseobnr/eob/waveform/waveform.pyx":1858
  *             + 0.2421875 * chi_2**2 * expr1
  *             - 0.25 * CES22 * chi_2**2 * expr1
  *             + (             # <<<<<<<<<<<<<<
  *                 2.220185687122071
  *                 + 0.484375 * chi_1**2 - 0.5 * CES21 * chi_1**2
  */
-    __Pyx_TraceLine(1766,0,__PYX_ERR(0, 1766, __pyx_L1_error))
+    __Pyx_TraceLine(1858,0,__PYX_ERR(0, 1858, __pyx_L1_error))
     __pyx_v_beta2 = ((((((((((-0.5528154168930304 - (0.2421875 * pow(__pyx_v_chi_1, 2.0))) + ((0.25 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0))) - (0.2421875 * pow(__pyx_v_chi_2, 2.0))) + ((0.25 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0))) - ((0.2421875 * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_expr1)) + (((0.25 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_expr1)) + ((0.2421875 * pow(__pyx_v_chi_2, 2.0)) * __pyx_v_expr1)) - (((0.25 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0)) * __pyx_v_expr1)) + ((((((2.220185687122071 + (0.484375 * pow(__pyx_v_chi_1, 2.0))) - ((0.5 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0))) - ((0.03125 * __pyx_v_chi_1) * __pyx_v_chi_2)) + (0.484375 * pow(__pyx_v_chi_2, 2.0))) - ((0.5 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0))) * __pyx_v_nu)) + (0.5488340301398338 * pow(__pyx_v_nu, 2.0)));
   }
   __pyx_L11:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1775
+  /* "pyseobnr/eob/waveform/waveform.pyx":1867
  *         )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta52 = (
  *             2.086213871524472
  */
-  __Pyx_TraceLine(1775,0,__PYX_ERR(0, 1775, __pyx_L1_error))
+  __Pyx_TraceLine(1867,0,__PYX_ERR(0, 1867, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_beaming == 1);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1785
+    /* "pyseobnr/eob/waveform/waveform.pyx":1877
  *                 + (1.2275855654761905 * chi_1 - 1.2275855654761905 * chi_2) * expr1
  *             ) * nu
  *             + (-0.9262152777777778 * chi_1 - 0.9262152777777778 * chi_2) * nu**2             # <<<<<<<<<<<<<<
  *         )
  *     else:
  */
-    __Pyx_TraceLine(1785,0,__PYX_ERR(0, 1785, __pyx_L1_error))
+    __Pyx_TraceLine(1877,0,__PYX_ERR(0, 1877, __pyx_L1_error))
     __pyx_v_beta52 = (((((2.086213871524472 - (0.09081256200396826 * __pyx_v_chi_1)) - (0.09081256200396826 * __pyx_v_chi_2)) + (((-0.09081256200396826 * __pyx_v_chi_1) + (0.09081256200396826 * __pyx_v_chi_2)) * __pyx_v_expr1)) + ((((-8.344855486097888 + (1.1473834325396826 * __pyx_v_chi_1)) + (1.1473834325396826 * __pyx_v_chi_2)) + (((1.2275855654761905 * __pyx_v_chi_1) - (1.2275855654761905 * __pyx_v_chi_2)) * __pyx_v_expr1)) * __pyx_v_nu)) + (((-0.9262152777777778 * __pyx_v_chi_1) - (0.9262152777777778 * __pyx_v_chi_2)) * pow(__pyx_v_nu, 2.0)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1775
+    /* "pyseobnr/eob/waveform/waveform.pyx":1867
  *         )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta52 = (
  *             2.086213871524472
  */
     goto __pyx_L12;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1797
+  /* "pyseobnr/eob/waveform/waveform.pyx":1889
  *                 + (1.2275855654761905 * chi_1 - 1.2275855654761905 * chi_2) * expr1
  *             ) * nu
  *             + (-0.9262152777777777 * chi_1 - 0.9262152777777777 * chi_2) * nu**2             # <<<<<<<<<<<<<<
  *         )
  * 
  */
-  __Pyx_TraceLine(1797,0,__PYX_ERR(0, 1797, __pyx_L1_error))
+  __Pyx_TraceLine(1889,0,__PYX_ERR(0, 1889, __pyx_L1_error))
   /*else*/ {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1792
+    /* "pyseobnr/eob/waveform/waveform.pyx":1884
  *             - 0.25617714533730157 * chi_1 - 0.25617714533730157 * chi_2
  *             + (-0.25617714533730157 * chi_1 + 0.25617714533730157 * chi_2) * expr1
  *             + (             # <<<<<<<<<<<<<<
  *                 -8.344855486097888
  *                 + 1.2255084325396826 * chi_1 + 1.2255084325396826 * chi_2
  */
-    __Pyx_TraceLine(1792,0,__PYX_ERR(0, 1792, __pyx_L1_error))
+    __Pyx_TraceLine(1884,0,__PYX_ERR(0, 1884, __pyx_L1_error))
     __pyx_v_beta52 = (((((2.086213871524472 - (0.25617714533730157 * __pyx_v_chi_1)) - (0.25617714533730157 * __pyx_v_chi_2)) + (((-0.25617714533730157 * __pyx_v_chi_1) + (0.25617714533730157 * __pyx_v_chi_2)) * __pyx_v_expr1)) + ((((-8.344855486097888 + (1.2255084325396826 * __pyx_v_chi_1)) + (1.2255084325396826 * __pyx_v_chi_2)) + (((1.2275855654761905 * __pyx_v_chi_1) - (1.2275855654761905 * __pyx_v_chi_2)) * __pyx_v_expr1)) * __pyx_v_nu)) + (((-0.9262152777777777 * __pyx_v_chi_1) - (0.9262152777777777 * __pyx_v_chi_2)) * pow(__pyx_v_nu, 2.0)));
   }
   __pyx_L12:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1800
+  /* "pyseobnr/eob/waveform/waveform.pyx":1892
  *         )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta3 = (
  *             - 2.128113388455193
  */
-  __Pyx_TraceLine(1800,0,__PYX_ERR(0, 1800, __pyx_L1_error))
+  __Pyx_TraceLine(1892,0,__PYX_ERR(0, 1892, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_beaming == 1);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1841
+    /* "pyseobnr/eob/waveform/waveform.pyx":1933
  *                 + 1.9211309523809523 * CES22 * chi_2**2
  *             ) * nu**2
  *             + 0.029224860174085567 * nu**3             # <<<<<<<<<<<<<<
  *         )
  *     else:
  */
-    __Pyx_TraceLine(1841,0,__PYX_ERR(0, 1841, __pyx_L1_error))
+    __Pyx_TraceLine(1933,0,__PYX_ERR(0, 1933, __pyx_L1_error))
     __pyx_v_beta3 = ((((((((((-2.128113388455193 + (0.06544984694978735 * __pyx_v_chi_1)) - (0.7453671409970238 * pow(__pyx_v_chi_1, 2.0))) + ((0.8759300595238095 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0))) + (0.06544984694978735 * __pyx_v_chi_2)) - (0.7453671409970238 * pow(__pyx_v_chi_2, 2.0))) + ((0.8759300595238095 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0))) + (((((((0.06544984694978735 * __pyx_v_chi_1) - (0.7453671409970238 * pow(__pyx_v_chi_1, 2.0))) + ((0.8759300595238095 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0))) - (0.06544984694978735 * __pyx_v_chi_2)) + (0.7453671409970238 * pow(__pyx_v_chi_2, 2.0))) - ((0.8759300595238095 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0))) * __pyx_v_expr1)) + (((((((((6.7228991308382025 - (0.2617993877991494 * __pyx_v_chi_1)) + (1.9449831039186507 * pow(__pyx_v_chi_1, 2.0))) - ((3.3530505952380953 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0))) - (0.2617993877991494 * __pyx_v_chi_2)) - ((0.9156048487103174 * __pyx_v_chi_1) * __pyx_v_chi_2)) + (1.9449831039186507 * pow(__pyx_v_chi_2, 2.0))) - ((3.3530505952380953 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0))) + (((((0.4542488219246032 * pow(__pyx_v_chi_1, 2.0)) - ((1.6011904761904763 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0))) - (0.4542488219246032 * pow(__pyx_v_chi_2, 2.0))) + ((1.6011904761904763 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0))) * __pyx_v_expr1)) * __pyx_v_nu)) + ((((((-1.4791500204153913 - (1.020600818452381 * pow(__pyx_v_chi_1, 2.0))) + ((1.9211309523809523 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0))) - ((1.8060825892857142 * __pyx_v_chi_1) * __pyx_v_chi_2)) - (1.020600818452381 * pow(__pyx_v_chi_2, 2.0))) + ((1.9211309523809523 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0))) * pow(__pyx_v_nu, 2.0))) + (0.029224860174085567 * pow(__pyx_v_nu, 3.0)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1800
+    /* "pyseobnr/eob/waveform/waveform.pyx":1892
  *         )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta3 = (
  *             - 2.128113388455193
  */
     goto __pyx_L13;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1884
+  /* "pyseobnr/eob/waveform/waveform.pyx":1976
  *                 + 1.9211309523809523 * CES22 * chi_2**2
  *             ) * nu**2
  *             + 0.02922486017408557 * nu**3             # <<<<<<<<<<<<<<
  *         )
  * 
  */
-  __Pyx_TraceLine(1884,0,__PYX_ERR(0, 1884, __pyx_L1_error))
+  __Pyx_TraceLine(1976,0,__PYX_ERR(0, 1976, __pyx_L1_error))
   /*else*/ {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1876
+    /* "pyseobnr/eob/waveform/waveform.pyx":1968
  *                 ) * expr1
  *             ) * nu
  *             + (             # <<<<<<<<<<<<<<
  *                 - 1.6054179646590612
  *                 - 1.020600818452381 * chi_1**2
  */
-    __Pyx_TraceLine(1876,0,__PYX_ERR(0, 1876, __pyx_L1_error))
+    __Pyx_TraceLine(1968,0,__PYX_ERR(0, 1968, __pyx_L1_error))
     __pyx_v_beta3 = ((((((((((-1.5673064297215402 + (0.06544984694978737 * __pyx_v_chi_1)) - (0.7150937034970238 * pow(__pyx_v_chi_1, 2.0))) + ((0.9071800595238094 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0))) + (0.06544984694978737 * __pyx_v_chi_2)) - (0.7150937034970238 * pow(__pyx_v_chi_2, 2.0))) + ((0.9071800595238094 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0))) + (((((((0.06544984694978735 * __pyx_v_chi_1) - (0.7150937034970237 * pow(__pyx_v_chi_1, 2.0))) + ((0.9071800595238094 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0))) - (0.06544984694978735 * __pyx_v_chi_2)) + (0.7150937034970237 * pow(__pyx_v_chi_2, 2.0))) - ((0.9071800595238094 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0))) * __pyx_v_expr1)) + (((((((((6.0984404660788964 - (0.26179938779914946 * __pyx_v_chi_1)) + (1.884436228918651 * pow(__pyx_v_chi_1, 2.0))) - ((3.415550595238095 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0))) - (0.26179938779914946 * __pyx_v_chi_2)) - ((0.6616985987103176 * __pyx_v_chi_1) * __pyx_v_chi_2)) + (1.884436228918651 * pow(__pyx_v_chi_2, 2.0))) - ((3.415550595238095 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0))) + (((((0.45424882192460314 * pow(__pyx_v_chi_1, 2.0)) - ((1.601190476190476 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0))) - (0.45424882192460314 * pow(__pyx_v_chi_2, 2.0))) + ((1.601190476190476 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0))) * __pyx_v_expr1)) * __pyx_v_nu)) + ((((((-1.6054179646590612 - (1.020600818452381 * pow(__pyx_v_chi_1, 2.0))) + ((1.9211309523809523 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0))) - ((1.8060825892857144 * __pyx_v_chi_1) * __pyx_v_chi_2)) - (1.020600818452381 * pow(__pyx_v_chi_2, 2.0))) + ((1.9211309523809523 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 2.0))) * pow(__pyx_v_nu, 2.0))) + (0.02922486017408557 * pow(__pyx_v_nu, 3.0)));
   }
   __pyx_L13:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1887
+  /* "pyseobnr/eob/waveform/waveform.pyx":1979
  *         )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta72 = (
  *             - 1.169026602968159
  */
-  __Pyx_TraceLine(1887,0,__PYX_ERR(0, 1887, __pyx_L1_error))
+  __Pyx_TraceLine(1979,0,__PYX_ERR(0, 1979, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_beaming == 1);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1943
+    /* "pyseobnr/eob/waveform/waveform.pyx":2035
  *                 ) * expr1
  *             ) * nu**2
  *             + (             # <<<<<<<<<<<<<<
  *                 1.8834442884503337 * chi_1 + 0.3333333333333333 * chi_1**3
  *                 + 0.08333333333333333 * CES21 * chi_1**3 + 0.08333333333333333 * CES22 * chi_1**3
  */
-    __Pyx_TraceLine(1943,0,__PYX_ERR(0, 1943, __pyx_L1_error))
+    __Pyx_TraceLine(2035,0,__PYX_ERR(0, 2035, __pyx_L1_error))
     __pyx_v_beta72 = ((((((((((((((-1.169026602968159 + (0.06236510029705724 * __pyx_v_chi_1)) - (0.04908738521234052 * pow(__pyx_v_chi_1, 2.0))) - (0.3328450520833333 * pow(__pyx_v_chi_1, 3.0))) + ((0.8385416666666666 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 3.0))) - ((0.5 * __pyx_v_CES31) * pow(__pyx_v_chi_1, 3.0))) + (0.06236510029705724 * __pyx_v_chi_2)) - (0.04908738521234052 * pow(__pyx_v_chi_2, 2.0))) - (0.3328450520833333 * pow(__pyx_v_chi_2, 3.0))) + ((0.8385416666666666 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 3.0))) - ((0.5 * __pyx_v_CES32) * pow(__pyx_v_chi_2, 3.0))) + (((((((((((0.06236510029705724 * __pyx_v_chi_1) - (0.04908738521234052 * pow(__pyx_v_chi_1, 2.0))) - (0.3328450520833333 * pow(__pyx_v_chi_1, 3.0))) + ((0.8385416666666666 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 3.0))) - ((0.5 * __pyx_v_CES31) * pow(__pyx_v_chi_1, 3.0))) - (0.06236510029705724 * __pyx_v_chi_2)) + (0.04908738521234052 * pow(__pyx_v_chi_2, 2.0))) + (0.3328450520833333 * pow(__pyx_v_chi_2, 3.0))) - ((0.8385416666666666 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 3.0))) + ((0.5 * __pyx_v_CES32) * pow(__pyx_v_chi_2, 3.0))) * __pyx_v_expr1)) + (((((((((((((((((((1.1044499346767318 + (10.925968357585004 * __pyx_v_chi_1)) + (0.09817477042468103 * pow(__pyx_v_chi_1, 2.0))) + (1.5704752604166667 * pow(__pyx_v_chi_1, 3.0))) - ((2.3177083333333335 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 3.0))) + ((0.020833333333333332 * __pyx_v_CES22) * pow(__pyx_v_chi_1, 3.0))) + ((1.5 * __pyx_v_CES31) * pow(__pyx_v_chi_1, 3.0))) + (10.925968357585004 * __pyx_v_chi_2)) + ((0.19634954084936207 * __pyx_v_chi_1) * __pyx_v_chi_2)) + ((1.24853515625 * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) - (((0.5052083333333334 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) + (0.09817477042468103 * pow(__pyx_v_chi_2, 2.0))) + ((1.24853515625 * __pyx_v_chi_1) * pow(__pyx_v_chi_2, 2.0))) - (((0.5052083333333334 * __pyx_v_CES22) * __pyx_v_chi_1) * pow(__pyx_v_chi_2, 2.0))) + (1.5704752604166667 * pow(__pyx_v_chi_2, 3.0))) + ((0.020833333333333332 * __pyx_v_CES21) * pow(__pyx_v_chi_2, 3.0))) - ((2.3177083333333335 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 3.0))) + ((1.5 * __pyx_v_CES32) * pow(__pyx_v_chi_2, 3.0))) + (((((((((((((((8.134637611102745 * __pyx_v_chi_1) + (0.90478515625 * pow(__pyx_v_chi_1, 3.0))) - ((0.640625 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 3.0))) + ((0.020833333333333332 * __pyx_v_CES22) * pow(__pyx_v_chi_1, 3.0))) + ((0.5 * __pyx_v_CES31) * pow(__pyx_v_chi_1, 3.0))) - (8.134637611102745 * __pyx_v_chi_2)) + ((1.24853515625 * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) - (((0.5052083333333334 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) - ((1.24853515625 * __pyx_v_chi_1) * pow(__pyx_v_chi_2, 2.0))) + (((0.5052083333333334 * __pyx_v_CES22) * __pyx_v_chi_1) * pow(__pyx_v_chi_2, 2.0))) - (0.90478515625 * pow(__pyx_v_chi_2, 3.0))) - ((0.020833333333333332 * __pyx_v_CES21) * pow(__pyx_v_chi_2, 3.0))) + ((0.640625 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 3.0))) - ((0.5 * __pyx_v_CES32) * pow(__pyx_v_chi_2, 3.0))) * __pyx_v_expr1)) * __pyx_v_nu)) + ((((((((((((((((21.378757472443116 - (8.71349019660671 * __pyx_v_chi_1)) - (1.6438802083333333 * pow(__pyx_v_chi_1, 3.0))) - ((0.4583333333333333 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 3.0))) - ((0.10416666666666667 * __pyx_v_CES22) * pow(__pyx_v_chi_1, 3.0))) - (8.71349019660671 * __pyx_v_chi_2)) + ((0.3600260416666667 * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) - (((0.4166666666666667 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) - (((0.0625 * __pyx_v_CES22) * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) + ((0.3600260416666667 * __pyx_v_chi_1) * pow(__pyx_v_chi_2, 2.0))) - (((0.0625 * __pyx_v_CES21) * __pyx_v_chi_1) * pow(__pyx_v_chi_2, 2.0))) - (((0.4166666666666667 * __pyx_v_CES22) * __pyx_v_chi_1) * pow(__pyx_v_chi_2, 2.0))) - (1.6438802083333333 * pow(__pyx_v_chi_2, 3.0))) - ((0.10416666666666667 * __pyx_v_CES21) * pow(__pyx_v_chi_2, 3.0))) - ((0.4583333333333333 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 3.0))) + (((((((((((((((-4.077088632581216 * __pyx_v_chi_1) - (0.5 * pow(__pyx_v_chi_1, 3.0))) - ((0.0625 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 3.0))) - ((0.0625 * __pyx_v_CES22) * pow(__pyx_v_chi_1, 3.0))) + (4.077088632581216 * __pyx_v_chi_2)) - ((0.5 * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) - (((0.0625 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) - (((0.0625 * __pyx_v_CES22) * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) + ((0.5 * __pyx_v_chi_1) * pow(__pyx_v_chi_2, 2.0))) + (((0.0625 * __pyx_v_CES21) * __pyx_v_chi_1) * pow(__pyx_v_chi_2, 2.0))) + (((0.0625 * __pyx_v_CES22) * __pyx_v_chi_1) * pow(__pyx_v_chi_2, 2.0))) + (0.5 * pow(__pyx_v_chi_2, 3.0))) + ((0.0625 * __pyx_v_CES21) * pow(__pyx_v_chi_2, 3.0))) + ((0.0625 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 3.0))) * __pyx_v_expr1)) * pow(__pyx_v_nu, 2.0))) + (((((((((((((((1.8834442884503337 * __pyx_v_chi_1) + (0.3333333333333333 * pow(__pyx_v_chi_1, 3.0))) + ((0.08333333333333333 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 3.0))) + ((0.08333333333333333 * __pyx_v_CES22) * pow(__pyx_v_chi_1, 3.0))) + (1.8834442884503337 * __pyx_v_chi_2)) + (pow(__pyx_v_chi_1, 2.0) * __pyx_v_chi_2)) + (((0.25 * __pyx_v_CES21) * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) + (((0.25 * __pyx_v_CES22) * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) + (__pyx_v_chi_1 * pow(__pyx_v_chi_2, 2.0))) + (((0.25 * __pyx_v_CES21) * __pyx_v_chi_1) * pow(__pyx_v_chi_2, 2.0))) + (((0.25 * __pyx_v_CES22) * __pyx_v_chi_1) * pow(__pyx_v_chi_2, 2.0))) + (0.3333333333333333 * pow(__pyx_v_chi_2, 3.0))) + ((0.08333333333333333 * __pyx_v_CES21) * pow(__pyx_v_chi_2, 3.0))) + ((0.08333333333333333 * __pyx_v_CES22) * pow(__pyx_v_chi_2, 3.0))) * pow(__pyx_v_nu, 3.0)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":1887
+    /* "pyseobnr/eob/waveform/waveform.pyx":1979
  *         )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta72 = (
  *             - 1.169026602968159
  */
     goto __pyx_L14;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1995
+  /* "pyseobnr/eob/waveform/waveform.pyx":2108
  *                 ) * expr1
  *             )* nu**2
  *             + (             # <<<<<<<<<<<<<<
  *                 (0.3333333333333333 + 0.08333333333333333 * CES21 + 0.08333333333333333 * CES22) * chi_1**3
  *                 + 1.8834442884503337 * chi_2
  */
-  __Pyx_TraceLine(1995,0,__PYX_ERR(0, 1995, __pyx_L1_error))
+  __Pyx_TraceLine(2108,0,__PYX_ERR(0, 2108, __pyx_L1_error))
   /*else*/ {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2001
+    /* "pyseobnr/eob/waveform/waveform.pyx":2114
  *                 + (0.3333333333333333 + 0.08333333333333333 * CES21 + 0.08333333333333333 * CES22) * chi_2**3
  *                 + chi_1 * (1.8834442884503337 + (0.9999999999999999 + 0.25 * CES21 + 0.25 * CES22) * chi_2**2)
  *             ) * nu**3             # <<<<<<<<<<<<<<
  *         )
  * 
  */
-    __Pyx_TraceLine(2001,0,__PYX_ERR(0, 2001, __pyx_L1_error))
+    __Pyx_TraceLine(2114,0,__PYX_ERR(0, 2114, __pyx_L1_error))
     __pyx_v_beta72 = ((((((((((-1.429803336908718 - (0.6095166813869705 * __pyx_v_chi_1)) - (0.04908738521234052 * pow(__pyx_v_chi_1, 2.0))) + (((-0.3328450520833333 + (0.8385416666666666 * __pyx_v_CES21)) - (0.49999999999999994 * __pyx_v_CES31)) * pow(__pyx_v_chi_1, 3.0))) - (0.6095166813869705 * __pyx_v_chi_2)) - (0.04908738521234052 * pow(__pyx_v_chi_2, 2.0))) + (((-0.3328450520833333 + (0.8385416666666666 * __pyx_v_CES22)) - (0.49999999999999994 * __pyx_v_CES32)) * pow(__pyx_v_chi_2, 3.0))) + (((((((-0.6095166813869705 * __pyx_v_chi_1) - (0.04908738521234052 * pow(__pyx_v_chi_1, 2.0))) + (((-0.3328450520833333 + (0.8385416666666666 * __pyx_v_CES21)) - (0.49999999999999994 * __pyx_v_CES31)) * pow(__pyx_v_chi_1, 3.0))) + (0.6095166813869705 * __pyx_v_chi_2)) + (0.04908738521234052 * pow(__pyx_v_chi_2, 2.0))) + (((0.3328450520833333 - (0.8385416666666666 * __pyx_v_CES22)) + (0.49999999999999994 * __pyx_v_CES32)) * pow(__pyx_v_chi_2, 3.0))) * __pyx_v_expr1)) + ((((((((2.1475568704389674 + ((((1.5704752604166665 - (2.317708333333333 * __pyx_v_CES21)) + (0.020833333333333332 * __pyx_v_CES22)) + (1.5 * __pyx_v_CES31)) * pow(__pyx_v_chi_1, 3.0))) + (12.029987764827068 * __pyx_v_chi_2)) + (0.09817477042468103 * pow(__pyx_v_chi_2, 2.0))) + ((((1.5704752604166665 + (0.020833333333333332 * __pyx_v_CES21)) - (2.317708333333333 * __pyx_v_CES22)) + (1.5 * __pyx_v_CES32)) * pow(__pyx_v_chi_2, 3.0))) + (pow(__pyx_v_chi_1, 2.0) * (0.09817477042468103 + ((1.24853515625 - (0.5052083333333333 * __pyx_v_CES21)) * __pyx_v_chi_2)))) + (__pyx_v_chi_1 * ((12.029987764827068 + (0.19634954084936207 * __pyx_v_chi_2)) + ((1.24853515625 - (0.5052083333333333 * __pyx_v_CES22)) * pow(__pyx_v_chi_2, 2.0))))) + (((((((((0.9047851562499999 - (0.640625 * __pyx_v_CES21)) + (0.020833333333333332 * __pyx_v_CES22)) + (0.49999999999999994 * __pyx_v_CES31)) * pow(__pyx_v_chi_1, 3.0)) - (8.510021260656316 * __pyx_v_chi_2)) + (((1.24853515625 - (0.5052083333333333 * __pyx_v_CES21)) * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) + ((((-0.9047851562499999 - (0.020833333333333332 * __pyx_v_CES21)) + (0.640625 * __pyx_v_CES22)) - (0.49999999999999994 * __pyx_v_CES32)) * pow(__pyx_v_chi_2, 3.0))) + (__pyx_v_chi_1 * (8.510021260656316 + ((-1.24853515625 + (0.5052083333333333 * __pyx_v_CES22)) * pow(__pyx_v_chi_2, 2.0))))) * __pyx_v_expr1)) * __pyx_v_nu)) + (((((((21.378757472443112 + (((-1.6438802083333333 - (0.4583333333333333 * __pyx_v_CES21)) - (0.10416666666666666 * __pyx_v_CES22)) * pow(__pyx_v_chi_1, 3.0))) - (8.766860112281313 * __pyx_v_chi_2)) + ((((0.36002604166666663 - (0.41666666666666663 * __pyx_v_CES21)) - (0.0625 * __pyx_v_CES22)) * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) + (((-1.6438802083333333 - (0.10416666666666666 * __pyx_v_CES21)) - (0.4583333333333333 * __pyx_v_CES22)) * pow(__pyx_v_chi_2, 3.0))) + (__pyx_v_chi_1 * (-8.766860112281313 + (((0.36002604166666663 - (0.0625 * __pyx_v_CES21)) - (0.41666666666666663 * __pyx_v_CES22)) * pow(__pyx_v_chi_2, 2.0))))) + ((((((((-0.49999999999999994 - (0.0625 * __pyx_v_CES21)) - (0.0625 * __pyx_v_CES22)) * pow(__pyx_v_chi_1, 3.0)) + (4.077088632581215 * __pyx_v_chi_2)) + ((((-0.49999999999999994 - (0.0625 * __pyx_v_CES21)) - (0.0625 * __pyx_v_CES22)) * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) + (((0.49999999999999994 + (0.0625 * __pyx_v_CES21)) + (0.0625 * __pyx_v_CES22)) * pow(__pyx_v_chi_2, 3.0))) + (__pyx_v_chi_1 * (-4.077088632581215 + (((0.49999999999999994 + (0.0625 * __pyx_v_CES21)) + (0.0625 * __pyx_v_CES22)) * pow(__pyx_v_chi_2, 2.0))))) * __pyx_v_expr1)) * pow(__pyx_v_nu, 2.0))) + ((((((((0.3333333333333333 + (0.08333333333333333 * __pyx_v_CES21)) + (0.08333333333333333 * __pyx_v_CES22)) * pow(__pyx_v_chi_1, 3.0)) + (1.8834442884503337 * __pyx_v_chi_2)) + ((((0.9999999999999999 + (0.25 * __pyx_v_CES21)) + (0.25 * __pyx_v_CES22)) * pow(__pyx_v_chi_1, 2.0)) * __pyx_v_chi_2)) + (((0.3333333333333333 + (0.08333333333333333 * __pyx_v_CES21)) + (0.08333333333333333 * __pyx_v_CES22)) * pow(__pyx_v_chi_2, 3.0))) + (__pyx_v_chi_1 * (1.8834442884503337 + (((0.9999999999999999 + (0.25 * __pyx_v_CES21)) + (0.25 * __pyx_v_CES22)) * pow(__pyx_v_chi_2, 2.0))))) * pow(__pyx_v_nu, 3.0)));
   }
   __pyx_L14:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2004
+  /* "pyseobnr/eob/waveform/waveform.pyx":2117
  *         )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta4 = (
  *             8.072488677403342
  */
-  __Pyx_TraceLine(2004,0,__PYX_ERR(0, 2004, __pyx_L1_error))
+  __Pyx_TraceLine(2117,0,__PYX_ERR(0, 2117, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_beaming == 1);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2010
+    /* "pyseobnr/eob/waveform/waveform.pyx":2123
  *             - 0.18213016868508652 * a**2
  *             - 0.0159912109375 * a**4
  *             - 0.9711167800453515 * log(x)             # <<<<<<<<<<<<<<
  *         )
  *     else:
  */
-    __Pyx_TraceLine(2010,0,__PYX_ERR(0, 2010, __pyx_L1_error))
+    __Pyx_TraceLine(2123,0,__PYX_ERR(0, 2123, __pyx_L1_error))
     __pyx_v_beta4 = ((((8.072488677403342 - (2.3141439374831623 * __pyx_v_a)) - (0.18213016868508652 * pow(__pyx_v_a, 2.0))) - (0.0159912109375 * pow(__pyx_v_a, 4.0))) - (0.9711167800453515 * log(__pyx_v_x)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2004
+    /* "pyseobnr/eob/waveform/waveform.pyx":2117
  *         )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta4 = (
  *             8.072488677403342
  */
     goto __pyx_L15;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2018
+  /* "pyseobnr/eob/waveform/waveform.pyx":2131
  *             + 0.38141469506119324 * a**2
  *             - 0.0159912109375 * a**4
  *             - 0.9711167800453515 * log(x)             # <<<<<<<<<<<<<<
  *         )
  * 
  */
-  __Pyx_TraceLine(2018,0,__PYX_ERR(0, 2018, __pyx_L1_error))
+  __Pyx_TraceLine(2131,0,__PYX_ERR(0, 2131, __pyx_L1_error))
   /*else*/ {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2017
+    /* "pyseobnr/eob/waveform/waveform.pyx":2130
  *             - 2.330506399220609 * a
  *             + 0.38141469506119324 * a**2
  *             - 0.0159912109375 * a**4             # <<<<<<<<<<<<<<
  *             - 0.9711167800453515 * log(x)
  *         )
  */
-    __Pyx_TraceLine(2017,0,__PYX_ERR(0, 2017, __pyx_L1_error))
+    __Pyx_TraceLine(2130,0,__PYX_ERR(0, 2130, __pyx_L1_error))
     __pyx_v_beta4 = ((((10.114228370386105 - (2.330506399220609 * __pyx_v_a)) + (0.38141469506119324 * pow(__pyx_v_a, 2.0))) - (0.0159912109375 * pow(__pyx_v_a, 4.0))) - (0.9711167800453515 * log(__pyx_v_x)));
   }
   __pyx_L15:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2021
+  /* "pyseobnr/eob/waveform/waveform.pyx":2134
  *         )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta92 = (
  *             - 18.29435444994186
  */
-  __Pyx_TraceLine(2021,0,__PYX_ERR(0, 2021, __pyx_L1_error))
+  __Pyx_TraceLine(2134,0,__PYX_ERR(0, 2134, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_beaming == 1);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2027
+    /* "pyseobnr/eob/waveform/waveform.pyx":2140
  *             + 1.7402829421802135 * a**2
  *             + 0.6351334237127287 * a**3
  *             + 3.898015873015873 * a * log(x)             # <<<<<<<<<<<<<<
  *         )
  *     else:
  */
-    __Pyx_TraceLine(2027,0,__PYX_ERR(0, 2027, __pyx_L1_error))
+    __Pyx_TraceLine(2140,0,__PYX_ERR(0, 2140, __pyx_L1_error))
     __pyx_v_beta92 = ((((-18.29435444994186 + (4.546626318517944 * __pyx_v_a)) + (1.7402829421802135 * pow(__pyx_v_a, 2.0))) + (0.6351334237127287 * pow(__pyx_v_a, 3.0))) + ((3.898015873015873 * __pyx_v_a) * log(__pyx_v_x)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2021
+    /* "pyseobnr/eob/waveform/waveform.pyx":2134
  *         )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta92 = (
  *             - 18.29435444994186
  */
     goto __pyx_L16;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2034
+  /* "pyseobnr/eob/waveform/waveform.pyx":2147
  *             + 1.7525547884832986 * a**2
  *             + 0.6258967700668954 * a**3
  *             + a * (0.16942839332227244 + 3.898015873015873 * log(x))             # <<<<<<<<<<<<<<
  *         )
  * 
  */
-  __Pyx_TraceLine(2034,0,__PYX_ERR(0, 2034, __pyx_L1_error))
+  __Pyx_TraceLine(2147,0,__PYX_ERR(0, 2147, __pyx_L1_error))
   /*else*/ {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2033
+    /* "pyseobnr/eob/waveform/waveform.pyx":2146
  *             -18.034136303471843
  *             + 1.7525547884832986 * a**2
  *             + 0.6258967700668954 * a**3             # <<<<<<<<<<<<<<
  *             + a * (0.16942839332227244 + 3.898015873015873 * log(x))
  *         )
  */
-    __Pyx_TraceLine(2033,0,__PYX_ERR(0, 2033, __pyx_L1_error))
+    __Pyx_TraceLine(2146,0,__PYX_ERR(0, 2146, __pyx_L1_error))
     __pyx_v_beta92 = (((-18.034136303471843 + (1.7525547884832986 * pow(__pyx_v_a, 2.0))) + (0.6258967700668954 * pow(__pyx_v_a, 3.0))) + (__pyx_v_a * (0.16942839332227244 + (3.898015873015873 * log(__pyx_v_x)))));
   }
   __pyx_L16:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2037
+  /* "pyseobnr/eob/waveform/waveform.pyx":2150
  *         )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta5 = (
  *             19.820637776303766
  */
-  __Pyx_TraceLine(2037,0,__PYX_ERR(0, 2037, __pyx_L1_error))
+  __Pyx_TraceLine(2150,0,__PYX_ERR(0, 2150, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_beaming == 1);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2045
+    /* "pyseobnr/eob/waveform/waveform.pyx":2158
  *             - 0.15794956873333643 * a**4
  *             + 0.4738176563005019 * log(x)
  *             - 0.9235119047619048 * a**2 * log(x)             # <<<<<<<<<<<<<<
  *         )
  *     else:
  */
-    __Pyx_TraceLine(2045,0,__PYX_ERR(0, 2045, __pyx_L1_error))
+    __Pyx_TraceLine(2158,0,__PYX_ERR(0, 2158, __pyx_L1_error))
     __pyx_v_beta5 = ((((((19.820637776303766 - (9.921907618552808 * __pyx_v_a)) - (1.025103686888767 * pow(__pyx_v_a, 2.0))) - (0.07772169325287248 * pow(__pyx_v_a, 3.0))) - (0.15794956873333643 * pow(__pyx_v_a, 4.0))) + (0.4738176563005019 * log(__pyx_v_x))) - ((0.9235119047619048 * pow(__pyx_v_a, 2.0)) * log(__pyx_v_x)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2037
+    /* "pyseobnr/eob/waveform/waveform.pyx":2150
  *         )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta5 = (
  *             19.820637776303766
  */
     goto __pyx_L17;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2054
+  /* "pyseobnr/eob/waveform/waveform.pyx":2167
  *             - 0.07772169325287248 * a**3
  *             - 0.15399754236614893 * a**4
  *             + (0.5952072538061708 - 0.9235119047619048 * a**2) * log(x)             # <<<<<<<<<<<<<<
  *         )
  * 
  */
-  __Pyx_TraceLine(2054,0,__PYX_ERR(0, 2054, __pyx_L1_error))
+  __Pyx_TraceLine(2167,0,__PYX_ERR(0, 2167, __pyx_L1_error))
   /*else*/ {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2053
+    /* "pyseobnr/eob/waveform/waveform.pyx":2166
  *             + 1.71620670347648 * a**2
  *             - 0.07772169325287248 * a**3
  *             - 0.15399754236614893 * a**4             # <<<<<<<<<<<<<<
  *             + (0.5952072538061708 - 0.9235119047619048 * a**2) * log(x)
  *         )
  */
-    __Pyx_TraceLine(2053,0,__PYX_ERR(0, 2053, __pyx_L1_error))
+    __Pyx_TraceLine(2166,0,__PYX_ERR(0, 2166, __pyx_L1_error))
     __pyx_v_beta5 = (((((23.820736971461926 - (10.32088567319877 * __pyx_v_a)) + (1.71620670347648 * pow(__pyx_v_a, 2.0))) - (0.07772169325287248 * pow(__pyx_v_a, 3.0))) - (0.15399754236614893 * pow(__pyx_v_a, 4.0))) + ((0.5952072538061708 - (0.9235119047619048 * pow(__pyx_v_a, 2.0))) * log(__pyx_v_x)));
   }
   __pyx_L17:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2057
+  /* "pyseobnr/eob/waveform/waveform.pyx":2170
  *         )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta112 = (
  *             1.8072480800519273
  */
-  __Pyx_TraceLine(2057,0,__PYX_ERR(0, 2057, __pyx_L1_error))
+  __Pyx_TraceLine(2170,0,__PYX_ERR(0, 2170, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_beaming == 1);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2066
+    /* "pyseobnr/eob/waveform/waveform.pyx":2179
  *             - 0.28276824951171875 * a**5
  *             - 6.637972453723382 * log(x)
  *             + 7.909000909391534 * a * log(x)             # <<<<<<<<<<<<<<
  *         )
  *     else:
  */
-    __Pyx_TraceLine(2066,0,__PYX_ERR(0, 2066, __pyx_L1_error))
+    __Pyx_TraceLine(2179,0,__PYX_ERR(0, 2179, __pyx_L1_error))
     __pyx_v_beta112 = (((((((1.8072480800519273 - (20.122387510504154 * __pyx_v_a)) + (5.501838571193589 * pow(__pyx_v_a, 2.0))) + (2.3338507859384703 * pow(__pyx_v_a, 3.0))) + (0.10277671278833796 * pow(__pyx_v_a, 4.0))) - (0.28276824951171875 * pow(__pyx_v_a, 5.0))) - (6.637972453723382 * log(__pyx_v_x))) + ((7.909000909391534 * __pyx_v_a) * log(__pyx_v_x)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2057
+    /* "pyseobnr/eob/waveform/waveform.pyx":2170
  *         )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         beta112 = (
  *             1.8072480800519273
  */
     goto __pyx_L18;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2076
+  /* "pyseobnr/eob/waveform/waveform.pyx":2189
  *             + 0.10277671278833796 * a**4
  *             - 0.28276824951171875 * a**5
  *             + (-6.637972453723382 + 7.42174892526455 * a) * log(x)             # <<<<<<<<<<<<<<
  *         )
  * 
  */
-  __Pyx_TraceLine(2076,0,__PYX_ERR(0, 2076, __pyx_L1_error))
+  __Pyx_TraceLine(2189,0,__PYX_ERR(0, 2189, __pyx_L1_error))
   /*else*/ {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2075
+    /* "pyseobnr/eob/waveform/waveform.pyx":2188
  *             + 1.7064747240397795 * a**3
  *             + 0.10277671278833796 * a**4
  *             - 0.28276824951171875 * a**5             # <<<<<<<<<<<<<<
  *             + (-6.637972453723382 + 7.42174892526455 * a) * log(x)
  *         )
  */
-    __Pyx_TraceLine(2075,0,__PYX_ERR(0, 2075, __pyx_L1_error))
+    __Pyx_TraceLine(2188,0,__PYX_ERR(0, 2188, __pyx_L1_error))
     __pyx_v_beta112 = ((((((5.003270253676121 - (33.70682640102828 * __pyx_v_a)) + (5.496077773304163 * pow(__pyx_v_a, 2.0))) + (1.7064747240397795 * pow(__pyx_v_a, 3.0))) + (0.10277671278833796 * pow(__pyx_v_a, 4.0))) - (0.28276824951171875 * pow(__pyx_v_a, 5.0))) + ((-6.637972453723382 + (7.42174892526455 * __pyx_v_a)) * log(__pyx_v_x)));
   }
   __pyx_L18:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2079
+  /* "pyseobnr/eob/waveform/waveform.pyx":2192
  *         )
  * 
  *     beta = 1. + (             # <<<<<<<<<<<<<<
  *         beta12 * x**(1./2)
  *         + beta1 * x
  */
-  __Pyx_TraceLine(2079,0,__PYX_ERR(0, 2079, __pyx_L1_error))
+  __Pyx_TraceLine(2192,0,__PYX_ERR(0, 2192, __pyx_L1_error))
   __pyx_v_beta = (1. + (((((((((((__pyx_v_beta12 * pow(__pyx_v_x, (1. / 2.0))) + (__pyx_v_beta1 * __pyx_v_x)) + (__pyx_v_beta32 * pow(__pyx_v_x, (3. / 2.0)))) + (__pyx_v_beta2 * pow(__pyx_v_x, 2.0))) + (__pyx_v_beta52 * pow(__pyx_v_x, (5. / 2.0)))) + (__pyx_v_beta3 * pow(__pyx_v_x, 3.))) + (__pyx_v_beta72 * pow(__pyx_v_x, (7. / 2.0)))) + (__pyx_v_beta4 * pow(__pyx_v_x, 4.))) + (__pyx_v_beta92 * pow(__pyx_v_x, (9. / 2.0)))) + (__pyx_v_beta5 * pow(__pyx_v_x, 5.))) + (__pyx_v_beta112 * pow(__pyx_v_x, (11. / 2.0)))));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2093
+  /* "pyseobnr/eob/waveform/waveform.pyx":2206
  *     )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         B = sqrt(2) * (asinh(Heff) - asinh(1.)) + 1.
  *     else:
  */
-  __Pyx_TraceLine(2093,0,__PYX_ERR(0, 2093, __pyx_L1_error))
+  __Pyx_TraceLine(2206,0,__PYX_ERR(0, 2206, __pyx_L1_error))
   __pyx_t_1 = (__pyx_v_beaming == 1);
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2094
+    /* "pyseobnr/eob/waveform/waveform.pyx":2207
  * 
  *     if beaming == 1:
  *         B = sqrt(2) * (asinh(Heff) - asinh(1.)) + 1.             # <<<<<<<<<<<<<<
  *     else:
  *         B = 1.
  */
-    __Pyx_TraceLine(2094,0,__PYX_ERR(0, 2094, __pyx_L1_error))
+    __Pyx_TraceLine(2207,0,__PYX_ERR(0, 2207, __pyx_L1_error))
     __pyx_v_B = ((sqrt(2.0) * (asinh(__pyx_v_Heff) - asinh(1.))) + 1.);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2093
+    /* "pyseobnr/eob/waveform/waveform.pyx":2206
  *     )
  * 
  *     if beaming == 1:             # <<<<<<<<<<<<<<
  *         B = sqrt(2) * (asinh(Heff) - asinh(1.)) + 1.
  *     else:
  */
     goto __pyx_L19;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2096
+  /* "pyseobnr/eob/waveform/waveform.pyx":2209
  *         B = sqrt(2) * (asinh(Heff) - asinh(1.)) + 1.
  *     else:
  *         B = 1.             # <<<<<<<<<<<<<<
  * 
  *     flux = dE_dt_22 * alpha * beta**4. * B
  */
-  __Pyx_TraceLine(2096,0,__PYX_ERR(0, 2096, __pyx_L1_error))
+  __Pyx_TraceLine(2209,0,__PYX_ERR(0, 2209, __pyx_L1_error))
   /*else*/ {
     __pyx_v_B = 1.;
   }
   __pyx_L19:;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2098
+  /* "pyseobnr/eob/waveform/waveform.pyx":2211
  *         B = 1.
  * 
  *     flux = dE_dt_22 * alpha * beta**4. * B             # <<<<<<<<<<<<<<
  * 
  *     return flux
  */
-  __Pyx_TraceLine(2098,0,__PYX_ERR(0, 2098, __pyx_L1_error))
+  __Pyx_TraceLine(2211,0,__PYX_ERR(0, 2211, __pyx_L1_error))
   __pyx_v_flux = (((__pyx_v_dE_dt_22 * __pyx_v_alpha) * pow(__pyx_v_beta, 4.)) * __pyx_v_B);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2100
+  /* "pyseobnr/eob/waveform/waveform.pyx":2213
  *     flux = dE_dt_22 * alpha * beta**4. * B
  * 
  *     return flux             # <<<<<<<<<<<<<<
  * 
- * @cython.cpow(True)
+ * 
  */
-  __Pyx_TraceLine(2100,0,__PYX_ERR(0, 2100, __pyx_L1_error))
+  __Pyx_TraceLine(2213,0,__PYX_ERR(0, 2213, __pyx_L1_error))
   __pyx_r = __pyx_v_flux;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1484
+  /* "pyseobnr/eob/waveform/waveform.pyx":1576
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double compute_refactorized_flux(             # <<<<<<<<<<<<<<
  *     double chi_1,
  *     double chi_2,
  */
 
@@ -30218,120 +30276,120 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_chi_1)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1484, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1576, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_chi_2)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1484, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1576, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 1); __PYX_ERR(0, 1484, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 1); __PYX_ERR(0, 1576, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1484, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1576, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 2); __PYX_ERR(0, 1484, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 2); __PYX_ERR(0, 1576, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x_phi)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1484, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1576, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 3); __PYX_ERR(0, 1484, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 3); __PYX_ERR(0, 1576, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_nu)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1484, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1576, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 4); __PYX_ERR(0, 1484, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 4); __PYX_ERR(0, 1576, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_H)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[5]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1484, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1576, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 5); __PYX_ERR(0, 1484, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 5); __PYX_ERR(0, 1576, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_beaming)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[6]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1484, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1576, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 6); __PYX_ERR(0, 1484, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 6); __PYX_ERR(0, 1576, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_alpha_N)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[7]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1484, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1576, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 7); __PYX_ERR(0, 1484, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 7); __PYX_ERR(0, 1576, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
         if (likely((values[8] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_beta_PN_N)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[8]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1484, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1576, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 8); __PYX_ERR(0, 1484, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 8); __PYX_ERR(0, 1576, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  9:
         if (likely((values[9] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_beta_TP_N)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[9]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1484, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1576, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 9); __PYX_ERR(0, 1484, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 9); __PYX_ERR(0, 1576, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 10:
         if (likely((values[10] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_quasi_circ)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[10]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1484, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1576, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 10); __PYX_ERR(0, 1484, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, 10); __PYX_ERR(0, 1576, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_refactorized_flux") < 0)) __PYX_ERR(0, 1484, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_refactorized_flux") < 0)) __PYX_ERR(0, 1576, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 11)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
@@ -30340,29 +30398,29 @@
       values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
       values[6] = __Pyx_Arg_FASTCALL(__pyx_args, 6);
       values[7] = __Pyx_Arg_FASTCALL(__pyx_args, 7);
       values[8] = __Pyx_Arg_FASTCALL(__pyx_args, 8);
       values[9] = __Pyx_Arg_FASTCALL(__pyx_args, 9);
       values[10] = __Pyx_Arg_FASTCALL(__pyx_args, 10);
     }
-    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1485, __pyx_L3_error)
-    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1486, __pyx_L3_error)
-    __pyx_v_x = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_x == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1487, __pyx_L3_error)
-    __pyx_v_x_phi = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_x_phi == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1488, __pyx_L3_error)
-    __pyx_v_nu = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_nu == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1489, __pyx_L3_error)
-    __pyx_v_H = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_H == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1490, __pyx_L3_error)
-    __pyx_v_beaming = __Pyx_PyObject_IsTrue(values[6]); if (unlikely((__pyx_v_beaming == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1491, __pyx_L3_error)
-    __pyx_v_alpha_N = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_alpha_N == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1492, __pyx_L3_error)
-    __pyx_v_beta_PN_N = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_beta_PN_N == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1493, __pyx_L3_error)
-    __pyx_v_beta_TP_N = __Pyx_PyInt_As_int(values[9]); if (unlikely((__pyx_v_beta_TP_N == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1494, __pyx_L3_error)
-    __pyx_v_quasi_circ = __Pyx_PyObject_IsTrue(values[10]); if (unlikely((__pyx_v_quasi_circ == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1495, __pyx_L3_error)
+    __pyx_v_chi_1 = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_chi_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1577, __pyx_L3_error)
+    __pyx_v_chi_2 = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_chi_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1578, __pyx_L3_error)
+    __pyx_v_x = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_x == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1579, __pyx_L3_error)
+    __pyx_v_x_phi = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_x_phi == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1580, __pyx_L3_error)
+    __pyx_v_nu = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_nu == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1581, __pyx_L3_error)
+    __pyx_v_H = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_H == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1582, __pyx_L3_error)
+    __pyx_v_beaming = __Pyx_PyObject_IsTrue(values[6]); if (unlikely((__pyx_v_beaming == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1583, __pyx_L3_error)
+    __pyx_v_alpha_N = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_alpha_N == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1584, __pyx_L3_error)
+    __pyx_v_beta_PN_N = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_beta_PN_N == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1585, __pyx_L3_error)
+    __pyx_v_beta_TP_N = __Pyx_PyInt_As_int(values[9]); if (unlikely((__pyx_v_beta_TP_N == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1586, __pyx_L3_error)
+    __pyx_v_quasi_circ = __Pyx_PyObject_IsTrue(values[10]); if (unlikely((__pyx_v_quasi_circ == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1587, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, __pyx_nargs); __PYX_ERR(0, 1484, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("compute_refactorized_flux", 1, 11, 11, __pyx_nargs); __PYX_ERR(0, 1576, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -30392,18 +30450,18 @@
   double __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__14)
   __Pyx_RefNannySetupContext("compute_refactorized_flux", 1);
-  __Pyx_TraceCall("compute_refactorized_flux (wrapper)", __pyx_f[0], 1484, 0, __PYX_ERR(0, 1484, __pyx_L1_error));
+  __Pyx_TraceCall("compute_refactorized_flux (wrapper)", __pyx_f[0], 1576, 0, __PYX_ERR(0, 1576, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_refactorized_flux(__pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_x, __pyx_v_x_phi, __pyx_v_nu, __pyx_v_H, __pyx_v_beaming, __pyx_v_alpha_N, __pyx_v_beta_PN_N, __pyx_v_beta_TP_N, __pyx_v_quasi_circ, 0); if (unlikely(__pyx_t_1 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1484, __pyx_L1_error)
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1484, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_refactorized_flux(__pyx_v_chi_1, __pyx_v_chi_2, __pyx_v_x, __pyx_v_x_phi, __pyx_v_nu, __pyx_v_H, __pyx_v_beaming, __pyx_v_alpha_N, __pyx_v_beta_PN_N, __pyx_v_beta_TP_N, __pyx_v_quasi_circ, 0); if (unlikely(__pyx_t_1 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1576, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1576, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -30413,20 +30471,20 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2110
+/* "pyseobnr/eob/waveform/waveform.pyx":2224
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef (double,double) RR_force(double[::1] q, double[::1] p, double omega, double omega_circ,             # <<<<<<<<<<<<<<
- *     double H, EOBParams eob_pars):
- *     """
+ * cpdef (double, double) RR_force(             # <<<<<<<<<<<<<<
+ *     double[::1] q,
+ *     double[::1] p,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_19RR_force(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
@@ -30447,141 +30505,141 @@
   Py_ssize_t __pyx_t_1;
   double __pyx_t_2;
   __pyx_ctuple_double__and_double __pyx_t_3;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__15)
-  __Pyx_TraceCall("RR_force", __pyx_f[0], 2110, 0, __PYX_ERR(0, 2110, __pyx_L1_error));
+  __Pyx_TraceCall("RR_force", __pyx_f[0], 2224, 0, __PYX_ERR(0, 2224, __pyx_L1_error));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2115
+  /* "pyseobnr/eob/waveform/waveform.pyx":2235
  *     Compute the RR force in polar coordinates, from the flux
  *     """
  *     cdef double r = q[0]             # <<<<<<<<<<<<<<
  *     cdef double phi = q[1]
  *     cdef double pr = p[0]
  */
-  __Pyx_TraceLine(2115,0,__PYX_ERR(0, 2115, __pyx_L1_error))
+  __Pyx_TraceLine(2235,0,__PYX_ERR(0, 2235, __pyx_L1_error))
   __pyx_t_1 = 0;
   __pyx_v_r = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_q.data) + __pyx_t_1)) )));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2116
+  /* "pyseobnr/eob/waveform/waveform.pyx":2236
  *     """
  *     cdef double r = q[0]
  *     cdef double phi = q[1]             # <<<<<<<<<<<<<<
  *     cdef double pr = p[0]
  *     cdef double pphi = p[1]
  */
-  __Pyx_TraceLine(2116,0,__PYX_ERR(0, 2116, __pyx_L1_error))
+  __Pyx_TraceLine(2236,0,__PYX_ERR(0, 2236, __pyx_L1_error))
   __pyx_t_1 = 1;
   __pyx_v_phi = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_q.data) + __pyx_t_1)) )));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2117
+  /* "pyseobnr/eob/waveform/waveform.pyx":2237
  *     cdef double r = q[0]
  *     cdef double phi = q[1]
  *     cdef double pr = p[0]             # <<<<<<<<<<<<<<
  *     cdef double pphi = p[1]
  *     cdef double nu = eob_pars.p_params.nu
  */
-  __Pyx_TraceLine(2117,0,__PYX_ERR(0, 2117, __pyx_L1_error))
+  __Pyx_TraceLine(2237,0,__PYX_ERR(0, 2237, __pyx_L1_error))
   __pyx_t_1 = 0;
   __pyx_v_pr = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_p.data) + __pyx_t_1)) )));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2118
+  /* "pyseobnr/eob/waveform/waveform.pyx":2238
  *     cdef double phi = q[1]
  *     cdef double pr = p[0]
  *     cdef double pphi = p[1]             # <<<<<<<<<<<<<<
  *     cdef double nu = eob_pars.p_params.nu
  *     # Note the multiplication of H by nu!
  */
-  __Pyx_TraceLine(2118,0,__PYX_ERR(0, 2118, __pyx_L1_error))
+  __Pyx_TraceLine(2238,0,__PYX_ERR(0, 2238, __pyx_L1_error))
   __pyx_t_1 = 1;
   __pyx_v_pphi = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_p.data) + __pyx_t_1)) )));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2119
+  /* "pyseobnr/eob/waveform/waveform.pyx":2239
  *     cdef double pr = p[0]
  *     cdef double pphi = p[1]
  *     cdef double nu = eob_pars.p_params.nu             # <<<<<<<<<<<<<<
  *     # Note the multiplication of H by nu!
- *     cdef double flux = compute_flux(r,phi,pr,pphi,omega,omega_circ,nu*H,eob_pars)
+ *     cdef double flux = compute_flux(r, phi, pr, pphi, omega, omega_circ, nu*H, eob_pars)
  */
-  __Pyx_TraceLine(2119,0,__PYX_ERR(0, 2119, __pyx_L1_error))
+  __Pyx_TraceLine(2239,0,__PYX_ERR(0, 2239, __pyx_L1_error))
   __pyx_t_2 = __pyx_v_eob_pars->p_params->nu;
   __pyx_v_nu = __pyx_t_2;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2121
+  /* "pyseobnr/eob/waveform/waveform.pyx":2241
  *     cdef double nu = eob_pars.p_params.nu
  *     # Note the multiplication of H by nu!
- *     cdef double flux = compute_flux(r,phi,pr,pphi,omega,omega_circ,nu*H,eob_pars)             # <<<<<<<<<<<<<<
+ *     cdef double flux = compute_flux(r, phi, pr, pphi, omega, omega_circ, nu*H, eob_pars)             # <<<<<<<<<<<<<<
  *     flux /= nu
  *     cdef double f_over_om = flux/omega
  */
-  __Pyx_TraceLine(2121,0,__PYX_ERR(0, 2121, __pyx_L1_error))
-  __pyx_t_2 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_flux(__pyx_v_r, __pyx_v_phi, __pyx_v_pr, __pyx_v_pphi, __pyx_v_omega, __pyx_v_omega_circ, (__pyx_v_nu * __pyx_v_H), __pyx_v_eob_pars, 0); if (unlikely(__pyx_t_2 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2121, __pyx_L1_error)
+  __Pyx_TraceLine(2241,0,__PYX_ERR(0, 2241, __pyx_L1_error))
+  __pyx_t_2 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_flux(__pyx_v_r, __pyx_v_phi, __pyx_v_pr, __pyx_v_pphi, __pyx_v_omega, __pyx_v_omega_circ, (__pyx_v_nu * __pyx_v_H), __pyx_v_eob_pars, 0); if (unlikely(__pyx_t_2 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2241, __pyx_L1_error)
   __pyx_v_flux = __pyx_t_2;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2122
+  /* "pyseobnr/eob/waveform/waveform.pyx":2242
  *     # Note the multiplication of H by nu!
- *     cdef double flux = compute_flux(r,phi,pr,pphi,omega,omega_circ,nu*H,eob_pars)
+ *     cdef double flux = compute_flux(r, phi, pr, pphi, omega, omega_circ, nu*H, eob_pars)
  *     flux /= nu             # <<<<<<<<<<<<<<
  *     cdef double f_over_om = flux/omega
  *     cdef double Fr = -pr / pphi * f_over_om
  */
-  __Pyx_TraceLine(2122,0,__PYX_ERR(0, 2122, __pyx_L1_error))
+  __Pyx_TraceLine(2242,0,__PYX_ERR(0, 2242, __pyx_L1_error))
   __pyx_v_flux = (__pyx_v_flux / __pyx_v_nu);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2123
- *     cdef double flux = compute_flux(r,phi,pr,pphi,omega,omega_circ,nu*H,eob_pars)
+  /* "pyseobnr/eob/waveform/waveform.pyx":2243
+ *     cdef double flux = compute_flux(r, phi, pr, pphi, omega, omega_circ, nu*H, eob_pars)
  *     flux /= nu
  *     cdef double f_over_om = flux/omega             # <<<<<<<<<<<<<<
  *     cdef double Fr = -pr / pphi * f_over_om
  *     cdef double Fphi = -f_over_om
  */
-  __Pyx_TraceLine(2123,0,__PYX_ERR(0, 2123, __pyx_L1_error))
+  __Pyx_TraceLine(2243,0,__PYX_ERR(0, 2243, __pyx_L1_error))
   __pyx_v_f_over_om = (__pyx_v_flux / __pyx_v_omega);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2124
+  /* "pyseobnr/eob/waveform/waveform.pyx":2244
  *     flux /= nu
  *     cdef double f_over_om = flux/omega
  *     cdef double Fr = -pr / pphi * f_over_om             # <<<<<<<<<<<<<<
  *     cdef double Fphi = -f_over_om
  *     return Fr, Fphi
  */
-  __Pyx_TraceLine(2124,0,__PYX_ERR(0, 2124, __pyx_L1_error))
+  __Pyx_TraceLine(2244,0,__PYX_ERR(0, 2244, __pyx_L1_error))
   __pyx_v_Fr = (((-__pyx_v_pr) / __pyx_v_pphi) * __pyx_v_f_over_om);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2125
+  /* "pyseobnr/eob/waveform/waveform.pyx":2245
  *     cdef double f_over_om = flux/omega
  *     cdef double Fr = -pr / pphi * f_over_om
  *     cdef double Fphi = -f_over_om             # <<<<<<<<<<<<<<
  *     return Fr, Fphi
  * 
  */
-  __Pyx_TraceLine(2125,0,__PYX_ERR(0, 2125, __pyx_L1_error))
+  __Pyx_TraceLine(2245,0,__PYX_ERR(0, 2245, __pyx_L1_error))
   __pyx_v_Fphi = (-__pyx_v_f_over_om);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2126
+  /* "pyseobnr/eob/waveform/waveform.pyx":2246
  *     cdef double Fr = -pr / pphi * f_over_om
  *     cdef double Fphi = -f_over_om
  *     return Fr, Fphi             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_TraceLine(2126,0,__PYX_ERR(0, 2126, __pyx_L1_error))
+  __Pyx_TraceLine(2246,0,__PYX_ERR(0, 2246, __pyx_L1_error))
   __pyx_t_3.f0 = __pyx_v_Fr;
   __pyx_t_3.f1 = __pyx_v_Fphi;
   __pyx_r = __pyx_t_3;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2110
+  /* "pyseobnr/eob/waveform/waveform.pyx":2224
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef (double,double) RR_force(double[::1] q, double[::1] p, double omega, double omega_circ,             # <<<<<<<<<<<<<<
- *     double H, EOBParams eob_pars):
- *     """
+ * cpdef (double, double) RR_force(             # <<<<<<<<<<<<<<
+ *     double[::1] q,
+ *     double[::1] p,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.RR_force", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_pretend_to_initialize(&__pyx_r);
   __pyx_L0:;
@@ -30654,91 +30712,91 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_q)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2110, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2224, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_p)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2110, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2224, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR_force", 1, 6, 6, 1); __PYX_ERR(0, 2110, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR_force", 1, 6, 6, 1); __PYX_ERR(0, 2224, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_omega)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2110, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2224, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR_force", 1, 6, 6, 2); __PYX_ERR(0, 2110, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR_force", 1, 6, 6, 2); __PYX_ERR(0, 2224, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_omega_circ)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2110, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2224, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR_force", 1, 6, 6, 3); __PYX_ERR(0, 2110, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR_force", 1, 6, 6, 3); __PYX_ERR(0, 2224, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_H)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2110, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2224, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR_force", 1, 6, 6, 4); __PYX_ERR(0, 2110, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR_force", 1, 6, 6, 4); __PYX_ERR(0, 2224, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_eob_pars)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[5]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2110, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2224, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR_force", 1, 6, 6, 5); __PYX_ERR(0, 2110, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR_force", 1, 6, 6, 5); __PYX_ERR(0, 2224, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "RR_force") < 0)) __PYX_ERR(0, 2110, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "RR_force") < 0)) __PYX_ERR(0, 2224, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 6)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
       values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
       values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
       values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
     }
-    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(0, 2110, __pyx_L3_error)
-    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(0, 2110, __pyx_L3_error)
-    __pyx_v_omega = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_omega == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2110, __pyx_L3_error)
-    __pyx_v_omega_circ = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_omega_circ == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2110, __pyx_L3_error)
-    __pyx_v_H = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_H == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2111, __pyx_L3_error)
+    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(0, 2225, __pyx_L3_error)
+    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(0, 2226, __pyx_L3_error)
+    __pyx_v_omega = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_omega == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2227, __pyx_L3_error)
+    __pyx_v_omega_circ = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_omega_circ == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2228, __pyx_L3_error)
+    __pyx_v_H = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_H == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2229, __pyx_L3_error)
     __pyx_v_eob_pars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)values[5]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("RR_force", 1, 6, 6, __pyx_nargs); __PYX_ERR(0, 2110, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("RR_force", 1, 6, 6, __pyx_nargs); __PYX_ERR(0, 2224, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -30746,15 +30804,15 @@
   }
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_q, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_p, 1);
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.RR_force", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_eob_pars), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "eob_pars", 0))) __PYX_ERR(0, 2111, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_eob_pars), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "eob_pars", 0))) __PYX_ERR(0, 2230, __pyx_L1_error)
   __pyx_r = __pyx_pf_8pyseobnr_3eob_8waveform_8waveform_18RR_force(__pyx_self, __pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H, __pyx_v_eob_pars);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -30777,18 +30835,18 @@
   __pyx_ctuple_double__and_double __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__15)
   __Pyx_RefNannySetupContext("RR_force", 1);
-  __Pyx_TraceCall("RR_force (wrapper)", __pyx_f[0], 2110, 0, __PYX_ERR(0, 2110, __pyx_L1_error));
+  __Pyx_TraceCall("RR_force (wrapper)", __pyx_f[0], 2224, 0, __PYX_ERR(0, 2224, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_RR_force(__pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H, __pyx_v_eob_pars, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2110, __pyx_L1_error)
-  __pyx_t_2 = __pyx_convert__to_py___pyx_ctuple_double__and_double(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2110, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_RR_force(__pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H, __pyx_v_eob_pars, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2224, __pyx_L1_error)
+  __pyx_t_2 = __pyx_convert__to_py___pyx_ctuple_double__and_double(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -30798,20 +30856,20 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2134
+/* "pyseobnr/eob/waveform/waveform.pyx":2253
  *     Convenience wrappers around the RR_force function to enable typed calls
  *     """
  *     def __cinit__(self):             # <<<<<<<<<<<<<<
  *         pass
- *     cpdef (double,double) RR(self, double[::1] q, double[::1] p, double omega,
+ * 
  */
 
 /* Python wrapper */
 static int __pyx_pw_8pyseobnr_3eob_8waveform_8waveform_22RadiationReactionForce_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static int __pyx_pw_8pyseobnr_3eob_8waveform_8waveform_22RadiationReactionForce_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   CYTHON_UNUSED Py_ssize_t __pyx_nargs;
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
@@ -30838,20 +30896,20 @@
   int __pyx_r;
 
   /* function exit code */
   __pyx_r = 0;
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2136
- *     def __cinit__(self):
- *         pass
- *     cpdef (double,double) RR(self, double[::1] q, double[::1] p, double omega,             # <<<<<<<<<<<<<<
- *         double omega_circ, double H, EOBParams eob_pars):
+/* "pyseobnr/eob/waveform/waveform.pyx":2256
  *         pass
+ * 
+ *     cpdef (double, double) RR(             # <<<<<<<<<<<<<<
+ *         self,
+ *         double[::1] q,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_22RadiationReactionForce_3RR(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
@@ -30880,28 +30938,28 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || __Pyx_PyType_HasFeature(Py_TYPE(((PyObject *)__pyx_v_self)), (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_typedict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_RR); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2136, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_RR); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2256, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!__Pyx_IsSameCFunction(__pyx_t_1, (void*) __pyx_pw_8pyseobnr_3eob_8waveform_8waveform_22RadiationReactionForce_3RR)) {
-        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(0, 2136, __pyx_L1_error) }
-        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2136, __pyx_L1_error)
+        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(0, 2256, __pyx_L1_error) }
+        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2256, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(0, 2136, __pyx_L1_error) }
-        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2136, __pyx_L1_error)
+        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(0, 2256, __pyx_L1_error) }
+        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2256, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_omega); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2136, __pyx_L1_error)
+        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_omega); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2256, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_omega_circ); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2136, __pyx_L1_error)
+        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_omega_circ); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2256, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_H); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2136, __pyx_L1_error)
+        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_H); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2256, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_8 = __pyx_t_1; __pyx_t_9 = NULL;
         __pyx_t_10 = 0;
         #if CYTHON_UNPACK_METHODS
         if (unlikely(PyMethod_Check(__pyx_t_8))) {
           __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_8);
@@ -30919,19 +30977,19 @@
           __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+1-__pyx_t_10, 6+__pyx_t_10);
           __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2136, __pyx_L1_error)
+          if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2256, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         }
-        __pyx_t_11 = __pyx_convert__from_py___pyx_ctuple_double__and_double(__pyx_t_2); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2136, __pyx_L1_error)
+        __pyx_t_11 = __pyx_convert__from_py___pyx_ctuple_double__and_double(__pyx_t_2); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2256, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __pyx_r = __pyx_t_11;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
       __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
@@ -30942,17 +31000,17 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2138
- *     cpdef (double,double) RR(self, double[::1] q, double[::1] p, double omega,
- *         double omega_circ, double H, EOBParams eob_pars):
+  /* "pyseobnr/eob/waveform/waveform.pyx":2265
+ *         EOBParams eob_pars
+ *     ):
  *         pass             # <<<<<<<<<<<<<<
  * 
  * 
  */
 
   /* function exit code */
   __Pyx_pretend_to_initialize(&__pyx_r);
@@ -30970,20 +31028,20 @@
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.RadiationReactionForce.RR", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_pretend_to_initialize(&__pyx_r);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2136
- *     def __cinit__(self):
- *         pass
- *     cpdef (double,double) RR(self, double[::1] q, double[::1] p, double omega,             # <<<<<<<<<<<<<<
- *         double omega_circ, double H, EOBParams eob_pars):
+/* "pyseobnr/eob/waveform/waveform.pyx":2256
  *         pass
+ * 
+ *     cpdef (double, double) RR(             # <<<<<<<<<<<<<<
+ *         self,
+ *         double[::1] q,
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_22RadiationReactionForce_3RR(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
@@ -31046,91 +31104,91 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_q)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2136, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2256, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_p)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2136, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2256, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 1); __PYX_ERR(0, 2136, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 1); __PYX_ERR(0, 2256, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_omega)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2136, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2256, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 2); __PYX_ERR(0, 2136, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 2); __PYX_ERR(0, 2256, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_omega_circ)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2136, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2256, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 3); __PYX_ERR(0, 2136, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 3); __PYX_ERR(0, 2256, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_H)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2136, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2256, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 4); __PYX_ERR(0, 2136, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 4); __PYX_ERR(0, 2256, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_eob_pars)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[5]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2136, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2256, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 5); __PYX_ERR(0, 2136, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 5); __PYX_ERR(0, 2256, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "RR") < 0)) __PYX_ERR(0, 2136, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "RR") < 0)) __PYX_ERR(0, 2256, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 6)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
       values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
       values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
       values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
     }
-    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(0, 2136, __pyx_L3_error)
-    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(0, 2136, __pyx_L3_error)
-    __pyx_v_omega = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_omega == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2136, __pyx_L3_error)
-    __pyx_v_omega_circ = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_omega_circ == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2137, __pyx_L3_error)
-    __pyx_v_H = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_H == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2137, __pyx_L3_error)
+    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(0, 2258, __pyx_L3_error)
+    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(0, 2259, __pyx_L3_error)
+    __pyx_v_omega = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_omega == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2260, __pyx_L3_error)
+    __pyx_v_omega_circ = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_omega_circ == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2261, __pyx_L3_error)
+    __pyx_v_H = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_H == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2262, __pyx_L3_error)
     __pyx_v_eob_pars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)values[5]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, __pyx_nargs); __PYX_ERR(0, 2136, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, __pyx_nargs); __PYX_ERR(0, 2256, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -31138,15 +31196,15 @@
   }
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_q, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_p, 1);
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.RadiationReactionForce.RR", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_eob_pars), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "eob_pars", 0))) __PYX_ERR(0, 2137, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_eob_pars), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "eob_pars", 0))) __PYX_ERR(0, 2263, __pyx_L1_error)
   __pyx_r = __pyx_pf_8pyseobnr_3eob_8waveform_8waveform_22RadiationReactionForce_2RR(((struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H, __pyx_v_eob_pars);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -31168,18 +31226,18 @@
   __pyx_ctuple_double__and_double __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("RR", 1);
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(0, 2136, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(0, 2136, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_22RadiationReactionForce_RR(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H, __pyx_v_eob_pars, 1); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2136, __pyx_L1_error)
-  __pyx_t_2 = __pyx_convert__to_py___pyx_ctuple_double__and_double(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2136, __pyx_L1_error)
+  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(0, 2256, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(0, 2256, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_22RadiationReactionForce_RR(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H, __pyx_v_eob_pars, 1); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2256, __pyx_L1_error)
+  __pyx_t_2 = __pyx_convert__to_py___pyx_ctuple_double__and_double(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2256, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -31402,17 +31460,17 @@
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.RadiationReactionForce.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2145
- *     Convenience wrappers around the RR_force function to enable typed calls
+/* "pyseobnr/eob/waveform/waveform.pyx":2273
  *     """
+ * 
  *     def __cinit__(self):             # <<<<<<<<<<<<<<
  *         pass
  * 
  */
 
 /* Python wrapper */
 static int __pyx_pw_8pyseobnr_3eob_8waveform_8waveform_15SEOBNRv5RRForce_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
@@ -31442,20 +31500,20 @@
   int __pyx_r;
 
   /* function exit code */
   __pyx_r = 0;
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2148
+/* "pyseobnr/eob/waveform/waveform.pyx":2276
  *         pass
  * 
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,             # <<<<<<<<<<<<<<
- *         double omega_circ, double H, EOBParams eob_pars):
- *         return RR_force(q, p, omega, omega_circ, H, eob_pars)
+ *     cpdef (double, double) RR(             # <<<<<<<<<<<<<<
+ *         self,
+ *         double[::1] q,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_15SEOBNRv5RRForce_3RR(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
@@ -31484,28 +31542,28 @@
   /* Check if overridden in Python */
   else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))->tp_dictoffset != 0) || __Pyx_PyType_HasFeature(Py_TYPE(((PyObject *)__pyx_v_self)), (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
     #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
     if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
       PY_UINT64_T __pyx_typedict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
       #endif
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_RR); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2148, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_RR); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2276, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (!__Pyx_IsSameCFunction(__pyx_t_1, (void*) __pyx_pw_8pyseobnr_3eob_8waveform_8waveform_15SEOBNRv5RRForce_3RR)) {
-        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(0, 2148, __pyx_L1_error) }
-        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2148, __pyx_L1_error)
+        if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(0, 2276, __pyx_L1_error) }
+        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_q, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2276, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(0, 2148, __pyx_L1_error) }
-        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2148, __pyx_L1_error)
+        if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(0, 2276, __pyx_L1_error) }
+        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2276, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_omega); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2148, __pyx_L1_error)
+        __pyx_t_5 = PyFloat_FromDouble(__pyx_v_omega); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2276, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_omega_circ); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2148, __pyx_L1_error)
+        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_omega_circ); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2276, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_H); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2148, __pyx_L1_error)
+        __pyx_t_7 = PyFloat_FromDouble(__pyx_v_H); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2276, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_1);
         __pyx_t_8 = __pyx_t_1; __pyx_t_9 = NULL;
         __pyx_t_10 = 0;
         #if CYTHON_UNPACK_METHODS
         if (unlikely(PyMethod_Check(__pyx_t_8))) {
           __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_8);
@@ -31523,19 +31581,19 @@
           __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+1-__pyx_t_10, 6+__pyx_t_10);
           __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2148, __pyx_L1_error)
+          if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2276, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         }
-        __pyx_t_11 = __pyx_convert__from_py___pyx_ctuple_double__and_double(__pyx_t_2); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2148, __pyx_L1_error)
+        __pyx_t_11 = __pyx_convert__from_py___pyx_ctuple_double__and_double(__pyx_t_2); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2276, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __pyx_r = __pyx_t_11;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         goto __pyx_L0;
       }
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
       __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
@@ -31546,31 +31604,31 @@
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       #if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
     }
     #endif
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2150
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,
- *         double omega_circ, double H, EOBParams eob_pars):
+  /* "pyseobnr/eob/waveform/waveform.pyx":2285
+ *         EOBParams eob_pars
+ *     ):
  *         return RR_force(q, p, omega, omega_circ, H, eob_pars)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_11 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_RR_force(__pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H, __pyx_v_eob_pars, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2150, __pyx_L1_error)
+  __pyx_t_11 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_RR_force(__pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H, __pyx_v_eob_pars, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2285, __pyx_L1_error)
   __pyx_r = __pyx_t_11;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2148
+  /* "pyseobnr/eob/waveform/waveform.pyx":2276
  *         pass
  * 
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,             # <<<<<<<<<<<<<<
- *         double omega_circ, double H, EOBParams eob_pars):
- *         return RR_force(q, p, omega, omega_circ, H, eob_pars)
+ *     cpdef (double, double) RR(             # <<<<<<<<<<<<<<
+ *         self,
+ *         double[::1] q,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
@@ -31651,91 +31709,91 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_q)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2148, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2276, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_p)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2148, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2276, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 1); __PYX_ERR(0, 2148, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 1); __PYX_ERR(0, 2276, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_omega)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2148, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2276, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 2); __PYX_ERR(0, 2148, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 2); __PYX_ERR(0, 2276, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_omega_circ)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2148, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2276, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 3); __PYX_ERR(0, 2148, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 3); __PYX_ERR(0, 2276, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_H)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2148, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2276, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 4); __PYX_ERR(0, 2148, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 4); __PYX_ERR(0, 2276, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_eob_pars)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[5]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2148, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2276, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 5); __PYX_ERR(0, 2148, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, 5); __PYX_ERR(0, 2276, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "RR") < 0)) __PYX_ERR(0, 2148, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "RR") < 0)) __PYX_ERR(0, 2276, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 6)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
       values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
       values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
       values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
     }
-    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(0, 2148, __pyx_L3_error)
-    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(0, 2148, __pyx_L3_error)
-    __pyx_v_omega = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_omega == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2148, __pyx_L3_error)
-    __pyx_v_omega_circ = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_omega_circ == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2149, __pyx_L3_error)
-    __pyx_v_H = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_H == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2149, __pyx_L3_error)
+    __pyx_v_q = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_q.memview)) __PYX_ERR(0, 2278, __pyx_L3_error)
+    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(0, 2279, __pyx_L3_error)
+    __pyx_v_omega = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_omega == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2280, __pyx_L3_error)
+    __pyx_v_omega_circ = __pyx_PyFloat_AsDouble(values[3]); if (unlikely((__pyx_v_omega_circ == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2281, __pyx_L3_error)
+    __pyx_v_H = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_H == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2282, __pyx_L3_error)
     __pyx_v_eob_pars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)values[5]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, __pyx_nargs); __PYX_ERR(0, 2148, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("RR", 1, 6, 6, __pyx_nargs); __PYX_ERR(0, 2276, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -31743,15 +31801,15 @@
   }
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_q, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_p, 1);
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.SEOBNRv5RRForce.RR", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_eob_pars), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "eob_pars", 0))) __PYX_ERR(0, 2149, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_eob_pars), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "eob_pars", 0))) __PYX_ERR(0, 2283, __pyx_L1_error)
   __pyx_r = __pyx_pf_8pyseobnr_3eob_8waveform_8waveform_15SEOBNRv5RRForce_2RR(((struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce *)__pyx_v_self), __pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H, __pyx_v_eob_pars);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -31773,18 +31831,18 @@
   __pyx_ctuple_double__and_double __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("RR", 1);
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(0, 2148, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(0, 2148, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_15SEOBNRv5RRForce_RR(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H, __pyx_v_eob_pars, 1); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2148, __pyx_L1_error)
-  __pyx_t_2 = __pyx_convert__to_py___pyx_ctuple_double__and_double(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2148, __pyx_L1_error)
+  if (unlikely(!__pyx_v_q.memview)) { __Pyx_RaiseUnboundLocalError("q"); __PYX_ERR(0, 2276, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_p.memview)) { __Pyx_RaiseUnboundLocalError("p"); __PYX_ERR(0, 2276, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_15SEOBNRv5RRForce_RR(__pyx_v_self, __pyx_v_q, __pyx_v_p, __pyx_v_omega, __pyx_v_omega_circ, __pyx_v_H, __pyx_v_eob_pars, 1); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2276, __pyx_L1_error)
+  __pyx_t_2 = __pyx_convert__to_py___pyx_ctuple_double__and_double(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2276, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -32007,20 +32065,20 @@
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.SEOBNRv5RRForce.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2161
+/* "pyseobnr/eob/waveform/waveform.pyx":2294
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cdef double complex EOBFluxCalculateNewtonianMultipole(             # <<<<<<<<<<<<<<
- *     double x, double phi, int l, int m, double complex[:,:] params
- * ):
+ *     double x,
+ *     double phi,
  */
 
 static __pyx_t_double_complex __pyx_f_8pyseobnr_3eob_8waveform_8waveform_EOBFluxCalculateNewtonianMultipole(double __pyx_v_x, double __pyx_v_phi, int __pyx_v_l, int __pyx_v_m, __Pyx_memviewslice __pyx_v_params) {
   __pyx_t_double_complex __pyx_v_param;
   int __pyx_v_epsilon;
   CYTHON_UNUSED __pyx_t_double_complex __pyx_v_y;
   __pyx_t_double_complex __pyx_v_ylm;
@@ -32028,112 +32086,112 @@
   __pyx_t_double_complex __pyx_r;
   __Pyx_TraceDeclarations
   Py_ssize_t __pyx_t_1;
   Py_ssize_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __Pyx_TraceCall("EOBFluxCalculateNewtonianMultipole", __pyx_f[0], 2161, 0, __PYX_ERR(0, 2161, __pyx_L1_error));
+  __Pyx_TraceCall("EOBFluxCalculateNewtonianMultipole", __pyx_f[0], 2294, 0, __PYX_ERR(0, 2294, __pyx_L1_error));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2167
+  /* "pyseobnr/eob/waveform/waveform.pyx":2304
  *     Compute the Newtonian multipole
  *     """
- *     cdef double complex param = params[l,m]             # <<<<<<<<<<<<<<
+ *     cdef double complex param = params[l, m]             # <<<<<<<<<<<<<<
  *     cdef int epsilon = (l + m) % 2
  * 
  */
-  __Pyx_TraceLine(2167,0,__PYX_ERR(0, 2167, __pyx_L1_error))
+  __Pyx_TraceLine(2304,0,__PYX_ERR(0, 2304, __pyx_L1_error))
   __pyx_t_1 = __pyx_v_l;
   __pyx_t_2 = __pyx_v_m;
   __pyx_v_param = (*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_params.data + __pyx_t_1 * __pyx_v_params.strides[0]) ) + __pyx_t_2 * __pyx_v_params.strides[1]) )));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2168
+  /* "pyseobnr/eob/waveform/waveform.pyx":2305
  *     """
- *     cdef double complex param = params[l,m]
+ *     cdef double complex param = params[l, m]
  *     cdef int epsilon = (l + m) % 2             # <<<<<<<<<<<<<<
  * 
- * 
+ *     cdef double complex y = 0.0
  */
-  __Pyx_TraceLine(2168,0,__PYX_ERR(0, 2168, __pyx_L1_error))
+  __Pyx_TraceLine(2305,0,__PYX_ERR(0, 2305, __pyx_L1_error))
   __pyx_v_epsilon = ((__pyx_v_l + __pyx_v_m) % 2);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2171
- * 
+  /* "pyseobnr/eob/waveform/waveform.pyx":2307
+ *     cdef int epsilon = (l + m) % 2
  * 
  *     cdef double complex y = 0.0             # <<<<<<<<<<<<<<
  *     # Calculate the necessary Ylm
  *     cdef double complex ylm = sph_harm(-m, l - epsilon, phi, pi / 2)
  */
-  __Pyx_TraceLine(2171,0,__PYX_ERR(0, 2171, __pyx_L1_error))
+  __Pyx_TraceLine(2307,0,__PYX_ERR(0, 2307, __pyx_L1_error))
   __pyx_v_y = __pyx_t_double_complex_from_parts(0.0, 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2173
+  /* "pyseobnr/eob/waveform/waveform.pyx":2309
  *     cdef double complex y = 0.0
  *     # Calculate the necessary Ylm
  *     cdef double complex ylm = sph_harm(-m, l - epsilon, phi, pi / 2)             # <<<<<<<<<<<<<<
  * 
- * 
+ *     cdef double complex multipole = param * x ** ((l + epsilon) / 2.0)
  */
-  __Pyx_TraceLine(2173,0,__PYX_ERR(0, 2173, __pyx_L1_error))
+  __Pyx_TraceLine(2309,0,__PYX_ERR(0, 2309, __pyx_L1_error))
   __pyx_v_ylm = __pyx_fuse_1__pyx_f_5scipy_7special_14cython_special_sph_harm((-__pyx_v_m), (__pyx_v_l - __pyx_v_epsilon), __pyx_v_phi, (((double)M_PI) / 2.0), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2176
- * 
+  /* "pyseobnr/eob/waveform/waveform.pyx":2311
+ *     cdef double complex ylm = sph_harm(-m, l - epsilon, phi, pi / 2)
  * 
  *     cdef double complex multipole = param * x ** ((l + epsilon) / 2.0)             # <<<<<<<<<<<<<<
  *     multipole *= ylm
  *     return multipole
  */
-  __Pyx_TraceLine(2176,0,__PYX_ERR(0, 2176, __pyx_L1_error))
+  __Pyx_TraceLine(2311,0,__PYX_ERR(0, 2311, __pyx_L1_error))
   __pyx_v_multipole = __Pyx_c_prod_double(__pyx_v_param, __pyx_t_double_complex_from_parts(pow(__pyx_v_x, (((double)(__pyx_v_l + __pyx_v_epsilon)) / 2.0)), 0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2177
+  /* "pyseobnr/eob/waveform/waveform.pyx":2312
  * 
  *     cdef double complex multipole = param * x ** ((l + epsilon) / 2.0)
  *     multipole *= ylm             # <<<<<<<<<<<<<<
  *     return multipole
  * 
  */
-  __Pyx_TraceLine(2177,0,__PYX_ERR(0, 2177, __pyx_L1_error))
+  __Pyx_TraceLine(2312,0,__PYX_ERR(0, 2312, __pyx_L1_error))
   __pyx_v_multipole = __Pyx_c_prod_double(__pyx_v_multipole, __pyx_v_ylm);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2178
+  /* "pyseobnr/eob/waveform/waveform.pyx":2313
  *     cdef double complex multipole = param * x ** ((l + epsilon) / 2.0)
  *     multipole *= ylm
  *     return multipole             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_TraceLine(2178,0,__PYX_ERR(0, 2178, __pyx_L1_error))
+  __Pyx_TraceLine(2313,0,__PYX_ERR(0, 2313, __pyx_L1_error))
   __pyx_r = __pyx_v_multipole;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2161
+  /* "pyseobnr/eob/waveform/waveform.pyx":2294
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cdef double complex EOBFluxCalculateNewtonianMultipole(             # <<<<<<<<<<<<<<
- *     double x, double phi, int l, int m, double complex[:,:] params
- * ):
+ *     double x,
+ *     double phi,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.EOBFluxCalculateNewtonianMultipole", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = __pyx_t_double_complex_from_parts(0, 0);
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2189
+/* "pyseobnr/eob/waveform/waveform.pyx":2324
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef double complex compute_mode(double v_phi2,double phi, double Slm, double[] vs,double[] vhs,int l, int m, EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     """
- *     Compute the given (l,m) mode at one instant in time.
+ * cdef double complex compute_mode(             # <<<<<<<<<<<<<<
+ *     double v_phi2,
+ *     double phi,
  */
 
 static __pyx_t_double_complex __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_mode(double __pyx_v_v_phi2, double __pyx_v_phi, double __pyx_v_Slm, double *__pyx_v_vs, double *__pyx_v_vhs, int __pyx_v_l, int __pyx_v_m, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *__pyx_v_eob_pars) {
   __pyx_t_double_complex __pyx_v_Tlm;
   __pyx_t_double_complex __pyx_v_hNewton;
   __pyx_t_double_complex __pyx_v_rholm;
   __pyx_t_double_complex __pyx_v_deltalm;
@@ -32151,206 +32209,206 @@
   __Pyx_RefNannyDeclarations
   __pyx_t_double_complex __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("compute_mode", 1);
-  __Pyx_TraceCall("compute_mode", __pyx_f[0], 2189, 0, __PYX_ERR(0, 2189, __pyx_L1_error));
+  __Pyx_TraceCall("compute_mode", __pyx_f[0], 2324, 0, __PYX_ERR(0, 2324, __pyx_L1_error));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2196
+  /* "pyseobnr/eob/waveform/waveform.pyx":2340
  * 
- *     cdef double complex Tlm,hNewton,rholm,deltalm
+ *     cdef double complex Tlm, hNewton, rholm, deltalm
  *     cdef double v = vs[1]             # <<<<<<<<<<<<<<
  *     cdef double vh = vhs[1]
  * 
  */
-  __Pyx_TraceLine(2196,0,__PYX_ERR(0, 2196, __pyx_L1_error))
+  __Pyx_TraceLine(2340,0,__PYX_ERR(0, 2340, __pyx_L1_error))
   __pyx_v_v = (__pyx_v_vs[1]);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2197
- *     cdef double complex Tlm,hNewton,rholm,deltalm
+  /* "pyseobnr/eob/waveform/waveform.pyx":2341
+ *     cdef double complex Tlm, hNewton, rholm, deltalm
  *     cdef double v = vs[1]
  *     cdef double vh = vhs[1]             # <<<<<<<<<<<<<<
  * 
  *     # Compute the tail
  */
-  __Pyx_TraceLine(2197,0,__PYX_ERR(0, 2197, __pyx_L1_error))
+  __Pyx_TraceLine(2341,0,__PYX_ERR(0, 2341, __pyx_L1_error))
   __pyx_v_vh = (__pyx_v_vhs[1]);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2200
+  /* "pyseobnr/eob/waveform/waveform.pyx":2344
  * 
  *     # Compute the tail
- *     cdef double k = m*v*v*v # this is just m*Omega             # <<<<<<<<<<<<<<
- *     cdef double hathatk = m*vh*vh*vh # this is just m*Omega*H
+ *     cdef double k = m*v*v*v  # this is just m*Omega             # <<<<<<<<<<<<<<
+ *     cdef double hathatk = m*vh*vh*vh  # this is just m*Omega*H
  *     # This is just l!
  */
-  __Pyx_TraceLine(2200,0,__PYX_ERR(0, 2200, __pyx_L1_error))
+  __Pyx_TraceLine(2344,0,__PYX_ERR(0, 2344, __pyx_L1_error))
   __pyx_v_k = (((__pyx_v_m * __pyx_v_v) * __pyx_v_v) * __pyx_v_v);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2201
+  /* "pyseobnr/eob/waveform/waveform.pyx":2345
  *     # Compute the tail
- *     cdef double k = m*v*v*v # this is just m*Omega
- *     cdef double hathatk = m*vh*vh*vh # this is just m*Omega*H             # <<<<<<<<<<<<<<
+ *     cdef double k = m*v*v*v  # this is just m*Omega
+ *     cdef double hathatk = m*vh*vh*vh  # this is just m*Omega*H             # <<<<<<<<<<<<<<
  *     # This is just l!
  *     cdef double z2 = tgamma(l+1)
  */
-  __Pyx_TraceLine(2201,0,__PYX_ERR(0, 2201, __pyx_L1_error))
+  __Pyx_TraceLine(2345,0,__PYX_ERR(0, 2345, __pyx_L1_error))
   __pyx_v_hathatk = (((__pyx_v_m * __pyx_v_vh) * __pyx_v_vh) * __pyx_v_vh);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2203
- *     cdef double hathatk = m*vh*vh*vh # this is just m*Omega*H
+  /* "pyseobnr/eob/waveform/waveform.pyx":2347
+ *     cdef double hathatk = m*vh*vh*vh  # this is just m*Omega*H
  *     # This is just l!
  *     cdef double z2 = tgamma(l+1)             # <<<<<<<<<<<<<<
  *     cdef double complex lnr1 = loggamma(l+1.0-2.0*hathatk*I)
  * 
  */
-  __Pyx_TraceLine(2203,0,__PYX_ERR(0, 2203, __pyx_L1_error))
+  __Pyx_TraceLine(2347,0,__PYX_ERR(0, 2347, __pyx_L1_error))
   __pyx_v_z2 = tgamma((__pyx_v_l + 1));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2204
+  /* "pyseobnr/eob/waveform/waveform.pyx":2348
  *     # This is just l!
  *     cdef double z2 = tgamma(l+1)
  *     cdef double complex lnr1 = loggamma(l+1.0-2.0*hathatk*I)             # <<<<<<<<<<<<<<
  * 
  *     cdef double lnr1_abs = cabs(lnr1)
  */
-  __Pyx_TraceLine(2204,0,__PYX_ERR(0, 2204, __pyx_L1_error))
+  __Pyx_TraceLine(2348,0,__PYX_ERR(0, 2348, __pyx_L1_error))
   __pyx_v_lnr1 = __pyx_fuse_0__pyx_f_5scipy_7special_14cython_special_loggamma(__Pyx_c_diff_double(__pyx_t_double_complex_from_parts((__pyx_v_l + 1.0), 0), __Pyx_c_prod_double(__pyx_t_double_complex_from_parts((2.0 * __pyx_v_hathatk), 0), I)), 0);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2206
+  /* "pyseobnr/eob/waveform/waveform.pyx":2350
  *     cdef double complex lnr1 = loggamma(l+1.0-2.0*hathatk*I)
  * 
  *     cdef double lnr1_abs = cabs(lnr1)             # <<<<<<<<<<<<<<
  *     cdef double lnr1_arg = carg(lnr1)
  * 
  */
-  __Pyx_TraceLine(2206,0,__PYX_ERR(0, 2206, __pyx_L1_error))
+  __Pyx_TraceLine(2350,0,__PYX_ERR(0, 2350, __pyx_L1_error))
   __pyx_v_lnr1_abs = cabs(__pyx_v_lnr1);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2207
+  /* "pyseobnr/eob/waveform/waveform.pyx":2351
  * 
  *     cdef double lnr1_abs = cabs(lnr1)
  *     cdef double lnr1_arg = carg(lnr1)             # <<<<<<<<<<<<<<
  * 
- *     Tlm = cexp((pi * hathatk) +
+ *     Tlm = (
  */
-  __Pyx_TraceLine(2207,0,__PYX_ERR(0, 2207, __pyx_L1_error))
+  __Pyx_TraceLine(2351,0,__PYX_ERR(0, 2351, __pyx_L1_error))
   __pyx_v_lnr1_arg = carg(__pyx_v_lnr1);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2210
- * 
- *     Tlm = cexp((pi * hathatk) +
- * 	  I * (2.0 * hathatk * log(4.0 * k / sqrt(M_E)))) * cexp(lnr1)             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":2357
+ *             (pi * hathatk)
+ *             + I * (2.0 * hathatk * log(4.0 * k / sqrt(M_E))))
+ *         * cexp(lnr1)             # <<<<<<<<<<<<<<
+ *     )
  *     Tlm /= z2
- * 
  */
-  __Pyx_TraceLine(2210,0,__PYX_ERR(0, 2210, __pyx_L1_error))
+  __Pyx_TraceLine(2357,0,__PYX_ERR(0, 2357, __pyx_L1_error))
   __pyx_v_Tlm = __Pyx_c_prod_double(cexp(__Pyx_c_sum_double(__pyx_t_double_complex_from_parts((M_PI * __pyx_v_hathatk), 0), __Pyx_c_prod_double(I, __pyx_t_double_complex_from_parts(((2.0 * __pyx_v_hathatk) * log(((4.0 * __pyx_v_k) / sqrt(M_E)))), 0)))), cexp(__pyx_v_lnr1));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2211
- *     Tlm = cexp((pi * hathatk) +
- * 	  I * (2.0 * hathatk * log(4.0 * k / sqrt(M_E)))) * cexp(lnr1)
+  /* "pyseobnr/eob/waveform/waveform.pyx":2359
+ *         * cexp(lnr1)
+ *     )
  *     Tlm /= z2             # <<<<<<<<<<<<<<
  * 
  *     # Calculate the newtonian multipole, 1st term in Eq. 17, given by Eq. A1
  */
-  __Pyx_TraceLine(2211,0,__PYX_ERR(0, 2211, __pyx_L1_error))
+  __Pyx_TraceLine(2359,0,__PYX_ERR(0, 2359, __pyx_L1_error))
   __pyx_v_Tlm = __Pyx_c_quot_double(__pyx_v_Tlm, __pyx_t_double_complex_from_parts(__pyx_v_z2, 0));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2214
+  /* "pyseobnr/eob/waveform/waveform.pyx":2362
  * 
  *     # Calculate the newtonian multipole, 1st term in Eq. 17, given by Eq. A1
  *     hNewton = EOBFluxCalculateNewtonianMultipole(             # <<<<<<<<<<<<<<
  *         v_phi2, phi, l, m, eob_pars.flux_params.prefixes
  *     )
  */
-  __Pyx_TraceLine(2214,0,__PYX_ERR(0, 2214, __pyx_L1_error))
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_EOBFluxCalculateNewtonianMultipole(__pyx_v_v_phi2, __pyx_v_phi, __pyx_v_l, __pyx_v_m, __pyx_v_eob_pars->flux_params->prefixes); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2214, __pyx_L1_error)
+  __Pyx_TraceLine(2362,0,__PYX_ERR(0, 2362, __pyx_L1_error))
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_EOBFluxCalculateNewtonianMultipole(__pyx_v_v_phi2, __pyx_v_phi, __pyx_v_l, __pyx_v_m, __pyx_v_eob_pars->flux_params->prefixes); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2362, __pyx_L1_error)
   __pyx_v_hNewton = __pyx_t_1;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2219
+  /* "pyseobnr/eob/waveform/waveform.pyx":2367
  * 
  *     # Compute rho^l
- *     rholm = compute_rholm_single(vs,vh,l,m,eob_pars)             # <<<<<<<<<<<<<<
+ *     rholm = compute_rholm_single(vs, vh, l, m, eob_pars)             # <<<<<<<<<<<<<<
  *     # Compute delta
- *     deltalm = compute_deltalm_single(vs,vhs,l,m,eob_pars.flux_params)
+ *     deltalm = compute_deltalm_single(vs, vhs, l, m, eob_pars.flux_params)
  */
-  __Pyx_TraceLine(2219,0,__PYX_ERR(0, 2219, __pyx_L1_error))
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rholm_single(__pyx_v_vs, __pyx_v_vh, __pyx_v_l, __pyx_v_m, __pyx_v_eob_pars); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2219, __pyx_L1_error)
+  __Pyx_TraceLine(2367,0,__PYX_ERR(0, 2367, __pyx_L1_error))
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rholm_single(__pyx_v_vs, __pyx_v_vh, __pyx_v_l, __pyx_v_m, __pyx_v_eob_pars); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2367, __pyx_L1_error)
   __pyx_v_rholm = __pyx_t_1;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2221
- *     rholm = compute_rholm_single(vs,vh,l,m,eob_pars)
+  /* "pyseobnr/eob/waveform/waveform.pyx":2369
+ *     rholm = compute_rholm_single(vs, vh, l, m, eob_pars)
  *     # Compute delta
- *     deltalm = compute_deltalm_single(vs,vhs,l,m,eob_pars.flux_params)             # <<<<<<<<<<<<<<
+ *     deltalm = compute_deltalm_single(vs, vhs, l, m, eob_pars.flux_params)             # <<<<<<<<<<<<<<
  *     # Put everything together
  *     cdef double complex hlm = Tlm * cexp (I * deltalm) * Slm * rholm
  */
-  __Pyx_TraceLine(2221,0,__PYX_ERR(0, 2221, __pyx_L1_error))
+  __Pyx_TraceLine(2369,0,__PYX_ERR(0, 2369, __pyx_L1_error))
   __pyx_t_2 = ((PyObject *)__pyx_v_eob_pars->flux_params);
   __Pyx_INCREF(__pyx_t_2);
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_deltalm_single(__pyx_v_vs, __pyx_v_vhs, __pyx_v_l, __pyx_v_m, ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_t_2)); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2221, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_deltalm_single(__pyx_v_vs, __pyx_v_vhs, __pyx_v_l, __pyx_v_m, ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams *)__pyx_t_2)); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2369, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_deltalm = __pyx_t_1;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2223
- *     deltalm = compute_deltalm_single(vs,vhs,l,m,eob_pars.flux_params)
+  /* "pyseobnr/eob/waveform/waveform.pyx":2371
+ *     deltalm = compute_deltalm_single(vs, vhs, l, m, eob_pars.flux_params)
  *     # Put everything together
  *     cdef double complex hlm = Tlm * cexp (I * deltalm) * Slm * rholm             # <<<<<<<<<<<<<<
  *     hlm *= hNewton
  *     return hlm
  */
-  __Pyx_TraceLine(2223,0,__PYX_ERR(0, 2223, __pyx_L1_error))
+  __Pyx_TraceLine(2371,0,__PYX_ERR(0, 2371, __pyx_L1_error))
   __pyx_v_hlm = __Pyx_c_prod_double(__Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_v_Tlm, cexp(__Pyx_c_prod_double(I, __pyx_v_deltalm))), __pyx_t_double_complex_from_parts(__pyx_v_Slm, 0)), __pyx_v_rholm);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2224
+  /* "pyseobnr/eob/waveform/waveform.pyx":2372
  *     # Put everything together
  *     cdef double complex hlm = Tlm * cexp (I * deltalm) * Slm * rholm
  *     hlm *= hNewton             # <<<<<<<<<<<<<<
  *     return hlm
  * 
  */
-  __Pyx_TraceLine(2224,0,__PYX_ERR(0, 2224, __pyx_L1_error))
+  __Pyx_TraceLine(2372,0,__PYX_ERR(0, 2372, __pyx_L1_error))
   __pyx_v_hlm = __Pyx_c_prod_double(__pyx_v_hlm, __pyx_v_hNewton);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2225
+  /* "pyseobnr/eob/waveform/waveform.pyx":2373
  *     cdef double complex hlm = Tlm * cexp (I * deltalm) * Slm * rholm
  *     hlm *= hNewton
  *     return hlm             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_TraceLine(2225,0,__PYX_ERR(0, 2225, __pyx_L1_error))
+  __Pyx_TraceLine(2373,0,__PYX_ERR(0, 2373, __pyx_L1_error))
   __pyx_r = __pyx_v_hlm;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2189
+  /* "pyseobnr/eob/waveform/waveform.pyx":2324
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef double complex compute_mode(double v_phi2,double phi, double Slm, double[] vs,double[] vhs,int l, int m, EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     """
- *     Compute the given (l,m) mode at one instant in time.
+ * cdef double complex compute_mode(             # <<<<<<<<<<<<<<
+ *     double v_phi2,
+ *     double phi,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.compute_mode", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = __pyx_t_double_complex_from_parts(0, 0);
   __pyx_L0:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2237
+/* "pyseobnr/eob/waveform/waveform.pyx":2384
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef compute_hlms(double[:,:] dynamics, EOBParams eob_pars):             # <<<<<<<<<<<<<<
+ * cpdef compute_hlms(double[:, :] dynamics, EOBParams eob_pars):             # <<<<<<<<<<<<<<
  *     """
  *     Compute the inspiral modes for aligned *or* precessing binaries.
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_21compute_hlms(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
@@ -32418,224 +32476,251 @@
   Py_ssize_t __pyx_t_25;
   __Pyx_memviewslice __pyx_t_26 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__16)
   __Pyx_RefNannySetupContext("compute_hlms", 1);
-  __Pyx_TraceCall("compute_hlms", __pyx_f[0], 2237, 0, __PYX_ERR(0, 2237, __pyx_L1_error));
+  __Pyx_TraceCall("compute_hlms", __pyx_f[0], 2384, 0, __PYX_ERR(0, 2384, __pyx_L1_error));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2253
+  /* "pyseobnr/eob/waveform/waveform.pyx":2400
  *     cdef double[:] row
  * 
  *     cdef double Slm = 0.0             # <<<<<<<<<<<<<<
  *     cdef double source1
  *     cdef double source2
  */
-  __Pyx_TraceLine(2253,0,__PYX_ERR(0, 2253, __pyx_L1_error))
+  __Pyx_TraceLine(2400,0,__PYX_ERR(0, 2400, __pyx_L1_error))
   __pyx_v_Slm = 0.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2257
+  /* "pyseobnr/eob/waveform/waveform.pyx":2404
  *     cdef double source2
- *     cdef (int,int) ell_m
+ *     cdef (int, int) ell_m
  *     cdef double nu = eob_pars.p_params.nu             # <<<<<<<<<<<<<<
  *     cdef double complex tmp
  * 
  */
-  __Pyx_TraceLine(2257,0,__PYX_ERR(0, 2257, __pyx_L1_error))
+  __Pyx_TraceLine(2404,0,__PYX_ERR(0, 2404, __pyx_L1_error))
   __pyx_t_1 = __pyx_v_eob_pars->p_params->nu;
   __pyx_v_nu = __pyx_t_1;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2263
+  /* "pyseobnr/eob/waveform/waveform.pyx":2410
  *     cdef double vhs[PN_limit]
  *     cdef double complex rho
- *     compute_rho_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,             # <<<<<<<<<<<<<<
- *                 eob_pars.p_params.chi_A, eob_pars.flux_params.rho_coeffs,eob_pars.flux_params.rho_coeffs_log,
- *                 eob_pars.flux_params.f_coeffs,eob_pars.flux_params.f_coeffs_vh, eob_pars.flux_params.extra_PN_terms)
- */
-  __Pyx_TraceLine(2263,0,__PYX_ERR(0, 2263, __pyx_L1_error))
-  __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rho_coeffs(__pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars->p_params->delta, __pyx_v_eob_pars->p_params->a, __pyx_v_eob_pars->p_params->chi_S, __pyx_v_eob_pars->p_params->chi_A, __pyx_v_eob_pars->flux_params->rho_coeffs, __pyx_v_eob_pars->flux_params->rho_coeffs_log, __pyx_v_eob_pars->flux_params->f_coeffs, __pyx_v_eob_pars->flux_params->f_coeffs_vh, __pyx_v_eob_pars->flux_params->extra_PN_terms, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2263, __pyx_L1_error)
-
-  /* "pyseobnr/eob/waveform/waveform.pyx":2267
- *                 eob_pars.flux_params.f_coeffs,eob_pars.flux_params.f_coeffs_vh, eob_pars.flux_params.extra_PN_terms)
- * 
- *     compute_delta_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,             # <<<<<<<<<<<<<<
- *         eob_pars.p_params.chi_A, eob_pars.flux_params.delta_coeffs,eob_pars.flux_params.delta_coeffs_vh)
- * 
+ *     compute_rho_coeffs(             # <<<<<<<<<<<<<<
+ *         eob_pars.p_params.nu,
+ *         eob_pars.p_params.delta,
+ */
+  __Pyx_TraceLine(2410,0,__PYX_ERR(0, 2410, __pyx_L1_error))
+  __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rho_coeffs(__pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars->p_params->delta, __pyx_v_eob_pars->p_params->a, __pyx_v_eob_pars->p_params->chi_S, __pyx_v_eob_pars->p_params->chi_A, __pyx_v_eob_pars->flux_params->rho_coeffs, __pyx_v_eob_pars->flux_params->rho_coeffs_log, __pyx_v_eob_pars->flux_params->f_coeffs, __pyx_v_eob_pars->flux_params->f_coeffs_vh, __pyx_v_eob_pars->flux_params->extra_PN_terms, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2410, __pyx_L1_error)
+
+  /* "pyseobnr/eob/waveform/waveform.pyx":2422
+ *         eob_pars.flux_params.extra_PN_terms)
+ * 
+ *     compute_delta_coeffs(             # <<<<<<<<<<<<<<
+ *         eob_pars.p_params.nu,
+ *         eob_pars.p_params.delta,
  */
-  __Pyx_TraceLine(2267,0,__PYX_ERR(0, 2267, __pyx_L1_error))
-  compute_delta_coeffs(__pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars->p_params->delta, __pyx_v_eob_pars->p_params->a, __pyx_v_eob_pars->p_params->chi_S, __pyx_v_eob_pars->p_params->chi_A, __pyx_v_eob_pars->flux_params->delta_coeffs, __pyx_v_eob_pars->flux_params->delta_coeffs_vh); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2267, __pyx_L1_error)
+  __Pyx_TraceLine(2422,0,__PYX_ERR(0, 2422, __pyx_L1_error))
+  compute_delta_coeffs(__pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars->p_params->delta, __pyx_v_eob_pars->p_params->a, __pyx_v_eob_pars->p_params->chi_S, __pyx_v_eob_pars->p_params->chi_A, __pyx_v_eob_pars->flux_params->delta_coeffs, __pyx_v_eob_pars->flux_params->delta_coeffs_vh); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2422, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2270
- *         eob_pars.p_params.chi_A, eob_pars.flux_params.delta_coeffs,eob_pars.flux_params.delta_coeffs_vh)
+  /* "pyseobnr/eob/waveform/waveform.pyx":2431
+ *         eob_pars.flux_params.delta_coeffs_vh)
  * 
  *     cdef int N = dynamics.shape[0]             # <<<<<<<<<<<<<<
- *     cdef dict modes = {(ell_m[0],ell_m[1]):np.zeros(N,dtype=np.complex128) for ell_m in eob_pars.mode_array}
- *     cdef double complex[:,:,:] temp_modes = np.zeros((ell_max,ell_max,N),dtype=np.complex128)
+ *     cdef dict modes = {
+ *         (ell_m[0], ell_m[1]): np.zeros(N, dtype=np.complex128)
  */
-  __Pyx_TraceLine(2270,0,__PYX_ERR(0, 2270, __pyx_L1_error))
+  __Pyx_TraceLine(2431,0,__PYX_ERR(0, 2431, __pyx_L1_error))
   __pyx_v_N = (__pyx_v_dynamics.shape[0]);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2271
+  /* "pyseobnr/eob/waveform/waveform.pyx":2432
  * 
  *     cdef int N = dynamics.shape[0]
- *     cdef dict modes = {(ell_m[0],ell_m[1]):np.zeros(N,dtype=np.complex128) for ell_m in eob_pars.mode_array}             # <<<<<<<<<<<<<<
- *     cdef double complex[:,:,:] temp_modes = np.zeros((ell_max,ell_max,N),dtype=np.complex128)
- *     # Compute all the modes
+ *     cdef dict modes = {             # <<<<<<<<<<<<<<
+ *         (ell_m[0], ell_m[1]): np.zeros(N, dtype=np.complex128)
+ *         for ell_m in eob_pars.mode_array
  */
-  __Pyx_TraceLine(2271,0,__PYX_ERR(0, 2271, __pyx_L1_error))
+  __Pyx_TraceLine(2432,0,__PYX_ERR(0, 2432, __pyx_L1_error))
   { /* enter inner scope */
-    __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2271, __pyx_L1_error)
+    __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2432, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
+
+    /* "pyseobnr/eob/waveform/waveform.pyx":2434
+ *     cdef dict modes = {
+ *         (ell_m[0], ell_m[1]): np.zeros(N, dtype=np.complex128)
+ *         for ell_m in eob_pars.mode_array             # <<<<<<<<<<<<<<
+ *     }
+ *     cdef double complex[:, :, :] temp_modes = np.zeros((ell_max, ell_max, N), dtype=np.complex128)
+ */
+    __Pyx_TraceLine(2434,0,__PYX_ERR(0, 2434, __pyx_L1_error))
     if (unlikely(__pyx_v_eob_pars->mode_array == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-      __PYX_ERR(0, 2271, __pyx_L1_error)
+      __PYX_ERR(0, 2434, __pyx_L1_error)
     }
     __pyx_t_3 = __pyx_v_eob_pars->mode_array; __Pyx_INCREF(__pyx_t_3);
     __pyx_t_4 = 0;
     for (;;) {
       {
         Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_3);
         #if !CYTHON_ASSUME_SAFE_MACROS
-        if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 2271, __pyx_L1_error)
+        if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 2434, __pyx_L1_error)
         #endif
         if (__pyx_t_4 >= __pyx_temp) break;
       }
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-      __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely((0 < 0))) __PYX_ERR(0, 2271, __pyx_L1_error)
+      __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely((0 < 0))) __PYX_ERR(0, 2434, __pyx_L1_error)
       #else
-      __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2271, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2434, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       #endif
-      __pyx_t_6 = __pyx_convert__from_py___pyx_ctuple_int__and_int(__pyx_t_5); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2271, __pyx_L1_error)
+      __pyx_t_6 = __pyx_convert__from_py___pyx_ctuple_int__and_int(__pyx_t_5); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2434, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_7genexpr__pyx_v_ell_m = __pyx_t_6;
-      __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_7genexpr__pyx_v_ell_m.f0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2271, __pyx_L1_error)
+
+      /* "pyseobnr/eob/waveform/waveform.pyx":2433
+ *     cdef int N = dynamics.shape[0]
+ *     cdef dict modes = {
+ *         (ell_m[0], ell_m[1]): np.zeros(N, dtype=np.complex128)             # <<<<<<<<<<<<<<
+ *         for ell_m in eob_pars.mode_array
+ *     }
+ */
+      __Pyx_TraceLine(2433,0,__PYX_ERR(0, 2433, __pyx_L1_error))
+      __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_7genexpr__pyx_v_ell_m.f0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2433, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_7genexpr__pyx_v_ell_m.f1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2271, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_7genexpr__pyx_v_ell_m.f1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2433, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2271, __pyx_L1_error)
+      __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2433, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_5);
-      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_5)) __PYX_ERR(0, 2271, __pyx_L1_error);
+      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_5)) __PYX_ERR(0, 2433, __pyx_L1_error);
       __Pyx_GIVEREF(__pyx_t_7);
-      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_7)) __PYX_ERR(0, 2271, __pyx_L1_error);
+      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_7)) __PYX_ERR(0, 2433, __pyx_L1_error);
       __pyx_t_5 = 0;
       __pyx_t_7 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2271, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2433, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2271, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2433, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_N); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2271, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_N); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2433, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2271, __pyx_L1_error)
+      __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2433, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_GIVEREF(__pyx_t_7);
-      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7)) __PYX_ERR(0, 2271, __pyx_L1_error);
+      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7)) __PYX_ERR(0, 2433, __pyx_L1_error);
       __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2271, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2433, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2271, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2433, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_complex128); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2271, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_complex128); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2433, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_11) < 0) __PYX_ERR(0, 2271, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_11) < 0) __PYX_ERR(0, 2433, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_9, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2271, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_9, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2433, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(PyDict_SetItem(__pyx_t_2, (PyObject*)__pyx_t_8, (PyObject*)__pyx_t_11))) __PYX_ERR(0, 2271, __pyx_L1_error)
+      if (unlikely(PyDict_SetItem(__pyx_t_2, (PyObject*)__pyx_t_8, (PyObject*)__pyx_t_11))) __PYX_ERR(0, 2433, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
+
+      /* "pyseobnr/eob/waveform/waveform.pyx":2434
+ *     cdef dict modes = {
+ *         (ell_m[0], ell_m[1]): np.zeros(N, dtype=np.complex128)
+ *         for ell_m in eob_pars.mode_array             # <<<<<<<<<<<<<<
+ *     }
+ *     cdef double complex[:, :, :] temp_modes = np.zeros((ell_max, ell_max, N), dtype=np.complex128)
+ */
+      __Pyx_TraceLine(2434,0,__PYX_ERR(0, 2434, __pyx_L1_error))
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   } /* exit inner scope */
   __pyx_v_modes = ((PyObject*)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2272
- *     cdef int N = dynamics.shape[0]
- *     cdef dict modes = {(ell_m[0],ell_m[1]):np.zeros(N,dtype=np.complex128) for ell_m in eob_pars.mode_array}
- *     cdef double complex[:,:,:] temp_modes = np.zeros((ell_max,ell_max,N),dtype=np.complex128)             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":2436
+ *         for ell_m in eob_pars.mode_array
+ *     }
+ *     cdef double complex[:, :, :] temp_modes = np.zeros((ell_max, ell_max, N), dtype=np.complex128)             # <<<<<<<<<<<<<<
+ * 
  *     # Compute all the modes
- *     for i in range(N):
  */
-  __Pyx_TraceLine(2272,0,__PYX_ERR(0, 2272, __pyx_L1_error))
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2272, __pyx_L1_error)
+  __Pyx_TraceLine(2436,0,__PYX_ERR(0, 2436, __pyx_L1_error))
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2272, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_From_int(ell_max); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2272, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_int(ell_max); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_11 = __Pyx_PyInt_From_int(ell_max); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2272, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyInt_From_int(ell_max); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_N); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2272, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_N); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_7 = PyTuple_New(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2272, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_2);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_2)) __PYX_ERR(0, 2272, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_2)) __PYX_ERR(0, 2436, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_11);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_11)) __PYX_ERR(0, 2272, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_11)) __PYX_ERR(0, 2436, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_8);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_8)) __PYX_ERR(0, 2272, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_8)) __PYX_ERR(0, 2436, __pyx_L1_error);
   __pyx_t_2 = 0;
   __pyx_t_11 = 0;
   __pyx_t_8 = 0;
-  __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2272, __pyx_L1_error)
+  __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_GIVEREF(__pyx_t_7);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_7)) __PYX_ERR(0, 2272, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_7)) __PYX_ERR(0, 2436, __pyx_L1_error);
   __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2272, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2272, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_complex128); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2272, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_complex128); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 2272, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 2436, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2272, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 2272, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 2436, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_temp_modes = __pyx_t_12;
   __pyx_t_12.memview = NULL;
   __pyx_t_12.data = NULL;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2274
- *     cdef double complex[:,:,:] temp_modes = np.zeros((ell_max,ell_max,N),dtype=np.complex128)
+  /* "pyseobnr/eob/waveform/waveform.pyx":2439
+ * 
  *     # Compute all the modes
  *     for i in range(N):             # <<<<<<<<<<<<<<
  *         row = dynamics[i]
  *         r = row[0]
  */
-  __Pyx_TraceLine(2274,0,__PYX_ERR(0, 2274, __pyx_L1_error))
+  __Pyx_TraceLine(2439,0,__PYX_ERR(0, 2439, __pyx_L1_error))
   __pyx_t_13 = __pyx_v_N;
   __pyx_t_14 = __pyx_t_13;
   for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
     __pyx_v_i = __pyx_t_15;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2275
+    /* "pyseobnr/eob/waveform/waveform.pyx":2440
  *     # Compute all the modes
  *     for i in range(N):
  *         row = dynamics[i]             # <<<<<<<<<<<<<<
  *         r = row[0]
  *         phi = row[1]
  */
-    __Pyx_TraceLine(2275,0,__PYX_ERR(0, 2275, __pyx_L1_error))
+    __Pyx_TraceLine(2440,0,__PYX_ERR(0, 2440, __pyx_L1_error))
     __pyx_t_16.data = __pyx_v_dynamics.data;
     __pyx_t_16.memview = __pyx_v_dynamics.memview;
     __PYX_INC_MEMVIEW(&__pyx_t_16, 1);
     {
     Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
     Py_ssize_t __pyx_tmp_stride = __pyx_v_dynamics.strides[0];
         __pyx_t_16.data += __pyx_tmp_idx * __pyx_tmp_stride;
@@ -32646,437 +32731,437 @@
     __pyx_t_16.suboffsets[0] = -1;
 
 __PYX_XCLEAR_MEMVIEW(&__pyx_v_row, 1);
     __pyx_v_row = __pyx_t_16;
     __pyx_t_16.memview = NULL;
     __pyx_t_16.data = NULL;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2276
+    /* "pyseobnr/eob/waveform/waveform.pyx":2441
  *     for i in range(N):
  *         row = dynamics[i]
  *         r = row[0]             # <<<<<<<<<<<<<<
  *         phi = row[1]
  *         pr = row[2]
  */
-    __Pyx_TraceLine(2276,0,__PYX_ERR(0, 2276, __pyx_L1_error))
+    __Pyx_TraceLine(2441,0,__PYX_ERR(0, 2441, __pyx_L1_error))
     __pyx_t_17 = 0;
     __pyx_v_r = (*((double *) ( /* dim=0 */ (__pyx_v_row.data + __pyx_t_17 * __pyx_v_row.strides[0]) )));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2277
+    /* "pyseobnr/eob/waveform/waveform.pyx":2442
  *         row = dynamics[i]
  *         r = row[0]
  *         phi = row[1]             # <<<<<<<<<<<<<<
  *         pr = row[2]
  *         pphi = row[3]
  */
-    __Pyx_TraceLine(2277,0,__PYX_ERR(0, 2277, __pyx_L1_error))
+    __Pyx_TraceLine(2442,0,__PYX_ERR(0, 2442, __pyx_L1_error))
     __pyx_t_17 = 1;
     __pyx_v_phi = (*((double *) ( /* dim=0 */ (__pyx_v_row.data + __pyx_t_17 * __pyx_v_row.strides[0]) )));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2278
+    /* "pyseobnr/eob/waveform/waveform.pyx":2443
  *         r = row[0]
  *         phi = row[1]
  *         pr = row[2]             # <<<<<<<<<<<<<<
  *         pphi = row[3]
  *         H = nu*row[4]
  */
-    __Pyx_TraceLine(2278,0,__PYX_ERR(0, 2278, __pyx_L1_error))
+    __Pyx_TraceLine(2443,0,__PYX_ERR(0, 2443, __pyx_L1_error))
     __pyx_t_17 = 2;
     __pyx_v_pr = (*((double *) ( /* dim=0 */ (__pyx_v_row.data + __pyx_t_17 * __pyx_v_row.strides[0]) )));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2279
+    /* "pyseobnr/eob/waveform/waveform.pyx":2444
  *         phi = row[1]
  *         pr = row[2]
  *         pphi = row[3]             # <<<<<<<<<<<<<<
  *         H = nu*row[4]
  *         omega = row[5]
  */
-    __Pyx_TraceLine(2279,0,__PYX_ERR(0, 2279, __pyx_L1_error))
+    __Pyx_TraceLine(2444,0,__PYX_ERR(0, 2444, __pyx_L1_error))
     __pyx_t_17 = 3;
     __pyx_v_pphi = (*((double *) ( /* dim=0 */ (__pyx_v_row.data + __pyx_t_17 * __pyx_v_row.strides[0]) )));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2280
+    /* "pyseobnr/eob/waveform/waveform.pyx":2445
  *         pr = row[2]
  *         pphi = row[3]
  *         H = nu*row[4]             # <<<<<<<<<<<<<<
  *         omega = row[5]
  *         omega_circ = row[6]
  */
-    __Pyx_TraceLine(2280,0,__PYX_ERR(0, 2280, __pyx_L1_error))
+    __Pyx_TraceLine(2445,0,__PYX_ERR(0, 2445, __pyx_L1_error))
     __pyx_t_17 = 4;
     __pyx_v_H = (__pyx_v_nu * (*((double *) ( /* dim=0 */ (__pyx_v_row.data + __pyx_t_17 * __pyx_v_row.strides[0]) ))));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2281
+    /* "pyseobnr/eob/waveform/waveform.pyx":2446
  *         pphi = row[3]
  *         H = nu*row[4]
  *         omega = row[5]             # <<<<<<<<<<<<<<
  *         omega_circ = row[6]
  *         v = omega**(1./3)
  */
-    __Pyx_TraceLine(2281,0,__PYX_ERR(0, 2281, __pyx_L1_error))
+    __Pyx_TraceLine(2446,0,__PYX_ERR(0, 2446, __pyx_L1_error))
     __pyx_t_17 = 5;
     __pyx_v_omega = (*((double *) ( /* dim=0 */ (__pyx_v_row.data + __pyx_t_17 * __pyx_v_row.strides[0]) )));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2282
+    /* "pyseobnr/eob/waveform/waveform.pyx":2447
  *         H = nu*row[4]
  *         omega = row[5]
  *         omega_circ = row[6]             # <<<<<<<<<<<<<<
  *         v = omega**(1./3)
  *         vh = (H*omega)**(1./3)
  */
-    __Pyx_TraceLine(2282,0,__PYX_ERR(0, 2282, __pyx_L1_error))
+    __Pyx_TraceLine(2447,0,__PYX_ERR(0, 2447, __pyx_L1_error))
     __pyx_t_17 = 6;
     __pyx_v_omega_circ = (*((double *) ( /* dim=0 */ (__pyx_v_row.data + __pyx_t_17 * __pyx_v_row.strides[0]) )));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2283
+    /* "pyseobnr/eob/waveform/waveform.pyx":2448
  *         omega = row[5]
  *         omega_circ = row[6]
  *         v = omega**(1./3)             # <<<<<<<<<<<<<<
  *         vh = (H*omega)**(1./3)
  *         # Various powers of v that enter the computation
  */
-    __Pyx_TraceLine(2283,0,__PYX_ERR(0, 2283, __pyx_L1_error))
+    __Pyx_TraceLine(2448,0,__PYX_ERR(0, 2448, __pyx_L1_error))
     __pyx_v_v = pow(__pyx_v_omega, (1. / 3.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2284
+    /* "pyseobnr/eob/waveform/waveform.pyx":2449
  *         omega_circ = row[6]
  *         v = omega**(1./3)
  *         vh = (H*omega)**(1./3)             # <<<<<<<<<<<<<<
  *         # Various powers of v that enter the computation
  *         # of rholm and deltalm
  */
-    __Pyx_TraceLine(2284,0,__PYX_ERR(0, 2284, __pyx_L1_error))
+    __Pyx_TraceLine(2449,0,__PYX_ERR(0, 2449, __pyx_L1_error))
     __pyx_v_vh = pow((__pyx_v_H * __pyx_v_omega), (1. / 3.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2287
+    /* "pyseobnr/eob/waveform/waveform.pyx":2452
  *         # Various powers of v that enter the computation
  *         # of rholm and deltalm
  *         for j in range(PN_limit):             # <<<<<<<<<<<<<<
  *             vs[j] = v**j
  *             vhs[j] = vh**j
  */
-    __Pyx_TraceLine(2287,0,__PYX_ERR(0, 2287, __pyx_L1_error))
+    __Pyx_TraceLine(2452,0,__PYX_ERR(0, 2452, __pyx_L1_error))
     __pyx_t_18 = PN_limit;
     __pyx_t_19 = __pyx_t_18;
     for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_19; __pyx_t_20+=1) {
       __pyx_v_j = __pyx_t_20;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2288
+      /* "pyseobnr/eob/waveform/waveform.pyx":2453
  *         # of rholm and deltalm
  *         for j in range(PN_limit):
  *             vs[j] = v**j             # <<<<<<<<<<<<<<
  *             vhs[j] = vh**j
  * 
  */
-      __Pyx_TraceLine(2288,0,__PYX_ERR(0, 2288, __pyx_L1_error))
+      __Pyx_TraceLine(2453,0,__PYX_ERR(0, 2453, __pyx_L1_error))
       (__pyx_v_vs[__pyx_v_j]) = pow(__pyx_v_v, ((double)__pyx_v_j));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2289
+      /* "pyseobnr/eob/waveform/waveform.pyx":2454
  *         for j in range(PN_limit):
  *             vs[j] = v**j
  *             vhs[j] = vh**j             # <<<<<<<<<<<<<<
  * 
  *         v_phi = omega/omega_circ**(2./3)
  */
-      __Pyx_TraceLine(2289,0,__PYX_ERR(0, 2289, __pyx_L1_error))
+      __Pyx_TraceLine(2454,0,__PYX_ERR(0, 2454, __pyx_L1_error))
       (__pyx_v_vhs[__pyx_v_j]) = pow(__pyx_v_vh, ((double)__pyx_v_j));
     }
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2291
+    /* "pyseobnr/eob/waveform/waveform.pyx":2456
  *             vhs[j] = vh**j
  * 
  *         v_phi = omega/omega_circ**(2./3)             # <<<<<<<<<<<<<<
  *         v_phi2 = v_phi*v_phi
- *         source1 = (H * H - 1.0) / (2.0 * nu) + 1.0 # H_eff
+ *         source1 = (H * H - 1.0) / (2.0 * nu) + 1.0  # H_eff
  */
-    __Pyx_TraceLine(2291,0,__PYX_ERR(0, 2291, __pyx_L1_error))
+    __Pyx_TraceLine(2456,0,__PYX_ERR(0, 2456, __pyx_L1_error))
     __pyx_v_v_phi = (__pyx_v_omega / pow(__pyx_v_omega_circ, (2. / 3.0)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2292
+    /* "pyseobnr/eob/waveform/waveform.pyx":2457
  * 
  *         v_phi = omega/omega_circ**(2./3)
  *         v_phi2 = v_phi*v_phi             # <<<<<<<<<<<<<<
- *         source1 = (H * H - 1.0) / (2.0 * nu) + 1.0 # H_eff
+ *         source1 = (H * H - 1.0) / (2.0 * nu) + 1.0  # H_eff
  *         source2 = v*pphi
  */
-    __Pyx_TraceLine(2292,0,__PYX_ERR(0, 2292, __pyx_L1_error))
+    __Pyx_TraceLine(2457,0,__PYX_ERR(0, 2457, __pyx_L1_error))
     __pyx_v_v_phi2 = (__pyx_v_v_phi * __pyx_v_v_phi);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2293
+    /* "pyseobnr/eob/waveform/waveform.pyx":2458
  *         v_phi = omega/omega_circ**(2./3)
  *         v_phi2 = v_phi*v_phi
- *         source1 = (H * H - 1.0) / (2.0 * nu) + 1.0 # H_eff             # <<<<<<<<<<<<<<
+ *         source1 = (H * H - 1.0) / (2.0 * nu) + 1.0  # H_eff             # <<<<<<<<<<<<<<
  *         source2 = v*pphi
  *         if not eob_pars.aligned:
  */
-    __Pyx_TraceLine(2293,0,__PYX_ERR(0, 2293, __pyx_L1_error))
+    __Pyx_TraceLine(2458,0,__PYX_ERR(0, 2458, __pyx_L1_error))
     __pyx_v_source1 = ((((__pyx_v_H * __pyx_v_H) - 1.0) / (2.0 * __pyx_v_nu)) + 1.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2294
+    /* "pyseobnr/eob/waveform/waveform.pyx":2459
  *         v_phi2 = v_phi*v_phi
- *         source1 = (H * H - 1.0) / (2.0 * nu) + 1.0 # H_eff
+ *         source1 = (H * H - 1.0) / (2.0 * nu) + 1.0  # H_eff
  *         source2 = v*pphi             # <<<<<<<<<<<<<<
  *         if not eob_pars.aligned:
  *             # For precession, we have to recompute the coefficients that enter
  */
-    __Pyx_TraceLine(2294,0,__PYX_ERR(0, 2294, __pyx_L1_error))
+    __Pyx_TraceLine(2459,0,__PYX_ERR(0, 2459, __pyx_L1_error))
     __pyx_v_source2 = (__pyx_v_v * __pyx_v_pphi);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2295
- *         source1 = (H * H - 1.0) / (2.0 * nu) + 1.0 # H_eff
+    /* "pyseobnr/eob/waveform/waveform.pyx":2460
+ *         source1 = (H * H - 1.0) / (2.0 * nu) + 1.0  # H_eff
  *         source2 = v*pphi
  *         if not eob_pars.aligned:             # <<<<<<<<<<<<<<
  *             # For precession, we have to recompute the coefficients that enter
  *             # the waveform at every step, since the spins change.
  */
-    __Pyx_TraceLine(2295,0,__PYX_ERR(0, 2295, __pyx_L1_error))
+    __Pyx_TraceLine(2460,0,__PYX_ERR(0, 2460, __pyx_L1_error))
     __pyx_t_21 = (!__pyx_v_eob_pars->aligned);
     if (__pyx_t_21) {
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2301
+      /* "pyseobnr/eob/waveform/waveform.pyx":2466
  *             # since the Newtonian prefixes are independent of the spins.
  *             # Assume the dynamics has been augmented appropriately with the spins.
  *             chi_1 = row[7]             # <<<<<<<<<<<<<<
  *             chi_2 = row[8]
- *             eob_pars.p_params.update_spins(chi_1,chi_2)
+ *             eob_pars.p_params.update_spins(chi_1, chi_2)
  */
-      __Pyx_TraceLine(2301,0,__PYX_ERR(0, 2301, __pyx_L1_error))
+      __Pyx_TraceLine(2466,0,__PYX_ERR(0, 2466, __pyx_L1_error))
       __pyx_t_17 = 7;
       __pyx_v_chi_1 = (*((double *) ( /* dim=0 */ (__pyx_v_row.data + __pyx_t_17 * __pyx_v_row.strides[0]) )));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2302
+      /* "pyseobnr/eob/waveform/waveform.pyx":2467
  *             # Assume the dynamics has been augmented appropriately with the spins.
  *             chi_1 = row[7]
  *             chi_2 = row[8]             # <<<<<<<<<<<<<<
- *             eob_pars.p_params.update_spins(chi_1,chi_2)
+ *             eob_pars.p_params.update_spins(chi_1, chi_2)
  *             # Recompute rho coeffs
  */
-      __Pyx_TraceLine(2302,0,__PYX_ERR(0, 2302, __pyx_L1_error))
+      __Pyx_TraceLine(2467,0,__PYX_ERR(0, 2467, __pyx_L1_error))
       __pyx_t_17 = 8;
       __pyx_v_chi_2 = (*((double *) ( /* dim=0 */ (__pyx_v_row.data + __pyx_t_17 * __pyx_v_row.strides[0]) )));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2303
+      /* "pyseobnr/eob/waveform/waveform.pyx":2468
  *             chi_1 = row[7]
  *             chi_2 = row[8]
- *             eob_pars.p_params.update_spins(chi_1,chi_2)             # <<<<<<<<<<<<<<
+ *             eob_pars.p_params.update_spins(chi_1, chi_2)             # <<<<<<<<<<<<<<
  *             # Recompute rho coeffs
- *             compute_rho_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,
+ *             compute_rho_coeffs(
  */
-      __Pyx_TraceLine(2303,0,__PYX_ERR(0, 2303, __pyx_L1_error))
-      __pyx_t_2 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_eob_pars->p_params->__pyx_vtab)->update_spins(__pyx_v_eob_pars->p_params, __pyx_v_chi_1, __pyx_v_chi_2, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2303, __pyx_L1_error)
+      __Pyx_TraceLine(2468,0,__PYX_ERR(0, 2468, __pyx_L1_error))
+      __pyx_t_2 = ((struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams *)__pyx_v_eob_pars->p_params->__pyx_vtab)->update_spins(__pyx_v_eob_pars->p_params, __pyx_v_chi_1, __pyx_v_chi_2, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2468, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2305
- *             eob_pars.p_params.update_spins(chi_1,chi_2)
+      /* "pyseobnr/eob/waveform/waveform.pyx":2470
+ *             eob_pars.p_params.update_spins(chi_1, chi_2)
  *             # Recompute rho coeffs
- *             compute_rho_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,             # <<<<<<<<<<<<<<
- *                 eob_pars.p_params.chi_A, eob_pars.flux_params.rho_coeffs,eob_pars.flux_params.rho_coeffs_log,
- *                 eob_pars.flux_params.f_coeffs,eob_pars.flux_params.f_coeffs_vh,eob_pars.flux_params.extra_PN_terms)
+ *             compute_rho_coeffs(             # <<<<<<<<<<<<<<
+ *                 eob_pars.p_params.nu,
+ *                 eob_pars.p_params.delta,
  */
-      __Pyx_TraceLine(2305,0,__PYX_ERR(0, 2305, __pyx_L1_error))
-      __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rho_coeffs(__pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars->p_params->delta, __pyx_v_eob_pars->p_params->a, __pyx_v_eob_pars->p_params->chi_S, __pyx_v_eob_pars->p_params->chi_A, __pyx_v_eob_pars->flux_params->rho_coeffs, __pyx_v_eob_pars->flux_params->rho_coeffs_log, __pyx_v_eob_pars->flux_params->f_coeffs, __pyx_v_eob_pars->flux_params->f_coeffs_vh, __pyx_v_eob_pars->flux_params->extra_PN_terms, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2305, __pyx_L1_error)
+      __Pyx_TraceLine(2470,0,__PYX_ERR(0, 2470, __pyx_L1_error))
+      __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rho_coeffs(__pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars->p_params->delta, __pyx_v_eob_pars->p_params->a, __pyx_v_eob_pars->p_params->chi_S, __pyx_v_eob_pars->p_params->chi_A, __pyx_v_eob_pars->flux_params->rho_coeffs, __pyx_v_eob_pars->flux_params->rho_coeffs_log, __pyx_v_eob_pars->flux_params->f_coeffs, __pyx_v_eob_pars->flux_params->f_coeffs_vh, __pyx_v_eob_pars->flux_params->extra_PN_terms, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2470, __pyx_L1_error)
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2309
- *                 eob_pars.flux_params.f_coeffs,eob_pars.flux_params.f_coeffs_vh,eob_pars.flux_params.extra_PN_terms)
+      /* "pyseobnr/eob/waveform/waveform.pyx":2482
+ *                 eob_pars.flux_params.extra_PN_terms)
  *             # Recompute delta coeffs
- *             compute_delta_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,             # <<<<<<<<<<<<<<
- *                 eob_pars.p_params.chi_A, eob_pars.flux_params.delta_coeffs,eob_pars.flux_params.delta_coeffs_vh)
- * 
+ *             compute_delta_coeffs(             # <<<<<<<<<<<<<<
+ *                 eob_pars.p_params.nu,
+ *                 eob_pars.p_params.delta,
  */
-      __Pyx_TraceLine(2309,0,__PYX_ERR(0, 2309, __pyx_L1_error))
-      compute_delta_coeffs(__pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars->p_params->delta, __pyx_v_eob_pars->p_params->a, __pyx_v_eob_pars->p_params->chi_S, __pyx_v_eob_pars->p_params->chi_A, __pyx_v_eob_pars->flux_params->delta_coeffs, __pyx_v_eob_pars->flux_params->delta_coeffs_vh); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2309, __pyx_L1_error)
+      __Pyx_TraceLine(2482,0,__PYX_ERR(0, 2482, __pyx_L1_error))
+      compute_delta_coeffs(__pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars->p_params->delta, __pyx_v_eob_pars->p_params->a, __pyx_v_eob_pars->p_params->chi_S, __pyx_v_eob_pars->p_params->chi_A, __pyx_v_eob_pars->flux_params->delta_coeffs, __pyx_v_eob_pars->flux_params->delta_coeffs_vh); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2482, __pyx_L1_error)
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2295
- *         source1 = (H * H - 1.0) / (2.0 * nu) + 1.0 # H_eff
+      /* "pyseobnr/eob/waveform/waveform.pyx":2460
+ *         source1 = (H * H - 1.0) / (2.0 * nu) + 1.0  # H_eff
  *         source2 = v*pphi
  *         if not eob_pars.aligned:             # <<<<<<<<<<<<<<
  *             # For precession, we have to recompute the coefficients that enter
  *             # the waveform at every step, since the spins change.
  */
     }
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2312
- *                 eob_pars.p_params.chi_A, eob_pars.flux_params.delta_coeffs,eob_pars.flux_params.delta_coeffs_vh)
+    /* "pyseobnr/eob/waveform/waveform.pyx":2491
+ *                 eob_pars.flux_params.delta_coeffs_vh)
  * 
  *         for j in range(len(eob_pars.mode_array)):             # <<<<<<<<<<<<<<
  *             ell_m = eob_pars.mode_array[j]
  *             l = ell_m[0]
  */
-    __Pyx_TraceLine(2312,0,__PYX_ERR(0, 2312, __pyx_L1_error))
+    __Pyx_TraceLine(2491,0,__PYX_ERR(0, 2491, __pyx_L1_error))
     __pyx_t_2 = __pyx_v_eob_pars->mode_array;
     __Pyx_INCREF(__pyx_t_2);
     if (unlikely(__pyx_t_2 == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-      __PYX_ERR(0, 2312, __pyx_L1_error)
+      __PYX_ERR(0, 2491, __pyx_L1_error)
     }
-    __pyx_t_4 = __Pyx_PyList_GET_SIZE(__pyx_t_2); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2312, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyList_GET_SIZE(__pyx_t_2); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2491, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_22 = __pyx_t_4;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_22; __pyx_t_18+=1) {
       __pyx_v_j = __pyx_t_18;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2313
+      /* "pyseobnr/eob/waveform/waveform.pyx":2492
  * 
  *         for j in range(len(eob_pars.mode_array)):
  *             ell_m = eob_pars.mode_array[j]             # <<<<<<<<<<<<<<
  *             l = ell_m[0]
  *             m = ell_m[1]
  */
-      __Pyx_TraceLine(2313,0,__PYX_ERR(0, 2313, __pyx_L1_error))
+      __Pyx_TraceLine(2492,0,__PYX_ERR(0, 2492, __pyx_L1_error))
       if (unlikely(__pyx_v_eob_pars->mode_array == Py_None)) {
         PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-        __PYX_ERR(0, 2313, __pyx_L1_error)
+        __PYX_ERR(0, 2492, __pyx_L1_error)
       }
-      __pyx_t_6 = __pyx_convert__from_py___pyx_ctuple_int__and_int(PyList_GET_ITEM(__pyx_v_eob_pars->mode_array, __pyx_v_j)); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2313, __pyx_L1_error)
+      __pyx_t_6 = __pyx_convert__from_py___pyx_ctuple_int__and_int(PyList_GET_ITEM(__pyx_v_eob_pars->mode_array, __pyx_v_j)); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2492, __pyx_L1_error)
       __pyx_v_ell_m = __pyx_t_6;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2314
+      /* "pyseobnr/eob/waveform/waveform.pyx":2493
  *         for j in range(len(eob_pars.mode_array)):
  *             ell_m = eob_pars.mode_array[j]
  *             l = ell_m[0]             # <<<<<<<<<<<<<<
  *             m = ell_m[1]
  *             if ((l + m) % 2) == 0:
  */
-      __Pyx_TraceLine(2314,0,__PYX_ERR(0, 2314, __pyx_L1_error))
+      __Pyx_TraceLine(2493,0,__PYX_ERR(0, 2493, __pyx_L1_error))
       __pyx_v_l = __pyx_v_ell_m.f0;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2315
+      /* "pyseobnr/eob/waveform/waveform.pyx":2494
  *             ell_m = eob_pars.mode_array[j]
  *             l = ell_m[0]
  *             m = ell_m[1]             # <<<<<<<<<<<<<<
  *             if ((l + m) % 2) == 0:
  *                 Slm = source1
  */
-      __Pyx_TraceLine(2315,0,__PYX_ERR(0, 2315, __pyx_L1_error))
+      __Pyx_TraceLine(2494,0,__PYX_ERR(0, 2494, __pyx_L1_error))
       __pyx_v_m = __pyx_v_ell_m.f1;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2316
+      /* "pyseobnr/eob/waveform/waveform.pyx":2495
  *             l = ell_m[0]
  *             m = ell_m[1]
  *             if ((l + m) % 2) == 0:             # <<<<<<<<<<<<<<
  *                 Slm = source1
  *             else:
  */
-      __Pyx_TraceLine(2316,0,__PYX_ERR(0, 2316, __pyx_L1_error))
+      __Pyx_TraceLine(2495,0,__PYX_ERR(0, 2495, __pyx_L1_error))
       __pyx_t_21 = (((__pyx_v_l + __pyx_v_m) % 2) == 0);
       if (__pyx_t_21) {
 
-        /* "pyseobnr/eob/waveform/waveform.pyx":2317
+        /* "pyseobnr/eob/waveform/waveform.pyx":2496
  *             m = ell_m[1]
  *             if ((l + m) % 2) == 0:
  *                 Slm = source1             # <<<<<<<<<<<<<<
  *             else:
  *                 Slm = source2
  */
-        __Pyx_TraceLine(2317,0,__PYX_ERR(0, 2317, __pyx_L1_error))
+        __Pyx_TraceLine(2496,0,__PYX_ERR(0, 2496, __pyx_L1_error))
         __pyx_v_Slm = __pyx_v_source1;
 
-        /* "pyseobnr/eob/waveform/waveform.pyx":2316
+        /* "pyseobnr/eob/waveform/waveform.pyx":2495
  *             l = ell_m[0]
  *             m = ell_m[1]
  *             if ((l + m) % 2) == 0:             # <<<<<<<<<<<<<<
  *                 Slm = source1
  *             else:
  */
         goto __pyx_L13;
       }
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2319
+      /* "pyseobnr/eob/waveform/waveform.pyx":2498
  *                 Slm = source1
  *             else:
  *                 Slm = source2             # <<<<<<<<<<<<<<
  * 
- * 
+ *             # modes[l,m][i] = compute_mode(v_phi2,phi, Slm, vs,vhs,l, m, eob_pars)
  */
-      __Pyx_TraceLine(2319,0,__PYX_ERR(0, 2319, __pyx_L1_error))
+      __Pyx_TraceLine(2498,0,__PYX_ERR(0, 2498, __pyx_L1_error))
       /*else*/ {
         __pyx_v_Slm = __pyx_v_source2;
       }
       __pyx_L13:;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2323
+      /* "pyseobnr/eob/waveform/waveform.pyx":2501
  * 
- *             #modes[l,m][i]  = compute_mode(v_phi2,phi, Slm, vs,vhs,l, m, eob_pars)
- *             temp_modes[l,m,i] = compute_mode(v_phi2,phi, Slm, vs,vhs,l, m, eob_pars)             # <<<<<<<<<<<<<<
+ *             # modes[l,m][i] = compute_mode(v_phi2,phi, Slm, vs,vhs,l, m, eob_pars)
+ *             temp_modes[l, m, i] = compute_mode(v_phi2, phi, Slm, vs, vhs, l, m, eob_pars)             # <<<<<<<<<<<<<<
  * 
  *     for j in range(len(eob_pars.mode_array)):
  */
-      __Pyx_TraceLine(2323,0,__PYX_ERR(0, 2323, __pyx_L1_error))
-      __pyx_t_23 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_mode(__pyx_v_v_phi2, __pyx_v_phi, __pyx_v_Slm, __pyx_v_vs, __pyx_v_vhs, __pyx_v_l, __pyx_v_m, __pyx_v_eob_pars); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2323, __pyx_L1_error)
+      __Pyx_TraceLine(2501,0,__PYX_ERR(0, 2501, __pyx_L1_error))
+      __pyx_t_23 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_mode(__pyx_v_v_phi2, __pyx_v_phi, __pyx_v_Slm, __pyx_v_vs, __pyx_v_vhs, __pyx_v_l, __pyx_v_m, __pyx_v_eob_pars); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2501, __pyx_L1_error)
       __pyx_t_17 = __pyx_v_l;
       __pyx_t_24 = __pyx_v_m;
       __pyx_t_25 = __pyx_v_i;
       *((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_temp_modes.data + __pyx_t_17 * __pyx_v_temp_modes.strides[0]) ) + __pyx_t_24 * __pyx_v_temp_modes.strides[1]) ) + __pyx_t_25 * __pyx_v_temp_modes.strides[2]) )) = __pyx_t_23;
     }
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2325
- *             temp_modes[l,m,i] = compute_mode(v_phi2,phi, Slm, vs,vhs,l, m, eob_pars)
+  /* "pyseobnr/eob/waveform/waveform.pyx":2503
+ *             temp_modes[l, m, i] = compute_mode(v_phi2, phi, Slm, vs, vhs, l, m, eob_pars)
  * 
  *     for j in range(len(eob_pars.mode_array)):             # <<<<<<<<<<<<<<
- *             ell_m = eob_pars.mode_array[j]
- *             l = ell_m[0]
+ *         ell_m = eob_pars.mode_array[j]
+ *         l = ell_m[0]
  */
-  __Pyx_TraceLine(2325,0,__PYX_ERR(0, 2325, __pyx_L1_error))
+  __Pyx_TraceLine(2503,0,__PYX_ERR(0, 2503, __pyx_L1_error))
   __pyx_t_2 = __pyx_v_eob_pars->mode_array;
   __Pyx_INCREF(__pyx_t_2);
   if (unlikely(__pyx_t_2 == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-    __PYX_ERR(0, 2325, __pyx_L1_error)
+    __PYX_ERR(0, 2503, __pyx_L1_error)
   }
-  __pyx_t_4 = __Pyx_PyList_GET_SIZE(__pyx_t_2); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2325, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyList_GET_SIZE(__pyx_t_2); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2503, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_22 = __pyx_t_4;
   for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_22; __pyx_t_13+=1) {
     __pyx_v_j = __pyx_t_13;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2326
+    /* "pyseobnr/eob/waveform/waveform.pyx":2504
  * 
  *     for j in range(len(eob_pars.mode_array)):
- *             ell_m = eob_pars.mode_array[j]             # <<<<<<<<<<<<<<
- *             l = ell_m[0]
- *             m = ell_m[1]
+ *         ell_m = eob_pars.mode_array[j]             # <<<<<<<<<<<<<<
+ *         l = ell_m[0]
+ *         m = ell_m[1]
  */
-    __Pyx_TraceLine(2326,0,__PYX_ERR(0, 2326, __pyx_L1_error))
+    __Pyx_TraceLine(2504,0,__PYX_ERR(0, 2504, __pyx_L1_error))
     if (unlikely(__pyx_v_eob_pars->mode_array == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 2326, __pyx_L1_error)
+      __PYX_ERR(0, 2504, __pyx_L1_error)
     }
-    __pyx_t_6 = __pyx_convert__from_py___pyx_ctuple_int__and_int(PyList_GET_ITEM(__pyx_v_eob_pars->mode_array, __pyx_v_j)); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2326, __pyx_L1_error)
+    __pyx_t_6 = __pyx_convert__from_py___pyx_ctuple_int__and_int(PyList_GET_ITEM(__pyx_v_eob_pars->mode_array, __pyx_v_j)); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2504, __pyx_L1_error)
     __pyx_v_ell_m = __pyx_t_6;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2327
+    /* "pyseobnr/eob/waveform/waveform.pyx":2505
  *     for j in range(len(eob_pars.mode_array)):
- *             ell_m = eob_pars.mode_array[j]
- *             l = ell_m[0]             # <<<<<<<<<<<<<<
- *             m = ell_m[1]
- *             modes[l,m] = temp_modes[l,m]
+ *         ell_m = eob_pars.mode_array[j]
+ *         l = ell_m[0]             # <<<<<<<<<<<<<<
+ *         m = ell_m[1]
+ *         modes[l, m] = temp_modes[l, m]
  */
-    __Pyx_TraceLine(2327,0,__PYX_ERR(0, 2327, __pyx_L1_error))
+    __Pyx_TraceLine(2505,0,__PYX_ERR(0, 2505, __pyx_L1_error))
     __pyx_v_l = __pyx_v_ell_m.f0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2328
- *             ell_m = eob_pars.mode_array[j]
- *             l = ell_m[0]
- *             m = ell_m[1]             # <<<<<<<<<<<<<<
- *             modes[l,m] = temp_modes[l,m]
+    /* "pyseobnr/eob/waveform/waveform.pyx":2506
+ *         ell_m = eob_pars.mode_array[j]
+ *         l = ell_m[0]
+ *         m = ell_m[1]             # <<<<<<<<<<<<<<
+ *         modes[l, m] = temp_modes[l, m]
  *     return modes
  */
-    __Pyx_TraceLine(2328,0,__PYX_ERR(0, 2328, __pyx_L1_error))
+    __Pyx_TraceLine(2506,0,__PYX_ERR(0, 2506, __pyx_L1_error))
     __pyx_v_m = __pyx_v_ell_m.f1;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2329
- *             l = ell_m[0]
- *             m = ell_m[1]
- *             modes[l,m] = temp_modes[l,m]             # <<<<<<<<<<<<<<
+    /* "pyseobnr/eob/waveform/waveform.pyx":2507
+ *         l = ell_m[0]
+ *         m = ell_m[1]
+ *         modes[l, m] = temp_modes[l, m]             # <<<<<<<<<<<<<<
  *     return modes
  * 
  */
-    __Pyx_TraceLine(2329,0,__PYX_ERR(0, 2329, __pyx_L1_error))
+    __Pyx_TraceLine(2507,0,__PYX_ERR(0, 2507, __pyx_L1_error))
     __pyx_t_26.data = __pyx_v_temp_modes.data;
     __pyx_t_26.memview = __pyx_v_temp_modes.memview;
     __PYX_INC_MEMVIEW(&__pyx_t_26, 1);
     {
     Py_ssize_t __pyx_tmp_idx = __pyx_v_l;
     Py_ssize_t __pyx_tmp_stride = __pyx_v_temp_modes.strides[0];
         __pyx_t_26.data += __pyx_tmp_idx * __pyx_tmp_stride;
@@ -33088,52 +33173,52 @@
         __pyx_t_26.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
 __pyx_t_26.shape[0] = __pyx_v_temp_modes.shape[2];
 __pyx_t_26.strides[0] = __pyx_v_temp_modes.strides[2];
     __pyx_t_26.suboffsets[0] = -1;
 
-__pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_26, 1, (PyObject *(*)(char *)) __pyx_memview_get___pyx_t_double_complex, (int (*)(char *, PyObject *)) __pyx_memview_set___pyx_t_double_complex, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2329, __pyx_L1_error)
+__pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_26, 1, (PyObject *(*)(char *)) __pyx_memview_get___pyx_t_double_complex, (int (*)(char *, PyObject *)) __pyx_memview_set___pyx_t_double_complex, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2507, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_26, 1);
     __pyx_t_26.memview = NULL; __pyx_t_26.data = NULL;
-    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_l); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2329, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_l); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2507, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_m); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2329, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_m); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2507, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2329, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2507, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_7);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7)) __PYX_ERR(0, 2329, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7)) __PYX_ERR(0, 2507, __pyx_L1_error);
     __Pyx_GIVEREF(__pyx_t_8);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_8)) __PYX_ERR(0, 2329, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_8)) __PYX_ERR(0, 2507, __pyx_L1_error);
     __pyx_t_7 = 0;
     __pyx_t_8 = 0;
-    if (unlikely((PyDict_SetItem(__pyx_v_modes, __pyx_t_3, __pyx_t_2) < 0))) __PYX_ERR(0, 2329, __pyx_L1_error)
+    if (unlikely((PyDict_SetItem(__pyx_v_modes, __pyx_t_3, __pyx_t_2) < 0))) __PYX_ERR(0, 2507, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2330
- *             m = ell_m[1]
- *             modes[l,m] = temp_modes[l,m]
+  /* "pyseobnr/eob/waveform/waveform.pyx":2508
+ *         m = ell_m[1]
+ *         modes[l, m] = temp_modes[l, m]
  *     return modes             # <<<<<<<<<<<<<<
  * 
- * cdef double min_threshold(int l,int m):
+ * 
  */
-  __Pyx_TraceLine(2330,0,__PYX_ERR(0, 2330, __pyx_L1_error))
+  __Pyx_TraceLine(2508,0,__PYX_ERR(0, 2508, __pyx_L1_error))
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_modes);
   __pyx_r = __pyx_v_modes;
   goto __pyx_L0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2237
+  /* "pyseobnr/eob/waveform/waveform.pyx":2384
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef compute_hlms(double[:,:] dynamics, EOBParams eob_pars):             # <<<<<<<<<<<<<<
+ * cpdef compute_hlms(double[:, :] dynamics, EOBParams eob_pars):             # <<<<<<<<<<<<<<
  *     """
  *     Compute the inspiral modes for aligned *or* precessing binaries.
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
@@ -33212,58 +33297,58 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dynamics)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2237, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2384, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_eob_pars)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2237, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2384, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_hlms", 1, 2, 2, 1); __PYX_ERR(0, 2237, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_hlms", 1, 2, 2, 1); __PYX_ERR(0, 2384, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_hlms") < 0)) __PYX_ERR(0, 2237, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_hlms") < 0)) __PYX_ERR(0, 2384, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 2)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
     }
-    __pyx_v_dynamics = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_dynamics.memview)) __PYX_ERR(0, 2237, __pyx_L3_error)
+    __pyx_v_dynamics = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_dynamics.memview)) __PYX_ERR(0, 2384, __pyx_L3_error)
     __pyx_v_eob_pars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)values[1]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("compute_hlms", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 2237, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("compute_hlms", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 2384, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_dynamics, 1);
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.compute_hlms", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_eob_pars), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "eob_pars", 0))) __PYX_ERR(0, 2237, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_eob_pars), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "eob_pars", 0))) __PYX_ERR(0, 2384, __pyx_L1_error)
   __pyx_r = __pyx_pf_8pyseobnr_3eob_8waveform_8waveform_20compute_hlms(__pyx_self, __pyx_v_dynamics, __pyx_v_eob_pars);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -33284,17 +33369,17 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__16)
   __Pyx_RefNannySetupContext("compute_hlms", 1);
-  __Pyx_TraceCall("compute_hlms (wrapper)", __pyx_f[0], 2237, 0, __PYX_ERR(0, 2237, __pyx_L1_error));
+  __Pyx_TraceCall("compute_hlms (wrapper)", __pyx_f[0], 2384, 0, __PYX_ERR(0, 2384, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_hlms(__pyx_v_dynamics, __pyx_v_eob_pars, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2237, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_hlms(__pyx_v_dynamics, __pyx_v_eob_pars, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2384, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -33304,28 +33389,28 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2332
- *     return modes
+/* "pyseobnr/eob/waveform/waveform.pyx":2511
+ * 
  * 
- * cdef double min_threshold(int l,int m):             # <<<<<<<<<<<<<<
+ * cdef double min_threshold(int l, int m):             # <<<<<<<<<<<<<<
  *     """
  *     The values for (2,1) and (5,5) are taken from SEOBNRv4HM. The
  */
 
 static double __pyx_f_8pyseobnr_3eob_8waveform_8waveform_min_threshold(int __pyx_v_l, int __pyx_v_m) {
   double __pyx_r;
   int __pyx_t_1;
   int __pyx_t_2;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2337
+  /* "pyseobnr/eob/waveform/waveform.pyx":2516
  *     value for (4,3) is determined empirically
  *     """
  *     if l==2 and m==1:             # <<<<<<<<<<<<<<
  *         return 90
  *     elif l==4 and m==3:
  */
   __pyx_t_2 = (__pyx_v_l == 2);
@@ -33335,34 +33420,34 @@
     goto __pyx_L4_bool_binop_done;
   }
   __pyx_t_2 = (__pyx_v_m == 1);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2338
+    /* "pyseobnr/eob/waveform/waveform.pyx":2517
  *     """
  *     if l==2 and m==1:
  *         return 90             # <<<<<<<<<<<<<<
  *     elif l==4 and m==3:
  *         return 100
  */
     __pyx_r = 90.0;
     goto __pyx_L0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2337
+    /* "pyseobnr/eob/waveform/waveform.pyx":2516
  *     value for (4,3) is determined empirically
  *     """
  *     if l==2 and m==1:             # <<<<<<<<<<<<<<
  *         return 90
  *     elif l==4 and m==3:
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2339
+  /* "pyseobnr/eob/waveform/waveform.pyx":2518
  *     if l==2 and m==1:
  *         return 90
  *     elif l==4 and m==3:             # <<<<<<<<<<<<<<
  *         return 100
  *     elif l==5 and m==5:
  */
   __pyx_t_2 = (__pyx_v_l == 4);
@@ -33372,34 +33457,34 @@
     goto __pyx_L6_bool_binop_done;
   }
   __pyx_t_2 = (__pyx_v_m == 3);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L6_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2340
+    /* "pyseobnr/eob/waveform/waveform.pyx":2519
  *         return 90
  *     elif l==4 and m==3:
  *         return 100             # <<<<<<<<<<<<<<
  *     elif l==5 and m==5:
  *         return 2000
  */
     __pyx_r = 100.0;
     goto __pyx_L0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2339
+    /* "pyseobnr/eob/waveform/waveform.pyx":2518
  *     if l==2 and m==1:
  *         return 90
  *     elif l==4 and m==3:             # <<<<<<<<<<<<<<
  *         return 100
  *     elif l==5 and m==5:
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2341
+  /* "pyseobnr/eob/waveform/waveform.pyx":2520
  *     elif l==4 and m==3:
  *         return 100
  *     elif l==5 and m==5:             # <<<<<<<<<<<<<<
  *         return 2000
  * 
  */
   __pyx_t_2 = (__pyx_v_l == 5);
@@ -33409,53 +33494,53 @@
     goto __pyx_L8_bool_binop_done;
   }
   __pyx_t_2 = (__pyx_v_m == 5);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L8_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2342
+    /* "pyseobnr/eob/waveform/waveform.pyx":2521
  *         return 100
  *     elif l==5 and m==5:
  *         return 2000             # <<<<<<<<<<<<<<
  * 
  * 
  */
     __pyx_r = 2000.0;
     goto __pyx_L0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2341
+    /* "pyseobnr/eob/waveform/waveform.pyx":2520
  *     elif l==4 and m==3:
  *         return 100
  *     elif l==5 and m==5:             # <<<<<<<<<<<<<<
  *         return 2000
  * 
  */
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2332
- *     return modes
+  /* "pyseobnr/eob/waveform/waveform.pyx":2511
+ * 
  * 
- * cdef double min_threshold(int l,int m):             # <<<<<<<<<<<<<<
+ * cdef double min_threshold(int l, int m):             # <<<<<<<<<<<<<<
  *     """
  *     The values for (2,1) and (5,5) are taken from SEOBNRv4HM. The
  */
 
   /* function exit code */
   __pyx_r = 0;
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2353
+/* "pyseobnr/eob/waveform/waveform.pyx":2532
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef compute_special_coeffs(double[:,:] dynamics, double t_attach, EOBParams eob_pars,             # <<<<<<<<<<<<<<
- *     dict amp_fits, dict amp_thresholds, dict modes={(2,1):7,(4,3):7,(5,5):5}):
- *     """
+ * cpdef compute_special_coeffs(             # <<<<<<<<<<<<<<
+ *     double[:, :] dynamics,
+ *     double t_attach,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_23compute_special_coeffs(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
@@ -33530,43 +33615,43 @@
   Py_ssize_t __pyx_t_22;
   __pyx_t_double_complex __pyx_t_23;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__18)
   __Pyx_RefNannySetupContext("compute_special_coeffs", 1);
-  __Pyx_TraceCall("compute_special_coeffs", __pyx_f[0], 2353, 0, __PYX_ERR(0, 2353, __pyx_L1_error));
+  __Pyx_TraceCall("compute_special_coeffs", __pyx_f[0], 2532, 0, __PYX_ERR(0, 2532, __pyx_L1_error));
   if (__pyx_optional_args) {
     if (__pyx_optional_args->__pyx_n > 0) {
       __pyx_v_modes = __pyx_optional_args->modes;
     }
   }
   __pyx_pybuffer_dynamics_55.pybuffer.buf = NULL;
   __pyx_pybuffer_dynamics_55.refcount = 0;
   __pyx_pybuffernd_dynamics_55.data = NULL;
   __pyx_pybuffernd_dynamics_55.rcbuffer = &__pyx_pybuffer_dynamics_55;
   __pyx_pybuffer_dynamics_all.pybuffer.buf = NULL;
   __pyx_pybuffer_dynamics_all.refcount = 0;
   __pyx_pybuffernd_dynamics_all.data = NULL;
   __pyx_pybuffernd_dynamics_all.rcbuffer = &__pyx_pybuffer_dynamics_all;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2369
+  /* "pyseobnr/eob/waveform/waveform.pyx":2553
  *     cdef double vhs[PN_limit]
  * 
- *     cdef np.ndarray[DTYPE_T,ndim=1] dynamics_55 = np.zeros(dynamics.shape[1]-1)             # <<<<<<<<<<<<<<
- *     cdef np.ndarray[DTYPE_T,ndim=1]  dynamics_all = np.zeros(dynamics.shape[1]-1)
+ *     cdef np.ndarray[DTYPE_T, ndim=1] dynamics_55 = np.zeros(dynamics.shape[1]-1)             # <<<<<<<<<<<<<<
+ *     cdef np.ndarray[DTYPE_T, ndim=1] dynamics_all = np.zeros(dynamics.shape[1]-1)
  * 
  */
-  __Pyx_TraceLine(2369,0,__PYX_ERR(0, 2369, __pyx_L1_error))
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2369, __pyx_L1_error)
+  __Pyx_TraceLine(2553,0,__PYX_ERR(0, 2553, __pyx_L1_error))
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2553, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2369, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2553, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromSsize_t(((__pyx_v_dynamics.shape[1]) - 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2369, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(((__pyx_v_dynamics.shape[1]) - 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2553, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
@@ -33579,46 +33664,46 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2369, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2553, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 2369, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 2553, __pyx_L1_error)
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_dynamics_55.rcbuffer->pybuffer, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_8pyseobnr_3eob_8waveform_8waveform_DTYPE_T, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_dynamics_55 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_dynamics_55.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 2369, __pyx_L1_error)
+      __PYX_ERR(0, 2553, __pyx_L1_error)
     } else {__pyx_pybuffernd_dynamics_55.diminfo[0].strides = __pyx_pybuffernd_dynamics_55.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_dynamics_55.diminfo[0].shape = __pyx_pybuffernd_dynamics_55.rcbuffer->pybuffer.shape[0];
     }
   }
   __pyx_t_6 = 0;
   __pyx_v_dynamics_55 = ((PyArrayObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2370
- * 
- *     cdef np.ndarray[DTYPE_T,ndim=1] dynamics_55 = np.zeros(dynamics.shape[1]-1)
- *     cdef np.ndarray[DTYPE_T,ndim=1]  dynamics_all = np.zeros(dynamics.shape[1]-1)             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":2554
  * 
+ *     cdef np.ndarray[DTYPE_T, ndim=1] dynamics_55 = np.zeros(dynamics.shape[1]-1)
+ *     cdef np.ndarray[DTYPE_T, ndim=1] dynamics_all = np.zeros(dynamics.shape[1]-1)             # <<<<<<<<<<<<<<
  * 
+ *     for i in range(1, dynamics.shape[1]):
  */
-  __Pyx_TraceLine(2370,0,__PYX_ERR(0, 2370, __pyx_L1_error))
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2370, __pyx_L1_error)
+  __Pyx_TraceLine(2554,0,__PYX_ERR(0, 2554, __pyx_L1_error))
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2554, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2370, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2554, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyInt_FromSsize_t(((__pyx_v_dynamics.shape[1]) - 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2370, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(((__pyx_v_dynamics.shape[1]) - 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2554, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
@@ -33631,69 +33716,69 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_3};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2370, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2554, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 2370, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 2554, __pyx_L1_error)
   __pyx_t_7 = ((PyArrayObject *)__pyx_t_1);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_dynamics_all.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_8pyseobnr_3eob_8waveform_8waveform_DTYPE_T, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_dynamics_all = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_dynamics_all.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 2370, __pyx_L1_error)
+      __PYX_ERR(0, 2554, __pyx_L1_error)
     } else {__pyx_pybuffernd_dynamics_all.diminfo[0].strides = __pyx_pybuffernd_dynamics_all.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_dynamics_all.diminfo[0].shape = __pyx_pybuffernd_dynamics_all.rcbuffer->pybuffer.shape[0];
     }
   }
   __pyx_t_7 = 0;
   __pyx_v_dynamics_all = ((PyArrayObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2373
- * 
+  /* "pyseobnr/eob/waveform/waveform.pyx":2556
+ *     cdef np.ndarray[DTYPE_T, ndim=1] dynamics_all = np.zeros(dynamics.shape[1]-1)
  * 
- *     for i in range(1,dynamics.shape[1]):             # <<<<<<<<<<<<<<
- *         spline = CubicSpline(dynamics[:,0],dynamics[:,i])
+ *     for i in range(1, dynamics.shape[1]):             # <<<<<<<<<<<<<<
+ *         spline = CubicSpline(dynamics[:, 0], dynamics[:, i])
  *         dynamics_all[i-1] = spline(t_attach)
  */
-  __Pyx_TraceLine(2373,0,__PYX_ERR(0, 2373, __pyx_L1_error))
+  __Pyx_TraceLine(2556,0,__PYX_ERR(0, 2556, __pyx_L1_error))
   __pyx_t_8 = (__pyx_v_dynamics.shape[1]);
   __pyx_t_9 = __pyx_t_8;
   for (__pyx_t_5 = 1; __pyx_t_5 < __pyx_t_9; __pyx_t_5+=1) {
     __pyx_v_i = __pyx_t_5;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2374
+    /* "pyseobnr/eob/waveform/waveform.pyx":2557
  * 
- *     for i in range(1,dynamics.shape[1]):
- *         spline = CubicSpline(dynamics[:,0],dynamics[:,i])             # <<<<<<<<<<<<<<
+ *     for i in range(1, dynamics.shape[1]):
+ *         spline = CubicSpline(dynamics[:, 0], dynamics[:, i])             # <<<<<<<<<<<<<<
  *         dynamics_all[i-1] = spline(t_attach)
  *         dynamics_55[i-1] = spline(t_attach-10)
  */
-    __Pyx_TraceLine(2374,0,__PYX_ERR(0, 2374, __pyx_L1_error))
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_CubicSpline); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2374, __pyx_L1_error)
+    __Pyx_TraceLine(2557,0,__PYX_ERR(0, 2557, __pyx_L1_error))
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_CubicSpline); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2557, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_10.data = __pyx_v_dynamics.data;
     __pyx_t_10.memview = __pyx_v_dynamics.memview;
     __PYX_INC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.shape[0] = __pyx_v_dynamics.shape[0];
 __pyx_t_10.strides[0] = __pyx_v_dynamics.strides[0];
     __pyx_t_10.suboffsets[0] = -1;
 
 {
     Py_ssize_t __pyx_tmp_idx = 0;
     Py_ssize_t __pyx_tmp_stride = __pyx_v_dynamics.strides[1];
         __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
-__pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2374, __pyx_L1_error)
+__pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2557, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
     __pyx_t_10.data = __pyx_v_dynamics.data;
     __pyx_t_10.memview = __pyx_v_dynamics.memview;
     __PYX_INC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.shape[0] = __pyx_v_dynamics.shape[0];
@@ -33702,15 +33787,15 @@
 
 {
     Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
     Py_ssize_t __pyx_tmp_stride = __pyx_v_dynamics.strides[1];
         __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
-__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2374, __pyx_L1_error)
+__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2557, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
     __pyx_t_11 = NULL;
     __pyx_t_12 = 0;
     #if CYTHON_UNPACK_METHODS
     if (unlikely(PyMethod_Check(__pyx_t_2))) {
@@ -33726,30 +33811,30 @@
     #endif
     {
       PyObject *__pyx_callargs[3] = {__pyx_t_11, __pyx_t_3, __pyx_t_4};
       __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_12, 2+__pyx_t_12);
       __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2374, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2557, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_XDECREF_SET(__pyx_v_spline, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2375
- *     for i in range(1,dynamics.shape[1]):
- *         spline = CubicSpline(dynamics[:,0],dynamics[:,i])
+    /* "pyseobnr/eob/waveform/waveform.pyx":2558
+ *     for i in range(1, dynamics.shape[1]):
+ *         spline = CubicSpline(dynamics[:, 0], dynamics[:, i])
  *         dynamics_all[i-1] = spline(t_attach)             # <<<<<<<<<<<<<<
  *         dynamics_55[i-1] = spline(t_attach-10)
  * 
  */
-    __Pyx_TraceLine(2375,0,__PYX_ERR(0, 2375, __pyx_L1_error))
-    __pyx_t_2 = PyFloat_FromDouble(__pyx_v_t_attach); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2375, __pyx_L1_error)
+    __Pyx_TraceLine(2558,0,__PYX_ERR(0, 2558, __pyx_L1_error))
+    __pyx_t_2 = PyFloat_FromDouble(__pyx_v_t_attach); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2558, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_v_spline);
     __pyx_t_4 = __pyx_v_spline; __pyx_t_3 = NULL;
     __pyx_t_12 = 0;
     #if CYTHON_UNPACK_METHODS
     if (unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
@@ -33763,32 +33848,32 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_2};
       __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_12, 1+__pyx_t_12);
       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2375, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2558, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
-    __pyx_t_13 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_13 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 2375, __pyx_L1_error)
+    __pyx_t_13 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_13 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 2558, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_14 = (__pyx_v_i - 1);
     *__Pyx_BufPtrStrided1d(__pyx_t_8pyseobnr_3eob_8waveform_8waveform_DTYPE_T *, __pyx_pybuffernd_dynamics_all.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_dynamics_all.diminfo[0].strides) = __pyx_t_13;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2376
- *         spline = CubicSpline(dynamics[:,0],dynamics[:,i])
+    /* "pyseobnr/eob/waveform/waveform.pyx":2559
+ *         spline = CubicSpline(dynamics[:, 0], dynamics[:, i])
  *         dynamics_all[i-1] = spline(t_attach)
  *         dynamics_55[i-1] = spline(t_attach-10)             # <<<<<<<<<<<<<<
  * 
  *     cdef double m_1 = eob_pars.p_params.m_1
  */
-    __Pyx_TraceLine(2376,0,__PYX_ERR(0, 2376, __pyx_L1_error))
-    __pyx_t_4 = PyFloat_FromDouble((__pyx_v_t_attach - 10.0)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2376, __pyx_L1_error)
+    __Pyx_TraceLine(2559,0,__PYX_ERR(0, 2559, __pyx_L1_error))
+    __pyx_t_4 = PyFloat_FromDouble((__pyx_v_t_attach - 10.0)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2559, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_v_spline);
     __pyx_t_2 = __pyx_v_spline; __pyx_t_3 = NULL;
     __pyx_t_12 = 0;
     #if CYTHON_UNPACK_METHODS
     if (unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
@@ -33802,570 +33887,570 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
       __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_12, 1+__pyx_t_12);
       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2376, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2559, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
-    __pyx_t_13 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_13 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 2376, __pyx_L1_error)
+    __pyx_t_13 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_13 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 2559, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_14 = (__pyx_v_i - 1);
     *__Pyx_BufPtrStrided1d(__pyx_t_8pyseobnr_3eob_8waveform_8waveform_DTYPE_T *, __pyx_pybuffernd_dynamics_55.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_dynamics_55.diminfo[0].strides) = __pyx_t_13;
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2378
+  /* "pyseobnr/eob/waveform/waveform.pyx":2561
  *         dynamics_55[i-1] = spline(t_attach-10)
  * 
  *     cdef double m_1 = eob_pars.p_params.m_1             # <<<<<<<<<<<<<<
  *     cdef double m_2 = eob_pars.p_params.m_2
  *     cdef double chi_1 = eob_pars.p_params.chi_1
  */
-  __Pyx_TraceLine(2378,0,__PYX_ERR(0, 2378, __pyx_L1_error))
+  __Pyx_TraceLine(2561,0,__PYX_ERR(0, 2561, __pyx_L1_error))
   __pyx_t_15 = __pyx_v_eob_pars->p_params->m_1;
   __pyx_v_m_1 = __pyx_t_15;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2379
+  /* "pyseobnr/eob/waveform/waveform.pyx":2562
  * 
  *     cdef double m_1 = eob_pars.p_params.m_1
  *     cdef double m_2 = eob_pars.p_params.m_2             # <<<<<<<<<<<<<<
  *     cdef double chi_1 = eob_pars.p_params.chi_1
  *     cdef double chi_2 = eob_pars.p_params.chi_2
  */
-  __Pyx_TraceLine(2379,0,__PYX_ERR(0, 2379, __pyx_L1_error))
+  __Pyx_TraceLine(2562,0,__PYX_ERR(0, 2562, __pyx_L1_error))
   __pyx_t_15 = __pyx_v_eob_pars->p_params->m_2;
   __pyx_v_m_2 = __pyx_t_15;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2380
+  /* "pyseobnr/eob/waveform/waveform.pyx":2563
  *     cdef double m_1 = eob_pars.p_params.m_1
  *     cdef double m_2 = eob_pars.p_params.m_2
  *     cdef double chi_1 = eob_pars.p_params.chi_1             # <<<<<<<<<<<<<<
  *     cdef double chi_2 = eob_pars.p_params.chi_2
  * 
  */
-  __Pyx_TraceLine(2380,0,__PYX_ERR(0, 2380, __pyx_L1_error))
+  __Pyx_TraceLine(2563,0,__PYX_ERR(0, 2563, __pyx_L1_error))
   __pyx_t_15 = __pyx_v_eob_pars->p_params->chi_1;
   __pyx_v_chi_1 = __pyx_t_15;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2381
+  /* "pyseobnr/eob/waveform/waveform.pyx":2564
  *     cdef double m_2 = eob_pars.p_params.m_2
  *     cdef double chi_1 = eob_pars.p_params.chi_1
  *     cdef double chi_2 = eob_pars.p_params.chi_2             # <<<<<<<<<<<<<<
  * 
- *     compute_rho_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,
+ *     compute_rho_coeffs(
  */
-  __Pyx_TraceLine(2381,0,__PYX_ERR(0, 2381, __pyx_L1_error))
+  __Pyx_TraceLine(2564,0,__PYX_ERR(0, 2564, __pyx_L1_error))
   __pyx_t_15 = __pyx_v_eob_pars->p_params->chi_2;
   __pyx_v_chi_2 = __pyx_t_15;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2383
+  /* "pyseobnr/eob/waveform/waveform.pyx":2566
  *     cdef double chi_2 = eob_pars.p_params.chi_2
  * 
- *     compute_rho_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,             # <<<<<<<<<<<<<<
- *                 eob_pars.p_params.chi_A, eob_pars.flux_params.rho_coeffs,eob_pars.flux_params.rho_coeffs_log,
- *                 eob_pars.flux_params.f_coeffs,eob_pars.flux_params.f_coeffs_vh, eob_pars.flux_params.extra_PN_terms)
+ *     compute_rho_coeffs(             # <<<<<<<<<<<<<<
+ *         eob_pars.p_params.nu,
+ *         eob_pars.p_params.delta,
  */
-  __Pyx_TraceLine(2383,0,__PYX_ERR(0, 2383, __pyx_L1_error))
-  __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rho_coeffs(__pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars->p_params->delta, __pyx_v_eob_pars->p_params->a, __pyx_v_eob_pars->p_params->chi_S, __pyx_v_eob_pars->p_params->chi_A, __pyx_v_eob_pars->flux_params->rho_coeffs, __pyx_v_eob_pars->flux_params->rho_coeffs_log, __pyx_v_eob_pars->flux_params->f_coeffs, __pyx_v_eob_pars->flux_params->f_coeffs_vh, __pyx_v_eob_pars->flux_params->extra_PN_terms, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2383, __pyx_L1_error)
+  __Pyx_TraceLine(2566,0,__PYX_ERR(0, 2566, __pyx_L1_error))
+  __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rho_coeffs(__pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars->p_params->delta, __pyx_v_eob_pars->p_params->a, __pyx_v_eob_pars->p_params->chi_S, __pyx_v_eob_pars->p_params->chi_A, __pyx_v_eob_pars->flux_params->rho_coeffs, __pyx_v_eob_pars->flux_params->rho_coeffs_log, __pyx_v_eob_pars->flux_params->f_coeffs, __pyx_v_eob_pars->flux_params->f_coeffs_vh, __pyx_v_eob_pars->flux_params->extra_PN_terms, 0); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2566, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2387
- *                 eob_pars.flux_params.f_coeffs,eob_pars.flux_params.f_coeffs_vh, eob_pars.flux_params.extra_PN_terms)
+  /* "pyseobnr/eob/waveform/waveform.pyx":2578
+ *         eob_pars.flux_params.extra_PN_terms)
  * 
- *     compute_delta_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,             # <<<<<<<<<<<<<<
- *         eob_pars.p_params.chi_A, eob_pars.flux_params.delta_coeffs,eob_pars.flux_params.delta_coeffs_vh)
- *     # Now, loop over every mode of interest
+ *     compute_delta_coeffs(             # <<<<<<<<<<<<<<
+ *         eob_pars.p_params.nu,
+ *         eob_pars.p_params.delta,
  */
-  __Pyx_TraceLine(2387,0,__PYX_ERR(0, 2387, __pyx_L1_error))
-  compute_delta_coeffs(__pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars->p_params->delta, __pyx_v_eob_pars->p_params->a, __pyx_v_eob_pars->p_params->chi_S, __pyx_v_eob_pars->p_params->chi_A, __pyx_v_eob_pars->flux_params->delta_coeffs, __pyx_v_eob_pars->flux_params->delta_coeffs_vh); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2387, __pyx_L1_error)
+  __Pyx_TraceLine(2578,0,__PYX_ERR(0, 2578, __pyx_L1_error))
+  compute_delta_coeffs(__pyx_v_eob_pars->p_params->nu, __pyx_v_eob_pars->p_params->delta, __pyx_v_eob_pars->p_params->a, __pyx_v_eob_pars->p_params->chi_S, __pyx_v_eob_pars->p_params->chi_A, __pyx_v_eob_pars->flux_params->delta_coeffs, __pyx_v_eob_pars->flux_params->delta_coeffs_vh); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2578, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2390
- *         eob_pars.p_params.chi_A, eob_pars.flux_params.delta_coeffs,eob_pars.flux_params.delta_coeffs_vh)
+  /* "pyseobnr/eob/waveform/waveform.pyx":2588
+ * 
  *     # Now, loop over every mode of interest
  *     for mode in modes.keys():             # <<<<<<<<<<<<<<
- *         l,m = mode
+ *         l, m = mode
  *         if l==5 and m==5:
  */
-  __Pyx_TraceLine(2390,0,__PYX_ERR(0, 2390, __pyx_L1_error))
+  __Pyx_TraceLine(2588,0,__PYX_ERR(0, 2588, __pyx_L1_error))
   __pyx_t_8 = 0;
   if (unlikely(__pyx_v_modes == Py_None)) {
     PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-    __PYX_ERR(0, 2390, __pyx_L1_error)
+    __PYX_ERR(0, 2588, __pyx_L1_error)
   }
-  __pyx_t_2 = __Pyx_dict_iterator(__pyx_v_modes, 1, __pyx_n_s_keys, (&__pyx_t_9), (&__pyx_t_5)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2390, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_dict_iterator(__pyx_v_modes, 1, __pyx_n_s_keys, (&__pyx_t_9), (&__pyx_t_5)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2588, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_1);
   __pyx_t_1 = __pyx_t_2;
   __pyx_t_2 = 0;
   while (1) {
     __pyx_t_12 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_9, &__pyx_t_8, &__pyx_t_2, NULL, NULL, __pyx_t_5);
     if (unlikely(__pyx_t_12 == 0)) break;
-    if (unlikely(__pyx_t_12 == -1)) __PYX_ERR(0, 2390, __pyx_L1_error)
+    if (unlikely(__pyx_t_12 == -1)) __PYX_ERR(0, 2588, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_XDECREF_SET(__pyx_v_mode, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2391
+    /* "pyseobnr/eob/waveform/waveform.pyx":2589
  *     # Now, loop over every mode of interest
  *     for mode in modes.keys():
- *         l,m = mode             # <<<<<<<<<<<<<<
+ *         l, m = mode             # <<<<<<<<<<<<<<
  *         if l==5 and m==5:
  *             dynamics_interp = 1*dynamics_55
  */
-    __Pyx_TraceLine(2391,0,__PYX_ERR(0, 2391, __pyx_L1_error))
+    __Pyx_TraceLine(2589,0,__PYX_ERR(0, 2589, __pyx_L1_error))
     if ((likely(PyTuple_CheckExact(__pyx_v_mode))) || (PyList_CheckExact(__pyx_v_mode))) {
       PyObject* sequence = __pyx_v_mode;
       Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
       if (unlikely(size != 2)) {
         if (size > 2) __Pyx_RaiseTooManyValuesError(2);
         else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-        __PYX_ERR(0, 2391, __pyx_L1_error)
+        __PYX_ERR(0, 2589, __pyx_L1_error)
       }
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
       if (likely(PyTuple_CheckExact(sequence))) {
         __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
         __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
       } else {
         __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
         __pyx_t_4 = PyList_GET_ITEM(sequence, 1); 
       }
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       #else
-      __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2391, __pyx_L1_error)
+      __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2589, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2391, __pyx_L1_error)
+      __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2589, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       #endif
     } else {
       Py_ssize_t index = -1;
-      __pyx_t_3 = PyObject_GetIter(__pyx_v_mode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2391, __pyx_L1_error)
+      __pyx_t_3 = PyObject_GetIter(__pyx_v_mode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2589, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_16 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_3);
       index = 0; __pyx_t_2 = __pyx_t_16(__pyx_t_3); if (unlikely(!__pyx_t_2)) goto __pyx_L7_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_2);
       index = 1; __pyx_t_4 = __pyx_t_16(__pyx_t_3); if (unlikely(!__pyx_t_4)) goto __pyx_L7_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_4);
-      if (__Pyx_IternextUnpackEndCheck(__pyx_t_16(__pyx_t_3), 2) < 0) __PYX_ERR(0, 2391, __pyx_L1_error)
+      if (__Pyx_IternextUnpackEndCheck(__pyx_t_16(__pyx_t_3), 2) < 0) __PYX_ERR(0, 2589, __pyx_L1_error)
       __pyx_t_16 = NULL;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       goto __pyx_L8_unpacking_done;
       __pyx_L7_unpacking_failed:;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_t_16 = NULL;
       if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-      __PYX_ERR(0, 2391, __pyx_L1_error)
+      __PYX_ERR(0, 2589, __pyx_L1_error)
       __pyx_L8_unpacking_done:;
     }
-    __pyx_t_12 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 2391, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 2589, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_17 = __Pyx_PyInt_As_int(__pyx_t_4); if (unlikely((__pyx_t_17 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 2391, __pyx_L1_error)
+    __pyx_t_17 = __Pyx_PyInt_As_int(__pyx_t_4); if (unlikely((__pyx_t_17 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 2589, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_l = __pyx_t_12;
     __pyx_v_m = __pyx_t_17;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2392
+    /* "pyseobnr/eob/waveform/waveform.pyx":2590
  *     for mode in modes.keys():
- *         l,m = mode
+ *         l, m = mode
  *         if l==5 and m==5:             # <<<<<<<<<<<<<<
  *             dynamics_interp = 1*dynamics_55
  *         else:
  */
-    __Pyx_TraceLine(2392,0,__PYX_ERR(0, 2392, __pyx_L1_error))
+    __Pyx_TraceLine(2590,0,__PYX_ERR(0, 2590, __pyx_L1_error))
     __pyx_t_19 = (__pyx_v_l == 5);
     if (__pyx_t_19) {
     } else {
       __pyx_t_18 = __pyx_t_19;
       goto __pyx_L10_bool_binop_done;
     }
     __pyx_t_19 = (__pyx_v_m == 5);
     __pyx_t_18 = __pyx_t_19;
     __pyx_L10_bool_binop_done:;
     if (__pyx_t_18) {
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2393
- *         l,m = mode
+      /* "pyseobnr/eob/waveform/waveform.pyx":2591
+ *         l, m = mode
  *         if l==5 and m==5:
  *             dynamics_interp = 1*dynamics_55             # <<<<<<<<<<<<<<
  *         else:
  *             dynamics_interp = 1*dynamics_all
  */
-      __Pyx_TraceLine(2393,0,__PYX_ERR(0, 2393, __pyx_L1_error))
-      __pyx_t_4 = PyNumber_Multiply(__pyx_int_1, ((PyObject *)__pyx_v_dynamics_55)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2393, __pyx_L1_error)
+      __Pyx_TraceLine(2591,0,__PYX_ERR(0, 2591, __pyx_L1_error))
+      __pyx_t_4 = PyNumber_Multiply(__pyx_int_1, ((PyObject *)__pyx_v_dynamics_55)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2591, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_XDECREF_SET(__pyx_v_dynamics_interp, __pyx_t_4);
       __pyx_t_4 = 0;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2392
+      /* "pyseobnr/eob/waveform/waveform.pyx":2590
  *     for mode in modes.keys():
- *         l,m = mode
+ *         l, m = mode
  *         if l==5 and m==5:             # <<<<<<<<<<<<<<
  *             dynamics_interp = 1*dynamics_55
  *         else:
  */
       goto __pyx_L9;
     }
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2395
+    /* "pyseobnr/eob/waveform/waveform.pyx":2593
  *             dynamics_interp = 1*dynamics_55
  *         else:
  *             dynamics_interp = 1*dynamics_all             # <<<<<<<<<<<<<<
  * 
  *         phi = dynamics_interp[1]
  */
-    __Pyx_TraceLine(2395,0,__PYX_ERR(0, 2395, __pyx_L1_error))
+    __Pyx_TraceLine(2593,0,__PYX_ERR(0, 2593, __pyx_L1_error))
     /*else*/ {
-      __pyx_t_4 = PyNumber_Multiply(__pyx_int_1, ((PyObject *)__pyx_v_dynamics_all)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2395, __pyx_L1_error)
+      __pyx_t_4 = PyNumber_Multiply(__pyx_int_1, ((PyObject *)__pyx_v_dynamics_all)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2593, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_XDECREF_SET(__pyx_v_dynamics_interp, __pyx_t_4);
       __pyx_t_4 = 0;
     }
     __pyx_L9:;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2397
+    /* "pyseobnr/eob/waveform/waveform.pyx":2595
  *             dynamics_interp = 1*dynamics_all
  * 
  *         phi = dynamics_interp[1]             # <<<<<<<<<<<<<<
  *         pphi = dynamics_interp[3]
  *         omega_circ = dynamics_interp[6]
  */
-    __Pyx_TraceLine(2397,0,__PYX_ERR(0, 2397, __pyx_L1_error))
-    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_dynamics_interp, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2397, __pyx_L1_error)
+    __Pyx_TraceLine(2595,0,__PYX_ERR(0, 2595, __pyx_L1_error))
+    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_dynamics_interp, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2595, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2397, __pyx_L1_error)
+    __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2595, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_phi = __pyx_t_15;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2398
+    /* "pyseobnr/eob/waveform/waveform.pyx":2596
  * 
  *         phi = dynamics_interp[1]
  *         pphi = dynamics_interp[3]             # <<<<<<<<<<<<<<
  *         omega_circ = dynamics_interp[6]
  *         omega = dynamics_interp[5]
  */
-    __Pyx_TraceLine(2398,0,__PYX_ERR(0, 2398, __pyx_L1_error))
-    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_dynamics_interp, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2398, __pyx_L1_error)
+    __Pyx_TraceLine(2596,0,__PYX_ERR(0, 2596, __pyx_L1_error))
+    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_dynamics_interp, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2596, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2398, __pyx_L1_error)
+    __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2596, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_pphi = __pyx_t_15;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2399
+    /* "pyseobnr/eob/waveform/waveform.pyx":2597
  *         phi = dynamics_interp[1]
  *         pphi = dynamics_interp[3]
  *         omega_circ = dynamics_interp[6]             # <<<<<<<<<<<<<<
  *         omega = dynamics_interp[5]
  *         H = eob_pars.p_params.nu*dynamics_interp[4]
  */
-    __Pyx_TraceLine(2399,0,__PYX_ERR(0, 2399, __pyx_L1_error))
-    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_dynamics_interp, 6, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2399, __pyx_L1_error)
+    __Pyx_TraceLine(2597,0,__PYX_ERR(0, 2597, __pyx_L1_error))
+    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_dynamics_interp, 6, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2597, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2399, __pyx_L1_error)
+    __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2597, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_omega_circ = __pyx_t_15;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2400
+    /* "pyseobnr/eob/waveform/waveform.pyx":2598
  *         pphi = dynamics_interp[3]
  *         omega_circ = dynamics_interp[6]
  *         omega = dynamics_interp[5]             # <<<<<<<<<<<<<<
  *         H = eob_pars.p_params.nu*dynamics_interp[4]
  *         v = omega**(1./3)
  */
-    __Pyx_TraceLine(2400,0,__PYX_ERR(0, 2400, __pyx_L1_error))
-    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_dynamics_interp, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2400, __pyx_L1_error)
+    __Pyx_TraceLine(2598,0,__PYX_ERR(0, 2598, __pyx_L1_error))
+    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_dynamics_interp, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2598, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2400, __pyx_L1_error)
+    __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2598, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_omega = __pyx_t_15;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2401
+    /* "pyseobnr/eob/waveform/waveform.pyx":2599
  *         omega_circ = dynamics_interp[6]
  *         omega = dynamics_interp[5]
  *         H = eob_pars.p_params.nu*dynamics_interp[4]             # <<<<<<<<<<<<<<
  *         v = omega**(1./3)
  *         vh = (H*omega)**(1./3)
  */
-    __Pyx_TraceLine(2401,0,__PYX_ERR(0, 2401, __pyx_L1_error))
-    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_eob_pars->p_params->nu); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2401, __pyx_L1_error)
+    __Pyx_TraceLine(2599,0,__PYX_ERR(0, 2599, __pyx_L1_error))
+    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_eob_pars->p_params->nu); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2599, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_dynamics_interp, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2401, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_dynamics_interp, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2599, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyNumber_Multiply(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2401, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Multiply(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2599, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2401, __pyx_L1_error)
+    __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2599, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_H = __pyx_t_15;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2402
+    /* "pyseobnr/eob/waveform/waveform.pyx":2600
  *         omega = dynamics_interp[5]
  *         H = eob_pars.p_params.nu*dynamics_interp[4]
  *         v = omega**(1./3)             # <<<<<<<<<<<<<<
  *         vh = (H*omega)**(1./3)
  *         vphi = omega/omega_circ**(2./3)
  */
-    __Pyx_TraceLine(2402,0,__PYX_ERR(0, 2402, __pyx_L1_error))
+    __Pyx_TraceLine(2600,0,__PYX_ERR(0, 2600, __pyx_L1_error))
     __pyx_v_v = pow(__pyx_v_omega, (1. / 3.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2403
+    /* "pyseobnr/eob/waveform/waveform.pyx":2601
  *         H = eob_pars.p_params.nu*dynamics_interp[4]
  *         v = omega**(1./3)
  *         vh = (H*omega)**(1./3)             # <<<<<<<<<<<<<<
  *         vphi = omega/omega_circ**(2./3)
  *         vphi2 = vphi*vphi
  */
-    __Pyx_TraceLine(2403,0,__PYX_ERR(0, 2403, __pyx_L1_error))
+    __Pyx_TraceLine(2601,0,__PYX_ERR(0, 2601, __pyx_L1_error))
     __pyx_v_vh = pow((__pyx_v_H * __pyx_v_omega), (1. / 3.0));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2404
+    /* "pyseobnr/eob/waveform/waveform.pyx":2602
  *         v = omega**(1./3)
  *         vh = (H*omega)**(1./3)
  *         vphi = omega/omega_circ**(2./3)             # <<<<<<<<<<<<<<
  *         vphi2 = vphi*vphi
  * 
  */
-    __Pyx_TraceLine(2404,0,__PYX_ERR(0, 2404, __pyx_L1_error))
+    __Pyx_TraceLine(2602,0,__PYX_ERR(0, 2602, __pyx_L1_error))
     __pyx_v_vphi = (__pyx_v_omega / pow(__pyx_v_omega_circ, (2. / 3.0)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2405
+    /* "pyseobnr/eob/waveform/waveform.pyx":2603
  *         vh = (H*omega)**(1./3)
  *         vphi = omega/omega_circ**(2./3)
  *         vphi2 = vphi*vphi             # <<<<<<<<<<<<<<
  * 
  *         for j in range(PN_limit):
  */
-    __Pyx_TraceLine(2405,0,__PYX_ERR(0, 2405, __pyx_L1_error))
+    __Pyx_TraceLine(2603,0,__PYX_ERR(0, 2603, __pyx_L1_error))
     __pyx_v_vphi2 = (__pyx_v_vphi * __pyx_v_vphi);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2407
+    /* "pyseobnr/eob/waveform/waveform.pyx":2605
  *         vphi2 = vphi*vphi
  * 
  *         for j in range(PN_limit):             # <<<<<<<<<<<<<<
  *             vs[j] = v**j
  *             vhs[j] = vh**j
  */
-    __Pyx_TraceLine(2407,0,__PYX_ERR(0, 2407, __pyx_L1_error))
+    __Pyx_TraceLine(2605,0,__PYX_ERR(0, 2605, __pyx_L1_error))
     __pyx_t_17 = PN_limit;
     __pyx_t_12 = __pyx_t_17;
     for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_12; __pyx_t_20+=1) {
       __pyx_v_j = __pyx_t_20;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2408
+      /* "pyseobnr/eob/waveform/waveform.pyx":2606
  * 
  *         for j in range(PN_limit):
  *             vs[j] = v**j             # <<<<<<<<<<<<<<
  *             vhs[j] = vh**j
- *         source1 = (H * H - 1.0) / (2.0 * eob_pars.p_params.nu) + 1.0 # H_eff
+ *         source1 = (H * H - 1.0) / (2.0 * eob_pars.p_params.nu) + 1.0  # H_eff
  */
-      __Pyx_TraceLine(2408,0,__PYX_ERR(0, 2408, __pyx_L1_error))
+      __Pyx_TraceLine(2606,0,__PYX_ERR(0, 2606, __pyx_L1_error))
       (__pyx_v_vs[__pyx_v_j]) = pow(__pyx_v_v, ((double)__pyx_v_j));
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2409
+      /* "pyseobnr/eob/waveform/waveform.pyx":2607
  *         for j in range(PN_limit):
  *             vs[j] = v**j
  *             vhs[j] = vh**j             # <<<<<<<<<<<<<<
- *         source1 = (H * H - 1.0) / (2.0 * eob_pars.p_params.nu) + 1.0 # H_eff
+ *         source1 = (H * H - 1.0) / (2.0 * eob_pars.p_params.nu) + 1.0  # H_eff
  *         source2 = v*pphi
  */
-      __Pyx_TraceLine(2409,0,__PYX_ERR(0, 2409, __pyx_L1_error))
+      __Pyx_TraceLine(2607,0,__PYX_ERR(0, 2607, __pyx_L1_error))
       (__pyx_v_vhs[__pyx_v_j]) = pow(__pyx_v_vh, ((double)__pyx_v_j));
     }
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2410
+    /* "pyseobnr/eob/waveform/waveform.pyx":2608
  *             vs[j] = v**j
  *             vhs[j] = vh**j
- *         source1 = (H * H - 1.0) / (2.0 * eob_pars.p_params.nu) + 1.0 # H_eff             # <<<<<<<<<<<<<<
+ *         source1 = (H * H - 1.0) / (2.0 * eob_pars.p_params.nu) + 1.0  # H_eff             # <<<<<<<<<<<<<<
  *         source2 = v*pphi
  * 
  */
-    __Pyx_TraceLine(2410,0,__PYX_ERR(0, 2410, __pyx_L1_error))
+    __Pyx_TraceLine(2608,0,__PYX_ERR(0, 2608, __pyx_L1_error))
     __pyx_v_source1 = ((((__pyx_v_H * __pyx_v_H) - 1.0) / (2.0 * __pyx_v_eob_pars->p_params->nu)) + 1.0);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2411
+    /* "pyseobnr/eob/waveform/waveform.pyx":2609
  *             vhs[j] = vh**j
- *         source1 = (H * H - 1.0) / (2.0 * eob_pars.p_params.nu) + 1.0 # H_eff
+ *         source1 = (H * H - 1.0) / (2.0 * eob_pars.p_params.nu) + 1.0  # H_eff
  *         source2 = v*pphi             # <<<<<<<<<<<<<<
  * 
  *         if ((l + m) % 2) == 0:
  */
-    __Pyx_TraceLine(2411,0,__PYX_ERR(0, 2411, __pyx_L1_error))
+    __Pyx_TraceLine(2609,0,__PYX_ERR(0, 2609, __pyx_L1_error))
     __pyx_v_source2 = (__pyx_v_v * __pyx_v_pphi);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2413
+    /* "pyseobnr/eob/waveform/waveform.pyx":2611
  *         source2 = v*pphi
  * 
  *         if ((l + m) % 2) == 0:             # <<<<<<<<<<<<<<
  *             Slm = source1
  *         else:
  */
-    __Pyx_TraceLine(2413,0,__PYX_ERR(0, 2413, __pyx_L1_error))
+    __Pyx_TraceLine(2611,0,__PYX_ERR(0, 2611, __pyx_L1_error))
     __pyx_t_18 = (((__pyx_v_l + __pyx_v_m) % 2) == 0);
     if (__pyx_t_18) {
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2414
+      /* "pyseobnr/eob/waveform/waveform.pyx":2612
  * 
  *         if ((l + m) % 2) == 0:
  *             Slm = source1             # <<<<<<<<<<<<<<
  *         else:
  *             Slm = source2
  */
-      __Pyx_TraceLine(2414,0,__PYX_ERR(0, 2414, __pyx_L1_error))
+      __Pyx_TraceLine(2612,0,__PYX_ERR(0, 2612, __pyx_L1_error))
       __pyx_v_Slm = __pyx_v_source1;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2413
+      /* "pyseobnr/eob/waveform/waveform.pyx":2611
  *         source2 = v*pphi
  * 
  *         if ((l + m) % 2) == 0:             # <<<<<<<<<<<<<<
  *             Slm = source1
  *         else:
  */
       goto __pyx_L14;
     }
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2416
+    /* "pyseobnr/eob/waveform/waveform.pyx":2614
  *             Slm = source1
  *         else:
  *             Slm = source2             # <<<<<<<<<<<<<<
+ * 
  *         # Step 1: compute the mode with the calibration coeff set to 0
- *         power = modes[mode]
  */
-    __Pyx_TraceLine(2416,0,__PYX_ERR(0, 2416, __pyx_L1_error))
+    __Pyx_TraceLine(2614,0,__PYX_ERR(0, 2614, __pyx_L1_error))
     /*else*/ {
       __pyx_v_Slm = __pyx_v_source2;
     }
     __pyx_L14:;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2418
- *             Slm = source2
+    /* "pyseobnr/eob/waveform/waveform.pyx":2617
+ * 
  *         # Step 1: compute the mode with the calibration coeff set to 0
  *         power = modes[mode]             # <<<<<<<<<<<<<<
- * 
- *         eob_pars.flux_params.f_coeffs[l,m,power] = 0.0
+ *         eob_pars.flux_params.f_coeffs[l, m, power] = 0.0
+ *         hlm = cabs(compute_mode(vphi2, phi, Slm, vs, vhs, l, m, eob_pars))
  */
-    __Pyx_TraceLine(2418,0,__PYX_ERR(0, 2418, __pyx_L1_error))
+    __Pyx_TraceLine(2617,0,__PYX_ERR(0, 2617, __pyx_L1_error))
     if (unlikely(__pyx_v_modes == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 2418, __pyx_L1_error)
+      __PYX_ERR(0, 2617, __pyx_L1_error)
     }
-    __pyx_t_3 = __Pyx_PyDict_GetItem(__pyx_v_modes, __pyx_v_mode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2418, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyDict_GetItem(__pyx_v_modes, __pyx_v_mode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2617, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_17 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_17 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 2418, __pyx_L1_error)
+    __pyx_t_17 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_17 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 2617, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_power = __pyx_t_17;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2420
+    /* "pyseobnr/eob/waveform/waveform.pyx":2618
+ *         # Step 1: compute the mode with the calibration coeff set to 0
  *         power = modes[mode]
+ *         eob_pars.flux_params.f_coeffs[l, m, power] = 0.0             # <<<<<<<<<<<<<<
+ *         hlm = cabs(compute_mode(vphi2, phi, Slm, vs, vhs, l, m, eob_pars))
  * 
- *         eob_pars.flux_params.f_coeffs[l,m,power] = 0.0             # <<<<<<<<<<<<<<
- *         hlm = cabs(compute_mode(vphi2,phi, Slm, vs,vhs,l, m,eob_pars))
- *         # Step 2: compute rho_lm for this mode
  */
-    __Pyx_TraceLine(2420,0,__PYX_ERR(0, 2420, __pyx_L1_error))
+    __Pyx_TraceLine(2618,0,__PYX_ERR(0, 2618, __pyx_L1_error))
     __pyx_t_14 = __pyx_v_l;
     __pyx_t_21 = __pyx_v_m;
     __pyx_t_22 = __pyx_v_power;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eob_pars->flux_params->f_coeffs.data + __pyx_t_14 * __pyx_v_eob_pars->flux_params->f_coeffs.strides[0]) ) + __pyx_t_21 * __pyx_v_eob_pars->flux_params->f_coeffs.strides[1]) ) + __pyx_t_22 * __pyx_v_eob_pars->flux_params->f_coeffs.strides[2]) )) = 0.0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2421
+    /* "pyseobnr/eob/waveform/waveform.pyx":2619
+ *         power = modes[mode]
+ *         eob_pars.flux_params.f_coeffs[l, m, power] = 0.0
+ *         hlm = cabs(compute_mode(vphi2, phi, Slm, vs, vhs, l, m, eob_pars))             # <<<<<<<<<<<<<<
  * 
- *         eob_pars.flux_params.f_coeffs[l,m,power] = 0.0
- *         hlm = cabs(compute_mode(vphi2,phi, Slm, vs,vhs,l, m,eob_pars))             # <<<<<<<<<<<<<<
  *         # Step 2: compute rho_lm for this mode
- *         rholm = creal(compute_rholm_single(vs,vh,l,m,eob_pars))
  */
-    __Pyx_TraceLine(2421,0,__PYX_ERR(0, 2421, __pyx_L1_error))
-    __pyx_t_23 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_mode(__pyx_v_vphi2, __pyx_v_phi, __pyx_v_Slm, __pyx_v_vs, __pyx_v_vhs, __pyx_v_l, __pyx_v_m, __pyx_v_eob_pars); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2421, __pyx_L1_error)
+    __Pyx_TraceLine(2619,0,__PYX_ERR(0, 2619, __pyx_L1_error))
+    __pyx_t_23 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_mode(__pyx_v_vphi2, __pyx_v_phi, __pyx_v_Slm, __pyx_v_vs, __pyx_v_vhs, __pyx_v_l, __pyx_v_m, __pyx_v_eob_pars); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2619, __pyx_L1_error)
     __pyx_v_hlm = cabs(__pyx_t_23);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2423
- *         hlm = cabs(compute_mode(vphi2,phi, Slm, vs,vhs,l, m,eob_pars))
+    /* "pyseobnr/eob/waveform/waveform.pyx":2622
+ * 
  *         # Step 2: compute rho_lm for this mode
- *         rholm = creal(compute_rholm_single(vs,vh,l,m,eob_pars))             # <<<<<<<<<<<<<<
+ *         rholm = creal(compute_rholm_single(vs, vh, l, m, eob_pars))             # <<<<<<<<<<<<<<
  * 
  *         # Step 3: compute K = |h_{lm}|/|rho_{lm}|
  */
-    __Pyx_TraceLine(2423,0,__PYX_ERR(0, 2423, __pyx_L1_error))
-    __pyx_t_23 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rholm_single(__pyx_v_vs, __pyx_v_vh, __pyx_v_l, __pyx_v_m, __pyx_v_eob_pars); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2423, __pyx_L1_error)
+    __Pyx_TraceLine(2622,0,__PYX_ERR(0, 2622, __pyx_L1_error))
+    __pyx_t_23 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_rholm_single(__pyx_v_vs, __pyx_v_vh, __pyx_v_l, __pyx_v_m, __pyx_v_eob_pars); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2622, __pyx_L1_error)
     __pyx_v_rholm = creal(__pyx_t_23);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2426
+    /* "pyseobnr/eob/waveform/waveform.pyx":2625
  * 
  *         # Step 3: compute K = |h_{lm}|/|rho_{lm}|
  *         K = hlm/fabs(rholm)             # <<<<<<<<<<<<<<
  * 
  *         # Step 4: compute |h_{lm}^{NR}| from fit
  */
-    __Pyx_TraceLine(2426,0,__PYX_ERR(0, 2426, __pyx_L1_error))
+    __Pyx_TraceLine(2625,0,__PYX_ERR(0, 2625, __pyx_L1_error))
     __pyx_v_K = (__pyx_v_hlm / fabs(__pyx_v_rholm));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2430
- *         # Step 4: compute |h_{lm}^{NR}| from fit
+    /* "pyseobnr/eob/waveform/waveform.pyx":2628
  * 
- *         amp =  amp_fits[(l, m)]             # <<<<<<<<<<<<<<
- *         amp22 = amp_fits[(2,2)]
+ *         # Step 4: compute |h_{lm}^{NR}| from fit
+ *         amp = amp_fits[(l, m)]             # <<<<<<<<<<<<<<
+ *         amp22 = amp_fits[(2, 2)]
  * 
  */
-    __Pyx_TraceLine(2430,0,__PYX_ERR(0, 2430, __pyx_L1_error))
+    __Pyx_TraceLine(2628,0,__PYX_ERR(0, 2628, __pyx_L1_error))
     if (unlikely(__pyx_v_amp_fits == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 2430, __pyx_L1_error)
+      __PYX_ERR(0, 2628, __pyx_L1_error)
     }
-    __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_l); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2430, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_l); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2628, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_m); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2430, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_m); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2628, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2430, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2628, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_3);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3)) __PYX_ERR(0, 2430, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3)) __PYX_ERR(0, 2628, __pyx_L1_error);
     __Pyx_GIVEREF(__pyx_t_2);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2)) __PYX_ERR(0, 2430, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2)) __PYX_ERR(0, 2628, __pyx_L1_error);
     __pyx_t_3 = 0;
     __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyDict_GetItem(__pyx_v_amp_fits, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2430, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyDict_GetItem(__pyx_v_amp_fits, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2628, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2430, __pyx_L1_error)
+    __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2628, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_amp = __pyx_t_15;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2431
- * 
- *         amp =  amp_fits[(l, m)]
- *         amp22 = amp_fits[(2,2)]             # <<<<<<<<<<<<<<
+    /* "pyseobnr/eob/waveform/waveform.pyx":2629
+ *         # Step 4: compute |h_{lm}^{NR}| from fit
+ *         amp = amp_fits[(l, m)]
+ *         amp22 = amp_fits[(2, 2)]             # <<<<<<<<<<<<<<
  * 
  *         # when the amplitude at merger is too small a positive sign is better
  */
-    __Pyx_TraceLine(2431,0,__PYX_ERR(0, 2431, __pyx_L1_error))
+    __Pyx_TraceLine(2629,0,__PYX_ERR(0, 2629, __pyx_L1_error))
     if (unlikely(__pyx_v_amp_fits == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 2431, __pyx_L1_error)
+      __PYX_ERR(0, 2629, __pyx_L1_error)
     }
-    __pyx_t_2 = __Pyx_PyDict_GetItem(__pyx_v_amp_fits, __pyx_tuple__19); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2431, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyDict_GetItem(__pyx_v_amp_fits, __pyx_tuple__19); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2629, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_XDECREF_SET(__pyx_v_amp22, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2434
+    /* "pyseobnr/eob/waveform/waveform.pyx":2632
  * 
  *         # when the amplitude at merger is too small a positive sign is better
- *         if np.abs(amp)<1e-4:             # <<<<<<<<<<<<<<
+ *         if np.abs(amp) < 1e-4:             # <<<<<<<<<<<<<<
  *             amp = np.abs(amp)
  * 
  */
-    __Pyx_TraceLine(2434,0,__PYX_ERR(0, 2434, __pyx_L1_error))
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2434, __pyx_L1_error)
+    __Pyx_TraceLine(2632,0,__PYX_ERR(0, 2632, __pyx_L1_error))
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_abs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2434, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_abs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_amp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2434, __pyx_L1_error)
+    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_amp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_11 = NULL;
     __pyx_t_17 = 0;
     #if CYTHON_UNPACK_METHODS
     if (unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_11)) {
@@ -34378,38 +34463,38 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_4};
       __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
       __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2434, __pyx_L1_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2632, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
-    __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_float_1eneg_4, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2434, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_float_1eneg_4, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2632, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_18 < 0))) __PYX_ERR(0, 2434, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_18 < 0))) __PYX_ERR(0, 2632, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_18) {
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2435
+      /* "pyseobnr/eob/waveform/waveform.pyx":2633
  *         # when the amplitude at merger is too small a positive sign is better
- *         if np.abs(amp)<1e-4:
+ *         if np.abs(amp) < 1e-4:
  *             amp = np.abs(amp)             # <<<<<<<<<<<<<<
  * 
- *         min_amp = amp_thresholds[(l,m)]
+ *         min_amp = amp_thresholds[(l, m)]
  */
-      __Pyx_TraceLine(2435,0,__PYX_ERR(0, 2435, __pyx_L1_error))
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2435, __pyx_L1_error)
+      __Pyx_TraceLine(2633,0,__PYX_ERR(0, 2633, __pyx_L1_error))
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2633, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_abs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2435, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_abs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2633, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyFloat_FromDouble(__pyx_v_amp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2435, __pyx_L1_error)
+      __pyx_t_2 = PyFloat_FromDouble(__pyx_v_amp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2633, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_11 = NULL;
       __pyx_t_17 = 0;
       #if CYTHON_UNPACK_METHODS
       if (unlikely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_11)) {
@@ -34422,76 +34507,76 @@
       }
       #endif
       {
         PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_2};
         __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
         __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2435, __pyx_L1_error)
+        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2633, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       }
-      __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2435, __pyx_L1_error)
+      __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2633, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_v_amp = __pyx_t_15;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2434
+      /* "pyseobnr/eob/waveform/waveform.pyx":2632
  * 
  *         # when the amplitude at merger is too small a positive sign is better
- *         if np.abs(amp)<1e-4:             # <<<<<<<<<<<<<<
+ *         if np.abs(amp) < 1e-4:             # <<<<<<<<<<<<<<
  *             amp = np.abs(amp)
  * 
  */
     }
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2437
+    /* "pyseobnr/eob/waveform/waveform.pyx":2635
  *             amp = np.abs(amp)
  * 
- *         min_amp = amp_thresholds[(l,m)]             # <<<<<<<<<<<<<<
- *         if np.abs(amp)<amp22/min_amp:
+ *         min_amp = amp_thresholds[(l, m)]             # <<<<<<<<<<<<<<
+ *         if np.abs(amp) < amp22/min_amp:
  *             amp = np.sign(amp)*amp22/min_amp
  */
-    __Pyx_TraceLine(2437,0,__PYX_ERR(0, 2437, __pyx_L1_error))
+    __Pyx_TraceLine(2635,0,__PYX_ERR(0, 2635, __pyx_L1_error))
     if (unlikely(__pyx_v_amp_thresholds == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 2437, __pyx_L1_error)
+      __PYX_ERR(0, 2635, __pyx_L1_error)
     }
-    __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_l); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2437, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_l); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2635, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_m); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2437, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_m); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2635, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2437, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2635, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_3);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3)) __PYX_ERR(0, 2437, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3)) __PYX_ERR(0, 2635, __pyx_L1_error);
     __Pyx_GIVEREF(__pyx_t_4);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4)) __PYX_ERR(0, 2437, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4)) __PYX_ERR(0, 2635, __pyx_L1_error);
     __pyx_t_3 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyDict_GetItem(__pyx_v_amp_thresholds, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2437, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyDict_GetItem(__pyx_v_amp_thresholds, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2635, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2437, __pyx_L1_error)
+    __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2635, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_min_amp = __pyx_t_15;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2438
+    /* "pyseobnr/eob/waveform/waveform.pyx":2636
  * 
- *         min_amp = amp_thresholds[(l,m)]
- *         if np.abs(amp)<amp22/min_amp:             # <<<<<<<<<<<<<<
+ *         min_amp = amp_thresholds[(l, m)]
+ *         if np.abs(amp) < amp22/min_amp:             # <<<<<<<<<<<<<<
  *             amp = np.sign(amp)*amp22/min_amp
  * 
  */
-    __Pyx_TraceLine(2438,0,__PYX_ERR(0, 2438, __pyx_L1_error))
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2438, __pyx_L1_error)
+    __Pyx_TraceLine(2636,0,__PYX_ERR(0, 2636, __pyx_L1_error))
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2636, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_abs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2438, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_abs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2636, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyFloat_FromDouble(__pyx_v_amp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2438, __pyx_L1_error)
+    __pyx_t_2 = PyFloat_FromDouble(__pyx_v_amp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2636, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_11 = NULL;
     __pyx_t_17 = 0;
     #if CYTHON_UNPACK_METHODS
     if (unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_11)) {
@@ -34504,44 +34589,44 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_2};
       __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
       __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2438, __pyx_L1_error)
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2636, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
-    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_min_amp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2438, __pyx_L1_error)
+    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_min_amp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2636, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_v_amp22, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2438, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_v_amp22, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2636, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyObject_RichCompare(__pyx_t_4, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2438, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_t_4, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2636, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_18 < 0))) __PYX_ERR(0, 2438, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_18 < 0))) __PYX_ERR(0, 2636, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_18) {
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2439
- *         min_amp = amp_thresholds[(l,m)]
- *         if np.abs(amp)<amp22/min_amp:
+      /* "pyseobnr/eob/waveform/waveform.pyx":2637
+ *         min_amp = amp_thresholds[(l, m)]
+ *         if np.abs(amp) < amp22/min_amp:
  *             amp = np.sign(amp)*amp22/min_amp             # <<<<<<<<<<<<<<
  * 
- * 
+ *         amp *= eob_pars.p_params.nu
  */
-      __Pyx_TraceLine(2439,0,__PYX_ERR(0, 2439, __pyx_L1_error))
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2439, __pyx_L1_error)
+      __Pyx_TraceLine(2637,0,__PYX_ERR(0, 2637, __pyx_L1_error))
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2637, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sign); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2439, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sign); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2637, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyFloat_FromDouble(__pyx_v_amp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2439, __pyx_L1_error)
+      __pyx_t_2 = PyFloat_FromDouble(__pyx_v_amp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2637, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_11 = NULL;
       __pyx_t_17 = 0;
       #if CYTHON_UNPACK_METHODS
       if (unlikely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_11)) {
@@ -34554,91 +34639,91 @@
       }
       #endif
       {
         PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_2};
         __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
         __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2439, __pyx_L1_error)
+        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2637, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       }
-      __pyx_t_4 = PyNumber_Multiply(__pyx_t_3, __pyx_v_amp22); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2439, __pyx_L1_error)
+      __pyx_t_4 = PyNumber_Multiply(__pyx_t_3, __pyx_v_amp22); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2637, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyFloat_FromDouble(__pyx_v_min_amp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2439, __pyx_L1_error)
+      __pyx_t_3 = PyFloat_FromDouble(__pyx_v_min_amp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2637, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2439, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2637, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2439, __pyx_L1_error)
+      __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2637, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_v_amp = __pyx_t_15;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2438
+      /* "pyseobnr/eob/waveform/waveform.pyx":2636
  * 
- *         min_amp = amp_thresholds[(l,m)]
- *         if np.abs(amp)<amp22/min_amp:             # <<<<<<<<<<<<<<
+ *         min_amp = amp_thresholds[(l, m)]
+ *         if np.abs(amp) < amp22/min_amp:             # <<<<<<<<<<<<<<
  *             amp = np.sign(amp)*amp22/min_amp
  * 
  */
     }
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2442
- * 
- * 
- *         amp*=eob_pars.p_params.nu             # <<<<<<<<<<<<<<
+    /* "pyseobnr/eob/waveform/waveform.pyx":2639
+ *             amp = np.sign(amp)*amp22/min_amp
  * 
+ *         amp *= eob_pars.p_params.nu             # <<<<<<<<<<<<<<
  * 
+ *         # Step 5: compute c_lm = (|h_{lm}^{NR}|/K - rho_{lm}(clm=0))/v**power
  */
-    __Pyx_TraceLine(2442,0,__PYX_ERR(0, 2442, __pyx_L1_error))
+    __Pyx_TraceLine(2639,0,__PYX_ERR(0, 2639, __pyx_L1_error))
     __pyx_v_amp = (__pyx_v_amp * __pyx_v_eob_pars->p_params->nu);
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2446
+    /* "pyseobnr/eob/waveform/waveform.pyx":2642
  * 
  *         # Step 5: compute c_lm = (|h_{lm}^{NR}|/K - rho_{lm}(clm=0))/v**power
  *         clm1 = (amp/K - rholm)*1/v**power             # <<<<<<<<<<<<<<
  *         clm2 = (-amp/K - rholm)*1/v**power
  * 
  */
-    __Pyx_TraceLine(2446,0,__PYX_ERR(0, 2446, __pyx_L1_error))
+    __Pyx_TraceLine(2642,0,__PYX_ERR(0, 2642, __pyx_L1_error))
     __pyx_v_clm1 = ((((__pyx_v_amp / __pyx_v_K) - __pyx_v_rholm) * 1.0) / pow(__pyx_v_v, ((double)__pyx_v_power)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2447
+    /* "pyseobnr/eob/waveform/waveform.pyx":2643
  *         # Step 5: compute c_lm = (|h_{lm}^{NR}|/K - rho_{lm}(clm=0))/v**power
  *         clm1 = (amp/K - rholm)*1/v**power
  *         clm2 = (-amp/K - rholm)*1/v**power             # <<<<<<<<<<<<<<
  * 
  *         # We always pick the positive solution
  */
-    __Pyx_TraceLine(2447,0,__PYX_ERR(0, 2447, __pyx_L1_error))
+    __Pyx_TraceLine(2643,0,__PYX_ERR(0, 2643, __pyx_L1_error))
     __pyx_v_clm2 = (((((-__pyx_v_amp) / __pyx_v_K) - __pyx_v_rholm) * 1.0) / pow(__pyx_v_v, ((double)__pyx_v_power)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2450
+    /* "pyseobnr/eob/waveform/waveform.pyx":2646
  * 
  *         # We always pick the positive solution
- *         eob_pars.flux_params.f_coeffs[l,m,power] = clm1             # <<<<<<<<<<<<<<
+ *         eob_pars.flux_params.f_coeffs[l, m, power] = clm1             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __Pyx_TraceLine(2450,0,__PYX_ERR(0, 2450, __pyx_L1_error))
+    __Pyx_TraceLine(2646,0,__PYX_ERR(0, 2646, __pyx_L1_error))
     __pyx_t_22 = __pyx_v_l;
     __pyx_t_21 = __pyx_v_m;
     __pyx_t_14 = __pyx_v_power;
     *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eob_pars->flux_params->f_coeffs.data + __pyx_t_22 * __pyx_v_eob_pars->flux_params->f_coeffs.strides[0]) ) + __pyx_t_21 * __pyx_v_eob_pars->flux_params->f_coeffs.strides[1]) ) + __pyx_t_14 * __pyx_v_eob_pars->flux_params->f_coeffs.strides[2]) )) = __pyx_v_clm1;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2353
+  /* "pyseobnr/eob/waveform/waveform.pyx":2532
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef compute_special_coeffs(double[:,:] dynamics, double t_attach, EOBParams eob_pars,             # <<<<<<<<<<<<<<
- *     dict amp_fits, dict amp_thresholds, dict modes={(2,1):7,(4,3):7,(5,5):5}):
- *     """
+ * cpdef compute_special_coeffs(             # <<<<<<<<<<<<<<
+ *     double[:, :] dynamics,
+ *     double t_attach,
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -34739,109 +34824,109 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dynamics)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2353, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2532, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t_attach)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2353, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2532, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_special_coeffs", 0, 5, 6, 1); __PYX_ERR(0, 2353, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_special_coeffs", 0, 5, 6, 1); __PYX_ERR(0, 2532, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_eob_pars)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2353, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2532, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_special_coeffs", 0, 5, 6, 2); __PYX_ERR(0, 2353, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_special_coeffs", 0, 5, 6, 2); __PYX_ERR(0, 2532, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_amp_fits)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2353, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2532, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_special_coeffs", 0, 5, 6, 3); __PYX_ERR(0, 2353, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_special_coeffs", 0, 5, 6, 3); __PYX_ERR(0, 2532, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_amp_thresholds)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[4]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2353, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2532, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_special_coeffs", 0, 5, 6, 4); __PYX_ERR(0, 2353, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_special_coeffs", 0, 5, 6, 4); __PYX_ERR(0, 2532, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_modes);
           if (value) { values[5] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2353, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2532, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_special_coeffs") < 0)) __PYX_ERR(0, 2353, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_special_coeffs") < 0)) __PYX_ERR(0, 2532, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  6: values[5] = __Pyx_Arg_FASTCALL(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = __Pyx_Arg_FASTCALL(__pyx_args, 4);
         values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
         values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
         values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_dynamics = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_dynamics.memview)) __PYX_ERR(0, 2353, __pyx_L3_error)
-    __pyx_v_t_attach = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_t_attach == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2353, __pyx_L3_error)
+    __pyx_v_dynamics = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_dynamics.memview)) __PYX_ERR(0, 2533, __pyx_L3_error)
+    __pyx_v_t_attach = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_t_attach == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 2534, __pyx_L3_error)
     __pyx_v_eob_pars = ((struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *)values[2]);
     __pyx_v_amp_fits = ((PyObject*)values[3]);
     __pyx_v_amp_thresholds = ((PyObject*)values[4]);
     __pyx_v_modes = ((PyObject*)values[5]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("compute_special_coeffs", 0, 5, 6, __pyx_nargs); __PYX_ERR(0, 2353, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("compute_special_coeffs", 0, 5, 6, __pyx_nargs); __PYX_ERR(0, 2532, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_dynamics, 1);
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.compute_special_coeffs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_eob_pars), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "eob_pars", 0))) __PYX_ERR(0, 2353, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_amp_fits), (&PyDict_Type), 1, "amp_fits", 1))) __PYX_ERR(0, 2354, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_amp_thresholds), (&PyDict_Type), 1, "amp_thresholds", 1))) __PYX_ERR(0, 2354, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_modes), (&PyDict_Type), 1, "modes", 1))) __PYX_ERR(0, 2354, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_eob_pars), __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams, 1, "eob_pars", 0))) __PYX_ERR(0, 2535, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_amp_fits), (&PyDict_Type), 1, "amp_fits", 1))) __PYX_ERR(0, 2536, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_amp_thresholds), (&PyDict_Type), 1, "amp_thresholds", 1))) __PYX_ERR(0, 2537, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_modes), (&PyDict_Type), 1, "modes", 1))) __PYX_ERR(0, 2538, __pyx_L1_error)
   __pyx_r = __pyx_pf_8pyseobnr_3eob_8waveform_8waveform_22compute_special_coeffs(__pyx_self, __pyx_v_dynamics, __pyx_v_t_attach, __pyx_v_eob_pars, __pyx_v_amp_fits, __pyx_v_amp_thresholds, __pyx_v_modes);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -34863,19 +34948,19 @@
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8pyseobnr_3eob_8waveform_8waveform_compute_special_coeffs __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__18)
   __Pyx_RefNannySetupContext("compute_special_coeffs", 1);
-  __Pyx_TraceCall("compute_special_coeffs (wrapper)", __pyx_f[0], 2353, 0, __PYX_ERR(0, 2353, __pyx_L1_error));
+  __Pyx_TraceCall("compute_special_coeffs (wrapper)", __pyx_f[0], 2532, 0, __PYX_ERR(0, 2532, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.modes = __pyx_v_modes;
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_special_coeffs(__pyx_v_dynamics, __pyx_v_t_attach, __pyx_v_eob_pars, __pyx_v_amp_fits, __pyx_v_amp_thresholds, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2353, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_special_coeffs(__pyx_v_dynamics, __pyx_v_t_attach, __pyx_v_eob_pars, __pyx_v_amp_fits, __pyx_v_amp_thresholds, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2532, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -34885,18 +34970,18 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2458
+/* "pyseobnr/eob/waveform/waveform.pyx":2653
  * @cython.wraparound(False)
  * @cython.cdivision(True)
- * cpdef compute_factors(double[::1] phi_orb,int m_max, double complex[:,:]result):             # <<<<<<<<<<<<<<
+ * cpdef compute_factors(double[::1] phi_orb, int m_max, double complex[:, :] result):             # <<<<<<<<<<<<<<
  *     """
  *     Trivial helper function that computes iterative :math:`e^{im\\phi}`.
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_25compute_factors(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
@@ -34919,87 +35004,87 @@
   int __pyx_t_6;
   int __pyx_t_7;
   int __pyx_t_8;
   Py_ssize_t __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   __Pyx_RefNannySetupContext("compute_factors", 1);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2464
- *     This is used in interpolation, see :py:func:`.compute_hlms.interpolate_modes_fast`.
+  /* "pyseobnr/eob/waveform/waveform.pyx":2660
  *     """
+ * 
  *     cdef int N = phi_orb.shape[0]             # <<<<<<<<<<<<<<
- *     cdef int i,m
+ *     cdef int i, m
  *     cdef double complex factor
  */
   __pyx_v_N = (__pyx_v_phi_orb.shape[0]);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2467
- *     cdef int i,m
+  /* "pyseobnr/eob/waveform/waveform.pyx":2663
+ *     cdef int i, m
  *     cdef double complex factor
  *     for i in range(N):             # <<<<<<<<<<<<<<
  *         factor = cexp(-1*I*phi_orb[i])
- *         result[0][i]  = factor
+ *         result[0][i] = factor
  */
   __pyx_t_1 = __pyx_v_N;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2468
+    /* "pyseobnr/eob/waveform/waveform.pyx":2664
  *     cdef double complex factor
  *     for i in range(N):
  *         factor = cexp(-1*I*phi_orb[i])             # <<<<<<<<<<<<<<
- *         result[0][i]  = factor
- *         for m in range(1,m_max):
+ *         result[0][i] = factor
+ *         for m in range(1, m_max):
  */
     __pyx_t_4 = __pyx_v_i;
     __pyx_v_factor = cexp(__Pyx_c_prod_double(__Pyx_c_prod_double(__pyx_t_double_complex_from_parts(-1L, 0), I), __pyx_t_double_complex_from_parts((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_phi_orb.data) + __pyx_t_4)) ))), 0)));
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2469
+    /* "pyseobnr/eob/waveform/waveform.pyx":2665
  *     for i in range(N):
  *         factor = cexp(-1*I*phi_orb[i])
- *         result[0][i]  = factor             # <<<<<<<<<<<<<<
- *         for m in range(1,m_max):
- *                 result[m][i]=result[m-1][i]*factor
+ *         result[0][i] = factor             # <<<<<<<<<<<<<<
+ *         for m in range(1, m_max):
+ *             result[m][i] = result[m-1][i]*factor
  */
     __pyx_t_4 = 0;
     __pyx_t_5 = __pyx_v_i;
     *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_result.data + __pyx_t_4 * __pyx_v_result.strides[0]) ) + __pyx_t_5 * __pyx_v_result.strides[1]) )) = __pyx_v_factor;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2470
+    /* "pyseobnr/eob/waveform/waveform.pyx":2666
  *         factor = cexp(-1*I*phi_orb[i])
- *         result[0][i]  = factor
- *         for m in range(1,m_max):             # <<<<<<<<<<<<<<
- *                 result[m][i]=result[m-1][i]*factor
+ *         result[0][i] = factor
+ *         for m in range(1, m_max):             # <<<<<<<<<<<<<<
+ *             result[m][i] = result[m-1][i]*factor
  * 
  */
     __pyx_t_6 = __pyx_v_m_max;
     __pyx_t_7 = __pyx_t_6;
     for (__pyx_t_8 = 1; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
       __pyx_v_m = __pyx_t_8;
 
-      /* "pyseobnr/eob/waveform/waveform.pyx":2471
- *         result[0][i]  = factor
- *         for m in range(1,m_max):
- *                 result[m][i]=result[m-1][i]*factor             # <<<<<<<<<<<<<<
+      /* "pyseobnr/eob/waveform/waveform.pyx":2667
+ *         result[0][i] = factor
+ *         for m in range(1, m_max):
+ *             result[m][i] = result[m-1][i]*factor             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_5 = (__pyx_v_m - 1);
       __pyx_t_4 = __pyx_v_i;
       __pyx_t_9 = __pyx_v_m;
       __pyx_t_10 = __pyx_v_i;
       *((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_result.data + __pyx_t_9 * __pyx_v_result.strides[0]) ) + __pyx_t_10 * __pyx_v_result.strides[1]) )) = __Pyx_c_prod_double((*((__pyx_t_double_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_result.data + __pyx_t_5 * __pyx_v_result.strides[0]) ) + __pyx_t_4 * __pyx_v_result.strides[1]) ))), __pyx_v_factor);
     }
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2458
+  /* "pyseobnr/eob/waveform/waveform.pyx":2653
  * @cython.wraparound(False)
  * @cython.cdivision(True)
- * cpdef compute_factors(double[::1] phi_orb,int m_max, double complex[:,:]result):             # <<<<<<<<<<<<<<
+ * cpdef compute_factors(double[::1] phi_orb, int m_max, double complex[:, :] result):             # <<<<<<<<<<<<<<
  *     """
  *     Trivial helper function that computes iterative :math:`e^{im\\phi}`.
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_XGIVEREF(__pyx_r);
@@ -35063,55 +35148,55 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_phi_orb)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2458, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2653, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_m_max)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2458, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2653, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_factors", 1, 3, 3, 1); __PYX_ERR(0, 2458, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_factors", 1, 3, 3, 1); __PYX_ERR(0, 2653, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_result)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2458, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2653, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_factors", 1, 3, 3, 2); __PYX_ERR(0, 2458, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_factors", 1, 3, 3, 2); __PYX_ERR(0, 2653, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_factors") < 0)) __PYX_ERR(0, 2458, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_factors") < 0)) __PYX_ERR(0, 2653, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 3)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
     }
-    __pyx_v_phi_orb = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_phi_orb.memview)) __PYX_ERR(0, 2458, __pyx_L3_error)
-    __pyx_v_m_max = __Pyx_PyInt_As_int(values[1]); if (unlikely((__pyx_v_m_max == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 2458, __pyx_L3_error)
-    __pyx_v_result = __Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_result.memview)) __PYX_ERR(0, 2458, __pyx_L3_error)
+    __pyx_v_phi_orb = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_phi_orb.memview)) __PYX_ERR(0, 2653, __pyx_L3_error)
+    __pyx_v_m_max = __Pyx_PyInt_As_int(values[1]); if (unlikely((__pyx_v_m_max == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 2653, __pyx_L3_error)
+    __pyx_v_result = __Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_double_complex(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_result.memview)) __PYX_ERR(0, 2653, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("compute_factors", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 2458, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("compute_factors", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 2653, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -35143,17 +35228,17 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("compute_factors", 1);
   __Pyx_XDECREF(__pyx_r);
-  if (unlikely(!__pyx_v_phi_orb.memview)) { __Pyx_RaiseUnboundLocalError("phi_orb"); __PYX_ERR(0, 2458, __pyx_L1_error) }
-  if (unlikely(!__pyx_v_result.memview)) { __Pyx_RaiseUnboundLocalError("result"); __PYX_ERR(0, 2458, __pyx_L1_error) }
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_factors(__pyx_v_phi_orb, __pyx_v_m_max, __pyx_v_result, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2458, __pyx_L1_error)
+  if (unlikely(!__pyx_v_phi_orb.memview)) { __Pyx_RaiseUnboundLocalError("phi_orb"); __PYX_ERR(0, 2653, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_result.memview)) { __Pyx_RaiseUnboundLocalError("result"); __PYX_ERR(0, 2653, __pyx_L1_error) }
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_compute_factors(__pyx_v_phi_orb, __pyx_v_m_max, __pyx_v_result, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2653, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -35162,20 +35247,20 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "pyseobnr/eob/waveform/waveform.pyx":2482
+/* "pyseobnr/eob/waveform/waveform.pyx":2677
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef unrotate_leading_pn(double[::1]re_part,double[::1]im_part, double complex[:] factor,double complex[:] result):             # <<<<<<<<<<<<<<
- *     """
- *     Helper function used to multiply the interpolated re and im parts by the leading order PN scaling
+ * cpdef unrotate_leading_pn(             # <<<<<<<<<<<<<<
+ *     double[::1] re_part,
+ *     double[::1] im_part,
  */
 
 static PyObject *__pyx_pw_8pyseobnr_3eob_8waveform_8waveform_27unrotate_leading_pn(PyObject *__pyx_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
@@ -35196,91 +35281,89 @@
   Py_ssize_t __pyx_t_7;
   Py_ssize_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__20)
   __Pyx_RefNannySetupContext("unrotate_leading_pn", 1);
-  __Pyx_TraceCall("unrotate_leading_pn", __pyx_f[0], 2482, 0, __PYX_ERR(0, 2482, __pyx_L1_error));
+  __Pyx_TraceCall("unrotate_leading_pn", __pyx_f[0], 2677, 0, __PYX_ERR(0, 2677, __pyx_L1_error));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2486
- *     Helper function used to multiply the interpolated re and im parts by the leading order PN scaling
+  /* "pyseobnr/eob/waveform/waveform.pyx":2687
  *     """
+ * 
  *     cdef int N = re_part.shape[0]             # <<<<<<<<<<<<<<
  *     cdef int i
- *     #print(re_part.shape[0],im_part.shape[0],phi.shape[0],result.shape[0])
+ *     # print(re_part.shape[0],im_part.shape[0],phi.shape[0],result.shape[0])
  */
-  __Pyx_TraceLine(2486,0,__PYX_ERR(0, 2486, __pyx_L1_error))
+  __Pyx_TraceLine(2687,0,__PYX_ERR(0, 2687, __pyx_L1_error))
   __pyx_v_N = (__pyx_v_re_part.shape[0]);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2489
+  /* "pyseobnr/eob/waveform/waveform.pyx":2690
  *     cdef int i
- *     #print(re_part.shape[0],im_part.shape[0],phi.shape[0],result.shape[0])
+ *     # print(re_part.shape[0],im_part.shape[0],phi.shape[0],result.shape[0])
  *     for i in range(N):             # <<<<<<<<<<<<<<
  *         result[i] = (re_part[i]+I*im_part[i])*factor[i]
- * 
  */
-  __Pyx_TraceLine(2489,0,__PYX_ERR(0, 2489, __pyx_L1_error))
+  __Pyx_TraceLine(2690,0,__PYX_ERR(0, 2690, __pyx_L1_error))
   __pyx_t_1 = __pyx_v_N;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "pyseobnr/eob/waveform/waveform.pyx":2490
- *     #print(re_part.shape[0],im_part.shape[0],phi.shape[0],result.shape[0])
+    /* "pyseobnr/eob/waveform/waveform.pyx":2691
+ *     # print(re_part.shape[0],im_part.shape[0],phi.shape[0],result.shape[0])
  *     for i in range(N):
  *         result[i] = (re_part[i]+I*im_part[i])*factor[i]             # <<<<<<<<<<<<<<
- * 
  */
-    __Pyx_TraceLine(2490,0,__PYX_ERR(0, 2490, __pyx_L1_error))
+    __Pyx_TraceLine(2691,0,__PYX_ERR(0, 2691, __pyx_L1_error))
     __pyx_t_4 = __pyx_v_i;
     __pyx_t_5 = -1;
     if (__pyx_t_4 < 0) {
       __pyx_t_5 = 0;
     } else if (unlikely(__pyx_t_4 >= __pyx_v_re_part.shape[0])) __pyx_t_5 = 0;
     if (unlikely(__pyx_t_5 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_5);
-      __PYX_ERR(0, 2490, __pyx_L1_error)
+      __PYX_ERR(0, 2691, __pyx_L1_error)
     }
     __pyx_t_6 = __pyx_v_i;
     __pyx_t_5 = -1;
     if (__pyx_t_6 < 0) {
       __pyx_t_5 = 0;
     } else if (unlikely(__pyx_t_6 >= __pyx_v_im_part.shape[0])) __pyx_t_5 = 0;
     if (unlikely(__pyx_t_5 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_5);
-      __PYX_ERR(0, 2490, __pyx_L1_error)
+      __PYX_ERR(0, 2691, __pyx_L1_error)
     }
     __pyx_t_7 = __pyx_v_i;
     __pyx_t_5 = -1;
     if (__pyx_t_7 < 0) {
       __pyx_t_5 = 0;
     } else if (unlikely(__pyx_t_7 >= __pyx_v_factor.shape[0])) __pyx_t_5 = 0;
     if (unlikely(__pyx_t_5 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_5);
-      __PYX_ERR(0, 2490, __pyx_L1_error)
+      __PYX_ERR(0, 2691, __pyx_L1_error)
     }
     __pyx_t_8 = __pyx_v_i;
     __pyx_t_5 = -1;
     if (__pyx_t_8 < 0) {
       __pyx_t_5 = 0;
     } else if (unlikely(__pyx_t_8 >= __pyx_v_result.shape[0])) __pyx_t_5 = 0;
     if (unlikely(__pyx_t_5 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_5);
-      __PYX_ERR(0, 2490, __pyx_L1_error)
+      __PYX_ERR(0, 2691, __pyx_L1_error)
     }
     *((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_result.data + __pyx_t_8 * __pyx_v_result.strides[0]) )) = __Pyx_c_prod_double(__Pyx_c_sum_double(__pyx_t_double_complex_from_parts((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_re_part.data) + __pyx_t_4)) ))), 0), __Pyx_c_prod_double(I, __pyx_t_double_complex_from_parts((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_im_part.data) + __pyx_t_6)) ))), 0))), (*((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_factor.data + __pyx_t_7 * __pyx_v_factor.strides[0]) ))));
   }
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2482
+  /* "pyseobnr/eob/waveform/waveform.pyx":2677
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef unrotate_leading_pn(double[::1]re_part,double[::1]im_part, double complex[:] factor,double complex[:] result):             # <<<<<<<<<<<<<<
- *     """
- *     Helper function used to multiply the interpolated re and im parts by the leading order PN scaling
+ * cpdef unrotate_leading_pn(             # <<<<<<<<<<<<<<
+ *     double[::1] re_part,
+ *     double[::1] im_part,
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("pyseobnr.eob.waveform.waveform.unrotate_leading_pn", __pyx_clineno, __pyx_lineno, __pyx_filename);
@@ -35351,67 +35434,67 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_re_part)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2482, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2677, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_im_part)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2482, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2677, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("unrotate_leading_pn", 1, 4, 4, 1); __PYX_ERR(0, 2482, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("unrotate_leading_pn", 1, 4, 4, 1); __PYX_ERR(0, 2677, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_factor)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2482, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2677, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("unrotate_leading_pn", 1, 4, 4, 2); __PYX_ERR(0, 2482, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("unrotate_leading_pn", 1, 4, 4, 2); __PYX_ERR(0, 2677, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_result)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2482, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 2677, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("unrotate_leading_pn", 1, 4, 4, 3); __PYX_ERR(0, 2482, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("unrotate_leading_pn", 1, 4, 4, 3); __PYX_ERR(0, 2677, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "unrotate_leading_pn") < 0)) __PYX_ERR(0, 2482, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "unrotate_leading_pn") < 0)) __PYX_ERR(0, 2677, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 4)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
       values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
       values[3] = __Pyx_Arg_FASTCALL(__pyx_args, 3);
     }
-    __pyx_v_re_part = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_re_part.memview)) __PYX_ERR(0, 2482, __pyx_L3_error)
-    __pyx_v_im_part = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_im_part.memview)) __PYX_ERR(0, 2482, __pyx_L3_error)
-    __pyx_v_factor = __Pyx_PyObject_to_MemoryviewSlice_ds___pyx_t_double_complex(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_factor.memview)) __PYX_ERR(0, 2482, __pyx_L3_error)
-    __pyx_v_result = __Pyx_PyObject_to_MemoryviewSlice_ds___pyx_t_double_complex(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_result.memview)) __PYX_ERR(0, 2482, __pyx_L3_error)
+    __pyx_v_re_part = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_re_part.memview)) __PYX_ERR(0, 2678, __pyx_L3_error)
+    __pyx_v_im_part = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_im_part.memview)) __PYX_ERR(0, 2679, __pyx_L3_error)
+    __pyx_v_factor = __Pyx_PyObject_to_MemoryviewSlice_ds___pyx_t_double_complex(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_factor.memview)) __PYX_ERR(0, 2680, __pyx_L3_error)
+    __pyx_v_result = __Pyx_PyObject_to_MemoryviewSlice_ds___pyx_t_double_complex(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_result.memview)) __PYX_ERR(0, 2681, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("unrotate_leading_pn", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 2482, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("unrotate_leading_pn", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 2677, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -35448,17 +35531,17 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__20)
   __Pyx_RefNannySetupContext("unrotate_leading_pn", 1);
-  __Pyx_TraceCall("unrotate_leading_pn (wrapper)", __pyx_f[0], 2482, 0, __PYX_ERR(0, 2482, __pyx_L1_error));
+  __Pyx_TraceCall("unrotate_leading_pn (wrapper)", __pyx_f[0], 2677, 0, __PYX_ERR(0, 2677, __pyx_L1_error));
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_unrotate_leading_pn(__pyx_v_re_part, __pyx_v_im_part, __pyx_v_factor, __pyx_v_result, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2482, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8pyseobnr_3eob_8waveform_8waveform_unrotate_leading_pn(__pyx_v_re_part, __pyx_v_im_part, __pyx_v_factor, __pyx_v_result, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2677, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -36909,15 +36992,15 @@
     {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
     {0, 0, 0, 0, 0, 0, 0}
   };
   return __Pyx_InitStrings(__pyx_string_tab);
 }
 /* #### Code section: cached_builtins ### */
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 232, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 239, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_builtin___import__ = __Pyx_GetBuiltinName(__pyx_n_s_import); if (!__pyx_builtin___import__) __PYX_ERR(1, 100, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(1, 141, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 156, __pyx_L1_error)
   __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(1, 159, __pyx_L1_error)
   __pyx_builtin_AssertionError = __Pyx_GetBuiltinName(__pyx_n_s_AssertionError); if (!__pyx_builtin_AssertionError) __PYX_ERR(1, 373, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(1, 408, __pyx_L1_error)
@@ -36966,44 +37049,44 @@
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError, "Incompatible checksums (0x%x vs (0x82a3537, 0x6ae9995, 0xb068931) = (name))" % __pyx_checksum
  */
   __pyx_tuple__8 = PyTuple_Pack(3, __pyx_int_136983863, __pyx_int_112105877, __pyx_int_184977713); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":984
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(2, 984, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__9);
   __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-l6w1nv0e/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
+  /* "../../../../private/var/folders/gy/4fqcxthx7jlgdblgz0p1ty1m0000gp/T/build-env-bfi0tt5q/lib/python3.11/site-packages/numpy/__init__.cython-30.pxd":990
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__10 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(2, 990, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__10);
   __Pyx_GIVEREF(__pyx_tuple__10);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2431
- * 
- *         amp =  amp_fits[(l, m)]
- *         amp22 = amp_fits[(2,2)]             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":2629
+ *         # Step 4: compute |h_{lm}^{NR}| from fit
+ *         amp = amp_fits[(l, m)]
+ *         amp22 = amp_fits[(2, 2)]             # <<<<<<<<<<<<<<
  * 
  *         # when the amplitude at merger is too small a positive sign is better
  */
-  __pyx_tuple__19 = PyTuple_Pack(2, __pyx_int_2, __pyx_int_2); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 2431, __pyx_L1_error)
+  __pyx_tuple__19 = PyTuple_Pack(2, __pyx_int_2, __pyx_int_2); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 2629, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__19);
   __Pyx_GIVEREF(__pyx_tuple__19);
 
   /* "View.MemoryView":100
  * cdef object __pyx_collections_abc_Sequence "__pyx_collections_abc_Sequence"
  * try:
  *     if __import__("sys").version_info >= (3, 3):             # <<<<<<<<<<<<<<
@@ -37100,145 +37183,145 @@
  *     cdef object __pyx_result
  */
   __pyx_tuple__30 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__30);
   __Pyx_GIVEREF(__pyx_tuple__30);
   __pyx_codeobj__31 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__30, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__31)) __PYX_ERR(1, 1, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":140
+  /* "pyseobnr/eob/waveform/waveform.pyx":144
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double complex calculate_multipole_prefix(double m1, double m2, int l, int m):             # <<<<<<<<<<<<<<
  *     """
  *     Calculates the Newtonian multipole prefactors, see Eq. 25-27 in
  */
-  __pyx_tuple__32 = PyTuple_Pack(4, __pyx_n_s_m1, __pyx_n_s_m2, __pyx_n_s_l, __pyx_n_s_m); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 140, __pyx_L1_error)
+  __pyx_tuple__32 = PyTuple_Pack(4, __pyx_n_s_m1, __pyx_n_s_m2, __pyx_n_s_l, __pyx_n_s_m); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 144, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__32);
   __Pyx_GIVEREF(__pyx_tuple__32);
-  __pyx_codeobj__11 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__32, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_calculate_multipole_prefix, 140, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 140, __pyx_L1_error)
+  __pyx_codeobj__11 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__32, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_calculate_multipole_prefix, 144, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 144, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":225
+  /* "pyseobnr/eob/waveform/waveform.pyx":232
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * cpdef compute_newtonian_prefixes(double m1, double m2):             # <<<<<<<<<<<<<<
  *     """
  *     Loop to set the Newtonian multipole prefactors.
  */
-  __pyx_tuple__33 = PyTuple_Pack(2, __pyx_n_s_m1, __pyx_n_s_m2); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __pyx_tuple__33 = PyTuple_Pack(2, __pyx_n_s_m1, __pyx_n_s_m2); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 232, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__33);
   __Pyx_GIVEREF(__pyx_tuple__33);
-  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_newtonian_prefixes, 225, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_newtonian_prefixes, 232, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 232, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":245
+  /* "pyseobnr/eob/waveform/waveform.pyx":253
  * @cython.wraparound(False)
  * @cython.cdivision(True)
- * cpdef double evaluate_nqc_correction_flux(double r, double pr,  double omega, double[:] coeffs):             # <<<<<<<<<<<<<<
- *     """
- *     Calculate the NQC amplitude correction.
+ * cpdef double evaluate_nqc_correction_flux(             # <<<<<<<<<<<<<<
+ *     double r,
+ *     double pr,
  */
-  __pyx_tuple__35 = PyTuple_Pack(4, __pyx_n_s_r, __pyx_n_s_pr, __pyx_n_s_omega, __pyx_n_s_coeffs); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 245, __pyx_L1_error)
+  __pyx_tuple__35 = PyTuple_Pack(4, __pyx_n_s_r, __pyx_n_s_pr, __pyx_n_s_omega, __pyx_n_s_coeffs); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 253, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__35);
   __Pyx_GIVEREF(__pyx_tuple__35);
-  __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_evaluate_nqc_correction_flux, 245, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 245, __pyx_L1_error)
+  __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_evaluate_nqc_correction_flux, 253, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 253, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":266
+  /* "pyseobnr/eob/waveform/waveform.pyx":280
  * @cython.wraparound(False)
  * @cython.cdivision(True)
- * cpdef compute_tail(double omega, double H, double[:,:] Tlm):             # <<<<<<<<<<<<<<
- *     """
- *     Calculate the resummed Tail effects.
+ * cpdef compute_tail(             # <<<<<<<<<<<<<<
+ *     double omega,
+ *     double H,
  */
-  __pyx_tuple__37 = PyTuple_Pack(3, __pyx_n_s_omega, __pyx_n_s_H, __pyx_n_s_Tlm); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 266, __pyx_L1_error)
+  __pyx_tuple__37 = PyTuple_Pack(3, __pyx_n_s_omega, __pyx_n_s_H, __pyx_n_s_Tlm); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 280, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__37);
   __Pyx_GIVEREF(__pyx_tuple__37);
-  __pyx_codeobj__38 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__37, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_tail, 266, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__38)) __PYX_ERR(0, 266, __pyx_L1_error)
+  __pyx_codeobj__38 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__37, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_tail, 280, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__38)) __PYX_ERR(0, 280, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":304
+  /* "pyseobnr/eob/waveform/waveform.pyx":321
  * @cython.nonecheck(False)
  * @cython.initializedcheck(False)
- * cpdef void compute_rho_coeffs(double nu,double dm, double a,double chiS,double chiA,             # <<<<<<<<<<<<<<
- *     double[:,:,:] rho_coeffs,double[:,:,:] rho_coeffs_log, double[:,:,:] f_coeffs,
- *     double complex[:,:,:] f_coeffs_vh, bint extra_PN_terms):
+ * cpdef void compute_rho_coeffs(             # <<<<<<<<<<<<<<
+ *     double nu,
+ *     double dm,
  */
-  __pyx_tuple__39 = PyTuple_Pack(10, __pyx_n_s_nu, __pyx_n_s_dm, __pyx_n_s_a, __pyx_n_s_chiS, __pyx_n_s_chiA, __pyx_n_s_rho_coeffs, __pyx_n_s_rho_coeffs_log, __pyx_n_s_f_coeffs, __pyx_n_s_f_coeffs_vh, __pyx_n_s_extra_PN_terms); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 304, __pyx_L1_error)
+  __pyx_tuple__39 = PyTuple_Pack(10, __pyx_n_s_nu, __pyx_n_s_dm, __pyx_n_s_a, __pyx_n_s_chiS, __pyx_n_s_chiA, __pyx_n_s_rho_coeffs, __pyx_n_s_rho_coeffs_log, __pyx_n_s_f_coeffs, __pyx_n_s_f_coeffs_vh, __pyx_n_s_extra_PN_terms); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 321, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__39);
   __Pyx_GIVEREF(__pyx_tuple__39);
-  __pyx_codeobj__40 = (PyObject*)__Pyx_PyCode_New(10, 0, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__39, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_rho_coeffs, 304, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 304, __pyx_L1_error)
+  __pyx_codeobj__40 = (PyObject*)__Pyx_PyCode_New(10, 0, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__39, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_rho_coeffs, 321, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 321, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1259
+  /* "pyseobnr/eob/waveform/waveform.pyx":1311
  * @cython.nonecheck(False)
  * @cython.initializedcheck(False)
- * cpdef double complex compute_extra_flm_terms(int l,int m,double vh,EOBParams eob_pars):             # <<<<<<<<<<<<<<
+ * cpdef double complex compute_extra_flm_terms(int l, int m, double vh, EOBParams eob_pars):             # <<<<<<<<<<<<<<
  *     """
  *     Compute the complex term in :math:`f_{33}`.
  */
-  __pyx_tuple__41 = PyTuple_Pack(4, __pyx_n_s_l, __pyx_n_s_m, __pyx_n_s_vh, __pyx_n_s_eob_pars); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 1259, __pyx_L1_error)
+  __pyx_tuple__41 = PyTuple_Pack(4, __pyx_n_s_l, __pyx_n_s_m, __pyx_n_s_vh, __pyx_n_s_eob_pars); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 1311, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__41);
   __Pyx_GIVEREF(__pyx_tuple__41);
-  __pyx_codeobj__42 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_extra_flm_terms, 1259, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__42)) __PYX_ERR(0, 1259, __pyx_L1_error)
+  __pyx_codeobj__42 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_extra_flm_terms, 1311, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__42)) __PYX_ERR(0, 1311, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1369
+  /* "pyseobnr/eob/waveform/waveform.pyx":1440
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double  EOBFluxCalculateNewtonianMultipoleAbs(             # <<<<<<<<<<<<<<
- *     double x, double phi, int l, int m, double [:,:] params
- * ):
+ *     double x,
+ *     double phi,
  */
-  __pyx_tuple__43 = PyTuple_Pack(5, __pyx_n_s_x, __pyx_n_s_phi, __pyx_n_s_l, __pyx_n_s_m, __pyx_n_s_params); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 1369, __pyx_L1_error)
+  __pyx_tuple__43 = PyTuple_Pack(5, __pyx_n_s_x, __pyx_n_s_phi, __pyx_n_s_l, __pyx_n_s_m, __pyx_n_s_params); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 1440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__43);
   __Pyx_GIVEREF(__pyx_tuple__43);
-  __pyx_codeobj__12 = (PyObject*)__Pyx_PyCode_New(5, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__43, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_EOBFluxCalculateNewtonianMultipo, 1369, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__12)) __PYX_ERR(0, 1369, __pyx_L1_error)
+  __pyx_codeobj__12 = (PyObject*)__Pyx_PyCode_New(5, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__43, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_EOBFluxCalculateNewtonianMultipo, 1440, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__12)) __PYX_ERR(0, 1440, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1411
+  /* "pyseobnr/eob/waveform/waveform.pyx":1486
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef double compute_flux(double r,double phi,double pr,double pphi,double omega,double omega_circ,double H,EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     """
- *     Compute the full flux.
+ * cpdef double compute_flux(             # <<<<<<<<<<<<<<
+ *     double r,
+ *     double phi,
  */
-  __pyx_tuple__44 = PyTuple_Pack(8, __pyx_n_s_r, __pyx_n_s_phi, __pyx_n_s_pr, __pyx_n_s_pphi, __pyx_n_s_omega, __pyx_n_s_omega_circ, __pyx_n_s_H, __pyx_n_s_eob_pars); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 1411, __pyx_L1_error)
+  __pyx_tuple__44 = PyTuple_Pack(8, __pyx_n_s_r, __pyx_n_s_phi, __pyx_n_s_pr, __pyx_n_s_pphi, __pyx_n_s_omega, __pyx_n_s_omega_circ, __pyx_n_s_H, __pyx_n_s_eob_pars); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 1486, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__44);
   __Pyx_GIVEREF(__pyx_tuple__44);
-  __pyx_codeobj__13 = (PyObject*)__Pyx_PyCode_New(8, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__44, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_flux, 1411, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__13)) __PYX_ERR(0, 1411, __pyx_L1_error)
+  __pyx_codeobj__13 = (PyObject*)__Pyx_PyCode_New(8, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__44, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_flux, 1486, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__13)) __PYX_ERR(0, 1486, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1484
+  /* "pyseobnr/eob/waveform/waveform.pyx":1576
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double compute_refactorized_flux(             # <<<<<<<<<<<<<<
  *     double chi_1,
  *     double chi_2,
  */
-  __pyx_tuple__45 = PyTuple_Pack(11, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_x, __pyx_n_s_x_phi, __pyx_n_s_nu, __pyx_n_s_H, __pyx_n_s_beaming, __pyx_n_s_alpha_N, __pyx_n_s_beta_PN_N, __pyx_n_s_beta_TP_N, __pyx_n_s_quasi_circ); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 1484, __pyx_L1_error)
+  __pyx_tuple__45 = PyTuple_Pack(11, __pyx_n_s_chi_1, __pyx_n_s_chi_2, __pyx_n_s_x, __pyx_n_s_x_phi, __pyx_n_s_nu, __pyx_n_s_H, __pyx_n_s_beaming, __pyx_n_s_alpha_N, __pyx_n_s_beta_PN_N, __pyx_n_s_beta_TP_N, __pyx_n_s_quasi_circ); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 1576, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__45);
   __Pyx_GIVEREF(__pyx_tuple__45);
-  __pyx_codeobj__14 = (PyObject*)__Pyx_PyCode_New(11, 0, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__45, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_refactorized_flux, 1484, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(0, 1484, __pyx_L1_error)
+  __pyx_codeobj__14 = (PyObject*)__Pyx_PyCode_New(11, 0, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__45, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_refactorized_flux, 1576, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(0, 1576, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2110
+  /* "pyseobnr/eob/waveform/waveform.pyx":2224
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef (double,double) RR_force(double[::1] q, double[::1] p, double omega, double omega_circ,             # <<<<<<<<<<<<<<
- *     double H, EOBParams eob_pars):
- *     """
+ * cpdef (double, double) RR_force(             # <<<<<<<<<<<<<<
+ *     double[::1] q,
+ *     double[::1] p,
  */
-  __pyx_tuple__46 = PyTuple_Pack(6, __pyx_n_s_q, __pyx_n_s_p, __pyx_n_s_omega, __pyx_n_s_omega_circ, __pyx_n_s_H, __pyx_n_s_eob_pars); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 2110, __pyx_L1_error)
+  __pyx_tuple__46 = PyTuple_Pack(6, __pyx_n_s_q, __pyx_n_s_p, __pyx_n_s_omega, __pyx_n_s_omega_circ, __pyx_n_s_H, __pyx_n_s_eob_pars); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 2224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__46);
   __Pyx_GIVEREF(__pyx_tuple__46);
-  __pyx_codeobj__15 = (PyObject*)__Pyx_PyCode_New(6, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__46, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_RR_force, 2110, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__15)) __PYX_ERR(0, 2110, __pyx_L1_error)
+  __pyx_codeobj__15 = (PyObject*)__Pyx_PyCode_New(6, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__46, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_RR_force, 2224, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__15)) __PYX_ERR(0, 2224, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2136
- *     def __cinit__(self):
- *         pass
- *     cpdef (double,double) RR(self, double[::1] q, double[::1] p, double omega,             # <<<<<<<<<<<<<<
- *         double omega_circ, double H, EOBParams eob_pars):
+  /* "pyseobnr/eob/waveform/waveform.pyx":2256
  *         pass
+ * 
+ *     cpdef (double, double) RR(             # <<<<<<<<<<<<<<
+ *         self,
+ *         double[::1] q,
  */
-  __pyx_tuple__47 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_q, __pyx_n_s_p, __pyx_n_s_omega, __pyx_n_s_omega_circ, __pyx_n_s_H, __pyx_n_s_eob_pars); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 2136, __pyx_L1_error)
+  __pyx_tuple__47 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_q, __pyx_n_s_p, __pyx_n_s_omega, __pyx_n_s_omega_circ, __pyx_n_s_H, __pyx_n_s_eob_pars); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 2256, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__47);
   __Pyx_GIVEREF(__pyx_tuple__47);
-  __pyx_codeobj__48 = (PyObject*)__Pyx_PyCode_New(7, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__47, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_RR, 2136, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__48)) __PYX_ERR(0, 2136, __pyx_L1_error)
+  __pyx_codeobj__48 = (PyObject*)__Pyx_PyCode_New(7, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__47, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_RR, 2256, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__48)) __PYX_ERR(0, 2256, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
  * def __setstate_cython__(self, __pyx_state):
  */
   __pyx_tuple__49 = PyTuple_Pack(1, __pyx_n_s_self); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(1, 1, __pyx_L1_error)
@@ -37253,22 +37336,22 @@
  *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
  */
   __pyx_tuple__51 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_pyx_state); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(1, 3, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__51);
   __Pyx_GIVEREF(__pyx_tuple__51);
   __pyx_codeobj__52 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__51, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_setstate_cython, 3, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__52)) __PYX_ERR(1, 3, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2148
+  /* "pyseobnr/eob/waveform/waveform.pyx":2276
  *         pass
  * 
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,             # <<<<<<<<<<<<<<
- *         double omega_circ, double H, EOBParams eob_pars):
- *         return RR_force(q, p, omega, omega_circ, H, eob_pars)
+ *     cpdef (double, double) RR(             # <<<<<<<<<<<<<<
+ *         self,
+ *         double[::1] q,
  */
-  __pyx_codeobj__53 = (PyObject*)__Pyx_PyCode_New(7, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__47, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_RR, 2148, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__53)) __PYX_ERR(0, 2148, __pyx_L1_error)
+  __pyx_codeobj__53 = (PyObject*)__Pyx_PyCode_New(7, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__47, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_RR, 2276, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__53)) __PYX_ERR(0, 2276, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
  * def __setstate_cython__(self, __pyx_state):
  */
   __pyx_codeobj__54 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__49, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_reduce_cython, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__54)) __PYX_ERR(1, 1, __pyx_L1_error)
@@ -37277,78 +37360,78 @@
  * def __reduce_cython__(self):
  *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
  * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
  *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
  */
   __pyx_codeobj__55 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__51, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_setstate_cython, 3, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__55)) __PYX_ERR(1, 3, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2237
+  /* "pyseobnr/eob/waveform/waveform.pyx":2384
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef compute_hlms(double[:,:] dynamics, EOBParams eob_pars):             # <<<<<<<<<<<<<<
+ * cpdef compute_hlms(double[:, :] dynamics, EOBParams eob_pars):             # <<<<<<<<<<<<<<
  *     """
  *     Compute the inspiral modes for aligned *or* precessing binaries.
  */
-  __pyx_tuple__56 = PyTuple_Pack(2, __pyx_n_s_dynamics, __pyx_n_s_eob_pars); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(0, 2237, __pyx_L1_error)
+  __pyx_tuple__56 = PyTuple_Pack(2, __pyx_n_s_dynamics, __pyx_n_s_eob_pars); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(0, 2384, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__56);
   __Pyx_GIVEREF(__pyx_tuple__56);
-  __pyx_codeobj__16 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__56, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_hlms, 2237, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(0, 2237, __pyx_L1_error)
+  __pyx_codeobj__16 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__56, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_hlms, 2384, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(0, 2384, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2354
- * @cython.linetrace(True)
- * cpdef compute_special_coeffs(double[:,:] dynamics, double t_attach, EOBParams eob_pars,
- *     dict amp_fits, dict amp_thresholds, dict modes={(2,1):7,(4,3):7,(5,5):5}):             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":2538
+ *     dict amp_fits,
+ *     dict amp_thresholds,
+ *     dict modes={(2, 1): 7, (4, 3): 7, (5, 5): 5}             # <<<<<<<<<<<<<<
+ * ):
  *     """
- *     Compute the "special" amplitude coefficients.
  */
-  __pyx_tuple__57 = PyTuple_Pack(2, __pyx_int_2, __pyx_int_1); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 2354, __pyx_L1_error)
+  __pyx_tuple__57 = PyTuple_Pack(2, __pyx_int_2, __pyx_int_1); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 2538, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__57);
   __Pyx_GIVEREF(__pyx_tuple__57);
-  __pyx_tuple__58 = PyTuple_Pack(2, __pyx_int_4, __pyx_int_3); if (unlikely(!__pyx_tuple__58)) __PYX_ERR(0, 2354, __pyx_L1_error)
+  __pyx_tuple__58 = PyTuple_Pack(2, __pyx_int_4, __pyx_int_3); if (unlikely(!__pyx_tuple__58)) __PYX_ERR(0, 2538, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__58);
   __Pyx_GIVEREF(__pyx_tuple__58);
-  __pyx_tuple__59 = PyTuple_Pack(2, __pyx_int_5, __pyx_int_5); if (unlikely(!__pyx_tuple__59)) __PYX_ERR(0, 2354, __pyx_L1_error)
+  __pyx_tuple__59 = PyTuple_Pack(2, __pyx_int_5, __pyx_int_5); if (unlikely(!__pyx_tuple__59)) __PYX_ERR(0, 2538, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__59);
   __Pyx_GIVEREF(__pyx_tuple__59);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2353
+  /* "pyseobnr/eob/waveform/waveform.pyx":2532
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef compute_special_coeffs(double[:,:] dynamics, double t_attach, EOBParams eob_pars,             # <<<<<<<<<<<<<<
- *     dict amp_fits, dict amp_thresholds, dict modes={(2,1):7,(4,3):7,(5,5):5}):
- *     """
+ * cpdef compute_special_coeffs(             # <<<<<<<<<<<<<<
+ *     double[:, :] dynamics,
+ *     double t_attach,
  */
-  __pyx_tuple__60 = PyTuple_Pack(6, __pyx_n_s_dynamics, __pyx_n_s_t_attach, __pyx_n_s_eob_pars, __pyx_n_s_amp_fits, __pyx_n_s_amp_thresholds, __pyx_n_s_modes); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 2353, __pyx_L1_error)
+  __pyx_tuple__60 = PyTuple_Pack(6, __pyx_n_s_dynamics, __pyx_n_s_t_attach, __pyx_n_s_eob_pars, __pyx_n_s_amp_fits, __pyx_n_s_amp_thresholds, __pyx_n_s_modes); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 2532, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__60);
   __Pyx_GIVEREF(__pyx_tuple__60);
-  __pyx_codeobj__18 = (PyObject*)__Pyx_PyCode_New(6, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__60, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_special_coeffs, 2353, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__18)) __PYX_ERR(0, 2353, __pyx_L1_error)
+  __pyx_codeobj__18 = (PyObject*)__Pyx_PyCode_New(6, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__60, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_special_coeffs, 2532, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__18)) __PYX_ERR(0, 2532, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2458
+  /* "pyseobnr/eob/waveform/waveform.pyx":2653
  * @cython.wraparound(False)
  * @cython.cdivision(True)
- * cpdef compute_factors(double[::1] phi_orb,int m_max, double complex[:,:]result):             # <<<<<<<<<<<<<<
+ * cpdef compute_factors(double[::1] phi_orb, int m_max, double complex[:, :] result):             # <<<<<<<<<<<<<<
  *     """
  *     Trivial helper function that computes iterative :math:`e^{im\\phi}`.
  */
-  __pyx_tuple__61 = PyTuple_Pack(3, __pyx_n_s_phi_orb, __pyx_n_s_m_max, __pyx_n_s_result); if (unlikely(!__pyx_tuple__61)) __PYX_ERR(0, 2458, __pyx_L1_error)
+  __pyx_tuple__61 = PyTuple_Pack(3, __pyx_n_s_phi_orb, __pyx_n_s_m_max, __pyx_n_s_result); if (unlikely(!__pyx_tuple__61)) __PYX_ERR(0, 2653, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__61);
   __Pyx_GIVEREF(__pyx_tuple__61);
-  __pyx_codeobj__62 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__61, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_factors, 2458, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__62)) __PYX_ERR(0, 2458, __pyx_L1_error)
+  __pyx_codeobj__62 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__61, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_compute_factors, 2653, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__62)) __PYX_ERR(0, 2653, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2482
+  /* "pyseobnr/eob/waveform/waveform.pyx":2677
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef unrotate_leading_pn(double[::1]re_part,double[::1]im_part, double complex[:] factor,double complex[:] result):             # <<<<<<<<<<<<<<
- *     """
- *     Helper function used to multiply the interpolated re and im parts by the leading order PN scaling
+ * cpdef unrotate_leading_pn(             # <<<<<<<<<<<<<<
+ *     double[::1] re_part,
+ *     double[::1] im_part,
  */
-  __pyx_tuple__63 = PyTuple_Pack(4, __pyx_n_s_re_part, __pyx_n_s_im_part, __pyx_n_s_factor, __pyx_n_s_result); if (unlikely(!__pyx_tuple__63)) __PYX_ERR(0, 2482, __pyx_L1_error)
+  __pyx_tuple__63 = PyTuple_Pack(4, __pyx_n_s_re_part, __pyx_n_s_im_part, __pyx_n_s_factor, __pyx_n_s_result); if (unlikely(!__pyx_tuple__63)) __PYX_ERR(0, 2677, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__63);
   __Pyx_GIVEREF(__pyx_tuple__63);
-  __pyx_codeobj__20 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__63, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_unrotate_leading_pn, 2482, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__20)) __PYX_ERR(0, 2482, __pyx_L1_error)
+  __pyx_codeobj__20 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__63, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyseobnr_eob_waveform_waveform_p, __pyx_n_s_unrotate_leading_pn, 2677, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__20)) __PYX_ERR(0, 2677, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 /* #### Code section: init_constants ### */
@@ -37457,74 +37540,74 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
   __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = &__pyx_vtable_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
   __pyx_vtable_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce.RR = (__pyx_ctuple_double__and_double (*)(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_8waveform_8waveform_22RadiationReactionForce_RR;
   #if CYTHON_USE_TYPE_SPECS
-  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce_spec, NULL); if (unlikely(!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(0, 2130, __pyx_L1_error)
-  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce_spec, __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) < 0) __PYX_ERR(0, 2130, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce_spec, NULL); if (unlikely(!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce)) __PYX_ERR(0, 2249, __pyx_L1_error)
+  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce_spec, __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) < 0) __PYX_ERR(0, 2249, __pyx_L1_error)
   #else
   __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce = &__pyx_type_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   #endif
   #if !CYTHON_USE_TYPE_SPECS
-  if (__Pyx_PyType_Ready(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) < 0) __PYX_ERR(0, 2130, __pyx_L1_error)
+  if (__Pyx_PyType_Ready(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) < 0) __PYX_ERR(0, 2249, __pyx_L1_error)
   #endif
   #if PY_MAJOR_VERSION < 3
   __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce->tp_print = 0;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce->tp_dictoffset && __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce->tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
   #endif
-  if (__Pyx_SetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce, __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) < 0) __PYX_ERR(0, 2130, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce, __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) < 0) __PYX_ERR(0, 2249, __pyx_L1_error)
   #if !CYTHON_COMPILING_IN_LIMITED_API
-  if (__Pyx_MergeVtables(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) < 0) __PYX_ERR(0, 2130, __pyx_L1_error)
+  if (__Pyx_MergeVtables(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) < 0) __PYX_ERR(0, 2249, __pyx_L1_error)
   #endif
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_RadiationReactionForce, (PyObject *) __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) < 0) __PYX_ERR(0, 2130, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_RadiationReactionForce, (PyObject *) __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) < 0) __PYX_ERR(0, 2249, __pyx_L1_error)
   #if !CYTHON_COMPILING_IN_LIMITED_API
-  if (__Pyx_setup_reduce((PyObject *) __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) < 0) __PYX_ERR(0, 2130, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject *) __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce) < 0) __PYX_ERR(0, 2249, __pyx_L1_error)
   #endif
   __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = &__pyx_vtable_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce;
   __pyx_vtable_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce.__pyx_base = *__pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
   __pyx_vtable_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce.__pyx_base.RR = (__pyx_ctuple_double__and_double (*)(struct __pyx_obj_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, double, struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams *, int __pyx_skip_dispatch))__pyx_f_8pyseobnr_3eob_8waveform_8waveform_15SEOBNRv5RRForce_RR;
   #if CYTHON_USE_TYPE_SPECS
-  __pyx_t_1 = PyTuple_Pack(1, (PyObject *)__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2141, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_Pack(1, (PyObject *)__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2268, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce_spec, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(0, 2141, __pyx_L1_error)
-  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce_spec, __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) < 0) __PYX_ERR(0, 2141, __pyx_L1_error)
+  if (unlikely(!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce)) __PYX_ERR(0, 2268, __pyx_L1_error)
+  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce_spec, __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) < 0) __PYX_ERR(0, 2268, __pyx_L1_error)
   #else
   __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce = &__pyx_type_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce->tp_base = __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce;
   #endif
   #if !CYTHON_USE_TYPE_SPECS
-  if (__Pyx_PyType_Ready(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) < 0) __PYX_ERR(0, 2141, __pyx_L1_error)
+  if (__Pyx_PyType_Ready(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) < 0) __PYX_ERR(0, 2268, __pyx_L1_error)
   #endif
   #if PY_MAJOR_VERSION < 3
   __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce->tp_print = 0;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce->tp_dictoffset && __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce->tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
   #endif
-  if (__Pyx_SetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce, __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) < 0) __PYX_ERR(0, 2141, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce, __pyx_vtabptr_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) < 0) __PYX_ERR(0, 2268, __pyx_L1_error)
   #if !CYTHON_COMPILING_IN_LIMITED_API
-  if (__Pyx_MergeVtables(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) < 0) __PYX_ERR(0, 2141, __pyx_L1_error)
+  if (__Pyx_MergeVtables(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) < 0) __PYX_ERR(0, 2268, __pyx_L1_error)
   #endif
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_SEOBNRv5RRForce, (PyObject *) __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) < 0) __PYX_ERR(0, 2141, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_SEOBNRv5RRForce, (PyObject *) __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) < 0) __PYX_ERR(0, 2268, __pyx_L1_error)
   #if !CYTHON_COMPILING_IN_LIMITED_API
-  if (__Pyx_setup_reduce((PyObject *) __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) < 0) __PYX_ERR(0, 2141, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject *) __pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce) < 0) __PYX_ERR(0, 2268, __pyx_L1_error)
   #endif
   __pyx_vtabptr_array = &__pyx_vtable_array;
   __pyx_vtable_array.get_memview = (PyObject *(*)(struct __pyx_array_obj *))__pyx_array_get_memview;
   #if CYTHON_USE_TYPE_SPECS
   __pyx_array_type = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type___pyx_array_spec, NULL); if (unlikely(!__pyx_array_type)) __PYX_ERR(1, 114, __pyx_L1_error)
   #if !CYTHON_COMPILING_IN_LIMITED_API
   __pyx_array_type->tp_as_buffer = &__pyx_tp_as_buffer_array;
@@ -37676,50 +37759,50 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule("pyseobnr.eob.utils.containers"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(3, 8, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "PhysicalParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_PhysicalParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams) __PYX_ERR(3, 8, __pyx_L1_error)
   __pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams = (struct __pyx_vtabstruct_8pyseobnr_3eob_5utils_10containers_PhysicalParams*)__Pyx_GetVtable(__pyx_ptype_8pyseobnr_3eob_5utils_10containers_PhysicalParams); if (unlikely(!__pyx_vtabptr_8pyseobnr_3eob_5utils_10containers_PhysicalParams)) __PYX_ERR(3, 8, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(3, 23, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(3, 26, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(3, 29, __pyx_L1_error)
-  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_8(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(3, 67, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "CalibCoeffs", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_CalibCoeffs),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_CalibCoeffs) __PYX_ERR(3, 23, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "Dynamics", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_Dynamics),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_Dynamics) __PYX_ERR(3, 26, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "FluxParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_FluxParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_FluxParams) __PYX_ERR(3, 29, __pyx_L1_error)
+  __pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams = __Pyx_ImportType_3_0_10(__pyx_t_1, "pyseobnr.eob.utils.containers", "EOBParams", sizeof(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(struct __pyx_obj_8pyseobnr_3eob_5utils_10containers_EOBParams),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_8pyseobnr_3eob_5utils_10containers_EOBParams) __PYX_ERR(3, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_0_8(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
+  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_0_10(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
   #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
-  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyTypeObject),
   #elif CYTHON_COMPILING_IN_LIMITED_API
-  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyTypeObject),
   #else
-  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyHeapTypeObject),
+  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyHeapTypeObject),
   #endif
-  __Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(4, 9, __pyx_L1_error)
+  __Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(4, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_5numpy_dtype = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArray_Descr),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 202, __pyx_L1_error)
-  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 225, __pyx_L1_error)
-  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayMultiIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 229, __pyx_L1_error)
-  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyArrayObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
-  __pyx_ptype_5numpy_generic = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 809, __pyx_L1_error)
-  __pyx_ptype_5numpy_number = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 811, __pyx_L1_error)
-  __pyx_ptype_5numpy_integer = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 813, __pyx_L1_error)
-  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 815, __pyx_L1_error)
-  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 817, __pyx_L1_error)
-  __pyx_ptype_5numpy_inexact = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 819, __pyx_L1_error)
-  __pyx_ptype_5numpy_floating = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 821, __pyx_L1_error)
-  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 823, __pyx_L1_error)
-  __pyx_ptype_5numpy_flexible = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 825, __pyx_L1_error)
-  __pyx_ptype_5numpy_character = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_8); if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 827, __pyx_L1_error)
-  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType_3_0_8(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_8(PyUFuncObject),__Pyx_ImportType_CheckSize_Ignore_3_0_8); if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 866, __pyx_L1_error)
+  __pyx_ptype_5numpy_dtype = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArray_Descr),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(2, 202, __pyx_L1_error)
+  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(2, 225, __pyx_L1_error)
+  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayMultiIterObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(2, 229, __pyx_L1_error)
+  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyArrayObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(2, 238, __pyx_L1_error)
+  __pyx_ptype_5numpy_generic = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_generic) __PYX_ERR(2, 809, __pyx_L1_error)
+  __pyx_ptype_5numpy_number = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "number", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_number) __PYX_ERR(2, 811, __pyx_L1_error)
+  __pyx_ptype_5numpy_integer = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_integer) __PYX_ERR(2, 813, __pyx_L1_error)
+  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(2, 815, __pyx_L1_error)
+  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(2, 817, __pyx_L1_error)
+  __pyx_ptype_5numpy_inexact = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(2, 819, __pyx_L1_error)
+  __pyx_ptype_5numpy_floating = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_floating) __PYX_ERR(2, 821, __pyx_L1_error)
+  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(2, 823, __pyx_L1_error)
+  __pyx_ptype_5numpy_flexible = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(2, 825, __pyx_L1_error)
+  __pyx_ptype_5numpy_character = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "character", sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_5numpy_character) __PYX_ERR(2, 827, __pyx_L1_error)
+  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType_3_0_10(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyUFuncObject),__Pyx_ImportType_CheckSize_Ignore_3_0_10); if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(2, 866, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -37739,18 +37822,18 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_function_import_code", 0);
   /*--- Function import code ---*/
   __pyx_t_1 = PyImport_ImportModule("scipy.special.cython_special"); if (!__pyx_t_1) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (__Pyx_ImportFunction_3_0_8(__pyx_t_1, "__pyx_fuse_0loggamma", (void (**)(void))&__pyx_fuse_0__pyx_f_5scipy_7special_14cython_special_loggamma, "__pyx_t_double_complex (__pyx_t_double_complex, int __pyx_skip_dispatch)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  if (__Pyx_ImportFunction_3_0_8(__pyx_t_1, "__pyx_fuse_1loggamma", (void (**)(void))&__pyx_fuse_1__pyx_f_5scipy_7special_14cython_special_loggamma, "double (double, int __pyx_skip_dispatch)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  if (__Pyx_ImportFunction_3_0_8(__pyx_t_1, "__pyx_fuse_0sph_harm", (void (**)(void))&__pyx_fuse_0__pyx_f_5scipy_7special_14cython_special_sph_harm, "__pyx_t_double_complex (double, double, double, double, int __pyx_skip_dispatch)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  if (__Pyx_ImportFunction_3_0_8(__pyx_t_1, "__pyx_fuse_1sph_harm", (void (**)(void))&__pyx_fuse_1__pyx_f_5scipy_7special_14cython_special_sph_harm, "__pyx_t_double_complex (long, long, double, double, int __pyx_skip_dispatch)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_ImportFunction_3_0_10(__pyx_t_1, "__pyx_fuse_0loggamma", (void (**)(void))&__pyx_fuse_0__pyx_f_5scipy_7special_14cython_special_loggamma, "__pyx_t_double_complex (__pyx_t_double_complex, int __pyx_skip_dispatch)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_ImportFunction_3_0_10(__pyx_t_1, "__pyx_fuse_1loggamma", (void (**)(void))&__pyx_fuse_1__pyx_f_5scipy_7special_14cython_special_loggamma, "double (double, int __pyx_skip_dispatch)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_ImportFunction_3_0_10(__pyx_t_1, "__pyx_fuse_0sph_harm", (void (**)(void))&__pyx_fuse_0__pyx_f_5scipy_7special_14cython_special_sph_harm, "__pyx_t_double_complex (double, double, double, double, int __pyx_skip_dispatch)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (__Pyx_ImportFunction_3_0_10(__pyx_t_1, "__pyx_fuse_1sph_harm", (void (**)(void))&__pyx_fuse_1__pyx_f_5scipy_7special_14cython_special_sph_harm, "__pyx_t_double_complex (long, long, double, double, int __pyx_skip_dispatch)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -37773,15 +37856,15 @@
   struct PyModuleDef __pyx_moduledef =
   #else
   static struct PyModuleDef __pyx_moduledef =
   #endif
   {
       PyModuleDef_HEAD_INIT,
       "waveform",
-      __pyx_k_Optimized_functions_for_wavefor, /* m_doc */
+      0, /* m_doc */
     #if CYTHON_PEP489_MULTI_PHASE_INIT
       0, /* m_size */
     #elif CYTHON_USE_MODULE_STATE
       sizeof(__pyx_mstate), /* m_size */
     #else
       -1, /* m_size */
     #endif
@@ -37951,15 +38034,15 @@
   #endif
   /*--- Module creation code ---*/
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   __pyx_m = __pyx_pyinit_module;
   Py_INCREF(__pyx_m);
   #else
   #if PY_MAJOR_VERSION < 3
-  __pyx_m = Py_InitModule4("waveform", __pyx_methods, __pyx_k_Optimized_functions_for_wavefor, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
+  __pyx_m = Py_InitModule4("waveform", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
   if (unlikely(!__pyx_m)) __PYX_ERR(0, 1, __pyx_L1_error)
   #elif CYTHON_USE_MODULE_STATE
   __pyx_t_1 = PyModule_Create(&__pyx_moduledef); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   {
     int add_module_result = PyState_AddModule(__pyx_t_1, &__pyx_moduledef);
     __pyx_t_1 = 0; /* transfer ownership from __pyx_t_1 to "waveform" pseudovariable */
     if (unlikely((add_module_result < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -38560,81 +38643,69 @@
  *     cdef object __pyx_result
  */
   __pyx_t_7 = PyCFunction_NewEx(&__pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum, NULL, __pyx_n_s_View_MemoryView); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_Enum, __pyx_t_7) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":12
- * from libc.math cimport M_E, M_PI_2
- * from scipy.special.cython_special cimport sph_harm, loggamma
- * from scipy.special import  factorial2             # <<<<<<<<<<<<<<
- * from pyseobnr.eob.utils.containers cimport EOBParams,FluxParams
+  /* "pyseobnr/eob/waveform/waveform.pyx":20
  * 
- */
-  __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 12, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_INCREF(__pyx_n_s_factorial2);
-  __Pyx_GIVEREF(__pyx_n_s_factorial2);
-  if (__Pyx_PyList_SET_ITEM(__pyx_t_7, 0, __pyx_n_s_factorial2)) __PYX_ERR(0, 12, __pyx_L1_error);
-  __pyx_t_4 = __Pyx_Import(__pyx_n_s_scipy_special, __pyx_t_7, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 12, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_ImportFrom(__pyx_t_4, __pyx_n_s_factorial2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 12, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_factorial2, __pyx_t_7) < 0) __PYX_ERR(0, 12, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-
-  /* "pyseobnr/eob/waveform/waveform.pyx":16
  * 
- * cimport scipy.linalg.cython_blas as blas
  * import numpy as np             # <<<<<<<<<<<<<<
  * cimport numpy as np
- * import sys
+ * from scipy.special.cython_special cimport loggamma, sph_harm
  */
-  __pyx_t_4 = __Pyx_ImportDottedModule(__pyx_n_s_numpy, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 16, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_4) < 0) __PYX_ERR(0, 16, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_7 = __Pyx_ImportDottedModule(__pyx_n_s_numpy, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 20, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_7) < 0) __PYX_ERR(0, 20, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":18
- * import numpy as np
+  /* "pyseobnr/eob/waveform/waveform.pyx":23
  * cimport numpy as np
- * import sys             # <<<<<<<<<<<<<<
+ * from scipy.special.cython_special cimport loggamma, sph_harm
+ * from scipy.interpolate import CubicSpline             # <<<<<<<<<<<<<<
+ * from scipy.special import factorial2
  * 
- * from scipy.interpolate import CubicSpline
  */
-  __pyx_t_4 = __Pyx_ImportDottedModule(__pyx_n_s_sys, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 18, __pyx_L1_error)
+  __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 23, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_INCREF(__pyx_n_s_CubicSpline);
+  __Pyx_GIVEREF(__pyx_n_s_CubicSpline);
+  if (__Pyx_PyList_SET_ITEM(__pyx_t_7, 0, __pyx_n_s_CubicSpline)) __PYX_ERR(0, 23, __pyx_L1_error);
+  __pyx_t_4 = __Pyx_Import(__pyx_n_s_scipy_interpolate, __pyx_t_7, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 23, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sys, __pyx_t_4) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_7 = __Pyx_ImportFrom(__pyx_t_4, __pyx_n_s_CubicSpline); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 23, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_CubicSpline, __pyx_t_7) < 0) __PYX_ERR(0, 23, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":20
- * import sys
- * 
- * from scipy.interpolate import CubicSpline             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":24
+ * from scipy.special.cython_special cimport loggamma, sph_harm
+ * from scipy.interpolate import CubicSpline
+ * from scipy.special import factorial2             # <<<<<<<<<<<<<<
  * 
- * cdef extern from "complex.h":
+ * from pyseobnr.eob.utils.containers cimport EOBParams, FluxParams
  */
-  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 20, __pyx_L1_error)
+  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 24, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_INCREF(__pyx_n_s_CubicSpline);
-  __Pyx_GIVEREF(__pyx_n_s_CubicSpline);
-  if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_s_CubicSpline)) __PYX_ERR(0, 20, __pyx_L1_error);
-  __pyx_t_7 = __Pyx_Import(__pyx_n_s_scipy_interpolate, __pyx_t_4, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 20, __pyx_L1_error)
+  __Pyx_INCREF(__pyx_n_s_factorial2);
+  __Pyx_GIVEREF(__pyx_n_s_factorial2);
+  if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_s_factorial2)) __PYX_ERR(0, 24, __pyx_L1_error);
+  __pyx_t_7 = __Pyx_Import(__pyx_n_s_scipy_special, __pyx_t_4, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 24, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_ImportFrom(__pyx_t_7, __pyx_n_s_CubicSpline); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 20, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_ImportFrom(__pyx_t_7, __pyx_n_s_factorial2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 24, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_CubicSpline, __pyx_t_4) < 0) __PYX_ERR(0, 20, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_factorial2, __pyx_t_4) < 0) __PYX_ERR(0, 24, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":37
+  /* "pyseobnr/eob/waveform/waveform.pyx":44
  * cdef double ylms[9][9]
  * ylms[:] = [
  *     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],             # <<<<<<<<<<<<<<
  *     [
  *         0.0,
  */
   __pyx_t_9[0] = 0.0;
@@ -38643,15 +38714,15 @@
   __pyx_t_9[3] = 0.0;
   __pyx_t_9[4] = 0.0;
   __pyx_t_9[5] = 0.0;
   __pyx_t_9[6] = 0.0;
   __pyx_t_9[7] = 0.0;
   __pyx_t_9[8] = 0.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":38
+  /* "pyseobnr/eob/waveform/waveform.pyx":45
  * ylms[:] = [
  *     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  *     [             # <<<<<<<<<<<<<<
  *         0.0,
  *         0.3454941494713355,
  */
   __pyx_t_10[0] = 0.0;
@@ -38660,15 +38731,15 @@
   __pyx_t_10[3] = 0.3231801841141506;
   __pyx_t_10[4] = 4.055554344078009e-17;
   __pyx_t_10[5] = 0.32028164857621516;
   __pyx_t_10[6] = 8.000317029649286e-17;
   __pyx_t_10[7] = 0.31937046138540076;
   __pyx_t_10[8] = 1.1920022960993937e-16;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":49
+  /* "pyseobnr/eob/waveform/waveform.pyx":56
  *         1.1920022960993937e-16,
  *     ],
  *     [             # <<<<<<<<<<<<<<
  *         0.0,
  *         0.0,
  */
   __pyx_t_11[0] = 0.0;
@@ -38677,15 +38748,15 @@
   __pyx_t_11[3] = 0.0;
   __pyx_t_11[4] = 0.33452327177864466;
   __pyx_t_11[5] = 4.447491653287784e-17;
   __pyx_t_11[6] = 0.32569524293385776;
   __pyx_t_11[7] = 8.531070568407408e-17;
   __pyx_t_11[8] = 0.32254835519288305;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":60
+  /* "pyseobnr/eob/waveform/waveform.pyx":67
  *         0.32254835519288305,
  *     ],
  *     [             # <<<<<<<<<<<<<<
  *         0.0,
  *         0.0,
  */
   __pyx_t_12[0] = 0.0;
@@ -38694,15 +38765,15 @@
   __pyx_t_12[3] = 0.4172238236327842;
   __pyx_t_12[4] = 0.0;
   __pyx_t_12[5] = 0.34594371914684025;
   __pyx_t_12[6] = 4.8749755603568385e-17;
   __pyx_t_12[7] = 0.331899519333737;
   __pyx_t_12[8] = 9.130149959227967e-17;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":71
+  /* "pyseobnr/eob/waveform/waveform.pyx":78
  *         9.130149959227967e-17,
  *     ],
  *     [             # <<<<<<<<<<<<<<
  *         0.0,
  *         0.0,
  */
   __pyx_t_13[0] = 0.0;
@@ -38711,15 +38782,15 @@
   __pyx_t_13[3] = 0.0;
   __pyx_t_13[4] = 0.4425326924449826;
   __pyx_t_13[5] = 0.0;
   __pyx_t_13[6] = 0.3567812628539981;
   __pyx_t_13[7] = 5.310595586255289e-17;
   __pyx_t_13[8] = 0.3382915688890245;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":82
+  /* "pyseobnr/eob/waveform/waveform.pyx":89
  *         0.3382915688890245,
  *     ],
  *     [             # <<<<<<<<<<<<<<
  *         0.0,
  *         0.0,
  */
   __pyx_t_14[0] = 0.0;
@@ -38728,15 +38799,15 @@
   __pyx_t_14[3] = 0.0;
   __pyx_t_14[4] = 0.0;
   __pyx_t_14[5] = 0.46413220344085826;
   __pyx_t_14[6] = 0.0;
   __pyx_t_14[7] = 0.3669287245764378;
   __pyx_t_14[8] = 5.745136532071183e-17;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":93
+  /* "pyseobnr/eob/waveform/waveform.pyx":100
  *         5.745136532071183e-17,
  *     ],
  *     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.48308411358006625, 0.0, 0.3764161087284946],             # <<<<<<<<<<<<<<
  *     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5000395635705508, 0.0],
  *     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5154289843972844],
  */
   __pyx_t_15[0] = 0.0;
@@ -38745,15 +38816,15 @@
   __pyx_t_15[3] = 0.0;
   __pyx_t_15[4] = 0.0;
   __pyx_t_15[5] = 0.0;
   __pyx_t_15[6] = 0.48308411358006625;
   __pyx_t_15[7] = 0.0;
   __pyx_t_15[8] = 0.3764161087284946;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":94
+  /* "pyseobnr/eob/waveform/waveform.pyx":101
  *     ],
  *     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.48308411358006625, 0.0, 0.3764161087284946],
  *     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5000395635705508, 0.0],             # <<<<<<<<<<<<<<
  *     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5154289843972844],
  * ]
  */
   __pyx_t_16[0] = 0.0;
@@ -38762,15 +38833,15 @@
   __pyx_t_16[3] = 0.0;
   __pyx_t_16[4] = 0.0;
   __pyx_t_16[5] = 0.0;
   __pyx_t_16[6] = 0.0;
   __pyx_t_16[7] = 0.5000395635705508;
   __pyx_t_16[8] = 0.0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":95
+  /* "pyseobnr/eob/waveform/waveform.pyx":102
  *     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.48308411358006625, 0.0, 0.3764161087284946],
  *     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5000395635705508, 0.0],
  *     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5154289843972844],             # <<<<<<<<<<<<<<
  * ]
  * 
  */
   __pyx_t_17[0] = 0.0;
@@ -38779,15 +38850,15 @@
   __pyx_t_17[3] = 0.0;
   __pyx_t_17[4] = 0.0;
   __pyx_t_17[5] = 0.0;
   __pyx_t_17[6] = 0.0;
   __pyx_t_17[7] = 0.0;
   __pyx_t_17[8] = 0.5154289843972844;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":36
+  /* "pyseobnr/eob/waveform/waveform.pyx":43
  * # Follows the scipy convention: ylms[m][ell]
  * cdef double ylms[9][9]
  * ylms[:] = [             # <<<<<<<<<<<<<<
  *     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  *     [
  */
   memcpy(&(__pyx_t_18[0]), __pyx_t_9, sizeof(__pyx_t_18[0]));
@@ -38797,45 +38868,45 @@
   memcpy(&(__pyx_t_18[4]), __pyx_t_13, sizeof(__pyx_t_18[0]));
   memcpy(&(__pyx_t_18[5]), __pyx_t_14, sizeof(__pyx_t_18[0]));
   memcpy(&(__pyx_t_18[6]), __pyx_t_15, sizeof(__pyx_t_18[0]));
   memcpy(&(__pyx_t_18[7]), __pyx_t_16, sizeof(__pyx_t_18[0]));
   memcpy(&(__pyx_t_18[8]), __pyx_t_17, sizeof(__pyx_t_18[0]));
   memcpy(&(__pyx_v_8pyseobnr_3eob_8waveform_8waveform_ylms[0]), __pyx_t_18, sizeof(__pyx_v_8pyseobnr_3eob_8waveform_8waveform_ylms[0]) * (9));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":99
+  /* "pyseobnr/eob/waveform/waveform.pyx":106
  * 
  * 
  * DTYPE = np.float64             # <<<<<<<<<<<<<<
  * ctypedef np.float64_t DTYPE_T
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 99, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 106, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 99, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 106, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_4) < 0) __PYX_ERR(0, 99, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_4) < 0) __PYX_ERR(0, 106, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":102
+  /* "pyseobnr/eob/waveform/waveform.pyx":109
  * ctypedef np.float64_t DTYPE_T
  * 
  * DTYPE_c = np.complex128             # <<<<<<<<<<<<<<
  * ctypedef np.complex128_t DTYPE_tc
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 102, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_complex128); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 102, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_complex128); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_DTYPE_c, __pyx_t_7) < 0) __PYX_ERR(0, 102, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_DTYPE_c, __pyx_t_7) < 0) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":107
+  /* "pyseobnr/eob/waveform/waveform.pyx":114
  * # Lookup table for factorial until n=21
  * cdef double[21] LOOKUP_TABLE
  * LOOKUP_TABLE[:] = [             # <<<<<<<<<<<<<<
  *         1,
  *         1,
  */
   __pyx_t_19[0] = 1.0;
@@ -38857,185 +38928,185 @@
   __pyx_t_19[16] = 20922789888000.0;
   __pyx_t_19[17] = 355687428096000.0;
   __pyx_t_19[18] = 6402373705728000.0;
   __pyx_t_19[19] = 121645100408832000.0;
   __pyx_t_19[20] = 2432902008176640000.0;
   memcpy(&(__pyx_v_8pyseobnr_3eob_8waveform_8waveform_LOOKUP_TABLE[0]), __pyx_t_19, sizeof(__pyx_v_8pyseobnr_3eob_8waveform_8waveform_LOOKUP_TABLE[0]) * (21));
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":140
+  /* "pyseobnr/eob/waveform/waveform.pyx":144
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double complex calculate_multipole_prefix(double m1, double m2, int l, int m):             # <<<<<<<<<<<<<<
  *     """
  *     Calculates the Newtonian multipole prefactors, see Eq. 25-27 in
  */
 
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_1calculate_multipole_prefix, 0, __pyx_n_s_calculate_multipole_prefix, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__11)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 140, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_1calculate_multipole_prefix, 0, __pyx_n_s_calculate_multipole_prefix, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__11)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 144, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calculate_multipole_prefix, __pyx_t_7) < 0) __PYX_ERR(0, 140, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calculate_multipole_prefix, __pyx_t_7) < 0) __PYX_ERR(0, 144, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":225
+  /* "pyseobnr/eob/waveform/waveform.pyx":232
  * @cython.wraparound(False)
  * @cython.boundscheck(False)
  * cpdef compute_newtonian_prefixes(double m1, double m2):             # <<<<<<<<<<<<<<
  *     """
  *     Loop to set the Newtonian multipole prefactors.
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_3compute_newtonian_prefixes, 0, __pyx_n_s_compute_newtonian_prefixes, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__34)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_3compute_newtonian_prefixes, 0, __pyx_n_s_compute_newtonian_prefixes, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__34)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 232, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_newtonian_prefixes, __pyx_t_7) < 0) __PYX_ERR(0, 225, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_newtonian_prefixes, __pyx_t_7) < 0) __PYX_ERR(0, 232, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":245
+  /* "pyseobnr/eob/waveform/waveform.pyx":253
  * @cython.wraparound(False)
  * @cython.cdivision(True)
- * cpdef double evaluate_nqc_correction_flux(double r, double pr,  double omega, double[:] coeffs):             # <<<<<<<<<<<<<<
- *     """
- *     Calculate the NQC amplitude correction.
+ * cpdef double evaluate_nqc_correction_flux(             # <<<<<<<<<<<<<<
+ *     double r,
+ *     double pr,
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_5evaluate_nqc_correction_flux, 0, __pyx_n_s_evaluate_nqc_correction_flux, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__36)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 245, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_5evaluate_nqc_correction_flux, 0, __pyx_n_s_evaluate_nqc_correction_flux, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__36)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 253, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_evaluate_nqc_correction_flux, __pyx_t_7) < 0) __PYX_ERR(0, 245, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_evaluate_nqc_correction_flux, __pyx_t_7) < 0) __PYX_ERR(0, 253, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":266
+  /* "pyseobnr/eob/waveform/waveform.pyx":280
  * @cython.wraparound(False)
  * @cython.cdivision(True)
- * cpdef compute_tail(double omega, double H, double[:,:] Tlm):             # <<<<<<<<<<<<<<
- *     """
- *     Calculate the resummed Tail effects.
+ * cpdef compute_tail(             # <<<<<<<<<<<<<<
+ *     double omega,
+ *     double H,
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_7compute_tail, 0, __pyx_n_s_compute_tail, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__38)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 266, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_7compute_tail, 0, __pyx_n_s_compute_tail, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__38)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 280, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_tail, __pyx_t_7) < 0) __PYX_ERR(0, 266, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_tail, __pyx_t_7) < 0) __PYX_ERR(0, 280, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":304
+  /* "pyseobnr/eob/waveform/waveform.pyx":321
  * @cython.nonecheck(False)
  * @cython.initializedcheck(False)
- * cpdef void compute_rho_coeffs(double nu,double dm, double a,double chiS,double chiA,             # <<<<<<<<<<<<<<
- *     double[:,:,:] rho_coeffs,double[:,:,:] rho_coeffs_log, double[:,:,:] f_coeffs,
- *     double complex[:,:,:] f_coeffs_vh, bint extra_PN_terms):
+ * cpdef void compute_rho_coeffs(             # <<<<<<<<<<<<<<
+ *     double nu,
+ *     double dm,
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_9compute_rho_coeffs, 0, __pyx_n_s_compute_rho_coeffs, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__40)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 304, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_9compute_rho_coeffs, 0, __pyx_n_s_compute_rho_coeffs, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__40)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 321, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_rho_coeffs, __pyx_t_7) < 0) __PYX_ERR(0, 304, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_rho_coeffs, __pyx_t_7) < 0) __PYX_ERR(0, 321, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1057
+  /* "pyseobnr/eob/waveform/waveform.pyx":1093
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef public void compute_delta_coeffs(double nu,double dm, double a,double chiS,double chiA,             # <<<<<<<<<<<<<<
- *     double complex[:,:,:] delta_coeffs, double complex[:,:,:] delta_coeffs_vh):
- * 
+ * cdef public void compute_delta_coeffs(             # <<<<<<<<<<<<<<
+ *     double nu,
+ *     double dm,
  */
 
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1235
+  /* "pyseobnr/eob/waveform/waveform.pyx":1283
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef void compute_delta(double v,double vh,double nu, EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     """
- *     Compute the  full :math:`\\delta_{\\ell m}` contribution for all modes
+ * cdef void compute_delta(             # <<<<<<<<<<<<<<
+ *     double v,
+ *     double vh,
  */
 
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1259
+  /* "pyseobnr/eob/waveform/waveform.pyx":1311
  * @cython.nonecheck(False)
  * @cython.initializedcheck(False)
- * cpdef double complex compute_extra_flm_terms(int l,int m,double vh,EOBParams eob_pars):             # <<<<<<<<<<<<<<
+ * cpdef double complex compute_extra_flm_terms(int l, int m, double vh, EOBParams eob_pars):             # <<<<<<<<<<<<<<
  *     """
  *     Compute the complex term in :math:`f_{33}`.
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_11compute_extra_flm_terms, 0, __pyx_n_s_compute_extra_flm_terms, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__42)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1259, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_11compute_extra_flm_terms, 0, __pyx_n_s_compute_extra_flm_terms, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__42)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1311, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_extra_flm_terms, __pyx_t_7) < 0) __PYX_ERR(0, 1259, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_extra_flm_terms, __pyx_t_7) < 0) __PYX_ERR(0, 1311, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1350
+  /* "pyseobnr/eob/waveform/waveform.pyx":1418
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef void compute_rholm(double v,double vh,double nu, EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     cdef int i,l,m
+ * cdef void compute_rholm(double v, double vh, double nu, EOBParams eob_pars):             # <<<<<<<<<<<<<<
+ *     cdef int i, l, m
  *     cdef double vs[PN_limit]
  */
 
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1369
+  /* "pyseobnr/eob/waveform/waveform.pyx":1440
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double  EOBFluxCalculateNewtonianMultipoleAbs(             # <<<<<<<<<<<<<<
- *     double x, double phi, int l, int m, double [:,:] params
- * ):
+ *     double x,
+ *     double phi,
  */
 
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_13EOBFluxCalculateNewtonianMultipoleAbs, 0, __pyx_n_s_EOBFluxCalculateNewtonianMultipo, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__12)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1369, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_13EOBFluxCalculateNewtonianMultipoleAbs, 0, __pyx_n_s_EOBFluxCalculateNewtonianMultipo, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__12)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_EOBFluxCalculateNewtonianMultipo, __pyx_t_7) < 0) __PYX_ERR(0, 1369, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_EOBFluxCalculateNewtonianMultipo, __pyx_t_7) < 0) __PYX_ERR(0, 1440, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1393
+  /* "pyseobnr/eob/waveform/waveform.pyx":1467
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef void update_rho_coeffs(double[:,:,:] rho_coeffs, double[:,:,:] extra_coeffs):             # <<<<<<<<<<<<<<
- *     cdef int l,m,i
+ * cdef void update_rho_coeffs(double[:, :, :] rho_coeffs, double[:, :, :] extra_coeffs):             # <<<<<<<<<<<<<<
+ *     cdef int l, m, i
  *     cdef double temp = 0.0
  */
 
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1411
+  /* "pyseobnr/eob/waveform/waveform.pyx":1486
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef double compute_flux(double r,double phi,double pr,double pphi,double omega,double omega_circ,double H,EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     """
- *     Compute the full flux.
+ * cpdef double compute_flux(             # <<<<<<<<<<<<<<
+ *     double r,
+ *     double phi,
  */
 
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_15compute_flux, 0, __pyx_n_s_compute_flux, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__13)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1411, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_15compute_flux, 0, __pyx_n_s_compute_flux, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__13)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1486, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_flux, __pyx_t_7) < 0) __PYX_ERR(0, 1411, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_flux, __pyx_t_7) < 0) __PYX_ERR(0, 1486, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":1484
+  /* "pyseobnr/eob/waveform/waveform.pyx":1576
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cpdef double compute_refactorized_flux(             # <<<<<<<<<<<<<<
  *     double chi_1,
  *     double chi_2,
  */
 
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_17compute_refactorized_flux, 0, __pyx_n_s_compute_refactorized_flux, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__14)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1484, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_17compute_refactorized_flux, 0, __pyx_n_s_compute_refactorized_flux, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__14)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1576, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_refactorized_flux, __pyx_t_7) < 0) __PYX_ERR(0, 1484, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_refactorized_flux, __pyx_t_7) < 0) __PYX_ERR(0, 1576, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2110
+  /* "pyseobnr/eob/waveform/waveform.pyx":2224
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef (double,double) RR_force(double[::1] q, double[::1] p, double omega, double omega_circ,             # <<<<<<<<<<<<<<
- *     double H, EOBParams eob_pars):
- *     """
+ * cpdef (double, double) RR_force(             # <<<<<<<<<<<<<<
+ *     double[::1] q,
+ *     double[::1] p,
  */
 
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_19RR_force, 0, __pyx_n_s_RR_force, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__15)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2110, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_19RR_force, 0, __pyx_n_s_RR_force, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__15)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_RR_force, __pyx_t_7) < 0) __PYX_ERR(0, 2110, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_RR_force, __pyx_t_7) < 0) __PYX_ERR(0, 2224, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2136
- *     def __cinit__(self):
- *         pass
- *     cpdef (double,double) RR(self, double[::1] q, double[::1] p, double omega,             # <<<<<<<<<<<<<<
- *         double omega_circ, double H, EOBParams eob_pars):
+  /* "pyseobnr/eob/waveform/waveform.pyx":2256
  *         pass
+ * 
+ *     cpdef (double, double) RR(             # <<<<<<<<<<<<<<
+ *         self,
+ *         double[::1] q,
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_22RadiationReactionForce_3RR, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_RadiationReactionForce_RR, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__48)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2136, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_22RadiationReactionForce_3RR, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_RadiationReactionForce_RR, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__48)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2256, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce, __pyx_n_s_RR, __pyx_t_7) < 0) __PYX_ERR(0, 2136, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce, __pyx_n_s_RR, __pyx_t_7) < 0) __PYX_ERR(0, 2256, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_RadiationReactionForce);
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
  * def __setstate_cython__(self, __pyx_state):
@@ -39052,24 +39123,24 @@
  *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
  */
   __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_22RadiationReactionForce_7__setstate_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_RadiationReactionForce___setstat, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__52)); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 3, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_setstate_cython, __pyx_t_7) < 0) __PYX_ERR(1, 3, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2148
+  /* "pyseobnr/eob/waveform/waveform.pyx":2276
  *         pass
  * 
- *     cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega,             # <<<<<<<<<<<<<<
- *         double omega_circ, double H, EOBParams eob_pars):
- *         return RR_force(q, p, omega, omega_circ, H, eob_pars)
+ *     cpdef (double, double) RR(             # <<<<<<<<<<<<<<
+ *         self,
+ *         double[::1] q,
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_15SEOBNRv5RRForce_3RR, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_SEOBNRv5RRForce_RR, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__53)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2148, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_15SEOBNRv5RRForce_3RR, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_SEOBNRv5RRForce_RR, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__53)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2276, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce, __pyx_n_s_RR, __pyx_t_7) < 0) __PYX_ERR(0, 2148, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce, __pyx_n_s_RR, __pyx_t_7) < 0) __PYX_ERR(0, 2276, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_8pyseobnr_3eob_8waveform_8waveform_SEOBNRv5RRForce);
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
  * def __setstate_cython__(self, __pyx_state):
@@ -39086,139 +39157,139 @@
  *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
  */
   __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_15SEOBNRv5RRForce_7__setstate_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_SEOBNRv5RRForce___setstate_cytho, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__55)); if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 3, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_setstate_cython, __pyx_t_7) < 0) __PYX_ERR(1, 3, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2161
+  /* "pyseobnr/eob/waveform/waveform.pyx":2294
  * @cython.profile(True)
  * @cython.linetrace(True)
  * cdef double complex EOBFluxCalculateNewtonianMultipole(             # <<<<<<<<<<<<<<
- *     double x, double phi, int l, int m, double complex[:,:] params
- * ):
+ *     double x,
+ *     double phi,
  */
 
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2189
+  /* "pyseobnr/eob/waveform/waveform.pyx":2324
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cdef double complex compute_mode(double v_phi2,double phi, double Slm, double[] vs,double[] vhs,int l, int m, EOBParams eob_pars):             # <<<<<<<<<<<<<<
- *     """
- *     Compute the given (l,m) mode at one instant in time.
+ * cdef double complex compute_mode(             # <<<<<<<<<<<<<<
+ *     double v_phi2,
+ *     double phi,
  */
 
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2237
+  /* "pyseobnr/eob/waveform/waveform.pyx":2384
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef compute_hlms(double[:,:] dynamics, EOBParams eob_pars):             # <<<<<<<<<<<<<<
+ * cpdef compute_hlms(double[:, :] dynamics, EOBParams eob_pars):             # <<<<<<<<<<<<<<
  *     """
  *     Compute the inspiral modes for aligned *or* precessing binaries.
  */
 
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_21compute_hlms, 0, __pyx_n_s_compute_hlms, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__16)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2237, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_21compute_hlms, 0, __pyx_n_s_compute_hlms, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__16)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2384, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_hlms, __pyx_t_7) < 0) __PYX_ERR(0, 2237, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_hlms, __pyx_t_7) < 0) __PYX_ERR(0, 2384, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2353
+  /* "pyseobnr/eob/waveform/waveform.pyx":2532
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef compute_special_coeffs(double[:,:] dynamics, double t_attach, EOBParams eob_pars,             # <<<<<<<<<<<<<<
- *     dict amp_fits, dict amp_thresholds, dict modes={(2,1):7,(4,3):7,(5,5):5}):
- *     """
+ * cpdef compute_special_coeffs(             # <<<<<<<<<<<<<<
+ *     double[:, :] dynamics,
+ *     double t_attach,
  */
 
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2354
- * @cython.linetrace(True)
- * cpdef compute_special_coeffs(double[:,:] dynamics, double t_attach, EOBParams eob_pars,
- *     dict amp_fits, dict amp_thresholds, dict modes={(2,1):7,(4,3):7,(5,5):5}):             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":2538
+ *     dict amp_fits,
+ *     dict amp_thresholds,
+ *     dict modes={(2, 1): 7, (4, 3): 7, (5, 5): 5}             # <<<<<<<<<<<<<<
+ * ):
  *     """
- *     Compute the "special" amplitude coefficients.
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2354, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2538, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_tuple__57, __pyx_int_7) < 0) __PYX_ERR(0, 2354, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_7, __pyx_tuple__58, __pyx_int_7) < 0) __PYX_ERR(0, 2354, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_7, __pyx_tuple__59, __pyx_int_5) < 0) __PYX_ERR(0, 2354, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_tuple__57, __pyx_int_7) < 0) __PYX_ERR(0, 2538, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_tuple__58, __pyx_int_7) < 0) __PYX_ERR(0, 2538, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_tuple__59, __pyx_int_5) < 0) __PYX_ERR(0, 2538, __pyx_L1_error)
   __pyx_k__17 = ((PyObject*)__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_7);
   __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2353
+  /* "pyseobnr/eob/waveform/waveform.pyx":2532
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef compute_special_coeffs(double[:,:] dynamics, double t_attach, EOBParams eob_pars,             # <<<<<<<<<<<<<<
- *     dict amp_fits, dict amp_thresholds, dict modes={(2,1):7,(4,3):7,(5,5):5}):
- *     """
+ * cpdef compute_special_coeffs(             # <<<<<<<<<<<<<<
+ *     double[:, :] dynamics,
+ *     double t_attach,
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2354, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2538, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2354
- * @cython.linetrace(True)
- * cpdef compute_special_coeffs(double[:,:] dynamics, double t_attach, EOBParams eob_pars,
- *     dict amp_fits, dict amp_thresholds, dict modes={(2,1):7,(4,3):7,(5,5):5}):             # <<<<<<<<<<<<<<
+  /* "pyseobnr/eob/waveform/waveform.pyx":2538
+ *     dict amp_fits,
+ *     dict amp_thresholds,
+ *     dict modes={(2, 1): 7, (4, 3): 7, (5, 5): 5}             # <<<<<<<<<<<<<<
+ * ):
  *     """
- *     Compute the "special" amplitude coefficients.
  */
-  if (PyDict_SetItem(__pyx_t_7, __pyx_tuple__57, __pyx_int_7) < 0) __PYX_ERR(0, 2354, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_7, __pyx_tuple__58, __pyx_int_7) < 0) __PYX_ERR(0, 2354, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_7, __pyx_tuple__59, __pyx_int_5) < 0) __PYX_ERR(0, 2354, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_tuple__57, __pyx_int_7) < 0) __PYX_ERR(0, 2538, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_tuple__58, __pyx_int_7) < 0) __PYX_ERR(0, 2538, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_tuple__59, __pyx_int_5) < 0) __PYX_ERR(0, 2538, __pyx_L1_error)
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2353
+  /* "pyseobnr/eob/waveform/waveform.pyx":2532
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef compute_special_coeffs(double[:,:] dynamics, double t_attach, EOBParams eob_pars,             # <<<<<<<<<<<<<<
- *     dict amp_fits, dict amp_thresholds, dict modes={(2,1):7,(4,3):7,(5,5):5}):
- *     """
+ * cpdef compute_special_coeffs(             # <<<<<<<<<<<<<<
+ *     double[:, :] dynamics,
+ *     double t_attach,
  */
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2353, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2532, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_7);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7)) __PYX_ERR(0, 2353, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7)) __PYX_ERR(0, 2532, __pyx_L1_error);
   __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_23compute_special_coeffs, 0, __pyx_n_s_compute_special_coeffs, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__18)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2353, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_23compute_special_coeffs, 0, __pyx_n_s_compute_special_coeffs, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__18)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2532, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_special_coeffs, __pyx_t_7) < 0) __PYX_ERR(0, 2353, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_special_coeffs, __pyx_t_7) < 0) __PYX_ERR(0, 2532, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2458
+  /* "pyseobnr/eob/waveform/waveform.pyx":2653
  * @cython.wraparound(False)
  * @cython.cdivision(True)
- * cpdef compute_factors(double[::1] phi_orb,int m_max, double complex[:,:]result):             # <<<<<<<<<<<<<<
+ * cpdef compute_factors(double[::1] phi_orb, int m_max, double complex[:, :] result):             # <<<<<<<<<<<<<<
  *     """
  *     Trivial helper function that computes iterative :math:`e^{im\\phi}`.
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_25compute_factors, 0, __pyx_n_s_compute_factors, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__62)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2458, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_25compute_factors, 0, __pyx_n_s_compute_factors, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__62)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2653, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_factors, __pyx_t_7) < 0) __PYX_ERR(0, 2458, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_factors, __pyx_t_7) < 0) __PYX_ERR(0, 2653, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "pyseobnr/eob/waveform/waveform.pyx":2482
+  /* "pyseobnr/eob/waveform/waveform.pyx":2677
  * @cython.profile(True)
  * @cython.linetrace(True)
- * cpdef unrotate_leading_pn(double[::1]re_part,double[::1]im_part, double complex[:] factor,double complex[:] result):             # <<<<<<<<<<<<<<
- *     """
- *     Helper function used to multiply the interpolated re and im parts by the leading order PN scaling
+ * cpdef unrotate_leading_pn(             # <<<<<<<<<<<<<<
+ *     double[::1] re_part,
+ *     double[::1] im_part,
  */
 
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_27unrotate_leading_pn, 0, __pyx_n_s_unrotate_leading_pn, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__20)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2482, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_8pyseobnr_3eob_8waveform_8waveform_27unrotate_leading_pn, 0, __pyx_n_s_unrotate_leading_pn, NULL, __pyx_n_s_pyseobnr_eob_waveform_waveform, __pyx_d, ((PyObject *)__pyx_codeobj__20)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2677, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_unrotate_leading_pn, __pyx_t_7) < 0) __PYX_ERR(0, 2482, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_unrotate_leading_pn, __pyx_t_7) < 0) __PYX_ERR(0, 2677, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
   /* "pyseobnr/eob/waveform/waveform.pyx":1
  * # cython: language_level=3             # <<<<<<<<<<<<<<
  * 
- * """
+ * cimport cython
  */
   __pyx_t_7 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_7) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
   /*--- Wrapped vars code ---*/
@@ -43436,18 +43507,18 @@
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
 }
 #endif
 
 /* TypeImport */
-  #ifndef __PYX_HAVE_RT_ImportType_3_0_8
-#define __PYX_HAVE_RT_ImportType_3_0_8
-static PyTypeObject *__Pyx_ImportType_3_0_8(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_8 check_size)
+  #ifndef __PYX_HAVE_RT_ImportType_3_0_10
+#define __PYX_HAVE_RT_ImportType_3_0_10
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject *module, const char *module_name, const char *class_name,
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
     Py_ssize_t itemsize;
 #if CYTHON_COMPILING_IN_LIMITED_API
     PyObject *py_basicsize;
@@ -43493,23 +43564,23 @@
     if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize+itemsize);
         goto bad;
     }
-    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_8 &&
+    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_10 &&
             ((size_t)basicsize > size || (size_t)(basicsize + itemsize) < size)) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd-%zd from PyObject",
             module_name, class_name, size, basicsize, basicsize+itemsize);
         goto bad;
     }
-    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_8 && (size_t)basicsize > size) {
+    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_10 && (size_t)basicsize > size) {
         PyOS_snprintf(warning, sizeof(warning),
             "%s.%s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
     }
     return (PyTypeObject *)result;
@@ -44501,15 +44572,15 @@
         break;
     case 0:
         self = ((PyCFunctionObject*)cyfunc)->m_self;
         break;
     default:
         return NULL;
     }
-    return ((_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
+    return ((__Pyx_PyCFunctionFastWithKeywords)(void(*)(void))def->ml_meth)(self, args, nargs, kwnames);
 }
 static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS_METHOD(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
 {
     __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
     PyMethodDef* def = ((PyCFunctionObject*)cyfunc)->m_ml;
     PyTypeObject *cls = (PyTypeObject *) __Pyx_CyFunction_GetClassObj(cyfunc);
 #if CYTHON_BACKPORT_VECTORCALL
@@ -47536,17 +47607,17 @@
 bad:
     Py_XDECREF(cobj);
     Py_XDECREF(d);
     return -1;
 }
 
 /* FunctionImport */
-  #ifndef __PYX_HAVE_RT_ImportFunction_3_0_8
-#define __PYX_HAVE_RT_ImportFunction_3_0_8
-static int __Pyx_ImportFunction_3_0_8(PyObject *module, const char *funcname, void (**f)(void), const char *sig) {
+  #ifndef __PYX_HAVE_RT_ImportFunction_3_0_10
+#define __PYX_HAVE_RT_ImportFunction_3_0_10
+static int __Pyx_ImportFunction_3_0_10(PyObject *module, const char *funcname, void (**f)(void), const char *sig) {
     PyObject *d = 0;
     PyObject *cobj = 0;
     union {
         void (*fp)(void);
         void *p;
     } tmp;
     d = PyObject_GetAttrString(module, (char *)"__pyx_capi__");
```

### Comparing `pyseobnr-0.2.8/pyseobnr/eob/waveform/waveform.pyx` & `pyseobnr-0.2.9/pyseobnr/eob/waveform/waveform.pyx`

 * *Files 8% similar despite different names*

```diff
@@ -1,27 +1,34 @@
 # cython: language_level=3
 
-"""
-Optimized functions for waveform generation.
-"""
-
 cimport cython
-from libc.math cimport log, sqrt, exp, abs,fabs, tgamma,sin,cos, tanh, sinh, asinh
+from libc.math cimport M_E
 from libc.math cimport M_PI as pi
-from libc.math cimport M_E, M_PI_2
-from scipy.special.cython_special cimport sph_harm, loggamma
-from scipy.special import  factorial2
-from pyseobnr.eob.utils.containers cimport EOBParams,FluxParams
+from libc.math cimport (
+    M_PI_2,
+    abs,
+    asinh,
+    exp,
+    fabs,
+    log,
+    sinh,
+    sqrt,
+    tanh,
+    tgamma,
+)
+
 
-cimport scipy.linalg.cython_blas as blas
 import numpy as np
 cimport numpy as np
-import sys
-
+from scipy.special.cython_special cimport loggamma, sph_harm
 from scipy.interpolate import CubicSpline
+from scipy.special import factorial2
+
+from pyseobnr.eob.utils.containers cimport EOBParams, FluxParams
+
 
 cdef extern from "complex.h":
     double cabs(double complex z)
     double creal(double complex z)
     double complex cexp(double complex z)
     double carg(double complex z)
     double complex I
@@ -125,17 +132,14 @@
         355687428096000,
         6402373705728000,
         121645100408832000,
         2432902008176640000,
     ]
 
 
-
-
-
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.profile(True)
 @cython.linetrace(True)
 cpdef double complex calculate_multipole_prefix(double m1, double m2, int l, int m):
     """
@@ -160,23 +164,26 @@
         sign = 1
     else:
         sign = -1
 
     #
     # Eq. 7 of Damour, Iyer and Nagar 2008.
     # For odd m, c is proportional to dM = m1-m2. In the equal-mass case, c = dM = 0.
-    # In the equal-mass unequal-spin case, however, when spins are different, the odd m term is generally not zero.
-    # In this case, c can be written as c0 * dM, while spins terms in PN expansion may take the form chiA/dM.
-    # Although the dM's cancel analytically, we can not implement c and chiA/dM with the possibility of dM -> 0.
-    # Therefore, for this case, we give numerical values of c0 for relevant modes, and c0 is calculated as
-    # c / dM in the limit of dM -> 0. Consistently, for this case, we implement chiA instead of chiA/dM
-    # below.
-    # Note that for equal masses and odd m modes we currently only have non-zero c up to l=5. If new spinning terms
-    # are added to modes above l=5 this will need to be revisited.
-    cdef double c,mult1,mult2
+    # In the equal-mass unequal-spin case, however, when spins are different, the odd m term
+    # is generally not zero.
+    # In this case, c can be written as c0 * dM, while spins terms in PN expansion may take
+    # the form chiA/dM.
+    # Although the dM's cancel analytically, we can not implement c and chiA/dM with the
+    # possibility of dM -> 0.
+    # Therefore, for this case, we give numerical values of c0 for relevant modes, and
+    # c0 is calculated as c / dM in the limit of dM -> 0. Consistently, for this case, we
+    # implement chiA instead of chiA/dM below.
+    # Note that for equal masses and odd m modes we currently only have non-zero c up to l=5.
+    # If new spinning terms are added to modes above l=5 this will need to be revisited.
+    cdef double c, mult1, mult2
     if m1 != m2 or sign == 1:
         c = pow(x2, l + epsilon - 1) + sign * pow(x1, l + epsilon - 1)
 
     else:
         if l == 2:
             c = -1.0
         elif l == 3:
@@ -234,80 +241,99 @@
             prefixes[i][j]=0.0
 
     for l in range(2, ell_max + 1):
         for m in range(1, l + 1):
             prefixes[l][m] = calculate_multipole_prefix(m1, m2, l, m)
     return prefixes
 
+
 @cython.cpow(True)
 @cython.boundscheck(False)
 @cython.wraparound(False)
 @cython.cdivision(True)
-cpdef double evaluate_nqc_correction_flux(double r, double pr,  double omega, double[:] coeffs):
+cpdef double evaluate_nqc_correction_flux(
+    double r,
+    double pr,
+    double omega,
+    double[:] coeffs
+):
     """
     Calculate the NQC amplitude correction.
 
     See Eq. 35 in [SEOBNRv5HM-notes]_.
     """
     cdef double sqrtR = sqrt(r)
     cdef double rOmega = r * omega
     cdef double rOmegaSq = rOmega * rOmega
     cdef double p = pr
     cdef double mag = 1.0 + (p * p / rOmegaSq) * (
         coeffs[0]
         + coeffs[1] / r
-        + coeffs[2]  / (r * sqrtR)
+        + coeffs[2] / (r * sqrtR)
     )
     return mag
 
+
 @cython.cpow(True)
 @cython.boundscheck(False)
 @cython.wraparound(False)
 @cython.cdivision(True)
-cpdef compute_tail(double omega, double H, double[:,:] Tlm):
+cpdef compute_tail(
+    double omega,
+    double H,
+    double[:, :] Tlm
+):
     """
     Calculate the resummed Tail effects.
 
     See
 
     * Eq. 32 in [SEOBNRv5HM-notes]_,
     * Sec. 2B of [Damour2009]_,
     * and Eq. (42) of [Damour2013]_.
     """
-    cdef int m,j
-    cdef double k, hathatk,hathatksq4,hathatk4pi,z2
+    cdef int m, j
+    cdef double k, hathatk, hathatksq4, hathatk4pi, z2
     cdef double tlmprod_fac = 1.0
     cdef double tlmprefac
 
-    for m in range(1,ell_max+1):
+    for m in range(1, ell_max+1):
         k = m*omega
         hathatk = H*k
         hathatksq4 = 4.0 * hathatk * hathatk
         hathatk4pi = 4.0 * pi * hathatk
         tlmprod_fac = 1.0
         tlmprefac = sqrt(hathatk4pi / (1.0 - exp(-hathatk4pi)))
 
-        for j in range(1,ell_max+1):
+        for j in range(1, ell_max+1):
             z2 = LOOKUP_TABLE[j]
             tlmprod_fac*= hathatksq4 + j**2
             if m>j:
                 continue
             Tlm[j][m] = tlmprefac*sqrt(tlmprod_fac)/z2
 
 
-
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
-cpdef void compute_rho_coeffs(double nu,double dm, double a,double chiS,double chiA,
-    double[:,:,:] rho_coeffs,double[:,:,:] rho_coeffs_log, double[:,:,:] f_coeffs,
-    double complex[:,:,:] f_coeffs_vh, bint extra_PN_terms):
+cpdef void compute_rho_coeffs(
+    double nu,
+    double dm,
+    double a,
+    double chiS,
+    double chiA,
+    double[:, :, :] rho_coeffs,
+    double[:, :, :] rho_coeffs_log,
+    double[:, :, :] f_coeffs,
+    double complex[:, :, :] f_coeffs_vh,
+    bint extra_PN_terms
+):
 
     """
     Compute the amplitude residual coefficients.
 
     See Sec. 2C and 2D of [Damour2009]_ and Eq. 59-63 of [SEOBNRv5HM-theory]_ for new
     terms.
     The rest has been copied from SEOBNRv4HM LAL code.
@@ -335,125 +361,124 @@
     cdef double chiS3 = chiS2 * chiS
 
     cdef double m1Plus3nu = -1.0 + 3.0 * nu
     cdef double m1Plus3nu2 = m1Plus3nu * m1Plus3nu
     cdef double m1Plus3nu3 = m1Plus3nu * m1Plus3nu2
 
     # (2,2) mode begins
-    rho_coeffs[2,2][2] = -43.0 / 42.0 + (55.0 * nu) / 84.0
-    rho_coeffs[2,2][3]  = (-2.0 * (chiS + chiA * dm - chiS * nu)) / 3.0
+    rho_coeffs[2, 2][2] = -43.0 / 42.0 + (55.0 * nu) / 84.0
+    rho_coeffs[2, 2][3] = (-2.0 * (chiS + chiA * dm - chiS * nu)) / 3.0
 
-    rho_coeffs[2,2][4]  = (
+    rho_coeffs[2, 2][4] = (
         -20555.0 / 10584.0
         + 0.5 * (chiS + chiA * dm) * (chiS + chiA * dm)
         - (33025.0 * nu) / 21168.0
         + (19583.0 * nu2) / 42336.0
     )
 
-    rho_coeffs[2,2][5]  = (
+    rho_coeffs[2, 2][5] = (
         -34.0 / 21.0 + 49.0 * nu / 18.0 + 209.0 * nu2 / 126.0
     ) * chiS + (-34.0 / 21.0 - 19.0 * nu / 42.0) * dm * chiA
 
-    rho_coeffs[2,2][6]  = (
+    rho_coeffs[2, 2][6] = (
         1556919113.0 / 122245200.0
         + (89.0 * a2) / 252.0
         - (48993925.0 * nu) / 9779616.0
         - (6292061.0 * nu2) / 3259872.0
         + (10620745.0 * nu3) / 39118464.0
         + (41.0 * nu * pi * pi) / 192.0
     )
-    rho_coeffs_log[2,2][6] = -428.0 / 105.0
+    rho_coeffs_log[2, 2][6] = -428.0 / 105.0
 
     # See https://dcc.ligo.org/T1600383
-    rho_coeffs[2,2][7]  = (
+    rho_coeffs[2, 2][7] = (
         a3 / 3.0
         + chiA
         * dm
         * (18733.0 / 15876.0 + (50140.0 * nu) / 3969.0 + (97865.0 * nu2) / 63504.0)
         + chiS
         * (
             18733.0 / 15876.0
             + (74749.0 * nu) / 5292.0
             - (245717.0 * nu2) / 63504.0
             + (50803.0 * nu3) / 63504.0
         )
     )
 
-    rho_coeffs[2,2][8]  = (
+    rho_coeffs[2, 2][8] = (
         -387216563023.0 / 160190110080.0 +
-            (18353.0 * a2) / 21168.0 - a2 * a2 / 8.0
+        (18353.0 * a2) / 21168.0 - a2 * a2 / 8.0
     )
 
-    rho_coeffs_log[2,2][8] = 9202.0 / 2205.0
-    rho_coeffs[2,2][10]  = -16094530514677.0 / 533967033600.0
-    rho_coeffs_log[2,2][10] = 439877.0 / 55566.0
+    rho_coeffs_log[2, 2][8] = 9202.0 / 2205.0
+    rho_coeffs[2, 2][10] = -16094530514677.0 / 533967033600.0
+    rho_coeffs_log[2, 2][10] = 439877.0 / 55566.0
     # (2,2) mode ends
 
     # We set test-spin terms to 0 (as in SEOBNRv4HM)
     # as no major improvement was found when trying to include them
     a = 0.0
     a2 = 0.0
     a3 = 0.0
     # (2,1) mode begins
     if dm2:
-        rho_coeffs[2,1][1] = 0.0
-        rho_coeffs[2,1][2] = -59.0 / 56 + (23.0 * nu) / 84.0
-        rho_coeffs[2,1][3] = 0.0
+        rho_coeffs[2, 1][1] = 0.0
+        rho_coeffs[2, 1][2] = -59.0 / 56 + (23.0 * nu) / 84.0
+        rho_coeffs[2, 1][3] = 0.0
 
-        rho_coeffs[2,1][4] = (
+        rho_coeffs[2, 1][4] = (
             -47009.0 / 56448.0
             - (865.0 * a2) / 1792.0
             - (405.0 * a2 * a2) / 2048.0
             - (10993.0 * nu) / 14112.0
             + (617.0 * nu2) / 4704.0
         )
-        rho_coeffs[2,1][5] = (
+        rho_coeffs[2, 1][5] = (
             (-98635.0 * a) / 75264.0
             + (2031.0 * a * a2) / 7168.0
             - (1701.0 * a2 * a3) / 8192.0
         )
-        rho_coeffs[2,1][6] = (
+        rho_coeffs[2, 1][6] = (
             7613184941.0 / 2607897600.0
             + (9032393.0 * a2) / 1806336.0
             + (3897.0 * a2 * a2) / 16384.0
             - (15309.0 * a3 * a3) / 65536.0
         )
-        rho_coeffs_log[2,1][6] = -107.0 / 105.0
-        rho_coeffs[2,1][7] = (
+        rho_coeffs_log[2, 1][6] = -107.0 / 105.0
+        rho_coeffs[2, 1][7] = (
             (-3859374457.0 * a) / 1159065600.0
             - (55169.0 * a3) / 16384.0
             + (18603.0 * a2 * a3) / 65536.0
             - (72171.0 * a2 * a2 * a3) / 262144.0
         )
-        rho_coeffs_log[2,1][7] = 107.0 * a / 140.0
-        rho_coeffs[2,1][8] = -1168617463883.0 / 911303737344.0
-        rho_coeffs_log[2,1][8] = 6313.0 / 5880.0
-        rho_coeffs[2,1][10] = -63735873771463.0 / 16569158860800.0
-        rho_coeffs_log[2,1][10] = 5029963.0 / 5927040.0
+        rho_coeffs_log[2, 1][7] = 107.0 * a / 140.0
+        rho_coeffs[2, 1][8] = -1168617463883.0 / 911303737344.0
+        rho_coeffs_log[2, 1][8] = 6313.0 / 5880.0
+        rho_coeffs[2, 1][10] = -63735873771463.0 / 16569158860800.0
+        rho_coeffs_log[2, 1][10] = 5029963.0 / 5927040.0
 
-        f_coeffs[2,1][1] = (-3.0 * (chiS + chiA / dm)) / (2.0)
+        f_coeffs[2, 1][1] = (-3.0 * (chiS + chiA / dm)) / (2.0)
 
-        f_coeffs[2,1][3] = (
+        f_coeffs[2, 1][3] = (
             (
                 chiS * dm * (427.0 + 79.0 * nu)
                 + chiA * (147.0 + 280.0 * dm * dm + 1251.0 * nu)
             )
             / 84.0
             / dm
         )
         # RC: New terms for SEOBNRv4HM, they are put to zero if use_hm == 0
 
-
         # RC: This terms are in Eq.A11 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
-        f_coeffs[2,1][4] = (
+        f_coeffs[2, 1][4] = (
             (-3.0 - 2.0 * nu) * chiA2
             + (-3.0 + nu / 2.0) * chiS2
             + (-6.0 + 21.0 * nu / 2.0) * chiS * chiA / dm
         )
-        f_coeffs[2,1][5] = (
+        f_coeffs[2, 1][5] = (
             (3.0 / 4.0 - 3.0 * nu) * chiA3 / dm
             + (
                 -81.0 / 16.0
                 + 1709.0 * nu / 1008.0
                 + 613.0 * nu2 / 1008.0
                 + (9.0 / 4.0 - 3 * nu) * chiA2
             )
@@ -464,306 +489,300 @@
                 - 703.0 * nu2 / 112.0
                 + 8797.0 * nu / 1008.0
                 + (9.0 / 4.0 - 6.0 * nu) * chiS2
             )
             * chiA
             / dm
         )
-        '''
-        This was in SEOBNRv4HM
-        f_coeffs[2,1][6] = (
-            (4163.0 / 252.0 - 9287.0 * nu /
-                1008.0 - 85.0 * nu2 / 112.0) * chiA2
-            + (4163.0 / 252.0 - 2633.0 * nu / 1008.0 + 461.0 * nu2 / 1008.0)
-            * chiS2
-            + (4163.0 / 126.0 - 1636.0 * nu / 21.0 + 1088.0 * nu2 / 63.0)
-            * chiS
-            * chiA
-            / dm
-        )
-        '''
-        f_coeffs[2,1][6] = (((16652 - 9287*nu + 720*nu**2)*chiA**2)/1008 +
-                            ((16652 - 39264*nu + 9487*nu**2)*chiA*chiS)/(504*dm) +
-                            ((16652 - 2633*nu + 1946*nu**2)*chiS**2)/1008)
+
+        # This was in SEOBNRv4HM
+        # f_coeffs[2,1][6] = (
+        #     (4163.0 / 252.0 - 9287.0 * nu /
+        #         1008.0 - 85.0 * nu2 / 112.0) * chiA2
+        #     + (4163.0 / 252.0 - 2633.0 * nu / 1008.0 + 461.0 * nu2 / 1008.0)
+        #     * chiS2
+        #     + (4163.0 / 126.0 - 1636.0 * nu / 21.0 + 1088.0 * nu2 / 63.0)
+        #     * chiS
+        #     * chiA
+        #     / dm
+        # )
+
+        f_coeffs[2, 1][6] = (((16652 - 9287*nu + 720*nu**2)*chiA**2)/1008 +
+                             ((16652 - 39264*nu + 9487*nu**2)*chiA*chiS)/(504*dm) +
+                             ((16652 - 2633*nu + 1946*nu**2)*chiS**2)/1008)
     else:
-        f_coeffs[2,1][1] = -3.0 * chiA / 2.0
-        f_coeffs[2,1][3] = (
+        f_coeffs[2, 1][1] = -3.0 * chiA / 2.0
+        f_coeffs[2, 1][3] = (
             chiS * dm * (427.0 + 79.0 * nu)
             + chiA * (147.0 + 280.0 * dm * dm + 1251.0 * nu)
         ) / 84.0
         # New terms for SEOBNRv4HM, they are put to zero if use_hm == 0
 
         # RC: This terms are in Eq.A11 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
-        f_coeffs[2,1][4] = (-6 + 21 * nu / 2.0) * chiS * chiA
-        f_coeffs[2,1][5] = (3.0 / 4.0 - 3.0 * nu) * chiA3 + (
+        f_coeffs[2, 1][4] = (-6 + 21 * nu / 2.0) * chiS * chiA
+        f_coeffs[2, 1][5] = (3.0 / 4.0 - 3.0 * nu) * chiA3 + (
             -81.0 / 16.0
             - 703.0 * nu2 / 112.0
             + 8797.0 * nu / 1008.0
             + (9.0 / 4.0 - 6.0 * nu) * chiS2
         ) * chiA
-        '''
-        This was in SEOBNRv4HM
-        f_coeffs[2,1][6] = (
-            (4163.0 / 126.0 - 1636.0 * nu / 21.0 + 1088.0 * nu2 / 63.0)
-            * chiS
-            * chiA
-        )
-        '''
-        f_coeffs[2,1][6] = ((16652 - 39264*nu + 9487*nu**2)*chiA*chiS)/504
+
+        # This was in SEOBNRv4HM
+        # f_coeffs[2,1][6] = (
+        #     (4163.0 / 126.0 - 1636.0 * nu / 21.0 + 1088.0 * nu2 / 63.0)
+        #     * chiS
+        #     * chiA
+        # )
+        f_coeffs[2, 1][6] = ((16652 - 39264*nu + 9487*nu**2)*chiA*chiS)/504
 
     # (2,1) mode ends
 
     # (3,3) mode begins
 
     if dm2:
-        rho_coeffs[3,3][2] = -7.0 / 6.0 + (2.0 * nu) / 3.0
-        rho_coeffs[3,3][3] = 0.0
-        rho_coeffs[3,3][4] = (
+        rho_coeffs[3, 3][2] = -7.0 / 6.0 + (2.0 * nu) / 3.0
+        rho_coeffs[3, 3][3] = 0.0
+        rho_coeffs[3, 3][4] = (
             -6719.0 / 3960.0
             + a2 / 2.0
             - (1861.0 * nu) / 990.0
             + (149.0 * nu2) / 330.0
         )
-        rho_coeffs[3,3][5] = (-4.0 * a) / 3.0
-        rho_coeffs[3,3][6] = (
+        rho_coeffs[3, 3][5] = (-4.0 * a) / 3.0
+        rho_coeffs[3, 3][6] = (
                 3203101567.0 / 227026800.0
                 + (5.0 * a2) / 36.0
                 + (-129509.0 / 25740.0 + 41.0 / 192.0 * pi * pi) * nu
                 - 274621.0 / 154440.0 * nu2
                 + 12011.0 / 46332.0 * nu3
             )
-        rho_coeffs_log[3,3][6] = -26.0 / 7.0
-        rho_coeffs[3,3][7] = (5297.0 * a) / 2970.0 + a * a2 / 3.0
-        rho_coeffs[3,3][8] = -57566572157.0 / 8562153600.0
-        rho_coeffs_log[3,3][8] = 13.0 / 3.0
+        rho_coeffs_log[3, 3][6] = -26.0 / 7.0
+        rho_coeffs[3, 3][7] = (5297.0 * a) / 2970.0 + a * a2 / 3.0
+        rho_coeffs[3, 3][8] = -57566572157.0 / 8562153600.0
+        rho_coeffs_log[3, 3][8] = 13.0 / 3.0
 
+        rho_coeffs[3, 3][10] = -903823148417327.0 / 30566888352000.0
+        rho_coeffs_log[3, 3][10] = 87347.0 / 13860.0
 
-        rho_coeffs[3,3][10] = -903823148417327.0 / 30566888352000.0
-        rho_coeffs_log[3,3][10] = 87347.0 / 13860.0
-
-        f_coeffs[3,3][3]= (
+        f_coeffs[3, 3][3]= (
             chiS * dm * (-4.0 + 5.0 * nu) + chiA * (-4.0 + 19.0 * nu)
         ) / (2.0 * dm)
 
-        f_coeffs[3,3][4]= (
+        f_coeffs[3, 3][4]= (
             3.0 / 2.0 * chiS2 * dm
             + (3.0 - 12 * nu) * chiA * chiS
             + dm * (3.0 / 2.0 - 6.0 * nu) * chiA2
         ) / (dm)
-        f_coeffs[3,3][5] = (
+        f_coeffs[3, 3][5] = (
             dm * (241.0 / 30.0 * nu2 + 11.0 /
-                    20.0 * nu + 2.0 / 3.0) * chiS
+                  20.0 * nu + 2.0 / 3.0) * chiS
             + (407.0 / 30.0 * nu2 - 593.0 / 60.0 * nu + 2.0 / 3.0) * chiA
         ) / (dm)
-        f_coeffs[3,3][6] = (
+        f_coeffs[3, 3][6] = (
             dm * (6.0 * nu2 - 27.0 / 2.0 * nu - 7.0 / 4.0) * chiS2
             + (44.0 * nu2 - 1.0 * nu - 7.0 / 2.0) * chiA * chiS
             + dm * (-12 * nu2 + 11.0 / 2.0 * nu - 7.0 / 4.0) * chiA2
         ) / dm
-        f_coeffs_vh[3,3][6] =  (
+        f_coeffs_vh[3, 3][6] = (
                 dm * (593.0 / 108.0 * nu - 81.0 / 20.0) * chiS
                 + (7339.0 / 540.0 * nu - 81.0 / 20.0) * chiA
             ) / (dm)
 
     else:
-        f_coeffs[3,3][3] = chiA * 3.0 / 8.0
+        f_coeffs[3, 3][3] = chiA * 3.0 / 8.0
 
         # RC: This terms are in Eq.A10 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
-        f_coeffs[3,3][4] = (3.0 - 12 * nu) * chiA * chiS
-        f_coeffs[3,3][5] = (
+        f_coeffs[3, 3][4] = (3.0 - 12 * nu) * chiA * chiS
+        f_coeffs[3, 3][5] = (
             407.0 / 30.0 * nu2 - 593.0 / 60.0 * nu + 2.0 / 3.0
         ) * chiA
-        f_coeffs[3,3][6] = (44.0 * nu2 - 1.0 * nu - 7.0 / 2.0) * chiA * chiS
-        f_coeffs_vh[3,3][6] = (7339.0 / 540.0 * nu - 81.0 / 20.0) * chiA
+        f_coeffs[3, 3][6] = (44.0 * nu2 - 1.0 * nu - 7.0 / 2.0) * chiA * chiS
+        f_coeffs_vh[3, 3][6] = (7339.0 / 540.0 * nu - 81.0 / 20.0) * chiA
 
     # (3,3) mode ends
 
     # (3,2) mode begins
-    rho_coeffs[3,2][1] = (4.0 * chiS * nu) / (-3.0 * m1Plus3nu)
-    rho_coeffs[3,2][2] = (328.0 - 1115.0 * nu + 320.0 *
-                      nu2) / (270.0 * m1Plus3nu)
+    rho_coeffs[3, 2][1] = (4.0 * chiS * nu) / (-3.0 * m1Plus3nu)
+    rho_coeffs[3, 2][2] = (328.0 - 1115.0 * nu + 320.0 *
+                           nu2) / (270.0 * m1Plus3nu)
 
-    rho_coeffs[3,2][3] = (
+    rho_coeffs[3, 2][3] = (
         2.0
         * (
             45.0 * a * m1Plus3nu3
             - a
             * nu
             * (328.0 - 2099.0 * nu + 5.0 * (733.0 + 20.0 * a2) * nu2 - 960.0 * nu3)
         )
     ) / (405.0 * m1Plus3nu3)
 
-    rho_coeffs[3,2][4] = a2 / 3.0 + (
+    rho_coeffs[3, 2][4] = a2 / 3.0 + (
         -1444528.0
         + 8050045.0 * nu
         - 4725605.0 * nu2
         - 20338960.0 * nu3
         + 3085640.0 * nu2 * nu2
     ) / (1603800.0 * m1Plus3nu2)
-    rho_coeffs[3,2][5] = (-2788.0 * a) / 1215.0
-    rho_coeffs[3,2][6] = 5849948554.0 / 940355325.0 + (488.0 * a2) / 405.0
-    rho_coeffs_log[3,2][6] = -104.0 / 63.0
-    rho_coeffs[3,2][8] = -10607269449358.0 / 3072140846775.0
-    rho_coeffs_log[3,2][8] = 17056.0 / 8505.0
+    rho_coeffs[3, 2][5] = (-2788.0 * a) / 1215.0
+    rho_coeffs[3, 2][6] = 5849948554.0 / 940355325.0 + (488.0 * a2) / 405.0
+    rho_coeffs_log[3, 2][6] = -104.0 / 63.0
+    rho_coeffs[3, 2][8] = -10607269449358.0 / 3072140846775.0
+    rho_coeffs_log[3, 2][8] = 17056.0 / 8505.0
     # (3,2) mode ends
 
     # (3,1) mode begins
     if dm2:
 
-        rho_coeffs[3,1][2] = -13.0 / 18.0 - (2.0 * nu) / 9.0
-        rho_coeffs[3,1][3] = 0.0
-        rho_coeffs[3,1][4] = (
+        rho_coeffs[3, 1][2] = -13.0 / 18.0 - (2.0 * nu) / 9.0
+        rho_coeffs[3, 1][3] = 0.0
+        rho_coeffs[3, 1][4] = (
             101.0 / 7128.0
             - (5.0 * a2) / 6.0
             - (1685.0 * nu) / 1782.0
             - (829.0 * nu2) / 1782.0
         )
-        rho_coeffs[3,1][5] = (4.0 * a) / 9.0
-        rho_coeffs[3,1][6] = 11706720301.0 / 6129723600.0 - (49.0 * a2) / 108.0
-        rho_coeffs_log[3,1][6] = -26.0 / 63.0
-        rho_coeffs[3,1][7] = (-2579.0 * a) / 5346.0 + a * a2 / 9.0
-        rho_coeffs[3,1][8] = 2606097992581.0 / 4854741091200.0
-        rho_coeffs_log[3,1][8] = 169.0 / 567.0
+        rho_coeffs[3, 1][5] = (4.0 * a) / 9.0
+        rho_coeffs[3, 1][6] = 11706720301.0 / 6129723600.0 - (49.0 * a2) / 108.0
+        rho_coeffs_log[3, 1][6] = -26.0 / 63.0
+        rho_coeffs[3, 1][7] = (-2579.0 * a) / 5346.0 + a * a2 / 9.0
+        rho_coeffs[3, 1][8] = 2606097992581.0 / 4854741091200.0
+        rho_coeffs_log[3, 1][8] = 169.0 / 567.0
 
-        f_coeffs[3,1][3] = (
+        f_coeffs[3, 1][3] = (
             chiA * (-4.0 + 11.0 * nu) + chiS * dm * (-4.0 + 13.0 * nu)
         ) / (2.0 * dm)
 
     else:
-        f_coeffs[3,1][3]= -chiA * 5.0 / 8.0
+        f_coeffs[3, 1][3]= -chiA * 5.0 / 8.0
     # (3,1) mode ends
 
     # (4,4) mode begins
-    rho_coeffs[4,4][2] = (1614.0 - 5870.0 * nu + 2625.0 *
-                      nu2) / (1320.0 * m1Plus3nu)
-    rho_coeffs[4,4][3] = (
-        chiA * (10.0 - 39.0 * nu) * dm + chiS *
-                (10.0 - 41.0 * nu + 42.0 * nu2)
+    rho_coeffs[4, 4][2] = (1614.0 - 5870.0 * nu + 2625.0 * nu2) / (1320.0 * m1Plus3nu)
+    rho_coeffs[4, 4][3] = (
+        chiA * (10.0 - 39.0 * nu) * dm
+        + chiS * (10.0 - 41.0 * nu + 42.0 * nu2)
     ) / (15.0 * m1Plus3nu)
 
     # RC: This terms are in Eq.A8 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
-    rho_coeffs[4,4][4] = (
+    rho_coeffs[4, 4][4] = (
         (
             -511573572.0
             + 2338945704.0 * nu
             - 313857376.0 * nu2
             - 6733146000.0 * nu3
             + 1252563795.0 * nu2 * nu2
         )
         / (317116800.0 * m1Plus3nu2)
         + chiS2 / 2.0
         + dm * chiS * chiA
         + dm2 * chiA2 / 2.0
     )
-    rho_coeffs[4,4][5] = chiA * dm * (
+    rho_coeffs[4, 4][5] = chiA * dm * (
         -8280.0 + 42716.0 * nu - 57990.0 * nu2 + 8955 * nu3
     ) / (6600.0 * m1Plus3nu2) + chiS * (
         -8280.0
         + 66284.0 * nu
         - 176418.0 * nu2
         + 128085.0 * nu3
         + 88650 * nu2 * nu2
     ) / (
         6600.0 * m1Plus3nu2
     )
-    rho_coeffs[4,4][8] = -172066910136202271.0 / 19426955708160000.0
-    rho_coeffs_log[4,4][8] = 845198.0 / 190575.0
-    rho_coeffs[4,4][10] = -17154485653213713419357.0 / 568432724020761600000.0
-    rho_coeffs_log[4,4][10] = 22324502267.0 / 3815311500.0
+    rho_coeffs[4, 4][8] = -172066910136202271.0 / 19426955708160000.0
+    rho_coeffs_log[4, 4][8] = 845198.0 / 190575.0
+    rho_coeffs[4, 4][10] = -17154485653213713419357.0 / 568432724020761600000.0
+    rho_coeffs_log[4, 4][10] = 22324502267.0 / 3815311500.0
 
-    rho_coeffs[4,4][6] = 16600939332793.0 / 1098809712000.0 + (217.0 * a2) / 3960.0
-    rho_coeffs_log[4,4][6] = -12568.0 / 3465.0
+    rho_coeffs[4, 4][6] = 16600939332793.0 / 1098809712000.0 + (217.0 * a2) / 3960.0
+    rho_coeffs_log[4, 4][6] = -12568.0 / 3465.0
     # (4,4) mode ends
     # (4,3) mode begins
     if dm2:
-        rho_coeffs[4,3][1] = 0.0
-        rho_coeffs[4,3][2] = (222.0 - 547.0 * nu + 160.0 * nu2) / (
+        rho_coeffs[4, 3][1] = 0.0
+        rho_coeffs[4, 3][2] = (222.0 - 547.0 * nu + 160.0 * nu2) / (
             176.0 * (-1.0 + 2.0 * nu)
         )
-        rho_coeffs[4,3][4] = -6894273.0 / 7047040.0 + (3.0 * a2) / 8.0
-        rho_coeffs[4,3][5] = (-12113.0 * a) / 6160.0
-        rho_coeffs[4,3][6] = 1664224207351.0 / 195343948800.0
-        rho_coeffs_log[4,3][6] = -1571.0 / 770.0
-        f_coeffs[4,3][1] = (5.0 * (chiA - chiS * dm) * nu) / (
+        rho_coeffs[4, 3][4] = -6894273.0 / 7047040.0 + (3.0 * a2) / 8.0
+        rho_coeffs[4, 3][5] = (-12113.0 * a) / 6160.0
+        rho_coeffs[4, 3][6] = 1664224207351.0 / 195343948800.0
+        rho_coeffs_log[4, 3][6] = -1571.0 / 770.0
+        f_coeffs[4, 3][1] = (5.0 * (chiA - chiS * dm) * nu) / (
             2.0 * dm * (-1.0 + 2.0 * nu)
         )
 
     else:
-        f_coeffs[4,3][1] = -5.0 * chiA / 4.0
+        f_coeffs[4, 3][1] = -5.0 * chiA / 4.0
     # (4,3) mode ends
 
     # (4,2) mode begins
-    rho_coeffs[4,2][2] = (1146.0 - 3530.0 * nu + 285.0 *
-                      nu2) / (1320.0 * m1Plus3nu)
-    rho_coeffs[4,2][3] = (
-        chiA * (10.0 - 21.0 * nu) * dm + chiS *
-                (10.0 - 59.0 * nu + 78.0 * nu2)
+    rho_coeffs[4, 2][2] = (1146.0 - 3530.0 * nu + 285.0 * nu2) / (1320.0 * m1Plus3nu)
+    rho_coeffs[4, 2][3] = (
+        chiA * (10.0 - 21.0 * nu) * dm
+        + chiS * (10.0 - 59.0 * nu + 78.0 * nu2)
     ) / (15.0 * m1Plus3nu)
-    rho_coeffs[4,2][4] = a2 / 2.0 + (
+    rho_coeffs[4, 2][4] = a2 / 2.0 + (
         -114859044.0
         + 295834536.0 * nu
         + 1204388696.0 * nu2
         - 3047981160.0 * nu3
         - 379526805.0 * nu2 * nu2
     ) / (317116800.0 * m1Plus3nu2)
-    rho_coeffs[4,2][5] = (-7.0 * a) / 110.0
-    rho_coeffs[4,2][6] = 848238724511.0 / 219761942400.0 + (2323.0 * a2) / 3960.0
-    rho_coeffs_log[4,2][6] = -3142.0 / 3465.0
+    rho_coeffs[4, 2][5] = (-7.0 * a) / 110.0
+    rho_coeffs[4, 2][6] = 848238724511.0 / 219761942400.0 + (2323.0 * a2) / 3960.0
+    rho_coeffs_log[4, 2][6] = -3142.0 / 3465.0
     # (4,2) mode ends
 
     # (4,1) mode begins
     if dm2:
 
-        rho_coeffs[4,1][1] = 0.0
-        rho_coeffs[4,1][2] = (602.0 - 1385.0 * nu + 288.0 * nu2) / (
+        rho_coeffs[4, 1][1] = 0.0
+        rho_coeffs[4, 1][2] = (602.0 - 1385.0 * nu + 288.0 * nu2) / (
             528.0 * (-1.0 + 2.0 * nu)
         )
-        rho_coeffs[4,1][4] = -7775491.0 / 21141120.0 + (3.0 * a2) / 8.0
-        rho_coeffs[4,1][5] = (-20033.0 * a) / 55440.0 - (5 * a * a2) / 6.0
-        rho_coeffs[4,1][6] = 1227423222031.0 / 1758095539200.0
-        rho_coeffs_log[4,1][6] = -1571.0 / 6930.0
-        f_coeffs[4,1][1] = (5.0 * (chiA - chiS * dm) * nu) / (
+        rho_coeffs[4, 1][4] = -7775491.0 / 21141120.0 + (3.0 * a2) / 8.0
+        rho_coeffs[4, 1][5] = (-20033.0 * a) / 55440.0 - (5 * a * a2) / 6.0
+        rho_coeffs[4, 1][6] = 1227423222031.0 / 1758095539200.0
+        rho_coeffs_log[4, 1][6] = -1571.0 / 6930.0
+        f_coeffs[4, 1][1] = (5.0 * (chiA - chiS * dm) * nu) / (
             2.0 * dm * (-1.0 + 2.0 * nu)
         )
 
     else:
-        f_coeffs[4,1][1] = -5.0 * chiA / 4.0
+        f_coeffs[4, 1][1] = -5.0 * chiA / 4.0
 
     # (4,1) mode ends
 
     # (5,5) mode begins
     if dm2:
 
-        rho_coeffs[5,5][2] = (487.0 - 1298.0 * nu + 512.0 * nu2) / (
+        rho_coeffs[5, 5][2] = (487.0 - 1298.0 * nu + 512.0 * nu2) / (
             390.0 * (-1.0 + 2.0 * nu)
         )
-        rho_coeffs[5,5][3] = (-2.0 * a) / 3.0
-        rho_coeffs[5,5][4] = -3353747.0 / 2129400.0 + a2 / 2.0
-        rho_coeffs[5,5][5] = -241.0 * a / 195.0
-
-
+        rho_coeffs[5, 5][3] = (-2.0 * a) / 3.0
+        rho_coeffs[5, 5][4] = -3353747.0 / 2129400.0 + a2 / 2.0
+        rho_coeffs[5, 5][5] = -241.0 * a / 195.0
 
         # RC: This terms are in Eq.A9 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
-        rho_coeffs[5,5][6] = 190606537999247.0 / 11957879934000.0
-        rho_coeffs_log[5,5][6] = -1546.0 / 429.0
-        rho_coeffs[5,5][8] = -1213641959949291437.0 / 118143853747920000.0
-        rho_coeffs_log[5,5][8] = 376451.0 / 83655.0
-        rho_coeffs[5,5][10] = -150082616449726042201261.0 / 4837990810977324000000.0
-        rho_coeffs_log[5,5][10] = 2592446431.0 / 456756300.0
+        rho_coeffs[5, 5][6] = 190606537999247.0 / 11957879934000.0
+        rho_coeffs_log[5, 5][6] = -1546.0 / 429.0
+        rho_coeffs[5, 5][8] = -1213641959949291437.0 / 118143853747920000.0
+        rho_coeffs_log[5, 5][8] = 376451.0 / 83655.0
+        rho_coeffs[5, 5][10] = -150082616449726042201261.0 / 4837990810977324000000.0
+        rho_coeffs_log[5, 5][10] = 2592446431.0 / 456756300.0
 
-        f_coeffs[5,5][3] = chiA / dm * (
+        f_coeffs[5, 5][3] = chiA / dm * (
             10.0 / (3.0 * (-1.0 + 2.0 * nu))
             - 70.0 * nu / (3.0 * (-1.0 + 2.0 * nu))
             + 110.0 * nu2 / (3.0 * (-1.0 + 2.0 * nu))
         ) + chiS * (
             10.0 / (3.0 * (-1.0 + 2.0 * nu))
             - 10.0 * nu / (-1.0 + 2.0 * nu)
             + 10 * nu2 / (-1.0 + 2.0 * nu)
         )
-        f_coeffs[5,5][4] = (
+        f_coeffs[5, 5][4] = (
             chiS2
             * (-5.0 / (2.0 * (-1.0 + 2.0 * nu)) + 5.0 * nu / (-1.0 + 2.0 * nu))
             + chiA
             * chiS
             / dm
             * (
                 -5.0 / (-1.0 + 2.0 * nu)
@@ -777,210 +796,210 @@
                 - 20.0 * nu2 / (-1.0 + 2.0 * nu)
             )
         )
 
     else:
 
         # RC: This terms are in Eq.A12 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
-        f_coeffs[5,5][3] = chiA * (
+        f_coeffs[5, 5][3] = chiA * (
             10.0 / (3.0 * (-1.0 + 2.0 * nu))
             - 70.0 * nu / (3.0 * (-1.0 + 2.0 * nu))
             + 110.0 * nu2 / (3.0 * (-1.0 + 2.0 * nu))
         )
-        f_coeffs[5,5][4] = (
+        f_coeffs[5, 5][4] = (
             chiA
             * chiS
             * (
                 -5.0 / (-1.0 + 2.0 * nu)
                 + 30.0 * nu / (-1.0 + 2.0 * nu)
                 - 40.0 * nu2 / (-1.0 + 2.0 * nu)
             )
         )
     # (5,5) mode ends
 
     # (5,4) mode begins
-    rho_coeffs[5,4][2] = (
+    rho_coeffs[5, 4][2] = (
         -17448.0 + 96019.0 * nu - 127610.0 * nu2 + 33320.0 * nu3
     ) / (13650.0 * (1.0 - 5.0 * nu + 5.0 * nu2))
-    rho_coeffs[5,4][3] = (-2.0 * a) / 15.0
-    rho_coeffs[5,4][4] = -16213384.0 / 15526875.0 + (2.0 * a2) / 5.0
+    rho_coeffs[5, 4][3] = (-2.0 * a) / 15.0
+    rho_coeffs[5, 4][4] = -16213384.0 / 15526875.0 + (2.0 * a2) / 5.0
     # (5,4) mode ends
 
     # (5,3)  mode begins
     if dm2:
 
-        rho_coeffs[5,3][2] = (375.0 - 850.0 * nu + 176.0 * nu2) / (
+        rho_coeffs[5, 3][2] = (375.0 - 850.0 * nu + 176.0 * nu2) / (
             390.0 * (-1.0 + 2.0 * nu)
         )
-        rho_coeffs[5,3][3] = (-2.0 * a) / 3.0
-        rho_coeffs[5,3][4] = -410833.0 / 709800.0 + a2 / 2.0
-        rho_coeffs[5,3][5] = -103.0 * a / 325.0
+        rho_coeffs[5, 3][3] = (-2.0 * a) / 3.0
+        rho_coeffs[5, 3][4] = -410833.0 / 709800.0 + a2 / 2.0
+        rho_coeffs[5, 3][5] = -103.0 * a / 325.0
     # (5,3) mode ends
 
     # (5,2) mode begins
-    rho_coeffs[5,2][2] = (
+    rho_coeffs[5, 2][2] = (
         -15828.0 + 84679.0 * nu - 104930.0 * nu2 + 21980.0 * nu3
     ) / (13650.0 * (1.0 - 5.0 * nu + 5.0 * nu2))
-    rho_coeffs[5,2][3] = (-2.0 * a) / 15.0
-    rho_coeffs[5,2][4] = -7187914.0 / 15526875.0 + (2.0 * a2) / 5.0
+    rho_coeffs[5, 2][3] = (-2.0 * a) / 15.0
+    rho_coeffs[5, 2][4] = -7187914.0 / 15526875.0 + (2.0 * a2) / 5.0
     # (5,2) mode ends
 
     # (5,1) mode begins
     if dm2:
-        rho_coeffs[5,1][2] = (319.0 - 626.0 * nu + 8.0 * nu2) / (
+        rho_coeffs[5, 1][2] = (319.0 - 626.0 * nu + 8.0 * nu2) / (
             390.0 * (-1.0 + 2.0 * nu)
         )
-        rho_coeffs[5,1][3] = (-2.0 * a) / 3.0
-        rho_coeffs[5,1][4] = -31877.0 / 304200.0 + a2 / 2.0
-        rho_coeffs[5,1][5] = 139.0 * a / 975.0
+        rho_coeffs[5, 1][3] = (-2.0 * a) / 3.0
+        rho_coeffs[5, 1][4] = -31877.0 / 304200.0 + a2 / 2.0
+        rho_coeffs[5, 1][5] = 139.0 * a / 975.0
     # (5,1) mode ends
 
     # (6,6) mode begins
-    rho_coeffs[6,6][2] = (-106.0 + 602.0 * nu - 861.0 * nu2 + 273.0 * nu3) / (
+    rho_coeffs[6, 6][2] = (-106.0 + 602.0 * nu - 861.0 * nu2 + 273.0 * nu3) / (
         84.0 * (1.0 - 5.0 * nu + 5.0 * nu2)
     )
-    rho_coeffs[6,6][3] = (-2.0 * a) / 3.0
-    rho_coeffs[6,6][4] = -1025435.0 / 659736.0 + a2 / 2.0
+    rho_coeffs[6, 6][3] = (-2.0 * a) / 3.0
+    rho_coeffs[6, 6][4] = -1025435.0 / 659736.0 + a2 / 2.0
     # (6,6) mode ends
 
     # (6,5) mode begins
     if dm2:
-        rho_coeffs[6,5][2] = (-185.0 + 838.0 * nu - 910.0 * nu2 + 220.0 * nu3) / (
+        rho_coeffs[6, 5][2] = (-185.0 + 838.0 * nu - 910.0 * nu2 + 220.0 * nu3) / (
             144.0 * (dm2 + 3.0 * nu2)
         )
-        rho_coeffs[6,5][3] = -2.0 * a / 9.0
+        rho_coeffs[6, 5][3] = -2.0 * a / 9.0
     # (6,5) mode ends
 
     # (6,4) mode begins
-    rho_coeffs[6,4][2] = (-86.0 + 462.0 * nu - 581.0 * nu2 + 133.0 * nu3) / (
+    rho_coeffs[6, 4][2] = (-86.0 + 462.0 * nu - 581.0 * nu2 + 133.0 * nu3) / (
         84.0 * (1.0 - 5.0 * nu + 5.0 * nu2)
     )
-    rho_coeffs[6,4][3] = (-2.0 * a) / 3.0
-    rho_coeffs[6,4][4] = -476887.0 / 659736.0 + a2 / 2.0
+    rho_coeffs[6, 4][3] = (-2.0 * a) / 3.0
+    rho_coeffs[6, 4][4] = -476887.0 / 659736.0 + a2 / 2.0
     # (6,4) mode ends
 
     # (6,3) mode begins
     if dm2:
-        rho_coeffs[6,3][2] = (-169.0 + 742.0 * nu - 750.0 * nu2 + 156.0 * nu3) / (
+        rho_coeffs[6, 3][2] = (-169.0 + 742.0 * nu - 750.0 * nu2 + 156.0 * nu3) / (
             144.0 * (dm2 + 3.0 * nu2)
         )
-        rho_coeffs[6,3][3] = -2.0 * a / 9.0
+        rho_coeffs[6, 3][3] = -2.0 * a / 9.0
     # (6,3) mode ends
 
     # (6,2) mode begins
-    rho_coeffs[6,2][2] = (-74.0 + 378.0 * nu - 413.0 * nu2 + 49.0 * nu3) / (
+    rho_coeffs[6, 2][2] = (-74.0 + 378.0 * nu - 413.0 * nu2 + 49.0 * nu3) / (
         84.0 * (1.0 - 5.0 * nu + 5.0 * nu2)
     )
-    rho_coeffs[6,2][3] = (-2.0 * a) / 3.0
-    rho_coeffs[6,2][4] = -817991.0 / 3298680.0 + a2 / 2.0
+    rho_coeffs[6, 2][3] = (-2.0 * a) / 3.0
+    rho_coeffs[6, 2][4] = -817991.0 / 3298680.0 + a2 / 2.0
     # (6,2) mode ends
 
     # (6,1) mode begins
     if dm2:
-        rho_coeffs[6,1][2] = (-161.0 + 694.0 * nu - 670.0 * nu2 + 124.0 * nu3) / (
+        rho_coeffs[6, 1][2] = (-161.0 + 694.0 * nu - 670.0 * nu2 + 124.0 * nu3) / (
             144.0 * (dm2 + 3.0 * nu2)
         )
-        rho_coeffs[6,1][3] = -2.0 * a / 9.0
+        rho_coeffs[6, 1][3] = -2.0 * a / 9.0
     # (6,1) mode ends
 
     # l=7 modes begin
     if dm2:
 
-        rho_coeffs[7,7][2] = (-906.0 + 4246.0 * nu - 4963.0 * nu2 + 1380.0 * nu3) / (
+        rho_coeffs[7, 7][2] = (-906.0 + 4246.0 * nu - 4963.0 * nu2 + 1380.0 * nu3) / (
             714.0 * (dm2 + 3.0 * nu2)
         )
-        rho_coeffs[7,7][3] = -2.0 * a / 3.0
+        rho_coeffs[7, 7][3] = -2.0 * a / 3.0
 
-    rho_coeffs[7,6][2] = (
+    rho_coeffs[7, 6][2] = (
         2144.0 - 16185.0 * nu + 37828.0 * nu2 - 29351.0 * nu3 + 6104.0 * nu2 * nu2
     ) / (1666.0 * (-1 + 7 * nu - 14 * nu2 + 7 * nu3))
 
     if dm2:
-        rho_coeffs[7,5][2] = (-762.0 + 3382.0 * nu - 3523.0 * nu2 + 804.0 * nu3) / (
+        rho_coeffs[7, 5][2] = (-762.0 + 3382.0 * nu - 3523.0 * nu2 + 804.0 * nu3) / (
             714.0 * (dm2 + 3.0 * nu2)
         )
-        rho_coeffs[7,5][3] = -2.0 * a / 3.0
+        rho_coeffs[7, 5][3] = -2.0 * a / 3.0
 
-    rho_coeffs[7,4][2] = (
+    rho_coeffs[7, 4][2] = (
         17756.0
         - 131805.0 * nu
         + 298872.0 * nu2
         - 217959.0 * nu3
         + 41076.0 * nu2 * nu2
     ) / (14994.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
 
     if dm2:
-        rho_coeffs[7,3][2] = (-666.0 + 2806.0 * nu - 2563.0 * nu2 + 420.0 * nu3) / (
+        rho_coeffs[7, 3][2] = (-666.0 + 2806.0 * nu - 2563.0 * nu2 + 420.0 * nu3) / (
             714.0 * (dm2 + 3.0 * nu2)
         )
-        rho_coeffs[7,3][3] = -2.0 * a / 3.0
+        rho_coeffs[7, 3][3] = -2.0 * a / 3.0
 
-    rho_coeffs[7,2][2] = (
+    rho_coeffs[7, 2][2] = (
         16832.0
         - 123489.0 * nu
         + 273924.0 * nu2
         - 190239.0 * nu3
         + 32760.0 * nu2 * nu2
     ) / (14994.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
 
     if dm2:
-        rho_coeffs[7,1][2] = (-618.0 + 2518.0 * nu - 2083.0 * nu2 + 228.0 * nu3) / (
+        rho_coeffs[7, 1][2] = (-618.0 + 2518.0 * nu - 2083.0 * nu2 + 228.0 * nu3) / (
             714.0 * (dm2 + 3.0 * nu2)
         )
-        rho_coeffs[7,1][3] = -2.0 * a / 3.0
+        rho_coeffs[7, 1][3] = -2.0 * a / 3.0
 
     # l =7 modes end
 
     # l=8 modes begin
-    rho_coeffs[8,8][2] = (
+    rho_coeffs[8, 8][2] = (
         3482.0 - 26778.0 * nu + 64659.0 * nu2 -
-            53445.0 * nu3 + 12243.0 * nu2 * nu2
+        53445.0 * nu3 + 12243.0 * nu2 * nu2
     ) / (2736.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
 
     if dm2:
-        rho_coeffs[8,7][2] = (
+        rho_coeffs[8, 7][2] = (
             23478.0
             - 154099.0 * nu
             + 309498.0 * nu2
             - 207550.0 * nu3
             + 38920 * nu2 * nu2
         ) / (18240.0 * (-1 + 6 * nu - 10 * nu2 + 4 * nu3))
 
-    rho_coeffs[8,6][2] = (
+    rho_coeffs[8, 6][2] = (
         1002.0 - 7498.0 * nu + 17269.0 * nu2 - 13055.0 * nu3 + 2653.0 * nu2 * nu2
     ) / (912.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
 
     if dm2:
-        rho_coeffs[8,5][2] = (
+        rho_coeffs[8, 5][2] = (
             4350.0
             - 28055.0 * nu
             + 54642.0 * nu2
             - 34598.0 * nu3
             + 6056.0 * nu2 * nu2
         ) / (3648.0 * (-1.0 + 6.0 * nu - 10.0 * nu2 + 4.0 * nu3))
 
-    rho_coeffs[8,4][2] = (
+    rho_coeffs[8, 4][2] = (
         2666.0 - 19434.0 * nu + 42627.0 * nu2 - 28965.0 * nu3 + 4899.0 * nu2 * nu2
     ) / (2736.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
 
     if dm2:
-        rho_coeffs[8,3][2] = (
+        rho_coeffs[8, 3][2] = (
             20598.0
             - 131059.0 * nu
             + 249018.0 * nu2
             - 149950.0 * nu3
             + 24520.0 * nu2 * nu2
         ) / (18240.0 * (-1.0 + 6.0 * nu - 10.0 * nu2 + 4.0 * nu3))
 
-    rho_coeffs[8,2][2] = (
+    rho_coeffs[8, 2][2] = (
         2462.0 - 17598.0 * nu + 37119.0 * nu2 - 22845.0 * nu3 + 3063.0 * nu2 * nu2
     ) / (2736.0 * (-1.0 + 7.0 * nu - 14.0 * nu2 + 7.0 * nu3))
 
     if dm2:
-        rho_coeffs[8,1][2] = (
+        rho_coeffs[8, 1][2] = (
             20022.0
             - 126451.0 * nu
             + 236922.0 * nu2
             - 138430.0 * nu3
             + 21640.0 * nu2 * nu2
         ) / (18240.0 * (-1.0 + 6.0 * nu - 10.0 * nu2 + 4.0 * nu3))
 
@@ -990,77 +1009,100 @@
         # appropriate to _add_ new terms to values defined above,
         # i.e with "+="". However, for brand new terms they should
         # just be defined with "=" since the coefficients are not
         # reset to 0 at every step.
         # These terms were not in SEOBNRv4HM
         # Add the NLO  spin-squared term at 3PN
         # We need to get rid of the test-spin term
-        rho_coeffs[2,2][6] -=(89.0 * atemp*atemp) / 252.0
-        rho_coeffs[2,2][6] += (
+        rho_coeffs[2, 2][6] -=(89.0 * atemp*atemp) / 252.0
+        rho_coeffs[2, 2][6] += (
             ((178. - 457.*nu- 972.*nu**2)*chiA**2)/504. +
             (dm*(178. - 781.*nu)*chiA*chiS)/252. +
             ((178. - 1817.*nu+ 560.*nu**2)*chiS**2)/504.)
         # Add LO spin-cubed term at 3.5 PN
         # We need to get rid of the test-spin term
         # We need atemp because we have set a to zero afer the (2,2) mode
-        rho_coeffs[2,2][7] -= atemp**3/3.0
-        rho_coeffs[2,2][7] += (((dm - 4.*dm*nu)*chiA**3)/3. +
-                (1. - 3.*nu - 4.*nu**2)*chiA**2*chiS +
-                ( dm + 2.*dm*nu)*chiA*chiS**2 +
-                (1./3. + nu)*chiS**3)
+        rho_coeffs[2, 2][7] -= atemp**3/3.0
+        rho_coeffs[2, 2][7] += (
+            ((dm - 4.*dm*nu)*chiA**3)/3.
+            + (1. - 3.*nu - 4.*nu**2)*chiA**2*chiS
+            + (dm + 2.*dm*nu)*chiA*chiS**2
+            + (1./3. + nu)*chiS**3
+        )
 
         # NB: from now on we don't need to worry about subtracting out the
         # test-spin terms since they were set to 0 for modes above (2,2)
 
         # All the known spin terms in (3,2)
-        rho_coeffs[3,2][2] +=  -(16.*nu**2*chiS**2)/(9.*(1. - 3.*nu)**2)
-        rho_coeffs[3,2][3] += ((dm*(2. + 13.*nu)*chiA)/(9. - 27.*nu) +
-                                ((90. - 1478.*nu + 2515.*nu**2 + 3035.*nu**3)*chiS)/
-                                (405.*(1. - 3.*nu)**2) - (320.*nu**3*chiS**3)/
-                                (81.*(-1. + 3.*nu)**3))
-        rho_coeffs[3,2][4] +=  (((1. - 9.*nu + 12.*nu**2)*chiA**2)/(3. - 9.*nu) -
-                                (2.*dm*(-9. + 44.*nu + 25.*nu**2)*chiA*chiS)/
-                                (27.*(1. - 3.*nu)**2) + ((-81. + 387.*nu - 1435.*nu**2 +
-                                1997.*nu**3 + 2452.*nu**4)*chiS**2)/(243.*(-1 + 3.*nu)**3))
-        rho_coeffs[3,2][5] += ((dm*(-245344. + 1128531.*nu - 1514740.*nu**2 +889673.*nu**3)*chiA)/(106920.*(1 - 3*nu)**2) +
-                            ((2208096. - 20471053.*nu + 70519165.*nu**2 - 101706029.*nu**3 +40204523.*nu**4 + 11842250.*nu**5)*chiS)/
-                            (962280.*(-1. + 3.*nu)**3) - (8.*nu*(1. - 9.*nu + 12.*nu**2)*chiA**2*chiS)/(9.*(1. - 3.*nu)**2) -
-                            (16.*dm*nu*(-9. + 46.*nu + 38.*nu**2)*chiA*chiS**2)/(81.*(-1. + 3.*nu)**3) + (8.*nu*(-243. + 1269.*nu - 5029.*nu**2 +
-                            5441.*nu**3 + 12022.*nu**4)*chiS**3)/(2187.*(1. - 3.*nu)**4))
+        rho_coeffs[3, 2][2] += -(16.*nu**2*chiS**2)/(9.*(1. - 3.*nu)**2)
+        rho_coeffs[3, 2][3] += (
+            (dm*(2. + 13.*nu)*chiA)/(9. - 27.*nu)
+            + ((90. - 1478.*nu + 2515.*nu**2 + 3035.*nu**3)*chiS)/(405.*(1. - 3.*nu)**2)
+            - (320.*nu**3*chiS**3)/(81.*(-1. + 3.*nu)**3)
+        )
+        rho_coeffs[3, 2][4] += (
+            ((1. - 9.*nu + 12.*nu**2)*chiA**2)/(3. - 9.*nu)
+            - (2.*dm*(-9. + 44.*nu + 25.*nu**2)*chiA*chiS)/(27.*(1. - 3.*nu)**2)
+            + ((-81. + 387.*nu - 1435.*nu**2 + 1997.*nu**3 + 2452.*nu**4)*chiS**2)/(243.*(-1 + 3.*nu)**3)
+        )
+        rho_coeffs[3, 2][5] += (
+            (dm*(-245344. + 1128531.*nu - 1514740.*nu**2 + 889673.*nu**3)*chiA)/(106920.*(1 - 3*nu)**2)
+            + ((2208096.
+                - 20471053.*nu
+                + 70519165.*nu**2
+                - 101706029.*nu**3
+                + 40204523.*nu**4
+                + 11842250.*nu**5)*chiS)/(962280.*(-1. + 3.*nu)**3)
+            - (8.*nu*(1. - 9.*nu + 12.*nu**2)*chiA**2*chiS)/(9.*(1. - 3.*nu)**2)
+            - (16.*dm*nu*(-9. + 46.*nu + 38.*nu**2)*chiA*chiS**2)/(81.*(-1. + 3.*nu)**3)
+            + (8.*nu*(
+                -243.
+                + 1269.*nu
+                - 5029.*nu**2
+                + 5441.*nu**3
+                + 12022.*nu**4)*chiS**3
+               )/(2187.*(1. - 3.*nu)**4)
+        )
 
         # All the known spin terms in (4,3)
         # NB: odd m so these are f-coeffs and we must treat the dm->0 issue as always
 
         if dm2:
+            f_coeffs[4, 3][3] = (
+                (nu*(-2661. + 3143.*nu)*chiA)/(132.*dm*(-1. + 2.*nu))
+                + (23.*nu*(87. + 23.*nu)*chiS)/(132.*(-1. + 2.*nu))
+            )
 
-            f_coeffs[4,3][3] = ((nu*(-2661. + 3143.*nu)*chiA)/(132.*dm*(-1. + 2.*nu)) +
-                            (23.*nu*(87. + 23.*nu)*chiS)/(132.*(-1. + 2.*nu)))
-
-
-            f_coeffs[4,3][4] = (((9. - 74.*nu + 72.*nu**2)*chiA**2)/(6. - 12.*nu) +
-                            ((18. - 108.*nu + 137.*nu**2)*chiA*chiS)/(6.*dm - 12.*dm*nu) + ((9. + 2.*nu + 35.*nu**2)*
-                            chiS**2)/(6. - 12.*nu))
-
-
+            f_coeffs[4, 3][4] = (
+                ((9. - 74.*nu + 72.*nu**2)*chiA**2)/(6. - 12.*nu)
+                + ((18. - 108.*nu + 137.*nu**2)*chiA*chiS)/(6.*dm - 12.*dm*nu)
+                + ((9. + 2.*nu + 35.*nu**2)*chiS**2)/(6. - 12.*nu)
+            )
         else:
-            f_coeffs[4,3][3] = ((nu*(-2661. + 3143.*nu)*chiA)/(132.*(-1. + 2.*nu)))
-            f_coeffs[4,3][4] = ((18. - 108.*nu + 137.*nu**2)*chiA*chiS)/(6. - 12.*nu)
+            f_coeffs[4, 3][3] = (nu*(-2661. + 3143.*nu)*chiA)/(132.*(-1. + 2.*nu))
+            f_coeffs[4, 3][4] = ((18. - 108.*nu + 137.*nu**2)*chiA*chiS)/(6. - 12.*nu)
 
 
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
 @cython.profile(True)
 @cython.linetrace(True)
-cdef public void compute_delta_coeffs(double nu,double dm, double a,double chiS,double chiA,
-    double complex[:,:,:] delta_coeffs, double complex[:,:,:] delta_coeffs_vh):
-
+cdef public void compute_delta_coeffs(
+    double nu,
+    double dm,
+    double a,
+    double chiS,
+    double chiA,
+    double complex[:, :, :] delta_coeffs,
+    double complex[:, :, :] delta_coeffs_vh
+):
     """
     Compute the phase residual coefficients.
 
     See Sec. 2B of [Damour2009]_ and Eq. 59-63 of [SEOBNRv5HM-theory]_ for new terms.
     The rest has been copied from SEOBNRv4HM LAL code.
 
     Coefficients can be found in:
@@ -1086,397 +1128,447 @@
 
     cdef double m1Plus3nu = -1.0 + 3.0 * nu
     cdef double m1Plus3nu2 = m1Plus3nu * m1Plus3nu
     cdef double m1Plus3nu3 = m1Plus3nu * m1Plus3nu2
 
     cdef double aDelta = 0.0
 
-    #(2,2) mode begins
-    delta_coeffs_vh[2,2][3] = 7.0 / 3.0
+    # (2,2) mode begins
+    delta_coeffs_vh[2, 2][3] = 7.0 / 3.0
     # See https://dcc.ligo.org/T1600383
 
-    delta_coeffs_vh[2,2][6] = (
+    delta_coeffs_vh[2, 2][6] = (
         -4.0 / 3.0 * (dm * chiA + chiS * (1 - 2 * nu)) + (428.0 * pi) / 105.0
     )
 
-    delta_coeffs[2,2][8] = (20.0 * aDelta) / 63.0
-    delta_coeffs_vh[2,2][9] = -2203.0 / 81.0 + (1712.0 * pi * pi) / 315.0
-    delta_coeffs[2,2][5] = -24.0 * nu
-    delta_coeffs[2,2][6] = 0.0
+    delta_coeffs[2, 2][8] = (20.0 * aDelta) / 63.0
+    delta_coeffs_vh[2, 2][9] = -2203.0 / 81.0 + (1712.0 * pi * pi) / 315.0
+    delta_coeffs[2, 2][5] = -24.0 * nu
+    delta_coeffs[2, 2][6] = 0.0
 
     # (2,2) mode ends
 
     # (2,1) mode begins
 
-    delta_coeffs_vh[2,1][3] = 2.0 / 3.0
-    delta_coeffs_vh[2,1][6] = (-17.0 * aDelta) / 35.0 + (107.0 * pi) / 105.0
-    delta_coeffs_vh[2,1][7] = (3.0 * aDelta * aDelta) / 140.0
-    delta_coeffs_vh[2,1][9] = -272.0 / 81.0 + (214.0 * pi * pi) / 315.0
-    """
-    This was in SEOBNRv4HM
-    delta_coeffs[2,1][5] = -493.0 * nu / 42.0
-    """
-    delta_coeffs[2,1][5] = -25.0 * nu /2
+    delta_coeffs_vh[2, 1][3] = 2.0 / 3.0
+    delta_coeffs_vh[2, 1][6] = (-17.0 * aDelta) / 35.0 + (107.0 * pi) / 105.0
+    delta_coeffs_vh[2, 1][7] = (3.0 * aDelta * aDelta) / 140.0
+    delta_coeffs_vh[2, 1][9] = -272.0 / 81.0 + (214.0 * pi * pi) / 315.0
+
+    # This was in SEOBNRv4HM
+    # delta_coeffs[2,1][5] = -493.0 * nu / 42.0
+    delta_coeffs[2, 1][5] = -25.0 * nu /2
 
     # (2,1) mode ends
 
     # (3,3) mode begins
     # l = 3, Eqs. A9a - A9c for rho, Eqs. A15b and A15c for f,
     # Eqs. 22 - 24 of DIN and Eqs. 27c - 27e of PBFRT for delta
-    delta_coeffs_vh[3,3][3] = 13.0 / 10.0
-    delta_coeffs_vh[3,3][6] = (-81.0 * aDelta) / 20.0 + (39.0 * pi) / 7.0
-    delta_coeffs_vh[3,3][9] = -227827.0 / 3000.0 + (78.0 * pi * pi) / 7.0
-    delta_coeffs[3,3][5] = -80897.0 * nu / 2430.0
+    delta_coeffs_vh[3, 3][3] = 13.0 / 10.0
+    delta_coeffs_vh[3, 3][6] = (-81.0 * aDelta) / 20.0 + (39.0 * pi) / 7.0
+    delta_coeffs_vh[3, 3][9] = -227827.0 / 3000.0 + (78.0 * pi * pi) / 7.0
+    delta_coeffs[3, 3][5] = -80897.0 * nu / 2430.0
     # (3,3) mode ends
 
     # (3,2) mode begins
-    delta_coeffs_vh[3,2][3] = (10.0 + 33.0 * nu) / (-15.0 * m1Plus3nu)
-    delta_coeffs_vh[3,2][4] = 4.0 * aDelta
-    delta_coeffs_vh[3,2][6] = (-136.0 * aDelta) / 45.0 + (52.0 * pi) / 21.0
-    delta_coeffs_vh[3,2][9] = -9112.0 / 405.0 + (208.0 * pi * pi) / 63.0
+    delta_coeffs_vh[3, 2][3] = (10.0 + 33.0 * nu) / (-15.0 * m1Plus3nu)
+    delta_coeffs_vh[3, 2][4] = 4.0 * aDelta
+    delta_coeffs_vh[3, 2][6] = (-136.0 * aDelta) / 45.0 + (52.0 * pi) / 21.0
+    delta_coeffs_vh[3, 2][9] = -9112.0 / 405.0 + (208.0 * pi * pi) / 63.0
     # (3,2) mode ends
 
     # (3,1) mode begins
-    delta_coeffs_vh[3,1][3] = 13.0 / 30.0
-    delta_coeffs_vh[3,1][6] = (61.0 * aDelta) / 20.0 + (13.0 * pi) / 21.0
-    delta_coeffs_vh[3,1][7] = (-24.0 * aDelta * aDelta) / 5.0
-    delta_coeffs_vh[3,1][9] = -227827.0 / 81000.0 + (26.0 * pi * pi) / 63.0
-    delta_coeffs[3,1][5] = -17.0 * nu / 10.0
+    delta_coeffs_vh[3, 1][3] = 13.0 / 30.0
+    delta_coeffs_vh[3, 1][6] = (61.0 * aDelta) / 20.0 + (13.0 * pi) / 21.0
+    delta_coeffs_vh[3, 1][7] = (-24.0 * aDelta * aDelta) / 5.0
+    delta_coeffs_vh[3, 1][9] = -227827.0 / 81000.0 + (26.0 * pi * pi) / 63.0
+    delta_coeffs[3, 1][5] = -17.0 * nu / 10.0
     # (3,1) mode ends
 
     # (4,4) mode begins
-    delta_coeffs_vh[4,4][3] = (112.0 + 219.0 * nu) / (-120.0 * m1Plus3nu)
-    delta_coeffs_vh[4,4][6] = (-464.0 * aDelta) / 75.0 + (25136.0 * pi) / 3465.0
+    delta_coeffs_vh[4, 4][3] = (112.0 + 219.0 * nu) / (-120.0 * m1Plus3nu)
+    delta_coeffs_vh[4, 4][6] = (-464.0 * aDelta) / 75.0 + (25136.0 * pi) / 3465.0
 
     # RC: This terms are in Eq.A15 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
-    delta_coeffs_vh[4,4][9] = -55144.0 / 375.0 + 201088.0 * pi * pi / 10395.0
+    delta_coeffs_vh[4, 4][9] = -55144.0 / 375.0 + 201088.0 * pi * pi / 10395.0
 
     # SO: what is going on with delta44v5: it's declared but never set in the LAL code!
 
     # (4,4) mode ends
 
     # (4,3) mode begins
-    delta_coeffs_vh[4,3][3] = (486.0 + 4961.0 * nu) / (810.0 * (1.0 - 2.0 * nu))
-    delta_coeffs_vh[4,3][4] = (11.0 * aDelta) / 4.0
-    delta_coeffs_vh[4,3][6] = 1571.0 * pi / 385.0
+    delta_coeffs_vh[4, 3][3] = (486.0 + 4961.0 * nu) / (810.0 * (1.0 - 2.0 * nu))
+    delta_coeffs_vh[4, 3][4] = (11.0 * aDelta) / 4.0
+    delta_coeffs_vh[4, 3][6] = 1571.0 * pi / 385.0
     # (4,3) mode ends
 
     # (4,2) mode begins
-    delta_coeffs_vh[4,2][3] = (7.0 * (1.0 + 6.0 * nu)) / (-15.0 * m1Plus3nu)
-    delta_coeffs_vh[4,2][6] = (212.0 * aDelta) / 75.0 + (6284.0 * pi) / 3465.0
+    delta_coeffs_vh[4, 2][3] = (7.0 * (1.0 + 6.0 * nu)) / (-15.0 * m1Plus3nu)
+    delta_coeffs_vh[4, 2][6] = (212.0 * aDelta) / 75.0 + (6284.0 * pi) / 3465.0
     # (4,2) mode ends
 
     # (4,1) mode begins
-    delta_coeffs_vh[4,1][3] = (2.0 + 507.0 * nu) / (10.0 * (1.0 - 2.0 * nu))
-    delta_coeffs_vh[4,1][4] = (11.0 * aDelta) / 12.0
-    delta_coeffs_vh[4,1][6] = 1571.0 * pi / 3465.0
+    delta_coeffs_vh[4, 1][3] = (2.0 + 507.0 * nu) / (10.0 * (1.0 - 2.0 * nu))
+    delta_coeffs_vh[4, 1][4] = (11.0 * aDelta) / 12.0
+    delta_coeffs_vh[4, 1][6] = 1571.0 * pi / 3465.0
     # (4,1) mode ends
 
     # l=5 modes begin
-    delta_coeffs_vh[5,5][3] = (96875.0 + 857528.0 * nu) / (131250.0 * (1 - 2 * nu))
+    delta_coeffs_vh[5, 5][3] = (96875.0 + 857528.0 * nu) / (131250.0 * (1 - 2 * nu))
 
     # RC: This terms are in Eq.A16 in https://journals.aps.org/prd/abstract/10.1103/PhysRevD.98.084028
-    delta_coeffs_vh[5,5][6] = 3865.0 / 429.0 * pi
-    delta_coeffs_vh[5,5][9] = (
+    delta_coeffs_vh[5, 5][6] = 3865.0 / 429.0 * pi
+    delta_coeffs_vh[5, 5][9] = (
         -7686949127.0 + 954500400.0 * pi * pi
     ) / 31783752.0
 
-    delta_coeffs_vh[5,4][3] = 8.0 / 15.0
-    delta_coeffs_vh[5,4][4] = 12.0 * aDelta / 5.0
+    delta_coeffs_vh[5, 4][3] = 8.0 / 15.0
+    delta_coeffs_vh[5, 4][4] = 12.0 * aDelta / 5.0
 
-    delta_coeffs_vh[5,3][3] = 31.0 / 70.0
+    delta_coeffs_vh[5, 3][3] = 31.0 / 70.0
 
-    delta_coeffs_vh[5,2][3] = 4.0 / 15.0
-    delta_coeffs_vh[5,2][4] = 6.0 * aDelta / 5.0
+    delta_coeffs_vh[5, 2][3] = 4.0 / 15.0
+    delta_coeffs_vh[5, 2][4] = 6.0 * aDelta / 5.0
 
-    delta_coeffs_vh[5,1][3] = 31.0 / 210.0
+    delta_coeffs_vh[5, 1][3] = 31.0 / 210.0
     # ell = 5 modes end
 
     # l=6 modes begin
-    delta_coeffs_vh[6,6][3] = 43.0 / 70.0
-    delta_coeffs_vh[6,5][3] = 10.0 / 21.0
-    delta_coeffs_vh[6,4][3] = 43.0 / 105.0
-    delta_coeffs_vh[6,3][3] = 2.0 / 7.0
-    delta_coeffs_vh[6,2][3] = 43.0 / 210.0
-    delta_coeffs_vh[6,1][3] = 2.0 / 21.0
+    delta_coeffs_vh[6, 6][3] = 43.0 / 70.0
+    delta_coeffs_vh[6, 5][3] = 10.0 / 21.0
+    delta_coeffs_vh[6, 4][3] = 43.0 / 105.0
+    delta_coeffs_vh[6, 3][3] = 2.0 / 7.0
+    delta_coeffs_vh[6, 2][3] = 43.0 / 210.0
+    delta_coeffs_vh[6, 1][3] = 2.0 / 21.0
     # l=6 modes end
 
     # l=7 modes begin
-    delta_coeffs_vh[7,7][3] = 19.0 / 36.0
-    delta_coeffs_vh[7,5][3] = 95.0 / 252.0
-    delta_coeffs_vh[7,3][3] = 19.0 / 84.0
-    delta_coeffs_vh[7,1][3] = 19.0 / 252.0
+    delta_coeffs_vh[7, 7][3] = 19.0 / 36.0
+    delta_coeffs_vh[7, 5][3] = 95.0 / 252.0
+    delta_coeffs_vh[7, 3][3] = 19.0 / 84.0
+    delta_coeffs_vh[7, 1][3] = 19.0 / 252.0
     # l=7 modes end
 
 
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
-cdef double complex compute_deltalm_single(double[] vs, double[] vhs,int l, int m, FluxParams fl):
+cdef double complex compute_deltalm_single(
+    double[] vs,
+    double[] vhs,
+    int l,
+    int m,
+    FluxParams fl
+):
     """
     Compute the  full :math:`\\delta_{\\ell m}` contribution for a given mode
     """
     cdef int j
     cdef double complex delta = 0.0
     for j in range(PN_limit):
-        delta += fl.delta_coeffs[l,m,j]*vs[j] + fl.delta_coeffs_vh[l,m,j]*vhs[j]
+        delta += fl.delta_coeffs[l, m, j]*vs[j] + fl.delta_coeffs_vh[l, m, j]*vhs[j]
     return delta
 
+
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
 @cython.profile(True)
 @cython.linetrace(True)
-cdef void compute_delta(double v,double vh,double nu, EOBParams eob_pars):
+cdef void compute_delta(
+    double v,
+    double vh,
+    double nu,
+    EOBParams eob_pars
+):
     """
     Compute the  full :math:`\\delta_{\\ell m}` contribution for all modes
     """
-    cdef int i,j,l,m
+    cdef int i, j, l, m
     cdef double vs[PN_limit]
     cdef double vhs[PN_limit]
-    cdef double complex delta  = 0.0
+    cdef double complex delta = 0.0
     for i in range(PN_limit):
         vs[i] = v**i
         vhs[i] = vh**i
     cdef FluxParams fl = eob_pars.flux_params
-    for l in range(2,ell_max+1):
-        for m in range(1,l+1):
-            fl.deltalm[l,m] = compute_deltalm_single(vs,vhs,l,m,fl)
-
+    for l in range(2, ell_max+1):
+        for m in range(1, l+1):
+            fl.deltalm[l, m] = compute_deltalm_single(vs, vhs, l, m, fl)
 
 
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
-cpdef double complex compute_extra_flm_terms(int l,int m,double vh,EOBParams eob_pars):
+cpdef double complex compute_extra_flm_terms(int l, int m, double vh, EOBParams eob_pars):
     """
     Compute the complex term in :math:`f_{33}`.
 
     See last term in Eq(A10) of [Cotesta2022]_
     """
     cdef double vh3 = vh**3
     cdef double complex extra_term = 0.0
     if l==3 and m==3:
-        extra_term = I*vh3 * vh3 * eob_pars.flux_params.f_coeffs_vh[3,3][6]
+        extra_term = I*vh3 * vh3 * eob_pars.flux_params.f_coeffs_vh[3, 3][6]
     return extra_term
 
+
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
-cdef double complex compute_rholm_single(double[] vs,double vh, int l, int m, EOBParams eob_pars):
+cdef double complex compute_rholm_single(
+    double[] vs,
+    double vh,
+    int l,
+    int m,
+    EOBParams eob_pars
+):
     """
     Compute the full :math:`\\rho_{\\ell m}` contribution for a given mode
     """
     cdef int j
     cdef double v = vs[1]
     cdef double nu = eob_pars.p_params.nu
-    cdef double complex rho_final  = 0.0
-    cdef double rho  = 1.0
+    cdef double complex rho_final = 0.0
+    cdef double rho = 1.0
 
     cdef double rho_log = 0.0
     cdef double f = 0.0
     cdef double complex f_final = 0.0
-    cdef double eulerlogxabs =  euler_gamma + log(2.0 * m * v)
+    cdef double eulerlogxabs = euler_gamma + log(2.0 * m * v)
     cdef double complex extra_flm_term
     # This is just computing rho_coeffs \dot v
 
-    if m%2:
+    if m % 2:
         # For odd m modes we need to compute f
-        for j in range(1,PN_limit):
-            rho+= (eob_pars.flux_params.rho_coeffs[l,m,j]+eob_pars.flux_params.extra_coeffs[l,m,j]+ (eob_pars.flux_params.rho_coeffs_log[l,m,j]+eob_pars.flux_params.extra_coeffs_log[l,m,j])*eulerlogxabs)*vs[j]
-            f += eob_pars.flux_params.f_coeffs[l,m,j]*vs[j]
+        for j in range(1, PN_limit):
+            rho+= (
+                eob_pars.flux_params.rho_coeffs[l, m, j]
+                + eob_pars.flux_params.extra_coeffs[l, m, j]
+                + (eob_pars.flux_params.rho_coeffs_log[l, m, j]
+                   + eob_pars.flux_params.extra_coeffs_log[l, m, j]
+                   )*eulerlogxabs
+                )*vs[j]
+            f += eob_pars.flux_params.f_coeffs[l, m, j]*vs[j]
     else:
         # For even m modes we only need rho
-        for j in range(1,PN_limit):
-            rho+= (eob_pars.flux_params.rho_coeffs[l,m,j]+eob_pars.flux_params.extra_coeffs[l,m,j]+(eob_pars.flux_params.rho_coeffs_log[l,m,j]+eob_pars.flux_params.extra_coeffs_log[l,m,j])*eulerlogxabs)*vs[j]
+        for j in range(1, PN_limit):
+            rho+= (eob_pars.flux_params.rho_coeffs[l, m, j]
+                   + eob_pars.flux_params.extra_coeffs[l, m, j]
+                   + (eob_pars.flux_params.rho_coeffs_log[l, m, j]
+                      + eob_pars.flux_params.extra_coeffs_log[l, m, j]
+                      )*eulerlogxabs
+                   )*vs[j]
 
     # Deal with the complex amplitude term
     f_final = f
     if l==3 and m==3:
-        extra_flm_term = compute_extra_flm_terms(l,m,vh,eob_pars)
+        extra_flm_term = compute_extra_flm_terms(l, m, vh, eob_pars)
         f_final += extra_flm_term
 
-
     rho_final = rho**l
-    if fabs(nu-0.25)<1e-14 and m%2:
+    if fabs(nu-0.25)<1e-14 and m % 2:
         rho_final = f_final
     else:
         rho_final += f_final
     return rho_final
 
 
-'''
-@cython.cpow(True)
-@cython.wraparound(False)
-@cython.boundscheck(False)
-@cython.cdivision(True)
-@cython.nonecheck(False)
-@cython.initializedcheck(False)
-@cython.profile(True)
-@cython.linetrace(True)
-cdef void compute_rholm(double v,double vh,double nu, EOBParams eob_pars):
-    """
-    Compute the full \rho_{\ell m}​ contribution for all modes.
-    """
-    cdef int i,l,m
-    cdef double vs[PN_limit]
-    for i in range(PN_limit):
-        vs[i] = v**i
+# @cython.cpow(True)
+# @cython.wraparound(False)
+# @cython.boundscheck(False)
+# @cython.cdivision(True)
+# @cython.nonecheck(False)
+# @cython.initializedcheck(False)
+# @cython.profile(True)
+# @cython.linetrace(True)
+# cdef void compute_rholm(double v,double vh,double nu, EOBParams eob_pars):
+#     """
+#     Compute the full \\rho_{\\ell m}​ contribution for all modes.
+#     """
+#     cdef int i,l,m
+#     cdef double vs[PN_limit]
+#     for i in range(PN_limit):
+#         vs[i] = v**i
+#
+#     for l in range(2,ell_max+1):
+#         for m in range(1,l+1):
+#             eob_pars.flux_params.rholm[l,m] = compute_rholm_single(vs,vh,l,m,eob_pars)
 
-    for l in range(2,ell_max+1):
-        for m in range(1,l+1):
-            eob_pars.flux_params.rholm[l,m] = compute_rholm_single(vs,vh,l,m,eob_pars)
-'''
 
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
 @cython.profile(True)
 @cython.linetrace(True)
-cdef void compute_rholm(double v,double vh,double nu, EOBParams eob_pars):
-    cdef int i,l,m
+cdef void compute_rholm(double v, double vh, double nu, EOBParams eob_pars):
+    cdef int i, l, m
     cdef double vs[PN_limit]
+
     vs[0] = 0
     vs[1] = v
-    for i in range(2,PN_limit):
+
+    for i in range(2, PN_limit):
         vs[i] = v*vs[i-1]
 
-    for l in range(2,ell_max+1):
-        for m in range(1,l+1):
-            eob_pars.flux_params.rholm[l,m] = compute_rholm_single(vs,vh,l,m,eob_pars)
+    for l in range(2, ell_max+1):
+        for m in range(1, l+1):
+            eob_pars.flux_params.rholm[l, m] = compute_rholm_single(vs, vh, l, m, eob_pars)
+
 
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.profile(True)
 @cython.linetrace(True)
 cpdef double  EOBFluxCalculateNewtonianMultipoleAbs(
-    double x, double phi, int l, int m, double [:,:] params
+    double x,
+    double phi,
+    int l,
+    int m,
+    double [:, :] params
 ):
     """
     Compute the Newtonian multipole (optimised for the flux calculation).
     """
-    cdef double param = params[l,m]
+    cdef double param = params[l, m]
     cdef int epsilon = (l + m) % 2
 
-
     cdef double y = ylms[m][l-epsilon]
     cdef double multipole = param * x ** ((l + epsilon) / 2.0)
     multipole *= y
     return multipole
 
 
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
 @cython.profile(True)
 @cython.linetrace(True)
-cdef void update_rho_coeffs(double[:,:,:] rho_coeffs, double[:,:,:] extra_coeffs):
-    cdef int l,m,i
+cdef void update_rho_coeffs(double[:, :, :] rho_coeffs, double[:, :, :] extra_coeffs):
+    cdef int l, m, i
     cdef double temp = 0.0
-    for l in range(2,ell_max+1):
-        for m in range(1,l+1):
+    for l in range(2, ell_max+1):
+        for m in range(1, l+1):
             for i in range(PN_limit):
-                temp = extra_coeffs[l,m,i]
+                temp = extra_coeffs[l, m, i]
                 if fabs(temp)>1e-15:
-                    rho_coeffs[l,m,i] += temp
+                    rho_coeffs[l, m, i] += temp
+
 
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
 @cython.profile(True)
 @cython.linetrace(True)
-cpdef double compute_flux(double r,double phi,double pr,double pphi,double omega,double omega_circ,double H,EOBParams eob_pars):
+cpdef double compute_flux(
+    double r,
+    double phi,
+    double pr,
+    double pphi,
+    double omega,
+    double omega_circ,
+    double H,
+    EOBParams eob_pars
+):
     """
     Compute the full flux.
 
     See Eq(43) in [SEOBNRv5HM-notes]_.
     """
-    cdef int l,m
-    cdef double[:,:] Tlm = eob_pars.flux_params.Tlm
+    cdef int l, m
+    cdef double[:, :] Tlm = eob_pars.flux_params.Tlm
     # Note the "abs" in the prefixes.
-    cdef double[:,:] prefixes = eob_pars.flux_params.prefixes_abs
+    cdef double[:, :] prefixes = eob_pars.flux_params.prefixes_abs
     cdef double v = omega**(1./3)
     cdef double vh3 = H*omega
     cdef double vh = vh3**(1./3)
     cdef double omega2 = omega*omega
     cdef double nu = eob_pars.p_params.nu
     cdef double flux = 0.0
     cdef double hNewton
 
     # Precompute the tail
     compute_tail(omega, H, Tlm)
     cdef double tail
 
     # Precompute the source term
     cdef double Slm = 0.0
-    cdef double source1 = (H * H - 1.0) / (2.0 * nu) + 1.0 # H_eff
+    cdef double source1 = (H * H - 1.0) / (2.0 * nu) + 1.0  # H_eff
     cdef double source2 = v*pphi
     cdef double v_phi = omega/omega_circ**(2./3)
     cdef double v_phi2 = v_phi*v_phi
 
-    cdef double complex rholmPwrl  = 1.0
+    cdef double complex rholmPwrl = 1.0
 
     # Assume that the spin params have already been updated appropriately
-    compute_rho_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,
-    eob_pars.p_params.chi_A, eob_pars.flux_params.rho_coeffs,eob_pars.flux_params.rho_coeffs_log,
-    eob_pars.flux_params.f_coeffs,eob_pars.flux_params.f_coeffs_vh, eob_pars.flux_params.extra_PN_terms)
+    compute_rho_coeffs(
+        eob_pars.p_params.nu,
+        eob_pars.p_params.delta,
+        eob_pars.p_params.a,
+        eob_pars.p_params.chi_S,
+        eob_pars.p_params.chi_A,
+        eob_pars.flux_params.rho_coeffs,
+        eob_pars.flux_params.rho_coeffs_log,
+        eob_pars.flux_params.f_coeffs,
+        eob_pars.flux_params.f_coeffs_vh,
+        eob_pars.flux_params.extra_PN_terms)
 
+    compute_rholm(v, vh, eob_pars.p_params.nu, eob_pars)
 
-
-    compute_rholm(v,vh,eob_pars.p_params.nu,eob_pars)
     cdef double complex hlm
 
     # Deal with NQCs
     cdef double[:] nqc_coeffs
     cdef double correction = 1.0
 
-    for l in range(2,ell_max+1):
-        for m in range(1,l+1):
+    for l in range(2, ell_max+1):
+        for m in range(1, l+1):
             # Assemble the waveform
-
             hNewton = EOBFluxCalculateNewtonianMultipoleAbs(
                 v_phi2, M_PI_2, l, m, prefixes
             )
+
             if ((l + m) % 2) == 0:
                 Slm = source1
-
             else:
                 Slm = source2
 
-            tail = Tlm[l,m]
-            rholmPwrl = eob_pars.flux_params.rholm[l,m]
+            tail = Tlm[l, m]
+            rholmPwrl = eob_pars.flux_params.rholm[l, m]
             hlm = tail*Slm*hNewton*rholmPwrl
 
             flux += m*m*omega2*cabs(hlm)**2
+
     return flux/(8*pi)
 
+
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
 @cython.profile(True)
@@ -1709,22 +1801,22 @@
                         + 12666.901579274047 / sinh_2pia
                     )
                 )
             )
         else:
             alpha5 = 52.6240144421630
 
-    #alpha = 1. + (a / (1. + expr3) - 2. * x**(3./2)) * (
+    # alpha = 1. + (a / (1. + expr3) - 2. * x**(3./2)) * (
     #    alpha52 * x**(5./2)
     #    + alpha3 * x**3.
     #    + alpha72 * x**(7./2)
     #    + alpha4 * x**4.
     #    + alpha92 * x**(9./2)
     #    + alpha5 * x**5.
-    #)
+    # )
 
     alpha = 1.
 
     beta12 = 0.
 
     if beaming == 1:
         beta1 = 0.47098214285714285 - 1.3839285714285714 * nu
@@ -1961,39 +2053,60 @@
                 -0.6095166813869705 * chi_1 - 0.04908738521234052 * chi_1**2
                 + (-0.3328450520833333 + 0.8385416666666666 * CES21 - 0.49999999999999994 * CES31) * chi_1**3
                 + 0.6095166813869705 * chi_2 + 0.04908738521234052 * chi_2**2
                 + (0.3328450520833333 - 0.8385416666666666 * CES22 + 0.49999999999999994 * CES32) * chi_2**3
             ) * expr1
             + (
                 2.1475568704389674
-                + (1.5704752604166665 - 2.317708333333333 * CES21 + 0.020833333333333332 * CES22 + 1.5 * CES31) * chi_1**3
+                + (1.5704752604166665
+                   - 2.317708333333333 * CES21
+                   + 0.020833333333333332 * CES22
+                   + 1.5 * CES31) * chi_1**3
                 + 12.029987764827068 * chi_2 + 0.09817477042468103 * chi_2**2
-                + (1.5704752604166665 + 0.020833333333333332 * CES21 - 2.317708333333333 * CES22 + 1.5 * CES32) * chi_2**3
+                + (1.5704752604166665
+                   + 0.020833333333333332 * CES21
+                   - 2.317708333333333 * CES22
+                   + 1.5 * CES32) * chi_2**3
                 + chi_1**2 * (0.09817477042468103 + (1.24853515625 - 0.5052083333333333 * CES21) * chi_2)
-                + chi_1 * (12.029987764827068 + 0.19634954084936207 * chi_2 + (1.24853515625 - 0.5052083333333333 * CES22) * chi_2**2)
+                + chi_1 * (12.029987764827068
+                           + 0.19634954084936207 * chi_2
+                           + (1.24853515625 - 0.5052083333333333 * CES22) * chi_2**2)
                 + (
-                    (0.9047851562499999 - 0.640625 * CES21 + 0.020833333333333332 * CES22 + 0.49999999999999994 * CES31) * chi_1**3
-                    - 8.510021260656316 * chi_2 + (1.24853515625 - 0.5052083333333333 * CES21) * chi_1**2 * chi_2
-                    + (-0.9047851562499999 - 0.020833333333333332 * CES21 + 0.640625 * CES22 - 0.49999999999999994 * CES32) * chi_2**3
+                    (0.9047851562499999
+                     - 0.640625 * CES21
+                     + 0.020833333333333332 * CES22
+                     + 0.49999999999999994 * CES31) * chi_1**3
+                    - 8.510021260656316 * chi_2
+                    + (1.24853515625 - 0.5052083333333333 * CES21) * chi_1**2 * chi_2
+                    + (-0.9047851562499999
+                       - 0.020833333333333332 * CES21
+                       + 0.640625 * CES22
+                       - 0.49999999999999994 * CES32) * chi_2**3
                     + chi_1 * (8.510021260656316 + (-1.24853515625 + 0.5052083333333333 * CES22) * chi_2**2)
                 ) * expr1
             ) * nu +
             (
                 21.378757472443112
                 + (-1.6438802083333333 - 0.4583333333333333 * CES21 - 0.10416666666666666 * CES22) * chi_1**3
                 - 8.766860112281313 * chi_2
                 + (0.36002604166666663 - 0.41666666666666663 * CES21 - 0.0625 * CES22) * chi_1**2 * chi_2
                 + (-1.6438802083333333 - 0.10416666666666666 * CES21 - 0.4583333333333333 * CES22) * chi_2**3
-                + chi_1 * (-8.766860112281313 + (0.36002604166666663 - 0.0625 * CES21 - 0.41666666666666663 * CES22) * chi_2**2)
+                + chi_1 * (-8.766860112281313
+                           + (0.36002604166666663
+                              - 0.0625 * CES21
+                              - 0.41666666666666663 * CES22) * chi_2**2)
                 + (
                     (-0.49999999999999994 - 0.0625 * CES21 - 0.0625 * CES22) * chi_1**3
                     + 4.077088632581215 * chi_2
                     + (-0.49999999999999994 - 0.0625 * CES21 - 0.0625 * CES22) * chi_1**2 * chi_2
                     + (0.49999999999999994 + 0.0625 * CES21 + 0.0625 * CES22) * chi_2**3
-                    + chi_1 * (-4.077088632581215 + (0.49999999999999994 + 0.0625 * CES21 + 0.0625 * CES22) * chi_2**2)
+                    + chi_1 * (-4.077088632581215
+                               + (0.49999999999999994
+                                  + 0.0625 * CES21
+                                  + 0.0625 * CES22) * chi_2**2)
                 ) * expr1
             )* nu**2
             + (
                 (0.3333333333333333 + 0.08333333333333333 * CES21 + 0.08333333333333333 * CES22) * chi_1**3
                 + 1.8834442884503337 * chi_2
                 + (0.9999999999999999 + 0.25 * CES21 + 0.25 * CES22) * chi_1**2 * chi_2
                 + (0.3333333333333333 + 0.08333333333333333 * CES21 + 0.08333333333333333 * CES22) * chi_2**3
@@ -2095,185 +2208,237 @@
     else:
         B = 1.
 
     flux = dE_dt_22 * alpha * beta**4. * B
 
     return flux
 
+
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
 @cython.profile(True)
 @cython.linetrace(True)
-cpdef (double,double) RR_force(double[::1] q, double[::1] p, double omega, double omega_circ,
-    double H, EOBParams eob_pars):
+cpdef (double, double) RR_force(
+    double[::1] q,
+    double[::1] p,
+    double omega,
+    double omega_circ,
+    double H,
+    EOBParams eob_pars
+):
     """
     Compute the RR force in polar coordinates, from the flux
     """
     cdef double r = q[0]
     cdef double phi = q[1]
     cdef double pr = p[0]
     cdef double pphi = p[1]
     cdef double nu = eob_pars.p_params.nu
     # Note the multiplication of H by nu!
-    cdef double flux = compute_flux(r,phi,pr,pphi,omega,omega_circ,nu*H,eob_pars)
+    cdef double flux = compute_flux(r, phi, pr, pphi, omega, omega_circ, nu*H, eob_pars)
     flux /= nu
     cdef double f_over_om = flux/omega
     cdef double Fr = -pr / pphi * f_over_om
     cdef double Fphi = -f_over_om
     return Fr, Fphi
 
 
-
 cdef class RadiationReactionForce:
     """
     Convenience wrappers around the RR_force function to enable typed calls
     """
     def __cinit__(self):
         pass
-    cpdef (double,double) RR(self, double[::1] q, double[::1] p, double omega,
-        double omega_circ, double H, EOBParams eob_pars):
+
+    cpdef (double, double) RR(
+        self,
+        double[::1] q,
+        double[::1] p,
+        double omega,
+        double omega_circ,
+        double H,
+        EOBParams eob_pars
+    ):
         pass
 
 
 cdef class SEOBNRv5RRForce(RadiationReactionForce):
     """
     Convenience wrappers around the RR_force function to enable typed calls
     """
+
     def __cinit__(self):
         pass
 
-    cpdef (double, double) RR(self, double[::1] q, double[::1] p, double omega, 
-        double omega_circ, double H, EOBParams eob_pars):
+    cpdef (double, double) RR(
+        self,
+        double[::1] q,
+        double[::1] p,
+        double omega,
+        double omega_circ,
+        double H,
+        EOBParams eob_pars
+    ):
         return RR_force(q, p, omega, omega_circ, H, eob_pars)
 
 
-
-
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.profile(True)
 @cython.linetrace(True)
 cdef double complex EOBFluxCalculateNewtonianMultipole(
-    double x, double phi, int l, int m, double complex[:,:] params
+    double x,
+    double phi,
+    int l,
+    int m,
+    double complex[:, :] params
 ):
     """
     Compute the Newtonian multipole
     """
-    cdef double complex param = params[l,m]
+    cdef double complex param = params[l, m]
     cdef int epsilon = (l + m) % 2
 
-
     cdef double complex y = 0.0
     # Calculate the necessary Ylm
     cdef double complex ylm = sph_harm(-m, l - epsilon, phi, pi / 2)
 
-
     cdef double complex multipole = param * x ** ((l + epsilon) / 2.0)
     multipole *= ylm
     return multipole
 
 
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
 @cython.profile(True)
 @cython.linetrace(True)
-cdef double complex compute_mode(double v_phi2,double phi, double Slm, double[] vs,double[] vhs,int l, int m, EOBParams eob_pars):
+cdef double complex compute_mode(
+    double v_phi2,
+    double phi,
+    double Slm,
+    double[] vs,
+    double[] vhs,
+    int l,
+    int m,
+    EOBParams eob_pars
+):
     """
     Compute the given (l,m) mode at one instant in time.
     See Eq(24) in [SEOBNRv5HM-notes]_.
     """
 
-    cdef double complex Tlm,hNewton,rholm,deltalm
+    cdef double complex Tlm, hNewton, rholm, deltalm
     cdef double v = vs[1]
     cdef double vh = vhs[1]
 
     # Compute the tail
-    cdef double k = m*v*v*v # this is just m*Omega
-    cdef double hathatk = m*vh*vh*vh # this is just m*Omega*H
+    cdef double k = m*v*v*v  # this is just m*Omega
+    cdef double hathatk = m*vh*vh*vh  # this is just m*Omega*H
     # This is just l!
     cdef double z2 = tgamma(l+1)
     cdef double complex lnr1 = loggamma(l+1.0-2.0*hathatk*I)
 
     cdef double lnr1_abs = cabs(lnr1)
     cdef double lnr1_arg = carg(lnr1)
 
-    Tlm = cexp((pi * hathatk) +
-	  I * (2.0 * hathatk * log(4.0 * k / sqrt(M_E)))) * cexp(lnr1)
+    Tlm = (
+        cexp(
+            (pi * hathatk)
+            + I * (2.0 * hathatk * log(4.0 * k / sqrt(M_E))))
+        * cexp(lnr1)
+    )
     Tlm /= z2
 
     # Calculate the newtonian multipole, 1st term in Eq. 17, given by Eq. A1
     hNewton = EOBFluxCalculateNewtonianMultipole(
         v_phi2, phi, l, m, eob_pars.flux_params.prefixes
     )
 
     # Compute rho^l
-    rholm = compute_rholm_single(vs,vh,l,m,eob_pars)
+    rholm = compute_rholm_single(vs, vh, l, m, eob_pars)
     # Compute delta
-    deltalm = compute_deltalm_single(vs,vhs,l,m,eob_pars.flux_params)
+    deltalm = compute_deltalm_single(vs, vhs, l, m, eob_pars.flux_params)
     # Put everything together
     cdef double complex hlm = Tlm * cexp (I * deltalm) * Slm * rholm
     hlm *= hNewton
     return hlm
 
 
-
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
 @cython.profile(True)
 @cython.linetrace(True)
-cpdef compute_hlms(double[:,:] dynamics, EOBParams eob_pars):
+cpdef compute_hlms(double[:, :] dynamics, EOBParams eob_pars):
     """
     Compute the inspiral modes for aligned *or* precessing binaries.
 
     .. notes:
 
         * it is assumed that the special mode coefficients have already been
           computed and set correctly in eob_pars.flux_params
         * it is assumed that if the case is precessing, dynamics has been correctly
           augmented with the projections of the spins
     """
 
-    cdef double r,pr,pphi,omega_circ,omega,v_phi,v_phi2,H,v,vh,phi,chi_1,chi_2
-    cdef int l,m,i,j
+    cdef double r, pr, pphi, omega_circ, omega, v_phi, v_phi2, H, v, vh, phi, chi_1, chi_2
+    cdef int l, m, i, j
     cdef double[:] row
 
     cdef double Slm = 0.0
     cdef double source1
     cdef double source2
-    cdef (int,int) ell_m
+    cdef (int, int) ell_m
     cdef double nu = eob_pars.p_params.nu
     cdef double complex tmp
 
     cdef double vs[PN_limit]
     cdef double vhs[PN_limit]
     cdef double complex rho
-    compute_rho_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,
-                eob_pars.p_params.chi_A, eob_pars.flux_params.rho_coeffs,eob_pars.flux_params.rho_coeffs_log,
-                eob_pars.flux_params.f_coeffs,eob_pars.flux_params.f_coeffs_vh, eob_pars.flux_params.extra_PN_terms)
-
-    compute_delta_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,
-        eob_pars.p_params.chi_A, eob_pars.flux_params.delta_coeffs,eob_pars.flux_params.delta_coeffs_vh)
+    compute_rho_coeffs(
+        eob_pars.p_params.nu,
+        eob_pars.p_params.delta,
+        eob_pars.p_params.a,
+        eob_pars.p_params.chi_S,
+        eob_pars.p_params.chi_A,
+        eob_pars.flux_params.rho_coeffs,
+        eob_pars.flux_params.rho_coeffs_log,
+        eob_pars.flux_params.f_coeffs,
+        eob_pars.flux_params.f_coeffs_vh,
+        eob_pars.flux_params.extra_PN_terms)
+
+    compute_delta_coeffs(
+        eob_pars.p_params.nu,
+        eob_pars.p_params.delta,
+        eob_pars.p_params.a,
+        eob_pars.p_params.chi_S,
+        eob_pars.p_params.chi_A,
+        eob_pars.flux_params.delta_coeffs,
+        eob_pars.flux_params.delta_coeffs_vh)
 
     cdef int N = dynamics.shape[0]
-    cdef dict modes = {(ell_m[0],ell_m[1]):np.zeros(N,dtype=np.complex128) for ell_m in eob_pars.mode_array}
-    cdef double complex[:,:,:] temp_modes = np.zeros((ell_max,ell_max,N),dtype=np.complex128)
+    cdef dict modes = {
+        (ell_m[0], ell_m[1]): np.zeros(N, dtype=np.complex128)
+        for ell_m in eob_pars.mode_array
+    }
+    cdef double complex[:, :, :] temp_modes = np.zeros((ell_max, ell_max, N), dtype=np.complex128)
+
     # Compute all the modes
     for i in range(N):
         row = dynamics[i]
         r = row[0]
         phi = row[1]
         pr = row[2]
         pphi = row[3]
@@ -2286,54 +2451,68 @@
         # of rholm and deltalm
         for j in range(PN_limit):
             vs[j] = v**j
             vhs[j] = vh**j
 
         v_phi = omega/omega_circ**(2./3)
         v_phi2 = v_phi*v_phi
-        source1 = (H * H - 1.0) / (2.0 * nu) + 1.0 # H_eff
+        source1 = (H * H - 1.0) / (2.0 * nu) + 1.0  # H_eff
         source2 = v*pphi
         if not eob_pars.aligned:
             # For precession, we have to recompute the coefficients that enter
             # the waveform at every step, since the spins change.
             # Note that we only need to recompute rho and delta coefficients
             # since the Newtonian prefixes are independent of the spins.
             # Assume the dynamics has been augmented appropriately with the spins.
             chi_1 = row[7]
             chi_2 = row[8]
-            eob_pars.p_params.update_spins(chi_1,chi_2)
+            eob_pars.p_params.update_spins(chi_1, chi_2)
             # Recompute rho coeffs
-            compute_rho_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,
-                eob_pars.p_params.chi_A, eob_pars.flux_params.rho_coeffs,eob_pars.flux_params.rho_coeffs_log,
-                eob_pars.flux_params.f_coeffs,eob_pars.flux_params.f_coeffs_vh,eob_pars.flux_params.extra_PN_terms)
+            compute_rho_coeffs(
+                eob_pars.p_params.nu,
+                eob_pars.p_params.delta,
+                eob_pars.p_params.a,
+                eob_pars.p_params.chi_S,
+                eob_pars.p_params.chi_A,
+                eob_pars.flux_params.rho_coeffs,
+                eob_pars.flux_params.rho_coeffs_log,
+                eob_pars.flux_params.f_coeffs,
+                eob_pars.flux_params.f_coeffs_vh,
+                eob_pars.flux_params.extra_PN_terms)
             # Recompute delta coeffs
-            compute_delta_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,
-                eob_pars.p_params.chi_A, eob_pars.flux_params.delta_coeffs,eob_pars.flux_params.delta_coeffs_vh)
+            compute_delta_coeffs(
+                eob_pars.p_params.nu,
+                eob_pars.p_params.delta,
+                eob_pars.p_params.a,
+                eob_pars.p_params.chi_S,
+                eob_pars.p_params.chi_A,
+                eob_pars.flux_params.delta_coeffs,
+                eob_pars.flux_params.delta_coeffs_vh)
 
         for j in range(len(eob_pars.mode_array)):
             ell_m = eob_pars.mode_array[j]
             l = ell_m[0]
             m = ell_m[1]
             if ((l + m) % 2) == 0:
                 Slm = source1
             else:
                 Slm = source2
 
-
-            #modes[l,m][i]  = compute_mode(v_phi2,phi, Slm, vs,vhs,l, m, eob_pars)
-            temp_modes[l,m,i] = compute_mode(v_phi2,phi, Slm, vs,vhs,l, m, eob_pars)
+            # modes[l,m][i] = compute_mode(v_phi2,phi, Slm, vs,vhs,l, m, eob_pars)
+            temp_modes[l, m, i] = compute_mode(v_phi2, phi, Slm, vs, vhs, l, m, eob_pars)
 
     for j in range(len(eob_pars.mode_array)):
-            ell_m = eob_pars.mode_array[j]
-            l = ell_m[0]
-            m = ell_m[1]
-            modes[l,m] = temp_modes[l,m]
+        ell_m = eob_pars.mode_array[j]
+        l = ell_m[0]
+        m = ell_m[1]
+        modes[l, m] = temp_modes[l, m]
     return modes
 
-cdef double min_threshold(int l,int m):
+
+cdef double min_threshold(int l, int m):
     """
     The values for (2,1) and (5,5) are taken from SEOBNRv4HM. The
     value for (4,3) is determined empirically
     """
     if l==2 and m==1:
         return 90
     elif l==4 and m==3:
@@ -2346,53 +2525,72 @@
 @cython.wraparound(False)
 @cython.boundscheck(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
 @cython.profile(True)
 @cython.linetrace(True)
-cpdef compute_special_coeffs(double[:,:] dynamics, double t_attach, EOBParams eob_pars,
-    dict amp_fits, dict amp_thresholds, dict modes={(2,1):7,(4,3):7,(5,5):5}):
+cpdef compute_special_coeffs(
+    double[:, :] dynamics,
+    double t_attach,
+    EOBParams eob_pars,
+    dict amp_fits,
+    dict amp_thresholds,
+    dict modes={(2, 1): 7, (4, 3): 7, (5, 5): 5}
+):
     """
     Compute the "special" amplitude coefficients.
 
     See discussion after Eq. (33) in [SEOBNRv5HM-notes]_.
     """
     # Step 0: spline the dynamics to the attachment point
 
-
-    cdef int i,j,l,m,power
-    cdef double phi,pphi,omega,omega_circ,H,v,vh,vphi,vphi2,source1,source2,Slm
-    cdef double rholm,hlm,K,amp,clm,min_amp
+    cdef int i, j, l, m, power
+    cdef double phi, pphi, omega, omega_circ, H, v, vh, vphi, vphi2, source1, source2, Slm
+    cdef double rholm, hlm, K, amp, clm, min_amp
     cdef double vs[PN_limit]
     cdef double vhs[PN_limit]
 
-    cdef np.ndarray[DTYPE_T,ndim=1] dynamics_55 = np.zeros(dynamics.shape[1]-1)
-    cdef np.ndarray[DTYPE_T,ndim=1]  dynamics_all = np.zeros(dynamics.shape[1]-1)
-
+    cdef np.ndarray[DTYPE_T, ndim=1] dynamics_55 = np.zeros(dynamics.shape[1]-1)
+    cdef np.ndarray[DTYPE_T, ndim=1] dynamics_all = np.zeros(dynamics.shape[1]-1)
 
-    for i in range(1,dynamics.shape[1]):
-        spline = CubicSpline(dynamics[:,0],dynamics[:,i])
+    for i in range(1, dynamics.shape[1]):
+        spline = CubicSpline(dynamics[:, 0], dynamics[:, i])
         dynamics_all[i-1] = spline(t_attach)
         dynamics_55[i-1] = spline(t_attach-10)
 
     cdef double m_1 = eob_pars.p_params.m_1
     cdef double m_2 = eob_pars.p_params.m_2
     cdef double chi_1 = eob_pars.p_params.chi_1
     cdef double chi_2 = eob_pars.p_params.chi_2
 
-    compute_rho_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,
-                eob_pars.p_params.chi_A, eob_pars.flux_params.rho_coeffs,eob_pars.flux_params.rho_coeffs_log,
-                eob_pars.flux_params.f_coeffs,eob_pars.flux_params.f_coeffs_vh, eob_pars.flux_params.extra_PN_terms)
+    compute_rho_coeffs(
+        eob_pars.p_params.nu,
+        eob_pars.p_params.delta,
+        eob_pars.p_params.a,
+        eob_pars.p_params.chi_S,
+        eob_pars.p_params.chi_A,
+        eob_pars.flux_params.rho_coeffs,
+        eob_pars.flux_params.rho_coeffs_log,
+        eob_pars.flux_params.f_coeffs,
+        eob_pars.flux_params.f_coeffs_vh,
+        eob_pars.flux_params.extra_PN_terms)
+
+    compute_delta_coeffs(
+        eob_pars.p_params.nu,
+        eob_pars.p_params.delta,
+        eob_pars.p_params.a,
+        eob_pars.p_params.chi_S,
+        eob_pars.p_params.chi_A,
+        eob_pars.flux_params.delta_coeffs,
+        eob_pars.flux_params.delta_coeffs_vh)
 
-    compute_delta_coeffs(eob_pars.p_params.nu,eob_pars.p_params.delta,eob_pars.p_params.a,eob_pars.p_params.chi_S,
-        eob_pars.p_params.chi_A, eob_pars.flux_params.delta_coeffs,eob_pars.flux_params.delta_coeffs_vh)
     # Now, loop over every mode of interest
     for mode in modes.keys():
-        l,m = mode
+        l, m = mode
         if l==5 and m==5:
             dynamics_interp = 1*dynamics_55
         else:
             dynamics_interp = 1*dynamics_all
 
         phi = dynamics_interp[1]
         pphi = dynamics_interp[3]
@@ -2403,89 +2601,91 @@
         vh = (H*omega)**(1./3)
         vphi = omega/omega_circ**(2./3)
         vphi2 = vphi*vphi
 
         for j in range(PN_limit):
             vs[j] = v**j
             vhs[j] = vh**j
-        source1 = (H * H - 1.0) / (2.0 * eob_pars.p_params.nu) + 1.0 # H_eff
+        source1 = (H * H - 1.0) / (2.0 * eob_pars.p_params.nu) + 1.0  # H_eff
         source2 = v*pphi
 
         if ((l + m) % 2) == 0:
             Slm = source1
         else:
             Slm = source2
+
         # Step 1: compute the mode with the calibration coeff set to 0
         power = modes[mode]
+        eob_pars.flux_params.f_coeffs[l, m, power] = 0.0
+        hlm = cabs(compute_mode(vphi2, phi, Slm, vs, vhs, l, m, eob_pars))
 
-        eob_pars.flux_params.f_coeffs[l,m,power] = 0.0
-        hlm = cabs(compute_mode(vphi2,phi, Slm, vs,vhs,l, m,eob_pars))
         # Step 2: compute rho_lm for this mode
-        rholm = creal(compute_rholm_single(vs,vh,l,m,eob_pars))
+        rholm = creal(compute_rholm_single(vs, vh, l, m, eob_pars))
 
         # Step 3: compute K = |h_{lm}|/|rho_{lm}|
         K = hlm/fabs(rholm)
 
         # Step 4: compute |h_{lm}^{NR}| from fit
-
-        amp =  amp_fits[(l, m)]
-        amp22 = amp_fits[(2,2)]
+        amp = amp_fits[(l, m)]
+        amp22 = amp_fits[(2, 2)]
 
         # when the amplitude at merger is too small a positive sign is better
-        if np.abs(amp)<1e-4:
+        if np.abs(amp) < 1e-4:
             amp = np.abs(amp)
 
-        min_amp = amp_thresholds[(l,m)]
-        if np.abs(amp)<amp22/min_amp:
+        min_amp = amp_thresholds[(l, m)]
+        if np.abs(amp) < amp22/min_amp:
             amp = np.sign(amp)*amp22/min_amp
 
-
-        amp*=eob_pars.p_params.nu
-
+        amp *= eob_pars.p_params.nu
 
         # Step 5: compute c_lm = (|h_{lm}^{NR}|/K - rho_{lm}(clm=0))/v**power
         clm1 = (amp/K - rholm)*1/v**power
         clm2 = (-amp/K - rholm)*1/v**power
 
         # We always pick the positive solution
-        eob_pars.flux_params.f_coeffs[l,m,power] = clm1
-
+        eob_pars.flux_params.f_coeffs[l, m, power] = clm1
 
 
 @cython.cpow(True)
 @cython.boundscheck(False)
 @cython.wraparound(False)
 @cython.cdivision(True)
-cpdef compute_factors(double[::1] phi_orb,int m_max, double complex[:,:]result):
+cpdef compute_factors(double[::1] phi_orb, int m_max, double complex[:, :] result):
     """
     Trivial helper function that computes iterative :math:`e^{im\\phi}`.
 
     This is used in interpolation, see :py:func:`.compute_hlms.interpolate_modes_fast`.
     """
+
     cdef int N = phi_orb.shape[0]
-    cdef int i,m
+    cdef int i, m
     cdef double complex factor
     for i in range(N):
         factor = cexp(-1*I*phi_orb[i])
-        result[0][i]  = factor
-        for m in range(1,m_max):
-                result[m][i]=result[m-1][i]*factor
-
+        result[0][i] = factor
+        for m in range(1, m_max):
+            result[m][i] = result[m-1][i]*factor
 
 
 @cython.cpow(True)
 @cython.wraparound(False)
 @cython.cdivision(True)
 @cython.nonecheck(False)
 @cython.initializedcheck(False)
 @cython.profile(True)
 @cython.linetrace(True)
-cpdef unrotate_leading_pn(double[::1]re_part,double[::1]im_part, double complex[:] factor,double complex[:] result):
+cpdef unrotate_leading_pn(
+    double[::1] re_part,
+    double[::1] im_part,
+    double complex[:] factor,
+    double complex[:] result
+):
     """
     Helper function used to multiply the interpolated re and im parts by the leading order PN scaling
     """
+
     cdef int N = re_part.shape[0]
     cdef int i
-    #print(re_part.shape[0],im_part.shape[0],phi.shape[0],result.shape[0])
+    # print(re_part.shape[0],im_part.shape[0],phi.shape[0],result.shape[0])
     for i in range(N):
         result[i] = (re_part[i]+I*im_part[i])*factor[i]
-
```

### Comparing `pyseobnr-0.2.8/pyseobnr/generate_waveform.py` & `pyseobnr-0.2.9/pyseobnr/generate_waveform.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,32 +1,38 @@
-from typing import Any, Dict, Tuple, Union
+from __future__ import annotations
+
+from typing import Any, Dict, Final, Literal, Tuple, Union, cast, get_args
 
 import lal
 import lalsimulation as lalsim
 import numpy as np
 
-from .eob.waveform.waveform import SEOBNRv5RRForce
 from .eob.hamiltonian.Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C import (
     Ham_align_a6_apm_AP15_DP23_gaugeL_Tay_C as Ham_aligned_opt,
 )
 from .eob.hamiltonian.Ham_AvgS2precess_simple_cython_PA_AD import (
     Ham_AvgS2precess_simple_cython_PA_AD as Ham_prec_pa_cy,
 )
+from .eob.waveform.waveform import SEOBNRv5RRForce
 from .models import SEOBNRv5HM
+from .models.model import Model
+
+#: Supported approximants
+SupportedApproximants = Literal["SEOBNRv5HM", "SEOBNRv5PHM"]
 
 
 def generate_prec_hpc_opt(
     q: float,
     chi1: np.ndarray,
     chi2: np.ndarray,
     omega_start: float,
-    omega_ref: float = None,
-    settings: Dict[Any, Any] = None,
+    omega_ref: float | None = None,
+    settings: Dict[Any, Any] | None = None,
     debug: bool = False,
-) -> Tuple:
+) -> tuple[np.array, np.array] | tuple[np.array, np.array, Model]:
     """Generate the GW wave polarizations for precessing model in an optimised way. In particular,
     do not compute the inertial frame modes, instead write the polarizations directly summing
     over the co-precessing frame modes
 
     Args:
         q (float): Mass ratio >=1
         chi1 (np.ndarray): Dimensionless spin of the primary
@@ -68,34 +74,85 @@
     model()
     if debug:
         return model.t, model.hpc, model
     else:
         return model.t, model.hpc
 
 
+def _check_spins(
+    chi1: Union[
+        float,
+        np.ndarray,
+        list,
+        tuple[
+            float,
+            float,
+            float,
+        ],
+    ],
+    chi2: Union[
+        float,
+        np.ndarray,
+        list,
+        tuple[
+            float,
+            float,
+            float,
+        ],
+    ],
+    approximant: SupportedApproximants,
+) -> tuple[float, float, float, float, float, float]:
+    chi1 = np.asarray(chi1, dtype=np.float64)
+    chi2 = np.asarray(chi2, dtype=np.float64)
+    if len(chi1.shape) == 0:
+        chi1 = np.array([0, 0, chi1], dtype=np.float64)
+    elif chi1.shape[0] > 3:
+        raise ValueError("Incorrect number of spin elements.")
+    if len(chi2.shape) == 0:
+        chi2 = np.array([0, 0, chi2], dtype=np.float64)
+    elif chi2.shape[0] > 3:
+        raise ValueError("Incorrect number of spin elements.")
+
+    if approximant == "SEOBNRv5HM" and (
+        (np.abs(chi1[:2]).max() > 1e-10) or (np.abs(chi2[:2]).max() > 1e-10)
+    ):
+        raise ValueError(
+            "In-plane spin components must be zero for calling non-precessing approximant."
+        )
+    if np.linalg.norm(chi1) > 1 or np.linalg.norm(chi2) > 1:
+        # raise ValueError("chi1 and chi2 have to respect Kerr limit (|chi|<=1)")
+        raise ValueError("Dimensionless spin magnitudes cannot be greater than 1!")
+
+    return cast(tuple[float, float, float], tuple(float(_) for _ in chi1)) + cast(
+        tuple[float, float, float], tuple(float(_) for _ in chi2)
+    )
+
+
 def generate_modes_opt(
     q: float,
     chi1: Union[float, np.ndarray],
     chi2: Union[float, np.ndarray],
     omega_start: float,
     omega_ref: float = None,
-    approximant: str = "SEOBNRv5HM",
+    approximant: SupportedApproximants = "SEOBNRv5HM",
     settings: Dict[Any, Any] = None,
     debug: bool = False,
 ) -> Tuple:
     """Compute the GW waveform modes for the given configuration and approximant.
 
     Args:
         q (float): Mass ratio >=1
-        chi1 (Union[float,np.ndarray]): Dimensionless spin of primary. If ``float``, interpreted as z component
-        chi2 (Union[float,np.ndarray]): Dimensionless spin of secondary. If ``float``, interpreted as z component
+        chi1 (Union[float,np.ndarray]): Dimensionless spin of primary.
+                                        If ``float``, interpreted as z component
+        chi2 (Union[float,np.ndarray]): Dimensionless spin of secondary.
+                                        If ``float``, interpreted as z component
         omega_start (float): Starting orbital frequency, in geometric units
         omega_ref (float, optional): Reference orbital frequency, in geometric units.
                                      Defaults to None, in which case equals omega_start.
-        approximant (str, optional): The approximant to use. Defaults to "SEOBNRv5HM".
+        approximant (SupportedApproximants, optional): The approximant to use. Defaults to "SEOBNRv5HM".
         settings (Dict[Any,Any], optional): Additional settings to pass to model. Defaults to None.
         debug (bool, optional): Run in debug mode . Defaults to False.
 
     Raises:
         ValueError: If input parameters are not physical
         NotImplementedError: If the approximant requested does not exist
 
@@ -104,37 +161,49 @@
         ``debug=True``
     """
     if q < 1.0:
         raise ValueError("mass-ratio has to be positive and with convention q>=1")
     if omega_start < 0:
         raise ValueError("omega_start has to be positive")
 
+    chi1_x, chi1_y, chi1_z, chi2_x, chi2_y, chi2_z = _check_spins(
+        chi1, chi2, approximant=approximant
+    )
+
     if approximant == "SEOBNRv5HM":
-        if np.abs(chi1) > 1 or np.abs(chi2) > 1:
-            raise ValueError("chi1 and chi2 have to respect Kerr limit (|chi|<=1)")
         RR_f = SEOBNRv5RRForce()
         model = SEOBNRv5HM.SEOBNRv5HM_opt(
-            q, chi1, chi2, omega_start, Ham_aligned_opt, RR_f, settings=settings
+            q,
+            chi_1=chi1_z,
+            chi_2=chi2_z,
+            omega0=omega_start,
+            H=Ham_aligned_opt,
+            RR=RR_f,
+            settings=settings,
         )
         model()
+
     elif approximant == "SEOBNRv5PHM":
-        if np.linalg.norm(chi1) > 1 or np.linalg.norm(chi2) > 1:
-            raise ValueError("chi1 and chi2 have to respect Kerr limit (|chi|<=1)")
         RR_f = SEOBNRv5RRForce()
         model = SEOBNRv5HM.SEOBNRv5PHM_opt(
             q,
-            *chi1,
-            *chi2,
-            omega_start,
-            Ham_prec_pa_cy,
-            RR_f,
+            chi1_x=chi1_x,
+            chi1_y=chi1_y,
+            chi1_z=chi1_z,
+            chi2_x=chi2_x,
+            chi2_y=chi2_y,
+            chi2_z=chi2_z,
+            omega_start=omega_start,
+            H=Ham_prec_pa_cy,
+            RR=RR_f,
             omega_ref=omega_ref,
             settings=settings,
         )
         model()
+
     else:
         raise NotImplementedError(f"Approximant '{approximant}' is not available")
     if debug:
         return model.t, model.waveform_modes, model
     else:
         return model.t, model.waveform_modes
 
@@ -143,43 +212,81 @@
     """
     Class for generating modes, time-domain polarizations and frequency-domain
     polarizations following LAL conventions.
     """
 
     def __init__(self, parameters):
         """
-        Initialize class. The ``parameters`` dictionary can
-        contain the following:
+        Initialize the class with the given ``parameters``.
+
+        ``parameters`` is a dictionary which keys are defined as follow:
 
         Parameters
         ----------
 
-            mass1: Mass of companion 1, in solar masses - Required
-            mass2: Mass of companion 2, in solar masses - Required
-            spin1x: x-component of dimensionless spin of companion 1 - Default: 0
-            spin1y: y-component of dimensionless spin of companion 1 - Default: 0
-            spin1z: z-component of dimensionless spin of companion 1 - Default: 0
-            spin2x: x-component of dimensionless spin of companion 2 - Default: 0
-            spin2y: y-component of dimensionless spin of companion 2 - Default: 0
-            spin2z: z-component of dimensionless spin of companion 2 - Default: 0
-            distance: Distance to the source, in Mpc - Default: 100 Mpc
-            inclination: Inclination of the source, in radians - Default: 0
-            phi_ref: Orbital phase at the reference frequency, in radians - Default: 0
-            f22_start: Starting waveform generation frequency, in Hz - Default: 20 Hz
-            f_ref: The reference frequency, in Hz - Default: f22_start
-            deltaT: Time spacing, in seconds - Default: 1/2048 seconds
-            f_max: Maximum frequency, in Hz - Default: 1024 Hz
-            deltaF: Frequency spacing, in Hz - Default: 0.125
-            ModeArray/mode_array: Mode content (only positive must be specified, e.g [(2,2),(2,1)]) - Default: None (all modes)
-            approximant: 'SEOBNRv5HM' or 'SEOBNRv5PHM'. Default: 'SEOBNRv5HM'
-
+        float mass1:
+            Mass of companion 1, in solar masses - Required
+        float mass2:
+            Mass of companion 2, in solar masses - Required
+        float spin1x:
+            x-component of dimensionless spin of companion 1 - Default: 0
+        float spin1y:
+            y-component of dimensionless spin of companion 1 - Default: 0
+        float spin1z:
+            z-component of dimensionless spin of companion 1 - Default: 0
+        float spin2x:
+            x-component of dimensionless spin of companion 2 - Default: 0
+        float spin2y:
+            y-component of dimensionless spin of companion 2 - Default: 0
+        float spin2z:
+            z-component of dimensionless spin of companion 2 - Default: 0
+        float distance:
+            Distance to the source, in Mpc - Default: 100 Mpc
+        float inclination:
+            Inclination of the source, in radians - Default: 0
+        float phi_ref:
+            Orbital phase at the reference frequency, in radians - Default: 0
+        float f22_start:
+            Starting waveform generation frequency, in Hz - Default: 20 Hz
+        float f_ref:
+            The reference frequency, in Hz - Default: ``f22_start``
+        float deltaT:
+            Time spacing, in seconds - Default: 1/2048 seconds
+        float f_max:
+            Maximum frequency, in Hz - Default: 1024 Hz
+        float deltaF:
+            Frequency spacing, in Hz - Default: 0.125
+        list ModeArray:
+        list mode_array:
+            Mode content (only positive must be specified, e.g ``[(2,2),(2,1)]``).
+            Defaults to ``None`` (all modes, see notes below).
+        str approximant:
+
+            * ``SEOBNRv5HM`` (default)
+            * ``SEOBNRv5PHM``
+
+        Note
+        ----
+
+        The default modes are ``(2, 2)``, ``(2, 1)``, ``(3, 3)``, ``(3, 2)``,
+        ``(4, 4)`` and ``(4, 3)``. In particular ``(5, 5)`` is not included
+        and should be explicitly set through ``ModeArray``.
         """
-        self.validate_parameters(parameters)
 
-    def validate_parameters(self, parameters):
+        self.swap_masses: bool = False
+        self.parameters: dict[str, Any] | None = None
+        self._validate_parameters(parameters)
+
+    @property
+    def model(self):
+        if not hasattr(self, "_model"):
+            raise ValueError("A model object has not been created!")
+        return self._model
+
+    def _validate_parameters(self, parameters):
         if "mass1" not in parameters:
             raise ValueError("mass1 has to be specified!")
         if "mass2" not in parameters:
             raise ValueError("mass2 has to be specified!")
 
         if parameters["mass1"] > 0 and parameters["mass2"] > 0:
             mass1 = parameters["mass1"]
@@ -193,45 +300,46 @@
 
         if mass1 * mass2 / Mtot**2 < 100.0 / (1 + 100) ** 2:
             raise ValueError(
                 "Internal function call failed: Input domain error. Model is only valid for systems with "
                 "mass-ratio up to 100."
             )
 
-        default_params = {
+        default_params: Final = {
             "spin1x": 0.0,
             "spin1y": 0.0,
             "spin1z": 0.0,
             "spin2x": 0.0,
             "spin2y": 0.0,
             "spin2z": 0.0,
             "distance": 100.0,
             "inclination": 0.0,
             "phi_ref": 0.0,
             "f22_start": 20.0,
-            "f_ref": 20.0,
             "deltaT": 1.0 / 2048.0,
             "deltaF": 0.0,
             "ModeArray": None,
             "mode_array": None,
             "approximant": "SEOBNRv5HM",
             "conditioning": 2,
             "polarizations_from_coprec": True,
             "initial_conditions": "adiabatic",
             "initial_conditions_postadiabatic_type": "analytic",
             "postadiabatic": True,
             "postadiabatic_type": "analytic",
             "r_size_input": 12,
         }
 
-        for param in default_params.keys():
-            if param not in parameters:
-                parameters[param] = default_params[param]
+        # fills the provided parameters over the default ones
+        parameters = default_params | parameters
+
+        if "f_ref" not in parameters.keys():
+            parameters["f_ref"] = parameters["f22_start"]
 
-        if parameters["approximant"] not in ["SEOBNRv5HM", "SEOBNRv5PHM"]:
+        if parameters["approximant"] not in get_args(SupportedApproximants):
             raise ValueError("Approximant not implemented!")
 
         # Disable direct polarizations for aligned-spin model
         if parameters["approximant"] == "SEOBNRv5HM":
             parameters["polarizations_from_coprec"] = False
 
         if "f_max" not in parameters.keys():
@@ -254,47 +362,38 @@
             "deltaF",
         ]:
             if not isinstance(parameters[param], float) and not isinstance(
                 parameters[param], int
             ):
                 raise ValueError(f"{param} has to be a real number!")
 
-        if (
-            parameters["approximant"] == "SEOBNRv5HM"
-            and (
-                np.abs(parameters["spin1x"])
-                + np.abs(parameters["spin1y"])
-                + np.abs(parameters["spin2x"])
-                + np.abs(parameters["spin2y"])
-            )
-            > 1e-10
-        ):
-            raise ValueError(
-                "In-plane spin components must be zero for calling non-precessing approximant."
-            )
-
-        if (
-            np.sqrt(
-                parameters["spin1x"] ** 2
-                + parameters["spin1y"] ** 2
-                + parameters["spin1z"] ** 2
-            )
-            > 1
-            or np.sqrt(
-                parameters["spin2x"] ** 2
-                + parameters["spin2y"] ** 2
-                + parameters["spin2z"] ** 2
-            )
-            > 1
-        ):
-            raise ValueError("Dimensionless spin magnitudes cannot be greater than 1!")
+        (
+            parameters["spin1x"],
+            parameters["spin1y"],
+            parameters["spin1z"],
+            parameters["spin2x"],
+            parameters["spin2y"],
+            parameters["spin2z"],
+        ) = _check_spins(
+            chi1=(
+                parameters["spin1x"],
+                parameters["spin1y"],
+                parameters["spin1z"],
+            ),
+            chi2=(
+                parameters["spin2x"],
+                parameters["spin2y"],
+                parameters["spin2z"],
+            ),
+            approximant=parameters["approximant"],
+        )
 
         for param in ["f22_start", "f_ref", "f_max", "deltaT", "deltaF", "distance"]:
             if parameters[param] < 0:
-                raise ValueError(f"{param} have to be positive!")
+                raise ValueError(f"{param} has to be positive!")
 
         if mass2 > mass1:
             self.swap_masses = True
             aux_spin1 = [
                 parameters["spin1x"],
                 parameters["spin1y"],
                 parameters["spin1z"],
@@ -308,16 +407,14 @@
                 -aux_spin1[0],
                 -aux_spin1[1],
                 aux_spin1[2],
             ]
             aux_mass1 = parameters["mass1"]
             parameters["mass1"] = parameters["mass2"]
             parameters["mass2"] = aux_mass1
-        else:
-            self.swap_masses = False
 
         if parameters["initial_conditions"] not in ["adiabatic", "postadiabatic"]:
             raise ValueError("Unrecognised setting for initial conditions.")
 
         if parameters["initial_conditions_postadiabatic_type"] not in [
             "numeric",
             "analytic",
@@ -326,43 +423,51 @@
                 "Unrecognised setting for initial conditions postadiabatic type."
             )
 
         if parameters["postadiabatic_type"] not in ["numeric", "analytic"]:
             raise ValueError("Unrecognised setting for dynamics postadiabatic type.")
 
         if parameters["ModeArray"] is not None and parameters["mode_array"] is not None:
-            raise ValueError("Only one setting can be specified between ModeArray and mode_array.")
+            raise ValueError(
+                "Only one setting can be specified between ModeArray and mode_array."
+            )
 
         self.parameters = parameters
 
     def generate_td_modes(self):
         """
         Generate dictionary of positive and negative m modes in physical units.
         """
         fmin, dt = self.parameters["f22_start"], self.parameters["deltaT"]
         f_ref = self.parameters.get("f_ref")
         m1, m2 = self.parameters["mass1"], self.parameters["mass2"]
         Mtot = m1 + m2
         dist = self.parameters["distance"]
-        approx = self.parameters["approximant"]
+        approx: SupportedApproximants = cast(
+            SupportedApproximants, self.parameters["approximant"]
+        )
 
         if approx == "SEOBNRv5HM":
             chi1 = self.parameters["spin1z"]
             chi2 = self.parameters["spin2z"]
         elif approx == "SEOBNRv5PHM":
-            chi1 = [
-                self.parameters["spin1x"],
-                self.parameters["spin1y"],
-                self.parameters["spin1z"],
-            ]
-            chi2 = [
-                self.parameters["spin2x"],
-                self.parameters["spin2y"],
-                self.parameters["spin2z"],
-            ]
+            chi1 = np.array(
+                [
+                    self.parameters["spin1x"],
+                    self.parameters["spin1y"],
+                    self.parameters["spin1z"],
+                ]
+            )
+            chi2 = np.array(
+                [
+                    self.parameters["spin2x"],
+                    self.parameters["spin2y"],
+                    self.parameters["spin2z"],
+                ]
+            )
 
         omega_start = np.pi * fmin * Mtot * lal.MTSUN_SI
         omega_ref = np.pi * f_ref * Mtot * lal.MTSUN_SI
         q = m1 / m2  # Model convention q=m1/m2>=1
         if q < 1.0:
             q = 1 / q
 
@@ -390,35 +495,33 @@
             if "initial_conditions_postadiabatic_type" in self.parameters:
                 settings.update(
                     initial_conditions_postadiabatic_type=self.parameters[
                         "initial_conditions_postadiabatic_type"
                     ]
                 )
 
+        # Select mode array
         if self.parameters["mode_array"] is not None:
-            settings["return_modes"] = self.parameters[
-                "mode_array"
-            ]  # Select mode array
+            settings["return_modes"] = self.parameters["mode_array"]
         if self.parameters["ModeArray"] is not None:
-            settings["return_modes"] = self.parameters[
-                "ModeArray"
-            ]  # Select mode array
+            settings["return_modes"] = self.parameters["ModeArray"]
 
         if "lmax_nyquist" in self.parameters:
             settings.update(lmax_nyquist=self.parameters["lmax_nyquist"])
 
         settings.update(f_ref=self.parameters["f_ref"])
-        times, h = generate_modes_opt(
+        times, h, self._model = generate_modes_opt(
             q,
             chi1,
             chi2,
             omega_start,
             approximant=approx,
             omega_ref=omega_ref,
             settings=settings,
+            debug=True,
         )
 
         # Convert to physical units and LAL convention
         Mpc_to_meters = lal.PC_SI * 1e6
         times *= Mtot * lal.MTSUN_SI  # Physical times
         fac = (
             -1 * Mtot * lal.MRSUN_SI / (dist * Mpc_to_meters)
@@ -429,24 +532,23 @@
             ell = int(ellm[0])
             if ellm[2] == "-":
                 emm = -int(ellm[3])
             else:
                 emm = int(ellm[2])
             hlm_dict[(ell, emm)] = fac * mode
 
-        if (
-            approx == "SEOBNRv5HM"
-        ):  # If aligned-spin model, compute negative modes using equatorial symmetry
+        # If aligned-spin model, compute negative modes using equatorial symmetry
+        if approx == "SEOBNRv5HM":
             for ellm, mode in h.items():
                 ell = int(ellm[0])
                 emm = int(ellm[2])
                 hlm_dict[(ell, -emm)] = pow(-1, ell) * fac * np.conj(mode)
 
-        # If masses are swapped to satisfy the m1/m2>=1 convention, this implies a pi rotation on the orbital plane,
-        # which translates into a minus sign for the odd modes.
+        # If masses are swapped to satisfy the m1/m2>=1 convention, this implies a
+        # pi rotation on the orbital plane, which translates into a minus sign for the odd modes.
         if self.swap_masses is True:
             for ell, emm in hlm_dict.keys():
                 if np.abs(emm) % 2 != 0:
                     hlm_dict[(ell, emm)] *= -1.0
 
         return times, hlm_dict
 
@@ -469,24 +571,28 @@
                 hpc += ylm * hlm
 
         else:
             fmin, dt = self.parameters["f22_start"], self.parameters["deltaT"]
             f_ref = self.parameters.get("f_ref")
             m1, m2 = self.parameters["mass1"], self.parameters["mass2"]
             Mtot = m1 + m2
-            chi1 = [
-                self.parameters["spin1x"],
-                self.parameters["spin1y"],
-                self.parameters["spin1z"],
-            ]
-            chi2 = [
-                self.parameters["spin2x"],
-                self.parameters["spin2y"],
-                self.parameters["spin2z"],
-            ]
+            chi1 = np.array(
+                [
+                    self.parameters["spin1x"],
+                    self.parameters["spin1y"],
+                    self.parameters["spin1z"],
+                ]
+            )
+            chi2 = np.array(
+                [
+                    self.parameters["spin2x"],
+                    self.parameters["spin2y"],
+                    self.parameters["spin2z"],
+                ]
+            )
             dist = self.parameters["distance"]
             omega_start = np.pi * fmin * Mtot * lal.MTSUN_SI
             omega_ref = np.pi * f_ref * Mtot * lal.MTSUN_SI
             q = m1 / m2
             # Generate internal polarizations, in geometrized units
             settings = {"dt": dt, "M": Mtot, "beta_approx": None}
             if "postadiabatic" in self.parameters:
@@ -507,46 +613,44 @@
                             "initial_conditions_postadiabatic_type"
                         ]
                     )
 
             if "r_size_input" in self.parameters:
                 settings.update(r_size_input=self.parameters["r_size_input"])
 
+            # Select mode array
             if self.parameters["mode_array"] is not None:
-                settings["return_modes"] = self.parameters[
-                    "mode_array"
-                ]  # Select mode array
+                settings["return_modes"] = self.parameters["mode_array"]
             if self.parameters["ModeArray"] is not None:
-                settings["return_modes"] = self.parameters[
-                    "ModeArray"
-                ]  # Select mode array
+                settings["return_modes"] = self.parameters["ModeArray"]
 
             if "lmax_nyquist" in self.parameters:
                 settings.update(lmax_nyquist=self.parameters["lmax_nyquist"])
 
             settings.update(f_ref=self.parameters["f_ref"])
             Mpc_to_meters = lal.PC_SI * 1e6
             fac = (
                 -1 * Mtot * lal.MRSUN_SI / (dist * Mpc_to_meters)
             )  # Minus sign to satisfy LAL convention
 
             # inclination and phiref for polarizations
             settings.update(inclination=incl)
-            # If masses are swapped to satisfy the m1/m2>=1 convention, this implies a pi rotation on the orbital plane.
+            # If masses are swapped to satisfy the m1/m2>=1 convention,
+            # this implies a pi rotation on the orbital plane.
             if self.swap_masses:
                 phi += np.pi
             settings.update(phiref=np.pi / 2 - phi)
-            times, hpc = generate_prec_hpc_opt(
+            times, hpc, self._model = generate_prec_hpc_opt(
                 q,
                 chi1,
                 chi2,
                 omega_start,
                 omega_ref=omega_ref,
                 settings=settings,
-                debug=False,
+                debug=True,
             )
             hpc *= fac
             times *= Mtot * lal.MTSUN_SI
 
         hp = np.real(hpc)
         hc = -np.imag(hpc)
         epoch = lal.LIGOTimeGPS(times[0])
@@ -611,30 +715,31 @@
         # upper bound on the final black hole spin */
         spinkerr = lalsim.SimInspiralFinalBlackHoleSpinBound(S1z, S2z)
         # upper bound on the final plunge, merger, and ringdown time */
         tmerge = lalsim.SimInspiralMergeTimeBound(
             m1 * lal.MSUN_SI, m2 * lal.MSUN_SI
         ) + lalsim.SimInspiralRingdownTimeBound((m1 + m2) * lal.MSUN_SI, spinkerr)
 
-        # extra time to include for all waveforms to take care of situations where the frequency is close to merger
-        # (and is sweeping rapidly): this is a few cycles at the low frequency
+        # extra time to include for all waveforms to take care of situations where the
+        # frequency is close to merger (and is sweeping rapidly): this is a few cycles
+        # at the low frequency
         textra = extra_cycles / f_min
         # compute a new lower frequency
         fstart = lalsim.SimInspiralChirpStartFrequencyBound(
             (1.0 + extra_time_fraction) * tchirp + tmerge + textra,
             m1 * lal.MSUN_SI,
             m2 * lal.MSUN_SI,
         )
 
         self.parameters["f22_start"] = fstart
         hp_lal, hc_lal = self.generate_td_polarizations()
         self.parameters["f22_start"] = original_f_min
 
-        # condition the time domain waveform by tapering in the extra time at the beginning and high-pass filtering
-        # above original f_min
+        # condition the time domain waveform by tapering in the extra time at the
+        # beginning and high-pass filtering above original f_min
         lalsim.SimInspiralTDConditionStage1(
             hp_lal, hc_lal, extra_time_fraction * tchirp + textra, original_f_min
         )
 
         # final tapering at the beginning and at the end to remove filter transients
         # waveform should terminate at a frequency >= Schwarzschild ISCO
         # so taper one cycle at this frequency at the end; should not make
```

### Comparing `pyseobnr-0.2.8/pyseobnr/models/SEOBNRv5HM.py` & `pyseobnr-0.2.9/pyseobnr/models/SEOBNRv5HM.py`

 * *Files 1% similar despite different names*

```diff
@@ -3,36 +3,41 @@
 from copy import deepcopy
 from typing import Any, Callable, Dict
 
 import lal
 import numpy as np
 import quaternion
 import scri
+from lalinference.imrtgr import nrutils
 from pygsl_lite import spline
-from pyseobnr.eob.dynamics.integrate_ode import augment_dynamics, compute_dynamics_opt
+from scipy.interpolate import CubicSpline
+from scipy.optimize import root
+
+from pyseobnr.eob.dynamics.integrate_ode import compute_dynamics_opt
 from pyseobnr.eob.dynamics.integrate_ode_prec import compute_dynamics_quasiprecessing
 from pyseobnr.eob.dynamics.postadiabatic_C import Kerr_ISCO, compute_combined_dynamics
 from pyseobnr.eob.dynamics.postadiabatic_C_fast import (
     compute_combined_dynamics as compute_combined_dynamics_fast,
 )
 from pyseobnr.eob.dynamics.postadiabatic_C_prec import (
     compute_combined_dynamics_exp_v1,
     precessing_final_spin,
 )
+from pyseobnr.eob.fits.EOB_fits import compute_QNM
 from pyseobnr.eob.fits.fits_Hamiltonian import NR_deltaT, NR_deltaT_NS, a6_NS, dSO
 from pyseobnr.eob.fits.GSF_fits import GSF_amplitude_fits
 from pyseobnr.eob.fits.IV_fits import InputValueFits
 from pyseobnr.eob.hamiltonian import Hamiltonian
 from pyseobnr.eob.utils.containers import CalibCoeffs, EOBParams
-from pyseobnr.eob.utils.math_ops_opt import my_dot, my_norm
+from pyseobnr.eob.utils.math_ops_opt import my_norm
 from pyseobnr.eob.utils.utils_precession_opt import (
     SEOBRotatehIlmFromhJlm_opt_v1,
     custom_swsh,
-    interpolate_quats,
     inspiral_merger_quaternion_angles,
+    interpolate_quats,
     seobnrv4P_quaternionJ2P_postmerger_extension,
 )
 from pyseobnr.eob.utils.waveform_ops import frame_inv_amp
 from pyseobnr.eob.waveform.compute_hlms import (
     NQC_correction,
     apply_nqc_corrections,
     compute_IMR_modes,
@@ -41,34 +46,19 @@
 )
 from pyseobnr.eob.waveform.waveform import compute_hlms as compute_hlms_new
 from pyseobnr.eob.waveform.waveform import (
     compute_newtonian_prefixes,
     compute_special_coeffs,
 )
 from pyseobnr.models.model import Model
-from rich.logging import RichHandler
-from rich.traceback import install
-from scipy.interpolate import CubicSpline
-from scipy.optimize import root
-from spherical_functions import SWSH
 
-from pyseobnr.eob.fits.EOB_fits import compute_QNM
+from .common import VALID_MODES
 
 # Setup the logger to work with rich
 logger = logging.getLogger(__name__)
-logger.addHandler(RichHandler(rich_tracebacks=True, markup=True))
-logger.setLevel("INFO")
-# Setup rich to get nice tracebacks
-install()
-
-# List of valid modes
-VALID_MODES = [(2, 2), (2, 1), (3, 3), (3, 2), (4, 4), (4, 3), (5, 5)]
-
-
-from lalinference.imrtgr import nrutils
 
 
 class SEOBNRv5HM_opt(Model):
     """Represents an aligned-spin SEOBNRv5HM waveform with new MR choices."""
 
     def __init__(
         self,
@@ -88,14 +78,16 @@
             chi_2 (float): z component of the dimensionless spin of secondary
             omega0 (float): Initial orbital frequency, in geometric units
             H (Hamiltonian): Hamiltonian class
             RR (Callable): RR force
             settings (Dict[Any, Any], optional): The settings. Defaults to None.
         """
 
+        super().__init__()
+
         self.settings = self._default_settings()
         # If we were given settings, override the defaults
         if settings is not None:
             self.settings.update(**settings)
 
         self.M = self.settings["M"]
         self.q = q
@@ -131,15 +123,17 @@
             # The reference frequency is not the same as the starting frequency
             # If the starting frequency is smaller than the reference frequency,
             # we don't need to adjust anything here, and will account for this
             # with a phase shift of the dynamics.
             # If the reference frequency is _less_ than the starting frequency
             # then just change the starting frequency to the reference frequency
             if self.f_ref < self.f0:
-                logger.warning(f"f_ref < f_start: f_start={self.f0} changed to f_ref={self.f_ref}")
+                logger.warning(
+                    f"f_ref < f_start: f_start={self.f0} changed to f_ref={self.f_ref}"
+                )
                 self.omega0 = self.f_ref * (self.M * lal.MTSUN_SI * np.pi)
                 self.f0 = self.omega0 / (self.M * lal.MTSUN_SI * np.pi)
 
         # The choice of step-back is determined by the range of
         # NR_deltaT in the parameter space of application.
         # The largest value is reached for maximum q and
         # maximum negative spins. The default choice of 250
@@ -277,29 +271,28 @@
         # Set the Hamiltonian coefficients
         self._set_H_coeffs()
         # Set the GSF contributions to the waveform
         gsf_coeffs = GSF_amplitude_fits(self.nu)
         keys = gsf_coeffs.keys()
         # The following is just a fancy way of passing the coeffs
         for key in keys:
-            tmp = re.findall("h(\d)(\d)_v(\d+)", key)
+            tmp = re.findall(r"h(\d)(\d)_v(\d+)", key)
             if tmp:
                 l, m, v = [int(x) for x in tmp[0]]
                 self.eob_pars.flux_params.extra_coeffs[l, m, v] = gsf_coeffs[key]
             else:
-                tmp = re.findall("h(\d)(\d)_vlog(\d+)", key)
+                tmp = re.findall(r"h(\d)(\d)_vlog(\d+)", key)
                 if tmp:
                     l, m, v = [int(x) for x in tmp[0]]
                     self.eob_pars.flux_params.extra_coeffs_log[l, m, v] = gsf_coeffs[
                         key
                     ]
         self._evaluate_model()
 
     def _set_H_coeffs(self):
-
         dc = {}
         # Actual coeffs inside the Hamiltonian
         a6_fit = a6_NS(self.nu)
         dSO_fit = dSO(self.nu, self.ap, self.am)
         dc["a6"] = a6_fit
         dc["dSO"] = dSO_fit
 
@@ -385,29 +378,34 @@
                 # the orbital phase is 0 at f_ref
                 omega_orb = dynamics[:, -2]
                 t_d = dynamics[:, 0]
                 # Approximate
                 f_22 = omega_orb / (self.M * lal.MTSUN_SI * np.pi)
                 if self.f_ref > f_22[-1]:
                     logger.error(
-                        "Internal function call failed: Input domain error. f_ref is larger than the highest frequency in the inspiral!"
+                        "Internal function call failed: Input domain error. "
+                        "f_ref is larger than the highest frequency in the inspiral!"
+                    )
+                    raise ValueError(
+                        "Internal function call failed: Input domain error. "
+                        "f_ref is larger than the highest frequency in the inspiral!"
                     )
-                    raise ValueError("Internal function call failed: Input domain error. f_ref is larger than the highest frequency in the inspiral!")
                 # Solve for time when f_22 = f_ref
                 intrp = CubicSpline(t_d, f_22)
                 guess = t_d[np.argmin(np.abs(f_22 - self.f_ref))]
-                rhs = lambda x: np.abs(intrp(x) - self.f_ref)
-                res = root(rhs, guess)
+                res = root(lambda x: np.abs(intrp(x) - self.f_ref), guess)
 
                 t_correct = res.x
                 if not res.success:
                     logger.error(
                         "Failed to find the time corresponding to requested f_ref."
                     )
-                    raise ValueError("Failed to find the time corresponding to requested f_ref.")
+                    raise ValueError(
+                        "Failed to find the time corresponding to requested f_ref."
+                    )
                 phase = dynamics[:, 2]
                 intrp_phase = CubicSpline(t_d, phase)
                 phase_shift = intrp_phase(t_correct)
                 # Shift the phase for all dynamics arrays
                 self.dynamics[:, 2] -= phase_shift
                 dynamics_low[:, 2] -= phase_shift
                 dynamics_fine[:, 2] -= phase_shift
@@ -546,18 +544,19 @@
             idx_max = np.argmax(amp_inv)
             self.t -= self.t[idx_max]
 
             # Step 10: fill the final dictionary of modes
             for key in self.return_modes:
                 self.waveform_modes[f"{key[0]},{key[1]}"] = hlms_full[key]
             self.success = True
-        except Exception as e:
 
+        except Exception as e:
             logger.error(
-                f"Waveform generation failed for q={self.q},chi_1={self.chi_1},chi_2={self.chi_2},omega0={self.omega0}"
+                f"Waveform generation failed for q={self.q},chi_1={self.chi_1},"
+                f"chi_2={self.chi_2},omega0={self.omega0}"
             )
             raise e
 
 
 class SEOBNRv5PHM_opt(Model):
     """Represents a precessing SEOBNRv5PHM waveform with new MR choices."""
 
@@ -567,15 +566,15 @@
         chi1_x: float,
         chi1_y: float,
         chi1_z: float,
         chi2_x: float,
         chi2_y: float,
         chi2_z: float,
         omega_start: float,
-        H: Hamiltonian,
+        H: type[Hamiltonian],
         RR: Callable,
         omega_ref: float = None,
         settings: Dict[Any, Any] = None,
     ) -> None:
         """Initialize the SEOBNRv5PHM approximant
 
         Args:
@@ -589,14 +588,16 @@
             omega_start (float): Initial orbital frequency, in geometric units
             H (Hamiltonian): Hamiltonian class
             RR (Callable): RR force
             settings (Dict[Any, Any], optional): The settings. Defaults to None.
             omega_ref (float): Reference orbital frequency at which the spins are defined, in geometric units
         """
 
+        super().__init__()
+
         self.settings = self._default_settings()
         # If we were given settings, override the defaults
         if settings is not None:
             self.settings.update(**settings)
 
         self.M = self.settings["M"]
         self.q = q
@@ -617,16 +618,16 @@
 
         self.nu = self.m_1 * self.m_2 / (self.m_1 + self.m_2) ** 2
 
         self.omega_start = omega_start
 
         # Do not use a omega_start which implies r0< 10.5, if that is
         # the case change starting frequency to correspond to r0=10.5M
-        if (self.omega_start) ** (-2.0 / 3.0) < 10.5:
-            self.omega_start = (10.5) ** (-3.0 / 2.0)
+        if self.omega_start ** (-2.0 / 3.0) < 10.5:
+            self.omega_start = 10.5 ** (-3.0 / 2.0)
 
         self.f_start = omega_start / (self.M * lal.MTSUN_SI * np.pi)
 
         # Deal with reference and starting frequencies
         if omega_ref:
             self.omega_ref = omega_ref
             self.f_ref = omega_ref / (self.M * lal.MTSUN_SI * np.pi)
@@ -638,15 +639,17 @@
             # The reference frequency is not the same as the starting frequency
             # If the starting frequency is smaller than the reference frequency,
             # we don't need to adjust anything here, and will account for this
             # with a phase shift of the dynamics.
             # If the reference frequency is _less_ than the starting frequency
             # then just change the starting frequency to the reference frequency
             if self.f_ref < self.f_start:
-                logger.warning(f"f_ref < f_start: f_start={self.f_start} changed to f_ref={self.f_ref}")
+                logger.warning(
+                    f"f_ref < f_start: f_start={self.f_start} changed to f_ref={self.f_ref}"
+                )
                 self.omega_start = self.f_ref * (self.M * lal.MTSUN_SI * np.pi)
                 self.f_start = self.omega_start / (self.M * lal.MTSUN_SI * np.pi)
 
         self.step_back = self.settings.get("step_back", 250.0)
         self.beta_approx = self.settings["beta_approx"]
         self.rd_approx = self.settings["rd_approx"]
         self.rd_smoothing = self.settings["rd_smoothing"]
@@ -766,30 +769,31 @@
             if (m, m) not in self.computed_modes:
                 self.computed_modes.append((m, m))
 
     def _initialize_params(self, phys_pars):
         """
         Re-initialize all parameters to make sure everything is reset
         """
-        self.eob_pars = EOBParams(phys_pars, {}, mode_array=list(self.computed_modes))
+        self.eob_pars: EOBParams = EOBParams(
+            phys_pars, {}, mode_array=list(self.computed_modes)
+        )
         self.eob_pars.flux_params.rho_initialized = False
         self.eob_pars.flux_params.prefixes = np.array(self.prefixes)
         self.eob_pars.flux_params.prefixes_abs = np.abs(
             self.eob_pars.flux_params.prefixes
         )
         self.step_back = self.settings.get("step_back", 250.0)
 
         self.eob_pars.flux_params.extra_PN_terms = self.settings.get(
             "extra_PN_terms", True
         )
 
         self.eob_pars.aligned = False
 
     def _set_H_coeffs(self):
-
         dc = {}
         # Actual coeffs inside the Hamiltonian
         a6_fit = a6_NS(self.nu)
         # dSO_fit = dSO(self.nu, self.ap, self.am)
         dc["a6"] = a6_fit
         # dc["dSO"] = dSO_fit
 
@@ -850,25 +854,25 @@
         keys = waveform_modes.keys()
         shape = waveform_modes[(2, 2)].shape
         n_elem = (ell_max + 3) * (ell_max - 1)
         result = np.zeros((shape[0], n_elem), dtype=np.complex128)
         i = 0
         for ell in range(ell_min, ell_max + 1):
             for m in range(-ell, ell + 1):
-
                 if (ell, m) in keys:
                     result[:, i] = waveform_modes[(ell, m)]
                 i += 1
         return result
 
     def _evaluate_model(self):
         try:
-            #print(
-            #    f"Waveform parameters: q={self.q},chi_1={self.chi1_v},chi_2={self.chi2_v},omega_ref={self.omega_ref}, omega_start = {self.omega_start}, Mt = {self.M}"
-            #)
+            # print(
+            #     f"Waveform parameters: q={self.q},chi_1={self.chi1_v},chi_2={self.chi2_v},"
+            #     f"omega_ref={self.omega_ref}, omega_start = {self.omega_start}, Mt = {self.M}"
+            # )
             # Generate PN and EOB dynamics
             if not self.settings["postadiabatic"]:
                 (
                     dynamics_low,
                     dynamics_fine,
                     t_PN,
                     dyn_PN,
@@ -920,44 +924,49 @@
 
             self.idx_restart = idx_restart
             self.pn_dynamics = np.c_[t_PN, dyn_PN]
             self.dynamics_fine = dynamics_fine
             self.dynamics_low = dynamics_low
 
             omega_orb_fine = dynamics_fine[:, 6]
-            omega_EOB_low = dynamics_low[:, 6]
+            # omega_EOB_low = dynamics_low[:, 6]
 
             self.dynamics = dynamics
             t_correct = None
             if np.abs(self.f_ref - self.f_start) > 1e-10:
                 # Reference frequency is not the same as starting frequency
                 # To account for the LAL conventions, shift things so that
                 # the orbital phase is 0 at f_ref
                 omega_orb = dynamics[:, 6]
                 t_d = dynamics[:, 0]
                 # Approximate
                 f_22 = omega_orb / (self.M * lal.MTSUN_SI * np.pi)
                 if self.f_ref > f_22[-1]:
                     logger.error(
-                        "Internal function call failed: Input domain error. f_ref is larger than the highest frequency in the inspiral!"
+                        "Internal function call failed: Input domain error. f_ref is larger than the highest "
+                        "frequency in the inspiral!"
+                    )
+                    raise ValueError(
+                        "Internal function call failed: Input domain error. f_ref is larger than the highest "
+                        "frequency in the inspiral!"
                     )
-                    raise ValueError("Internal function call failed: Input domain error. f_ref is larger than the highest frequency in the inspiral!")
                 # Solve for time when f_22 = f_ref
                 intrp = CubicSpline(t_d, f_22)
                 guess = t_d[np.argmin(np.abs(f_22 - self.f_ref))]
-                rhs = lambda x: np.abs(intrp(x) - self.f_ref)
-                res = root(rhs, guess)
+                res = root(lambda x: np.abs(intrp(x) - self.f_ref), guess)
 
                 t_correct = res.x
                 self.t_ref = t_correct
                 if not res.success:
                     logger.error(
                         "Failed to find the time corresponding to requested f_ref."
                     )
-                    raise ValueError("Failed to find the time corresponding to requested f_ref.")
+                    raise ValueError(
+                        "Failed to find the time corresponding to requested f_ref."
+                    )
                 phase = dynamics[:, 2]
                 intrp_phase = CubicSpline(t_d, phase)
                 phase_shift = intrp_phase(t_correct)
                 # Shift the phase for all dynamics arrays
                 self.dynamics[:, 2] -= phase_shift
                 dynamics_low[:, 2] -= phase_shift
                 dynamics_fine[:, 2] -= phase_shift
@@ -1016,17 +1025,17 @@
                 idx = (np.abs(r_zoomed_in - r_ISCO)).argmin()
                 t_ISCO = zoom[idx]
 
             om_rISCO = iom(t_ISCO)
             tmp = splines["everything"](om_rISCO)
             chi1LN_om_rISCO = tmp[0]
             chi2LN_om_rISCO = tmp[1]
-            chi1_om_rISCO = tmp[4:7]
-            chi2_om_rISCO = tmp[7:10]
-            LN_om_rISCO = tmp[10:13]
+            # chi1_om_rISCO = tmp[4:7]
+            # chi2_om_rISCO = tmp[7:10]
+            # LN_om_rISCO = tmp[10:13]
 
             ap = (
                 chi1LN_om_rISCO * self.eob_pars.p_params.X_1
                 + chi2LN_om_rISCO * self.eob_pars.p_params.X_2
             )
             am = (
                 chi1LN_om_rISCO * self.eob_pars.p_params.X_1
@@ -1263,16 +1272,16 @@
             self.final_mass = final_mass
             self.t_attach = t_attach
             self.omega_orb_attach = omega_orb_attach
             self.splines = splines
 
             # Now:
             # 1) Compute the time-dependent quaternions from the P-frame to the J-frame using LN_hat
-            # 2) Compute the time-dependent quaternions at ringdown in the J-frame assuming simple precession around
-            #    the final J
+            # 2) Compute the time-dependent quaternions at ringdown in the J-frame assuming simple
+            #    precession around the final J
             # 3) Compute the time-independent Euler angles from the J-frame to the I-frame
             self.euler_angles_attach = euler_angles_attach
             # Compute ringdown approximation of the Euler angles in the J-frame
             quat_postMerger = seobnrv4P_quaternionJ2P_postmerger_extension(
                 t_full,
                 precRate,
                 euler_angles_attach,
@@ -1292,16 +1301,15 @@
             # qt[idx] = quaternion.squad(quatJ2P_dyn, t_dyn, t_full[idx])
 
             # Interpolate the quaternions from P to J-frame to the finer time grid of the waveform modes
             qt[idx] = interpolate_quats(quatJ2P_dyn, t_dyn, t_full[idx])
 
             qt[idx[-1] + 1 :] = quat_postMerger
 
-            if self.settings["polarizations_from_coprec"] == False:
-
+            if self.settings["polarizations_from_coprec"] is False:
                 imr_full = self._add_negative_m_modes(imr_full)
                 # We only need to package modes here
                 imr_full = self._package_modes(imr_full, ell_max=self.max_ell_returned)
                 # iii) Create a co-precessing frame scri waveform
                 w = scri.WaveformModes(
                     dataType=scri.h,
                     t=t_full,
@@ -1320,15 +1328,15 @@
                 w.frame = qt
                 w_modes = w.to_inertial_frame()
                 self.wavefom_modesJ = self._unpack_scri(deepcopy(w_modes))
 
                 # Store the time array
 
                 self.t = t_full - t_full[idx_max]
-                # Store the I2J quatnerion
+                # Store the I2J quaternion
                 self.quaternion = quaternion.as_float_array(qt)
 
                 # Store all the angles
                 # For posterity store the rotation as Euler angles
                 anglesJ2P = quaternion.as_euler_angles(qt).T
                 # self.anglesI2J = [alphaI2J, betaI2J, gammaI2J]
                 self.quatI2J = quatI2J
@@ -1374,12 +1382,12 @@
                 # self.hpc = hpcIfromP
                 self.t = t_full - t_full[idx_max]
                 self.hpc = hpc
                 # self.coprec = imr_full_2
                 # self.anglesTot = [alphaTot, betaTot, gammaTot]
                 self.success = True
         except Exception as e:
-
             logger.error(
-                f"Waveform generation failed for q={self.q},chi_1={self.chi1_v},chi_2={self.chi2_v},omega_ref={self.omega_ref}, omega_start = {self.omega_start}, Mt = {self.M}"
+                f"Waveform generation failed for q={self.q},chi_1={self.chi1_v},chi_2={self.chi2_v},"
+                f"omega_ref={self.omega_ref}, omega_start = {self.omega_start}, Mt = {self.M}"
             )
             raise e
```

### Comparing `pyseobnr-0.2.8/pyseobnr.egg-info/PKG-INFO` & `pyseobnr-0.2.9/pyseobnr.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: pyseobnr
-Version: 0.2.8
+Version: 0.2.9
 Summary: Gravitational wave modelling within the effective-one-body framework
 Author-email: Serguei Ossokine <serguei.ossokine@tutanota.com>, Lorenzo Pompili <lorenzo.pompili@ligo.org>, Deyan Mihaylov <deyan.mihaylov@ligo.org>, Antoni Ramos Buades <antoni.ramos-buades@ligo.org>, Michael Puerrer <michael.puerrer@ligo.org>, Hector Estelles <hector.estelles@ligo.org>
 License: GPL-3.0-or-later
 Requires-Python: >=3.8
 Description-Content-Type: text/x-rst
 License-File: LICENSE
 License-File: AUTHORS.md
@@ -33,14 +33,15 @@
 Requires-Dist: sphinx-tabs; extra == "docs"
 Requires-Dist: cython; extra == "docs"
 Requires-Dist: sphinx_gallery; extra == "docs"
 Requires-Dist: jupytext; extra == "docs"
 Requires-Dist: jupyterlab; extra == "docs"
 Requires-Dist: pandas; extra == "docs"
 Requires-Dist: pyarrow; extra == "docs"
+Requires-Dist: seaborn; extra == "docs"
 Provides-Extra: tests
 Requires-Dist: pytest; extra == "tests"
 Requires-Dist: pytest-sugar; extra == "tests"
 Requires-Dist: pandas; extra == "tests"
 Requires-Dist: pyarrow; extra == "tests"
 
 |pipeline status|
```

### Comparing `pyseobnr-0.2.8/pyseobnr.egg-info/SOURCES.txt` & `pyseobnr-0.2.9/pyseobnr.egg-info/SOURCES.txt`

 * *Files 2% similar despite different names*

```diff
@@ -3,25 +3,28 @@
 CONTRIBUTING.md
 LICENSE
 MANIFEST.in
 README.rst
 pyproject.toml
 setup.py
 tox.ini
+.github/PULL_REQUEST_TEMPLATE.md
+.github/workflows/github.yml
 .gitlab/aei.yml
 docs/Makefile
 docs/README.md
 docs/conf.py
 docs/index.rst
 docs/_static/.gitkeep
 docs/_static/pyseobnr_120px.png
 docs/source/basic_usage.rst
 docs/source/citations.rst
 docs/source/expert_mode.rst
 docs/source/installation.rst
+docs/source/notebooks/example_precession.md
 docs/source/notebooks/getting_started.md
 docs/templates/custom-class-template.rst
 docs/templates/custom-module-template.rst
 pyseobnr/__init__.py
 pyseobnr/_version.py
 pyseobnr/generate_waveform.py
 pyseobnr.egg-info/PKG-INFO
@@ -110,30 +113,33 @@
 pyseobnr/eob/utils/__init__.pxd
 pyseobnr/eob/utils/__init__.py
 pyseobnr/eob/utils/containers.c
 pyseobnr/eob/utils/containers.pxd
 pyseobnr/eob/utils/containers.pyx
 pyseobnr/eob/utils/eob_parameters.h
 pyseobnr/eob/utils/math_ops_opt.py
+pyseobnr/eob/utils/utils.py
 pyseobnr/eob/utils/utils_precession_opt.py
 pyseobnr/eob/utils/waveform_ops.py
 pyseobnr/eob/waveform/__init__.py
 pyseobnr/eob/waveform/compute_MR.py
 pyseobnr/eob/waveform/compute_hlms.py
 pyseobnr/eob/waveform/waveform.c
 pyseobnr/eob/waveform/waveform.pxd
 pyseobnr/eob/waveform/waveform.pyx
 pyseobnr/models/SEOBNRv5HM.py
 pyseobnr/models/__init__.py
+pyseobnr/models/common.py
 pyseobnr/models/model.py
 test/conftest.py
 test/data/frame_hm.csv.gz
 test/regression_tests/__init__.py
 test/regression_tests/helpers.py
 test/regression_tests/regenerate_SEOBNRv5HM.py
 test/regression_tests/regenerate_SEOBNRv5PHM.py
 test/regression_tests/template_v5HM_tests.jinja
 test/regression_tests/template_v5PHM_tests.jinja
 test/regression_tests/test_SEOBNRv5HM.py
 test/regression_tests/test_SEOBNRv5HM_dynamics.py
 test/regression_tests/test_SEOBNRv5PHM.py
-test/regression_tests/test_settings.py
+test/regression_tests/test_settings.py
+test/regression_tests/test_utils.py
```

### Comparing `pyseobnr-0.2.8/setup.py` & `pyseobnr-0.2.9/setup.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/test/data/frame_hm.csv.gz` & `pyseobnr-0.2.9/test/data/frame_hm.csv.gz`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/test/regression_tests/regenerate_SEOBNRv5HM.py` & `pyseobnr-0.2.9/test/regression_tests/regenerate_SEOBNRv5HM.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/test/regression_tests/regenerate_SEOBNRv5PHM.py` & `pyseobnr-0.2.9/test/regression_tests/regenerate_SEOBNRv5PHM.py`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/test/regression_tests/template_v5HM_tests.jinja` & `pyseobnr-0.2.9/test/regression_tests/template_v5HM_tests.jinja`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/test/regression_tests/template_v5PHM_tests.jinja` & `pyseobnr-0.2.9/test/regression_tests/template_v5PHM_tests.jinja`

 * *Files identical despite different names*

### Comparing `pyseobnr-0.2.8/test/regression_tests/test_SEOBNRv5HM.py` & `pyseobnr-0.2.9/test/regression_tests/test_SEOBNRv5HM.py`

 * *Files 2% similar despite different names*

```diff
@@ -50,14 +50,15 @@
         "spin1y": s1y,
         "spin1z": s1z,
         "spin2x": s2x,
         "spin2y": s2y,
         "spin2z": s2z,
         "deltaT": dt,
         "deltaF": deltaF,
+        "f_ref": 20,
         "f22_start": f_min,
         "phi_ref": phiRef,
         "distance": distance,
         "inclination": inclination,
         "f_max": f_max,
         "approximant": approximant,
         "postadiabatic": False,
```

### Comparing `pyseobnr-0.2.8/test/regression_tests/test_SEOBNRv5HM_dynamics.py` & `pyseobnr-0.2.9/test/regression_tests/test_SEOBNRv5HM_dynamics.py`

 * *Files 25% similar despite different names*

```diff
@@ -1,14 +1,16 @@
-from pathlib import Path
 import os
+from pathlib import Path
 
 import pandas as pd
+
 import pytest
 
 from pyseobnr.generate_waveform import generate_modes_opt
+
 from .helpers import compare_frames
 
 folder_data = Path(__file__).parent.parent / "data"
 
 
 @pytest.mark.skipif(
     "CI_TEST_DYNAMIC_REGRESSIONS" not in os.environ,
@@ -29,23 +31,23 @@
         data=model.dynamics,
         columns="t, r, phi, pr, pphi, H, Omega, Omega_circular".replace(" ", "").split(
             ","
         ),
     )
     frame_hm_reference = pd.read_csv(folder_data / "frame_hm.csv.gz")
 
-    known_differences = {
-        "r": 1.303788310647036e-06,  # 1e-10,
-        "phi": 7.878629730839748e-07,  # 1e-10,
-        "pr": 3.3902689824949483e-07,  # 1e-10,
-        "pphi": 1.6233081812089267e-07,  # 1e-10,
-        "H": 1.0472285616458521e-07,  # 1e-10,
-        "Omega": 1.1044090023060171e-07,  # 1e-10,
-        "Omega_circular": 1.344480126674874e-07,  # 1e-10,
+    known_differences_percentage = {
+        "r": 1,
+        "phi": 1,
+        "pr": 1,
+        "pphi": 1,
+        "H": 1,
+        "Omega": 1,
+        "Omega_circular": 1,
     }
 
     compare_frames(
         test_frame=frame_hm,
         reference_frame=frame_hm_reference,
-        known_differences=known_differences,
-        time_tolerance=0.09,  # pretty high, the reference frame was generated on a macOS m2
+        known_differences_percentage=known_differences_percentage,
+        time_tolerance_percent=1,
     )
```

### Comparing `pyseobnr-0.2.8/test/regression_tests/test_SEOBNRv5PHM.py` & `pyseobnr-0.2.9/test/regression_tests/test_SEOBNRv5PHM.py`

 * *Files 1% similar despite different names*

```diff
@@ -53,14 +53,15 @@
         "spin1y": s1y,
         "spin1z": s1z,
         "spin2x": s2x,
         "spin2y": s2y,
         "spin2z": s2z,
         "deltaT": dt,
         "deltaF": deltaF,
+        "f_ref": 20,
         "f22_start": f_min,
         "phi_ref": phiRef,
         "distance": distance,
         "inclination": inclination,
         "f_max": f_max,
         "approximant": approximant,
         "postadiabatic": True,
```

### Comparing `pyseobnr-0.2.8/tox.ini` & `pyseobnr-0.2.9/tox.ini`

 * *Files 10% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 [tox]
 requires =
     tox>=4
-env_list = 
+env_list =
     lint
     py{39,310,311}
     docs
 skip_missing_interpreters = true
 
 [default]
 
@@ -15,31 +15,27 @@
     LDFLAGS
     GSL_HOME
     FFTW3_HOME
 
 [testenv]
 description = run unit tests
 package = wheel
-extras = test
-passenv = 
+extras = tests
+passenv =
     CI_TEST_DYNAMIC_REGRESSIONS
-deps =
-    pytest>=7
-    pytest-sugar
 commands =
     pytest --junitxml={env_tmp_dir}/junit-{env_name}.xml {posargs:test}
 
 [testenv:lint]
 description = install black and invoke it on the current folder
 skip_install = true
 deps =
     black==22.12
-# disabling the check for now (the '-' at the beginning of the line)
-commands = 
-    - black --exclude .tox --check {posargs:.}
+commands =
+    black --extend-exclude=pyseobnr/auxiliary/ --check {posargs:.}
 
 [testenv:docs]
 description = "generates the documentation using Sphinx"
 package = wheel
 extras = docs
 package_env = .pkg-docs
 # required as the name of the package "pyseobnr" is the same as the folder where the source is
```

